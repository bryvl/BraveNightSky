function BlockData(e,t){this.selMenuHander=e,this.target=t}function BlockCCControlData(e,t,i){this.selCCControlHandler=e,this.target=t,this.controlEvents=i}!function(e,t){function i(e){var t=e.length,i=ne.type(e);return!ne.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)))}function n(e){var t=de[e]={};return ne.each(e.match(oe)||[],function(e,i){t[i]=!0}),t}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ne.expando+Math.random()}function o(e,i,n){var r;if(n===t&&1===e.nodeType)if(r="data-"+i.replace(me,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:fe.test(n)?JSON.parse(n):n)}catch(e){}pe.set(e,i,n)}else n=t;return n}function s(){return!0}function a(){return!1}function c(){try{return Y.activeElement}catch(e){}}function l(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function u(e,t,i){if(ne.isFunction(t))return ne.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return ne.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(Ae.test(t))return ne.filter(t,e,i);t=ne.filter(t,e)}return ne.grep(e,function(e){return $.call(t,e)>=0!==i})}function h(e,t){return ne.nodeName(e,"table")&&ne.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function d(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function p(e){var t=Be.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function _(e,t){for(var i=e.length,n=0;n<i;n++)_e.set(e[n],"globalEval",!t||_e.get(t[n],"globalEval"))}function f(e,t){var i,n,r,o,s,a,c,l;if(1===t.nodeType){if(_e.hasData(e)&&(o=_e.access(e),s=_e.set(t,o),l=o.events)){delete s.handle,s.events={};for(r in l)for(i=0,n=l[r].length;i<n;i++)ne.event.add(t,r,l[r][i])}pe.hasData(e)&&(a=pe.access(e),c=ne.extend({},a),pe.set(t,c))}}function m(e,i){var n=e.getElementsByTagName?e.getElementsByTagName(i||"*"):e.querySelectorAll?e.querySelectorAll(i||"*"):[];return i===t||i&&ne.nodeName(e,i)?ne.merge([e],n):n}function g(e,t){var i=t.nodeName.toLowerCase();"input"===i&&Oe.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function y(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,r=Qe.length;r--;)if((t=Qe[r]+i)in e)return t;return n}function T(e,t){return e=t||e,"none"===ne.css(e,"display")||!ne.contains(e.ownerDocument,e)}function v(t){return e.getComputedStyle(t,null)}function S(e,t){for(var i,n,r,o=[],s=0,a=e.length;s<a;s++)(n=e[s]).style&&(o[s]=_e.get(n,"olddisplay"),i=n.style.display,t?(o[s]||"none"!==i||(n.style.display=""),""===n.style.display&&T(n)&&(o[s]=_e.access(n,"olddisplay",A(n.nodeName)))):o[s]||(r=T(n),(i&&"none"!==i||!r)&&_e.set(n,"olddisplay",r?i:ne.css(n,"display"))));for(s=0;s<a;s++)(n=e[s]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[s]||"":"none"));return e}function C(e,t,i){var n=Ue.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function E(e,t,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,s=0;o<4;o+=2)"margin"===i&&(s+=ne.css(e,i+Ke[o],!0,r)),n?("content"===i&&(s-=ne.css(e,"padding"+Ke[o],!0,r)),"margin"!==i&&(s-=ne.css(e,"border"+Ke[o]+"Width",!0,r))):(s+=ne.css(e,"padding"+Ke[o],!0,r),"padding"!==i&&(s+=ne.css(e,"border"+Ke[o]+"Width",!0,r)));return s}function b(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=v(e),s=ne.support.boxSizing&&"border-box"===ne.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=We(e,t,o))<0||null==r)&&(r=e.style[t]),Ye.test(r))return r;n=s&&(ne.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+E(e,t,i||(s?"border":"content"),n,o)+"px"}function A(e){var t=Y,i=Xe[e];return i||("none"!==(i=x(e,t))&&i||((t=((Ve=(Ve||ne("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement))[0].contentWindow||Ve[0].contentDocument).document).write("<!doctype html><html><body>"),t.close(),i=x(e,t),Ve.detach()),Xe[e]=i),i}function x(e,t){var i=ne(t.createElement(e)).appendTo(t.body),n=ne.css(i[0],"display");return i.remove(),n}function R(e,t,i,n){var r;if(ne.isArray(t))ne.each(t,function(t,r){i||Je.test(e)?n(e,r):R(e+"["+("object"==typeof r?t:"")+"]",r,i,n)});else if(i||"object"!==ne.type(t))n(e,t);else for(r in t)R(e+"["+r+"]",t[r],i,n)}function P(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,o=t.toLowerCase().match(oe)||[];if(ne.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function I(e,t,i,n){function r(a){var c;return o[a]=!0,ne.each(e[a]||[],function(e,a){var l=a(t,i,n);return"string"!=typeof l||s||o[l]?s?!(c=l):void 0:(t.dataTypes.unshift(l),r(l),!1)}),c}var o={},s=e===ft;return r(t.dataTypes[0])||!o["*"]&&r("*")}function w(e,i){var n,r,o=ne.ajaxSettings.flatOptions||{};for(n in i)i[n]!==t&&((o[n]?e:r||(r={}))[n]=i[n]);return r&&ne.extend(!0,e,r),e}function N(e,i,n){for(var r,o,s,a,c=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),r===t&&(r=e.mimeType||i.getResponseHeader("Content-Type"));if(r)for(o in c)if(c[o]&&c[o].test(r)){l.unshift(o);break}if(l[0]in n)s=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){s=o;break}a||(a=o)}s=s||a}if(s)return s!==l[0]&&l.unshift(s),n[s]}function L(e,t,i,n){var r,o,s,a,c,l={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!c&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=o,o=u.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(s=l[c+" "+o]||l["* "+o]))for(r in l)if((a=r.split(" "))[1]===o&&(s=l[c+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[r]:!0!==l[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+c+" to "+o}}}return{state:"success",data:t}}function O(){return setTimeout(function(){Et=t}),Et=ne.now()}function D(e,t,i){for(var n,r=(It[t]||[]).concat(It["*"]),o=0,s=r.length;o<s;o++)if(n=r[o].call(i,t,e))return n}function F(e,t,i){var n,r,o=0,s=Pt.length,a=ne.Deferred().always(function(){delete c.elem}),c=function(){if(r)return!1;for(var t=Et||O(),i=Math.max(0,l.startTime+l.duration-t),n=1-(i/l.duration||0),o=0,s=l.tweens.length;o<s;o++)l.tweens[o].run(n);return a.notifyWith(e,[l,n,i]),n<1&&s?i:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:ne.extend({},t),opts:ne.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Et||O(),duration:i.duration,tweens:[],createTween:function(t,i){var n=ne.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var i=0,n=t?l.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)l.tweens[i].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),u=l.props;for(B(u,l.opts.specialEasing);o<s;o++)if(n=Pt[o].call(l,e,u,l.opts))return n;return ne.map(u,D,l),ne.isFunction(l.opts.start)&&l.opts.start.call(e,l),ne.fx.timer(ne.extend(c,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function B(e,t){var i,n,r,o,s;for(i in e)if(n=ne.camelCase(i),r=t[n],o=e[i],ne.isArray(o)&&(r=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),(s=ne.cssHooks[n])&&"expand"in s){o=s.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=r)}else t[n]=r}function M(e,t,i,n,r){return new M.prototype.init(e,t,i,n,r)}function k(e,t){var i,n={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)n["margin"+(i=Ke[r])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function W(e){return ne.isWindow(e)?e:9===e.nodeType&&e.defaultView}var V,z,G=typeof t,U=e.location,Y=e.document,H=Y.documentElement,X=e.jQuery,q=e.$,j={},K=[],Q=K.concat,Z=K.push,J=K.slice,$=K.indexOf,ee=j.toString,te=j.hasOwnProperty,ie="2.0.3".trim,ne=function(e,t){return new ne.fn.init(e,t,V)},re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,oe=/\S+/g,se=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ae=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ce=/^-ms-/,le=/-([\da-z])/gi,ue=function(e,t){return t.toUpperCase()},he=function(){Y.removeEventListener("DOMContentLoaded",he,!1),e.removeEventListener("load",he,!1),ne.ready()};ne.fn=ne.prototype={jquery:"2.0.3",constructor:ne,init:function(e,i,n){var r,o;if(!e)return this;if("string"==typeof e){if(!(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:se.exec(e))||!r[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(r[1]){if(i=i instanceof ne?i[0]:i,ne.merge(this,ne.parseHTML(r[1],i&&i.nodeType?i.ownerDocument||i:Y,!0)),ae.test(r[1])&&ne.isPlainObject(i))for(r in i)ne.isFunction(this[r])?this[r](i[r]):this.attr(r,i[r]);return this}return(o=Y.getElementById(r[2]))&&o.parentNode&&(this.length=1,this[0]=o),this.context=Y,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ne.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ne.makeArray(e,this))},selector:"",length:0,toArray:function(){return J.call(this)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=ne.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ne.each(this,e,t)},ready:function(e){return ne.ready.promise().done(e),this},slice:function(){return this.pushStack(J.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},map:function(e){return this.pushStack(ne.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:Z,sort:[].sort,splice:[].splice},ne.fn.init.prototype=ne.fn,ne.extend=ne.fn.extend=function(){var e,i,n,r,o,s,a=arguments[0]||{},c=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},c=2),"object"==typeof a||ne.isFunction(a)||(a={}),l===c&&(a=this,--c);c<l;c++)if(null!=(e=arguments[c]))for(i in e)n=a[i],a!==(r=e[i])&&(u&&r&&(ne.isPlainObject(r)||(o=ne.isArray(r)))?(o?(o=!1,s=n&&ne.isArray(n)?n:[]):s=n&&ne.isPlainObject(n)?n:{},a[i]=ne.extend(u,s,r)):r!==t&&(a[i]=r));return a},ne.extend({expando:"jQuery"+("2.0.3"+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ne&&(e.$=q),t&&e.jQuery===ne&&(e.jQuery=X),ne},isReady:!1,readyWait:1,holdReady:function(e){e?ne.readyWait++:ne.ready(!0)},ready:function(e){(!0===e?--ne.readyWait:ne.isReady)||(ne.isReady=!0,!0!==e&&--ne.readyWait>0||(z.resolveWith(Y,[ne]),ne.fn.trigger&&ne(Y).trigger("ready").off("ready")))},isFunction:function(e){return"function"===ne.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?j[ee.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==ne.type(e)||e.nodeType||ne.isWindow(e))return!1;try{if(e.constructor&&!te.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||Y;var n=ae.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=ne.buildFragment([e],t,r),r&&ne(r).remove(),ne.merge([],n.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var i;if(!e||"string"!=typeof e)return null;try{i=(new DOMParser).parseFromString(e,"text/xml")}catch(e){i=t}return i&&!i.getElementsByTagName("parsererror").length||ne.error("Invalid XML: "+e),i},noop:function(){},globalEval:function(e){var t,i=eval;(e=ne.trim(e))&&(1===e.indexOf("use strict")?((t=Y.createElement("script")).text=e,Y.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(ce,"ms-").replace(le,ue)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r=0,o=e.length,s=i(e);if(n){if(s)for(;r<o&&!1!==t.apply(e[r],n);r++);else for(r in e)if(!1===t.apply(e[r],n))break}else if(s)for(;r<o&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":ie.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?ne.merge(n,"string"==typeof e?[e]:e):Z.call(n,e)),n},inArray:function(e,t,i){return null==t?-1:$.call(t,e,i)},merge:function(e,i){var n=i.length,r=e.length,o=0;if("number"==typeof n)for(;o<n;o++)e[r++]=i[o];else for(;i[o]!==t;)e[r++]=i[o++];return e.length=r,e},grep:function(e,t,i){var n=[],r=0,o=e.length;for(i=!!i;r<o;r++)i!==!!t(e[r],r)&&n.push(e[r]);return n},map:function(e,t,n){var r,o=0,s=e.length,a=[];if(i(e))for(;o<s;o++)null!=(r=t(e[o],o,n))&&(a[a.length]=r);else for(o in e)null!=(r=t(e[o],o,n))&&(a[a.length]=r);return Q.apply([],a)},guid:1,proxy:function(e,i){var n,r,o;return"string"==typeof i&&(n=e[i],i=e,e=n),ne.isFunction(e)?(r=J.call(arguments,2),o=function(){return e.apply(i||this,r.concat(J.call(arguments)))},o.guid=e.guid=e.guid||ne.guid++,o):t},access:function(e,i,n,r,o,s,a){var c=0,l=e.length,u=null==n;if("object"===ne.type(n)){o=!0;for(c in n)ne.access(e,i,c,n[c],!0,s,a)}else if(r!==t&&(o=!0,ne.isFunction(r)||(a=!0),u&&(a?(i.call(e,r),i=null):(u=i,i=function(e,t,i){return u.call(ne(e),i)})),i))for(;c<l;c++)i(e[c],n,a?r:r.call(e[c],c,i(e[c],n)));return o?e:u?i.call(e):l?i(e[0],n):s},now:Date.now,swap:function(e,t,i,n){var r,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];r=i.apply(e,n||[]);for(o in t)e.style[o]=s[o];return r}}),ne.ready.promise=function(t){return z||(z=ne.Deferred(),"complete"===Y.readyState?setTimeout(ne.ready):(Y.addEventListener("DOMContentLoaded",he,!1),e.addEventListener("load",he,!1))),z.promise(t)},ne.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){j["[object "+t+"]"]=t.toLowerCase()}),V=ne(Y),function(e,t){function i(e,t,i,n){var r,o,s,a,c,l,d,p,_,f;if((t?t.ownerDocument||t:k)!==w&&I(t),t=t||w,i=i||[],!e||"string"!=typeof e)return i;if(1!==(a=t.nodeType)&&9!==a)return[];if(L&&!n){if(r=me.exec(e))if(s=r[1]){if(9===a){if(!(o=t.getElementById(s))||!o.parentNode)return i;if(o.id===s)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&B(t,o)&&o.id===s)return i.push(o),i}else{if(r[2])return Z.apply(i,t.getElementsByTagName(e)),i;if((s=r[3])&&S.getElementsByClassName&&t.getElementsByClassName)return Z.apply(i,t.getElementsByClassName(s)),i}if(S.qsa&&(!O||!O.test(e))){if(p=d=M,_=t,f=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(l=u(e),(d=t.getAttribute("id"))?p=d.replace(Te,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",c=l.length;c--;)l[c]=p+h(l[c]);_=ue.test(e)&&t.parentNode||t,f=l.join(",")}if(f)try{return Z.apply(i,_.querySelectorAll(f)),i}catch(e){}finally{d||t.removeAttribute("id")}}}return T(e.replace(ae,"$1"),t,i,n)}function n(){function e(i,n){return t.push(i+=" ")>E.cacheLength&&delete e[t.shift()],e[i]=n}var t=[];return e}function r(e){return e[M]=!0,e}function o(e){var t=w.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function s(e,t){for(var i=e.split("|"),n=e.length;n--;)E.attrHandle[i[n]]=t}function a(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||X)-(~e.sourceIndex||X);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function c(e){return r(function(t){return t=+t,r(function(i,n){for(var r,o=e([],i.length,t),s=o.length;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})})}function l(){}function u(e,t){var n,r,o,s,a,c,l,u=G[e+" "];if(u)return t?0:u.slice(0);for(a=e,c=[],l=E.preFilter;a;){n&&!(r=ce.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=le.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(ae," ")}),a=a.slice(n.length));for(s in E.filter)!(r=_e[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?i.error(e):G(e,c).slice(0)}function h(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function d(e,t,i){var n=t.dir,r=i&&"parentNode"===n,o=V++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||r)return e(t,i,o)}:function(t,i,s){var a,c,l,u=W+" "+o;if(s){for(;t=t[n];)if((1===t.nodeType||r)&&e(t,i,s))return!0}else for(;t=t[n];)if(1===t.nodeType||r)if(l=t[M]||(t[M]={}),(c=l[n])&&c[0]===u){if(!0===(a=c[1])||a===C)return!0===a}else if(c=l[n]=[u],c[1]=e(t,i,s)||C,!0===c[1])return!0}}function p(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function _(e,t,i,n,r){for(var o,s=[],a=0,c=e.length,l=null!=t;a<c;a++)(o=e[a])&&(i&&!i(o,n,r)||(s.push(o),l&&t.push(a)));return s}function f(e,t,i,n,o,s){return n&&!n[M]&&(n=f(n)),o&&!o[M]&&(o=f(o,s)),r(function(r,s,a,c){var l,u,h,d=[],p=[],f=s.length,m=r||y(t||"*",a.nodeType?[a]:a,[]),g=!e||!r&&t?m:_(m,d,e,a,c),T=i?o||(r?e:f||n)?[]:s:g;if(i&&i(g,T,a,c),n)for(l=_(T,p),n(l,[],a,c),u=l.length;u--;)(h=l[u])&&(T[p[u]]=!(g[p[u]]=h));if(r){if(o||e){if(o){for(l=[],u=T.length;u--;)(h=T[u])&&l.push(g[u]=h);o(null,T=[],l,c)}for(u=T.length;u--;)(h=T[u])&&(l=o?$.call(r,h):d[u])>-1&&(r[l]=!(s[l]=h))}}else T=_(T===s?T.splice(f,T.length):T),o?o(null,s,T,c):Z.apply(s,T)})}function m(e){for(var t,i,n,r=e.length,o=E.relative[e[0].type],s=o||E.relative[" "],a=o?1:0,c=d(function(e){return e===t},s,!0),l=d(function(e){return $.call(t,e)>-1},s,!0),u=[function(e,i,n){return!o&&(n||i!==R)||((t=i).nodeType?c(e,i,n):l(e,i,n))}];a<r;a++)if(i=E.relative[e[a].type])u=[d(p(u),i)];else{if((i=E.filter[e[a].type].apply(null,e[a].matches))[M]){for(n=++a;n<r&&!E.relative[e[n].type];n++);return f(a>1&&p(u),a>1&&h(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ae,"$1"),i,a<n&&m(e.slice(a,n)),n<r&&m(e=e.slice(n)),n<r&&h(e))}u.push(i)}return p(u)}function g(e,t){var n=0,o=t.length>0,s=e.length>0,a=function(r,a,c,l,u){var h,d,p,f=[],m=0,g="0",y=r&&[],T=null!=u,v=R,S=r||s&&E.find.TAG("*",u&&a.parentNode||a),b=W+=null==v?1:Math.random()||.1;for(T&&(R=a!==w&&a,C=n);null!=(h=S[g]);g++){if(s&&h){for(d=0;p=e[d++];)if(p(h,a,c)){l.push(h);break}T&&(W=b,C=++n)}o&&((h=!p&&h)&&m--,r&&y.push(h))}if(m+=g,o&&g!==m){for(d=0;p=t[d++];)p(y,f,a,c);if(r){if(m>0)for(;g--;)y[g]||f[g]||(f[g]=K.call(l));f=_(f)}Z.apply(l,f),T&&!r&&f.length>0&&m+t.length>1&&i.uniqueSort(l)}return T&&(W=b,R=v),y};return o?r(a):a}function y(e,t,n){for(var r=0,o=t.length;r<o;r++)i(e,t[r],n);return n}function T(e,t,i,n){var r,o,s,a,c,l=u(e);if(!n&&1===l.length){if((o=l[0]=l[0].slice(0)).length>2&&"ID"===(s=o[0]).type&&S.getById&&9===t.nodeType&&L&&E.relative[o[1].type]){if(!(t=(E.find.ID(s.matches[0].replace(ve,Se),t)||[])[0]))return i;e=e.slice(o.shift().value.length)}for(r=_e.needsContext.test(e)?0:o.length;r--&&(s=o[r],!E.relative[a=s.type]);)if((c=E.find[a])&&(n=c(s.matches[0].replace(ve,Se),ue.test(o[0].type)&&t.parentNode||t))){if(o.splice(r,1),!(e=n.length&&h(o)))return Z.apply(i,n),i;break}}return x(e,l)(n,t,!L,i,ue.test(e)),i}var v,S,C,E,b,A,x,R,P,I,w,N,L,O,D,F,B,M="sizzle"+-new Date,k=e.document,W=0,V=0,z=n(),G=n(),U=n(),Y=!1,H=function(e,t){return e===t?(Y=!0,0):0},X=1<<31,q={}.hasOwnProperty,j=[],K=j.pop,Q=j.push,Z=j.push,J=j.slice,$=j.indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(this[t]===e)return t;return-1},ee="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",te="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=ie.replace("w","w#"),oe="\\["+te+"*("+ie+")"+te+"*(?:([*^$|!~]?=)"+te+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+re+")|)|)"+te+"*\\]",se=":("+ie+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+oe.replace(3,8)+")*)|.*)\\)|)",ae=new RegExp("^"+te+"+|((?:^|[^\\\\])(?:\\\\.)*)"+te+"+$","g"),ce=new RegExp("^"+te+"*,"+te+"*"),le=new RegExp("^"+te+"*([>+~]|"+te+")"+te+"*"),ue=new RegExp(te+"*[+~]"),he=new RegExp("="+te+"*([^\\]'\"]*)"+te+"*\\]","g"),de=new RegExp(se),pe=new RegExp("^"+re+"$"),_e={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+te+"*(even|odd|(([+-]|)(\\d*)n|)"+te+"*(?:([+-]|)"+te+"*(\\d+)|))"+te+"*\\)|)","i"),bool:new RegExp("^(?:"+ee+")$","i"),needsContext:new RegExp("^"+te+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+te+"*((?:-\\d)?\\d*)"+te+"*\\)|)(?=[^-]|$)","i")},fe=/^[^{]+\{\s*\[native \w/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ge=/^(?:input|select|textarea|button)$/i,ye=/^h\d$/i,Te=/'|\\/g,ve=new RegExp("\\\\([\\da-f]{1,6}"+te+"?|("+te+")|.)","ig"),Se=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Z.apply(j=J.call(k.childNodes),k.childNodes),j[k.childNodes.length].nodeType}catch(e){Z={apply:j.length?function(e,t){Q.apply(e,J.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}A=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},S=i.support={},I=i.setDocument=function(e){var t=e?e.ownerDocument||e:k,i=t.defaultView;return t!==w&&9===t.nodeType&&t.documentElement?(w=t,N=t.documentElement,L=!A(t),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){I()}),S.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),S.getElementsByTagName=o(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),S.getElementsByClassName=o(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),S.getById=o(function(e){return N.appendChild(e).id=M,!t.getElementsByName||!t.getElementsByName(M).length}),S.getById?(E.find.ID=function(e,t){if(void 0!==t.getElementById&&L){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},E.filter.ID=function(e){var t=e.replace(ve,Se);return function(e){return e.getAttribute("id")===t}}):(delete E.find.ID,E.filter.ID=function(e){var t=e.replace(ve,Se);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),E.find.TAG=S.getElementsByTagName?function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},E.find.CLASS=S.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&L)return t.getElementsByClassName(e)},D=[],O=[],(S.qsa=fe.test(t.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||O.push("\\["+te+"*(?:value|"+ee+")"),e.querySelectorAll(":checked").length||O.push(":checked")}),o(function(e){var i=t.createElement("input");i.setAttribute("type","hidden"),e.appendChild(i).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&O.push("[*^$]="+te+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")})),(S.matchesSelector=fe.test(F=N.webkitMatchesSelector||N.mozMatchesSelector||N.oMatchesSelector||N.msMatchesSelector))&&o(function(e){S.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),D.push("!=",se)}),O=O.length&&new RegExp(O.join("|")),D=D.length&&new RegExp(D.join("|")),B=fe.test(N.contains)||N.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},H=N.compareDocumentPosition?function(e,i){if(e===i)return Y=!0,0;var n=i.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(i);return n?1&n||!S.sortDetached&&i.compareDocumentPosition(e)===n?e===t||B(k,e)?-1:i===t||B(k,i)?1:P?$.call(P,e)-$.call(P,i):0:4&n?-1:1:e.compareDocumentPosition?-1:1}:function(e,i){var n,r=0,o=e.parentNode,s=i.parentNode,c=[e],l=[i];if(e===i)return Y=!0,0;if(!o||!s)return e===t?-1:i===t?1:o?-1:s?1:P?$.call(P,e)-$.call(P,i):0;if(o===s)return a(e,i);for(n=e;n=n.parentNode;)c.unshift(n);for(n=i;n=n.parentNode;)l.unshift(n);for(;c[r]===l[r];)r++;return r?a(c[r],l[r]):c[r]===k?-1:l[r]===k?1:0},t):w},i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){if((e.ownerDocument||e)!==w&&I(e),t=t.replace(he,"='$1']"),S.matchesSelector&&L&&(!D||!D.test(t))&&(!O||!O.test(t)))try{var n=F.call(e,t);if(n||S.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return i(t,w,null,[e]).length>0},i.contains=function(e,t){return(e.ownerDocument||e)!==w&&I(e),B(e,t)},i.attr=function(e,t){(e.ownerDocument||e)!==w&&I(e);var i=E.attrHandle[t.toLowerCase()],n=i&&q.call(E.attrHandle,t.toLowerCase())?i(e,t,!L):void 0;return void 0===n?S.attributes||!L?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null:n},i.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},i.uniqueSort=function(e){var t,i=[],n=0,r=0;if(Y=!S.detectDuplicates,P=!S.sortStable&&e.slice(0),e.sort(H),Y){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)e.splice(i[n],1)}return e},b=i.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=b(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n];n++)i+=b(t);return i},(E=i.selectors={cacheLength:50,createPseudo:r,match:_e,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ve,Se),e[3]=(e[4]||e[5]||"").replace(ve,Se),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||i.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&i.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return _e.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:i&&de.test(i)&&(t=u(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ve,Se).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=z[e+" "];return t||(t=new RegExp("(^|"+te+")"+e+"("+te+"|$)"))&&z(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var o=i.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,i,n,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,c){var l,u,h,d,p,_,f=o!==s?"nextSibling":"previousSibling",m=t.parentNode,g=a&&t.nodeName.toLowerCase(),y=!c&&!a;if(m){if(o){for(;f;){for(h=t;h=h[f];)if(a?h.nodeName.toLowerCase()===g:1===h.nodeType)return!1;_=f="only"===e&&!_&&"nextSibling"}return!0}if(_=[s?m.firstChild:m.lastChild],s&&y){for(p=(l=(u=m[M]||(m[M]={}))[e]||[])[0]===W&&l[1],d=l[0]===W&&l[2],h=p&&m.childNodes[p];h=++p&&h&&h[f]||(d=p=0)||_.pop();)if(1===h.nodeType&&++d&&h===t){u[e]=[W,p,d];break}}else if(y&&(l=(t[M]||(t[M]={}))[e])&&l[0]===W)d=l[1];else for(;(h=++p&&h&&h[f]||(d=p=0)||_.pop())&&((a?h.nodeName.toLowerCase()!==g:1!==h.nodeType)||!++d||(y&&((h[M]||(h[M]={}))[e]=[W,d]),h!==t)););return(d-=r)===n||d%n==0&&d/n>=0}}},PSEUDO:function(e,t){var n,o=E.pseudos[e]||E.setFilters[e.toLowerCase()]||i.error("unsupported pseudo: "+e);return o[M]?o(t):o.length>1?(n=[e,e,"",t],E.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,i){for(var n,r=o(e,t),s=r.length;s--;)e[n=$.call(e,r[s])]=!(i[n]=r[s])}):function(e){return o(e,0,n)}):o}},pseudos:{not:r(function(e){var t=[],i=[],n=x(e.replace(ae,"$1"));return n[M]?r(function(e,t,i,r){for(var o,s=n(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,r,o){return t[0]=e,n(t,null,o,i),!i.pop()}}),has:r(function(e){return function(t){return i(e,t).length>0}}),contains:r(function(e){return function(t){return(t.textContent||t.innerText||b(t)).indexOf(e)>-1}}),lang:r(function(e){return pe.test(e||"")||i.error("unsupported lang: "+e),e=e.replace(ve,Se).toLowerCase(),function(t){var i;do{if(i=L?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===N},focus:function(e){return e===w.activeElement&&(!w.hasFocus||w.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!E.pseudos.empty(e)},header:function(e){return ye.test(e.nodeName)},input:function(e){return ge.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[i<0?i+t:i]}),even:c(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:c(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:c(function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e}),gt:c(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}}).pseudos.nth=E.pseudos.eq;for(v in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[v]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(v);for(v in{submit:!0,reset:!0})E.pseudos[v]=function(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}(v);l.prototype=E.filters=E.pseudos,E.setFilters=new l,x=i.compile=function(e,t){var i,n=[],r=[],o=U[e+" "];if(!o){for(t||(t=u(e)),i=t.length;i--;)(o=m(t[i]))[M]?n.push(o):r.push(o);o=U(e,g(r,n))}return o},S.sortStable=M.split("").sort(H).join("")===M,S.detectDuplicates=Y,I(),S.sortDetached=o(function(e){return 1&e.compareDocumentPosition(w.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||s("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),S.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||s("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||s(ee,function(e,t,i){var n;if(!i)return(n=e.getAttributeNode(t))&&n.specified?n.value:!0===e[t]?t.toLowerCase():null}),ne.find=i,ne.expr=i.selectors,ne.expr[":"]=ne.expr.pseudos,ne.unique=i.uniqueSort,ne.text=i.getText,ne.isXMLDoc=i.isXML,ne.contains=i.contains}(e);var de={};ne.Callbacks=function(e){var i,r,o,s,a,c,l=[],u=!(e="string"==typeof e?de[e]||n(e):ne.extend({},e)).once&&[],h=function(t){for(i=e.memory&&t,r=!0,c=s||0,s=0,a=l.length,o=!0;l&&c<a;c++)if(!1===l[c].apply(t[0],t[1])&&e.stopOnFalse){i=!1;break}o=!1,l&&(u?u.length&&h(u.shift()):i?l=[]:d.disable())},d={add:function(){if(l){var t=l.length;!function t(i){ne.each(i,function(i,n){var r=ne.type(n);"function"===r?e.unique&&d.has(n)||l.push(n):n&&n.length&&"string"!==r&&t(n)})}(arguments),o?a=l.length:i&&(s=t,h(i))}return this},remove:function(){return l&&ne.each(arguments,function(e,t){for(var i;(i=ne.inArray(t,l,i))>-1;)l.splice(i,1),o&&(i<=a&&a--,i<=c&&c--)}),this},has:function(e){return e?ne.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=u=i=t,this},disabled:function(){return!l},lock:function(){return u=t,i||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||r&&!u||(t=[e,(t=t||[]).slice?t.slice():t],o?u.push(t):h(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!r}};return d},ne.extend({Deferred:function(e){var t=[["resolve","done",ne.Callbacks("once memory"),"resolved"],["reject","fail",ne.Callbacks("once memory"),"rejected"],["notify","progress",ne.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ne.Deferred(function(i){ne.each(t,function(t,o){var s=o[0],a=ne.isFunction(e[t])&&e[t];r[o[1]](function(){var e=a&&a.apply(this,arguments);e&&ne.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s+"With"](this===n?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ne.extend(e,n):n}},r={};return n.pipe=n.then,ne.each(t,function(e,o){var s=o[2],a=o[3];n[o[1]]=s.add,a&&s.add(function(){i=a},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=s.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t,i,n,r=0,o=J.call(arguments),s=o.length,a=1!==s||e&&ne.isFunction(e.promise)?s:0,c=1===a?e:ne.Deferred(),l=function(e,i,n){return function(r){i[e]=this,n[e]=arguments.length>1?J.call(arguments):r,n===t?c.notifyWith(i,n):--a||c.resolveWith(i,n)}};if(s>1)for(t=new Array(s),i=new Array(s),n=new Array(s);r<s;r++)o[r]&&ne.isFunction(o[r].promise)?o[r].promise().done(l(r,n,o)).fail(c.reject).progress(l(r,i,t)):--a;return a||c.resolveWith(n,o),c.promise()}}),ne.support=function(t){var i=Y.createElement("input"),n=Y.createDocumentFragment(),r=Y.createElement("div"),o=Y.createElement("select"),s=o.appendChild(Y.createElement("option"));return i.type?(i.type="checkbox",t.checkOn=""!==i.value,t.optSelected=s.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,i.checked=!0,t.noCloneChecked=i.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!s.disabled,i=Y.createElement("input"),i.value="t",i.type="radio",t.radioValue="t"===i.value,i.setAttribute("checked","t"),i.setAttribute("name","t"),n.appendChild(i),t.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===r.style.backgroundClip,ne(function(){var i,n,o=Y.getElementsByTagName("body")[0];o&&((i=Y.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(i).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",ne.swap(o,null!=o.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===r.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(r,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(r,null)||{width:"4px"}).width,(n=r.appendChild(Y.createElement("div"))).style.cssText=r.style.cssText="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",n.style.marginRight=n.style.width="0",r.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),o.removeChild(i))}),t):t}({});var pe,_e,fe=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,me=/([A-Z])/g;r.uid=1,r.accepts=function(e){return!e.nodeType||(1===e.nodeType||9===e.nodeType)},r.prototype={key:function(e){if(!r.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=r.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(n){t[this.expando]=i,ne.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var n,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=i;else if(ne.isEmptyObject(o))ne.extend(this.cache[r],t);else for(n in t)o[n]=t[n];return o},get:function(e,i){var n=this.cache[this.key(e)];return i===t?n:n[i]},access:function(e,i,n){var r;return i===t||i&&"string"==typeof i&&n===t?(r=this.get(e,i))!==t?r:this.get(e,ne.camelCase(i)):(this.set(e,i,n),n!==t?n:i)},remove:function(e,i){var n,r,o,s=this.key(e),a=this.cache[s];if(i===t)this.cache[s]={};else{ne.isArray(i)?r=i.concat(i.map(ne.camelCase)):(o=ne.camelCase(i),r=i in a?[i,o]:(r=o)in a?[r]:r.match(oe)||[]),n=r.length;for(;n--;)delete a[r[n]]}},hasData:function(e){return!ne.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},pe=new r,_e=new r,ne.extend({acceptData:r.accepts,hasData:function(e){return pe.hasData(e)||_e.hasData(e)},data:function(e,t,i){return pe.access(e,t,i)},removeData:function(e,t){pe.remove(e,t)},_data:function(e,t,i){return _e.access(e,t,i)},_removeData:function(e,t){_e.remove(e,t)}}),ne.fn.extend({data:function(e,i){var n,r,s=this[0],a=0,c=null;if(e===t){if(this.length&&(c=pe.get(s),1===s.nodeType&&!_e.get(s,"hasDataAttrs"))){for(n=s.attributes;a<n.length;a++)0===(r=n[a].name).indexOf("data-")&&(r=ne.camelCase(r.slice(5)),o(s,r,c[r]));_e.set(s,"hasDataAttrs",!0)}return c}return"object"==typeof e?this.each(function(){pe.set(this,e)}):ne.access(this,function(i){var n,r=ne.camelCase(e);if(s&&i===t){if((n=pe.get(s,e))!==t)return n;if((n=pe.get(s,r))!==t)return n;if((n=o(s,r,t))!==t)return n}else this.each(function(){var n=pe.get(this,r);pe.set(this,r,i),-1!==e.indexOf("-")&&n!==t&&pe.set(this,e,i)})},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){pe.remove(this,e)})}}),ne.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=_e.get(e,t),i&&(!n||ne.isArray(i)?n=_e.access(e,t,ne.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=ne.queue(e,t),n=i.length,r=i.shift(),o=ne._queueHooks(e,t);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,function(){ne.dequeue(e,t)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return _e.get(e,i)||_e.access(e,i,{empty:ne.Callbacks("once memory").add(function(){_e.remove(e,[t+"queue",i])})})}}),ne.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),arguments.length<n?ne.queue(this[0],e):i===t?this:this.each(function(){var t=ne.queue(this,e,i);ne._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ne.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ne.dequeue(this,e)})},delay:function(e,t){return e=ne.fx?ne.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,r=1,o=ne.Deferred(),s=this,a=this.length,c=function(){--r||o.resolveWith(s,[s])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";a--;)(n=_e.get(s[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(c));return c(),o.promise(i)}});var ge,ye=/[\t\r\n\f]/g,Te=/\r/g,ve=/^(?:input|select|textarea|button)$/i;ne.fn.extend({attr:function(e,t){return ne.access(this,ne.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ne.removeAttr(this,e)})},prop:function(e,t){return ne.access(this,ne.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ne.propFix[e]||e]})},addClass:function(e){var t,i,n,r,o,s=0,a=this.length,c="string"==typeof e&&e;if(ne.isFunction(e))return this.each(function(t){ne(this).addClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(oe)||[];s<a;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ye," "):" ")){for(o=0;r=t[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");i.className=ne.trim(n)}return this},removeClass:function(e){var t,i,n,r,o,s=0,a=this.length,c=0===arguments.length||"string"==typeof e&&e;if(ne.isFunction(e))return this.each(function(t){ne(this).removeClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(oe)||[];s<a;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ye," "):"")){for(o=0;r=t[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");i.className=e?ne.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):ne.isFunction(e)?this.each(function(i){ne(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var t,n=0,r=ne(this),o=e.match(oe)||[];t=o[n++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else i!==G&&"boolean"!==i||(this.className&&_e.set(this,"__className__",this.className),this.className=this.className||!1===e?"":_e.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(ye," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,r,o=this[0];if(arguments.length)return r=ne.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(null==(o=r?e.call(this,n,ne(this).val()):e)?o="":"number"==typeof o?o+="":ne.isArray(o)&&(o=ne.map(o,function(e){return null==e?"":e+""})),(i=ne.valHooks[this.type]||ne.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&i.set(this,o,"value")!==t||(this.value=o))});if(o)return(i=ne.valHooks[o.type]||ne.valHooks[o.nodeName.toLowerCase()])&&"get"in i&&(n=i.get(o,"value"))!==t?n:"string"==typeof(n=o.value)?n.replace(Te,""):null==n?"":n}}),ne.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,o="select-one"===e.type||r<0,s=o?null:[],a=o?r+1:n.length,c=r<0?a:o?r:0;c<a;c++)if(((i=n[c]).selected||c===r)&&(ne.support.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!ne.nodeName(i.parentNode,"optgroup"))){if(t=ne(i).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var i,n,r=e.options,o=ne.makeArray(t),s=r.length;s--;)((n=r[s]).selected=ne.inArray(ne(n).val(),o)>=0)&&(i=!0);return i||(e.selectedIndex=-1),o}}},attr:function(e,i,n){var r,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===G?ne.prop(e,i,n):(1===s&&ne.isXMLDoc(e)||(i=i.toLowerCase(),r=ne.attrHooks[i]||(ne.expr.match.bool.test(i)?ge:void 0)),n===t?r&&"get"in r&&null!==(o=r.get(e,i))?o:null==(o=ne.find.attr(e,i))?t:o:null!==n?r&&"set"in r&&(o=r.set(e,n,i))!==t?o:(e.setAttribute(i,n+""),n):void ne.removeAttr(e,i))},removeAttr:function(e,t){var i,n,r=0,o=t&&t.match(oe);if(o&&1===e.nodeType)for(;i=o[r++];)n=ne.propFix[i]||i,ne.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!ne.support.radioValue&&"radio"===t&&ne.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{for:"htmlFor",class:"className"},prop:function(e,i,n){var r,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return(1!==s||!ne.isXMLDoc(e))&&(i=ne.propFix[i]||i,o=ne.propHooks[i]),n!==t?o&&"set"in o&&(r=o.set(e,n,i))!==t?r:e[i]=n:o&&"get"in o&&null!==(r=o.get(e,i))?r:e[i]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||ve.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),ge={set:function(e,t,i){return!1===t?ne.removeAttr(e,i):e.setAttribute(i,i),i}},ne.each(ne.expr.match.bool.source.match(/\w+/g),function(e,i){var n=ne.expr.attrHandle[i]||ne.find.attr;ne.expr.attrHandle[i]=function(e,i,r){var o=ne.expr.attrHandle[i],s=r?t:(ne.expr.attrHandle[i]=t)!=n(e,i,r)?i.toLowerCase():null;return ne.expr.attrHandle[i]=o,s}}),ne.support.optSelected||(ne.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),ne.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ne.propFix[this.toLowerCase()]=this}),ne.each(["radio","checkbox"],function(){ne.valHooks[this]={set:function(e,t){if(ne.isArray(t))return e.checked=ne.inArray(ne(e).val(),t)>=0}},ne.support.checkOn||(ne.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Se=/^key/,Ce=/^(?:mouse|contextmenu)|click/,Ee=/^(?:focusinfocus|focusoutblur)$/,be=/^([^.]*)(?:\.(.+)|)$/;ne.event={global:{},add:function(e,i,n,r,o){var s,a,c,l,u,h,d,p,_,f,m,g=_e.get(e);if(g){for(n.handler&&(n=(s=n).handler,o=s.selector),n.guid||(n.guid=ne.guid++),(l=g.events)||(l=g.events={}),(a=g.handle)||((a=g.handle=function(e){return typeof ne===G||e&&ne.event.triggered===e.type?t:ne.event.dispatch.apply(a.elem,arguments)}).elem=e),u=(i=(i||"").match(oe)||[""]).length;u--;)_=m=(c=be.exec(i[u])||[])[1],f=(c[2]||"").split(".").sort(),_&&(d=ne.event.special[_]||{},_=(o?d.delegateType:d.bindType)||_,d=ne.event.special[_]||{},h=ne.extend({type:_,origType:m,data:r,handler:n,guid:n.guid,selector:o,needsContext:o&&ne.expr.match.needsContext.test(o),namespace:f.join(".")},s),(p=l[_])||((p=l[_]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,r,f,a)||e.addEventListener&&e.addEventListener(_,a,!1)),d.add&&(d.add.call(e,h),h.handler.guid||(h.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,h):p.push(h),ne.event.global[_]=!0);e=null}},remove:function(e,t,i,n,r){var o,s,a,c,l,u,h,d,p,_,f,m=_e.hasData(e)&&_e.get(e);if(m&&(c=m.events)){for(l=(t=(t||"").match(oe)||[""]).length;l--;)if(a=be.exec(t[l])||[],p=f=a[1],_=(a[2]||"").split(".").sort(),p){for(h=ne.event.special[p]||{},d=c[p=(n?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+_.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!r&&f!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,_,m.handle)||ne.removeEvent(e,p,m.handle),delete c[p])}else for(p in c)ne.event.remove(e,p+t[l],i,n,!0);ne.isEmptyObject(c)&&(delete m.handle,_e.remove(e,"events"))}},trigger:function(i,n,r,o){var s,a,c,l,u,h,d,p=[r||Y],_=te.call(i,"type")?i.type:i,f=te.call(i,"namespace")?i.namespace.split("."):[];if(a=c=r=r||Y,3!==r.nodeType&&8!==r.nodeType&&!Ee.test(_+ne.event.triggered)&&(_.indexOf(".")>=0&&(_=(f=_.split(".")).shift(),f.sort()),u=_.indexOf(":")<0&&"on"+_,i=i[ne.expando]?i:new ne.Event(_,"object"==typeof i&&i),i.isTrigger=o?2:3,i.namespace=f.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=r),n=null==n?[i]:ne.makeArray(n,[i]),d=ne.event.special[_]||{},o||!d.trigger||!1!==d.trigger.apply(r,n))){if(!o&&!d.noBubble&&!ne.isWindow(r)){for(l=d.delegateType||_,Ee.test(l+_)||(a=a.parentNode);a;a=a.parentNode)p.push(a),c=a;c===(r.ownerDocument||Y)&&p.push(c.defaultView||c.parentWindow||e)}for(s=0;(a=p[s++])&&!i.isPropagationStopped();)i.type=s>1?l:d.bindType||_,(h=(_e.get(a,"events")||{})[i.type]&&_e.get(a,"handle"))&&h.apply(a,n),(h=u&&a[u])&&ne.acceptData(a)&&h.apply&&!1===h.apply(a,n)&&i.preventDefault();return i.type=_,o||i.isDefaultPrevented()||d._default&&!1!==d._default.apply(p.pop(),n)||!ne.acceptData(r)||u&&ne.isFunction(r[_])&&!ne.isWindow(r)&&((c=r[u])&&(r[u]=null),ne.event.triggered=_,r[_](),ne.event.triggered=t,c&&(r[u]=c)),i.result}},dispatch:function(e){e=ne.event.fix(e);var i,n,r,o,s,a=[],c=J.call(arguments),l=(_e.get(this,"events")||{})[e.type]||[],u=ne.event.special[e.type]||{};if(c[0]=e,e.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(a=ne.event.handlers.call(this,e,l),i=0;(o=a[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(s=o.handlers[n++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(s.namespace)||(e.handleObj=s,e.data=s.data,(r=((ne.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,c))!==t&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,i){var n,r,o,s,a=[],c=i.delegateCount,l=e.target;if(c&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==e.type){for(r=[],n=0;n<c;n++)r[o=(s=i[n]).selector+" "]===t&&(r[o]=s.needsContext?ne(o,this).index(l)>=0:ne.find(o,this,null,[l]).length),r[o]&&r.push(s);r.length&&a.push({elem:l,handlers:r})}return c<i.length&&a.push({elem:this,handlers:i.slice(c)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,r,o,s=i.button;return null==e.pageX&&null!=i.clientX&&(r=(n=e.target.ownerDocument||Y).documentElement,o=n.body,e.pageX=i.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=i.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[ne.expando])return e;var t,i,n,r=e.type,o=e,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=Ce.test(r)?this.mouseHooks:Se.test(r)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,e=new ne.Event(o),t=n.length;t--;)e[i=n[t]]=o[i];return e.target||(e.target=Y),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==c()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===c()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&ne.nodeName(this,"input"))return this.click(),!1},_default:function(e){return ne.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var r=ne.extend(new ne.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?ne.event.trigger(r,null,t):ne.event.dispatch.call(t,r),r.isDefaultPrevented()&&i.preventDefault()}},ne.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},ne.Event=function(e,t){if(!(this instanceof ne.Event))return new ne.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?s:a):this.type=e,t&&ne.extend(this,t),this.timeStamp=e&&e.timeStamp||ne.now(),this[ne.expando]=!0},ne.Event.prototype={isDefaultPrevented:a,isPropagationStopped:a,isImmediatePropagationStopped:a,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=s,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=s,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=s,this.stopPropagation()}},ne.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ne.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,r=e.relatedTarget,o=e.handleObj;return r&&(r===n||ne.contains(n,r))||(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),ne.support.focusinBubbles||ne.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){ne.event.simulate(t,e.target,ne.event.fix(e),!0)};ne.event.special[t]={setup:function(){0==i++&&Y.addEventListener(e,n,!0)},teardown:function(){0==--i&&Y.removeEventListener(e,n,!0)}}}),ne.fn.extend({on:function(e,i,n,r,o){var s,c;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(c in e)this.on(c,i,n,e[c],o);return this}if(null==n&&null==r?(r=i,n=i=t):null==r&&("string"==typeof i?(r=n,n=t):(r=n,n=i,i=t)),!1===r)r=a;else if(!r)return this;return 1===o&&(s=r,(r=function(e){return ne().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=ne.guid++)),this.each(function(){ne.event.add(this,e,r,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ne(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return!1!==i&&"function"!=typeof i||(n=i,i=t),!1===n&&(n=a),this.each(function(){ne.event.remove(this,e,n,i)})},trigger:function(e,t){return this.each(function(){ne.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return ne.event.trigger(e,t,i,!0)}});var Ae=/^.[^:#\[\.,]*$/,xe=/^(?:parents|prev(?:Until|All))/,Re=ne.expr.match.needsContext,Pe={children:!0,contents:!0,next:!0,prev:!0};ne.fn.extend({find:function(e){var t,i=[],n=this,r=n.length;if("string"!=typeof e)return this.pushStack(ne(e).filter(function(){for(t=0;t<r;t++)if(ne.contains(n[t],this))return!0}));for(t=0;t<r;t++)ne.find(e,n[t],i);return i=this.pushStack(r>1?ne.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},has:function(e){var t=ne(e,this),i=t.length;return this.filter(function(){for(var e=0;e<i;e++)if(ne.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(u(this,e||[],!0))},filter:function(e){return this.pushStack(u(this,e||[],!1))},is:function(e){return!!u(this,"string"==typeof e&&Re.test(e)?ne(e):e||[],!1).length},closest:function(e,t){for(var i,n=0,r=this.length,o=[],s=Re.test(e)||"string"!=typeof e?ne(e,t||this.context):0;n<r;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&ne.find.matchesSelector(i,e))){i=o.push(i);break}return this.pushStack(o.length>1?ne.unique(o):o)},index:function(e){return e?"string"==typeof e?$.call(ne(e),this[0]):$.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?ne(e,t):ne.makeArray(e&&e.nodeType?[e]:e),n=ne.merge(this.get(),i);return this.pushStack(ne.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ne.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ne.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ne.dir(e,"parentNode",i)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return ne.dir(e,"nextSibling")},prevAll:function(e){return ne.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ne.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ne.dir(e,"previousSibling",i)},siblings:function(e){return ne.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ne.sibling(e.firstChild)},contents:function(e){return e.contentDocument||ne.merge([],e.childNodes)}},function(e,t){ne.fn[e]=function(i,n){var r=ne.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=ne.filter(n,r)),this.length>1&&(Pe[e]||ne.unique(r),xe.test(e)&&r.reverse()),this.pushStack(r)}}),ne.extend({filter:function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?ne.find.matchesSelector(n,e)?[n]:[]:ne.find.matches(e,ne.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,i,n){for(var r=[],o=n!==t;(e=e[i])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&ne(e).is(n))break;r.push(e)}return r},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Ie=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,we=/<([\w:]+)/,Ne=/<|&#?\w+;/,Le=/<(?:script|style|link)/i,Oe=/^(?:checkbox|radio)$/i,De=/checked\s*(?:[^=]|=\s*.checked.)/i,Fe=/^$|\/(?:java|ecma)script/i,Be=/^true\/(.*)/,Me=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ke={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ke.optgroup=ke.option,ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,ne.fn.extend({text:function(e){return ne.access(this,function(e){return e===t?ne.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Y).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||h(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?ne.filter(e,this):this,r=0;null!=(i=n[r]);r++)t||1!==i.nodeType||ne.cleanData(m(i)),i.parentNode&&(t&&ne.contains(i.ownerDocument,i)&&_(m(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ne.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ne.clone(this,e,t)})},html:function(e){return ne.access(this,function(e){var i=this[0]||{},n=0,r=this.length;if(e===t&&1===i.nodeType)return i.innerHTML;if("string"==typeof e&&!Le.test(e)&&!ke[(we.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ie,"<$1></$2>");try{for(;n<r;n++)1===(i=this[n]||{}).nodeType&&(ne.cleanData(m(i,!1)),i.innerHTML=e);i=0}catch(e){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ne.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(i){var n=e[t++],r=e[t++];r&&(n&&n.parentNode!==r&&(n=this.nextSibling),ne(this).remove(),r.insertBefore(i,n))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,i){e=Q.apply([],e);var n,r,o,s,a,c,l=0,u=this.length,h=this,_=u-1,f=e[0],g=ne.isFunction(f);if(g||!(u<=1||"string"!=typeof f||ne.support.checkClone)&&De.test(f))return this.each(function(n){var r=h.eq(n);g&&(e[0]=f.call(this,n,r.html())),r.domManip(e,t,i)});if(u&&(n=ne.buildFragment(e,this[0].ownerDocument,!1,!i&&this),r=n.firstChild,1===n.childNodes.length&&(n=r),r)){for(s=(o=ne.map(m(n,"script"),d)).length;l<u;l++)a=n,l!==_&&(a=ne.clone(a,!0,!0),s&&ne.merge(o,m(a,"script"))),t.call(this[l],a,l);if(s)for(c=o[o.length-1].ownerDocument,ne.map(o,p),l=0;l<s;l++)a=o[l],Fe.test(a.type||"")&&!_e.access(a,"globalEval")&&ne.contains(c,a)&&(a.src?ne._evalUrl(a.src):ne.globalEval(a.textContent.replace(Me,"")))}return this}}),ne.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ne.fn[e]=function(e){for(var i,n=[],r=ne(e),o=r.length-1,s=0;s<=o;s++)i=s===o?this:this.clone(!0),ne(r[s])[t](i),Z.apply(n,i.get());return this.pushStack(n)}}),ne.extend({clone:function(e,t,i){var n,r,o,s,a=e.cloneNode(!0),c=ne.contains(e.ownerDocument,e);if(!(ne.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ne.isXMLDoc(e)))for(s=m(a),n=0,r=(o=m(e)).length;n<r;n++)g(o[n],s[n]);if(t)if(i)for(o=o||m(e),s=s||m(a),n=0,r=o.length;n<r;n++)f(o[n],s[n]);else f(e,a);return(s=m(a,"script")).length>0&&_(s,!c&&m(e,"script")),a},buildFragment:function(e,t,i,n){for(var r,o,s,a,c,l,u=0,h=e.length,d=t.createDocumentFragment(),p=[];u<h;u++)if((r=e[u])||0===r)if("object"===ne.type(r))ne.merge(p,r.nodeType?[r]:r);else if(Ne.test(r)){for(o=o||d.appendChild(t.createElement("div")),s=(we.exec(r)||["",""])[1].toLowerCase(),a=ke[s]||ke._default,o.innerHTML=a[1]+r.replace(Ie,"<$1></$2>")+a[2],l=a[0];l--;)o=o.lastChild;ne.merge(p,o.childNodes),(o=d.firstChild).textContent=""}else p.push(t.createTextNode(r));for(d.textContent="",u=0;r=p[u++];)if((!n||-1===ne.inArray(r,n))&&(c=ne.contains(r.ownerDocument,r),o=m(d.appendChild(r),"script"),c&&_(o),i))for(l=0;r=o[l++];)Fe.test(r.type||"")&&i.push(r);return d},cleanData:function(e){for(var i,n,o,s,a,c,l=ne.event.special,u=0;(n=e[u])!==t;u++){if(r.accepts(n)&&(a=n[_e.expando])&&(i=_e.cache[a])){if((o=Object.keys(i.events||{})).length)for(c=0;(s=o[c])!==t;c++)l[s]?ne.event.remove(n,s):ne.removeEvent(n,s,i.handle);_e.cache[a]&&delete _e.cache[a]}delete pe.cache[n[pe.expando]]}},_evalUrl:function(e){return ne.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})}}),ne.fn.extend({wrapAll:function(e){var t;return ne.isFunction(e)?this.each(function(t){ne(this).wrapAll(e.call(this,t))}):(this[0]&&(t=ne(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return ne.isFunction(e)?this.each(function(t){ne(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ne(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ne.isFunction(e);return this.each(function(i){ne(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ne.nodeName(this,"body")||ne(this).replaceWith(this.childNodes)}).end()}});var We,Ve,ze=/^(none|table(?!-c[ea]).+)/,Ge=/^margin/,Ue=new RegExp("^("+re+")(.*)$","i"),Ye=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),He=new RegExp("^([+-])=("+re+")","i"),Xe={BODY:"block"},qe={position:"absolute",visibility:"hidden",display:"block"},je={letterSpacing:0,fontWeight:400},Ke=["Top","Right","Bottom","Left"],Qe=["Webkit","O","Moz","ms"];ne.fn.extend({css:function(e,i){return ne.access(this,function(e,i,n){var r,o,s={},a=0;if(ne.isArray(i)){for(r=v(e),o=i.length;a<o;a++)s[i[a]]=ne.css(e,i[a],!1,r);return s}return n!==t?ne.style(e,i,n):ne.css(e,i)},e,i,arguments.length>1)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){T(this)?ne(this).show():ne(this).hide()})}}),ne.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=We(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,i,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,s,a,c=ne.camelCase(i),l=e.style;if(i=ne.cssProps[c]||(ne.cssProps[c]=y(l,c)),a=ne.cssHooks[i]||ne.cssHooks[c],n===t)return a&&"get"in a&&(o=a.get(e,!1,r))!==t?o:l[i];"string"==(s=typeof n)&&(o=He.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(ne.css(e,i)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||ne.cssNumber[c]||(n+="px"),ne.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(l[i]="inherit"),a&&"set"in a&&(n=a.set(e,n,r))===t||(l[i]=n))}},css:function(e,i,n,r){var o,s,a,c=ne.camelCase(i);return i=ne.cssProps[c]||(ne.cssProps[c]=y(e.style,c)),(a=ne.cssHooks[i]||ne.cssHooks[c])&&"get"in a&&(o=a.get(e,!0,n)),o===t&&(o=We(e,i,r)),"normal"===o&&i in je&&(o=je[i]),""===n||n?(s=parseFloat(o),!0===n||ne.isNumeric(s)?s||0:o):o}}),We=function(e,i,n){var r,o,s,a=n||v(e),c=a?a.getPropertyValue(i)||a[i]:t,l=e.style;return a&&(""!==c||ne.contains(e.ownerDocument,e)||(c=ne.style(e,i)),Ye.test(c)&&Ge.test(i)&&(r=l.width,o=l.minWidth,s=l.maxWidth,l.minWidth=l.maxWidth=l.width=c,c=a.width,l.width=r,l.minWidth=o,l.maxWidth=s)),c},ne.each(["height","width"],function(e,t){ne.cssHooks[t]={get:function(e,i,n){if(i)return 0===e.offsetWidth&&ze.test(ne.css(e,"display"))?ne.swap(e,qe,function(){return b(e,t,n)}):b(e,t,n)},set:function(e,i,n){var r=n&&v(e);return C(0,i,n?E(e,t,n,ne.support.boxSizing&&"border-box"===ne.css(e,"boxSizing",!1,r),r):0)}}}),ne(function(){ne.support.reliableMarginRight||(ne.cssHooks.marginRight={get:function(e,t){if(t)return ne.swap(e,{display:"inline-block"},We,[e,"marginRight"])}}),!ne.support.pixelPosition&&ne.fn.position&&ne.each(["top","left"],function(e,t){ne.cssHooks[t]={get:function(e,i){if(i)return i=We(e,t),Ye.test(i)?ne(e).position()[t]+"px":i}}})}),ne.expr&&ne.expr.filters&&(ne.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},ne.expr.filters.visible=function(e){return!ne.expr.filters.hidden(e)}),ne.each({margin:"",padding:"",border:"Width"},function(e,t){ne.cssHooks[e+t]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[e+Ke[n]+t]=o[n]||o[n-2]||o[0];return r}},Ge.test(e)||(ne.cssHooks[e+t].set=C)});var Ze=/%20/g,Je=/\[\]$/,$e=/\r?\n/g,et=/^(?:submit|button|image|reset|file)$/i,tt=/^(?:input|select|textarea|keygen)/i;ne.fn.extend({serialize:function(){return ne.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ne.prop(this,"elements");return e?ne.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ne(this).is(":disabled")&&tt.test(this.nodeName)&&!et.test(e)&&(this.checked||!Oe.test(e))}).map(function(e,t){var i=ne(this).val();return null==i?null:ne.isArray(i)?ne.map(i,function(e){return{name:t.name,value:e.replace($e,"\r\n")}}):{name:t.name,value:i.replace($e,"\r\n")}}).get()}}),ne.param=function(e,i){var n,r=[],o=function(e,t){t=ne.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=ne.ajaxSettings&&ne.ajaxSettings.traditional),ne.isArray(e)||e.jquery&&!ne.isPlainObject(e))ne.each(e,function(){o(this.name,this.value)});else for(n in e)R(n,e[n],i,o);return r.join("&").replace(Ze,"+")},ne.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ne.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ne.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var it,nt,rt=ne.now(),ot=/\?/,st=/#.*$/,at=/([?&])_=[^&]*/,ct=/^(.*?):[ \t]*([^\r\n]*)$/gm,lt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ut=/^(?:GET|HEAD)$/,ht=/^\/\//,dt=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,pt=ne.fn.load,_t={},ft={},mt="*/".concat("*");try{nt=U.href}catch(e){(nt=Y.createElement("a")).href="",nt=nt.href}it=dt.exec(nt.toLowerCase())||[],ne.fn.load=function(e,i,n){if("string"!=typeof e&&pt)return pt.apply(this,arguments);var r,o,s,a=this,c=e.indexOf(" ");return c>=0&&(r=e.slice(c),e=e.slice(0,c)),ne.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(o="POST"),a.length>0&&ne.ajax({url:e,type:o,dataType:"html",data:i}).done(function(e){s=arguments,a.html(r?ne("<div>").append(ne.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){a.each(n,s||[e.responseText,t,e])}),this},ne.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ne.fn[t]=function(e){return this.on(t,e)}}),ne.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:nt,type:"GET",isLocal:lt.test(it[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":mt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ne.parseJSON,"text xml":ne.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?w(w(e,ne.ajaxSettings),t):w(ne.ajaxSettings,e)},ajaxPrefilter:P(_t),ajaxTransport:P(ft),ajax:function(e,i){function n(e,i,n,a){var l,h,y,T,S,E=i;2!==v&&(v=2,c&&clearTimeout(c),r=t,s=a||"",C.readyState=e>0?4:0,l=e>=200&&e<300||304===e,n&&(T=N(d,C,n)),T=L(d,T,C,l),l?(d.ifModified&&((S=C.getResponseHeader("Last-Modified"))&&(ne.lastModified[o]=S),(S=C.getResponseHeader("etag"))&&(ne.etag[o]=S)),204===e||"HEAD"===d.type?E="nocontent":304===e?E="notmodified":(E=T.state,h=T.data,l=!(y=T.error))):(y=E,!e&&E||(E="error",e<0&&(e=0))),C.status=e,C.statusText=(i||E)+"",l?f.resolveWith(p,[h,E,C]):f.rejectWith(p,[C,E,y]),C.statusCode(g),g=t,u&&_.trigger(l?"ajaxSuccess":"ajaxError",[C,d,l?h:y]),m.fireWith(p,[C,E]),u&&(_.trigger("ajaxComplete",[C,d]),--ne.active||ne.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var r,o,s,a,c,l,u,h,d=ne.ajaxSetup({},i),p=d.context||d,_=d.context&&(p.nodeType||p.jquery)?ne(p):ne.event,f=ne.Deferred(),m=ne.Callbacks("once memory"),g=d.statusCode||{},y={},T={},v=0,S="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!a)for(a={};t=ct.exec(s);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?s:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return v||(e=T[i]=T[i]||e,y[e]=t),this},overrideMimeType:function(e){return v||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(v<2)for(t in e)g[t]=[g[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){var t=e||S;return r&&r.abort(t),n(0,t),this}};if(f.promise(C).complete=m.add,C.success=C.done,C.error=C.fail,d.url=((e||d.url||nt)+"").replace(st,"").replace(ht,it[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=ne.trim(d.dataType||"*").toLowerCase().match(oe)||[""],null==d.crossDomain&&(l=dt.exec(d.url.toLowerCase()),d.crossDomain=!(!l||l[1]===it[1]&&l[2]===it[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(it[3]||("http:"===it[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ne.param(d.data,d.traditional)),I(_t,d,i,C),2===v)return C;(u=d.global)&&0==ne.active++&&ne.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!ut.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(ot.test(o)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=at.test(o)?o.replace(at,"$1_="+rt++):o+(ot.test(o)?"&":"?")+"_="+rt++)),d.ifModified&&(ne.lastModified[o]&&C.setRequestHeader("If-Modified-Since",ne.lastModified[o]),ne.etag[o]&&C.setRequestHeader("If-None-Match",ne.etag[o])),(d.data&&d.hasContent&&!1!==d.contentType||i.contentType)&&C.setRequestHeader("Content-Type",d.contentType),C.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+mt+"; q=0.01":""):d.accepts["*"]);for(h in d.headers)C.setRequestHeader(h,d.headers[h]);if(d.beforeSend&&(!1===d.beforeSend.call(p,C,d)||2===v))return C.abort();S="abort";for(h in{success:1,error:1,complete:1})C[h](d[h]);if(r=I(ft,d,i,C)){C.readyState=1,u&&_.trigger("ajaxSend",[C,d]),d.async&&d.timeout>0&&(c=setTimeout(function(){C.abort("timeout")},d.timeout));try{v=1,r.send(y,n)}catch(e){if(!(v<2))throw e;n(-1,e)}}else n(-1,"No Transport");return C},getJSON:function(e,t,i){return ne.get(e,t,i,"json")},getScript:function(e,i){return ne.get(e,t,i,"script")}}),ne.each(["get","post"],function(e,i){ne[i]=function(e,n,r,o){return ne.isFunction(n)&&(o=o||r,r=n,n=t),ne.ajax({url:e,type:i,dataType:o,data:n,success:r})}}),ne.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ne.globalEval(e),e}}}),ne.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ne.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,r){t=ne("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&r("error"===e.type?404:200,e.type)}),Y.head.appendChild(t[0])},abort:function(){i&&i()}}}});var gt=[],yt=/(=)\?(?=&|$)|\?\?/;ne.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=gt.pop()||ne.expando+"_"+rt++;return this[e]=!0,e}}),ne.ajaxPrefilter("json jsonp",function(i,n,r){var o,s,a,c=!1!==i.jsonp&&(yt.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&yt.test(i.data)&&"data");if(c||"jsonp"===i.dataTypes[0])return o=i.jsonpCallback=ne.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,c?i[c]=i[c].replace(yt,"$1"+o):!1!==i.jsonp&&(i.url+=(ot.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return a||ne.error(o+" was not called"),a[0]},i.dataTypes[0]="json",s=e[o],e[o]=function(){a=arguments},r.always(function(){e[o]=s,i[o]&&(i.jsonpCallback=n.jsonpCallback,gt.push(o)),a&&ne.isFunction(s)&&s(a[0]),a=s=t}),"script"}),ne.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Tt=ne.ajaxSettings.xhr(),vt={0:200,1223:204},St=0,Ct={};e.ActiveXObject&&ne(e).on("unload",function(){for(var e in Ct)Ct[e]();Ct=t}),ne.support.cors=!!Tt&&"withCredentials"in Tt,ne.support.ajax=Tt=!!Tt,ne.ajaxTransport(function(e){var i;if(ne.support.cors||Tt&&!e.crossDomain)return{send:function(n,r){var o,s,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(o in n)a.setRequestHeader(o,n[o]);i=function(e){return function(){i&&(delete Ct[s],i=a.onload=a.onerror=null,"abort"===e?a.abort():"error"===e?r(a.status||404,a.statusText):r(vt[a.status]||a.status,a.statusText,"string"==typeof a.responseText?{text:a.responseText}:t,a.getAllResponseHeaders()))}},a.onload=i(),a.onerror=i("error"),i=Ct[s=St++]=i("abort"),a.send(e.hasContent&&e.data||null)},abort:function(){i&&i()}}});var Et,bt,At=/^(?:toggle|show|hide)$/,xt=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),Rt=/queueHooks$/,Pt=[function(e,i,n){var r,o,s,a,c,l,u=this,h={},d=e.style,p=e.nodeType&&T(e),_=_e.get(e,"fxshow");n.queue||(null==(c=ne._queueHooks(e,"fx")).unqueued&&(c.unqueued=0,l=c.empty.fire,c.empty.fire=function(){c.unqueued||l()}),c.unqueued++,u.always(function(){u.always(function(){c.unqueued--,ne.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in i||"width"in i)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===ne.css(e,"display")&&"none"===ne.css(e,"float")&&(d.display="inline-block")),n.overflow&&(d.overflow="hidden",u.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(r in i)if(o=i[r],At.exec(o)){if(delete i[r],s=s||"toggle"===o,o===(p?"hide":"show")){if("show"!==o||!_||_[r]===t)continue;p=!0}h[r]=_&&_[r]||ne.style(e,r)}if(!ne.isEmptyObject(h)){_?"hidden"in _&&(p=_.hidden):_=_e.access(e,"fxshow",{}),s&&(_.hidden=!p),p?ne(e).show():u.done(function(){ne(e).hide()}),u.done(function(){var t;_e.remove(e,"fxshow");for(t in h)ne.style(e,t,h[t])});for(r in h)a=D(p?_[r]:0,r,u),r in _||(_[r]=a.start,p&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}}],It={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),r=xt.exec(t),o=r&&r[3]||(ne.cssNumber[e]?"":"px"),s=(ne.cssNumber[e]||"px"!==o&&+n)&&xt.exec(ne.css(i.elem,e)),a=1,c=20;if(s&&s[3]!==o){o=o||s[3],r=r||[],s=+n||1;do{s/=a=a||".5",ne.style(i.elem,e,s+o)}while(a!==(a=i.cur()/n)&&1!==a&&--c)}return r&&(s=i.start=+s||+n||0,i.unit=o,i.end=r[1]?s+(r[1]+1)*r[2]:+r[2]),i}]};ne.Animation=ne.extend(F,{tweener:function(e,t){ne.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,r=e.length;n<r;n++)i=e[n],It[i]=It[i]||[],It[i].unshift(t)},prefilter:function(e,t){t?Pt.unshift(e):Pt.push(e)}}),ne.Tween=M,M.prototype={constructor:M,init:function(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(ne.cssNumber[i]?"":"px")},cur:function(){var e=M.propHooks[this.prop];return e&&e.get?e.get(this):M.propHooks._default.get(this)},run:function(e){var t,i=M.propHooks[this.prop];return this.options.duration?this.pos=t=ne.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):M.propHooks._default.set(this),this}},M.prototype.init.prototype=M.prototype,M.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ne.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){ne.fx.step[e.prop]?ne.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ne.cssProps[e.prop]]||ne.cssHooks[e.prop])?ne.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},M.propHooks.scrollTop=M.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ne.each(["toggle","show","hide"],function(e,t){var i=ne.fn[t];ne.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(k(t,!0),e,n,r)}}),ne.fn.extend({fadeTo:function(e,t,i,n){return this.filter(T).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=ne.isEmptyObject(e),o=ne.speed(t,i,n),s=function(){var t=F(this,ne.extend({},e),o);(r||_e.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(e,i,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=ne.timers,s=_e.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&Rt.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||ne.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,i=_e.get(this),n=i[e+"queue"],r=i[e+"queueHooks"],o=ne.timers,s=n?n.length:0;for(i.finish=!0,ne.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),ne.each({slideDown:k("show"),slideUp:k("hide"),slideToggle:k("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ne.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),ne.speed=function(e,t,i){var n=e&&"object"==typeof e?ne.extend({},e):{complete:i||!i&&t||ne.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ne.isFunction(t)&&t};return n.duration=ne.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ne.fx.speeds?ne.fx.speeds[n.duration]:ne.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){ne.isFunction(n.old)&&n.old.call(this),n.queue&&ne.dequeue(this,n.queue)},n},ne.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ne.timers=[],ne.fx=M.prototype.init,ne.fx.tick=function(){var e,i=ne.timers,n=0;for(Et=ne.now();n<i.length;n++)(e=i[n])()||i[n]!==e||i.splice(n--,1);i.length||ne.fx.stop(),Et=t},ne.fx.timer=function(e){e()&&ne.timers.push(e)&&ne.fx.start()},ne.fx.interval=13,ne.fx.start=function(){bt||(bt=setInterval(ne.fx.tick,ne.fx.interval))},ne.fx.stop=function(){clearInterval(bt),bt=null},ne.fx.speeds={slow:600,fast:200,_default:400},ne.fx.step={},ne.expr&&ne.expr.filters&&(ne.expr.filters.animated=function(e){return ne.grep(ne.timers,function(t){return e===t.elem}).length}),ne.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ne.offset.setOffset(this,e,t)});var i,n,r=this[0],o={top:0,left:0},s=r&&r.ownerDocument;if(s)return i=s.documentElement,ne.contains(i,r)?(typeof r.getBoundingClientRect!==G&&(o=r.getBoundingClientRect()),n=W(s),{top:o.top+n.pageYOffset-i.clientTop,left:o.left+n.pageXOffset-i.clientLeft}):o},ne.offset={setOffset:function(e,t,i){var n,r,o,s,a,c,l=ne.css(e,"position"),u=ne(e),h={};"static"===l&&(e.style.position="relative"),a=u.offset(),o=ne.css(e,"top"),c=ne.css(e,"left"),("absolute"===l||"fixed"===l)&&(o+c).indexOf("auto")>-1?(s=(n=u.position()).top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(c)||0),ne.isFunction(t)&&(t=t.call(e,i,a)),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+r),"using"in t?t.using.call(e,h):u.css(h)}},ne.fn.extend({position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===ne.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ne.nodeName(e[0],"html")||(n=e.offset()),n.top+=ne.css(e[0],"borderTopWidth",!0),n.left+=ne.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-ne.css(i,"marginTop",!0),left:t.left-n.left-ne.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||H;e&&!ne.nodeName(e,"html")&&"static"===ne.css(e,"position");)e=e.offsetParent;return e||H})}}),ne.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(i,n){var r="pageYOffset"===n;ne.fn[i]=function(o){return ne.access(this,function(i,o,s){var a=W(i);if(s===t)return a?a[n]:i[o];a?a.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):i[o]=s},i,o,arguments.length,null)}}),ne.each({Height:"height",Width:"width"},function(e,i){ne.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,r){ne.fn[r]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return ne.access(this,function(i,n,r){var o;return ne.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):r===t?ne.css(i,n,a):ne.style(i,n,r,a)},i,s?r:t,s,null)}})}),ne.fn.size=function(){return this.length},ne.fn.andSelf=ne.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ne:"function"==typeof define&&define.amd&&define("jquery",[],function(){return ne}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=ne)}(window),function(e){function t(e){var t=e.length,n=i.type(e);return"function"!==n&&!i.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e))}if(!e.jQuery){var i=function(e,t){return new i.fn.init(e,t)};i.isWindow=function(e){return null!=e&&e==e.window},i.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?r[s.call(e)]||"object":typeof e},i.isArray=Array.isArray||function(e){return"array"===i.type(e)},i.isPlainObject=function(e){var t;if(!e||"object"!==i.type(e)||e.nodeType||i.isWindow(e))return!1;try{if(e.constructor&&!o.call(e,"constructor")&&!o.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(t in e);return void 0===t||o.call(e,t)},i.each=function(e,i,n){var r=0,o=e.length,s=t(e);if(n){if(s)for(;r<o&&!1!==i.apply(e[r],n);r++);else for(r in e)if(!1===i.apply(e[r],n))break}else if(s)for(;r<o&&!1!==i.call(e[r],r,e[r]);r++);else for(r in e)if(!1===i.call(e[r],r,e[r]))break;return e},i.data=function(e,t,r){if(void 0===r){var o=(s=e[i.expando])&&n[s];if(void 0===t)return o;if(o&&t in o)return o[t]}else if(void 0!==t){var s=e[i.expando]||(e[i.expando]=++i.uuid);return n[s]=n[s]||{},n[s][t]=r,r}},i.removeData=function(e,t){var r=e[i.expando],o=r&&n[r];o&&i.each(t,function(e,t){delete o[t]})},i.extend=function(){var e,t,n,r,o,s,a=arguments[0]||{},c=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[c]||{},c++),"object"!=typeof a&&"function"!==i.type(a)&&(a={}),c===l&&(a=this,c--);c<l;c++)if(null!=(o=arguments[c]))for(r in o)e=a[r],a!==(n=o[r])&&(u&&n&&(i.isPlainObject(n)||(t=i.isArray(n)))?(t?(t=!1,s=e&&i.isArray(e)?e:[]):s=e&&i.isPlainObject(e)?e:{},a[r]=i.extend(u,s,n)):void 0!==n&&(a[r]=n));return a},i.queue=function(e,n,r){if(e){n=(n||"fx")+"queue";var o=i.data(e,n);return r?(!o||i.isArray(r)?o=i.data(e,n,function(e,i){var n=i||[];return null!=e&&(t(Object(e))?function(e,t){for(var i=+t.length,n=0,r=e.length;n<i;)e[r++]=t[n++];if(i!==i)for(;void 0!==t[n];)e[r++]=t[n++];e.length=r}(n,"string"==typeof e?[e]:e):[].push.call(n,e)),n}(r)):o.push(r),o):o||[]}},i.dequeue=function(e,t){i.each(e.nodeType?[e]:e,function(e,n){t=t||"fx";var r=i.queue(n,t),o=r.shift();"inprogress"===o&&(o=r.shift()),o&&("fx"===t&&r.unshift("inprogress"),o.call(n,function(){i.dequeue(n,t)}))})},i.fn=i.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(){for(var e=this.offsetParent||document;e&&"html"===!e.nodeType.toLowerCase&&"static"===e.style.position;)e=e.offsetParent;return e||document}var t=this[0],e=e.apply(t),n=this.offset(),r=/^(?:body|html)$/i.test(e.nodeName)?{top:0,left:0}:i(e).offset();return n.top-=parseFloat(t.style.marginTop)||0,n.left-=parseFloat(t.style.marginLeft)||0,e.style&&(r.top+=parseFloat(e.style.borderTopWidth)||0,r.left+=parseFloat(e.style.borderLeftWidth)||0),{top:n.top-r.top,left:n.left-r.left}}};var n={};i.expando="velocity"+(new Date).getTime(),i.uuid=0;for(var r={},o=r.hasOwnProperty,s=r.toString,a="Boolean Number String Function Array Date RegExp Object Error".split(" "),c=0;c<a.length;c++)r["[object "+a[c]+"]"]=a[c].toLowerCase();i.fn.init.prototype=i.fn,e.Velocity={Utilities:i}}}(window),function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=e():"function"==typeof define&&define.amd?define(e):e()}(function(){return function(e,t,i,n){function r(e){for(var t=-1,i=e?e.length:0,n=[];++t<i;){var r=e[t];r&&n.push(r)}return n}function o(e){return f.isWrapped(e)?e=[].slice.call(e):f.isNode(e)&&(e=[e]),e}function s(e){var t=d.data(e,"velocity");return null===t?n:t}function a(e){return function(t){return Math.round(t*e)*(1/e)}}function c(e,i,n,r){function o(e,t){return 1-3*t+3*e}function s(e,t){return 3*t-6*e}function a(e){return 3*e}function c(e,t,i){return((o(t,i)*e+s(t,i))*e+a(t))*e}function l(e,t,i){return 3*o(t,i)*e*e+2*s(t,i)*e+a(t)}function u(t,i){for(var r=0;r<f;++r){var o=l(i,e,n);if(0===o)return i;i-=(c(i,e,n)-t)/o}return i}function h(){for(var t=0;t<T;++t)E[t]=c(t*v,e,n)}function d(t,i,r){var o,s,a=0;do{(o=c(s=i+(r-i)/2,e,n)-t)>0?r=s:i=s}while(Math.abs(o)>g&&++a<y);return s}function p(t){for(var i=0,r=1,o=T-1;r!=o&&E[r]<=t;++r)i+=v;var s=i+(t-E[--r])/(E[r+1]-E[r])*v,a=l(s,e,n);return a>=m?u(t,s):0==a?s:d(t,i,i+v)}function _(){b=!0,e==i&&n==r||h()}var f=4,m=.001,g=1e-7,y=10,T=11,v=1/(T-1),S="Float32Array"in t;if(4!==arguments.length)return!1;for(var C=0;C<4;++C)if("number"!=typeof arguments[C]||isNaN(arguments[C])||!isFinite(arguments[C]))return!1;e=Math.min(e,1),n=Math.min(n,1),e=Math.max(e,0),n=Math.max(n,0);var E=S?new Float32Array(T):new Array(T),b=!1,A=function(t){return b||_(),e===i&&n===r?t:0===t?0:1===t?1:c(p(t),i,r)};A.getControlPoints=function(){return[{x:e,y:i},{x:n,y:r}]};var x="generateBezier("+[e,i,n,r]+")";return A.toString=function(){return x},A}function l(e,t){var i=e;return f.isString(e)?T.Easings[e]||(i=!1):i=f.isArray(e)&&1===e.length?a.apply(null,e):f.isArray(e)&&2===e.length?v.apply(null,e.concat([t])):!(!f.isArray(e)||4!==e.length)&&c.apply(null,e),!1===i&&(i=T.Easings[T.defaults.easing]?T.defaults.easing:y),i}function u(e){if(e){var t=(new Date).getTime(),i=T.State.calls.length;i>1e4&&(T.State.calls=r(T.State.calls));for(var o=0;o<i;o++)if(T.State.calls[o]){var a=T.State.calls[o],c=a[0],l=a[2],p=a[3],_=!!p,m=null;p||(p=T.State.calls[o][3]=t-16);for(var g=Math.min((t-p)/l.duration,1),y=0,v=c.length;y<v;y++){var C=c[y],b=C.element;if(s(b)){var A=!1;if(l.display!==n&&null!==l.display&&"none"!==l.display){if("flex"===l.display){var x=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];d.each(x,function(e,t){S.setPropertyValue(b,"display",t)})}S.setPropertyValue(b,"display",l.display)}l.visibility!==n&&"hidden"!==l.visibility&&S.setPropertyValue(b,"visibility",l.visibility);for(var R in C)if("element"!==R){var P,I=C[R],w=f.isString(I.easing)?T.Easings[I.easing]:I.easing;if(1===g)P=I.endValue;else{var N=I.endValue-I.startValue;if(P=I.startValue+N*w(g,l,N),!_&&P===I.currentValue)continue}if(I.currentValue=P,"tween"===R)m=P;else{if(S.Hooks.registered[R]){var L=S.Hooks.getRoot(R),O=s(b).rootPropertyValueCache[L];O&&(I.rootPropertyValue=O)}var D=S.setPropertyValue(b,R,I.currentValue+(0===parseFloat(P)?"":I.unitType),I.rootPropertyValue,I.scrollData);S.Hooks.registered[R]&&(S.Normalizations.registered[L]?s(b).rootPropertyValueCache[L]=S.Normalizations.registered[L]("extract",null,D[1]):s(b).rootPropertyValueCache[L]=D[1]),"transform"===D[0]&&(A=!0)}}l.mobileHA&&s(b).transformCache.translate3d===n&&(s(b).transformCache.translate3d="(0px, 0px, 0px)",A=!0),A&&S.flushTransformCache(b)}}l.display!==n&&"none"!==l.display&&(T.State.calls[o][2].display=!1),l.visibility!==n&&"hidden"!==l.visibility&&(T.State.calls[o][2].visibility=!1),l.progress&&l.progress.call(a[1],a[1],g,Math.max(0,p+l.duration-t),p,m),1===g&&h(o)}}T.State.isTicking&&E(u)}function h(e,t){if(!T.State.calls[e])return!1;for(var i=T.State.calls[e][0],r=T.State.calls[e][1],o=T.State.calls[e][2],a=T.State.calls[e][4],c=!1,l=0,u=i.length;l<u;l++){var h=i[l].element;if(t||o.loop||("none"===o.display&&S.setPropertyValue(h,"display",o.display),"hidden"===o.visibility&&S.setPropertyValue(h,"visibility",o.visibility)),!0!==o.loop&&(d.queue(h)[1]===n||!/\.velocityQueueEntryFlag/i.test(d.queue(h)[1]))&&s(h)){s(h).isAnimating=!1,s(h).rootPropertyValueCache={};var p=!1;d.each(S.Lists.transforms3D,function(e,t){var i=/^scale/.test(t)?1:0,r=s(h).transformCache[t];s(h).transformCache[t]!==n&&new RegExp("^\\("+i+"[^.]").test(r)&&(p=!0,delete s(h).transformCache[t])}),o.mobileHA&&(p=!0,delete s(h).transformCache.translate3d),p&&S.flushTransformCache(h),S.Values.removeClass(h,"velocity-animating")}if(!t&&o.complete&&!o.loop&&l===u-1)try{o.complete.call(r,r)}catch(e){setTimeout(function(){throw e},1)}a&&!0!==o.loop&&a(r),s(h)&&!0===o.loop&&!t&&(d.each(s(h).tweensContainer,function(e,t){/^rotate/.test(e)&&360===parseFloat(t.endValue)&&(t.endValue=0,t.startValue=360),/^backgroundPosition/.test(e)&&100===parseFloat(t.endValue)&&"%"===t.unitType&&(t.endValue=0,t.startValue=100)}),T(h,"reverse",{loop:!0,delay:o.delay})),!1!==o.queue&&d.dequeue(h,o.queue)}T.State.calls[e]=!1;for(var _=0,f=T.State.calls.length;_<f;_++)if(!1!==T.State.calls[_]){c=!0;break}!1===c&&(T.State.isTicking=!1,delete T.State.calls,T.State.calls=[])}var d,p=function(){if(i.documentMode)return i.documentMode;for(var e=7;e>4;e--){var t=i.createElement("div");if(t.innerHTML="\x3c!--[if IE "+e+"]><span></span><![endif]--\x3e",t.getElementsByTagName("span").length)return t=null,e}return n}(),_=function(){var e=0;return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var i,n=(new Date).getTime();return i=Math.max(0,16-(n-e)),e=n+i,setTimeout(function(){t(n+i)},i)}}(),f={isString:function(e){return"string"==typeof e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return"object"==typeof e&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==n&&(0===e.length||"object"==typeof e[0]&&e[0].nodeType>0)},isWrapped:function(e){return e&&(e.jquery||t.Zepto&&t.Zepto.zepto.isZ(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)return!1;return!0}},m=!1;if(e.fn&&e.fn.jquery?(d=e,m=!0):d=t.Velocity.Utilities,p<=8&&!m)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(!(p<=7)){var g=400,y="swing",T={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:i.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:d,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:g,easing:y,begin:n,complete:n,progress:n,display:n,visibility:n,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(e){d.data(e,"velocity",{isSVG:f.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};t.pageYOffset!==n?(T.State.scrollAnchor=t,T.State.scrollPropertyLeft="pageXOffset",T.State.scrollPropertyTop="pageYOffset"):(T.State.scrollAnchor=i.documentElement||i.body.parentNode||i.body,T.State.scrollPropertyLeft="scrollLeft",T.State.scrollPropertyTop="scrollTop");var v=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,i,n){var r={x:t.x+n.dx*i,v:t.v+n.dv*i,tension:t.tension,friction:t.friction};return{dx:r.v,dv:e(r)}}function i(i,n){var r={dx:i.v,dv:e(i)},o=t(i,.5*n,r),s=t(i,.5*n,o),a=t(i,n,s),c=1/6*(r.dx+2*(o.dx+s.dx)+a.dx),l=1/6*(r.dv+2*(o.dv+s.dv)+a.dv);return i.x=i.x+c*n,i.v=i.v+l*n,i}return function e(t,n,r){var o,s,a,c={x:-1,v:0,tension:null,friction:null},l=[0],u=0;for(t=parseFloat(t)||500,n=parseFloat(n)||20,r=r||null,c.tension=t,c.friction=n,s=(o=null!==r)?(u=e(t,n))/r*.016:.016;;)if(a=i(a||c,s),l.push(1+a.x),u+=16,!(Math.abs(a.x)>1e-4&&Math.abs(a.v)>1e-4))break;return o?function(e){return l[e*(l.length-1)|0]}:u}}();T.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)}},d.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){T.Easings[t[0]]=c.apply(null,t[1])});var S=T.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(o=0;o<S.Lists.colors.length;o++){var e="color"===S.Lists.colors[o]?"0 0 0 1":"255 255 255 1";S.Hooks.templates[S.Lists.colors[o]]=["Red Green Blue Alpha",e]}var t,i,n;if(p)for(t in S.Hooks.templates){n=(i=S.Hooks.templates[t])[0].split(" ");var r=i[1].match(S.RegEx.valueSplit);"Color"===n[0]&&(n.push(n.shift()),r.push(r.shift()),S.Hooks.templates[t]=[n.join(" "),r.join(" ")])}for(t in S.Hooks.templates){n=(i=S.Hooks.templates[t])[0].split(" ");for(var o in n){var s=t+n[o],a=o;S.Hooks.registered[s]=[t,a]}}},getRoot:function(e){var t=S.Hooks.registered[e];return t?t[0]:e},cleanRootPropertyValue:function(e,t){return S.RegEx.valueUnwrap.test(t)&&(t=t.match(S.RegEx.valueUnwrap)[1]),S.Values.isCSSNullValue(t)&&(t=S.Hooks.templates[e][1]),t},extractValue:function(e,t){var i=S.Hooks.registered[e];if(i){var n=i[0],r=i[1];return(t=S.Hooks.cleanRootPropertyValue(n,t)).toString().match(S.RegEx.valueSplit)[r]}return t},injectValue:function(e,t,i){var n=S.Hooks.registered[e];if(n){var r,o=n[0],s=n[1];return i=S.Hooks.cleanRootPropertyValue(o,i),r=i.toString().match(S.RegEx.valueSplit),r[s]=t,r.join(" ")}return i}},Normalizations:{registered:{clip:function(e,t,i){switch(e){case"name":return"clip";case"extract":var n;return n=S.RegEx.wrappedValueAlreadyExtracted.test(i)?i:(n=i.toString().match(S.RegEx.valueUnwrap))?n[1].replace(/,(\s+)?/g," "):i;case"inject":return"rect("+i+")"}},blur:function(e,t,i){switch(e){case"name":return T.State.isFirefox?"filter":"-webkit-filter";case"extract":var n=parseFloat(i);if(!n&&0!==n){var r=i.toString().match(/blur\(([0-9]+[A-z]+)\)/i);n=r?r[1]:0}return n;case"inject":return parseFloat(i)?"blur("+i+")":"none"}},opacity:function(e,t,i){if(p<=8)switch(e){case"name":return"filter";case"extract":var n=i.toString().match(/alpha\(opacity=(.*)\)/i);return i=n?n[1]/100:1;case"inject":return t.style.zoom=1,parseFloat(i)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(i),10)+")"}else switch(e){case"name":return"opacity";case"extract":case"inject":return i}}},register:function(){p<=9||T.State.isGingerbread||(S.Lists.transformsBase=S.Lists.transformsBase.concat(S.Lists.transforms3D));for(e=0;e<S.Lists.transformsBase.length;e++)!function(){var t=S.Lists.transformsBase[e];S.Normalizations.registered[t]=function(e,i,r){switch(e){case"name":return"transform";case"extract":return s(i)===n||s(i).transformCache[t]===n?/^scale/i.test(t)?1:0:s(i).transformCache[t].replace(/[()]/g,"");case"inject":var o=!1;switch(t.substr(0,t.length-1)){case"translate":o=!/(%|px|em|rem|vw|vh|\d)$/i.test(r);break;case"scal":case"scale":T.State.isAndroid&&s(i).transformCache[t]===n&&r<1&&(r=1),o=!/(\d)$/i.test(r);break;case"skew":case"rotate":o=!/(deg|\d)$/i.test(r)}return o||(s(i).transformCache[t]="("+r+")"),s(i).transformCache[t]}}}();for(var e=0;e<S.Lists.colors.length;e++)!function(){var t=S.Lists.colors[e];S.Normalizations.registered[t]=function(e,i,r){switch(e){case"name":return t;case"extract":var o;if(S.RegEx.wrappedValueAlreadyExtracted.test(r))o=r;else{var s,a={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(r)?s=a[r]!==n?a[r]:a.black:S.RegEx.isHex.test(r)?s="rgb("+S.Values.hexToRgb(r).join(" ")+")":/^rgba?\(/i.test(r)||(s=a.black),o=(s||r).toString().match(S.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return p<=8||3!==o.split(" ").length||(o+=" 1"),o;case"inject":return p<=8?4===r.split(" ").length&&(r=r.split(/\s+/).slice(0,3).join(" ")):3===r.split(" ").length&&(r+=" 1"),(p<=8?"rgb":"rgba")+"("+r.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(p||T.State.isAndroid&&!T.State.isChrome)&&(t+="|transform"),new RegExp("^("+t+")$","i").test(e)},prefixCheck:function(e){if(T.State.prefixMatches[e])return[T.State.prefixMatches[e],!0];for(var t=["","Webkit","Moz","ms","O"],i=0,n=t.length;i<n;i++){var r;if(r=0===i?e:t[i]+e.replace(/^\w/,function(e){return e.toUpperCase()}),f.isString(T.State.prefixElement.style[r]))return T.State.prefixMatches[e]=r,[r,!0]}return[e,!1]}},Values:{hexToRgb:function(e){var t,i=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return e=e.replace(i,function(e,t,i,n){return t+t+i+i+n+n}),(t=n.exec(e))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]},isCSSNullValue:function(e){return 0==e||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=(e.className.length?" ":"")+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(e,i,r,o){function a(e,i){var r=0;if(p<=8)r=d.css(e,i);else{var c=!1;/^(width|height)$/.test(i)&&0===S.getPropertyValue(e,"display")&&(c=!0,S.setPropertyValue(e,"display",S.Values.getDisplayType(e)));function l(){c&&S.setPropertyValue(e,"display","none")}if(!o){if("height"===i&&"border-box"!==S.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var u=e.offsetHeight-(parseFloat(S.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(S.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(S.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(S.getPropertyValue(e,"paddingBottom"))||0);return l(),u}if("width"===i&&"border-box"!==S.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var h=e.offsetWidth-(parseFloat(S.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(S.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(S.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(S.getPropertyValue(e,"paddingRight"))||0);return l(),h}}var _;_=s(e)===n?t.getComputedStyle(e,null):s(e).computedStyle?s(e).computedStyle:s(e).computedStyle=t.getComputedStyle(e,null),"borderColor"===i&&(i="borderTopColor"),""!==(r=9===p&&"filter"===i?_.getPropertyValue(i):_[i])&&null!==r||(r=e.style[i]),l()}if("auto"===r&&/^(top|right|bottom|left)$/i.test(i)){var f=a(e,"position");("fixed"===f||"absolute"===f&&/top|left/i.test(i))&&(r=d(e).position()[i]+"px")}return r}var c;if(S.Hooks.registered[i]){var l=i,u=S.Hooks.getRoot(l);r===n&&(r=S.getPropertyValue(e,S.Names.prefixCheck(u)[0])),S.Normalizations.registered[u]&&(r=S.Normalizations.registered[u]("extract",e,r)),c=S.Hooks.extractValue(l,r)}else if(S.Normalizations.registered[i]){var h,_;"transform"!==(h=S.Normalizations.registered[i]("name",e))&&(_=a(e,S.Names.prefixCheck(h)[0]),S.Values.isCSSNullValue(_)&&S.Hooks.templates[i]&&(_=S.Hooks.templates[i][1])),c=S.Normalizations.registered[i]("extract",e,_)}if(!/^[\d-]/.test(c))if(s(e)&&s(e).isSVG&&S.Names.SVGAttribute(i))if(/^(height|width)$/i.test(i))try{c=e.getBBox()[i]}catch(e){c=0}else c=e.getAttribute(i);else c=a(e,S.Names.prefixCheck(i)[0]);return S.Values.isCSSNullValue(c)&&(c=0),T.debug>=2&&console.log("Get "+i+": "+c),c},setPropertyValue:function(e,i,n,r,o){var a=i;if("scroll"===i)o.container?o.container["scroll"+o.direction]=n:"Left"===o.direction?t.scrollTo(n,o.alternateValue):t.scrollTo(o.alternateValue,n);else if(S.Normalizations.registered[i]&&"transform"===S.Normalizations.registered[i]("name",e))S.Normalizations.registered[i]("inject",e,n),a="transform",n=s(e).transformCache[i];else{if(S.Hooks.registered[i]){var c=i,l=S.Hooks.getRoot(i);r=r||S.getPropertyValue(e,l),n=S.Hooks.injectValue(c,n,r),i=l}if(S.Normalizations.registered[i]&&(n=S.Normalizations.registered[i]("inject",e,n),i=S.Normalizations.registered[i]("name",e)),a=S.Names.prefixCheck(i)[0],p<=8)try{e.style[a]=n}catch(e){T.debug&&console.log("Browser does not support ["+n+"] for ["+a+"]")}else s(e)&&s(e).isSVG&&S.Names.SVGAttribute(i)?e.setAttribute(i,n):e.style[a]=n;T.debug>=2&&console.log("Set "+i+" ("+a+"): "+n)}return[a,n]},flushTransformCache:function(e){var t="";if((p||T.State.isAndroid&&!T.State.isChrome)&&s(e).isSVG){function i(t){return parseFloat(S.getPropertyValue(e,t))}var n={translate:[i("translateX"),i("translateY")],skewX:[i("skewX")],skewY:[i("skewY")],scale:1!==i("scale")?[i("scale"),i("scale")]:[i("scaleX"),i("scaleY")],rotate:[i("rotateZ"),0,0]};d.each(s(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),n[e]&&(t+=e+"("+n[e].join(" ")+") ",delete n[e])})}else{var r,o;d.each(s(e).transformCache,function(i){if(r=s(e).transformCache[i],"transformPerspective"===i)return o=r,!0;9===p&&"rotateZ"===i&&(i="rotate"),t+=i+r+" "}),o&&(t="perspective"+o+" "+t)}S.setPropertyValue(e,"transform",t)}};S.Hooks.register(),S.Normalizations.register(),T.hook=function(e,t,i){var r=n;return e=o(e),d.each(e,function(e,o){if(s(o)===n&&T.init(o),i===n)r===n&&(r=T.CSS.getPropertyValue(o,t));else{var a=T.CSS.setPropertyValue(o,t,i);"transform"===a[0]&&T.CSS.flushTransformCache(o),r=a}}),r};var C=function(){function e(){return a?x.promise||null:c}function r(){function e(e){if(a.begin&&0===b)try{a.begin.call(_,_)}catch(e){setTimeout(function(){throw e},1)}if("scroll"===R){var h,p,g,v=/^x$/i.test(a.axis)?"Left":"Top",C=parseFloat(a.offset)||0;a.container?f.isWrapped(a.container)||f.isNode(a.container)?(a.container=a.container[0]||a.container,g=(h=a.container["scroll"+v])+d(o).position()[v.toLowerCase()]+C):a.container=null:(h=T.State.scrollAnchor[T.State["scrollProperty"+v]],p=T.State.scrollAnchor[T.State["scrollProperty"+("Left"===v?"Top":"Left")]],g=d(o).offset()[v.toLowerCase()]+C),c={scroll:{rootPropertyValue:!1,startValue:h,currentValue:h,endValue:g,unitType:"",easing:a.easing,scrollData:{container:a.container,direction:v,alternateValue:p}},element:o},T.debug&&console.log("tweensContainer (scroll): ",c.scroll,o)}else if("reverse"===R){if(!s(o).tweensContainer)return void d.dequeue(o,a.queue);"none"===s(o).opts.display&&(s(o).opts.display="auto"),"hidden"===s(o).opts.visibility&&(s(o).opts.visibility="visible"),s(o).opts.loop=!1,s(o).opts.begin=null,s(o).opts.complete=null,y.easing||delete a.easing,y.duration||delete a.duration,a=d.extend({},s(o).opts,a);I=d.extend(!0,{},s(o).tweensContainer);for(var A in I)if("element"!==A){var P=I[A].startValue;I[A].startValue=I[A].currentValue=I[A].endValue,I[A].endValue=P,f.isEmptyObject(y)||(I[A].easing=a.easing),T.debug&&console.log("reverse tweensContainer ("+A+"): "+JSON.stringify(I[A]),o)}c=I}else if("start"===R){var I;s(o).tweensContainer&&!0===s(o).isAnimating&&(I=s(o).tweensContainer);function w(e,t){var i=n,r=n,s=n;return f.isArray(e)?(i=e[0],!f.isArray(e[1])&&/^[\d-]/.test(e[1])||f.isFunction(e[1])||S.RegEx.isHex.test(e[1])?s=e[1]:(f.isString(e[1])&&!S.RegEx.isHex.test(e[1])||f.isArray(e[1]))&&(r=t?e[1]:l(e[1],a.duration),e[2]!==n&&(s=e[2]))):i=e,t||(r=r||a.easing),f.isFunction(i)&&(i=i.call(o,b,E)),f.isFunction(s)&&(s=s.call(o,b,E)),[i||0,r,s]}d.each(m,function(e,t){if(RegExp("^"+S.Lists.colors.join("$|^")+"$").test(e)){var i=w(t,!0),r=i[0],o=i[1],s=i[2];if(S.RegEx.isHex.test(r)){for(var a=["Red","Green","Blue"],c=S.Values.hexToRgb(r),l=s?S.Values.hexToRgb(s):n,u=0;u<a.length;u++){var h=[c[u]];o&&h.push(o),l!==n&&h.push(l[u]),m[e+a[u]]=h}delete m[e]}}});for(var N in m){var D=w(m[N]),F=D[0],B=D[1],M=D[2];N=S.Names.camelCase(N);var k=S.Hooks.getRoot(N),W=!1;if(s(o).isSVG||"tween"===k||!1!==S.Names.prefixCheck(k)[1]||S.Normalizations.registered[k]!==n){(a.display!==n&&null!==a.display&&"none"!==a.display||a.visibility!==n&&"hidden"!==a.visibility)&&/opacity|filter/.test(N)&&!M&&0!==F&&(M=0),a._cacheValues&&I&&I[N]?(M===n&&(M=I[N].endValue+I[N].unitType),W=s(o).rootPropertyValueCache[k]):S.Hooks.registered[N]?M===n?(W=S.getPropertyValue(o,k),M=S.getPropertyValue(o,N,W)):W=S.Hooks.templates[k][1]:M===n&&(M=S.getPropertyValue(o,N));var V,z,G,U=!1;if(V=H(N,M),M=V[0],G=V[1],V=H(N,F),F=V[0].replace(/^([+-\/*])=/,function(e,t){return U=t,""}),z=V[1],M=parseFloat(M)||0,F=parseFloat(F)||0,"%"===z&&(/^(fontSize|lineHeight)$/.test(N)?(F/=100,z="em"):/^scale/.test(N)?(F/=100,z=""):/(Red|Green|Blue)$/i.test(N)&&(F=F/100*255,z="")),/[\/*]/.test(U))z=G;else if(G!==z&&0!==M)if(0===F)z=G;else{r=r||X();var Y=/margin|padding|left|right|width|text|word|letter/i.test(N)||/X$/.test(N)||"x"===N?"x":"y";switch(G){case"%":M*="x"===Y?r.percentToPxWidth:r.percentToPxHeight;break;case"px":break;default:M*=r[G+"ToPx"]}switch(z){case"%":M*=1/("x"===Y?r.percentToPxWidth:r.percentToPxHeight);break;case"px":break;default:M*=1/r[z+"ToPx"]}}switch(U){case"+":F=M+F;break;case"-":F=M-F;break;case"*":F*=M;break;case"/":F=M/F}c[N]={rootPropertyValue:W,startValue:M,currentValue:M,endValue:F,unitType:z,easing:B},T.debug&&console.log("tweensContainer ("+N+"): "+JSON.stringify(c[N]),o)}else T.debug&&console.log("Skipping ["+k+"] due to a lack of browser support.");function H(e,t){var i,n;return n=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return i=e,""}),i||(i=S.Values.getUnitType(e)),[n,i]}function X(){var e={myParent:o.parentNode||i.body,position:S.getPropertyValue(o,"position"),fontSize:S.getPropertyValue(o,"fontSize")},n=e.position===L.lastPosition&&e.myParent===L.lastParent,r=e.fontSize===L.lastFontSize;L.lastParent=e.myParent,L.lastPosition=e.position,L.lastFontSize=e.fontSize;var a={};if(r&&n)a.emToPx=L.lastEmToPx,a.percentToPxWidth=L.lastPercentToPxWidth,a.percentToPxHeight=L.lastPercentToPxHeight;else{var c=s(o).isSVG?i.createElementNS("http://www.w3.org/2000/svg","rect"):i.createElement("div");T.init(c),e.myParent.appendChild(c),d.each(["overflow","overflowX","overflowY"],function(e,t){T.CSS.setPropertyValue(c,t,"hidden")}),T.CSS.setPropertyValue(c,"position",e.position),T.CSS.setPropertyValue(c,"fontSize",e.fontSize),T.CSS.setPropertyValue(c,"boxSizing","content-box"),d.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){T.CSS.setPropertyValue(c,t,"100%")}),T.CSS.setPropertyValue(c,"paddingLeft","100em"),a.percentToPxWidth=L.lastPercentToPxWidth=(parseFloat(S.getPropertyValue(c,"width",null,!0))||1)/100,a.percentToPxHeight=L.lastPercentToPxHeight=(parseFloat(S.getPropertyValue(c,"height",null,!0))||1)/100,a.emToPx=L.lastEmToPx=(parseFloat(S.getPropertyValue(c,"paddingLeft"))||1)/100,e.myParent.removeChild(c)}return null===L.remToPx&&(L.remToPx=parseFloat(S.getPropertyValue(i.body,"fontSize"))||16),null===L.vwToPx&&(L.vwToPx=parseFloat(t.innerWidth)/100,L.vhToPx=parseFloat(t.innerHeight)/100),a.remToPx=L.remToPx,a.vwToPx=L.vwToPx,a.vhToPx=L.vhToPx,T.debug>=1&&console.log("Unit ratios: "+JSON.stringify(a),o),a}}c.element=o}c.element&&(S.Values.addClass(o,"velocity-animating"),O.push(c),""===a.queue&&(s(o).tweensContainer=c,s(o).opts=a),s(o).isAnimating=!0,b===E-1?(T.State.calls.push([O,_,a,null,x.resolver]),!1===T.State.isTicking&&(T.State.isTicking=!0,u())):b++)}var r,o=this,a=d.extend({},T.defaults,y),c={};switch(s(o)===n&&T.init(o),parseFloat(a.delay)&&!1!==a.queue&&d.queue(o,a.queue,function(e){T.velocityQueueEntryFlag=!0,s(o).delayTimer={setTimeout:setTimeout(e,parseFloat(a.delay)),next:e}}),a.duration.toString().toLowerCase()){case"fast":a.duration=200;break;case"normal":a.duration=g;break;case"slow":a.duration=600;break;default:a.duration=parseFloat(a.duration)||1}!1!==T.mock&&(!0===T.mock?a.duration=a.delay=1:(a.duration*=parseFloat(T.mock)||1,a.delay*=parseFloat(T.mock)||1)),a.easing=l(a.easing,a.duration),a.begin&&!f.isFunction(a.begin)&&(a.begin=null),a.progress&&!f.isFunction(a.progress)&&(a.progress=null),a.complete&&!f.isFunction(a.complete)&&(a.complete=null),a.display!==n&&null!==a.display&&(a.display=a.display.toString().toLowerCase(),"auto"===a.display&&(a.display=T.CSS.Values.getDisplayType(o))),a.visibility!==n&&null!==a.visibility&&(a.visibility=a.visibility.toString().toLowerCase()),a.mobileHA=a.mobileHA&&T.State.isMobile&&!T.State.isGingerbread,!1===a.queue?a.delay?setTimeout(e,a.delay):e():d.queue(o,a.queue,function(t,i){if(!0===i)return x.promise&&x.resolver(_),!0;T.velocityQueueEntryFlag=!0,e()}),""!==a.queue&&"fx"!==a.queue||"inprogress"===d.queue(o)[0]||d.dequeue(o)}var a,c,p,_,m,y,v=arguments[0]&&(arguments[0].p||d.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||f.isString(arguments[0].properties));if(f.isWrapped(this)?(a=!1,p=0,_=this,c=this):(a=!0,p=1,_=v?arguments[0].elements||arguments[0].e:arguments[0]),_=o(_)){v?(m=arguments[0].properties||arguments[0].p,y=arguments[0].options||arguments[0].o):(m=arguments[p],y=arguments[p+1]);var E=_.length,b=0;if(!/^(stop|finish)$/i.test(m)&&!d.isPlainObject(y)){y={};for(var A=p+1;A<arguments.length;A++)f.isArray(arguments[A])||!/^(fast|normal|slow)$/i.test(arguments[A])&&!/^\d/.test(arguments[A])?f.isString(arguments[A])||f.isArray(arguments[A])?y.easing=arguments[A]:f.isFunction(arguments[A])&&(y.complete=arguments[A]):y.duration=arguments[A]}var x={promise:null,resolver:null,rejecter:null};a&&T.Promise&&(x.promise=new T.Promise(function(e,t){x.resolver=e,x.rejecter=t}));var R;switch(m){case"scroll":R="scroll";break;case"reverse":R="reverse";break;case"finish":case"stop":d.each(_,function(e,t){s(t)&&s(t).delayTimer&&(clearTimeout(s(t).delayTimer.setTimeout),s(t).delayTimer.next&&s(t).delayTimer.next(),delete s(t).delayTimer)});var P=[];return d.each(T.State.calls,function(e,t){t&&d.each(t[1],function(i,r){var o=y===n?"":y;if(!0!==o&&t[2].queue!==o&&(y!==n||!1!==t[2].queue))return!0;d.each(_,function(i,n){n===r&&((!0===y||f.isString(y))&&(d.each(d.queue(n,f.isString(y)?y:""),function(e,t){f.isFunction(t)&&t(null,!0)}),d.queue(n,f.isString(y)?y:"",[])),"stop"===m?(s(n)&&s(n).tweensContainer&&!1!==o&&d.each(s(n).tweensContainer,function(e,t){t.endValue=t.currentValue}),P.push(e)):"finish"===m&&(t[2].duration=1))})})}),"stop"===m&&(d.each(P,function(e,t){h(t,!0)}),x.promise&&x.resolver(_)),e();default:if(!d.isPlainObject(m)||f.isEmptyObject(m)){if(f.isString(m)&&T.Redirects[m]){var I=(F=d.extend({},y)).duration,w=F.delay||0;return!0===F.backwards&&(_=d.extend(!0,[],_).reverse()),d.each(_,function(e,t){parseFloat(F.stagger)?F.delay=w+parseFloat(F.stagger)*e:f.isFunction(F.stagger)&&(F.delay=w+F.stagger.call(t,e,E)),F.drag&&(F.duration=parseFloat(I)||(/^(callout|transition)/.test(m)?1e3:g),F.duration=Math.max(F.duration*(F.backwards?1-e/E:(e+1)/E),.75*F.duration,200)),T.Redirects[m].call(t,t,F||{},e,E,_,x.promise?x:n)}),e()}var N="Velocity: First argument ("+m+") was not a property map, a known action, or a registered redirect. Aborting.";return x.promise?x.rejecter(new Error(N)):console.log(N),e()}R="start"}var L={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},O=[];d.each(_,function(e,t){f.isNode(t)&&r.call(t)});var D,F=d.extend({},T.defaults,y);if(F.loop=parseInt(F.loop),D=2*F.loop-1,F.loop)for(var B=0;B<D;B++){var M={delay:F.delay,progress:F.progress};B===D-1&&(M.display=F.display,M.visibility=F.visibility,M.complete=F.complete),C(_,"reverse",M)}return e()}};(T=d.extend(C,T)).animate=C;var E=t.requestAnimationFrame||_;return T.State.isMobile||i.hidden===n||i.addEventListener("visibilitychange",function(){i.hidden?(E=function(e){return setTimeout(function(){e(!0)},16)},u()):E=t.requestAnimationFrame||_}),e.Velocity=T,e!==t&&(e.fn.velocity=C,e.fn.velocity.defaults=T.defaults),d.each(["Down","Up"],function(e,t){T.Redirects["slide"+t]=function(e,i,r,o,s,a){var c=d.extend({},i),l=c.begin,u=c.complete,h={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},p={};c.display===n&&(c.display="Down"===t?"inline"===T.CSS.Values.getDisplayType(e)?"inline-block":"block":"none"),c.begin=function(){l&&l.call(s,s);for(var i in h){p[i]=e.style[i];var n=T.CSS.getPropertyValue(e,i);h[i]="Down"===t?[n,0]:[0,n]}p.overflow=e.style.overflow,e.style.overflow="hidden"},c.complete=function(){for(var t in p)e.style[t]=p[t];u&&u.call(s,s),a&&a.resolver(s)},T(e,h,c)}}),d.each(["In","Out"],function(e,t){T.Redirects["fade"+t]=function(e,i,r,o,s,a){var c=d.extend({},i),l={opacity:"In"===t?1:0},u=c.complete;c.complete=r!==o-1?c.begin=null:function(){u&&u.call(s,s),a&&a.resolver(s)},c.display===n&&(c.display="In"===t?"auto":"none"),T(this,l,c)}}),T}jQuery.fn.velocity=jQuery.fn.animate}(window.jQuery||window.Zepto||window,window,document)}),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.affix"),o="object"==typeof t&&t;r||n.data("bs.affix",r=new i(this,o)),"string"==typeof t&&r[t]()})}var i=function(t,n){this.options=e.extend({},i.DEFAULTS,n),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.2.0",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},i.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=e(document).height(),n=this.$target.scrollTop(),r=this.$element.offset(),o=this.options.offset,s=o.top,a=o.bottom;"object"!=typeof o&&(a=s=o),"function"==typeof s&&(s=o.top(this.$element)),"function"==typeof a&&(a=o.bottom(this.$element));var c=!(null!=this.unpin&&n+this.unpin<=r.top)&&(null!=a&&r.top+this.$element.height()>=t-a?"bottom":null!=s&&n<=s&&"top");if(this.affixed!==c){null!=this.unpin&&this.$element.css("top","");var l="affix"+(c?"-"+c:""),u=e.Event(l+".bs.affix");this.$element.trigger(u),u.isDefaultPrevented()||(this.affixed=c,this.unpin="bottom"==c?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(l).trigger(e.Event(l.replace("affix","affixed"))),"bottom"==c&&this.$element.offset({top:t-this.$element.height()-a}))}}};var n=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=i,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var i=e(this),n=i.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.call(i,n)})})}(jQuery),function(e){"use strict";var t='[data-dismiss="alert"]',i=function(i){e(i).on("click",t,this.close)};i.VERSION="3.2.0",i.prototype.close=function(t){function i(){o.detach().trigger("closed.bs.alert").remove()}var n=e(this),r=n.attr("data-target");r||(r=(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]*$)/,""));var o=e(r);t&&t.preventDefault(),o.length||(o=n.hasClass("alert")?n:n.parent()),o.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",i).emulateTransitionEnd(150):i())};var n=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var n=e(this),r=n.data("bs.alert");r||n.data("bs.alert",r=new i(this)),"string"==typeof t&&r[t].call(n)})},e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=n,this},e(document).on("click.bs.alert.data-api",t,i.prototype.close)}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.button"),o="object"==typeof t&&t;r||n.data("bs.button",r=new i(this,o)),"toggle"==t?r.toggle():t&&r.setState(t)})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.2.0",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(t){var i="disabled",n=this.$element,r=n.is("input")?"val":"html",o=n.data();t+="Text",null==o.resetText&&n.data("resetText",n[r]()),n[r](null==o[t]?this.options[t]:o[t]),setTimeout(e.proxy(function(){"loadingText"==t?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))},this),0)},i.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}e&&this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=t,e.fn.button.Constructor=i,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=e(i.target);n.hasClass("btn")||(n=n.closest(".btn")),t.call(n,"toggle"),i.preventDefault()})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.carousel"),o=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t),s="string"==typeof t?t:o.slide;r||n.data("bs.carousel",r=new i(this,o)),"number"==typeof t?r.to(t):s?r[s]():o.interval&&r.pause().cycle()})}var i=function(t,i){this.$element=e(t).on("keydown.bs.carousel",e.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};i.VERSION="3.2.0",i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},i.prototype.keydown=function(e){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},i.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},i.prototype.to=function(t){var i=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},i.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){if(!this.sliding)return this.slide("next")},i.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},i.prototype.slide=function(t,i){var n=this.$element.find(".item.active"),r=i||n[t](),o=this.interval,s="next"==t?"left":"right",a="next"==t?"first":"last",c=this;if(!r.length){if(!this.options.wrap)return;r=this.$element.find(".item")[a]()}if(r.hasClass("active"))return this.sliding=!1;var l=r[0],u=e.Event("slide.bs.carousel",{relatedTarget:l,direction:s});if(this.$element.trigger(u),!u.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=e(this.$indicators.children()[this.getItemIndex(r)]);h&&h.addClass("active")}var d=e.Event("slid.bs.carousel",{relatedTarget:l,direction:s});return e.support.transition&&this.$element.hasClass("slide")?(r.addClass(t),r[0].offsetWidth,n.addClass(s),r.addClass(s),n.one("bsTransitionEnd",function(){r.removeClass([t,s].join(" ")).addClass("active"),n.removeClass(["active",s].join(" ")),c.sliding=!1,setTimeout(function(){c.$element.trigger(d)},0)}).emulateTransitionEnd(1e3*n.css("transition-duration").slice(0,-1))):(n.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger(d)),o&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=i,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(i){var n,r=e(this),o=e(r.attr("data-target")||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var s=e.extend({},o.data(),r.data()),a=r.attr("data-slide-to");a&&(s.interval=!1),t.call(o,s),a&&o.data("bs.carousel").to(a),i.preventDefault()}}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var i=e(this);t.call(i,i.data())})})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.collapse"),o=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t);!r&&o.toggle&&"show"==t&&(t=!t),r||n.data("bs.collapse",r=new i(this,o)),"string"==typeof t&&r[t]()})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};i.VERSION="3.2.0",i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i=e.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;t.call(n,"hide"),r||n.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var a=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(350)[o](this.$element[0][a])}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!e.support.transition)return n.call(this);this.$element[i](0).one("bsTransitionEnd",e.proxy(n,this)).emulateTransitionEnd(350)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=t,e.fn.collapse.Constructor=i,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var n,r=e(this),o=r.attr("data-target")||i.preventDefault()||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),s=e(o),a=s.data("bs.collapse"),c=a?"toggle":r.data(),l=r.attr("data-parent"),u=l&&e(l);a&&a.transitioning||(u&&u.find('[data-toggle="collapse"][data-parent="'+l+'"]').not(r).addClass("collapsed"),r[s.hasClass("in")?"addClass":"removeClass"]("collapsed")),t.call(s,c)})}(jQuery),function(e){"use strict";function t(t){t&&3===t.which||(e(n).remove(),e(r).each(function(){var n=i(e(this)),r={relatedTarget:this};n.hasClass("open")&&(n.trigger(t=e.Event("hide.bs.dropdown",r)),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown",r))}))}function i(t){var i=t.attr("data-target");i||(i=(i=t.attr("href"))&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&e(i);return n&&n.length?n:t.parent()}var n=".dropdown-backdrop",r='[data-toggle="dropdown"]',o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.VERSION="3.2.0",o.prototype.toggle=function(n){var r=e(this);if(!r.is(".disabled, :disabled")){var o=i(r),s=o.hasClass("open");if(t(),!s){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var a={relatedTarget:this};if(o.trigger(n=e.Event("show.bs.dropdown",a)),n.isDefaultPrevented())return;r.trigger("focus"),o.toggleClass("open").trigger("shown.bs.dropdown",a)}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=e(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var o=i(n),s=o.hasClass("open");if(!s||s&&27==t.keyCode)return 27==t.which&&o.find(r).trigger("focus"),n.trigger("click");var a=" li:not(.divider):visible a",c=o.find('[role="menu"]'+a+', [role="listbox"]'+a);if(c.length){var l=c.index(c.filter(":focus"));38==t.keyCode&&l>0&&l--,40==t.keyCode&&l<c.length-1&&l++,~l||(l=0),c.eq(l).trigger("focus")}}}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var i=e(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new o(this)),"string"==typeof t&&n[t].call(i)})},e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r+', [role="menu"], [role="listbox"]',o.prototype.keydown)}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.tab");r||n.data("bs.tab",r=new i(this)),"string"==typeof t&&r[t]()})}var i=function(t){this.element=e(t)};i.VERSION="3.2.0",i.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=i.find(".active:last a")[0],o=e.Event("show.bs.tab",{relatedTarget:r});if(t.trigger(o),!o.isDefaultPrevented()){var s=e(n);this.activate(t.closest("li"),i),this.activate(s,s.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:r})})}}},i.prototype.activate=function(t,i,n){function r(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var o=i.find("> .active"),s=n&&e.support.transition&&o.hasClass("fade");s?o.one("bsTransitionEnd",r).emulateTransitionEnd(150):r(),o.removeClass("in")};var n=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=i,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(i){i.preventDefault(),t.call(e(this),"show")})}(jQuery),function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one("bsTransitionEnd",function(){i=!0});return setTimeout(function(){i||e(n).trigger(e.support.transition.end)},t),this},e(function(){e.support.transition=t(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(e){"use strict";function t(i,n){var r=e.proxy(this.process,this);this.$body=e("body"),this.$scrollElement=e(e(i).is("body")?window:i),this.options=e.extend({},t.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",r),this.refresh(),this.process()}function i(i){return this.each(function(){var n=e(this),r=n.data("bs.scrollspy"),o="object"==typeof i&&i;r||n.data("bs.scrollspy",r=new t(this,o)),"string"==typeof i&&r[i]()})}t.VERSION="3.2.0",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",i=0;e.isWindow(this.$scrollElement[0])||(t="position",i=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var n=this;this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),o=/^#./.test(r)&&e(r);return o&&o.length&&o.is(":visible")&&[[o[t]().top+i,r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),r=this.offsets,o=this.targets,s=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),t>=n)return s!=(e=o[o.length-1])&&this.activate(e);if(s&&t<=r[0])return s!=(e=o[0])&&this.activate(e);for(e=r.length;e--;)s!=o[e]&&t>=r[e]&&(!r[e+1]||t<=r[e+1])&&this.activate(o[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var n=e.fn.scrollspy;e.fn.scrollspy=i,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);i.call(t,t.data())})})}(jQuery),function(e){"use strict";function t(t,n){return this.each(function(){var r=e(this),o=r.data("bs.modal"),s=e.extend({},i.DEFAULTS,r.data(),"object"==typeof t&&t);o||r.data("bs.modal",o=new i(this,s)),"string"==typeof t?o[t](n):s.show&&o.show(n)})}var i=function(t,i){this.options=i,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.2.0",i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},i.prototype.show=function(t){var i=this,n=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var n=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var r=e.Event("shown.bs.modal",{relatedTarget:t});n?i.$element.find(".modal-dialog").one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(r)}).emulateTransitionEnd(300):i.$element.trigger("focus").trigger(r)}))},i.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},i.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},i.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(t){var i=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(150):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){i.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(150):o()}else t&&t()},i.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},i.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},i.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var n=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=i,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=e(this),r=n.attr("href"),o=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=o.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},o.data(),n.data());n.is("a")&&i.preventDefault(),o.one("show.bs.modal",function(e){e.isDefaultPrevented()||o.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),t.call(o,s,this)})}(jQuery),function(e){"use strict";var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.VERSION="3.2.0",t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,i,n){this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var r=this.options.trigger.split(" "),o=r.length;o--;){var s=r[o];if("click"==s)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focusin",c="hover"==s?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(c+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return(t=e.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var i=e.contains(document.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!i)return;var n=this,r=this.tip(),o=this.getUID(this.type);this.setContent(),r.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&r.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,c=a.test(s);c&&(s=s.replace(a,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var l=this.getPosition(),u=r[0].offsetWidth,h=r[0].offsetHeight;if(c){var d=s,p=this.$element.parent(),_=this.getPosition(p);s="bottom"==s&&l.top+l.height+h-_.scroll>_.height?"top":"top"==s&&l.top-_.scroll-h<0?"bottom":"right"==s&&l.right+u>_.width?"left":"left"==s&&l.left-u<_.left?"right":s,r.removeClass(d).addClass(s)}var f=this.getCalculatedOffset(s,l,u,h);this.applyPlacement(f,s);var m=function(){n.$element.trigger("shown.bs."+n.type),n.hoverState=null};e.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",m).emulateTransitionEnd(150):m()}},t.prototype.applyPlacement=function(t,i){var n=this.tip(),r=n[0].offsetWidth,o=n[0].offsetHeight,s=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),t.top=t.top+s,t.left=t.left+a,e.offset.setOffset(n[0],e.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),n.addClass("in");var c=n[0].offsetWidth,l=n[0].offsetHeight;"top"==i&&l!=o&&(t.top=t.top+o-l);var u=this.getViewportAdjustedDelta(i,t,c,l);u.left?t.left+=u.left:t.top+=u.top;var h=u.left?2*u.left-r+c:2*u.top-o+l,d=u.left?"left":"top",p=u.left?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(h,n[0][p],d)},t.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=i.hoverState&&n.detach(),i.$element.trigger("hidden.bs."+i.type)}var i=this,n=this.tip(),r=e.Event("hide.bs."+this.type);if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(r),!r.isDefaultPrevented())return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",t).emulateTransitionEnd(150):t(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){var i=(t=t||this.$element)[0],n="BODY"==i.tagName;return e.extend({},"function"==typeof i.getBoundingClientRect?i.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:n?e(window).width():t.outerWidth(),height:n?e(window).height():t.outerHeight()},n?{top:0,left:0}:t.offset())},t.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,i,n){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);if(/right|left/.test(e)){var a=t.top-o-s.scroll,c=t.top+o-s.scroll+n;a<s.top?r.top=s.top-a:c>s.top+s.height&&(r.top=s.top+s.height-c)}else{var l=t.left-o,u=t.left+o+i;l<s.left?r.left=s.left-l:u>s.width&&(r.left=s.left+s.width-u)}return r},t.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},t.prototype.getUID=function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=this;t&&((i=e(t.currentTarget).data("bs."+this.type))||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var n=e(this),r=n.data("bs.tooltip"),o="object"==typeof i&&i;(r||"destroy"!=i)&&(r||n.data("bs.tooltip",r=new t(this,o)),"string"==typeof i&&r[i]())})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.2.0",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=function(i){return this.each(function(){var n=e(this),r=n.data("bs.popover"),o="object"==typeof i&&i;(r||"destroy"!=i)&&(r||n.data("bs.popover",r=new t(this,o)),"string"==typeof i&&r[i]())})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),function(){var e=this,t=e._,i={},n=Array.prototype,r=Object.prototype,o=Function.prototype,s=n.push,a=n.slice,c=n.concat,l=r.toString,u=r.hasOwnProperty,h=n.forEach,d=n.map,p=n.reduce,_=n.reduceRight,f=n.filter,m=n.every,g=n.some,y=n.indexOf,T=n.lastIndexOf,v=Array.isArray,S=Object.keys,C=o.bind,E=function(e){return e instanceof E?e:this instanceof E?void(this._wrapped=e):new E(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=E),exports._=E):e._=E,E.VERSION="1.6.0";var b=E.each=E.forEach=function(e,t,n){if(null==e)return e;if(h&&e.forEach===h)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,o=e.length;r<o;r++)if(t.call(n,e[r],r,e)===i)return}else for(var s=E.keys(e),r=0,o=s.length;r<o;r++)if(t.call(n,e[s[r]],s[r],e)===i)return;return e};E.map=E.collect=function(e,t,i){var n=[];return null==e?n:d&&e.map===d?e.map(t,i):(b(e,function(e,r,o){n.push(t.call(i,e,r,o))}),n)};var A="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(e,t,i,n){var r=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=E.bind(t,n)),r?e.reduce(t,i):e.reduce(t);if(b(e,function(e,o,s){r?i=t.call(n,i,e,o,s):(i=e,r=!0)}),!r)throw new TypeError(A);return i},E.reduceRight=E.foldr=function(e,t,i,n){var r=arguments.length>2;if(null==e&&(e=[]),_&&e.reduceRight===_)return n&&(t=E.bind(t,n)),r?e.reduceRight(t,i):e.reduceRight(t);var o=e.length;if(o!==+o){var s=E.keys(e);o=s.length}if(b(e,function(a,c,l){c=s?s[--o]:--o,r?i=t.call(n,i,e[c],c,l):(i=e[c],r=!0)}),!r)throw new TypeError(A);return i},E.find=E.detect=function(e,t,i){var n;return x(e,function(e,r,o){if(t.call(i,e,r,o))return n=e,!0}),n},E.filter=E.select=function(e,t,i){var n=[];return null==e?n:f&&e.filter===f?e.filter(t,i):(b(e,function(e,r,o){t.call(i,e,r,o)&&n.push(e)}),n)},E.reject=function(e,t,i){return E.filter(e,function(e,n,r){return!t.call(i,e,n,r)},i)},E.every=E.all=function(e,t,n){t||(t=E.identity);var r=!0;return null==e?r:m&&e.every===m?e.every(t,n):(b(e,function(e,o,s){if(!(r=r&&t.call(n,e,o,s)))return i}),!!r)};var x=E.some=E.any=function(e,t,n){t||(t=E.identity);var r=!1;return null==e?r:g&&e.some===g?e.some(t,n):(b(e,function(e,o,s){if(r||(r=t.call(n,e,o,s)))return i}),!!r)};E.contains=E.include=function(e,t){return null!=e&&(y&&e.indexOf===y?-1!=e.indexOf(t):x(e,function(e){return e===t}))},E.invoke=function(e,t){var i=a.call(arguments,2),n=E.isFunction(t);return E.map(e,function(e){return(n?t:e[t]).apply(e,i)})},E.pluck=function(e,t){return E.map(e,E.property(t))},E.where=function(e,t){return E.filter(e,E.matches(t))},E.findWhere=function(e,t){return E.find(e,E.matches(t))},E.max=function(e,t,i){if(!t&&E.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var n=-1/0,r=-1/0;return b(e,function(e,o,s){var a=t?t.call(i,e,o,s):e;a>r&&(n=e,r=a)}),n},E.min=function(e,t,i){if(!t&&E.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var n=1/0,r=1/0;return b(e,function(e,o,s){var a=t?t.call(i,e,o,s):e;a<r&&(n=e,r=a)}),n},E.shuffle=function(e){var t,i=0,n=[];return b(e,function(e){t=E.random(i++),n[i-1]=n[t],n[t]=e}),n},E.sample=function(e,t,i){return null==t||i?(e.length!==+e.length&&(e=E.values(e)),e[E.random(e.length-1)]):E.shuffle(e).slice(0,Math.max(0,t))};var R=function(e){return null==e?E.identity:E.isFunction(e)?e:E.property(e)};E.sortBy=function(e,t,i){return t=R(t),E.pluck(E.map(e,function(e,n,r){return{value:e,index:n,criteria:t.call(i,e,n,r)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index}),"value")};var P=function(e){return function(t,i,n){var r={};return i=R(i),b(t,function(o,s){var a=i.call(n,o,s,t);e(r,a,o)}),r}};E.groupBy=P(function(e,t,i){E.has(e,t)?e[t].push(i):e[t]=[i]}),E.indexBy=P(function(e,t,i){e[t]=i}),E.countBy=P(function(e,t){E.has(e,t)?e[t]++:e[t]=1}),E.sortedIndex=function(e,t,i,n){for(var r=(i=R(i)).call(n,t),o=0,s=e.length;o<s;){var a=o+s>>>1;i.call(n,e[a])<r?o=a+1:s=a}return o},E.toArray=function(e){return e?E.isArray(e)?a.call(e):e.length===+e.length?E.map(e,E.identity):E.values(e):[]},E.size=function(e){return null==e?0:e.length===+e.length?e.length:E.keys(e).length},E.first=E.head=E.take=function(e,t,i){if(null!=e)return null==t||i?e[0]:t<0?[]:a.call(e,0,t)},E.initial=function(e,t,i){return a.call(e,0,e.length-(null==t||i?1:t))},E.last=function(e,t,i){if(null!=e)return null==t||i?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},E.rest=E.tail=E.drop=function(e,t,i){return a.call(e,null==t||i?1:t)},E.compact=function(e){return E.filter(e,E.identity)};var I=function(e,t,i){return t&&E.every(e,E.isArray)?c.apply(i,e):(b(e,function(e){E.isArray(e)||E.isArguments(e)?t?s.apply(i,e):I(e,t,i):i.push(e)}),i)};E.flatten=function(e,t){return I(e,t,[])},E.without=function(e){return E.difference(e,a.call(arguments,1))},E.partition=function(e,t){var i=[],n=[];return b(e,function(e){(t(e)?i:n).push(e)}),[i,n]},E.uniq=E.unique=function(e,t,i,n){E.isFunction(t)&&(n=i,i=t,t=!1);var r=i?E.map(e,i,n):e,o=[],s=[];return b(r,function(i,n){(t?n&&s[s.length-1]===i:E.contains(s,i))||(s.push(i),o.push(e[n]))}),o},E.union=function(){return E.uniq(E.flatten(arguments,!0))},E.intersection=function(e){var t=a.call(arguments,1);return E.filter(E.uniq(e),function(e){return E.every(t,function(t){return E.contains(t,e)})})},E.difference=function(e){var t=c.apply(n,a.call(arguments,1));return E.filter(e,function(e){return!E.contains(t,e)})},E.zip=function(){for(var e=E.max(E.pluck(arguments,"length").concat(0)),t=new Array(e),i=0;i<e;i++)t[i]=E.pluck(arguments,""+i);return t},E.object=function(e,t){if(null==e)return{};for(var i={},n=0,r=e.length;n<r;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},E.indexOf=function(e,t,i){if(null==e)return-1;var n=0,r=e.length;if(i){if("number"!=typeof i)return n=E.sortedIndex(e,t),e[n]===t?n:-1;n=i<0?Math.max(0,r+i):i}if(y&&e.indexOf===y)return e.indexOf(t,i);for(;n<r;n++)if(e[n]===t)return n;return-1},E.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(T&&e.lastIndexOf===T)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var r=n?i:e.length;r--;)if(e[r]===t)return r;return-1},E.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),r=0,o=new Array(n);r<n;)o[r++]=e,e+=i;return o};var w=function(){};E.bind=function(e,t){var i,n;if(C&&e.bind===C)return C.apply(e,a.call(arguments,1));if(!E.isFunction(e))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(a.call(arguments)));w.prototype=e.prototype;var r=new w;w.prototype=null;var o=e.apply(r,i.concat(a.call(arguments)));return Object(o)===o?o:r}},E.partial=function(e){var t=a.call(arguments,1);return function(){for(var i=0,n=t.slice(),r=0,o=n.length;r<o;r++)n[r]===E&&(n[r]=arguments[i++]);for(;i<arguments.length;)n.push(arguments[i++]);return e.apply(this,n)}},E.bindAll=function(e){var t=a.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return b(t,function(t){e[t]=E.bind(e[t],e)}),e},E.memoize=function(e,t){var i={};return t||(t=E.identity),function(){var n=t.apply(this,arguments);return E.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},E.delay=function(e,t){var i=a.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},E.defer=function(e){return E.delay.apply(E,[e,1].concat(a.call(arguments,1)))},E.throttle=function(e,t,i){var n,r,o,s=null,a=0;i||(i={});var c=function(){a=!1===i.leading?0:E.now(),s=null,o=e.apply(n,r),n=r=null};return function(){var l=E.now();a||!1!==i.leading||(a=l);var u=t-(l-a);return n=this,r=arguments,u<=0?(clearTimeout(s),s=null,a=l,o=e.apply(n,r),n=r=null):s||!1===i.trailing||(s=setTimeout(c,u)),o}},E.debounce=function(e,t,i){var n,r,o,s,a,c=function(){var l=E.now()-s;l<t?n=setTimeout(c,t-l):(n=null,i||(a=e.apply(o,r),o=r=null))};return function(){o=this,r=arguments,s=E.now();var l=i&&!n;return n||(n=setTimeout(c,t)),l&&(a=e.apply(o,r),o=r=null),a}},E.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},E.wrap=function(e,t){return E.partial(t,e)},E.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},E.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},E.keys=function(e){if(!E.isObject(e))return[];if(S)return S(e);var t=[];for(var i in e)E.has(e,i)&&t.push(i);return t},E.values=function(e){for(var t=E.keys(e),i=t.length,n=new Array(i),r=0;r<i;r++)n[r]=e[t[r]];return n},E.pairs=function(e){for(var t=E.keys(e),i=t.length,n=new Array(i),r=0;r<i;r++)n[r]=[t[r],e[t[r]]];return n},E.invert=function(e){for(var t={},i=E.keys(e),n=0,r=i.length;n<r;n++)t[e[i[n]]]=i[n];return t},E.functions=E.methods=function(e){var t=[];for(var i in e)E.isFunction(e[i])&&t.push(i);return t.sort()},E.extend=function(e){return b(a.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},E.pick=function(e){var t={},i=c.apply(n,a.call(arguments,1));return b(i,function(i){i in e&&(t[i]=e[i])}),t},E.omit=function(e){var t={},i=c.apply(n,a.call(arguments,1));for(var r in e)E.contains(i,r)||(t[r]=e[r]);return t},E.defaults=function(e){return b(a.call(arguments,1),function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])}),e},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e};var N=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof E&&(e=e._wrapped),t instanceof E&&(t=t._wrapped);var r=l.call(e);if(r!=l.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]==e)return n[o]==t;var s=e.constructor,a=t.constructor;if(s!==a&&!(E.isFunction(s)&&s instanceof s&&E.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1;i.push(e),n.push(t);var c=0,u=!0;if("[object Array]"==r){if(c=e.length,u=c==t.length)for(;c--&&(u=N(e[c],t[c],i,n)););}else{for(var h in e)if(E.has(e,h)&&(c++,!(u=E.has(t,h)&&N(e[h],t[h],i,n))))break;if(u){for(h in t)if(E.has(t,h)&&!c--)break;u=!c}}return i.pop(),n.pop(),u};E.isEqual=function(e,t){return N(e,t,[],[])},E.isEmpty=function(e){if(null==e)return!0;if(E.isArray(e)||E.isString(e))return 0===e.length;for(var t in e)if(E.has(e,t))return!1;return!0},E.isElement=function(e){return!(!e||1!==e.nodeType)},E.isArray=v||function(e){return"[object Array]"==l.call(e)},E.isObject=function(e){return e===Object(e)},b(["Arguments","Function","String","Number","Date","RegExp"],function(e){E["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),E.isArguments(arguments)||(E.isArguments=function(e){return!(!e||!E.has(e,"callee"))}),"function"!=typeof/./&&(E.isFunction=function(e){return"function"==typeof e}),E.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},E.isNaN=function(e){return E.isNumber(e)&&e!=+e},E.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==l.call(e)},E.isNull=function(e){return null===e},E.isUndefined=function(e){return void 0===e},E.has=function(e,t){return u.call(e,t)},E.noConflict=function(){return e._=t,this},E.identity=function(e){return e},E.constant=function(e){return function(){return e}},E.property=function(e){return function(t){return t[e]}},E.matches=function(e){return function(t){if(t===e)return!0;for(var i in e)if(e[i]!==t[i])return!1;return!0}},E.times=function(e,t,i){for(var n=Array(Math.max(0,e)),r=0;r<e;r++)n[r]=t.call(i,r);return n},E.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},E.now=Date.now||function(){return(new Date).getTime()};var L={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};L.unescape=E.invert(L.escape);var O={escape:new RegExp("["+E.keys(L.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(L.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(e){E[e]=function(t){return null==t?"":(""+t).replace(O[e],function(t){return L[e][t]})}}),E.result=function(e,t){if(null!=e){var i=e[t];return E.isFunction(i)?i.call(e):i}},E.mixin=function(e){b(E.functions(e),function(t){var i=E[t]=e[t];E.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),k.call(this,i.apply(E,e))}})};var D=0;E.uniqueId=function(e){var t=++D+"";return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(e,t,i){var n;i=E.defaults({},i,E.templateSettings);var r=new RegExp([(i.escape||F).source,(i.interpolate||F).source,(i.evaluate||F).source].join("|")+"|$","g"),o=0,s="__p+='";e.replace(r,function(t,i,n,r,a){return s+=e.slice(o,a).replace(M,function(e){return"\\"+B[e]}),i&&(s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(s+="';\n"+r+"\n__p+='"),o=a+t.length,t}),s+="';\n",i.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(i.variable||"obj","_",s)}catch(e){throw e.source=s,e}if(t)return n(t,E);var a=function(e){return n.call(this,e,E)};return a.source="function("+(i.variable||"obj")+"){\n"+s+"}",a},E.chain=function(e){return E(e).chain()};var k=function(e){return this._chain?E(e).chain():e};E.mixin(E),b(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];E.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],k.call(this,i)}}),b(["concat","join","slice"],function(e){var t=n[e];E.prototype[e]=function(){return k.call(this,t.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return E})}.call(this),function(e,t){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(i,n,r){e.Backbone=t(e,r,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");t(e,exports,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,i,n){var r=e.Backbone,o=[],s=o.slice;t.VERSION="1.1.2",t.$=n,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,i){return l(this,"on",e,[t,i])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:i,ctx:i||this}),this):this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,o=i.once(function(){r.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,n)},off:function(e,t,n){var r,o,s,a,c,u,h,d;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(c=0,u=(a=e?[e]:i.keys(this._events)).length;c<u;c++)if(e=a[c],s=this._events[e]){if(this._events[e]=r=[],t||n)for(h=0,d=s.length;h<d;h++)o=s[h],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!l(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&u(i,t),n&&u(n,arguments),this},stopListening:function(e,t,n){var r=this._listeningTo;if(!r)return this;var o=!t&&!n;n||"object"!=typeof t||(n=this),e&&((r={})[e._listenId]=e);for(var s in r)(e=r[s]).off(t,n,this),(o||i.isEmpty(e._events))&&delete this._listeningTo[s];return this}},c=/\s+/,l=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var r in i)e[t].apply(e,[r,i[r]].concat(n));return!1}if(c.test(i)){for(var o=i.split(c),s=0,a=o.length;s<a;s++)e[t].apply(e,[o[s]].concat(n));return!1}return!0},u=function(e,t){var i,n=-1,r=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<r;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=e[n]).callback.apply(i.ctx,t);return}},h={listenTo:"on",listenToOnce:"once"};i.each(h,function(e,t){a[t]=function(t,n,r){return(this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=i.uniqueId("l"))]=t,r||"object"!=typeof n||(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(t,a);var d=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(d.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,o,s,a,c,l,u,h;if(null==e)return this;if("object"==typeof e?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;s=n.unset,c=n.silent,a=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o)t=o[r],i.isEqual(h[r],t)||a.push(r),i.isEqual(u[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete h[r]:h[r]=t;if(!c){a.length&&(this._pending=n);for(var d=0,p=a.length;d<p;d++)this.trigger("change:"+a[d],this,h[a[d]],n)}if(l)return this;if(!c)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in e)i.isEqual(r[o],t=e[o])||((n||(n={}))[o]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?i.clone(e):{}).parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){if(!t.set(t.parse(i,e),e))return!1;n&&n(t,i,e),t.trigger("sync",t,i,e)},B(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,o,s,a=this.attributes;if(null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,n=i.extend({validate:!0},n),r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=i.extend({},a,r)),void 0===n.parse&&(n.parse=!0);var c=this,l=n.success;return n.success=function(e){c.attributes=a;var t=c.parse(e,n);if(n.wait&&(t=i.extend(r||{},t)),i.isObject(t)&&!c.set(t,n))return!1;l&&l(c,e,n),c.trigger("sync",c,e,n)},B(this,n),"patch"===(o=this.isNew()?"create":n.patch?"patch":"update")&&(n.attrs=r),s=this.sync(o,this,n),r&&n.wait&&(this.attributes=a),s},destroy:function(e){var t=this,n=(e=e?i.clone(e):{}).success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;B(this,e);var o=this.sync("delete",this,e);return e.wait||r(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1)}});var p=["keys","values","pairs","invert","pick","omit"];i.each(p,function(e){d.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var _=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},f={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};i.extend(_.prototype,a,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,m))},remove:function(e,t){var n=!i.isArray(e);e=n?[e]:i.clone(e),t||(t={});var r,o,s,a;for(r=0,o=e.length;r<o;r++)(a=e[r]=this.get(e[r]))&&(delete this._byId[a.id],delete this._byId[a.cid],s=this.indexOf(a),this.models.splice(s,1),this.length--,t.silent||(t.index=s,a.trigger("remove",a,this,t)),this._removeReference(a,t));return n?e[0]:e},set:function(e,t){(t=i.defaults({},t,f)).parse&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?e?[e]:[]:i.clone(e);var r,o,s,a,c,l,u,h=t.at,p=this.model,_=this.comparator&&null==h&&!1!==t.sort,m=i.isString(this.comparator)?this.comparator:null,g=[],y=[],T={},v=t.add,S=t.merge,C=t.remove,E=!(_||!v||!C)&&[];for(r=0,o=e.length;r<o;r++){if(c=e[r]||{},s=c instanceof d?a=c:c[p.prototype.idAttribute||"id"],l=this.get(s))C&&(T[l.cid]=!0),S&&(c=c===a?a.attributes:c,t.parse&&(c=l.parse(c,t)),l.set(c,t),_&&!u&&l.hasChanged(m)&&(u=!0)),e[r]=l;else if(v){if(!(a=e[r]=this._prepareModel(c,t)))continue;g.push(a),this._addReference(a,t)}a=l||a,!E||!a.isNew()&&T[a.id]||E.push(a),T[a.id]=!0}if(C){for(r=0,o=this.length;r<o;++r)T[(a=this.models[r]).cid]||y.push(a);y.length&&this.remove(y,t)}if(g.length||E&&E.length)if(_&&(u=!0),this.length+=g.length,null!=h)for(r=0,o=g.length;r<o;r++)this.models.splice(h+r,0,g[r]);else{E&&(this.models.length=0);var b=E||g;for(r=0,o=b.length;r<o;r++)this.models.push(b[r])}if(u&&this.sort({silent:!0}),!t.silent){for(r=0,o=g.length;r<o;r++)(a=g[r]).trigger("add",a,this,t);(u||E&&E.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return s.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){void 0===(e=e?i.clone(e):{}).parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var r=e.reset?"reset":"set";n[r](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},B(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;(t=t?i.clone(t):{}).collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(g,function(e){_.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var y=["groupBy","countBy","sortBy","indexBy"];i.each(y,function(e){_.prototype[e]=function(t,n){var r=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,r,n)}});var T=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,S)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},v=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName","events"];i.extend(T.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var r=t.match(v),o=r[1],s=r[2];n=i.bind(n,this),o+=".delegateEvents"+this.cid,""===s?this.$el.on(o,n):this.$el.on(o,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e.class=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,r){var o=E[e];i.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=i.result(n,"url")||F()),null!=r.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1),"PATCH"===s.type&&C&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var c=r.xhr=t.ajax(i.extend(s,r));return n.trigger("request",n,c,r),c};var C=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),E={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var b=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,x=/(\(\?)?:\w+/g,R=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(b.prototype,a,{initialize:function(){},route:function(e,n,r){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return t.history.route(e,function(i){var s=o._extractParameters(e,i);o.execute(r,s),o.trigger.apply(o,["route:"+n].concat(s)),o.trigger("route",n,s),t.history.trigger("route",o,n,s)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(A,"(?:$1)?").replace(x,function(e,t){return t?e:"([^/?]+)"}).replace(R,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var I=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},w=/^[#\/]|\s+$/g,N=/^\/+|\/+$/g,L=/msie [\w.]+/,O=/\/$/,D=/#.*$/;I.started=!1,i.extend(I.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(O,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(w,"")},start:function(e){if(I.started)throw new Error("Backbone.history has already been started");I.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,o=L.exec(navigator.userAgent.toLowerCase())&&(!r||r<=7);if(this.root=("/"+this.root+"/").replace(N,"/"),o&&this._wantsHashChange){var s=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(w,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),I.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!I.started)return!1;t&&!0!==t||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(D,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new I;d.extend=_.extend=b.extend=T.extend=I.extend=function(e,t){var n,r=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,t);var o=function(){this.constructor=n};return o.prototype=r.prototype,n.prototype=new o,e&&i.extend(n.prototype,e),n.__super__=r.prototype,n};var F=function(){throw new Error('A "url" property or function must be specified')},B=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}),function(){var e=window._,t=window.Backbone;t.Firebase=function(e){this._fbref=e,this._children=[],"string"==typeof e&&(this._fbref=new Firebase(e)),this._fbref.on("child_added",this._childAdded,this),this._fbref.on("child_moved",this._childMoved,this),this._fbref.on("child_changed",this._childChanged,this),this._fbref.on("child_removed",this._childRemoved,this)},e.extend(t.Firebase.prototype,{_getKey:function(e){return"function"==typeof e.key?e.key():e.name()},_childAdded:function(t,i){var n=t.val();if(n.id=this._getKey(t),i){var r=e.find(this._children,function(e){return e.id==i});this._children.splice(this._children.indexOf(r)+1,0,n)}else this._children.unshift(n)},_childMoved:function(t,i){var n=t.val();this._children=e.reject(this._children,function(e){return e.id==n.id}),this._childAdded(t,i)},_childChanged:function(t){var i=t.val();i.id=this._getKey(t);var n=e.find(this._children,function(e){return e.id==i.id});this._children[this._children.indexOf(n)]=i},_childRemoved:function(t){var i=t.val();this._children=e.reject(this._children,function(e){return e.id==i.id})},create:function(t,i){t.id||(t.id=this._getKey(this._fbref.ref().push()));var n=t.toJSON();this._fbref.ref().child(t.id).set(n,e.bind(function(e){e?i("Could not create model "+t.id):i(null,n)},this))},read:function(t,i){if(t.id){var n=e.find(this._children,function(e){return e.id==t.id});e.defer(i,null,this._children[n])}else e.defer(i,"Invalid model ID provided to read")},readAll:function(t,i){e.defer(i,null,this._children)},update:function(e,t){var i=e.toJSON();this._fbref.ref().child(e.id).update(i,function(n){n?t("Could not update model "+e.id,null):t(null,i)})},delete:function(e,t){this._fbref.ref().child(e.id).remove(function(i){i?t("Could not delete model "+e.id):t(null,e)})},ref:function(){return this._fbref}}),t.Firebase.sync=function(e,i,n,r){var o=i.firebase||i.collection.firebase;"function"==typeof n&&(n={success:n,error:r}),"read"==e&&void 0===i.id&&(e="readAll"),o[e].apply(o,[i,function(e,r){e?(i.trigger("error",i,e,n),"0.9.10"===t.VERSION?n.error(i,e,n):n.error(e)):(i.trigger("sync",i,r,n),"0.9.10"===t.VERSION?n.success(i,r,n):n.success(r))}])},t.oldSync=t.sync,t.sync=function(e,i,n,r){var o=t.oldSync;return(i.firebase||i.collection&&i.collection.firebase)&&(o=t.Firebase.sync),o.apply(this,[e,i,n,r])},t.Firebase.Collection=t.Collection.extend({sync:function(){this._log("Sync called on a Firebase collection, ignoring.")},fetch:function(){this._log("Fetch called on a Firebase collection, ignoring.")},constructor:function(i,n){switch(t.Collection.apply(this,arguments),n&&n.firebase&&(this.firebase=n.firebase),typeof this.firebase){case"object":break;case"string":this.firebase=new Firebase(this.firebase);break;case"function":this.firebase=this.firebase();break;default:throw new Error("Invalid firebase reference created")}this.firebase.on("child_added",e.bind(this._childAdded,this)),this.firebase.on("child_moved",e.bind(this._childMoved,this)),this.firebase.on("child_changed",e.bind(this._childChanged,this)),this.firebase.on("child_removed",e.bind(this._childRemoved,this)),this.firebase.once("value",e.bind(function(){this.trigger("sync",this,null,null)},this)),this.listenTo(this,"change",this._updateModel,this),this.listenTo(this,"destroy",this._removeModel,this),this._suppressEvent=!1},comparator:function(e){return e.id},add:function(t,i){var n=this._parseModels(t);(i=i?e.clone(i):{}).success=e.isFunction(i.success)?i.success:function(){};for(var r=0;r<n.length;r++){var o=n[r],s=this.firebase.ref().child(o.id);!0===i.silent&&(this._suppressEvent=!0),s.set(o,e.bind(i.success,o))}return n},remove:function(t,i){var n=this._parseModels(t);(i=i?e.clone(i):{}).success=e.isFunction(i.success)?i.success:function(){};for(var r=0;r<n.length;r++){var o=n[r],s=this.firebase.ref().child(o.id);!0===i.silent&&(this._suppressEvent=!0),s.set(null,e.bind(i.success,o))}return n},create:function(i,n){return(n=n?e.clone(n):{}).wait&&this._log("Wait option provided to create, ignoring."),!!(i=t.Collection.prototype._prepareModel.apply(this,[i,n]))&&this.add([i],n)[0]},reset:function(t,i){i=i?e.clone(i):{},this.remove(this.models,{silent:!0});var n=this.add(t,{silent:!0});return i.silent||this.trigger("reset",this,i),n},_log:function(e){console&&console.log&&console.log(e)},_parseModels:function(i){var n=[];i=e.isArray(i)?i.slice():[i];for(var r=0;r<i.length;r++){var o=i[r];o.toJSON&&"function"==typeof o.toJSON&&(o=o.toJSON()),o.id||(o.id=t.Firebase.prototype._getKey(this.firebase.ref().push())),n.push(o)}return n},_childAdded:function(i){var n=i.val();n.id||(e.isObject(n)||(n={}),n.id=t.Firebase.prototype._getKey(i)),!0===this._suppressEvent?(this._suppressEvent=!1,t.Collection.prototype.add.apply(this,[n],{silent:!0})):t.Collection.prototype.add.apply(this,[n]),this.get(n.id)._remoteAttributes=n},_childMoved:function(e){this._log("_childMoved called with "+e.val())},_childChanged:function(i){var n=i.val();n.id||(n.id=t.Firebase.prototype._getKey(i));var r=e.find(this.models,function(e){return e.id==n.id});if(!r)throw new Error("Could not find model with ID "+n.id);this._preventSync(r,!0),r._remoteAttributes=n;var o=e.difference(e.keys(r.attributes),e.keys(n));e.each(o,function(e){r.unset(e)}),r.set(n),this._preventSync(r,!1)},_childRemoved:function(e){var i=e.val();i.id||(i.id=t.Firebase.prototype._getKey(e)),!0===this._suppressEvent?(this._suppressEvent=!1,t.Collection.prototype.remove.apply(this,[i],{silent:!0})):t.Collection.prototype.remove.apply(this,[i])},_updateModel:function(t){if(!t._remoteChanging){var i=t._remoteAttributes||{},n=t.toJSON(),r={},o=e.union(e.keys(i),e.keys(n));if(e.each(o,function(t){e.has(n,t)?n[t]!=i[t]&&(r[t]=n[t]):r[t]=null}),e.size(r))if(e.has(r,".priority")){var s=this.firebase.ref().child(t.id),a=n[".priority"];delete n[".priority"],s.setWithPriority(n,a)}else this.firebase.ref().child(t.id).update(r)}},_removeModel:function(t,i,n){(n=n?e.clone(n):{}).success=e.isFunction(n.success)?n.success:function(){},this.firebase.ref().child(t.id).set(null,e.bind(n.success,t))},_preventSync:function(e,t){e._remoteChanging=t}}),t.Firebase.Model=t.Model.extend({save:function(){this._log("Save called on a Firebase model, ignoring.")},destroy:function(e){this.firebase.ref().set(null,this._log),this.trigger("destroy",this,this.collection,e),e.success&&e.success(this,null,e)},constructor:function(i,n){var r=e.result(this,"defaults");switch(this.once("sync",function(){this.set(e.defaults(this.toJSON(),r))}),t.Model.apply(this,arguments),n&&n.firebase&&(this.firebase=n.firebase),typeof this.firebase){case"object":break;case"string":this.firebase=new Firebase(this.firebase);break;case"function":this.firebase=this.firebase();break;default:throw new Error("Invalid firebase reference created")}this.firebase.on("value",e.bind(this._modelChanged,this)),this._listenLocalChange(!0)},_listenLocalChange:function(e){e?this.on("change",this._updateModel,this):this.off("change",this._updateModel,this)},_updateModel:function(t){var i=t.changedAttributes();e.each(t.changed,function(e,t){void 0!==e&&null!==e||("id"==t?delete i[t]:i[t]=null)}),e.size(i)&&this.firebase.ref().update(i,this._log)},_modelChanged:function(t){var i=t.val();if("object"==typeof i&&null!==i){var n=e.difference(e.keys(this.attributes),e.keys(i)),r=this;e.each(n,function(e){r.unset(e)})}this._listenLocalChange(!1),this.set(i),this._listenLocalChange(!0),this.trigger("sync",this,null,null)},_log:function(e){void 0!==e&&null!==e&&console&&console.log&&console.log(e)}})}(),function(e,t){if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(i,n){return e.Marionette=t(e,i,n)});else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");module.exports=t(e,i,n)}else e.Marionette=t(e,e.Backbone,e._)}(this,function(e,t,i){"use strict";!function(e,t){var i=e.ChildViewContainer;e.ChildViewContainer=function(e,t){var i=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(i.prototype,{add:function(e,t){var i=e.cid;return this._views[i]=e,e.model&&(this._indexByModel[e.model.cid]=i),t&&(this._indexByCustom[t]=i),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var i=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){if(e===i)return delete this._indexByCustom[t],!0},this),delete this._views[i],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,i){t.each(this._views,function(n){t.isFunction(n[e])&&n[e].apply(n,i||[])})},_updateLength:function(){this.length=t.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return t.each(n,function(e){i.prototype[e]=function(){var i=[t.values(this._views)].concat(t.toArray(arguments));return t[e].apply(t,i)}}),i}(0,t),e.ChildViewContainer.VERSION="0.1.4",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=i,this},e.ChildViewContainer}(t,i),function(e,t){var i=e.Wreqr,n=e.Wreqr={};e.Wreqr.VERSION="1.3.1",e.Wreqr.noConflict=function(){return e.Wreqr=i,this},n.Handlers=function(e,t){var i=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,i){var n=null;t.isObject(e)&&!t.isFunction(e)&&(n=e.context,e=e.callback),this.setHandler(i,e,n)},this)},setHandler:function(e,t,i){var n={callback:t,context:i};this._wreqrHandlers[e]=n,this.trigger("handler:add",e,t,i)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),i}(e,t),n.CommandStorage=function(){var i=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(i.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){this.getCommands(e).instances.push(t)},clearCommands:function(e){this.getCommands(e).instances=[]}}),i}(),n.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var i=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,i)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,i,n){var r=this.storage.getCommands(e);t.each(r.instances,function(e){i.apply(n,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var i,n=e.storageType||this.storageType;i=t.isFunction(n)?new n:n,this.storage=i}})}(n),n.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);if(this.hasHandler(e))return this.getHandler(e).apply(this,t)}})}(n),n.EventAggregator=function(e,t){var i=function(){};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events),i}(e,t),n.Channel=function(i){var n=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,i,n){if(i){n=n||this;var r="vent"===e?"on":"setHandler";t.each(i,function(i,o){this[e][r](o,t.bind(i,n))},this)}}}),n}(),n.radio=function(e){var i=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(i.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var i=this._channels[t];return i||(i=new e.Channel(t),this._channels[t]=i),i},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(n[e],function(t){this[e][t]=r(this,e,t)},this)},this)}});var n={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(e,t,i){return function(n){var r=e._getChannel(n)[t],o=Array.prototype.slice.call(arguments,1);return r[i].apply(r,o)}};return new i}(n),e.Wreqr}(t,i);var n=e.Marionette,r=t.Marionette={};r.VERSION="2.2.2",r.noConflict=function(){return e.Marionette=n,this},t.Marionette=r,r.Deferred=t.$.Deferred;var o=Array.prototype.slice;r.extend=t.Model.extend,r.getOption=function(e,t){if(e&&t){return e.options&&void 0!==e.options[t]?e.options[t]:e[t]}},r.proxyGetOption=function(e){return r.getOption(this,e)},r.normalizeMethods=function(e){var t={};return i.each(e,function(e,n){i.isFunction(e)||(e=this[e]),e&&(t[n]=e)},this),t},r.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(e){return t[e.slice(4)]})},r.normalizeUIKeys=function(e,t){if(void 0!==e)return e=i.clone(e),i.each(i.keys(e),function(i){var n=r.normalizeUIString(i,t);n!==i&&(e[n]=e[i],delete e[i])}),e},r.normalizeUIValues=function(e,t){if(void 0!==e)return i.each(e,function(n,o){i.isString(n)&&(e[o]=r.normalizeUIString(n,t))}),e},r.actAsCollection=function(e,t){var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];i.each(n,function(n){e[n]=function(){var e=[i.values(i.result(this,t))].concat(i.toArray(arguments));return i[n].apply(i,e)}})},r.triggerMethod=function(e){var t,n=/(^|:)(\w)/gi,r=this["on"+e.replace(n,function(e,t,i){return i.toUpperCase()})];return i.isFunction(r)&&(t=r.apply(this,i.tail(arguments))),i.isFunction(this.trigger)&&this.trigger.apply(this,arguments),t},r.triggerMethodOn=function(e,t){var n=i.tail(arguments,2);return(i.isFunction(e.triggerMethod)?e.triggerMethod:r.triggerMethod).apply(e,[t].concat(n))},r.MonitorDOMRefresh=function(e){function n(e){e._isShown=!0,o(e)}function r(e){e._isRendered=!0,o(e)}function o(e){e._isShown&&e._isRendered&&s(e)&&i.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}function s(i){return t.$.contains(e,i.el)}return function(e){e.listenTo(e,"show",function(){n(e)}),e.listenTo(e,"render",function(){r(e)})}}(document.documentElement),function(e){function t(t,n,r,o){var s=o.split(/\s+/);i.each(s,function(i){var o=t[i];if(!o)throw new e.Error('Method "'+i+'" was configured as an event handler, but does not exist.');t.listenTo(n,r,o)})}function n(e,t,i,n){e.listenTo(t,i,n)}function r(e,t,n,r){var o=r.split(/\s+/);i.each(o,function(i){var r=e[i];e.stopListening(t,n,r)})}function o(e,t,i,n){e.stopListening(t,i,n)}function s(t,n,r,o,s){if(n&&r){if(!i.isFunction(r)&&!i.isObject(r))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});i.isFunction(r)&&(r=r.call(t)),i.each(r,function(e,r){i.isFunction(e)?o(t,n,r,e):s(t,n,r,e)})}}e.bindEntityEvents=function(e,i,r){s(e,i,r,n,t)},e.unbindEntityEvents=function(e,t,i){s(e,t,i,o,r)},e.proxyBindEntityEvents=function(t,i){return e.bindEntityEvents(this,t,i)},e.proxyUnbindEntityEvents=function(t,i){return e.unbindEntityEvents(this,t,i)}}(r);var s=["description","fileName","lineNumber","name","message","number"];return r.Error=r.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+r.VERSION+"/",constructor:function(e,t){i.isObject(e)?e=(t=e).message:t||(t={});var n=Error.call(this,e);i.extend(this,i.pick(n,s),i.pick(t,s)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,r.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),r.Error.extend=r.extend,r.Callbacks=function(){this._deferred=r.Deferred(),this._callbacks=[]},i.extend(r.Callbacks.prototype,{add:function(e,t){var n=i.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),n.then(function(i){t&&(i.context=t),e.call(i.context,i.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=r.Deferred(),this._callbacks=[],i.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),r.Controller=function(e){this.options=e||{},i.isFunction(this.initialize)&&this.initialize(this.options)},r.Controller.extend=r.extend,i.extend(r.Controller.prototype,t.Events,{destroy:function(){var e=o.call(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.triggerMethod.apply(this,["destroy"].concat(e)),this.stopListening(),this.off(),this},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption}),r.Object=function(e){this.options=i.extend({},i.result(this,"options"),e),this.initialize.apply(this,arguments)},r.Object.extend=r.extend,i.extend(r.Object.prototype,{initialize:function(){},destroy:function(){this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening()},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),i.extend(r.Object.prototype,t.Events),r.Region=function(e){if(this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el,!this.el)throw new r.Error({name:"NoElError",message:'An "el" must be specified for a region.'});if(this.$el=this.getEl(this.el),this.initialize){var i=o.apply(arguments);this.initialize.apply(this,i)}},i.extend(r.Region,{buildRegion:function(e,t){if(i.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(i.isFunction(e))return this._buildRegionFromRegionClass(e);throw new r.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,n){var r=e.regionClass||n,o=i.omit(e,"selector","regionClass");e.selector&&!o.el&&(o.el=e.selector);var s=new r(o);return e.parentEl&&(s.getEl=function(n){if(i.isObject(n))return t.$(n);var r=e.parentEl;return i.isFunction(r)&&(r=r()),r.find(n)}),s},_buildRegionFromRegionClass:function(e){return new e}}),i.extend(r.Region.prototype,t.Events,{show:function(e,t){this._ensureElement();var i=t||{},n=e!==this.currentView,o=!!i.preventDestroy,s=!!i.forceShow,a=!!this.currentView,c=n&&!o,l=n||s;return a&&this.triggerMethod("before:swapOut",this.currentView),c&&this.empty(),l?(e.once("destroy",this.empty,this),e.render(),a&&this.triggerMethod("before:swap",e),this.triggerMethod("before:show",e),r.triggerMethodOn(e,"before:show"),this.attachHtml(e),a&&this.triggerMethod("swapOut",this.currentView),this.currentView=e,a&&this.triggerMethod("swap",e),this.triggerMethod("show",e),r.triggerMethodOn(e,"show"),this):this},_ensureElement:function(){if(i.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length)throw new r.Error('An "el" '+this.$el.selector+" must exist in DOM")},getEl:function(e){return t.$(e)},attachHtml:function(e){this.el.innerHTML="",this.el.appendChild(e.el)},empty:function(){var e=this.currentView;if(e)return e.off("destroy",this.empty,this),this.triggerMethod("before:empty",e),this._destroyView(),this.triggerMethod("empty",e),delete this.currentView,this},_destroyView:function(){var e=this.currentView;e.destroy&&!e.isDestroyed?e.destroy():e.remove&&e.remove()},attachView:function(e){return this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this},getOption:r.proxyGetOption,triggerMethod:r.triggerMethod}),r.Region.extend=r.extend,r.RegionManager=function(e){var t=e.Controller.extend({constructor:function(t){this._regions={},e.Controller.call(this,t)},addRegions:function(e,t){i.isFunction(e)&&(e=e.apply(this,arguments));var n={};return i.each(e,function(e,r){i.isString(e)&&(e={selector:e}),e.selector&&(e=i.defaults({},e,t));var o=this.addRegion(r,e);n[r]=o},this),n},addRegion:function(t,i){var n;return n=i instanceof e.Region?i:e.Region.buildRegion(i,e.Region),this.triggerMethod("before:add:region",t,n),this._store(t,n),this.triggerMethod("add:region",t,n),n},get:function(e){return this._regions[e]},getRegions:function(){return i.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return i.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return i.each(e,function(e){e.empty()},this),e},destroy:function(){return this.removeRegions(),e.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]=t,this._setLength()},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete this._regions[e],this._setLength(),this.triggerMethod("remove:region",e,t)},_setLength:function(){this.length=i.size(this._regions)}});return e.actAsCollection(t.prototype,"_regions"),t}(r),r.TemplateCache=function(e){this.templateId=e},i.extend(r.TemplateCache,{templateCaches:{},get:function(e){var t=this.templateCaches[e];return t||(t=new r.TemplateCache(e),this.templateCaches[e]=t),t.load()},clear:function(){var e,t=o.call(arguments),i=t.length;if(i>0)for(e=0;e<i;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),i.extend(r.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(e),this.compiledTemplate},loadTemplate:function(e){var i=t.$(e).html();if(!i||0===i.length)throw new r.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return i},compileTemplate:function(e){return i.template(e)}}),r.Renderer={render:function(e,t){if(!e)throw new r.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});return("function"==typeof e?e:r.TemplateCache.get(e))(t)}},r.View=t.View.extend({constructor:function(e){i.bindAll(this,"render"),this.options=i.extend({},i.result(this,"options"),i.isFunction(e)?e.call(this):e),this._behaviors=r.Behaviors(this),t.View.apply(this,arguments),r.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,o.call(arguments,1))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return i.isFunction(t)&&(t=t.call(this)),i.extend(e,t)},normalizeUIKeys:function(e){var t=i.result(this,"ui"),n=i.result(this,"_uiBindings");return r.normalizeUIKeys(e,n||t)},normalizeUIValues:function(e){var t=i.result(this,"ui"),n=i.result(this,"_uiBindings");return r.normalizeUIValues(e,n||t)},configureTriggers:function(){if(this.triggers){var e={},t=this.normalizeUIKeys(i.result(this,"triggers"));return i.each(t,function(t,i){e[i]=this._buildViewTrigger(t)},this),e}},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var n=e||this.events;i.isFunction(n)&&(n=n.call(this)),n=this.normalizeUIKeys(n),i.isUndefined(e)&&(this.events=n);var r={},o=i.result(this,"behaviorEvents")||{},s=this.configureTriggers(),a=i.result(this,"behaviorTriggers")||{};i.extend(r,o,n,s,a),t.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){var e=o.call(arguments);return t.View.prototype.undelegateEvents.apply(this,e),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},onShowCalled:function(){},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new r.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(!this.isDestroyed){var e=o.call(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.remove(),i.invoke(this._behaviors,"destroy",e),this}},bindUIElements:function(){this._bindUIElements(),i.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=i.result(this,"_uiBindings");this.ui={},i.each(i.keys(e),function(t){var i=e[t];this.ui[t]=this.$(i)},this)}},unbindUIElements:function(){this._unbindUIElements(),i.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(e){var t=i.isObject(e),n=i.defaults({},t?e:{},{preventDefault:!0,stopPropagation:!0}),r=t?n.event:e;return function(e){e&&(e.preventDefault&&n.preventDefault&&e.preventDefault(),e.stopPropagation&&n.stopPropagation&&e.stopPropagation());var t={view:this,model:this.model,collection:this.collection};this.triggerMethod(r,t)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return i.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=arguments,t=r.triggerMethod,n=t.apply(this,e);return i.each(this._behaviors,function(i){t.apply(i,e)}),n},normalizeMethods:r.normalizeMethods,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),r.ItemView=r.View.extend({constructor:function(){r.View.apply(this,arguments)},serializeData:function(){var e={};return this.model?e=i.partial(this.serializeModel,this.model).apply(this,arguments):this.collection&&(e={items:i.partial(this.serializeCollection,this.collection).apply(this,arguments)}),e},serializeCollection:function(e){return e.toJSON.apply(e,o.call(arguments,1))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(!1!==e){if(!e)throw new r.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.serializeData();t=this.mixinTemplateHelpers(t);var i=r.Renderer.render(e,t,this);return this.attachElContent(i),this}},attachElContent:function(e){return this.$el.html(e),this},destroy:function(){if(!this.isDestroyed)return r.View.prototype.destroy.apply(this,arguments)}}),r.CollectionView=r.View.extend({childViewEventPrefix:"childview",constructor:function(e){var t=e||{};this.sort=!!i.isUndefined(t.sort)||t.sort,this.once("render",this._initialEvents),this._initChildViewStorage(),r.View.apply(this,arguments),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this._triggerBeforeShowBufferedChildren(),this.attachBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerBeforeShowBufferedChildren:function(){this._isShown&&i.each(this._bufferedChildren,i.partial(this._triggerMethodOnChild,"before:show"))},_triggerShowBufferedChildren:function(){this._isShown&&(i.each(this._bufferedChildren,i.partial(this._triggerMethodOnChild,"show")),this._bufferedChildren=[])},_triggerMethodOnChild:function(e,t){r.triggerMethodOn(t,e)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e){this.destroyEmptyView();var t=this.getChildView(e),i=this.collection.indexOf(e);this.addChild(e,t,i)},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},onShowCalled:function(){this.children.each(i.partial(this._triggerMethodOnChild,"show"))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.triggerMethod("render",this),this},resortView:function(){this.render()},_sortViews:function(){this.collection.find(function(e,t){var i=this.children.findByModel(e);return!i||i._index!==t},this)&&this.resortView()},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren(),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this))},showCollection:function(){var e;this.collection.each(function(t,i){e=this.getChildView(t),this.addChild(t,e,i)},this)},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var i=new t.Model;this.addEmptyView(i,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var n=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");i.isFunction(n)&&(n=n.call(this));var o=this.buildChildView(e,t,n);this.proxyChildEvents(o),this._isShown&&r.triggerMethodOn(o,"before:show"),this.children.add(o),this.renderChildView(o,-1),this._isShown&&r.triggerMethodOn(o,"show")},getChildView:function(e){var t=this.getOption("childView");if(!t)throw new r.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(e,t,n){var r=this.getOption("childViewOptions");i.isFunction(r)&&(r=r.call(this,e,n));var o=this.buildChildView(e,t,r);return this._updateIndices(o,!0,n),this._addChildView(o,n),o},_updateIndices:function(e,t,i){this.sort&&(t?(e._index=i,this.children.each(function(t){t._index>=e._index&&t._index++})):this.children.each(function(t){t._index>=e._index&&t._index--}))},_addChildView:function(e,t){this.proxyChildEvents(e),this.triggerMethod("before:add:child",e),this.children.add(e),this.renderChildView(e,t),this._isShown&&!this.isBuffering&&r.triggerMethodOn(e,"show"),this.triggerMethod("add:child",e)},renderChildView:function(e,t){return e.render(),this.attachHtml(this,e,t),e},buildChildView:function(e,t,n){return new t(i.extend({model:e},n))},removeChildView:function(e){return e&&(this.triggerMethod("before:remove:child",e),e.destroy?e.destroy():e.remove&&e.remove(),this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1)),e},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},attachHtml:function(e,t,i){e.isBuffering?(e.elBuffer.appendChild(t.el),e._bufferedChildren.push(t)):e._insertBefore(t,i)||e._insertAfter(t)},_insertBefore:function(e,t){var i;return this.sort&&t<this.children.length-1&&(i=this.children.find(function(e){return e._index===t+1})),!!i&&(i.$el.before(e.el),!0)},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){if(!this.isDestroyed)return this.triggerMethod("before:destroy:collection"),this.destroyChildren(),this.triggerMethod("destroy:collection"),r.View.prototype.destroy.apply(this,arguments)},destroyChildren:function(){var e=this.children.map(i.identity);return this.children.each(this.removeChildView,this),this.checkEmpty(),e},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var n=o.call(arguments),r=n[0],s=this.normalizeMethods(i.result(this,"childEvents"));n[0]=t+":"+r,n.splice(1,0,e),void 0!==s&&i.isFunction(s[r])&&s[r].apply(this,n.slice(1)),this.triggerMethod.apply(this,n)},this)}}),r.CompositeView=r.CollectionView.extend({constructor:function(){r.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(e){var t=this.getOption("childView")||this.constructor;if(!t)throw new r.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},serializeData:function(){var e={};return this.model&&(e=i.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this.isRendered=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this.triggerMethod("render",this),this},_renderChildren:function(){this.isRendered&&r.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),i=r.Renderer.render(t,e,this);this.attachElContent(i),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){this.getChildViewContainer(e).append(t)},_insertAfter:function(e){this.getChildViewContainer(this).append(e.el)},getChildViewContainer:function(e){if("$childViewContainer"in e)return e.$childViewContainer;var t,n=r.getOption(e,"childViewContainer");if(n){var o=i.isFunction(n)?n.call(e):n;if((t="@"===o.charAt(0)&&e.ui?e.ui[o.substr(4)]:e.$(o)).length<=0)throw new r.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else t=e.$el;return e.$childViewContainer=t,t},resetChildViewContainer:function(){this.$childViewContainer&&delete this.$childViewContainer}}),r.LayoutView=r.ItemView.extend({regionClass:r.Region,constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),r.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),r.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.regionManager.destroy(),r.ItemView.prototype.destroy.apply(this,arguments))},addRegion:function(e,t){var i={};return i[e]=t,this._buildRegions(i)[e]},addRegions:function(e){return this.regions=i.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t=this,i={regionClass:this.getOption("regionClass"),parentEl:function(){return t.$el}};return this.regionManager.addRegions(e,i)},_initializeRegions:function(e){var t;this._initRegionManager(),t=i.isFunction(this.regions)?this.regions(e):this.regions||{};var n=this.getOption.call(e,"regions");i.isFunction(n)&&(n=n.call(this,e)),i.extend(t,n),t=this.normalizeUIValues(t),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.emptyRegions(),this.regionManager.each(function(e){e.reset()})},getRegionManager:function(){return new r.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})}}),r.Behavior=function(e,t){function i(t,i){this.view=i,this.defaults=e.result(this,"defaults")||{},this.options=e.extend({},this.defaults,t),this.$=function(){return this.view.$.apply(this.view,arguments)},this.initialize.apply(this,arguments)}return e.extend(i.prototype,t.Events,{initialize:function(){},destroy:function(){this.stopListening()},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),i.extend=r.extend,i}(i,t),r.Behaviors=function(e,t){function i(e,n){return t.isObject(e.behaviors)?(n=i.parseBehaviors(e,n||t.result(e,"behaviors")),i.wrap(e,n,t.keys(r)),n):{}}function n(e,i){this._view=e,this._viewUI=t.result(e,"ui"),this._behaviors=i,this._triggers={}}var r={behaviorTriggers:function(e,t){return new n(this,t).buildBehaviorTriggers()},behaviorEvents:function(i,n){var r={},o=t.result(this,"ui");return t.each(n,function(i,n){var s={},a=t.clone(t.result(i,"events"))||{},c=t.result(i,"ui"),l=t.extend({},o,c);a=e.normalizeUIKeys(a,l),t.each(t.keys(a),function(e){var r=e+new Array(n+2).join(" "),o=t.isFunction(a[e])?a[e]:i[a[e]];s[r]=t.bind(o,i)}),r=t.extend(r,s)}),r}};return t.extend(i,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(e,n){return e.behaviorClass?e.behaviorClass:t.isFunction(i.behaviorsLookup)?i.behaviorsLookup.apply(this,arguments)[n]:i.behaviorsLookup[n]},parseBehaviors:function(e,n){return t.chain(n).map(function(n,r){var o=new(i.getBehaviorClass(n,r))(n,e),s=i.parseBehaviors(e,t.result(o,"behaviors"));return[o].concat(s)}).flatten().value()},wrap:function(e,i,n){t.each(n,function(n){e[n]=t.partial(r[n],e[n],i)})}}),t.extend(n.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(i,n){var r=t.extend({},this._viewUI,t.result(i,"ui")),o=t.clone(t.result(i,"triggers"))||{};o=e.normalizeUIKeys(o,r),t.each(o,t.partial(this._setHandlerForBehavior,i,n),this)},_setHandlerForBehavior:function(e,t,i,n){var r=n.replace(/^\S+/,function(e){return e+".behaviortriggers"+t});this._triggers[r]=this._view._buildViewTrigger(i)}}),i}(r,i),r.AppRouter=t.Router.extend({constructor:function(e){t.Router.apply(this,arguments),this.options=e||{};var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var i=this._getController();this._addAppRoute(i,e,t)},_processOnRoute:function(e,t){var n=i.invert(this.getOption("appRoutes"))[e];i.isFunction(this.onRoute)&&this.onRoute(e,n,t)},processAppRoutes:function(e,t){if(t){var n=i.keys(t).reverse();i.each(n,function(i){this._addAppRoute(e,i,t[i])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,n){var o=e[n];if(!o)throw new r.Error('Method "'+n+'" was not found on the controller');this.route(t,n,i.bind(o,e))},getOption:r.proxyGetOption}),r.Application=function(e){this.options=e,this._initializeRegions(e),this._initCallbacks=new r.Callbacks,this.submodules={},i.extend(this,e),this._initChannel(),this.initialize.apply(this,arguments)},i.extend(r.Application.prototype,t.Events,{initialize:function(){},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var i=r.Module.getClass(t),n=o.call(arguments);return n.unshift(this),i.create.apply(i,n)},getRegionManager:function(){return new r.RegionManager},_initializeRegions:function(e){var t=i.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var n=r.getOption(e,"regions");return i.isFunction(n)&&(n=n.call(this,e)),i.extend(t,n),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this.listenTo(this._regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this._regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this._regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_initChannel:function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=i.result(this,"vent")||this.channel.vent,this.commands=i.result(this,"commands")||this.channel.commands,this.reqres=i.result(this,"reqres")||this.channel.reqres},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption}),r.Application.extend=r.extend,r.Module=function(e,t,n){this.moduleName=e,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,i.isFunction(this.initialize)&&this.initialize(e,t,this.options)},r.Module.extend=r.extend,i.extend(r.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(i.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),i.each(this.submodules,function(e){e.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,n){if(e){var o=i.flatten([this,this.app,t,r,t.$,i,n]);e.apply(this,o)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new r.Callbacks,this._finalizerCallbacks=new r.Callbacks},triggerMethod:r.triggerMethod}),i.extend(r.Module,{create:function(e,t,n){var r=e,s=o.call(arguments);s.splice(0,3);var a=(t=t.split(".")).length,c=[];return c[a-1]=n,i.each(t,function(t,i){var o=r;r=this._getModule(o,t,e,n),this._addModuleDefinition(o,r,c[i],s)},this),r},_getModule:function(e,t,n,r,o){var s=i.extend({},r),a=this.getClass(r),c=e[t];return c||(c=new a(t,n,s),e[t]=c,e.submodules[t]=c),c},getClass:function(e){var t=r.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,i,n){var r=this._getDefine(i),o=this._getStartWithParent(i,t);r&&t.addDefinition(r,n),this._addStartWithParent(e,t,o)},_getStartWithParent:function(e,t){var n;return i.isFunction(e)&&e.prototype instanceof r.Module?(n=t.constructor.prototype.startWithParent,!!i.isUndefined(n)||n):!i.isObject(e)||(n=e.startWithParent,!!i.isUndefined(n)||n)},_getDefine:function(e){return!i.isFunction(e)||e.prototype instanceof r.Module?i.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,i){t.startWithParent=t.startWithParent&&i,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),r}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(t,n){var r,o,s,a=t.nodeName.toLowerCase();return"area"===a?(r=t.parentNode,o=r.name,!(!t.href||!o||"map"!==r.nodeName.toLowerCase())&&(!!(s=e("img[usemap='#"+o+"']")[0])&&i(s))):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),n="absolute"===i,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return(!n||"static"!==t.css("position"))&&r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var n=e.attr(i,"tabindex"),r=isNaN(n);return(r||n>=0)&&t(i,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function n(t,i,n,o){return e.each(r,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?s["inner"+i].call(this):this.each(function(){e(this).css(o,n(this,t)+"px")})},e.fn["outer"+i]=function(t,r){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){e(this).css(o,n(this,t,!0,r)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,n,r=e(this[0]);r.length&&r[0]!==document;){if(("absolute"===(i=r.css("position"))||"relative"===i||"fixed"===i)&&(n=parseInt(r.css("zIndex"),10),!isNaN(n)&&0!==n))return n;r=r.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var r,o=e.ui[t].prototype;for(r in n)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([i,n[r]])},call:function(e,t,i,n){var r,o=e.plugins[t];if(o&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;o.length>r;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,i)}};var n=0,r=Array.prototype.slice;e.cleanData=function(t){return function(i){var n,r,o;for(o=0;null!=(r=i[o]);o++)try{(n=e._data(r,"events"))&&n.remove&&e(r).triggerHandler("remove")}catch(e){}t(i)}}(e.cleanData),e.widget=function(t,i,n){var r,o,s,a,c={},l=t.split(".")[0];return t=t.split(".")[1],r=l+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[l]=e[l]||{},o=e[l][t],s=e[l][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),a=new i,a.options=e.widget.extend({},a.options),e.each(n,function(t,n){return e.isFunction(n)?void(c[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},r=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=n.apply(this,arguments),this._super=i,this._superApply=o,t}}()):void(c[t]=n)}),s.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||t:t},c,{constructor:s,namespace:l,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,s,i._proto)}),delete o._childConstructors):i._childConstructors.push(s),e.widget.bridge(t,s),s},e.widget.extend=function(t){for(var i,n,o=r.call(arguments,1),s=0,a=o.length;a>s;s++)for(i in o[s])n=o[s][i],o[s].hasOwnProperty(i)&&void 0!==n&&(t[i]=e.isPlainObject(n)?e.isPlainObject(t[i])?e.widget.extend({},t[i],n):e.widget.extend({},n):n);return t},e.widget.bridge=function(t,i){var n=i.prototype.widgetFullName||t;e.fn[t]=function(o){var s="string"==typeof o,a=r.call(arguments,1),c=this;return o=!s&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,s?this.each(function(){var i,r=e.data(this,n);return"instance"===o?(c=r,!1):r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(i=r[o].apply(r,a))!==r&&void 0!==i?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0:e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,n);t?(t.option(o||{}),t._init&&t._init()):e.data(this,n,new i(o,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,r,o,s=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(s={},n=t.split("."),t=n.shift(),n.length){for(r=s[t]=e.widget.extend({},this.options[t]),o=0;n.length-1>o;o++)r[n[o]]=r[n[o]]||{},r=r[n[o]];if(t=n.pop(),1===arguments.length)return void 0===r[t]?null:r[t];r[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];s[t]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var r,o=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=r=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,r=this.widget()),e.each(n,function(n,s){function a(){return t||!0!==o.options.disabled&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||e.guid++);var c=n.match(/^([\w:-]*)\s*(.*)$/),l=c[1]+o.eventNamespace,u=c[2];u?r.delegate(u,l,a):i.bind(l,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var r,o,s=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(r in o)r in i||(i[r]=o[r]);return this.element.trigger(i,n),!(e.isFunction(s)&&!1===s.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,r,o){"string"==typeof r&&(r={effect:r});var s,a=r?!0===r||"number"==typeof r?i:r.effect||i:t;"number"==typeof(r=r||{})&&(r={duration:r}),s=!e.isEmptyObject(r),r.complete=o,r.delay&&n.delay(r.delay),s&&e.effects&&e.effects.effect[a]?n[t](r):a!==t&&n[a]?n[a](r.duration,r.easing,o):n.queue(function(i){e(this)[t](),o&&o.call(n[0]),i()})}}),e.widget;var o=!1;e(document).mouseup(function(){o=!1}),e.widget("ui.mouse",{version:"1.11.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!o){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,n=1===t.which,r=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&e(t.target).closest(this.options.cancel).length;return!(n&&!r&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),o=!0,!0))}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),o=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.widget("ui.draggable",e.ui.mouse,{version:"1.11.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var i=this.document[0],n=this.options;try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(e){}return!(this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(e(!0===n.iframeFix?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0))},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(!1===this._trigger("drag",t,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?e(this.helper).addClass("ui-draggable-reverting").velocity({translateY:"0px"},parseInt(this.options.revertDuration,10),function(){!1!==i._trigger("stop",t)&&i._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,r=this.options,o=this.document[0];return this.relativeContainer=null,r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),i=e(r.containment),void((n=i[0])&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,r,o,s=this.options,a=this._isRootNode(this.scrollParent[0]),c=e.pageX,l=e.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(c=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(c=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),s.grid&&(r=s.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,l=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-s.grid[1]:r+s.grid[1]:r,o=s.grid[0]?this.originalPageX+Math.round((c-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,c=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-s.grid[0]:o+s.grid[0]:o),"y"===s.axis&&(c=this.originalPageX),"x"===s.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:c-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,n){var r=n.options,o=e.extend({},i,{item:n.element});n.sortables=[],e(r.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,o))})},stop:function(t,i,n){var r=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,r))})},drag:function(t,i,n){var r=this;e.each(n.sortables,function(){var o=!1,s=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==s&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(s.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,n){var r=e("body"),o=n.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(t,i,n){var r=n.options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,n){var r=e(i.helper),o=n.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(t,i,n){var r=n.options;r._opacity&&e(i.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,n){var r=n.options,o=!1,s=n.scrollParentNotHidden[0],a=n.document[0];s!==a&&"HTML"!==s.tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+s.offsetHeight-t.pageY<r.scrollSensitivity?s.scrollTop=o=s.scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(s.scrollTop=o=s.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+s.offsetWidth-t.pageX<r.scrollSensitivity?s.scrollLeft=o=s.scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(s.scrollLeft=o=s.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(a).scrollTop()<r.scrollSensitivity?o=e(a).scrollTop(e(a).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(a).scrollTop())<r.scrollSensitivity&&(o=e(a).scrollTop(e(a).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(a).scrollLeft()<r.scrollSensitivity?o=e(a).scrollLeft(e(a).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(a).scrollLeft())<r.scrollSensitivity&&(o=e(a).scrollLeft(e(a).scrollLeft()+r.scrollSpeed)))),!1!==o&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,n){var r=n.options;n.snapElements=[],e(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var t=e(this),i=t.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,n){var r,o,s,a,c,l,u,h,d,p,_=n.options,f=_.snapTolerance,m=i.offset.left,g=m+n.helperProportions.width,y=i.offset.top,T=y+n.helperProportions.height;for(d=n.snapElements.length-1;d>=0;d--)c=n.snapElements[d].left,l=c+n.snapElements[d].width,u=n.snapElements[d].top,h=u+n.snapElements[d].height,c-f>g||m>l+f||u-f>T||y>h+f||!e.contains(n.snapElements[d].item.ownerDocument,n.snapElements[d].item)?(n.snapElements[d].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=!1):("inner"!==_.snapMode&&(r=f>=Math.abs(u-T),o=f>=Math.abs(h-y),s=f>=Math.abs(c-g),a=f>=Math.abs(l-m),r&&(i.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top-n.margins.top),o&&(i.position.top=n._convertPositionTo("relative",{top:h,left:0}).top-n.margins.top),s&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c-n.helperProportions.width}).left-n.margins.left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left-n.margins.left)),p=r||o||s||a,"outer"!==_.snapMode&&(r=f>=Math.abs(u-y),o=f>=Math.abs(h-T),s=f>=Math.abs(c-m),a=f>=Math.abs(l-g),r&&(i.position.top=n._convertPositionTo("relative",{top:u,left:0}).top-n.margins.top),o&&(i.position.top=n._convertPositionTo("relative",{top:h-n.helperProportions.height,left:0}).top-n.margins.top),s&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c}).left-n.margins.left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[d].snapping&&(r||o||s||a||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=r||o||s||a||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,n){var r,o=n.options,s=e.makeArray(e(o.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});s.length&&(r=parseInt(e(s[0]).css("zIndex"),10)||0,e(s).each(function(t){e(this).css("zIndex",r+t)}),this.css("zIndex",r+s.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,n){var r=e(i.helper),o=n.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(t,i,n){var r=n.options;r._zIndex&&e(i.helper).css("zIndex",r._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.1",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var n=e.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var n=i||e.ui.ddmanager.current,r=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===n.options.scope&&i.accept.call(i.element[0],n.currentItem||n.element)&&e.ui.intersect(n,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(r=!0,!1):void 0}),!r&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(n)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,n,r){if(!i.offset)return!1;var o=(t.positionAbs||t.position.absolute).left,s=(t.positionAbs||t.position.absolute).top,a=o+t.helperProportions.width,c=s+t.helperProportions.height,l=i.offset.left,u=i.offset.top,h=l+i.proportions().width,d=u+i.proportions().height;switch(n){case"fit":return o>=l&&h>=a&&s>=u&&d>=c;case"intersect":return o+t.helperProportions.width/2>l&&h>a-t.helperProportions.width/2&&s+t.helperProportions.height/2>u&&d>c-t.helperProportions.height/2;case"pointer":return e(r.pageY,u,i.proportions().height)&&e(r.pageX,l,i.proportions().width);case"touch":return(s>=u&&d>=s||c>=u&&d>=c||u>s&&c>d)&&(o>=l&&h>=o||a>=l&&h>=a||l>o&&a>h);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var n,r,o=e.ui.ddmanager.droppables[t.options.scope]||[],s=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(n=0;o.length>n;n++)if(!(o[n].options.disabled||t&&!o[n].accept.call(o[n].element[0],t.currentItem||t.element))){for(r=0;a.length>r;r++)if(a[r]===o[n].element[0]){o[n].proportions().height=0;continue e}o[n].visible="none"!==o[n].element.css("display"),o[n].visible&&("mousedown"===s&&o[n]._activate.call(o[n],i),o[n].offset=o[n].element.offset(),o[n].proportions({width:o[n].element[0].offsetWidth,height:o[n].element[0].offsetHeight}))}},drop:function(t,i){var n=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,r,o,s=e.ui.intersect(t,this,this.options.tolerance,i),a=!s&&this.isover?"isout":s&&!this.isover?"isover":null;a&&(this.options.greedy&&(r=this.options.scope,(o=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===r})).length&&(n=e(o[0]).droppable("instance"),n.greedyChild="isover"===a)),n&&"isover"===a&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),n&&"isout"===a&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable}),ccConfig=document.ccConfig={renderMode:2,frameRate:60,debugMode:1,showFPS:!1,id:"app-gamecanvas"},(cc=cc||{})._loadingImage="data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7",cc._fpsImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfcAgcQLxxUBNp/AAAQZ0lEQVR42u2be3QVVZbGv1N17829eRLyIKAEOiISEtPhJTJAYuyBDmhWjAEx4iAGBhxA4wABbVAMWUAeykMCM+HRTcBRWkNH2l5moS0LCCrQTkYeQWBQSCAIgYRXEpKbW/XNH5zS4noR7faPEeu31l0h4dSpvc+t/Z199jkFWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY/H9D/MR9qfKnLj/00U71aqfJn9+HCkCR/Wk36ddsgyJ/1wF4fkDfqqm9/gPsUeTnVr6a2xlQfnxdI7zs0W7irzD17Ytb2WT7EeNv/r4ox1O3Quf2QP2pgt9utwfout4FQE8AVBSlnaRmfvAURQkg2RlAbwB9AThlW5L0GaiKojhJhgOIBqDa7XaPrusdPtr5kQwF0BVAAoBIABRCKDd5aFUhRDAAw57eAOwAhKIoupft3zoqhB1AqLwuHIBut9uFt02qqvqRDJR2dAEQJj/BAOjn56dqmma+xiaECAEQAWAggLsB6A6HQ2iaZggBhBAqgEAAnQB0kzaEmT4hAITT6VQ8Ho/HJAKKECJQtr8LwD1y/A1/vcdfEUIEyfZ9AcQbYvZ942Px88L2UwlJR0dH0EMPPbRj5syZPUeNGrXR7Xb/641xIwJ1XY9NSUlZm52dfW+XLl1w8uRJzJ8//+OGhoYJqqqe1TSt1Wsm9NN1PSIqKmr12rVrR5WUlHy1bdu2AQCumWc3IYRD1/UwVVXnFRQUTIuNjUVzczN2797dWFJSkq8oymZd15sAGAEnFEUJ1nX9nzIzM1dnZmZGh4SE4OTJk5g5c+Zf29vbp9pstrMej6fVOyhIhgAYU1hY+B+hoaGoqKg4XVlZea+XTULTNFdCQsLGiRMnPuR2u3UhBOV9eeDAAWXTpk095DUe6WsoyRE5OTlr0tLSAux2O/bs2cO5c+e+pijKUpIXSHaQVAGkvPLKK++6XK4OksJLCFlXV2cvKSlJBFAjhU+x2WwhHo9nUHp6+urMzMy7wsLCUF9fjxdffPHjxsbGiTab7WuPx9NiEutOuq4PyMjI+M+srKyYqKgoHD58GDNmzNjq8XhyVFU9b/q+LH7hBAEYu3PnTlZVVRFAGgCX6f/tAHoOHDjwa0p27txp/JO9e/f+QM7cipw9nfL3kQBKt2zZQpJ87rnn6mQmoHilw2EACs+cOUOSrK+vZ1NTE0nyo48+IoBpxswoBcMJ4Ndjx471kOTFixe5d+9ekqTH42H//v13A4jyzpAURfEH0H/OnDnthu1z5sw558MmFUCPWbNmnaMP3nrrLZoyDmP8Hl68eDFJ8siRI9/Yc+zYMQKYKdtAztrTrl27xptRXV1NAKMAOAyBBBA/Y8aMdpLs6Ojgxx9//E37+++//29yvFXppwvAwMcee8xjtDHsuXLlCqOjo//ia3wsfpkoALqFhoZuIckJEyackimm3dQmEMDUmpoakmRISMhhAHOHDx/eQJIbN24kgKEyMAHAFRMTs2XXrl1saWkhSZ0kp0+ffhrAr3wEW/S8efOukORLL72kA1gKYMPWrVtJkk899dRJAHeYrgsEsIQkjx8/TgDvAPjd448/3kaSb7zxBmUa7vC6z53BwcFbSHL9+vU6Sc6aNes8gF5ewWAH0PfVV18lSQL4DMBGIcQ6AKtcLleBFC2jXtFt8ODBe0iyoqKCAJYByC8qKmJDQwOzsrK+MAmqo1OnTveHhoa+GRkZ+XZkZOSWiIiIvzgcjk9mzpypkWRmZuZpmbYbGV4AgPnNzc1sa2sjgN0A5iQmJtaSZHl5OQHcb/K3s81mW0uSTU1NBFAFYFbfvn1Pk+Tbb79NAA8IIVzW42/hByA+Pz/fLR/2ZXIda05NI/z9/TeR5J49ewhgqlxTrtI0jY2NjQQw3zTLuWJiYjaUlJToS5Ys6fjkk080kwDEeAmADcA9GzZsIElGRUW9CyAWwLApU6Y0kOSKFSsog9QICGdERMTGsrIyZmVlEcC9AB4IDw/fTpLbtm0jgN94CUAnAJmVlZVcs2aNZ/LkyRdJcvbs2b4EwAkgZfPmzTxw4AABFAN4BkC6vFeUSewcAO5duXIlSTIhIaEawGMAxgKYAmAGgCS73e5vrKVk/yGythANYEhCQsIhkly+fDkBpKqqGmL6DgIALDKN/3yZpVWQZGVlJQE8aPI3KiMjo5okV61aRQAjAPQBMPfIkSN0u90EUCBtsPiFEwpgbn19PdetW2fM5N4zQ9ekpKQqkty0aRMBpMjiWM6JEydIkoqirJUFJ6iq6pAPVy8A6cZMehMBUACEuVyuFwG8HBwcPEIWx367ZMkSjSQXLVrUJouTRorrkAHdA8BdQogsAOsKCwtJkmPGjDkvMw2bDDo/ADEjRoz4XylyFbm5uY0mAbjLyyZ/AOOrq6tZVlbWsWDBgo69e/eyoqKCgwcPPg4gSQaoIRbp27dvN7KF+tLSUr28vJwFBQXtMpvpYRIM7+wrAkDeqVOnePbsWQIoNKfzpiXPg8uXLydJJicnNwF4f+nSpW6STEtLq5fjYwhk1wkTJtSQ5Ouvv04AqTKj+N2xY8dIkgEBAW/Ie1v8wncRegwZMmQvSfbr12+3Ua33WqPfOWbMmP0kWVpaSgCDZAqcfejQIWNZsEGKgvnh9gfQb9myZd8nAEJVVZtMkUNk8CcNHTq0liR1XWdYWNhmH1mJIme80OnTp18x1rp5eXkEsNJms92Fb7e/IgEsvHz5Mp999tkmAI/l5uZeMC0B7vEqqAYAyL106RJJsra2lpWVld+sucePH38ZQG+5NncBeOrgwYMkqbe3t/Po0aOsra011wAWyl0H7x0JJ4DE+fPnu0kyPT29DsDdUrBuyNKEEAkAdpw/f/6GeoEM8GUmfwEgPCIiopwkGxsbabPZPgOw6L777vvm4p49e26VGYjFLxUhhD+ApLKyMp44ccIoVnXybgbgzkcfffRzklyzZg0BDJYCMMmoCwQFBXkLgLGWvvcWAgBToSsKwNPTp09vMR7UuLi4rwH0lgU8c/Db5ezbeeTIkRWzZ8++aMxu+fn5BPCADBwHgP4LFy701NXVEUAJgAnPP/98kyxMNgHo53A4zH77BQQETMvPz7+Um5vbBuAlAFMSExPPmdbVL0qh8Acw8fDhw5SCchVAEYAVb775JknyhRdeaJYztHfxMwLAaqNwCGC2FArv8x0hAHKNLGPKlCme5OTk/Zs3bzb7O0wKiiG8KXl5ed8IxenTp0mSR48e1UmyW7duWywBuD2xyQcgFECgoih+8H1gyJgZV5Lkyy+/3CbTRIePtl2HDBmyw1QBHyGDdXZdXR1JUghRKkXBjOMHCoBdpr0L3nvvPZLkF198wejo6O0A4lVVDTb74HQ6AwD8Wq7Jh8rgGgDgQ13XjVR8qaxJuADMbmlpYXl5uV5UVNRWUFDgfv/993Vj/ZydnU1c37eHXML4S3viAcQqitJD2l104cIFY8lTKsXSBWBMVVWVcd9yed2A1NTUQ6Zl00CvLMMOoHdubm6zFIlWOf5+PsY/Kj09vdrU11QAwwGsv3jxIk21m2DZr10I0RXAuAcffPBgaWkpV69eTYfDcdiwUxY0w6xw+flX8L1xApjevXv3lREREaW6rofB93aPDUDQpEmTMgHgtddeqwBwEd/utZvpqK6uPgEAcXFxkA94NwB9unfvjrNnz4LklwDcf08iIqv66Zs2bXrl4YcfxooVKxAbG7uqrq5uAYA2TdOEqqpGYIi2tjbl6aeffu/YsWPv5uTk7JaC1wHg4Pnz542MwoVvTx+21dbWYvjw4WLixIl+2dnZ9lGjRgmSTE1NRUpKCkwFTGiaxtTU1OXTpk3707Bhw/6g67pDipnT4biuj7qut+Lbk3Vf1tTUXI9qu91Pjq1QFEUBgJaWFgBo8yGOQ8eNGxcAAOvXr/8QwBUfYygAKL169eoCABcuXACAWtn2hOGv0+kMNO1KiPDw8F4A4rZv3/7R1KlTR0+bNu1ht9u9r1+/fqitrQXJgwDarRC6/QjPzs4+QJIffPCB9/aQmSAA43ft2mW0e1QGoi8CAPyLsZccExNTC2BlRkbGRdOyYJCP2csBIN6UAZzCd7cBbQCijYp/dXU1ExMTz6SmptaMHj36f9LS0vYlJCRsl6mxIWSdu3fv/g5J7t+/nwC2AShMTk6+SJKff/45AWRLYbD7+fndAeDf5BJnLoCCyZMnt5JkdnZ2C4B/F0KEm1Pu+Pj4rST55ZdfEsBWAK+mpaVdMo3raDn7KwDuSEpK+m+S3LBhAwG8DuCtHTt2UBbpjgC408vvcFVV15HkuXPnjMp+p5uMf0RcXNyHJNnQ0EBVVfcCWBQXF3fG+Jv0yxABPwB5LS0tRmFxN4BlTzzxxGWSXLx4sS5F3GGFy+1Hp5SUlJq6ujoWFxdTpsZ2H+0iIyMj/0iSWVlZX5mr5jfJFroPGzasxlhTnjp1iiTZ3NxMl8tlrCd9pfa9SkpKSJI5OTmnZOageLUZZqxvfVFWVkZcPwdgNwnSCKPqb17jkmR8fPzfZMDZ5CRsFBmNI7h95s2b1yhT7/MAYmStwCx4vy0uLqa3v5qmEcCfvSr1QQAeXb16NY3Cm3HQ55133iGAp+SxZTNhKSkpfzUddkrFjYevzAQCeGjp0qXfsYckY2NjTwD4leGDLCL2HTdunNtoY+zWSHFcIHdsFCtcfuZ1vO9Eqs3m7/F47sb1k2qX/f3997W2tl7BjWfpBYDOzzzzzIVJkyZh0KBBCwEsB3AJvl9AETabLcDj8dwRFRW1ctasWb8JCgpSzp07d62wsPC/Wltb8xRFadR1/ZqPXYbgAQMGbI2Pjw/+6quv9ldVVT0r01ezuPRJSUn5Y9euXXVd11WzDaqq6kePHm3+7LPPRgO4KlNuxWazhXo8nuTk5OSXMjIyEl0uFxoaGtqKior+dPXq1VdUVT0jj7r68ieoT58+vx8yZMjdx48fP1JVVTVF9m20VW02WyfZf97YsWPjXS4X6urqWvPy8jYCWCyEuEDS8FdVFKWzruv//OSTTy5OTk7uqWkaPv3007qysrJ8RVH+LI8ym8/rB3Tu3HnRI488knLo0KG2ffv2ZQI4C98vP6mqqoZqmpaclpa2cOTIkX39/f3R0NDQUVxc/G5TU9PLqqrWa5rWLH1QVFUN0TStX1JSUvH48eP7BwYG4uDBg1cKCgpeBbBe2u+2Qug2EwD5N5sMPuNtMe8XP4TT6Qxoa2sbIGeXvUKIK7d4IISiKC5d1wPljOfA9bPwzYqiXNV13dd6Uqiq6qdpml2mpe02m63d4/G4vcTF5fF47LJf71nJA6BZVVW3pmntuPHlmAD5wk6Q9NnbHp9vHaqq6tA0zU/64PZhk1FfCZB9G/23ALiqKEqzD39tpvbGUqoFwFUhRLP3yzpCCDtJpxyXDulfG27+pqRR3DXsUWVd4Yq0x/taVQjhIhksC8L+ABpM9ljBf5sKwI8pIBr75L5E4vvu+UNeG/a+hv+AL7yFH8qPtOfHjtOP6V/Bja8D6z/B2Nys/1u9Xv33tLf4GfF/LC4GCJwByWIAAAAASUVORK5CYII=",cc._loaderImage="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAlAAD/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4MDBEMDY2QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4MDBEMDY1QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU2RTk0OEM4OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU2RTk0OEM5OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQADQkJCQoJDQoKDRMMCwwTFhENDREWGhUVFhUVGhkUFhUVFhQZGR0fIB8dGScnKionJzk4ODg5QEBAQEBAQEBAQAEODAwOEA4RDw8RFA4RDhQVERISERUfFRUXFRUfKB0ZGRkZHSgjJiAgICYjLCwoKCwsNzc1NzdAQEBAQEBAQEBA/8AAEQgAyACgAwEiAAIRAQMRAf/EALAAAAEFAQEAAAAAAAAAAAAAAAQAAgMFBgcBAQEAAwEBAAAAAAAAAAAAAAAAAQMEAgUQAAIBAgIEBwoLBgQGAwAAAAECAwAEEQUhMRIGQVFxsTITFGGBwdEiQlKSMzWRoeFicqKyI1NzFYJjJDQWB9KjVCbxwkNkJWXik3QRAAIBAgMFBQcDBQEAAAAAAAABAhEDIRIEMUFRcTJhwVIUBZGhsSJyEzOB0ULhYpIjUxX/2gAMAwEAAhEDEQA/AMJSpUqAVKlXuFAeUq9wpUB5XuFe4V6ooDzZHDox0CnGMinzwl7Z8NajaHeoO3vmTBZBtp9YUIqTEV5ROxHKnWRnaU8VRMhFBUjpV7hSoSeUq9pUB5Sr2lhQHlKvcK8oBV7hSFSRrtaKAZs07YNPM1pG2xJIAw1jSeandry/8X4m8VCKkWwaWwam7Xl/4v1W8VLtmX/i/VbxUoKkWwakSM407tmX/i/VbxUmzGwjQsjdY41IARie/U0IbZO0kNtCXnOCkEBeFu4KI3Bs7DNb27ya+jDx3kJeEnpJJEcQVbWDsk17u5urd591ucZkWhym2Vnd9RkCDEpFxDRpbw0bunu5mlp2De2FMLYXOD2wB2xbOeraUcYGJ72mlSUiqzzdzMd3Z3mixltA2yzcK/NlHM1DQyRXce1HocdNOEfJXZ88y9ZojOqhiBszIRiHQ8Y4cK5TvHuzLljHNMqxNoDjLFraHHnjPxcNCGVbxEUzYNTx5jZSxhpW6qTzlwJ+DCvO2Zf+L9VvFSgqyHYNLYNTdssPxfibxUu15f8Ai/VPiqCakOwa82DU/a8v/F+JvFTDdWPBL8R8VKCvYRYV5UzoMAy6QdIIqI0B4KJtxiRQwou16QoGUkntH5Tz0RbZbmF2hktraSVBo2lUkY8tDye0flPPXTslVUyiyVRsjqUOA4yMT8dW2ram2m6UVTNq9S7EIyUVJydMTn/6DnP+im9Wl+g5z/opvVrpteEhQWY4AaSTwAVf5WPiZh/9S5/zj7zltzlmYWkfWXNvJDGTgGcYDHirR7i7mSbwXParsFMrgb7w6jKw/wCmnc9I14kF3vpvCljbMyWMOJL4aEiB8qU/ObUK7HYWVrl1pFZWiCOCBQqKOLjPGTrNZZqKbUXVHq2nNwTuJRk1VpbgXN8s7Rk5ym0UQQzhIG2NAjhxHWbI+gCBVjBBFbwxwQqEiiUJGg1BVGAFe7dV28WYLYZFmF2Th1UD7JGjymGyn1iK5OyzIBGB1HgrLZhamzumQAGJwSqnSCh1q3GOCodxt4cxurdcpzuN4cyhiWaF5Bg09udUmnWw1H/jV9nFuJ7Quo+8h8peThFA+047vduyMtk7fYqTl07YFdfUufMPzT5p71UdtlmYXaGS2t3mQHAsgxANdadYJopLe4QS2867EsZ4QfCNYrCFbjdDPmgkYyWFxgVf04ifJf6ScNdRUW1XBb6FU5TjF5EpSSrGu/s5lN+g5z/opvVpfoOc/wCim9WtdHnatvObJXDW7xLGhB8nrPaY9/HCr+tEdPCVaSeDoYLnqF63lzW4/PFSW3ecxbI84VSzWUwUaSdg0DXXK5nvAipnd6qgKvWnQO7pri9ZUEmm3Vl2j1kr8pRlFRyquBNZjGxQ/S56Y1S2fu9OVueon11Szahoou06QoQUXadIVCD2FJJ7R+U89dMydv8Axdn+TH9muZye0flPPXQstlK5Tbka1gUjlC1q0vVLkeb6r+O3Tx9xcY1nt8c0NrZCyiOE1108NYjGv1joo7Js1jzKyScYLIvkzL6LDwHXVJksH9Sb49dKNq0tj1jA6uriOCL+02FWX7iVtZX1/AzaHTyeoauKn2MX9W79zebiZCuR5MjSrhfXuEtwTrUeZH+yNfdrRNcxI6IzhXlJEak6WIGJ2Rw4ChWnChndtlVBLMdQA0k1gbXNMzzDfDLs6mjaPKppJbWwJ1bOwwxw43OnHh71YT3DpfWUJmFlb5jHHDdeXBHIsrRea5TSqvxqG04cNN62vetoCS4tre5mgnkGE9q+3DKOkuI2WX6LDQRRHWDh1UCtwj7QRg2wdl8Djgw1qe7XvW0BQ3kfZ7mSLgU+T9E6RVbnuVrnWVSWqj+Lt8ZbRuHEdKPkYVcZ2MJY5fSGyeVar45+rkWQHAqccalPE5km1htWK5nK4Wnt5FuUBUwOMG4nGkA/BXUrW4S6torlOjMgcd/xVn7rLo7zKs0uEjCNeSvdwoBhgsZxX1l2j36k3Lu+uyprdj5Vs5A+i/lD48a0aaVJOPi7jB6lbzWozpjB48pf1NDXNN4vfl7+Z4BXS65pvF78vfzPAK71XTHmZ/S/yT+jvJ7L3fHytz1E+upbL+Qj5W56jfXWRnsIYKLtekKEFGWvSFQgyjk9o/Keet3YthlMP/5x9msJJ7R+U89biyb/AMXEv7gD6tadL1T+kwepRrC39ZkLDMbiwMvUHRPG0bjlGg8ore/23sxBldxfMPLupNhT8yL/AORNZbdzJ484scytxgLqJY5LZj6Q2sV5G1Vud1mjjyG0ij0NEGSZToKyhjtqw4waztuiXA3qKTbSxltfGhbZlE95ZtZqxVbgiOZhrER9ph3Svk9+pJILZ4Y4DGBFCUMKjRsGPobPFhUfW0NJmljE2xJcIrcI2vFUEln1lRXd6lrazXT9GCNpD+yNqoI7mOVduNw6nzlOIoPOUa6yye1XXcbMR5GdQ3xY0BSbj31/FcTQZirJ+q431q7anbHCTZ72Bw7lbPrKBMcBWNNgbMBBh+bsjBdni0VJ1lARZs6yWiupxCuMDy6KpS2IwOo6DTr3Mre3e5tZZVUM4ZBjqOOJoWO4jkXajcOOMHGgDISvWIrdAkKR80+TzVl908bPPL3LzxOuHdifxVfiTAg92qI/w+/8gGgSyN/mR7XPVlp0lF/3L3mbVKtu5Hjbk/8AHE2Fc03i9+Xv5ngFdKNc13i9+Xv5ngFaNV0x5nn+l/kn9HeEWXu+PlbnqJ9dS2Xu9OVueon11kZ7CGCjLXpCgxRlr0hUIPYUcntH5Tz1s8vb+Bt1/dqPirGSe0flPPWusG/g4Py15q06XqlyMWvVYQ+ruI9xJOqzO9hOto/sP8tbGOFIrmWeM7IuMDMnAXXQJOUjQeOsJk0nY96ip0CYunrjaHx1t+srPJUbXBm2LrFPikwTOb+T+VhbZxGMrDXp83x1QSy2tucJpUjPETp+Cn5/ftaRvKvtp3Kx48HG3erHMzOxZiWZtLMdJNQSbbL71Vk6yynViOkqnEEfOWtPbXi3EQkGg6mXiNckjeSJxJGxR10qw0GtxuxmvbImD4CZMFlA4fRfv0BqesqqzTMZNMEDbIHtHH2QeCiZJSqMQdOGiue53mz3czQwsRbIcNHnkec3c4qAMuriz68gTIToxwOOnlp0MjxMJYW741Gs3RVldtbygE/dMcHX/moDaxTiWNZB53B3arb8/wC+4SOF4sf/AKxU9kcBsfOGHfoUHtG/RbzY5Die5HHhXdvavqiZ9Q8Jdlq4/gbKua7xe/L38zwCuhpf2Uk/Zo50kmwJKIdogDjw1VzzeL35e/meAVp1LTgqY4nn+mRauzqmqwrjzCLL3fHytz1E+upLL+Qj5W56jfXWRnroYKLtekKEFF2vSFQg9hSSe0flPPWosm/hIfoLzVl5PaPynnrRWb/w0X0F5q06XqlyM2sVYx5gmbFre/t71NY2T+0h8VbSO5SWNJUOKSAMp7jDGspmMPaLRlXS6eWve1/FRO7WYdbZm1Y/eW/R7qHxHRXGojlm3ulid6aVbaW+OALvgCLq2Hm9WxHKWqjhj6xsK1e8dm15l4niG1LZkswGsxtrPeOmsvayBJA1VItlWjptLuTdPMo7LtjRDq9naK4+WF9IrUW7BaHOljGqVHB7w2hzVoZt87d8vaNYSLl02CcRsDEbJbj71Uu7UBkvJ7/D7q2QoDxySaAO8MTXdxRVMpRp5XZOWdF/ms7R5XdyKfKWJsO/5PhrG5XlNxmEywW6bTnTxAAcJNbGSMXkM1pjgbiNo1PziPJ+Os7u7m/6ReM00ZOgxSpqYYHT3wRXMKN4ll9zUG4bQfNshu8sZVuEA2hirA4qe/VOwwrVbzbww5mI44UKRRYkbWG0S3JWctbd7u5WFfOOLHiUdJqmaipfLsIsObhWe001lMkMVvJNjhghIALMcBxCs7fxXQmkupx1bXDswGPlaTidVaEyKNXkoo4eBV+Sq7L7Vs9zcBgeyQ4GQ/MB1crmoim2orezqcowTuSeEY48jQ7oZX2PLzdyLhNd6RjrEY6I7+uspvH78vfzPAK6UAAAFGAGgAcArmu8Xvy9/M8ArTfio24RW5nnaG67uou3H/KPuqT2X8hHytz1G+upLL3enK3PUb66ys9RDBRdr0hQgou06QqEGUkntH5Tz1e238vF9BeaqKT2j8p56vbb+Xi+gvNWjTdUuRn1XTHmTh8KrJTJlt8t1CPIY44cGnpJVjTJYkmjaN9Ib4u7V923njTethRauZJV3PaW1rfLIiXEDYg6R4VYc9CXW7thfOZbKdbGZtLW8uPVY/u3GrkNUkM9zlcxUjbhfWOA90cRq4gv4LhdqN+VToNYWmnRm9NNVWNTyHc6VWBv8wt4YeHqm6xyPmroq1Z7WGFLSxTq7WLSuPSdjrkfumq5yHXDUeA92oO2SKpVumNAaoJLMXH3myp0rpJ4uKhc3tbDM5BMri1zAj79j7KTiY8TcdBpcsith0286o+sPCagEX9Pzg4zXUCp6QYse8oouCG3tk6m1BYv05W6T+IdyolxbHDAAa2OgDlNCz3ryN2WxBd5PJMg1t81eId2ukqnLlTBbfcuY+9uJLiRcvtPvHdsHK+cfRHcHDWsyawjyy0WBcDI3lTP6TeIcFV+S5OmXx9bJg1048o8Cj0V8Jq2DVu09nL80up7OxHi+oal3P8AXB/IsZS8T/YOV65zvCcc7vfzPAK3ivWCz445zeH954BXOr6I8yfSfyz+jvCLP3fHytz1G+upLP3fHytz1E+usbPaQ0UXadIUIKLtekKhB7Ckk9o/Keer22/l4/oLzVRSe0flPPV7b/y8X0F5q0abqlyM+q6Y8yQsBTDMor1o8aiaE1pbluMqS3sbLLHIhSRQyngqukhaJ9uBjo+H5aOa3ao2t34qouRlLajTalGP8v0IY8ylXQ+PKPFU/bYXOLPge6CKia0LaxTOxHu1Q7cuBd9yPEJ7TbjXKO8CajbMIF6CNIeNvJHjqIWJ7tSpYkalqVblwIdyG+RGXur0hXYJFxal+Dhq5y3slkv3Y2pD0pTr+QUClpJRUdo9XW4OLrTHtM16cZLLWkeC7y4jvlNEpcRtw1Ux27Ci448NZrTFy3nn3IQWxlgGrDZ3pza7/M8ArZo+ArF5171uvp+CqdV0R5l/psUrs2vB3hdl7vTlbnqJ9dS2Xu+PlbnqJ9dY2eshooq16QoQUXa9IVCD2FLJ7RuU89WNtmUSQqkgYMgw0accKrpPaPynnrZWG4Vi+VWmY5tnMWXG+XrIYnA0rhj0mdcTgdNdwnKDqjmduM1SRR/qlr8/4KX6pa8T/BVzDuLZXudRZblmbxXcPUNPc3KqCIwrbOzgrHEnHjoyD+3eSXkht7DeKG4umDGOJVUklfouThXfmbnZ7Cvy1vt9pmv1W1+d8FL9VteJvgq5yrcOGfLmzHN80iyyETPbptAEFo2ZG8pmUa1OFNn3Ky6W/sbDKM5hv5bx2WTZA+7RF2y52WOPJTzE+z2Dy1vt9pT/AKpacTerS/U7Tib1a04/t7kDXPY03jhN0W6sQ7K7W3q2dnrMccaDy/8At80kuZfqWYxWNtlcvUPPhiGYhWDeUy7IwYU8xPs9g8tb7faUn6pacTerTxm9oOBvVq3v9z927aynuId44LiWKNnjhAXF2UYhRg516qpsryjLr21665zFLSTaK9U2GOA87SwqY37knRU+BzOzags0s1Oyr+BKM6sxwP6tSDPLMen6vy0rvdm3Sxlu7K/S7WDDrFUDUTxgnTU826eXW7KlxmqQuwDBXUKcD+1Xee/wXuKX5XDGWLapSVcOyhEM/seJ/V+WnjeGx4pPV+Wkm6kKZlFay3Jlt7iFpYZY8ASVK6DjtDDA0f8A0Tl340/1f8Ndx8xJVWXB0KbktFFpNzdVXAC/qOwA0CQni2flrO3Vwbm5lnI2TKxbDirX/wBE5d+NcfV/wVR7xZPa5U9utvI8nWhmbbw0YEAYYAVxfhfy5rlKR4Fulu6X7mW1mzT8S4Yis/5CPlbnqJ9dSWfu9OVueon11mZvQ2i7XpChKKtekKhBlNJ7R+U89bDfGTb3a3ZX0Lcj6kdY+T2j8p560288m1kWQr6MJ+ylSAr+2cnV5renjs3H1loX+3j9XvbbtxLN9lqW4UnV5jdnjtXHxihtyZNjeSBu5J9k1BJe7xy7W5CJ/wCzuD/mTVTf2+fq97LJuLrPsNRueS7W6aJ/38x+vLVXuY+xvHaNxbf2GoCezf8A36j/APsSf8w1sLnqczTefJluYoLm5uo5F61sBshItP1cNFYe1f8A3ir/APfE/wCZUe9bB94r5jwuPsrQFhmG4l/Z2M17HdW90tuu3IkTHaCjWdIw0VVZdks9/C06yJFEp2dp+E1bbqybGTZ8vpQD7L1XRv8A7blT96Oda7tpNuuNE37Cq9KSisjyuUoxrStKllHbLlWTXsMs8chuSuwEPDqwoLe5y+YRE/gLzmqRekvKKtd4327yM/ulHxmrHJStySWVRyrjxKI2XC/CTlnlPPKTpTdFbP0L1bgrf5Lp0G3dPhQHwV0S1lzBsns3sESR8Crh9WAJGjSOKuU3E+zdZQ3oJh8IArdZXFDmOTpHa3i2+YrI2KtKy4ricBsBuHHgFXSo440+Wa2qqxjvM9uMoy+WvzWpLCWWWE28HxL6e43ojgkeSCBY1Ri5BGIUDT51cl3vm276BBqSEH4WbxV0tlkyXJcxTMb+OW6uY9mGHrCzDQwwAbTp2uKuTZ9N1uYsfRRR8WPhrm419mSSjRyiqxVK7y23B/ftuTm2oSdJyzNVw3BFn7vTlbnqF9dS2fu9OVueon11lZuQ2iLdsGFD05H2dNQGV0ntG5Tz1dWm9N1b2kVq8EVwsI2UaQaQOKhmitZGLOmk68DhSFvY+gfWNSAg7z3Qvo7yKCKIohiaNR5LKxx8qpxvjcqS0VpbxvwOAcRQPZ7D0G9Y0uz2HoH1jUCpLY7zXlpbm3eKO5QuzjrBqZji3x17PvNcyT288VvDBJbMWUovS2hslW7mFQ9nsPQPrGl2ew9A+saCod/WNxtbYsrfb17WBxx5ddD2281xC88klvDcSXEnWuzrqOGGC9zRUPZ7D0G9Y0uzWHoH1jQVCLreq6ntZbaO3it1mGy7RjTs1X2mYy20ZiCq8ZOODcdEdmsPQb1jS7PYegfWNdJuLqnQiSUlRqpFLmryxtH1Ma7Qw2gNNPOdSt0oI27p007s9h6B9Y0uz2HoH1jXX3Z+I4+1b8IJdX89xLHKQFMXQUahpxoiPN5P+onfU+A0/s9h6DesaXZ7D0D6xpG7OLbUtu0StW5JJx2bBsmbtiSiEk+cxoCWWSaVpZOk2vDVo0VYdnsPQb1jSNvZcCH1jSd2c+p1XAmFqEOmOPEfaH+BQd1ueo211IzrgFUYKNAAqI1WztCpUqVCRUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoD/9k=",(cc=cc||{})._tmp=cc._tmp||{},cc._LogInfos={},window._p,(_p=window).gl,_p.WebGLRenderingContext,_p.DeviceOrientationEvent,_p.DeviceMotionEvent,_p.AudioContext,_p.webkitAudioContext,_p.mozAudioContext,(_p=Object.prototype)._super,_p.ctor,delete window._p,cc.newElement=function(e){return document.createElement(e)},cc._addEventListener=function(e,t,i,n){e.addEventListener(t,i,n)},cc._isNodeJs=!1,cc.each=function(e,t,i){if(e)if(e instanceof Array){for(var n=0,r=e.length;n<r;n++)if(!1===t.call(i,e[n],n))return}else for(var o in e)if(!1===t.call(i,e[o],o))return},cc.extend=function(e){var t=arguments.length>=2?Array.prototype.slice.call(arguments,1):[];return cc.each(t,function(t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}),e},cc.isFunction=function(e){return"function"==typeof e},cc.isNumber=function(e){return"number"==typeof e||"[object Number]"==Object.prototype.toString.call(e)},cc.isString=function(e){return"string"==typeof e||"[object String]"==Object.prototype.toString.call(e)},cc.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},cc.isUndefined=function(e){return void 0===e},cc.isObject=function(e){var t=typeof e;return"function"==t||e&&"object"==t},cc.isCrossOrigin=function(e){if(!e)return cc.log("invalid URL"),!1;var t=e.indexOf("://");if(-1==t)return!1;var i=e.indexOf("/",t+3);return(-1==i?e:e.substring(0,i))!=location.origin},cc.AsyncPool=function(e,t,i,n,r){var o=this;o._srcObj=e,o._limit=t,o._pool=[],o._iterator=i,o._iteratorTarget=r,o._onEnd=n,o._onEndTarget=r,o._results=e instanceof Array?[]:{},o._isErr=!1,cc.each(e,function(e,t){o._pool.push({index:t,value:e})}),o.size=o._pool.length,o.finishedSize=0,o._workingSize=0,o._limit=o._limit||o.size,o.onIterator=function(e,t){o._iterator=e,o._iteratorTarget=t},o.onEnd=function(e,t){o._onEnd=e,o._onEndTarget=t},o._handleItem=function(){var e=this;if(!(0==e._pool.length||e._workingSize>=e._limit)){var t=e._pool.shift(),i=t.value,n=t.index;e._workingSize++,e._iterator.call(e._iteratorTarget,i,n,function(t){if(!e._isErr){if(e.finishedSize++,e._workingSize--,t)return e._isErr=!0,void(e._onEnd&&e._onEnd.call(e._onEndTarget,t));var i=Array.prototype.slice.call(arguments,1);e._results[this.index]=i[0],e.finishedSize!=e.size?e._handleItem():e._onEnd&&e._onEnd.call(e._onEndTarget,null,e._results)}}.bind(t),e)}},o.flow=function(){var e=this;if(0!=e._pool.length)for(var t=0;t<e._limit;t++)e._handleItem();else e._onEnd&&e._onEnd.call(e._onEndTarget,null,[])}},cc.async={series:function(e,t,i){var n=new cc.AsyncPool(e,1,function(e,t,n){e.call(i,n)},t,i);return n.flow(),n},parallel:function(e,t,i){var n=new cc.AsyncPool(e,0,function(e,t,n){e.call(i,n)},t,i);return n.flow(),n},waterfall:function(e,t,i){var n=[],r=[null],o=new cc.AsyncPool(e,1,function(t,o,s){n.push(function(t){n=Array.prototype.slice.call(arguments,1),e.length-1==o&&(r=r.concat(n)),s.apply(null,arguments)}),t.apply(i,n)},function(e){if(t)return e?t.call(i,e):void t.apply(i,r)});return o.flow(),o},map:function(e,t,i,n){var r=t;"object"==typeof t&&(i=t.cb,n=t.iteratorTarget,r=t.iterator);var o=new cc.AsyncPool(e,0,r,i,n);return o.flow(),o},mapLimit:function(e,t,i,n,r){var o=new cc.AsyncPool(e,t,i,n,r);return o.flow(),o}},cc.path={join:function(){for(var e=arguments.length,t="",i=0;i<e;i++)t=(t+(""==t?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return t},extname:function(e){var t=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(e);return t?t[1]:null},mainFileName:function(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(0,t)}return e},basename:function(e,t){var i=e.indexOf("?");i>0&&(e=e.substring(0,i));var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(e.replace(/(\/|\\\\)$/,""));if(!n)return null;var r=n[2];return t&&e.substring(e.length-t.length).toLowerCase()==t.toLowerCase()?r.substring(0,r.length-t.length):r},dirname:function(e){return e.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(e,t){t=t||"";var i=e.indexOf("?"),n="";return i>0&&(n=e.substring(i),e=e.substring(0,i)),(i=e.lastIndexOf("."))<0?e+t+n:e.substring(0,i)+t+n},changeBasename:function(e,t,i){if(0==t.indexOf("."))return this.changeExtname(e,t);var n=e.indexOf("?"),r="",o=i?this.extname(e):"";return n>0&&(r=e.substring(n),e=e.substring(0,n)),n=e.lastIndexOf("/"),n=n<=0?0:n+1,e.substring(0,n)+t+o+r}},cc.loader={_jsCache:{},_register:{},_langPathCache:{},_aliases:{},resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},_getArgs4Js:function(e){var t=e[0],i=e[1],n=e[2],r=["",null,null];if(1===e.length)r[1]=t instanceof Array?t:[t];else if(2===e.length)"function"==typeof i?(r[1]=t instanceof Array?t:[t],r[2]=i):(r[0]=t||"",r[1]=i instanceof Array?i:[i]);else{if(3!==e.length)throw"arguments error to load js!";r[0]=t||"",r[1]=i instanceof Array?i:[i],r[2]=n}return r},loadJs:function(e,t,i){var n=this,r=n._jsCache,o=n._getArgs4Js(arguments),s=o[0],a=o[1],c=o[2];navigator.userAgent.indexOf("Trident/5")>-1?n._loadJs4Dependency(s,a,0,c):cc.async.map(a,function(e,t,i){var o=cc.path.join(s,e);if(r[o])return i(null);n._createScript(o,!1,i)},c)},loadJsWithImg:function(e,t,i){var n=this,r=n._loadJsImg(),o=n._getArgs4Js(arguments);this.loadJs(o[0],o[1],function(e){if(e)throw e;r.parentNode.removeChild(r),o[2]&&o[2]()})},_createScript:function(e,t,i){var n=document,r=this,o=cc.newElement("script");o.async=t,r._jsCache[e]=!0,cc.game.config.noCache&&"string"==typeof e?r._noCacheRex.test(e)?o.src=e+"&_t="+(new Date-0):o.src=e+"?_t="+(new Date-0):o.src=e,cc._addEventListener(o,"load",function(){o.parentNode.removeChild(o),this.removeEventListener("load",arguments.callee,!1),i()},!1),cc._addEventListener(o,"error",function(){o.parentNode.removeChild(o),i("Load "+e+" failed!")},!1),n.body.appendChild(o)},_loadJs4Dependency:function(e,t,i,n){if(i>=t.length)n&&n();else{var r=this;r._createScript(cc.path.join(e,t[i]),!1,function(o){if(o)return n(o);r._loadJs4Dependency(e,t,i+1,n)})}},_loadJsImg:function(){var e=document,t=e.getElementById("cocos2d_loadJsImg");if(!t){t=cc.newElement("img"),cc._loadingImage&&(t.src=cc._loadingImage);var i=e.getElementById(cc.game.config.id);i.style.backgroundColor="black",i.parentNode.appendChild(t);var n=getComputedStyle?getComputedStyle(i):i.currentStyle;n||(n={width:i.width,height:i.height}),t.style.left=i.offsetLeft+(parseFloat(n.width)-t.width)/2+"px",t.style.top=i.offsetTop+(parseFloat(n.height)-t.height)/2+"px",t.style.position="absolute"}return t},loadTxt:function(e,t){if(cc._isNodeJs)require("fs").readFile(__dirname+"/"+e,function(e,i){e?t(e):t(null,i.toString())});else{var i=this.getXMLHttpRequest(),n="load "+e+" failed!";i.open("GET",e,!0),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(i.setRequestHeader("Accept-Charset","utf-8"),i.onreadystatechange=function(){4==i.readyState&&(200==i.status?t(null,i.responseText):t(n))}):(i.overrideMimeType&&i.overrideMimeType("text/plain; charset=utf-8"),i.onload=function(){4==i.readyState&&(200==i.status?t(null,i.responseText):t(n))}),i.send(null)}},_loadTxtSync:function(e){if(cc._isNodeJs)return require("fs").readFileSync(__dirname+"/"+e).toString();var t=this.getXMLHttpRequest();return t.open("GET",e,!1),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?t.setRequestHeader("Accept-Charset","utf-8"):t.overrideMimeType&&t.overrideMimeType("text/plain; charset=utf-8"),t.send(null),4==!t.readyState||200!=t.status?null:t.responseText},loadCsb:function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){var n=i.response;n&&(window.msg=n),4==i.readyState&&(200==i.status?t(null,i.response):t("load "+e+" failed!"))},i.send(null)},loadJson:function(e,t){this.loadTxt(e,function(i,n){if(i)t(i);else{try{var r=JSON.parse(n)}catch(t){throw"parse json ["+e+"] failed : "+t}t(null,r)}})},_checkIsImageURL:function(e){return null!=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(e)},loadImg:function(e,t,i,n){var r=this;null==i&&null!=t&&(i=t);var o=this.getRes(e);if(o)return i&&i(null,o),o;(o=new Image).crossOrigin="Anonymous";var s=function(){this.removeEventListener("load",s,!1),this.removeEventListener("error",a,!1),cc.loader.cache[e]=o,i&&i(null,o)},a=function(){this.removeEventListener("load",s,!1),this.removeEventListener("error",a,!1),n?"function"==typeof i&&i("load image failed"):_.delay(function(){r.release(e),cc.loader.loadImg(e,t,i,!0)},60)};return cc._addEventListener(o,"load",s),cc._addEventListener(o,"error",a),o.src=e,o},_loadResIterator:function(e,t,i){var n=this,r=null,o=e.type;o?(o="."+o.toLowerCase(),r=e.src?e.src:e.name+o):(r=e,o=cc.path.extname(r));var s=n.getRes(r);if(s)return i(null,s);var a=null;if(o&&(a=n._register[o.toLowerCase()]),!a)return cc.error("loader for ["+o+"] not exists!"),i();var c=a.getBasePath?a.getBasePath():n.resPath,l=n.getUrl(c,r);cc.game.config.noCache&&"string"==typeof l&&(n._noCacheRex.test(l)?l+="&_t="+(new Date-0):l+="?_t="+(new Date-0)),a.load(l,r,e,function(e,t){e?(cc.log(e),n.cache[r]=null,delete n.cache[r],i()):(n.cache[r]=t,i(null,t))})},_noCacheRex:/\?/,getUrl:function(e,t){var i=this,n=i._langPathCache,r=cc.path;if(void 0!==e&&void 0===t){t=e;var o=r.extname(t);o=o?o.toLowerCase():"";var s=i._register[o];e=s&&s.getBasePath?s.getBasePath():i.resPath}if((t=cc.path.join(e||"",t)).match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(n[t])return n[t];var a=r.extname(t)||"";t=n[t]=t.substring(0,t.length-a.length)+"_"+cc.sys.language+a}return t},load:function(e,t,i){var n=this,r=arguments.length;if(0==r)throw"arguments error!";3==r?"function"==typeof t&&(t="function"==typeof i?{trigger:t,cb:i}:{cb:t,cbTarget:i}):2==r?"function"==typeof t&&(t={cb:t}):1==r&&(t={}),e instanceof Array||(e=[e]);var o=new cc.AsyncPool(e,window.ccMapLimit,function(e,i,r,o){n._loadResIterator(e,i,function(e){if(e)return r(e);var i=Array.prototype.slice.call(arguments,1);t.trigger&&t.trigger.call(t.triggerTarget,i[0],o.size,o.finishedSize),r(null,i[0])})},t.cb,t.cbTarget);return o.flow(),o},_handleAliases:function(e,t){var i=this._aliases,n=[];for(var r in e){var o=e[r];i[r]=o,n.push(o)}this.load(n,t)},loadAliases:function(e,t){var i=this,n=i.getRes(e);n?i._handleAliases(n.filenames,t):i.load(e,function(e,n){i._handleAliases(n[0].filenames,t)})},register:function(e,t){if(e&&t){var i=this;if("string"==typeof e)return this._register[e.trim().toLowerCase()]=t;for(var n=0,r=e.length;n<r;n++)i._register["."+e[n].trim().toLowerCase()]=t}},getRes:function(e){return this.cache[e]||this.cache[this._aliases[e]]},release:function(e){var t=this.cache,i=this._aliases;delete t[e],delete t[i[e]],delete i[e]},releaseAll:function(){var e=this.cache,t=this._aliases;for(var i in e)delete e[i];for(var i in t)delete t[i]}},cc.formatStr=function(){var e=arguments,t=e.length;if(t<1)return"";var i=e[0],n=!0;"object"==typeof i&&(n=!1);for(var r=1;r<t;++r){var o=e[r];if(n)for(;;){if("number"==typeof o&&i.match(/(%d)|(%s)/)){i=i.replace(/(%d)|(%s)/,o);break}i.match(/%s/)?i=i.replace(/%s/,o):i+="    "+o;break}else i+="    "+o}return i},function(){var e,t,i=window;cc.isUndefined(document.hidden)?cc.isUndefined(document.mozHidden)?cc.isUndefined(document.msHidden)?cc.isUndefined(document.webkitHidden)||(e="webkitHidden",t="webkitvisibilitychange"):(e="msHidden",t="msvisibilitychange"):(e="mozHidden",t="mozvisibilitychange"):(e="hidden",t="visibilitychange");var n=function(){cc.eventManager&&cc.game._eventHide&&cc.eventManager.dispatchEvent(cc.game._eventHide)},r=function(){cc.eventManager&&cc.game._eventShow&&cc.eventManager.dispatchEvent(cc.game._eventShow),cc.game._intervalId&&(window.cancelAnimationFrame(cc.game._intervalId),cc.game._runMainLoop())};e?cc._addEventListener(document,t,function(){document[e]?n():r()},!1):(cc._addEventListener(i,"blur",n,!1),cc._addEventListener(i,"focus",r,!1)),navigator.userAgent.indexOf("MicroMessenger")>-1&&(i.onfocus=function(){r()}),"onpageshow"in window&&"onpagehide"in window&&(cc._addEventListener(i,"pagehide",n,!1),cc._addEventListener(i,"pageshow",r,!1)),i=null,t=null}(),cc.log=cc.warn=cc.error=cc.assert=function(){},cc.create3DContext=function(e,t){for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,r=0;r<i.length;++r){try{n=e.getContext(i[r],t)}catch(e){}if(n)break}return n},cc._initSys=function(e,t){cc._RENDER_TYPE_CANVAS=0,cc._RENDER_TYPE_WEBGL=1,cc.sys={};var i=cc.sys;i.LANGUAGE_ENGLISH="en",i.LANGUAGE_CHINESE="zh",i.LANGUAGE_FRENCH="fr",i.LANGUAGE_ITALIAN="it",i.LANGUAGE_GERMAN="de",i.LANGUAGE_SPANISH="es",i.LANGUAGE_DUTCH="du",i.LANGUAGE_RUSSIAN="ru",i.LANGUAGE_KOREAN="ko",i.LANGUAGE_JAPANESE="ja",i.LANGUAGE_HUNGARIAN="hu",i.LANGUAGE_PORTUGUESE="pt",i.LANGUAGE_ARABIC="ar",i.LANGUAGE_NORWEGIAN="no",i.LANGUAGE_POLISH="pl",i.OS_WINDOWS="Windows",i.OS_IOS="iOS",i.OS_OSX="OS X",i.OS_UNIX="UNIX",i.OS_LINUX="Linux",i.OS_ANDROID="Android",i.OS_UNKNOWN="Unknown",i.WINDOWS=0,i.LINUX=1,i.MACOS=2,i.ANDROID=3,i.IPHONE=4,i.IPAD=5,i.BLACKBERRY=6,i.NACL=7,i.EMSCRIPTEN=8,i.TIZEN=9,i.WINRT=10,i.WP8=11,i.MOBILE_BROWSER=100,i.DESKTOP_BROWSER=101,i.BROWSER_TYPE_WECHAT="wechat",i.BROWSER_TYPE_ANDROID="androidbrowser",i.BROWSER_TYPE_IE="ie",i.BROWSER_TYPE_QQ="qqbrowser",i.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",i.BROWSER_TYPE_UC="ucbrowser",i.BROWSER_TYPE_360="360browser",i.BROWSER_TYPE_BAIDU_APP="baiduboxapp",i.BROWSER_TYPE_BAIDU="baidubrowser",i.BROWSER_TYPE_MAXTHON="maxthon",i.BROWSER_TYPE_OPERA="opera",i.BROWSER_TYPE_OUPENG="oupeng",i.BROWSER_TYPE_MIUI="miuibrowser",i.BROWSER_TYPE_FIREFOX="firefox",i.BROWSER_TYPE_SAFARI="safari",i.BROWSER_TYPE_CHROME="chrome",i.BROWSER_TYPE_LIEBAO="liebao",i.BROWSER_TYPE_QZONE="qzone",i.BROWSER_TYPE_SOUGOU="sogou",i.BROWSER_TYPE_UNKNOWN="unknown",i.isNative=!1;var n=[i.BROWSER_TYPE_BAIDU,i.BROWSER_TYPE_OPERA,i.BROWSER_TYPE_FIREFOX,i.BROWSER_TYPE_CHROME,i.BROWSER_TYPE_SAFARI],r=[i.OS_IOS,i.OS_WINDOWS,i.OS_OSX,i.OS_LINUX],o=[i.BROWSER_TYPE_BAIDU,i.BROWSER_TYPE_OPERA,i.BROWSER_TYPE_FIREFOX,i.BROWSER_TYPE_CHROME,i.BROWSER_TYPE_BAIDU_APP,i.BROWSER_TYPE_SAFARI,i.BROWSER_TYPE_UC,i.BROWSER_TYPE_QQ,i.BROWSER_TYPE_MOBILE_QQ,i.BROWSER_TYPE_IE],s=window,a=s.navigator,c=document,l=c.documentElement,u=a.userAgent.toLowerCase();i.isMobile=-1!=u.indexOf("mobile")||-1!=u.indexOf("android"),i.platform=i.isMobile?i.MOBILE_BROWSER:i.DESKTOP_BROWSER;var h=a.language;h=(h=h||a.browserLanguage)?h.split("-")[0]:i.LANGUAGE_ENGLISH,i.language=h;var d=i.BROWSER_TYPE_UNKNOWN,p=u.match(/sogou|qzone|liebao|micromessenger|qqbrowser|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|trident|oupeng|opera|miuibrowser|firefox/i)||u.match(/chrome|safari/i);p&&p.length>0&&("micromessenger"==(d=p[0])?d=i.BROWSER_TYPE_WECHAT:"safari"===d&&u.match(/android.*applewebkit/)?d=i.BROWSER_TYPE_ANDROID:"trident"==d?d=i.BROWSER_TYPE_IE:"360 aphone"==d&&(d=i.BROWSER_TYPE_360)),i.browserType=d;var _=!!u.match(/(iPad|iPhone|iPod)/i),f=!(!u.match(/android/i)&&!a.platform.match(/android/i)),m=i.OS_UNKNOWN;-1!=a.appVersion.indexOf("Win")?m=i.OS_WINDOWS:_?m=i.OS_IOS:-1!=a.appVersion.indexOf("Mac")?m=i.OS_OSX:-1!=a.appVersion.indexOf("X11")&&-1==a.appVersion.indexOf("Linux")?m=i.OS_UNIX:f?m=i.OS_ANDROID:-1!=a.appVersion.indexOf("Linux")&&(m=i.OS_LINUX),i.os=m,i._supportMultipleAudio=o.indexOf(i.browserType)>-1;var g=parseInt(e[t.renderMode]),y=cc._RENDER_TYPE_WEBGL,T=cc.newElement("Canvas");cc._supportRender=!0;var v=!window.WebGLRenderingContext||-1==n.indexOf(i.browserType)||-1==r.indexOf(i.os);if((1===g||0===g&&v)&&(y=cc._RENDER_TYPE_CANVAS),i._canUseCanvasNewBlendModes=function(){var e=document.createElement("canvas");e.width=1,e.height=1;var t=e.getContext("2d");t.fillStyle="#000",t.fillRect(0,0,1,1),t.globalCompositeOperation="multiply";var i=document.createElement("canvas");i.width=1,i.height=1;var n=i.getContext("2d");return n.fillStyle="#fff",n.fillRect(0,0,1,1),t.drawImage(i,0,0,1,1),0===t.getImageData(0,0,1,1).data[0]},i._supportCanvasNewBlendModes=i._canUseCanvasNewBlendModes(),y==cc._RENDER_TYPE_WEBGL&&(s.WebGLRenderingContext&&cc.create3DContext(T,{stencil:!0,preserveDrawingBuffer:!0})||(0==g?y=cc._RENDER_TYPE_CANVAS:cc._supportRender=!1)),y==cc._RENDER_TYPE_CANVAS)try{T.getContext("2d")}catch(e){cc._supportRender=!1}cc._renderType=y;try{i._supportWebAudio=!!(s.AudioContext||s.webkitAudioContext||s.mozAudioContext)}catch(e){i._supportWebAudio=!1}try{var S=i.localStorage=s.localStorage;S.setItem("storage",""),S.removeItem("storage"),S=null}catch(e){"SECURITY_ERR"!==e.name&&"QuotaExceededError"!==e.name||cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option"),i.localStorage=function(){}}var C=i.capabilities={canvas:!0};cc._renderType==cc._RENDER_TYPE_WEBGL&&(C.opengl=!0),(void 0!==l.ontouchstart||void 0!==c.ontouchstart||a.msPointerEnabled)&&(C.touches=!0),void 0!==l.onmouseup&&(C.mouse=!0),void 0!==l.onkeyup&&(C.keyboard=!0),(s.DeviceMotionEvent||s.DeviceOrientationEvent)&&(C.accelerometer=!0),i.garbageCollect=function(){},i.dumpRoot=function(){},i.restartVM=function(){},i.cleanScript=function(e){},i.dump=function(){var e=this,t="";t+="isMobile : "+e.isMobile+"\r\n",t+="language : "+e.language+"\r\n",t+="browserType : "+e.browserType+"\r\n",t+="capabilities : "+JSON.stringify(e.capabilities)+"\r\n",t+="os : "+e.os+"\r\n",t+="platform : "+e.platform+"\r\n",cc.log(t)}},cc.ORIENTATION_PORTRAIT=0,cc.ORIENTATION_PORTRAIT_UPSIDE_DOWN=1,cc.ORIENTATION_LANDSCAPE_LEFT=2,cc.ORIENTATION_LANDSCAPE_RIGHT=3,cc._drawingUtil=null,cc._renderContext=null,cc._canvas=null,cc._gameDiv=null,cc._rendererInitialized=!1,cc._setupCalled=!1,cc._setup=function(e,t,i){if(!cc._setupCalled){cc._setupCalled=!0;var n,r,o,s=window,a=cc.$(e)||cc.$("#"+e);if(cc.game._setAnimFrame(),"CANVAS"==a.tagName?(t=t||a.width,i=i||a.height,r=cc.container=cc.newElement("DIV"),(n=cc._canvas=a).parentNode.insertBefore(r,n),n.appendTo(r),r.setAttribute("id","Cocos2dGameContainer")):("DIV"!=a.tagName&&cc.log("Warning: target element is not a DIV or CANVAS"),t=t||a.clientWidth,i=i||a.clientHeight,r=cc.container=a,n=cc._canvas=cc.$(cc.newElement("CANVAS")),a.appendChild(n)),n.addClass("gameCanvas"),n.setAttribute("width",t||480),n.setAttribute("height",i||320),n.setAttribute("tabindex",99),n.style.outline="none",o=r.style,o.width=(t||480)+"px",o.height=(i||320)+"px",o.margin="0 auto",o.position="relative",o.overflow="hidden",r.top="100%",cc._renderType==cc._RENDER_TYPE_WEBGL&&(cc._renderContext=cc.webglContext=cc.create3DContext(n,{stencil:!0,preserveDrawingBuffer:!0,antialias:!cc.sys.isMobile,alpha:!1})),cc._renderContext?(s.gl=cc._renderContext,cc._drawingUtil=new cc.DrawingPrimitiveWebGL(cc._renderContext),cc._rendererInitialized=!0,cc.textureCache._initializingRenderer(),cc.shaderCache._init()):(cc._renderContext=new cc.CanvasContextWrapper(n.getContext("2d")),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(cc._renderContext):null),cc._gameDiv=r,cc._setContextMenuEnable(!1),cc.sys.isMobile){var c=cc.newElement("style");c.type="text/css",document.body.appendChild(c),c.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}cc.view=cc.EGLView._getInstance(),cc.inputManager.registerSystemEvent(cc._canvas),cc.director=cc.Director._getInstance(),cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view),cc.winSize=cc.director.getWinSize(),cc.saxParser=new cc.SAXParser,cc.plistParser=new cc.PlistParser}},cc._checkWebGLRenderMode=function(){if(cc._renderType!==cc._RENDER_TYPE_WEBGL)throw"This feature supports WebGL render mode only."},cc._isContextMenuEnable=!1,cc._setContextMenuEnable=function(e){cc._isContextMenuEnable=e,cc._canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1}},cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",_eventHide:null,_eventShow:null,_onBeforeStartArr:[],CONFIG_KEY:{engineDir:"engineDir",dependencies:"dependencies",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList",classReleaseMode:"classReleaseMode"},_prepareCalled:!1,_prepared:!1,_paused:!0,_intervalId:null,_lastTime:null,_frameTime:null,config:null,onStart:null,onStop:null,setFrameRate:function(e){var t=this;t.config[t.CONFIG_KEY.frameRate]=e,t._intervalId&&window.cancelAnimationFrame(t._intervalId),t._paused=!0,t._setAnimFrame(),t._runMainLoop()},_setAnimFrame:function(){this._lastTime=new Date,this._frameTime=1e3/cc.game.config[cc.game.CONFIG_KEY.frameRate],cc.sys.os===cc.sys.OS_IOS&&cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT||60!=cc.game.config[cc.game.CONFIG_KEY.frameRate]?(window.requestAnimFrame=this._stTime,window.cancelAnimationFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(e){var t=(new Date).getTime(),i=Math.max(0,cc.game._frameTime-(t-cc.game._lastTime)),n=window.setTimeout(function(){e()},i);return cc.game._lastTime=t+i,n},_ctTime:function(e){window.clearTimeout(e)},_runMainLoop:function(){var e,t=this,i=t.config,n=t.CONFIG_KEY,r=cc.director;r.setDisplayStats(i[n.showFPS]),e=function(){t._paused||(r.mainLoop(),t._intervalId&&window.cancelAnimationFrame(t._intervalId),t._intervalId=window.requestAnimFrame(e))},window.requestAnimFrame(e),t._paused=!1},restart:function(){cc.director.popToSceneStackLevel(0),cc.audioEngine&&cc.audioEngine.end(),cc.game.onStart()},run:function(e){var t=this,i=function(){e&&(t.config[t.CONFIG_KEY.id]=e),t._prepareCalled||t.prepare(function(){t._prepared=!0}),cc._supportRender&&(t._checkPrepare=setInterval(function(){t._prepared&&(cc._setup(t.config[t.CONFIG_KEY.id]),t._runMainLoop(),t._eventHide=t._eventHide||new cc.EventCustom(t.EVENT_HIDE),t._eventHide.setUserData(t),t._eventShow=t._eventShow||new cc.EventCustom(t.EVENT_SHOW),t._eventShow.setUserData(t),t.onStart(),clearInterval(t._checkPrepare))},10))};document.body?i():cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1),i()},!1)},_initConfig:function(){var e=this,t=e.CONFIG_KEY,i=function(e){return e[t.engineDir]=e[t.engineDir]||"frameworks/cocos2d-html5",null==e[t.debugMode]&&(e[t.debugMode]=0),e[t.frameRate]=e[t.frameRate]||60,null==e[t.renderMode]&&(e[t.renderMode]=1),e};if(document.ccConfig)e.config=i(document.ccConfig);else try{for(var n=document.getElementsByTagName("script"),r=0;r<n.length;r++){var o=n[r].getAttribute("cocos");if(""==o||o)break}var s,a,c;r<n.length&&((s=n[r].src)&&(c=/(.*)\//.exec(s)[0],cc.loader.resPath=c,s=cc.path.join(c,"project.json")),a=cc.loader._loadTxtSync(s)),a||(a=cc.loader._loadTxtSync("project.json"));var l=JSON.parse(a);e.config=i(l||{})}catch(t){cc.log("Failed to read or parse project.json"),e.config=i({})}cc._initSys(e.config,t)},_jsAddedCache:{},_getJsListOfModule:function(e,t,i){var n=this._jsAddedCache;if(n[t])return null;i=i||"";var r=[],o=e[t];if(!o)throw"can not find module ["+t+"]";for(var s=cc.path,a=0,c=o.length;a<c;a++){var l=o[a];if(!n[l]){var u=s.extname(l);if(u)".js"==u.toLowerCase()&&r.push(s.join(i,l));else{var h=this._getJsListOfModule(e,l,i);h&&(r=r.concat(h))}n[l]=1}}return r},prepare:function(e){var t=this,i=t.config,n=t.CONFIG_KEY,r=i[n.engineDir],o=cc.loader;if(!cc._supportRender)throw"The renderer doesn't support the renderMode "+i[n.renderMode];t._prepareCalled=!0;var s=i[n.jsList]||[];if(cc.Class)o.loadJsWithImg("",s,function(i){if(i)throw i;t._prepared=!0,e&&e()});else{var a=cc.path.join(r,"moduleConfig.json");o.loadJson(a,function(n,o){if(n)throw n;var a=i.modules||[],c=o.module,l=[];cc._renderType==cc._RENDER_TYPE_WEBGL?a.splice(0,0,"shaders"):a.indexOf("core")<0&&a.splice(0,0,"core");for(var u=0,h=a.length;u<h;u++){var d=t._getJsListOfModule(c,a[u],r);d&&(l=l.concat(d))}l=l.concat(s),cc.loader.loadJsWithImg(l,function(i){if(i)throw i;t._prepared=!0,e&&e()})})}}},cc.game._initConfig(),Function.prototype.bind=Function.prototype.bind||function(e){if(!cc.isFunction(this))throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),i=this,n=function(){},r=function(){return i.apply(this instanceof n&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,r.prototype=new n,r},cc._LogInfos={ActionManager_addAction:"cc.ActionManager.addAction(): action must be non-null",ActionManager_removeAction:"cocos2d: removeAction: Target not found",ActionManager_removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",ActionManager_removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",ActionManager_getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",ActionManager_getActionByTag_2:"cocos2d : getActionByTag(tag = %s): Action not found",configuration_dumpInfo:"cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)",configuration_loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",configuration_loadConfigFile_2:"Please load the resource first : %s",Director_resume:"cocos2d: Director: Error in gettimeofday",Director_setProjection:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",Director_popScene:"running scene should not null",Director_pushScene:"the scene should not null",arrayVerifyType:"element type is wrong!",Scheduler_scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",Scheduler_scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",Scheduler_scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",Scheduler_pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",Scheduler_resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",Scheduler_isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null",Node_getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",Node_setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",Node_getRotation:"RotationX != RotationY. Don't know which one to return",Node_getScale:"ScaleX != ScaleY. Don't know which one to return",Node_addChild:"An Node can't be added as a child of itself.",Node_addChild_2:"child already added. It can't be added again",Node_addChild_3:"child must be non-null",Node_removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",Node_boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",Node_removeChildByTag:"argument tag is an invalid tag",Node_removeChildByTag_2:"cocos2d: removeChildByTag(tag = %s): child not found!",Node_removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",Node_stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",Node_getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",Node_resumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",Node_pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",Node__arrayMakeObjectsPerformSelector:"Unknown callback function",Node_reorderChild:"child must be non-null",Node_runAction:"cc.Node.runAction(): action must be non-null",Node_schedule:"callback function must be non-null",Node_schedule_2:"interval must be positive",Node_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",AtlasNode_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",AtlasNode_initWithTileFile:"",AtlasNode__initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_EventListenerKeyboard_checkAvailable:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",_EventListenerTouchOneByOne_checkAvailable:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",_EventListenerTouchAllAtOnce_checkAvailable:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",_EventListenerAcceleration_checkAvailable:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",EventListener_create:"Invalid parameter.",__getListenerID:"Don't call this method if the event is for touch.",eventManager__forceAddEventListener:"Invalid scene graph priority!",eventManager_addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",eventManager_removeListeners:"Invalid listener type!",eventManager_setPriority:"Can't set fixed priority with scene graph based listener.",eventManager_addListener_2:"Invalid parameters.",eventManager_addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",eventManager_addListener_4:"The listener has been registered, please don't register it again.",LayerMultiplex_initWithLayers:"parameters should not be ending with null in Javascript",LayerMultiplex_switchTo:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_addLayer:"cc.Layer.addLayer(): layer should be non-null",EGLView_setDesignResolutionSize:"Resolution not valid",EGLView_setDesignResolutionSize_2:"should set resolutionPolicy",inputManager_handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex = %s",swap:"cc.swap is being modified from original macro, please check usage",checkGLErrorDebug:"WebGL error %s",animationCache__addAnimationsWithDictionary:"cocos2d: cc.AnimationCache: No animations were found in provided dictionary.",animationCache__addAnimationsWithDictionary_2:"cc.AnimationCache. Invalid animation format",animationCache_addAnimations:"cc.AnimationCache.addAnimations(): File could not be found",animationCache__parseVersion1:"cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion1_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache__parseVersion1_3:"cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",animationCache__parseVersion1_4:"cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",animationCache__parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion2_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache_addAnimations_2:"cc.AnimationCache.addAnimations(): Invalid texture file name",Sprite_reorderChild:"cc.Sprite.reorderChild(): this child is not in children list",Sprite_ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",Sprite_setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",Sprite_setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",Sprite_setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",Sprite__updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",Sprite_initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",Sprite_initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",Sprite_initWithSpriteFrameName1:" is null, please check.",Sprite_initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",Sprite_setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",Sprite_reorderChild_2:"cc.Sprite.reorderChild(): child should be non-null",Sprite_addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",Sprite_addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",Sprite_addChild_3:"cc.Sprite.addChild(): child should be non-null",Sprite_setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",Sprite_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",Sprite_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",Sprite_setSpriteFrame:"Invalid spriteFrameName",Sprite_setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",Sprite_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",Sprite_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",SpriteBatchNode_addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",SpriteBatchNode_increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",SpriteBatchNode_increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",SpriteBatchNode_reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",SpriteBatchNode_removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",SpriteBatchNode_addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",SpriteBatchNode_reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",spriteFrameCache__getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",spriteFrameCache_addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",spriteFrameCache__checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",spriteFrameCache_getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",spriteFrameCache__getFrameConfig_2:"Please load the resource first : %s",spriteFrameCache_addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",spriteFrameCache_addSpriteFrames_3:"Argument must be non-nil",CCSpriteBatchNode_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",CCSpriteBatchNode_addChild_2:"cc.Sprite.addChild(): child should be non-null",CCSpriteBatchNode_setSpriteFrame:"Invalid spriteFrameName",CCSpriteBatchNode_setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",CCSpriteBatchNode_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null",TextureAtlas_initWithFile:"cocos2d: Could not open file: %s",TextureAtlas_insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",TextureAtlas_initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",TextureAtlas_updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",TextureAtlas_updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",TextureAtlas_insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",TextureAtlas_insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",TextureAtlas_insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",TextureAtlas_insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",TextureAtlas_removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",TextureAtlas_removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",TextureAtlas_moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",TextureAtlas_moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",TextureAtlas_moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex",textureCache_addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",textureCache_addPVRImage:"addPVRImage does not support on HTML5",textureCache_addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",textureCache_dumpCachedTextureInfo:"cocos2d: '%s' id=%s %s x %s",textureCache_dumpCachedTextureInfo_2:"cocos2d: '%s' id= HTMLCanvasElement %s x %s",textureCache_dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",textureCache_addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",Texture2D_initWithETCFile:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData:"initWithPVRTCData does not support on HTML5",Texture2D_addImage:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",Texture2D_initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",Texture2D_initWithString:"initWithString isn't supported on cocos2d-html5",Texture2D_initWithETCFile_2:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile_2:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",Texture2D_bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",Texture2D__initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",Texture2D_addImage_2:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithData:"NSInternalInconsistencyException",MissingFile:"Missing file: %s",radiansToDegress:"cc.radiansToDegress() should be called cc.radiansToDegrees()",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager__updateListeners:"If program goes here, there should be event in dispatch.",EventManager__updateListeners_2:"_inDispatch should be 1 here."},cc._logToWebPage=function(e){if(cc._canvas){var t=cc._logList,i=document;if(!t){var n=i.createElement("Div"),r=n.style;n.setAttribute("id","logInfoDiv"),cc._canvas.parentNode.appendChild(n),n.setAttribute("width","200"),n.setAttribute("height",cc._canvas.height),r.zIndex="99999",r.position="absolute",r.top="0",r.left="0";var o=(t=cc._logList=i.createElement("textarea")).style;t.setAttribute("rows","20"),t.setAttribute("cols","30"),t.setAttribute("disabled",!0),n.appendChild(t),o.backgroundColor="transparent",o.borderBottom="1px solid #cccccc",o.borderRightWidth="0px",o.borderLeftWidth="0px",o.borderTopWidth="0px",o.borderTopStyle="none",o.borderRightStyle="none",o.borderLeftStyle="none",o.padding="0px",o.margin=0}t.value=t.value+e+"\r\n",t.scrollTop=t.scrollHeight}},cc._formatString=function(e){if(!cc.isObject(e))return e;try{return JSON.stringify(e)}catch(e){return""}},cc._initDebugSetting=function(e){var t=cc.game;if(e!=t.DEBUG_MODE_NONE){var i;e>t.DEBUG_MODE_ERROR?(i=cc._logToWebPage.bind(cc),cc.error=function(){i("ERROR :  "+cc.formatStr.apply(cc,arguments))},cc.assert=function(e,t){if(!e&&t){for(var n=2;n<arguments.length;n++)t=t.replace(/(%s)|(%d)/,cc._formatString(arguments[n]));i("Assert: "+t)}},e!=t.DEBUG_MODE_ERROR_FOR_WEB_PAGE&&(cc.warn=function(){i("WARN :  "+cc.formatStr.apply(cc,arguments))}),e==t.DEBUG_MODE_INFO_FOR_WEB_PAGE&&(cc.log=function(){i(cc.formatStr.apply(cc,arguments))})):console&&console.log.apply&&(cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(e,t){if(!e&&t){for(var i=2;i<arguments.length;i++)t=t.replace(/(%s)|(%d)/,cc._formatString(arguments[i]));throw t}},e!=t.DEBUG_MODE_ERROR&&(cc.warn=function(){return console.warn.apply(console,arguments)}),e==t.DEBUG_MODE_INFO&&(cc.log=function(){return console.log.apply(console,arguments)}))}},cc._initDebugSetting(cc.game.config[cc.game.CONFIG_KEY.debugMode]),cc.loader.loadBinary=function(e,t){var i=this,n=this.getXMLHttpRequest(),r="load "+e+" failed!";n.open("GET",e,!0),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=cc._convertResponseBodyToText(n.responseBody);t(null,i._str2Uint8Array(e))}else t(r)}):(n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.onload=function(){4==n.readyState&&200==n.status?t(null,i._str2Uint8Array(n.responseText)):t(r)}),n.send(null)},cc.loader._str2Uint8Array=function(e){if(!e)return null;for(var t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=255&e.charCodeAt(i);return t},cc.loader.loadBinarySync=function(e){var t=this,i=this.getXMLHttpRequest(),n="load "+e+" failed!";i.open("GET",e,!1);var r=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){if(i.setRequestHeader("Accept-Charset","x-user-defined"),i.send(null),200!=i.status)return cc.log(n),null;var o=cc._convertResponseBodyToText(i.responseBody);o&&(r=t._str2Uint8Array(o))}else{if(i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.send(null),200!=i.status)return cc.log(n),null;r=this._str2Uint8Array(i.responseText)}return r};var Uint8Array=Uint8Array||Array;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var IEBinaryToArray_ByteStr_Script='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n',myVBScript=cc.newElement("script");myVBScript.type="text/vbscript",myVBScript.textContent=IEBinaryToArray_ByteStr_Script,document.body.appendChild(myVBScript),cc._convertResponseBodyToText=function(e){for(var t={},i=0;i<256;i++)for(var n=0;n<256;n++)t[String.fromCharCode(i+256*n)]=String.fromCharCode(i)+String.fromCharCode(n);var r=IEBinaryToArray_ByteStr(e),o=IEBinaryToArray_ByteStr_Last(e);return r.replace(/[\s\S]/g,function(e){return t[e]})+o}}var cc=cc||{},ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),compileSuper:function(e,t,i){var n=(c=e.toString()).indexOf("("),r=c.indexOf(")"),o=c.substring(n+1,r);o=o.trim();for(var s=c.indexOf("{"),a=c.lastIndexOf("}"),c=c.substring(s+1,a);-1!=c.indexOf("this._super");){var l=c.indexOf("this._super"),u=c.indexOf("(",l),h=c.indexOf(")",u),d=c.substring(u+1,h),p=(d=d.trim())?",":"";c=c.substring(0,l)+"ClassManager["+i+"]."+t+".call(this"+p+c.substring(u+1)}return Function(o,c)},getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};switch(ClassManager.compileSuper.ClassManager=ClassManager,function(){var e=/\b_super\b/,t=cc.game.config[cc.game.CONFIG_KEY.classReleaseMode];t&&console.log("release Mode"),cc.Class=function(){},cc.Class.extend=function(i){function n(){this.__instanceId=ClassManager.getNewInstanceId(),this.ctor&&this.ctor.apply(this,arguments)}var r=this.prototype,o=Object.create(r),s=ClassManager.getNewID();ClassManager[s]=r;var a={writable:!0,enumerable:!1,configurable:!0};o.__instanceId=null,n.id=s,a.value=s,Object.defineProperty(o,"__pid",a),n.prototype=o,a.value=n,Object.defineProperty(n.prototype,"constructor",a),this.__getters__&&(n.__getters__=cc.clone(this.__getters__)),this.__setters__&&(n.__setters__=cc.clone(this.__setters__));for(var c=0,l=arguments.length;c<l;++c){var u=arguments[c];for(var h in u){var d="function"==typeof u[h],p="function"==typeof r[h],_=e.test(u[h]);if(t&&d&&p&&_?(a.value=ClassManager.compileSuper(u[h],h,s),Object.defineProperty(o,h,a)):d&&p&&_?(a.value=function(e,t){return function(){var i=this._super;this._super=r[e];var n=t.apply(this,arguments);return this._super=i,n}}(h,u[h]),Object.defineProperty(o,h,a)):d?(a.value=u[h],Object.defineProperty(o,h,a)):o[h]=u[h],d){var f,m,g;if(this.__getters__&&this.__getters__[h]){g=this.__getters__[h];for(var y in this.__setters__)if(this.__setters__[y]==g){m=y;break}cc.defineGetterSetter(o,g,u[h],u[m]?u[m]:o[m],h,m)}if(this.__setters__&&this.__setters__[h]){g=this.__setters__[h];for(var y in this.__getters__)if(this.__getters__[y]==g){f=y;break}cc.defineGetterSetter(o,g,u[f]?u[f]:o[f],u[h],f,h)}}}}return n.extend=cc.Class.extend,n.implement=function(e){for(var t in e)o[t]=e[t]},n}}(),cc.defineGetterSetter=function(e,t,i,n,r,o){if(e.__defineGetter__)i&&e.__defineGetter__(t,i),n&&e.__defineSetter__(t,n);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var s={enumerable:!1,configurable:!0};i&&(s.get=i),n&&(s.set=n),Object.defineProperty(e,t,s)}if(!r&&!o)for(var a=null!=i,c=void 0!=n,l=Object.getOwnPropertyNames(e),u=0;u<l.length;u++){var h=l[u];if((e.__lookupGetter__?!e.__lookupGetter__(h):!Object.getOwnPropertyDescriptor(e,h))&&"function"==typeof e[h]){var d=e[h];if(a&&d===i&&(r=h,!c||o))break;if(c&&d===n&&(o=h,!a||r))break}}var p=e.constructor;r&&(p.__getters__||(p.__getters__={}),p.__getters__[r]=t),o&&(p.__setters__||(p.__setters__={}),p.__setters__[o]=t)},cc.clone=function(e){var t=e.constructor?new e.constructor:{};for(var i in e){var n=e[i];"object"!=typeof n||!n||n instanceof cc.Node||n instanceof HTMLElement?t[i]=n:t[i]=cc.clone(n)}return t},cc.inject=function(e,t){for(var i in e)t[i]=e[i]},(cc=cc||{})._tmp=cc._tmp||{},cc.associateWithNative=function(e,t){},cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.FMT_JPG=0,cc.FMT_PNG=1,cc.FMT_TIFF=2,cc.FMT_RAWDATA=3,cc.FMT_WEBP=4,cc.FMT_UNKNOWN=5,cc.getImageFormatByData=function(e){return e.length>8&&137==e[0]&&80==e[1]&&78==e[2]&&71==e[3]&&13==e[4]&&10==e[5]&&26==e[6]&&10==e[7]?cc.FMT_PNG:e.length>2&&(73==e[0]&&73==e[1]||77==e[0]&&77==e[1]||255==e[0]&&216==e[1])?cc.FMT_TIFF:cc.FMT_UNKNOWN},cc.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new i,e.prototype.constructor=e},cc.base=function(e,t,i){var n=arguments.callee.caller;if(n.superClass_)return ret=n.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1)),ret;for(var r=Array.prototype.slice.call(arguments,2),o=!1,s=e.constructor;s;s=s.superClass_&&s.superClass_.constructor)if(s.prototype[t]===n)o=!0;else if(o)return s.prototype[t].apply(e,r);if(e[t]===n)return e.constructor.prototype[t].apply(e,r);throw Error("cc.base called from a method of one name to a method of a different name")},cc.Point=function(e,t){this.x=e||0,this.y=t||0},cc.p=function(e,t){return void 0==e?{x:0,y:0}:void 0==t?{x:e.x,y:e.y}:{x:e,y:t}},cc.pointEqualToPoint=function(e,t){return e&&t&&e.x===t.x&&e.y===t.y},cc.Size=function(e,t){this.width=e||0,this.height=t||0},cc.size=function(e,t){return void 0===e?{width:0,height:0}:void 0===t?{width:e.width,height:e.height}:{width:e,height:t}},cc.sizeEqualToSize=function(e,t){return e&&t&&e.width==t.width&&e.height==t.height},cc.Rect=function(e,t,i,n){this.x=e||0,this.y=t||0,this.width=i||0,this.height=n||0},cc.rect=function(e,t,i,n){return void 0===e?{x:0,y:0,width:0,height:0}:void 0===t?{x:e.x,y:e.y,width:e.width,height:e.height}:{x:e,y:t,width:i,height:n}},cc.rectEqualToRect=function(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},cc._rectEqualToZero=function(e){return e&&0===e.x&&0===e.y&&0===e.width&&0===e.height},cc.rectContainsRect=function(e,t){return!(!e||!t)&&!(e.x>=t.x||e.y>=t.y||e.x+e.width<=t.x+t.width||e.y+e.height<=t.y+t.height)},cc.rectGetMaxX=function(e){return e.x+e.width},cc.rectGetMidX=function(e){return e.x+e.width/2},cc.rectGetMinX=function(e){return e.x},cc.rectGetMaxY=function(e){return e.y+e.height},cc.rectGetMidY=function(e){return e.y+e.height/2},cc.rectGetMinY=function(e){return e.y},cc.rectContainsPoint=function(e,t){return t.x>=cc.rectGetMinX(e)&&t.x<=cc.rectGetMaxX(e)&&t.y>=cc.rectGetMinY(e)&&t.y<=cc.rectGetMaxY(e)},cc.rectIntersectsRect=function(e,t){var i=e.x+e.width,n=e.y+e.height,r=t.x+t.width,o=t.y+t.height;return!(i<t.x||r<e.x||n<t.y||o<e.y)},cc.rectOverlapsRect=function(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)},cc.rectUnion=function(e,t){var i=cc.rect(0,0,0,0);return i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.width=Math.max(e.x+e.width,t.x+t.width)-i.x,i.height=Math.max(e.y+e.height,t.y+t.height)-i.y,i},cc.rectIntersection=function(e,t){var i=cc.rect(Math.max(cc.rectGetMinX(e),cc.rectGetMinX(t)),Math.max(cc.rectGetMinY(e),cc.rectGetMinY(t)),0,0);return i.width=Math.min(cc.rectGetMaxX(e),cc.rectGetMaxX(t))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(e),cc.rectGetMaxY(t))-cc.rectGetMinY(i),i},cc._tmp.PrototypeColor=function(){var e=cc.color;e._getWhite=function(){return e(255,255,255)},e._getYellow=function(){return e(255,255,0)},e._getBlue=function(){return e(0,0,255)},e._getGreen=function(){return e(0,255,0)},e._getRed=function(){return e(255,0,0)},e._getMagenta=function(){return e(255,0,255)},e._getBlack=function(){return e(0,0,0)},e._getOrange=function(){return e(255,127,0)},e._getGray=function(){return e(166,166,166)},e.WHITE,cc.defineGetterSetter(e,"WHITE",e._getWhite),e.YELLOW,cc.defineGetterSetter(e,"YELLOW",e._getYellow),e.BLUE,cc.defineGetterSetter(e,"BLUE",e._getBlue),e.GREEN,cc.defineGetterSetter(e,"GREEN",e._getGreen),e.RED,cc.defineGetterSetter(e,"RED",e._getRed),e.MAGENTA,cc.defineGetterSetter(e,"MAGENTA",e._getMagenta),e.BLACK,cc.defineGetterSetter(e,"BLACK",e._getBlack),e.ORANGE,cc.defineGetterSetter(e,"ORANGE",e._getOrange),e.GRAY,cc.defineGetterSetter(e,"GRAY",e._getGray),cc.BlendFunc._disable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._additive=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE)},cc.BlendFunc.DISABLE,cc.defineGetterSetter(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.defineGetterSetter(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,cc.defineGetterSetter(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.BlendFunc.ADDITIVE,cc.defineGetterSetter(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive)},cc.SAXParser=cc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(e){return this._parseXML(e)},_parseXML:function(e){var t;return this._isSupportDOMParser?t=this._parser.parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)),t}}),cc.PlistParser=cc.SAXParser.extend({parse:function(e){var t=this._parseXML(e),i=t.documentElement;if("plist"!=i.tagName)throw"Not a plist file!";for(var n=null,r=0,o=i.childNodes.length;r<o&&1!=(n=i.childNodes[r]).nodeType;r++);return t=null,this._parseNode(n)},_parseNode:function(e){var t=null,i=e.tagName;if("dict"==i)t=this._parseDict(e);else if("array"==i)t=this._parseArray(e);else if("string"==i)if(1==e.childNodes.length)t=e.firstChild.nodeValue;else{t="";for(var n=0;n<e.childNodes.length;n++)t+=e.childNodes[n].nodeValue}else"false"==i?t=!1:"true"==i?t=!0:"real"==i?t=parseFloat(e.firstChild.nodeValue):"integer"==i&&(t=parseInt(e.firstChild.nodeValue,10));return t},_parseArray:function(e){for(var t=[],i=0,n=e.childNodes.length;i<n;i++){var r=e.childNodes[i];1==r.nodeType&&t.push(this._parseNode(r))}return t},_parseDict:function(e){for(var t={},i=null,n=0,r=e.childNodes.length;n<r;n++){var o=e.childNodes[n];1==o.nodeType&&("key"==o.tagName?i=o.firstChild.nodeValue:t[i]=this._parseNode(o))}return t}}),cc._txtLoader={load:function(e,t,i,n){cc.loader.loadTxt(e,n)}},cc.loader.register(["txt","xml","vsh","fsh","atlas"],cc._txtLoader),cc._jsonLoader={load:function(e,t,i,n){cc.loader.loadJson(e,n)}},cc.loader.register(["json","ExportJson"],cc._jsonLoader),cc._jsLoader={load:function(e,t,i,n){cc.loader.loadJs(e,n)}},cc.loader.register(["js"],cc._jsLoader),cc._imgLoader={load:function(e,t,i,n){cc.loader.cache[t]=cc.loader.loadImg(e,function(e,i){if(e)return n(e);cc.textureCache.handleLoadedTexture(t),n(null,i)})}},cc.loader.register(["png","jpg","bmp","jpeg","gif","ico"],cc._imgLoader),cc._serverImgLoader={load:function(e,t,i,n){cc.loader.cache[t]=cc.loader.loadImg(i.src,function(e,i){if(e)return n(e);cc.textureCache.handleLoadedTexture(t),n(null,i)})}},cc.loader.register(["serverImg"],cc._serverImgLoader),cc._plistLoader={load:function(e,t,i,n){cc.loader.loadTxt(e,function(e,t){if(e)return n(e);n(null,cc.plistParser.parse(t))})}},cc.loader.register(["plist"],cc._plistLoader),cc._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(e,t,i){var n=document,r=cc.path,o=this.TYPE,s=cc.newElement("style");s.type="text/css",n.body.appendChild(s);var a="@font-face { font-family:"+e+"; src:";if(t instanceof Array)for(var c=0,l=t.length;c<l;c++){var u=t[c];i=r.extname(u).toLowerCase(),a+="url('"+t[c]+"') format('"+o[i]+"')",a+=c==l-1?";":","}else a+="url('"+t+"') format('"+o[i]+"');";s.textContent+=a+"};";var h=cc.newElement("div"),d=h.style;d.fontFamily=e,h.innerHTML=".",d.position="absolute",d.left="-100px",d.top="-100px",n.body.appendChild(h)},load:function(e,t,i,n){var r=this,o=i.type,s=i.name,a=i.srcs;cc.isString(i)?(o=cc.path.extname(i),s=cc.path.basename(i,o),r._loadFont(s,i,o)):r._loadFont(s,a),n(null,!0)}},cc.loader.register(["font","eot","ttf","woff","svg"],cc._fontLoader),cc._binaryLoader={load:function(e,t,i,n){cc.loader.loadBinary(e,n)}},cc._csbLoader={load:function(e,t,i,n){cc.loader.loadCsb(e,n)}},cc.loader.register(["csb"],cc._csbLoader),window.CocosEngine=cc.ENGINE_VERSION="Cocos2d-JS v3.3 RC0",cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0,cc.DIRECTOR_STATS_POSITION=cc.p(0,0),cc.DIRECTOR_FPS_INTERVAL=.5,cc.COCOSNODE_RENDER_SUBPIXEL=1,cc.SPRITEBATCHNODE_RENDER_SUBPIXEL=1,cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=0,cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0,cc.TEXTURE_ATLAS_USE_VAO=0,cc.TEXTURE_NPOT_SUPPORT=0,cc.RETINA_DISPLAY_SUPPORT=1,cc.RETINA_DISPLAY_FILENAME_SUFFIX="-hd",cc.USE_LA88_LABELS=1,cc.SPRITE_DEBUG_DRAW=0,cc.SPRITEBATCHNODE_DEBUG_DRAW=0,cc.LABELBMFONT_DEBUG_DRAW=0,cc.LABELATLAS_DEBUG_DRAW=0,cc.IS_RETINA_DISPLAY_SUPPORTED=1,cc.DEFAULT_ENGINE=cc.ENGINE_VERSION+"-canvas",cc.ENABLE_STACKABLE_ACTIONS=1,cc.ENABLE_GL_STATE_CACHE=1,cc.$=function(e){var t=this==cc?document:this,i=e instanceof HTMLElement?e:t.querySelector(e);return i&&(i.find=i.find||cc.$,i.hasClass=i.hasClass||function(e){return this.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},i.addClass=i.addClass||function(e){return this.hasClass(e)||(this.className&&(this.className+=" "),this.className+=e),this},i.removeClass=i.removeClass||function(e){return this.hasClass(e)&&(this.className=this.className.replace(e,"")),this},i.remove=i.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),this},i.appendTo=i.appendTo||function(e){return e.appendChild(this),this},i.prependTo=i.prependTo||function(e){return e.childNodes[0]?e.insertBefore(this,e.childNodes[0]):e.appendChild(this),this},i.transforms=i.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(e,t){return this.position.x=e,this.position.y=t,this.transforms(),this},i.rotate=function(e){return this.rotation=e,this.transforms(),this},i.resize=function(e,t){return this.scale.x=e,this.scale.y=t,this.transforms(),this},i.setSkew=function(e,t){return this.skew.x=e,this.skew.y=t,this.transforms(),this}),i},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O",cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms",cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}switch(cc.$.trans=cc.$.pfx+"Transform",cc.$.translate=cc.$.hd?function(e){return"translate3d("+e.x+"px, "+e.y+"px, 0) "}:function(e){return"translate("+e.x+"px, "+e.y+"px) "},cc.$.rotate=cc.$.hd?function(e){return"rotateZ("+e+"deg) "}:function(e){return"rotate("+e+"deg) "},cc.$.scale=function(e){return"scale("+e.x+", "+e.y+") "},cc.$.skew=function(e){return"skewX("+-e.x+"deg) skewY("+e.y+"deg)"},cc.$new=function(e){return cc.$(document.createElement(e))},cc.$.findpos=function(e){var t=0,i=0;do{t+=e.offsetLeft,i+=e.offsetTop}while(e=e.offsetParent);return{x:t,y:i}},cc.INVALID_INDEX=-1,cc.PI=Math.PI,cc.FLT_MAX=parseFloat("3.402823466e+38F"),cc.FLT_MIN=parseFloat("1.175494351e-38F"),cc.RAD=cc.PI/180,cc.DEG=180/cc.PI,cc.UINT_MAX=4294967295,cc.swap=function(e,t,i){if(!cc.isObject(i)||cc.isUndefined(i.x)||cc.isUndefined(i.y))cc.log(cc._LogInfos.swap);else{var n=i[e];i[e]=i[t],i[t]=n}},cc.lerp=function(e,t,i){return e+(t-e)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(e){return e*cc.RAD},cc.radiansToDegrees=function(e){return e*cc.DEG},cc.radiansToDegress=function(e){return cc.log(cc._LogInfos.radiansToDegress),e*cc.DEG},cc.REPEAT_FOREVER=Number.MAX_VALUE-1,cc.BLEND_SRC=cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?1:770,cc.BLEND_DST=771,cc.nodeDrawSetup=function(e){e._shaderProgram&&(e._shaderProgram.use(),e._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.enableDefaultGLStates=function(){},cc.disableDefaultGLStates=function(){},cc.incrementGLDraws=function(e){cc.g_NumberOfDraws+=e},cc.FLT_EPSILON=1.192092896e-7,cc.contentScaleFactor=cc.IS_RETINA_DISPLAY_SUPPORTED?function(){return cc.director.getContentScaleFactor()}:function(){return 1},cc.pointPointsToPixels=function(e){var t=cc.contentScaleFactor();return cc.p(e.x*t,e.y*t)},cc.pointPixelsToPoints=function(e){var t=cc.contentScaleFactor();return cc.p(e.x/t,e.y/t)},cc._pointPixelsToPointsOut=function(e,t){var i=cc.contentScaleFactor();t.x=e.x/i,t.y=e.y/i},cc.sizePointsToPixels=function(e){var t=cc.contentScaleFactor();return cc.size(e.width*t,e.height*t)},cc.sizePixelsToPoints=function(e){var t=cc.contentScaleFactor();return cc.size(e.width/t,e.height/t)},cc._sizePixelsToPointsOut=function(e,t){var i=cc.contentScaleFactor();t.width=e.width/i,t.height=e.height/i},cc.rectPixelsToPoints=cc.IS_RETINA_DISPLAY_SUPPORTED?function(e){var t=cc.contentScaleFactor();return cc.rect(e.x/t,e.y/t,e.width/t,e.height/t)}:function(e){return e},cc.rectPointsToPixels=cc.IS_RETINA_DISPLAY_SUPPORTED?function(e){var t=cc.contentScaleFactor();return cc.rect(e.x*t,e.y*t,e.width*t,e.height*t)}:function(e){return e},cc.ONE=1,cc.ZERO=0,cc.SRC_ALPHA=770,cc.SRC_ALPHA_SATURATE=776,cc.SRC_COLOR=768,cc.DST_ALPHA=772,cc.DST_COLOR=774,cc.ONE_MINUS_SRC_ALPHA=771,cc.ONE_MINUS_SRC_COLOR=769,cc.ONE_MINUS_DST_ALPHA=773,cc.ONE_MINUS_DST_COLOR=775,cc.ONE_MINUS_CONSTANT_ALPHA=32772,cc.ONE_MINUS_CONSTANT_COLOR=32770,cc.LINEAR=9729,cc.REPEAT=10497,cc.CLAMP_TO_EDGE=33071,cc.MIRRORED_REPEAT=33648,cc.checkGLErrorDebug=function(){if(cc.renderMode==cc._RENDER_TYPE_WEBGL){var e=cc._renderContext.getError();e&&cc.log(cc._LogInfos.checkGLErrorDebug,e)}},cc.DEVICE_ORIENTATION_PORTRAIT=0,cc.DEVICE_ORIENTATION_LANDSCAPE_LEFT=1,cc.DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN=2,cc.DEVICE_ORIENTATION_LANDSCAPE_RIGHT=3,cc.DEVICE_MAX_ORIENTATIONS=2,cc.VERTEX_ATTRIB_FLAG_NONE=0,cc.VERTEX_ATTRIB_FLAG_POSITION=1,cc.VERTEX_ATTRIB_FLAG_COLOR=2,cc.VERTEX_ATTRIB_FLAG_TEX_COORDS=4,cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS,cc.GL_ALL=0,cc.VERTEX_ATTRIB_POSITION=0,cc.VERTEX_ATTRIB_COLOR=1,cc.VERTEX_ATTRIB_TEX_COORDS=2,cc.VERTEX_ATTRIB_MAX=3,cc.UNIFORM_PMATRIX=0,cc.UNIFORM_MVMATRIX=1,cc.UNIFORM_MVPMATRIX=2,cc.UNIFORM_TIME=3,cc.UNIFORM_SINTIME=4,cc.UNIFORM_COSTIME=5,cc.UNIFORM_RANDOM01=6,cc.UNIFORM_SAMPLER=7,cc.UNIFORM_MAX=8,cc.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor",cc.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest",cc.SHADER_POSITION_COLOR="ShaderPositionColor",cc.SHADER_POSITION_TEXTURE="ShaderPositionTexture",cc.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTexture_uColor",cc.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color",cc.SHADER_POSITION_UCOLOR="ShaderPosition_uColor",cc.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor",cc.UNIFORM_PMATRIX_S="CC_PMatrix",cc.UNIFORM_MVMATRIX_S="CC_MVMatrix",cc.UNIFORM_MVPMATRIX_S="CC_MVPMatrix",cc.UNIFORM_TIME_S="CC_Time",cc.UNIFORM_SINTIME_S="CC_SinTime",cc.UNIFORM_COSTIME_S="CC_CosTime",cc.UNIFORM_RANDOM01_S="CC_Random01",cc.UNIFORM_SAMPLER_S="CC_Texture0",cc.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value",cc.ATTRIBUTE_NAME_COLOR="a_color",cc.ATTRIBUTE_NAME_POSITION="a_position",cc.ATTRIBUTE_NAME_TEX_COORD="a_texCoord",cc.ITEM_SIZE=32,cc.CURRENT_ITEM=3233828865,cc.ZOOM_ACTION_TAG=3233828866,cc.NORMAL_TAG=8801,cc.SELECTED_TAG=8802,cc.DISABLE_TAG=8803,cc.arrayVerifyType=function(e,t){if(e&&e.length>0)for(var i=0;i<e.length;i++)if(!(e[i]instanceof t))return cc.log("element type is wrong!"),!1;return!0},cc.arrayRemoveObject=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]==t){e.splice(i,1);break}},cc.arrayRemoveArray=function(e,t){for(var i=0,n=t.length;i<n;i++)cc.arrayRemoveObject(e,t[i])},cc.arrayAppendObjectsToIndex=function(e,t,i){return e.splice.apply(e,[i,0].concat(t)),e},cc.copyArray=function(e){var t,i=e.length,n=new Array(i);for(t=0;t<i;t+=1)n[t]=e[t];return n},(cc=cc||{})._tmp=cc._tmp||{},cc._tmp.WebGLColor=function(){cc.color=function(e,t,i,n,r,o){if(void 0===e)return new cc.Color(0,0,0,255,r,o);if(cc.isString(e)){var s=cc.hexToColor(e);return new cc.Color(s.r,s.g,s.b,s.a)}return cc.isObject(e)?new cc.Color(e.r,e.g,e.b,e.a,e.arrayBuffer,e.offset):new cc.Color(e,t,i,n,r,o)},cc.Color=function(e,t,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Color.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,a=this._offset,c=Uint8Array.BYTES_PER_ELEMENT;this._rU8=new Uint8Array(s,a,1),this._gU8=new Uint8Array(s,a+c,1),this._bU8=new Uint8Array(s,a+2*c,1),this._aU8=new Uint8Array(s,a+3*c,1),this._rU8[0]=e||0,this._gU8[0]=t||0,this._bU8[0]=i||0,this._aU8[0]=null==n?255:n,void 0===n&&(this.a_undefined=!0)},cc.Color.BYTES_PER_ELEMENT=4;var e=cc.Color.prototype;e._getR=function(){return this._rU8[0]},e._setR=function(e){this._rU8[0]=e<0?0:e},e._getG=function(){return this._gU8[0]},e._setG=function(e){this._gU8[0]=e<0?0:e},e._getB=function(){return this._bU8[0]},e._setB=function(e){this._bU8[0]=e<0?0:e},e._getA=function(){return this._aU8[0]},e._setA=function(e){this._aU8[0]=e<0?0:e},e.r,cc.defineGetterSetter(e,"r",e._getR,e._setR),e.g,cc.defineGetterSetter(e,"g",e._getG,e._setG),e.b,cc.defineGetterSetter(e,"b",e._getB,e._setB),e.a,cc.defineGetterSetter(e,"a",e._getA,e._setA),cc.Vertex2F=function(e,t,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._xF32=new Float32Array(this._arrayBuffer,this._offset,1),this._yF32=new Float32Array(this._arrayBuffer,this._offset+4,1),this._xF32[0]=e||0,this._yF32[0]=t||0},cc.Vertex2F.BYTES_PER_ELEMENT=8,Object.defineProperties(cc.Vertex2F.prototype,{x:{get:function(){return this._xF32[0]},set:function(e){this._xF32[0]=e},enumerable:!0},y:{get:function(){return this._yF32[0]},set:function(e){this._yF32[0]=e},enumerable:!0}}),cc.Vertex3F=function(e,t,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._xF32=new Float32Array(o,s,1),this._xF32[0]=e||0,this._yF32=new Float32Array(o,s+Float32Array.BYTES_PER_ELEMENT,1),this._yF32[0]=t||0,this._zF32=new Float32Array(o,s+2*Float32Array.BYTES_PER_ELEMENT,1),this._zF32[0]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,Object.defineProperties(cc.Vertex3F.prototype,{x:{get:function(){return this._xF32[0]},set:function(e){this._xF32[0]=e},enumerable:!0},y:{get:function(){return this._yF32[0]},set:function(e){this._yF32[0]=e},enumerable:!0},z:{get:function(){return this._zF32[0]},set:function(e){this._zF32[0]=e},enumerable:!0}}),cc.Tex2F=function(e,t,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._uF32=new Float32Array(this._arrayBuffer,this._offset,1),this._vF32=new Float32Array(this._arrayBuffer,this._offset+4,1),this._uF32[0]=e||0,this._vF32[0]=t||0},cc.Tex2F.BYTES_PER_ELEMENT=8,Object.defineProperties(cc.Tex2F.prototype,{u:{get:function(){return this._uF32[0]},set:function(e){this._uF32[0]=e},enumerable:!0},v:{get:function(){return this._vF32[0]},set:function(e){this._vF32[0]=e},enumerable:!0}}),cc.Quad2=function(e,t,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,a=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=e?new cc.Vertex2F(e.x,e.y,s,0):new cc.Vertex2F(0,0,s,0),this._tr=t?new cc.Vertex2F(t.x,t.y,s,a):new cc.Vertex2F(0,0,s,a),this._bl=i?new cc.Vertex2F(i.x,i.y,s,2*a):new cc.Vertex2F(0,0,s,2*a),this._br=n?new cc.Vertex2F(n.x,n.y,s,3*a):new cc.Vertex2F(0,0,s,3*a)},cc.Quad2.BYTES_PER_ELEMENT=32,cc.Quad3=function(e,t,i,n){this.bl=e||new cc.Vertex3F(0,0,0),this.br=t||new cc.Vertex3F(0,0,0),this.tl=i||new cc.Vertex3F(0,0,0),this.tr=n||new cc.Vertex3F(0,0,0)},Object.defineProperties(cc.Quad2.prototype,{tl:{get:function(){return this._tl},set:function(e){this._tl.x=e.x,this._tl.y=e.y},enumerable:!0},tr:{get:function(){return this._tr},set:function(e){this._tr.x=e.x,this._tr.y=e.y},enumerable:!0},bl:{get:function(){return this._bl},set:function(e){this._bl.x=e.x,this._bl.y=e.y},enumerable:!0},br:{get:function(){return this._br},set:function(e){this._br.x=e.x,this._br.y=e.y},enumerable:!0}}),cc.V3F_C4B_T2F=function(e,t,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,a=cc.Vertex3F.BYTES_PER_ELEMENT;this._vertices=e?new cc.Vertex3F(e.x,e.y,e.z,o,s):new cc.Vertex3F(0,0,0,o,s),this._colors=t?cc.color(t.r,t.g,t.b,t.a,o,s+a):cc.color(0,0,0,0,o,s+a),this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s+a+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,o,s+a+cc.Color.BYTES_PER_ELEMENT)},cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,Object.defineProperties(cc.V3F_C4B_T2F.prototype,{vertices:{get:function(){return this._vertices},set:function(e){var t=this._vertices;t.x=e.x,t.y=e.y,t.z=e.z},enumerable:!0},colors:{get:function(){return this._colors},set:function(e){var t=this._colors;t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a},enumerable:!0},texCoords:{get:function(){return this._texCoords},set:function(e){this._texCoords.u=e.u,this._texCoords.v=e.v},enumerable:!0}}),cc.V3F_C4B_T2F_Quad=function(e,t,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,a=this._offset,c=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,s,a):new cc.V3F_C4B_T2F(null,null,null,s,a),this._bl=t?new cc.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,s,a+c):new cc.V3F_C4B_T2F(null,null,null,s,a+c),this._tr=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,s,a+2*c):new cc.V3F_C4B_T2F(null,null,null,s,a+2*c),this._br=n?new cc.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,s,a+3*c):new cc.V3F_C4B_T2F(null,null,null,s,a+3*c)},cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,Object.defineProperties(cc.V3F_C4B_T2F_Quad.prototype,{tl:{get:function(){return this._tl},set:function(e){var t=this._tl;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},enumerable:!0},bl:{get:function(){return this._bl},set:function(e){var t=this._bl;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},enumerable:!0},tr:{get:function(){return this._tr},set:function(e){var t=this._tr;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},enumerable:!0},br:{get:function(){return this._br},set:function(e){var t=this._br;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},enumerable:!0},arrayBuffer:{get:function(){return this._arrayBuffer},enumerable:!0}}),cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad},cc.V3F_C4B_T2F_QuadCopy=function(e){if(!e)return cc.V3F_C4B_T2F_QuadZero();var t=e.tl,i=e.bl,n=e.tr,r=e.br;return{tl:{vertices:{x:t.vertices.x,y:t.vertices.y,z:t.vertices.z},colors:{r:t.colors.r,g:t.colors.g,b:t.colors.b,a:t.colors.a},texCoords:{u:t.texCoords.u,v:t.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:r.vertices.x,y:r.vertices.y,z:r.vertices.z},colors:{r:r.colors.r,g:r.colors.g,b:r.colors.b,a:r.colors.a},texCoords:{u:r.texCoords.u,v:r.texCoords.v}}}},cc.V3F_C4B_T2F_QuadsCopy=function(e){if(!e)return[];for(var t=[],i=0;i<e.length;i++)t.push(cc.V3F_C4B_T2F_QuadCopy(e[i]));return t},cc.V2F_C4B_T2F=function(e,t,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,a=cc.Vertex2F.BYTES_PER_ELEMENT;this._vertices=e?new cc.Vertex2F(e.x,e.y,o,s):new cc.Vertex2F(0,0,o,s),this._colors=t?cc.color(t.r,t.g,t.b,t.a,o,s+a):cc.color(0,0,0,0,o,s+a),this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s+a+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,o,s+a+cc.Color.BYTES_PER_ELEMENT)},cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,Object.defineProperties(cc.V2F_C4B_T2F.prototype,{vertices:{get:function(){return this._vertices},set:function(e){this._vertices.x=e.x,this._vertices.y=e.y},enumerable:!0},colors:{get:function(){return this._colors},set:function(e){var t=this._colors;t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a},enumerable:!0},texCoords:{get:function(){return this._texCoords},set:function(e){this._texCoords.u=e.u,this._texCoords.v=e.v},enumerable:!0}}),cc.V2F_C4B_T2F_Triangle=function(e,t,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,a=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=e?new cc.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s),this._b=t?new cc.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,o,s+a):new cc.V2F_C4B_T2F(null,null,null,o,s+a),this._c=i?new cc.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,o,s+2*a):new cc.V2F_C4B_T2F(null,null,null,o,s+2*a)},cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,Object.defineProperties(cc.V2F_C4B_T2F_Triangle.prototype,{a:{get:function(){return this._a},set:function(e){var t=this._a;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},enumerable:!0},b:{get:function(){return this._b},set:function(e){var t=this._b;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},enumerable:!0},c:{get:function(){return this._c},set:function(e){var t=this._c;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},enumerable:!0}})},cc.Color=function(e,t,i,n){this.r=e||0,this.g=t||0,this.b=i||0,this.a=null==n?255:n},cc.color=function(e,t,i,n){return void 0===e?{r:0,g:0,b:0,a:255}:cc.isString(e)?cc.hexToColor(e):cc.isObject(e)?{r:e.r,g:e.g,b:e.b,a:null==e.a?255:e.a}:{r:e,g:t,b:i,a:null==n?255:n}},cc.colorEqual=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b},cc.Acceleration=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.timestamp=n||0},cc.Vertex2F=function(e,t){this.x=e||0,this.y=t||0},cc.vertex2=function(e,t){return new cc.Vertex2F(e,t)},cc.Vertex3F=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},cc.vertex3=function(e,t,i){return new cc.Vertex3F(e,t,i)},cc.Tex2F=function(e,t){this.u=e||0,this.v=t||0},cc.tex2=function(e,t){return new cc.Tex2F(e,t)},cc.BlendFunc=function(e,t){this.src=e,this.dst=t},cc.blendFuncDisable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.hexToColor=function(e){e=e.replace(/^#?/,"0x");var t=parseInt(e),i=t>>16,n=(t>>8)%256,r=t%256;return cc.color(i,n,r)},cc.colorToHex=function(e){var t=e.r.toString(16),i=e.g.toString(16),n=e.b.toString(16);return"#"+(e.r<16?"0"+t:t)+(e.g<16?"0"+i:i)+(e.b<16?"0"+n:n)},cc.TEXT_ALIGNMENT_LEFT=0,cc.TEXT_ALIGNMENT_CENTER=1,cc.TEXT_ALIGNMENT_RIGHT=2,cc.VERTICAL_TEXT_ALIGNMENT_TOP=0,cc.VERTICAL_TEXT_ALIGNMENT_CENTER=1,cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2,cc._Dictionary=cc.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return"key_"+ ++this.__currId},setObject:function(e,t){if(null!=t){var i=this.__getKey();this._keyMapTb[i]=t,this._valueMapTb[i]=e}},objectForKey:function(e){if(null==e)return null;var t=this._keyMapTb;for(var i in t)if(t[i]===e)return this._valueMapTb[i];return null},valueForKey:function(e){return this.objectForKey(e)},removeObjectForKey:function(e){if(null!=e){var t=this._keyMapTb;for(var i in t)if(t[i]===e)return delete this._valueMapTb[i],void delete t[i]}},removeObjectsForKeys:function(e){if(null!=e)for(var t=0;t<e.length;t++)this.removeObjectForKey(e[t])},allKeys:function(){var e=[],t=this._keyMapTb;for(var i in t)e.push(t[i]);return e},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}}),cc.FontDefinition=function(){var e=this;e.fontName="Arial",e.fontSize=12,e.textAlign=cc.TEXT_ALIGNMENT_CENTER,e.verticalAlign=cc.VERTICAL_TEXT_ALIGNMENT_TOP,e.fillStyle=cc.color(255,255,255,255),e.boundingWidth=0,e.boundingHeight=0,e.strokeEnabled=!1,e.strokeStyle=cc.color(255,255,255,255),e.lineWidth=1,e.shadowEnabled=!1,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowOpacity=1},cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLColor),cc._LogInfos.MissingFile,"CCTypesWebGL.js"),cc._tmp.WebGLColor(),delete cc._tmp.WebGLColor),cc.assert(cc.isFunction(cc._tmp.PrototypeColor),cc._LogInfos.MissingFile,"CCTypesPropertyDefine.js"),cc._tmp.PrototypeColor(),delete cc._tmp.PrototypeColor,cc.Touches=[],cc.TouchesIntergerDict={},cc.DENSITYDPI_DEVICE="device-dpi",cc.DENSITYDPI_HIGH="high-dpi",cc.DENSITYDPI_MEDIUM="medium-dpi",cc.DENSITYDPI_LOW="low-dpi",cc.__BrowserGetter={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(e){return e&&e!==this.html?e.clientWidth:window.innerWidth},availHeight:function(e){return e&&e!==this.html?e.clientHeight:window.innerHeight},meta:{width:"device-width","user-scalable":"no"}},cc.sys.browserType){case cc.sys.BROWSER_TYPE_SAFARI:cc.__BrowserGetter.meta["minimal-ui"]="true",cc.__BrowserGetter.availWidth=function(e){return e.clientWidth},cc.__BrowserGetter.availHeight=function(e){return e.clientHeight};break;case cc.sys.BROWSER_TYPE_CHROME:cc.__BrowserGetter.__defineGetter__("target-densitydpi",function(){return cc.view._targetDensityDPI});case cc.sys.BROWSER_TYPE_UC:cc.__BrowserGetter.availWidth=function(e){return e.clientWidth},cc.__BrowserGetter.availHeight=function(e){return e.clientHeight};break;case cc.sys.BROWSER_TYPE_MIUI:cc.__BrowserGetter.init=function(e){if(!e.__resizeWithBrowserSize){var t=function(){e.setDesignResolutionSize(e._designResolutionSize.width,e._designResolutionSize.height,e._resolutionPolicy),window.removeEventListener("resize",t,!1)};window.addEventListener("resize",t,!1)}}}cc.EGLView=cc.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:!1,_autoFullScreen:!0,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_indexBitsUsed:0,_maxTouches:5,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:!1,_captured:!1,_wnd:null,_hDC:null,_hRC:null,_supportTouch:!1,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:!1,_isAdjustViewPort:!0,_targetDensityDPI:null,ctor:function(){var e=this,t=document,i=cc.ContainerStrategy,n=cc.ContentStrategy;cc.__BrowserGetter.init(this),e._frame=cc.container.parentNode===t.body?t.documentElement:cc.container.parentNode,e._frameSize=cc.size(0,0),e._initFrameSize();var r=cc._canvas.width,o=cc._canvas.height;e._designResolutionSize=cc.size(r,o),e._originalDesignResolutionSize=cc.size(r,o),e._viewPortRect=cc.rect(0,0,r,o),e._visibleRect=cc.rect(0,0,r,o),e._contentTranslateLeftTop={left:0,top:0},e._viewName="Cocos2dHTML5";var s=cc.sys;e.enableRetina(s.os==s.OS_IOS||s.os==s.OS_OSX),cc.visibleRect&&cc.visibleRect.init(e._visibleRect),e._rpExactFit=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.EXACT_FIT),e._rpShowAll=new cc.ResolutionPolicy(i.PROPORTION_TO_FRAME,n.SHOW_ALL),e._rpNoBorder=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.NO_BORDER),e._rpFixedHeight=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.FIXED_HEIGHT),e._rpFixedWidth=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.FIXED_WIDTH),e._hDC=cc._canvas,e._hRC=cc._renderContext,e._targetDensityDPI=cc.DENSITYDPI_HIGH},_resizeEvent:function(){var e,t=(e=this.setDesignResolutionSize?this:cc.view)._frameSize.width,i=e._frameSize.height;if(e._initFrameSize(),e._frameSize.width!=t||e._frameSize.height!=i){e._resizeCallback&&e._resizeCallback.call();var n=e._originalDesignResolutionSize.width,r=e._originalDesignResolutionSize.height;n>0&&e.setDesignResolutionSize(n,r,e._resolutionPolicy)}},setTargetDensityDPI:function(e){this._targetDensityDPI=e,this._setViewPortMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(e){e?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,cc._addEventListener(window,"resize",this._resizeEvent),cc._addEventListener(window,"orientationchange",this._resizeEvent)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("orientationchange",this._resizeEvent))},setResizeCallback:function(e){(cc.isFunction(e)||null==e)&&(this._resizeCallback=e)},_initFrameSize:function(){var e=this._frameSize;e.width=cc.__BrowserGetter.availWidth(this._frame),e.height=cc.__BrowserGetter.availHeight(this._frame)},_adjustSizeKeepCanvasSize:function(){var e=this._originalDesignResolutionSize.width,t=this._originalDesignResolutionSize.height;e>0&&this.setDesignResolutionSize(e,t,this._resolutionPolicy)},_setViewPortMeta:function(){if(this._isAdjustViewPort){var e=document.getElementById("cocosMetaElement");e&&document.head.removeChild(e);var t,i,n=document.getElementsByName("viewport"),r=n?n[0]:null;(e=cc.newElement("meta")).id="cocosMetaElement",e.name="viewport",e.content="",t=cc.__BrowserGetter.meta,i=r?r.content:"";for(var o in t)new RegExp(o).test(i)||(i+=","+o+"="+t[o]);/^,/.test(i)&&(i=i.substr(1)),e.content=i,r&&(r.content=i),document.head.appendChild(e)}},_setScaleXYForRenderTexture:function(){var e=cc.contentScaleFactor();this._scaleX=e,this._scaleY=e},_resetScale:function(){this._scaleX=this._originalScaleX,this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(e){this._isAdjustViewPort=e},enableRetina:function(e){this._retinaEnabled=!!e},isRetinaEnabled:function(){return this._retinaEnabled},enableAutoFullScreen:function(e){this._autoFullScreen=!!e},isAutoFullScreenEnabled:function(){return this._autoFullScreen},end:function(){},isOpenGLReady:function(){return null!=this._hDC&&null!=this._hRC},setFrameZoomFactor:function(e){this._frameZoomFactor=e,this.centerWindow(),cc.director.setProjection(cc.director.getProjection())},swapBuffers:function(){},setIMEKeyboardState:function(e){},setContentTranslateLeftTop:function(e,t){this._contentTranslateLeftTop={left:e,top:t}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(e,t){this._frameSize.width=e,this._frameSize.height=t,this._frame.style.width=e+"px",this._frame.style.height=t+"px",this._resizeEvent(),cc.director.setProjection(cc.director.getProjection())},centerWindow:function(){},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(e){var t=this;if(e instanceof cc.ResolutionPolicy)t._resolutionPolicy=e;else{var i=cc.ResolutionPolicy;e===i.EXACT_FIT&&(t._resolutionPolicy=t._rpExactFit),e===i.SHOW_ALL&&(t._resolutionPolicy=t._rpShowAll),e===i.NO_BORDER&&(t._resolutionPolicy=t._rpNoBorder),e===i.FIXED_HEIGHT&&(t._resolutionPolicy=t._rpFixedHeight),e===i.FIXED_WIDTH&&(t._resolutionPolicy=t._rpFixedWidth)}},setDesignResolutionSize:function(e,t,i){if(e>0||t>0){this.setResolutionPolicy(i);var n=this._resolutionPolicy;if(n){n.preApply(this),cc.sys.isMobile&&this._setViewPortMeta(),this._initFrameSize(),this._originalDesignResolutionSize.width=this._designResolutionSize.width=e,this._originalDesignResolutionSize.height=this._designResolutionSize.height=t;var r=n.apply(this,this._designResolutionSize);if(r.scale&&2==r.scale.length&&(this._scaleX=r.scale[0],this._scaleY=r.scale[1]),r.viewport){var o=this._viewPortRect,s=this._visibleRect,a=r.viewport;o.x=a.x,o.y=a.y,o.width=a.width,o.height=a.height,s.x=-o.x/this._scaleX,s.y=-o.y/this._scaleY,s.width=cc._canvas.width/this._scaleX,s.height=cc._canvas.height/this._scaleY,cc._renderContext.setOffset&&cc._renderContext.setOffset(o.x,-o.y)}var c=cc.director;c._winSizeInPoints.width=this._designResolutionSize.width,c._winSizeInPoints.height=this._designResolutionSize.height,n.postApply(this),cc.winSize.width=c._winSizeInPoints.width,cc.winSize.height=c._winSizeInPoints.height,cc._renderType==cc._RENDER_TYPE_WEBGL&&(c._createStatsLabel(),c.setGLDefaultValues()),this._originalScaleX=this._scaleX,this._originalScaleY=this._scaleY,cc.DOM&&cc.DOM._resetEGLViewDiv(),cc.visibleRect&&cc.visibleRect.init(this._visibleRect)}else cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2)}else cc.log(cc._LogInfos.EGLView_setDesignResolutionSize)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setViewPortInPoints:function(e,t,i,n){var r=this._frameZoomFactor,o=this._scaleX,s=this._scaleY;cc._renderContext.viewport(e*o*r+this._viewPortRect.x*r,t*s*r+this._viewPortRect.y*r,i*o*r,n*s*r)},setScissorInPoints:function(e,t,i,n){var r=this._frameZoomFactor,o=this._scaleX,s=this._scaleY;cc._renderContext.scissor(e*o*r+this._viewPortRect.x*r,t*s*r+this._viewPortRect.y*r,i*o*r,n*s*r)},isScissorEnabled:function(){var e=cc._renderContext;return e.isEnabled(e.SCISSOR_TEST)},getScissorRect:function(){var e=cc._renderContext,t=this._scaleX,i=this._scaleY,n=e.getParameter(e.SCISSOR_BOX);return cc.rect((n[0]-this._viewPortRect.x)/t,(n[1]-this._viewPortRect.y)/i,n[2]/t,n[3]/i)},setViewName:function(e){null!=e&&e.length>0&&(this._viewName=e)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(e,t,i){return{x:this._devicePixelRatio*(e-i.left),y:this._devicePixelRatio*(i.top+i.height-t)}},_convertMouseToLocationInView:function(e,t){var i=this._viewPortRect,n=this;e.x=(n._devicePixelRatio*(e.x-t.left)-i.x)/n._scaleX,e.y=(n._devicePixelRatio*(t.top+t.height-e.y)-i.y)/n._scaleY},_convertTouchesWithScale:function(e){for(var t,i,n,r=this._viewPortRect,o=this._scaleX,s=this._scaleY,a=0;a<e.length;a++)i=(t=e[a])._point,n=t._prevPoint,t._setPoint((i.x-r.x)/o,(i.y-r.y)/s),t._setPrevPoint((n.x-r.x)/o,(n.y-r.y)/s)}}),cc.EGLView._getInstance=function(){return this._instance||(this._instance=this._instance||new cc.EGLView,this._instance.initialize()),this._instance},cc.ContainerStrategy=cc.Class.extend({preApply:function(e){},apply:function(e,t){},postApply:function(e){},_setupContainer:function(e,t,i){var n=e._frame;cc.view._autoFullScreen&&cc.sys.isMobile&&n==document.documentElement&&cc.screen.autoFullScreen(n);var r=cc._canvas,o=cc.container;o.style.width=r.style.width=t+"px",o.style.height=r.style.height=i+"px";var s=e._devicePixelRatio=1;e.isRetinaEnabled()&&(s=e._devicePixelRatio=window.devicePixelRatio||1),r.width=t*s,r.height=i*s,cc._renderContext.resetCache&&cc._renderContext.resetCache();var a,c=document.body;c&&(a=c.style)&&(a.paddingTop=a.paddingTop||"0px",a.paddingRight=a.paddingRight||"0px",a.paddingBottom=a.paddingBottom||"0px",a.paddingLeft=a.paddingLeft||"0px",a.borderTop=a.borderTop||"0px",a.borderRight=a.borderRight||"0px",a.borderBottom=a.borderBottom||"0px",a.borderLeft=a.borderLeft||"0px",a.marginTop=a.marginTop||"0px",a.marginRight=a.marginRight||"0px",a.marginBottom=a.marginBottom||"0px",a.marginLeft=a.marginLeft||"0px")},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var e=document.body.style;e.width=window.innerWidth+"px",e.height=window.innerHeight+"px",e.overflow="hidden";var t=cc.container.style;t.position="fixed",t.left=t.top="0px",document.body.scrollTop=0}}),cc.ContentStrategy=cc.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(e,t,i,n,r,o){Math.abs(e-i)<2&&(i=e),Math.abs(t-n)<2&&(n=t);var s=cc.rect(Math.round((e-i)/2),Math.round((t-n)/2),i,n);return cc._renderType,cc._RENDER_TYPE_CANVAS,this._result.scale=[r,o],this._result.viewport=s,this._result},preApply:function(e){},apply:function(e,t){return{scale:[1,1]}},postApply:function(e){}}),function(){var e=cc.ContainerStrategy.extend({apply:function(e){this._setupContainer(e,e._frameSize.width,e._frameSize.height)}}),t=cc.ContainerStrategy.extend({apply:function(e,t){var i,n,r=e._frameSize.width,o=e._frameSize.height,s=cc.container.style,a=t.width,c=t.height,l=r/a,u=o/c;l<u?(i=r,n=c*l):(i=a*u,n=o);var h=Math.round((r-i)/2),d=Math.round((o-n)/2);i=r-2*h,n=o-2*d,this._setupContainer(e,i,n),s.marginLeft=h+"px",s.marginRight=h+"px",s.marginTop=d+"px",s.marginBottom=d+"px"}}),i=(e.extend({preApply:function(e){this._super(e),e._frame=document.documentElement},apply:function(e){this._super(e),this._fixContainer()}}),t.extend({preApply:function(e){this._super(e),e._frame=document.documentElement},apply:function(e,t){this._super(e,t),this._fixContainer()}}),cc.ContainerStrategy.extend({apply:function(e){this._setupContainer(e,cc._canvas.width,cc._canvas.height)}}));cc.ContainerStrategy.EQUAL_TO_FRAME=new e,cc.ContainerStrategy.PROPORTION_TO_FRAME=new t,cc.ContainerStrategy.ORIGINAL_CONTAINER=new i;var n=cc.ContentStrategy.extend({apply:function(e,t){var i=cc._canvas.width,n=cc._canvas.height,r=i/t.width,o=n/t.height;return this._buildResult(i,n,i,n,r,o)}}),r=cc.ContentStrategy.extend({apply:function(e,t){var i,n,r=cc._canvas.width,o=cc._canvas.height,s=t.width,a=t.height,c=r/s,l=o/a,u=0;return c<l?(u=c,i=r,n=a*u):(u=l,i=s*u,n=o),this._buildResult(r,o,i,n,u,u)}}),o=cc.ContentStrategy.extend({apply:function(e,t){var i,n,r,o=cc._canvas.width,s=cc._canvas.height,a=t.width,c=t.height,l=o/a,u=s/c;return l<u?(i=u,n=a*i,r=s):(i=l,n=o,r=c*i),this._buildResult(o,s,n,r,i,i)}}),s=cc.ContentStrategy.extend({apply:function(e,t){var i=cc._canvas.width,n=cc._canvas.height,r=n/t.height,o=i,s=n;return this._buildResult(i,n,o,s,r,r)},postApply:function(e){cc.director._winSizeInPoints=e.getVisibleSize()}}),a=cc.ContentStrategy.extend({apply:function(e,t){var i=cc._canvas.width,n=cc._canvas.height,r=i/t.width,o=i,s=n;return this._buildResult(i,n,o,s,r,r)},postApply:function(e){cc.director._winSizeInPoints=e.getVisibleSize()}});cc.ContentStrategy.EXACT_FIT=new n,cc.ContentStrategy.SHOW_ALL=new r,cc.ContentStrategy.NO_BORDER=new o,cc.ContentStrategy.FIXED_HEIGHT=new s,cc.ContentStrategy.FIXED_WIDTH=new a}(),cc.ResolutionPolicy=cc.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(e,t){this.setContainerStrategy(e),this.setContentStrategy(t)},preApply:function(e){this._containerStrategy.preApply(e),this._contentStrategy.preApply(e)},apply:function(e,t){return this._containerStrategy.apply(e,t),this._contentStrategy.apply(e,t)},postApply:function(e){this._containerStrategy.postApply(e),this._contentStrategy.postApply(e)},setContainerStrategy:function(e){e instanceof cc.ContainerStrategy&&(this._containerStrategy=e)},setContentStrategy:function(e){e instanceof cc.ContentStrategy&&(this._contentStrategy=e)}}),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,cc.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var e,t,i,n=this._fnMap;for(e=0,l=n.length;e<l;e++)if((t=n[e])&&t[1]in document){for(e=0,i=t.length;e<i;e++)this._fn[n[0][e]]=t[e];break}this._supportsFullScreen=void 0!=this._fn.requestFullscreen,this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},fullScreen:function(){return this._supportsFullScreen&&document[this._fn.fullscreenEnabled]},requestFullScreen:function(e,t){if(this._supportsFullScreen){if((e=e||document.documentElement)[this._fn.requestFullscreen](),t){var i=this._fn.fullscreenchange;this._preOnFullScreenChange&&document.removeEventListener(i,this._preOnFullScreenChange),this._preOnFullScreenChange=t,cc._addEventListener(document,i,t,!1)}return e[this._fn.requestFullscreen]()}},exitFullScreen:function(){return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(e,t){function i(){r.requestFullScreen(e,t),n.removeEventListener(r._touchEvent,i)}e=e||document.body;var n=cc._canvas||e,r=this;this.requestFullScreen(e,t),cc._addEventListener(n,this._touchEvent,i)}},cc.screen.init(),cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(e){var t=this.width=e.width,i=this.height=e.height,n=e.x,r=e.y,o=r+i,s=n+t;this.topLeft.x=n,this.topLeft.y=o,this.topRight.x=s,this.topRight.y=o,this.top.x=n+t/2,this.top.y=o,this.bottomLeft.x=n,this.bottomLeft.y=r,this.bottomRight.x=s,this.bottomRight.y=r,this.bottom.x=n+t/2,this.bottom.y=r,this.center.x=n+t/2,this.center.y=r+i/2,this.left.x=n,this.left.y=r+i/2,this.right.x=s,this.right.y=r+i/2}},cc.UIInterfaceOrientationLandscapeLeft=-90,cc.UIInterfaceOrientationLandscapeRight=90,cc.UIInterfaceOrientationPortraitUpsideDown=180,cc.UIInterfaceOrientationPortrait=0,cc.inputManager={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.p(0,0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var e=this._indexBitsUsed,t=0;t<this._maxTouches;t++){if(!(1&e))return this._indexBitsUsed|=1<<t,t;e>>=1}return-1},_removeUsedIndexBit:function(e){if(!(e<0||e>=this._maxTouches)){var t=1<<e;t=~t,this._indexBitsUsed&=t}},_glView:null,handleTouchesBegin:function(e){for(var t,i,n,r=[],o=this._touchesIntegerDict,s=0,a=e.length;s<a;s++)if(t=e[s],n=t.getID(),null==o[n]){var c=this._getUnUsedIndex();if(-1==c){cc.log(cc._LogInfos.inputManager_handleTouchesBegin,c);continue}(i=this._touches[c]=new cc.Touch(t._point.x,t._point.y,t.getID()))._setPrevPoint(t._prevPoint),o[n]=c,r.push(i)}if(r.length>0){this._glView._convertTouchesWithScale(r);var l=new cc.EventTouch(r);l._eventCode=cc.EventTouch.EventCode.BEGAN,cc.eventManager.dispatchEvent(l)}},handleTouchesMove:function(e){for(var t,i,n,r=[],o=this._touches,s=0,a=e.length;s<a;s++)n=(t=e[s]).getID(),null!=(i=this._touchesIntegerDict[n])&&o[i]&&(o[i]._setPoint(t._point),o[i]._setPrevPoint(t._prevPoint),r.push(o[i]));if(r.length>0){this._glView._convertTouchesWithScale(r);var c=new cc.EventTouch(r);c._eventCode=cc.EventTouch.EventCode.MOVED,cc.eventManager.dispatchEvent(c)}},handleTouchesEnd:function(e){var t=this.getSetOfTouchesEndOrCancel(e);if(t.length>0){this._glView._convertTouchesWithScale(t);var i=new cc.EventTouch(t);i._eventCode=cc.EventTouch.EventCode.ENDED,cc.eventManager.dispatchEvent(i)}},handleTouchesCancel:function(e){var t=this.getSetOfTouchesEndOrCancel(e);if(t.length>0){this._glView._convertTouchesWithScale(t);var i=new cc.EventTouch(t);i._eventCode=cc.EventTouch.EventCode.CANCELLED,cc.eventManager.dispatchEvent(i)}},getSetOfTouchesEndOrCancel:function(e){for(var t,i,n,r=[],o=this._touches,s=this._touchesIntegerDict,a=0,c=e.length;a<c;a++)null!=(i=s[n=(t=e[a]).getID()])&&o[i]&&(o[i]._setPoint(t._point),o[i]._setPrevPoint(t._prevPoint),r.push(o[i]),this._removeUsedIndexBit(i),delete s[n]);return r},getHTMLElementPosition:function(e){var t=document.documentElement,i=window,n=null;return n=cc.isFunction(e.getBoundingClientRect)?e.getBoundingClientRect():e instanceof HTMLCanvasElement?{left:0,top:0,width:e.width,height:e.height}:{left:0,top:0,width:parseInt(e.style.width),height:parseInt(e.style.height)},{left:n.left+i.pageXOffset-t.clientLeft,top:n.top+i.pageYOffset-t.clientTop,width:n.width,height:n.height}},getPreTouch:function(e){for(var t=null,i=this._preTouchPool,n=e.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()==n){t=i[r];break}return t||(t=e),t},setPreTouch:function(e){for(var t=!1,i=this._preTouchPool,n=e.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()==n){i[r]=e,t=!0;break}t||(i.length<=50?i.push(e):(i[this._preTouchPoolPointer]=e,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(e,t,i){var n=this._preTouchPoint,r=this._glView.convertToLocationInView(e,t,i),o=new cc.Touch(r.x,r.y);return o._setPrevPoint(n.x,n.y),n.x=r.x,n.y=r.y,o},getMouseEvent:function(e,t,i){var n=this._prevMousePoint;this._glView._convertMouseToLocationInView(e,t);var r=new cc.EventMouse(i);return r.setLocation(e.x,e.y),r._setPrevCursor(n.x,n.y),n.x=e.x,n.y=e.y,r},getPointByEvent:function(e,t){return null!=e.pageX?{x:e.pageX,y:e.pageY}:(t.left-=document.body.scrollLeft,t.top-=document.body.scrollTop,{x:e.clientX,y:e.clientY})},getTouchesByEvent:function(e,t){for(var i,n,r,o=[],s=this._glView,a=this._preTouchPoint,c=e.changedTouches.length,l=0;l<c;l++)if(i=e.changedTouches[l]){var u;u=cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?s.convertToLocationInView(i.pageX,i.pageY,t):s.convertToLocationInView(i.clientX,i.clientY,t),null!=i.identifier?(n=new cc.Touch(u.x,u.y,i.identifier),r=this.getPreTouch(n).getLocation(),n._setPrevPoint(r.x,r.y),this.setPreTouch(n)):(n=new cc.Touch(u.x,u.y))._setPrevPoint(a.x,a.y),a.x=u.x,a.y=u.y,o.push(n)}return o},registerSystemEvent:function(e){if(!this._isRegisterEvent){this._glView=cc.view;var t=this,i="mouse"in cc.sys.capabilities,n="touches"in cc.sys.capabilities,r=!1;if(cc.sys.isMobile&&(r=!0),i&&(cc._addEventListener(window,"mousedown",function(){t._mousePressed=!0},!1),cc._addEventListener(window,"mouseup",function(i){if(!r){var n=t._mousePressed;if(t._mousePressed=!1,n){var o=t.getHTMLElementPosition(e),s=t.getPointByEvent(i,o);if(!cc.rectContainsPoint(new cc.Rect(o.left,o.top,o.width,o.height),s)){t.handleTouchesEnd([t.getTouchByXY(s.x,s.y,o)]);var a=t.getMouseEvent(s,o,cc.EventMouse.UP);a.setButton(i.button),cc.eventManager.dispatchEvent(a)}}}},!1),cc._addEventListener(e,"mousedown",function(i){if(!r){t._mousePressed=!0;var n=t.getHTMLElementPosition(e),o=t.getPointByEvent(i,n);t.handleTouchesBegin([t.getTouchByXY(o.x,o.y,n)]);var s=t.getMouseEvent(o,n,cc.EventMouse.DOWN);s.setButton(i.button),cc.eventManager.dispatchEvent(s),i.stopPropagation(),i.preventDefault(),e.focus()}},!1),cc._addEventListener(e,"mouseup",function(i){if(!r){t._mousePressed=!1;var n=t.getHTMLElementPosition(e),o=t.getPointByEvent(i,n);t.handleTouchesEnd([t.getTouchByXY(o.x,o.y,n)]);var s=t.getMouseEvent(o,n,cc.EventMouse.UP);s.setButton(i.button),cc.eventManager.dispatchEvent(s),i.stopPropagation(),i.preventDefault()}},!1),cc._addEventListener(e,"mousemove",function(i){if(!r){var n=t.getHTMLElementPosition(e),o=t.getPointByEvent(i,n);t.handleTouchesMove([t.getTouchByXY(o.x,o.y,n)]);var s=t.getMouseEvent(o,n,cc.EventMouse.MOVE);t._mousePressed?s.setButton(i.button):s.setButton(null),cc.eventManager.dispatchEvent(s),i.stopPropagation(),i.preventDefault()}},!1),cc._addEventListener(e,"mousewheel",function(i){var n=t.getHTMLElementPosition(e),r=t.getPointByEvent(i,n),o=t.getMouseEvent(r,n,cc.EventMouse.SCROLL);o.setButton(i.button),o.setScrollData(0,i.wheelDelta),cc.eventManager.dispatchEvent(o),i.stopPropagation(),i.preventDefault()},!1),cc._addEventListener(e,"DOMMouseScroll",function(i){var n=t.getHTMLElementPosition(e),r=t.getPointByEvent(i,n),o=t.getMouseEvent(r,n,cc.EventMouse.SCROLL);o.setButton(i.button),o.setScrollData(0,-120*i.detail),cc.eventManager.dispatchEvent(o),i.stopPropagation(),i.preventDefault()},!1)),window.navigator.msPointerEnabled){var o={MSPointerDown:t.handleTouchesBegin,MSPointerMove:t.handleTouchesMove,MSPointerUp:t.handleTouchesEnd,MSPointerCancel:t.handleTouchesCancel};for(var s in o)!function(i,n){cc._addEventListener(e,i,function(i){var r=t.getHTMLElementPosition(e);r.left-=document.documentElement.scrollLeft,r.top-=document.documentElement.scrollTop,n.call(t,[t.getTouchByXY(i.clientX,i.clientY,r)]),i.stopPropagation()},!1)}(s,o[s])}n&&(cc._addEventListener(e,"touchstart",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,t.handleTouchesBegin(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault(),e.focus()}},!1),cc._addEventListener(e,"touchmove",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,t.handleTouchesMove(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1),cc._addEventListener(e,"touchend",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,t.handleTouchesEnd(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1),cc._addEventListener(e,"touchcancel",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,t.handleTouchesCancel(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1)),this._registerKeyboardEvent(),this._registerAccelerometerEvent(),this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(e){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration))),this._accelCurTime+=e}},(_p=cc.inputManager).setAccelerometerEnabled=function(e){var t=this;if(t._accelEnabled!==e){t._accelEnabled=e;var i=cc.director.getScheduler();t._accelEnabled?(t._accelCurTime=0,i.scheduleUpdateForTarget(t)):(t._accelCurTime=0,i.unscheduleUpdateForTarget(t))}},_p.setAccelerometerInterval=function(e){this._accelInterval!==e&&(this._accelInterval=e)},_p._registerKeyboardEvent=function(){cc._addEventListener(cc._canvas,"keydown",function(e){cc.eventManager.dispatchEvent(new cc.EventKeyboard(e.keyCode,!0)),e.stopPropagation(),e.preventDefault()},!1),cc._addEventListener(cc._canvas,"keyup",function(e){cc.eventManager.dispatchEvent(new cc.EventKeyboard(e.keyCode,!1)),e.stopPropagation(),e.preventDefault()},!1)},_p._registerAccelerometerEvent=function(){var e=window,t=this;t._acceleration=new cc.Acceleration,t._accelDeviceEvent=e.DeviceMotionEvent||e.DeviceOrientationEvent,cc.sys.browserType==cc.sys.BROWSER_TYPE_MOBILE_QQ&&(t._accelDeviceEvent=window.DeviceOrientationEvent);var i=t._accelDeviceEvent==e.DeviceMotionEvent?"devicemotion":"deviceorientation",n=navigator.userAgent;(/Android/.test(n)||/Adr/.test(n)&&cc.sys.browserType==cc.BROWSER_TYPE_UC)&&(t._minus=-1),cc._addEventListener(e,i,t.didAccelerate.bind(t),!1)},_p.didAccelerate=function(e){var t=this,i=window;if(t._accelEnabled){var n,r,o,s=t._acceleration;if(t._accelDeviceEvent==window.DeviceMotionEvent){var a=e.accelerationIncludingGravity;n=t._accelMinus*a.x*.1,r=t._accelMinus*a.y*.1,o=.1*a.z}else n=e.gamma/90*.981,r=-e.beta/90*.981,o=e.alpha/90*.981;cc.sys.os===cc.sys.OS_ANDROID?(s.x=-n,s.y=-r):(s.x=n,s.y=r),s.z=o,s.timestamp=e.timeStamp||Date.now();var c=s.x;i.orientation===cc.UIInterfaceOrientationLandscapeRight?(s.x=-s.y,s.y=c):i.orientation===cc.UIInterfaceOrientationLandscapeLeft?(s.x=s.y,s.y=-c):i.orientation===cc.UIInterfaceOrientationPortraitUpsideDown&&(s.x=-s.x,s.y=-s.y)}},delete _p,cc.AffineTransform=function(e,t,i,n,r,o){this.a=e,this.b=t,this.c=i,this.d=n,this.tx=r,this.ty=o},cc.affineTransformMake=function(e,t,i,n,r,o){return{a:e,b:t,c:i,d:n,tx:r,ty:o}},cc.pointApplyAffineTransform=function(e,t){return{x:t.a*e.x+t.c*e.y+t.tx,y:t.b*e.x+t.d*e.y+t.ty}},cc._pointApplyAffineTransform=function(e,t,i){return{x:i.a*e+i.c*t+i.tx,y:i.b*e+i.d*t+i.ty}},cc.sizeApplyAffineTransform=function(e,t){return{width:t.a*e.width+t.c*e.height,height:t.b*e.width+t.d*e.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(e,t){var i=cc.rectGetMinY(e),n=cc.rectGetMinX(e),r=cc.rectGetMaxX(e),o=cc.rectGetMaxY(e),s=cc._pointApplyAffineTransform(n,i,t),a=cc._pointApplyAffineTransform(r,i,t),c=cc._pointApplyAffineTransform(n,o,t),l=cc._pointApplyAffineTransform(r,o,t),u=Math.min(s.x,a.x,c.x,l.x),h=Math.max(s.x,a.x,c.x,l.x),d=Math.min(s.y,a.y,c.y,l.y),p=Math.max(s.y,a.y,c.y,l.y);return cc.rect(u,d,h-u,p-d)},cc._rectApplyAffineTransformIn=function(e,t){var i=cc.rectGetMinY(e),n=cc.rectGetMinX(e),r=cc.rectGetMaxX(e),o=cc.rectGetMaxY(e),s=cc._pointApplyAffineTransform(n,i,t),a=cc._pointApplyAffineTransform(r,i,t),c=cc._pointApplyAffineTransform(n,o,t),l=cc._pointApplyAffineTransform(r,o,t),u=Math.min(s.x,a.x,c.x,l.x),h=Math.max(s.x,a.x,c.x,l.x),d=Math.min(s.y,a.y,c.y,l.y),p=Math.max(s.y,a.y,c.y,l.y);return e.x=u,e.y=d,e.width=h-u,e.height=p-d,e},cc.affineTransformTranslate=function(e,t,i){return{a:e.a,b:e.b,c:e.c,d:e.d,tx:e.tx+e.a*t+e.c*i,ty:e.ty+e.b*t+e.d*i}},cc.affineTransformScale=function(e,t,i){return{a:e.a*t,b:e.b*t,c:e.c*i,d:e.d*i,tx:e.tx,ty:e.ty}},cc.affineTransformRotate=function(e,t){var i=Math.sin(t),n=Math.cos(t);return{a:e.a*n+e.c*i,b:e.b*n+e.d*i,c:e.c*n-e.a*i,d:e.d*n-e.b*i,tx:e.tx,ty:e.ty}},cc.affineTransformConcat=function(e,t){return{a:e.a*t.a+e.b*t.c,b:e.a*t.b+e.b*t.d,c:e.c*t.a+e.d*t.c,d:e.c*t.b+e.d*t.d,tx:e.tx*t.a+e.ty*t.c+t.tx,ty:e.tx*t.b+e.ty*t.d+t.ty}},cc.affineTransformEqualToTransform=function(e,t){return e.a===t.a&&e.b===t.b&&e.c===t.c&&e.d===t.d&&e.tx===t.tx&&e.ty===t.ty},cc.affineTransformInvert=function(e){var t=1/(e.a*e.d-e.b*e.c);return{a:t*e.d,b:-t*e.b,c:-t*e.c,d:t*e.a,tx:t*(e.c*e.ty-e.d*e.tx),ty:t*(e.b*e.tx-e.a*e.ty)}},cc.POINT_EPSILON=parseFloat("1.192092896e-07F"),cc.pNeg=function(e){return cc.p(-e.x,-e.y)},cc.pAdd=function(e,t){return cc.p(e.x+t.x,e.y+t.y)},cc.pSub=function(e,t){return cc.p(e.x-t.x,e.y-t.y)},cc.pMult=function(e,t){return cc.p(e.x*t,e.y*t)},cc.pMidpoint=function(e,t){return cc.pMult(cc.pAdd(e,t),.5)},cc.pDot=function(e,t){return e.x*t.x+e.y*t.y},cc.pCross=function(e,t){return e.x*t.y-e.y*t.x},cc.pPerp=function(e){return cc.p(-e.y,e.x)},cc.pRPerp=function(e){return cc.p(e.y,-e.x)},cc.pProject=function(e,t){return cc.pMult(t,cc.pDot(e,t)/cc.pDot(t,t))},cc.pRotate=function(e,t){return cc.p(e.x*t.x-e.y*t.y,e.x*t.y+e.y*t.x)},cc.pUnrotate=function(e,t){return cc.p(e.x*t.x+e.y*t.y,e.y*t.x-e.x*t.y)},cc.pLengthSQ=function(e){return cc.pDot(e,e)},cc.pDistanceSQ=function(e,t){return cc.pLengthSQ(cc.pSub(e,t))},cc.pLength=function(e){return Math.sqrt(cc.pLengthSQ(e))},cc.pDistance=function(e,t){return cc.pLength(cc.pSub(e,t))},cc.pNormalize=function(e){var t=cc.pLength(e);return 0===t?cc.p(e):cc.pMult(e,1/t)},cc.pForAngle=function(e){return cc.p(Math.cos(e),Math.sin(e))},cc.pToAngle=function(e){return Math.atan2(e.y,e.x)},cc.clampf=function(e,t,i){if(t>i){var n=t;t=i,i=n}return e<t?t:e<i?e:i},cc.pClamp=function(e,t,i){return cc.p(cc.clampf(e.x,t.x,i.x),cc.clampf(e.y,t.y,i.y))},cc.pFromSize=function(e){return cc.p(e.width,e.height)},cc.pCompOp=function(e,t){return cc.p(t(e.x),t(e.y))},cc.pLerp=function(e,t,i){return cc.pAdd(cc.pMult(e,1-i),cc.pMult(t,i))},cc.pFuzzyEqual=function(e,t,i){return e.x-i<=t.x&&t.x<=e.x+i&&e.y-i<=t.y&&t.y<=e.y+i},cc.pCompMult=function(e,t){return cc.p(e.x*t.x,e.y*t.y)},cc.pAngleSigned=function(e,t){var i=cc.pNormalize(e),n=cc.pNormalize(t),r=Math.atan2(i.x*n.y-i.y*n.x,cc.pDot(i,n));return Math.abs(r)<cc.POINT_EPSILON?0:r},cc.pAngle=function(e,t){var i=Math.acos(cc.pDot(cc.pNormalize(e),cc.pNormalize(t)));return Math.abs(i)<cc.POINT_EPSILON?0:i},cc.pRotateByAngle=function(e,t,i){var n=cc.pSub(e,t),r=Math.cos(i),o=Math.sin(i),s=n.x;return n.x=s*r-n.y*o+t.x,n.y=s*o+n.y*r+t.y,n},cc.pLineIntersect=function(e,t,i,n,r){if(e.x==t.x&&e.y==t.y||i.x==n.x&&i.y==n.y)return!1;var o=t.x-e.x,s=t.y-e.y,a=n.x-i.x,c=n.y-i.y,l=e.x-i.x,u=e.y-i.y,h=c*o-a*s;return r.x=a*u-c*l,r.y=o*u-s*l,0==h?0==r.x||0==r.y:(r.x=r.x/h,r.y=r.y/h,!0)},cc.pSegmentIntersect=function(e,t,i,n){var r=cc.p(0,0);return!!(cc.pLineIntersect(e,t,i,n,r)&&r.x>=0&&r.x<=1&&r.y>=0&&r.y<=1)},cc.pIntersectPoint=function(e,t,i,n){var r=cc.p(0,0);if(cc.pLineIntersect(e,t,i,n,r)){var o=cc.p(0,0);return o.x=e.x+r.x*(t.x-e.x),o.y=e.y+r.x*(t.y-e.y),o}return cc.p(0,0)},cc.pSameAs=function(e,t){return null!=e&&null!=t&&(e.x==t.x&&e.y==t.y)},cc.pZeroIn=function(e){e.x=0,e.y=0},cc.pIn=function(e,t){e.x=t.x,e.y=t.y},cc.pMultIn=function(e,t){e.x*=t,e.y*=t},cc.pSubIn=function(e,t){e.x-=t.x,e.y-=t.y},cc.pAddIn=function(e,t){e.x+=t.x,e.y+=t.y},cc.pNormalizeIn=function(e){cc.pMultIn(e,1/Math.sqrt(e.x*e.x+e.y*e.y))},cc.vertexLineToPolygon=function(e,t,i,n,r){if(!((r+=n)<=1)){t*=.5;for(var o,s=r-1,a=n;a<r;a++){o=2*a;var c,l=cc.p(e[2*a],e[2*a+1]);if(0===a)c=cc.pPerp(cc.pNormalize(cc.pSub(l,cc.p(e[2*(a+1)],e[2*(a+1)+1]))));else if(a===s)c=cc.pPerp(cc.pNormalize(cc.pSub(cc.p(e[2*(a-1)],e[2*(a-1)+1]),l)));else{var u=cc.p(e[2*(a-1)],e[2*(a-1)+1]),h=cc.p(e[2*(a+1)],e[2*(a+1)+1]),d=cc.pNormalize(cc.pSub(h,l)),p=cc.pNormalize(cc.pSub(u,l)),_=Math.acos(cc.pDot(d,p));c=_<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(d,p))):_<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(d,p)):cc.pPerp(cc.pNormalize(cc.pSub(h,u)))}c=cc.pMult(c,t),i[2*o]=l.x+c.x,i[2*o+1]=l.y+c.y,i[2*(o+1)]=l.x-c.x,i[2*(o+1)+1]=l.y-c.y}for(a=n=0==n?0:n-1;a<s;a++){var f=(o=2*a)+2,m=cc.vertex2(i[2*o],i[2*o+1]),g=cc.vertex2(i[2*(o+1)],i[2*(o+1)+1]),y=cc.vertex2(i[2*f],i[2*f]),T=cc.vertex2(i[2*(f+1)],i[2*(f+1)+1]),v=!cc.vertexLineIntersect(m.x,m.y,T.x,T.y,g.x,g.y,y.x,y.y);v.isSuccess||(v.value<0||v.value>1)&&(v.isSuccess=!0),v.isSuccess&&(i[2*f]=T.x,i[2*f+1]=T.y,i[2*(f+1)]=y.x,i[2*(f+1)+1]=y.y)}}},cc.vertexLineIntersect=function(e,t,i,n,r,o,s,a){var c,l,u,h;return e==i&&t==n||r==s&&o==a?{isSuccess:!1,value:0}:(i-=e,n-=t,r-=e,o-=t,s-=e,a-=t,c=Math.sqrt(i*i+n*n),l=i/c,u=n/c,h=r*l+o*u,o=o*l-r*u,r=h,h=s*l+a*u,a=a*l-s*u,s=h,o==a?{isSuccess:!1,value:0}:{isSuccess:!0,value:(s+(r-s)*a/(a-o))/c})},cc.vertexListIsClockwise=function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t],r=e[(t+1)%i],o=e[(t+2)%i];if(cc.pCross(cc.pSub(r,n),cc.pSub(o,r))>0)return!1}return!0},cc.CGAffineToGL=function(e,t){t[2]=t[3]=t[6]=t[7]=t[8]=t[9]=t[11]=t[14]=0,t[10]=t[15]=1,t[0]=e.a,t[4]=e.c,t[12]=e.tx,t[1]=e.b,t[5]=e.d,t[13]=e.ty},cc.GLToCGAffine=function(e,t){t.a=e[0],t.c=e[4],t.tx=e[12],t.b=e[1],t.d=e[5],t.ty=e[13]},cc.Touch=cc.Class.extend({_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(e,t,i){this._point=cc.p(e||0,t||0),this._id=i||0},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return cc.pSub(this._point,this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getID:function(){return this._id},getId:function(){return cc.log("getId is deprecated. Please use getID instead."),this._id},setTouchInfo:function(e,t,i){this._prevPoint=this._point,this._point=cc.p(t||0,i||0),this._id=e,this._startPointCaptured||(this._startPoint=cc.p(this._point),this._startPointCaptured=!0)},_setPoint:function(e,t){void 0===t?(this._point.x=e.x,this._point.y=e.y):(this._point.x=e,this._point.y=t)},_setPrevPoint:function(e,t){this._prevPoint=void 0===t?cc.p(e.x,e.y):cc.p(e||0,t||0)}}),cc.Event=cc.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(e){this._currentTarget=e},ctor:function(e){this._type=e},getType:function(){return this._type},stopPropagation:function(){this._isStopped=!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}}),cc.Event.TOUCH=0,cc.Event.KEYBOARD=1,cc.Event.ACCELERATION=2,cc.Event.MOUSE=3,cc.Event.FOCUS=4,cc.Event.CUSTOM=6,cc.EventCustom=cc.Event.extend({_eventName:null,_userData:null,ctor:function(e){cc.Event.prototype.ctor.call(this,cc.Event.CUSTOM),this._eventName=e},setUserData:function(e){this._userData=e},getUserData:function(){return this._userData},getEventName:function(){return this._eventName}}),cc.EventMouse=cc.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(e){cc.Event.prototype.ctor.call(this,cc.Event.MOUSE),this._eventType=e},setScrollData:function(e,t){this._scrollX=e,this._scrollY=t},getScrollX:function(){return this._scrollX},getScrollY:function(){return this._scrollY},setLocation:function(e,t){this._x=e,this._y=t},getLocation:function(){return{x:this._x,y:this._y}},getLocationInView:function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},_setPrevCursor:function(e,t){this._prevX=e,this._prevY=t},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},getDeltaX:function(){return this._x-this._prevX},getDeltaY:function(){return this._y-this._prevY},setButton:function(e){this._button=e},getButton:function(){return this._button},getLocationX:function(){return this._x},getLocationY:function(){return this._y}}),cc.EventMouse.NONE=0,cc.EventMouse.DOWN=1,cc.EventMouse.UP=2,cc.EventMouse.MOVE=3,cc.EventMouse.SCROLL=4,cc.EventMouse.BUTTON_LEFT=0,cc.EventMouse.BUTTON_RIGHT=2,cc.EventMouse.BUTTON_MIDDLE=1,cc.EventMouse.BUTTON_4=3,cc.EventMouse.BUTTON_5=4,cc.EventMouse.BUTTON_6=5,cc.EventMouse.BUTTON_7=6,cc.EventMouse.BUTTON_8=7,cc.EventTouch=cc.Event.extend({_eventCode:0,_touches:null,ctor:function(e){cc.Event.prototype.ctor.call(this,cc.Event.TOUCH),this._touches=e||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(e){this._eventCode=e},_setTouches:function(e){this._touches=e}}),cc.EventTouch.MAX_TOUCHES=5,cc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3},cc.EventFocus=cc.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(e,t){cc.Event.prototype.ctor.call(this,cc.Event.FOCUS),this._widgetGetFocus=t,this._widgetLoseFocus=e}}),cc.EventListener=cc.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:!1,_fixedPriority:0,_node:null,_paused:!0,_isEnabled:!0,ctor:function(e,t,i){this._onEvent=i,this._type=e||0,this._listenerID=t||""},_setPaused:function(e){this._paused=e},_isPaused:function(){return this._paused},_setRegistered:function(e){this._registered=e},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(e){this._fixedPriority=e},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(e){this._node=e},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!=this._onEvent},clone:function(){return null},setEnabled:function(e){this._isEnabled=e},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}}),cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=5,cc.EventListener.ACCELERATION=6,cc.EventListener.CUSTOM=8,cc.EventListener.FOCUS=7,cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(e,t){this._onCustomEvent=t;var i=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,e,function(e){null!=i._onCustomEvent&&i._onCustomEvent(e)})},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!=this._onCustomEvent},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent)}}),cc._EventListenerCustom.create=function(e,t){return new cc._EventListenerCustom(e,t)},cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){var e=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,function(t){var i=cc.EventMouse;switch(t._eventType){case i.DOWN:e.onMouseDown&&e.onMouseDown(t);break;case i.UP:e.onMouseUp&&e.onMouseUp(t);break;case i.MOVE:e.onMouseMove&&e.onMouseMove(t);break;case i.SCROLL:e.onMouseScroll&&e.onMouseScroll(t)}})},clone:function(){var e=new cc._EventListenerMouse;return e.onMouseDown=this.onMouseDown,e.onMouseUp=this.onMouseUp,e.onMouseMove=this.onMouseMove,e.onMouseScroll=this.onMouseScroll,e},checkAvailable:function(){return!0}}),cc._EventListenerMouse.LISTENER_ID="__cc_mouse",cc._EventListenerMouse.create=function(){return new cc._EventListenerMouse},cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,cc._EventListenerTouchOneByOne.LISTENER_ID,null),this._claimedTouches=[]},setSwallowTouches:function(e){this.swallowTouches=e},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var e=new cc._EventListenerTouchOneByOne;return e.onTouchBegan=this.onTouchBegan,e.onTouchMoved=this.onTouchMoved,e.onTouchEnded=this.onTouchEnded,e.onTouchCancelled=this.onTouchCancelled,e.swallowTouches=this.swallowTouches,e},checkAvailable:function(){return!!this.onTouchBegan||(cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable),!1)}}),cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",cc._EventListenerTouchOneByOne.create=function(){return new cc._EventListenerTouchOneByOne},cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var e=new cc._EventListenerTouchAllAtOnce;return e.onTouchesBegan=this.onTouchesBegan,e.onTouchesMoved=this.onTouchesMoved,e.onTouchesEnded=this.onTouchesEnded,e.onTouchesCancelled=this.onTouchesCancelled,e},checkAvailable:function(){return null!=this.onTouchesBegan||null!=this.onTouchesMoved||null!=this.onTouchesEnded||null!=this.onTouchesCancelled||(cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable),!1)}}),cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",cc._EventListenerTouchAllAtOnce.create=function(){return new cc._EventListenerTouchAllAtOnce},cc.EventListener.create=function(e){cc.assert(e&&e.event,cc._LogInfos.EventListener_create);var t=e.event;delete e.event;var i=null;t===cc.EventListener.TOUCH_ONE_BY_ONE?i=new cc._EventListenerTouchOneByOne:t===cc.EventListener.TOUCH_ALL_AT_ONCE?i=new cc._EventListenerTouchAllAtOnce:t===cc.EventListener.MOUSE?i=new cc._EventListenerMouse:t===cc.EventListener.CUSTOM?(i=new cc._EventListenerCustom(e.eventName,e.callback),delete e.eventName,delete e.callback):t===cc.EventListener.KEYBOARD?i=new cc._EventListenerKeyboard:t===cc.EventListener.ACCELERATION?(i=new cc._EventListenerAcceleration(e.callback),delete e.callback):t===cc.EventListener.FOCUS&&(i=new cc._EventListenerFocus);for(var n in e)i[n]=e[n];return i},cc._EventListenerFocus=cc.EventListener.extend({clone:function(){var e=new cc._EventListenerFocus;return e.onFocusChanged=this.onFocusChanged,e},checkAvailable:function(){return!!this.onFocusChanged||(cc.log("Invalid EventListenerFocus!"),!1)},onFocusChanged:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.FOCUS,cc._EventListenerFocus.LISTENER_ID,function(e){this.onFocusChanged&&this.onFocusChanged(e._widgetLoseFocus,e._widgetGetFocus)})}}),cc._EventListenerFocus.LISTENER_ID="__cc_focus_event",cc._EventListenerVector=cc.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[],this._sceneGraphListeners=[]},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(e){0==e._getFixedPriority()?this._sceneGraphListeners.push(e):this._fixedListeners.push(e)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}}),cc.__getListenerID=function(e){var t=cc.Event,i=e.getType();return i===t.ACCELERATION?cc._EventListenerAcceleration.LISTENER_ID:i===t.CUSTOM?e.getEventName():i===t.KEYBOARD?cc._EventListenerKeyboard.LISTENER_ID:i===t.MOUSE?cc._EventListenerMouse.LISTENER_ID:i===t.FOCUS?cc._EventListenerFocus.LISTENER_ID:(i===t.TOUCH&&cc.log(cc._LogInfos.__getListenerID),"")},cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[cc.game.EVENT_HIDE,cc.game.EVENT_SHOW],_setDirtyForNode:function(e){null!=this._nodeListenersMap[e.__instanceId]&&this._dirtyNodes.push(e);for(var t=e.getChildren(),i=0,n=t.length;i<n;i++)this._setDirtyForNode(t[i])},pauseTarget:function(e,t){var i,n,r=this._nodeListenersMap[e.__instanceId];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!0);if(!0===t){var o=e.getChildren();for(i=0,n=o.length;i<n;i++)this.pauseTarget(o[i],!0)}},resumeTarget:function(e,t){var i,n,r=this._nodeListenersMap[e.__instanceId];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!1);if(this._setDirtyForNode(e),!0===t){var o=e.getChildren();for(i=0,n=o.length;i<n;i++)this.resumeTarget(o[i],!0)}},_addListener:function(e){0===this._inDispatch?this._forceAddEventListener(e):this._toAddedListeners.push(e)},_forceAddEventListener:function(e){var t=e._getListenerID(),i=this._listenersMap[t];if(i||(i=new cc._EventListenerVector,this._listenersMap[t]=i),i.push(e),0==e._getFixedPriority()){this._setDirty(t,this.DIRTY_SCENE_GRAPH_PRIORITY);var n=e._getSceneGraphPriority();null==n&&cc.log(cc._LogInfos.eventManager__forceAddEventListener),this._associateNodeAndEventListener(n,e),n.isRunning()&&this.resumeTarget(n)}else this._setDirty(t,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(e){return this._listenersMap[e]},_updateDirtyFlagForSceneGraph:function(){if(0!=this._dirtyNodes.length){for(var e,t,i=this._dirtyNodes,n=this._nodeListenersMap,r=0,o=i.length;r<o;r++)if(e=n[i[r].__instanceId])for(var s=0,a=e.length;s<a;s++)(t=e[s])&&this._setDirty(t._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyNodes.length=0}},_removeAllListenersInVector:function(e){if(e)for(var t,i=0;i<e.length;)(t=e[i])._setRegistered(!1),null!=t._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(t._getSceneGraphPriority(),t),t._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(e,t):++i},_removeListenersForListenerID:function(e){var t,i=this._listenersMap[e];if(i){var n=i.getFixedPriorityListeners(),r=i.getSceneGraphPriorityListeners();this._removeAllListenersInVector(r),this._removeAllListenersInVector(n),delete this._priorityDirtyFlagMap[e],this._inDispatch||(i.clear(),delete this._listenersMap[e])}var o,s=this._toAddedListeners;for(t=0;t<s.length;)(o=s[t])&&o._getListenerID()==e?cc.arrayRemoveObject(s,o):++t},_sortEventListeners:function(e){var t=this.DIRTY_NONE,i=this._priorityDirtyFlagMap;if(i[e]&&(t=i[e]),t!=this.DIRTY_NONE&&(i[e]=this.DIRTY_NONE,t&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(e),t&this.DIRTY_SCENE_GRAPH_PRIORITY)){var n=cc.director.getRunningScene();n?this._sortListenersOfSceneGraphPriority(e,n):i[e]=this.DIRTY_SCENE_GRAPH_PRIORITY}},_sortListenersOfSceneGraphPriority:function(e,t){var i=this._getListeners(e);if(i){var n=i.getSceneGraphPriorityListeners();n&&0!==n.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(t,!0),i.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))}},_sortEventListenersOfSceneGraphPriorityDes:function(e,t){var i=cc.eventManager._nodePriorityMap;return e&&t&&e._getSceneGraphPriority()&&t._getSceneGraphPriority()?i[t._getSceneGraphPriority().__instanceId]-i[e._getSceneGraphPriority().__instanceId]:-1},_sortListenersOfFixedPriority:function(e){var t=this._listenersMap[e];if(t){var i=t.getFixedPriorityListeners();if(i&&0!==i.length){i.sort(this._sortListenersOfFixedPriorityAsc);for(var n=0,r=i.length;n<r&&!(i[n]._getFixedPriority()>=0);)++n;t.gt0Index=n}}},_sortListenersOfFixedPriorityAsc:function(e,t){return e._getFixedPriority()-t._getFixedPriority()},_onUpdateListeners:function(e){var t=this._listenersMap[e];if(t){var i,n,r=t.getFixedPriorityListeners(),o=t.getSceneGraphPriorityListeners();if(o)for(i=0;i<o.length;)(n=o[i])._isRegistered()?++i:cc.arrayRemoveObject(o,n);if(r)for(i=0;i<r.length;)(n=r[i])._isRegistered()?++i:cc.arrayRemoveObject(r,n);o&&0===o.length&&t.clearSceneGraphListeners(),r&&0===r.length&&t.clearFixedListeners()}},_updateListeners:function(e){var t=this._inDispatch;if(cc.assert(t>0,cc._LogInfos.EventManager__updateListeners),e.getType()==cc.Event.TOUCH?(this._onUpdateListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._onUpdateListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID)):this._onUpdateListeners(cc.__getListenerID(e)),!(t>1)){cc.assert(1==t,cc._LogInfos.EventManager__updateListeners_2);var i=this._listenersMap,n=this._priorityDirtyFlagMap;for(var r in i)i[r].empty()&&(delete n[r],delete i[r]);var o=this._toAddedListeners;if(0!==o.length){for(var s=0,a=o.length;s<a;s++)this._forceAddEventListener(o[s]);this._toAddedListeners.length=0}}},_onTouchEventCallback:function(e,t){if(!e._isRegistered)return!1;var i=t.event,n=t.selTouch;i._setCurrentTarget(e._node);var r,o=!1,s=i.getEventCode(),a=cc.EventTouch.EventCode;return s==a.BEGAN?e.onTouchBegan&&(o=e.onTouchBegan(n,i))&&e._registered&&e._claimedTouches.push(n):e._claimedTouches.length>0&&-1!=(r=e._claimedTouches.indexOf(n))&&(o=!0,s===a.MOVED&&e.onTouchMoved?e.onTouchMoved(n,i):s===a.ENDED?(e.onTouchEnded&&e.onTouchEnded(n,i),e._registered&&e._claimedTouches.splice(r,1)):s===a.CANCELLED&&(e.onTouchCancelled&&e.onTouchCancelled(n,i),e._registered&&e._claimedTouches.splice(r,1))),i.isStopped()?(cc.eventManager._updateListeners(i),!0):!!(o&&e._registered&&e.swallowTouches)&&(t.needsMutableSet&&t.touches.splice(n,1),!0)},_dispatchTouchEvent:function(e){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var t=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),i=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!=t||null!=i){var n=e.getTouches(),r=cc.copyArray(n),o={event:e,needsMutableSet:t&&i,touches:r,selTouch:null};if(t)for(var s=0;s<n.length;s++)if(o.selTouch=n[s],this._dispatchEventToListeners(t,this._onTouchEventCallback,o),e.isStopped())return;i&&r.length>0&&(this._dispatchEventToListeners(i,this._onTouchesEventCallback,{event:e,touches:r}),e.isStopped())||this._updateListeners(e)}},_onTouchesEventCallback:function(e,t){if(!e._registered)return!1;var i=cc.EventTouch.EventCode,n=t.event,r=t.touches,o=n.getEventCode();return n._setCurrentTarget(e._node),o==i.BEGAN&&e.onTouchesBegan?e.onTouchesBegan(r,n):o==i.MOVED&&e.onTouchesMoved?e.onTouchesMoved(r,n):o==i.ENDED&&e.onTouchesEnded?e.onTouchesEnded(r,n):o==i.CANCELLED&&e.onTouchesCancelled&&e.onTouchesCancelled(r,n),!!n.isStopped()&&(cc.eventManager._updateListeners(n),!0)},_associateNodeAndEventListener:function(e,t){var i=this._nodeListenersMap[e.__instanceId];i||(i=[],this._nodeListenersMap[e.__instanceId]=i),i.push(t)},_dissociateNodeAndEventListener:function(e,t){var i=this._nodeListenersMap[e.__instanceId];i&&(cc.arrayRemoveObject(i,t),0===i.length&&delete this._nodeListenersMap[e.__instanceId])},_dispatchEventToListeners:function(e,t,i){var n,r,o=!1,s=e.getFixedPriorityListeners(),a=e.getSceneGraphPriorityListeners(),c=0;if(s&&0!==s.length)for(;c<e.gt0Index;++c)if((r=s[c]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&t(r,i)){o=!0;break}if(a&&!o)for(n=0;n<a.length;n++)if((r=a[n]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&t(r,i)){o=!0;break}if(s&&!o)for(;c<s.length;++c)if((r=s[c]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&t(r,i)){o=!0;break}},_setDirty:function(e,t){var i=this._priorityDirtyFlagMap;null==i[e]?i[e]=t:i[e]=t|i[e]},_visitTarget:function(e,t){var i=e.getChildren(),n=0,r=i.length,o=this._globalZOrderNodeMap,s=this._nodeListenersMap;if(r>0){for(var a;n<r&&((a=i[n])&&a.getLocalZOrder()<0);n++)this._visitTarget(a,!1);for(null!=s[e.__instanceId]&&(o[e.getGlobalZOrder()]||(o[e.getGlobalZOrder()]=[]),o[e.getGlobalZOrder()].push(e.__instanceId));n<r;n++)(a=i[n])&&this._visitTarget(a,!1)}else null!=s[e.__instanceId]&&(o[e.getGlobalZOrder()]||(o[e.getGlobalZOrder()]=[]),o[e.getGlobalZOrder()].push(e.__instanceId));if(t){var c=[];for(var l in o)c.push(l);c.sort(this._sortNumberAsc);var u,h,d=c.length,p=this._nodePriorityMap;for(n=0;n<d;n++)for(u=o[c[n]],h=0;h<u.length;h++)p[u[h]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}}},_sortNumberAsc:function(e,t){return e-t},addListener:function(e,t){if(cc.assert(e&&t,cc._LogInfos.eventManager_addListener_2),e instanceof cc.EventListener){if(e._isRegistered())return void cc.log(cc._LogInfos.eventManager_addListener_4)}else cc.assert(!cc.isNumber(t),cc._LogInfos.eventManager_addListener_3),e=cc.EventListener.create(e);if(e.checkAvailable()){if(cc.isNumber(t)){if(0==t)return void cc.log(cc._LogInfos.eventManager_addListener);e._setSceneGraphPriority(null),e._setFixedPriority(t),e._setRegistered(!0),e._setPaused(!1),this._addListener(e)}else e._setSceneGraphPriority(t),e._setFixedPriority(0),e._setRegistered(!0),this._addListener(e);return e}},addCustomListener:function(e,t){var i=new cc._EventListenerCustom(e,t);return this.addListener(i,1),i},removeListener:function(e){if(null!=e){var t,i=this._listenersMap;for(var n in i){var r=i[n],o=r.getFixedPriorityListeners(),s=r.getSceneGraphPriorityListeners();if((t=this._removeListenerInVector(s,e))?this._setDirty(e._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(t=this._removeListenerInVector(o,e))&&this._setDirty(e._getListenerID(),this.DIRTY_FIXED_PRIORITY),r.empty()&&(delete this._priorityDirtyFlagMap[e._getListenerID()],delete i[n]),t)break}if(!t)for(var a=this._toAddedListeners,c=0,l=a.length;c<l;c++){var u=a[c];if(u==e){cc.arrayRemoveObject(a,u),u._setRegistered(!1);break}}}},_removeListenerInVector:function(e,t){if(null==e)return!1;for(var i=0,n=e.length;i<n;i++){var r=e[i];if(r==t)return r._setRegistered(!1),null!=r._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(r._getSceneGraphPriority(),r),r._setSceneGraphPriority(null)),0==this._inDispatch&&cc.arrayRemoveObject(e,r),!0}return!1},removeListeners:function(e,t){var i=this;if(e instanceof cc.Node){delete i._nodePriorityMap[e.__instanceId],cc.arrayRemoveObject(i._dirtyNodes,e);var n,r=i._nodeListenersMap[e.__instanceId];if(r){var o=cc.copyArray(r);for(n=0;n<o.length;n++)i.removeListener(o[n]);o.length=0}var s=i._toAddedListeners;for(n=0;n<s.length;){var a=s[n];a._getSceneGraphPriority()==e?(a._setSceneGraphPriority(null),a._setRegistered(!1),s.splice(n,1)):++n}if(!0===t){var c,l=e.getChildren();for(n=0,c=l.length;n<c;n++)i.removeListeners(l[n],!0)}}else e==cc.EventListener.TOUCH_ONE_BY_ONE?i._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):e==cc.EventListener.TOUCH_ALL_AT_ONCE?i._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):e==cc.EventListener.MOUSE?i._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):e==cc.EventListener.ACCELERATION?i._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):e==cc.EventListener.KEYBOARD?i._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):cc.log(cc._LogInfos.eventManager_removeListeners)},removeCustomListeners:function(e){this._removeListenersForListenerID(e)},removeAllListeners:function(){var e=this._listenersMap,t=this._internalCustomListenerIDs;for(var i in e)-1===t.indexOf(i)&&this._removeListenersForListenerID(i)},setPriority:function(e,t){if(null!=e){var i=this._listenersMap;for(var n in i){var r=i[n].getFixedPriorityListeners();if(r&&-1!=r.indexOf(e))return null!=e._getSceneGraphPriority()&&cc.log(cc._LogInfos.eventManager_setPriority),void(e._getFixedPriority()!==t&&(e._setFixedPriority(t),this._setDirty(e._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(e){this._isEnabled=e},isEnabled:function(){return this._isEnabled},dispatchEvent:function(e){if(this._isEnabled){if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,!e||!e.getType)throw"event is undefined";if(e.getType()==cc.Event.TOUCH)return this._dispatchTouchEvent(e),void this._inDispatch--;var t=cc.__getListenerID(e);this._sortEventListeners(t);var i=this._listenersMap[t];null!=i&&this._dispatchEventToListeners(i,this._onListenerCallback,e),this._updateListeners(e),this._inDispatch--}},_onListenerCallback:function(e,t){return t._setCurrentTarget(e._getSceneGraphPriority()),e._onEvent(t),t.isStopped()},dispatchCustomEvent:function(e,t){var i=new cc.EventCustom(e);i.setUserData(t),this.dispatchEvent(i)}},cc.EventHelper=function(){},cc.EventHelper.prototype={constructor:cc.EventHelper,apply:function(e){e.addEventListener=cc.EventHelper.prototype.addEventListener,e.hasEventListener=cc.EventHelper.prototype.hasEventListener,e.removeEventListener=cc.EventHelper.prototype.removeEventListener,e.dispatchEvent=cc.EventHelper.prototype.dispatchEvent},addEventListener:function(e,t,i){if("load"===e&&this._textureLoaded)setTimeout(function(){t.call(i)},0);else{void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),this.hasEventListener(e,t,i)||n[e].push({callback:t,eventTarget:i})}},hasEventListener:function(e,t,i){if(void 0===this._listeners)return!1;var n=this._listeners;if(void 0!==n[e])for(var r=0,o=n.length;r<o;r++){var s=n[r];if(s.callback==t&&s.eventTarget==i)return!0}return!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i)for(var n=0;n<i.length;)i[n].eventTarget==t?i.splice(n,1):n++}},dispatchEvent:function(e,t){if(void 0!==this._listeners){null==t&&(t=!0);var i=this._listeners[e];if(void 0!==i){for(var n=[],r=i.length,o=0;o<r;o++)n[o]=i[o];for(o=0;o<r;o++)n[o].callback.call(n[o].eventTarget,this);t&&(i.length=0)}}}},cc.EventAcceleration=cc.Event.extend({_acc:null,ctor:function(e){cc.Event.prototype.ctor.call(this,cc.Event.ACCELERATION),this._acc=e}}),cc.EventKeyboard=cc.Event.extend({_keyCode:0,_isPressed:!1,ctor:function(e,t){cc.Event.prototype.ctor.call(this,cc.Event.KEYBOARD),this._keyCode=e,this._isPressed=t}}),cc._EventListenerAcceleration=cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(e){this._onAccelerationEvent=e;var t=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,function(e){t._onAccelerationEvent(e._acc,e)})},checkAvailable:function(){return cc.assert(this._onAccelerationEvent,cc._LogInfos._EventListenerAcceleration_checkAvailable),!0},clone:function(){return new cc._EventListenerAcceleration(this._onAccelerationEvent)}}),cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration",cc._EventListenerAcceleration.create=function(e){return new cc._EventListenerAcceleration(e)},cc._EventListenerKeyboard=cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){var e=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,function(t){t._isPressed?e.onKeyPressed&&e.onKeyPressed(t._keyCode,t):e.onKeyReleased&&e.onKeyReleased(t._keyCode,t)})},clone:function(){var e=new cc._EventListenerKeyboard;return e.onKeyPressed=this.onKeyPressed,e.onKeyReleased=this.onKeyReleased,e},checkAvailable:function(){return null!=this.onKeyPressed||null!=this.onKeyReleased||(cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable),!1)}}),cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard",cc._EventListenerKeyboard.create=function(){return new cc._EventListenerKeyboard},cc._tmp.PrototypeCCNode=function(){var e=cc.Node.prototype;cc.defineGetterSetter(e,"x",e.getPositionX,e.setPositionX),cc.defineGetterSetter(e,"y",e.getPositionY,e.setPositionY),e.width,cc.defineGetterSetter(e,"width",e._getWidth,e._setWidth),e.height,cc.defineGetterSetter(e,"height",e._getHeight,e._setHeight),e.anchorX,cc.defineGetterSetter(e,"anchorX",e._getAnchorX,e._setAnchorX),e.anchorY,cc.defineGetterSetter(e,"anchorY",e._getAnchorY,e._setAnchorY),e.skewX,cc.defineGetterSetter(e,"skewX",e.getSkewX,e.setSkewX),e.skewY,cc.defineGetterSetter(e,"skewY",e.getSkewY,e.setSkewY),e.zIndex,cc.defineGetterSetter(e,"zIndex",e.getLocalZOrder,e.setLocalZOrder),e.vertexZ,cc.defineGetterSetter(e,"vertexZ",e.getVertexZ,e.setVertexZ),e.rotation,cc.defineGetterSetter(e,"rotation",e.getRotation,e.setRotation),e.rotationX,cc.defineGetterSetter(e,"rotationX",e.getRotationX,e.setRotationX),e.rotationY,cc.defineGetterSetter(e,"rotationY",e.getRotationY,e.setRotationY),e.scale,cc.defineGetterSetter(e,"scale",e.getScale,e.setScale),e.scaleX,cc.defineGetterSetter(e,"scaleX",e.getScaleX,e.setScaleX),e.scaleY,cc.defineGetterSetter(e,"scaleY",e.getScaleY,e.setScaleY),e.children,cc.defineGetterSetter(e,"children",e.getChildren),e.childrenCount,cc.defineGetterSetter(e,"childrenCount",e.getChildrenCount),e.parent,cc.defineGetterSetter(e,"parent",e.getParent,e.setParent),e.visible,cc.defineGetterSetter(e,"visible",e.isVisible,e.setVisible),e.running,cc.defineGetterSetter(e,"running",e.isRunning),e.ignoreAnchor,cc.defineGetterSetter(e,"ignoreAnchor",e.isIgnoreAnchorPointForPosition,e.ignoreAnchorPointForPosition),e.tag,e.userData,e.userObject,e.arrivalOrder,e.actionManager,cc.defineGetterSetter(e,"actionManager",e.getActionManager,e.setActionManager),e.scheduler,cc.defineGetterSetter(e,"scheduler",e.getScheduler,e.setScheduler),e.shaderProgram,cc.defineGetterSetter(e,"shaderProgram",e.getShaderProgram,e.setShaderProgram),e.opacity,cc.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity),e.opacityModifyRGB,cc.defineGetterSetter(e,"opacityModifyRGB",e.isOpacityModifyRGB),e.cascadeOpacity,cc.defineGetterSetter(e,"cascadeOpacity",e.isCascadeOpacityEnabled,e.setCascadeOpacityEnabled),e.color,cc.defineGetterSetter(e,"color",e.getColor,e.setColor),e.cascadeColor,cc.defineGetterSetter(e,"cascadeColor",e.isCascadeColorEnabled,e.setCascadeColorEnabled)},cc.rendererCanvas={childrenOrderDirty:!0,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,getRenderCmd:function(e){return e._createRenderCmd()},rendering:function(e){var t,i,n=this._renderCmds,r=cc.view.getScaleX(),o=cc.view.getScaleY(),s=e||cc._renderContext;for(s.computeRealOffsetY(),t=0,i=n.length;t<i;t++)n[t].rendering(s,r,o)},_renderingToCacheCanvas:function(e,t,i,n){e||cc.log("The context of RenderTexture is invalid."),i=cc.isUndefined(i)?1:i,n=cc.isUndefined(n)?1:n,t=t||this._currentID;var r,o,s=this._cacheToCanvasCmds[t];for(e.computeRealOffsetY(),r=0,o=s.length;r<o;r++)s[r].rendering(e,i,n);s.length=0;var a=this._cacheInstanceIds;delete this._cacheToCanvasCmds[t],cc.arrayRemoveObject(a,t),0===a.length?this._isCacheToCanvasOn=!1:this._currentID=a[a.length-1]},_turnToCacheMode:function(e){this._isCacheToCanvasOn=!0,e=e||0,this._cacheToCanvasCmds[e]=[],-1===this._cacheInstanceIds.indexOf(e)&&this._cacheInstanceIds.push(e),this._currentID=e},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var e=this._transformNodePool;e.sort(this._sortNodeByLevelAsc);for(var t=0,i=e.length;t<i;t++)0!==e[t]._dirtyFlag&&e[t].updateStatus();e.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(e,t){return e._curLevel-t._curLevel},pushDirtyNode:function(e){this._transformNodePool.push(e)},clearRenderCommands:function(){this._renderCmds.length=0},pushRenderCommand:function(e){if(e._needDraw)if(this._isCacheToCanvasOn){var t=this._currentID,i=this._cacheToCanvasCmds[t];-1===i.indexOf(e)&&i.push(e)}else-1===this._renderCmds.indexOf(e)&&this._renderCmds.push(e)}},cc._renderType===cc._RENDER_TYPE_CANVAS&&(cc.renderer=cc.rendererCanvas),function(){cc.CanvasContextWrapper=function(e){this._context=e,this._saveCount=0,this._currentAlpha=e.globalAlpha,this._currentCompositeOperation=e.globalCompositeOperation,this._currentFillStyle=e.fillStyle,this._currentStrokeStyle=e.strokeStyle,this._offsetX=0,this._offsetY=0,this._realOffsetY=this.height,this._armatureMode=0};var e=cc.CanvasContextWrapper.prototype;e.resetCache=function(){var e=this._context;this._currentAlpha=e.globalAlpha,this._currentCompositeOperation=e.globalCompositeOperation,this._currentFillStyle=e.fillStyle,this._currentStrokeStyle=e.strokeStyle,this._realOffsetY=this._context.canvas.height+this._offsetY},e.setOffset=function(e,t){this._offsetX=e,this._offsetY=t,this._realOffsetY=this._context.canvas.height+this._offsetY},e.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY},e.setViewScale=function(e,t){this._scaleX=e,this._scaleY=t},e.getContext=function(){return this._context},e.save=function(){this._context.save(),this._saveCount++},e.restore=function(){this._context.restore(),this._saveCount--},e.setGlobalAlpha=function(e){this._saveCount>0?this._context.globalAlpha=e:this._currentAlpha!==e&&(this._currentAlpha=e,this._context.globalAlpha=e)},e.setCompositeOperation=function(e){this._saveCount>0?this._context.globalCompositeOperation=e:this._currentCompositeOperation!==e&&(this._currentCompositeOperation=e,this._context.globalCompositeOperation=e)},e.setFillStyle=function(e){this._saveCount>0?this._context.fillStyle=e:this._currentFillStyle!==e&&(this._currentFillStyle=e,this._context.fillStyle=e)},e.setStrokeStyle=function(e){this._saveCount>0?this._context.strokeStyle=e:this._currentStrokeStyle!==e&&(this._currentStrokeStyle=e,this._context.strokeStyle=e)},e.setTransform=function(e,t,i){this._armatureMode>0?(this.restore(),this.save(),this._context.transform(e.a,e.c,e.b,e.d,e.tx*t,-e.ty*i)):this._context.setTransform(e.a,e.c,e.b,e.d,this._offsetX+e.tx*t,this._realOffsetY-e.ty*i)},e._switchToArmatureMode=function(e,t,i,n){e?(this._armatureMode++,this._context.setTransform(t.a,t.c,t.b,t.d,this._offsetX+t.tx*i,this._realOffsetY-t.ty*n),this.save()):(this._armatureMode--,this.restore())}}(),cc.rendererWebGL={childrenOrderDirty:!0,_transformNodePool:[],_renderCmds:[],_isCacheToBufferOn:!1,_cacheToBufferCmds:{},_cacheInstanceIds:[],_currentID:0,getRenderCmd:function(e){return e._createRenderCmd()},rendering:function(e){var t,i,n=this._renderCmds,r=e||cc._renderContext;for(t=0,i=n.length;t<i;t++)n[t].rendering(r)},_turnToCacheMode:function(e){this._isCacheToBufferOn=!0,e=e||0,this._cacheToBufferCmds[e]=[],this._cacheInstanceIds.push(e),this._currentID=e},_turnToNormalMode:function(){this._isCacheToBufferOn=!1},_renderingToBuffer:function(e){e=e||this._currentID;var t,i,n=this._cacheToBufferCmds[e],r=cc._renderContext,o=this._cacheInstanceIds;for(t=0,i=n.length;t<i;t++)n[t].rendering(r);n.length=0,delete this._cacheToBufferCmds[e],cc.arrayRemoveObject(o,e),0===o.length?this._isCacheToBufferOn=!1:this._currentID=o[o.length-1]},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var e=this._transformNodePool;e.sort(this._sortNodeByLevelAsc);for(var t=0,i=e.length;t<i;t++)e[t].updateStatus();e.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(e,t){return e._curLevel-t._curLevel},pushDirtyNode:function(e){this._transformNodePool.push(e)},clearRenderCommands:function(){this._renderCmds.length=0},pushRenderCommand:function(e){if(e._needDraw)if(this._isCacheToBufferOn){var t=this._currentID,i=this._cacheToBufferCmds[t];-1===i.indexOf(e)&&i.push(e)}else-1===this._renderCmds.indexOf(e)&&this._renderCmds.push(e)}},cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.renderer=cc.rendererWebGL),cc.NODE_TAG_INVALID=-1,cc.s_globalOrderOfArrival=1,cc.Node=cc.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_normalizedPosition:null,_usingNormalizedPosition:!1,_normalizedPositionDirty:!1,_skewX:0,_skewY:0,_children:null,_visible:!0,_anchorPoint:null,_contentSize:null,_running:!1,_parent:null,_ignoreAnchorPointForPosition:!1,tag:cc.NODE_TAG_INVALID,userData:null,userObject:null,_reorderChildDirty:!1,_shaderProgram:null,arrivalOrder:0,_actionManager:null,_scheduler:null,_eventDispatcher:null,_additionalTransformDirty:!1,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:!1,_className:"Node",_showNode:!1,_name:"",_realOpacity:255,_realColor:null,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_renderCmd:null,ctor:function(){this._initNode(),this._initRendererCmd()},_initNode:function(){var e=this;e._anchorPoint=cc.p(0,0),e._contentSize=cc.size(0,0),e._position=cc.p(0,0),e._normalizedPosition=cc.p(0,0),e._children=[];var t=cc.director;e._actionManager=t.getActionManager(),e._scheduler=t.getScheduler(),e._additionalTransform=cc.affineTransformMakeIdentity(),cc.ComponentContainer&&(e._componentContainer=new cc.ComponentContainer(e)),this._realOpacity=255,this._realColor=cc.color(255,255,255,255),this._cascadeColorEnabled=!1,this._cascadeOpacityEnabled=!1},init:function(){return!0},_arrayMakeObjectsPerformSelector:function(e,t){if(e&&0!==e.length){var i,n,r=e.length,o=cc.Node._stateCallbackType;switch(t){case o.onEnter:for(i=0;i<r;i++)(n=e[i])&&n.onEnter();break;case o.onExit:for(i=0;i<r;i++)(n=e[i])&&n.onExit();break;case o.onEnterTransitionDidFinish:for(i=0;i<r;i++)(n=e[i])&&n.onEnterTransitionDidFinish();break;case o.cleanup:for(i=0;i<r;i++)(n=e[i])&&n.cleanup();break;case o.updateTransform:for(i=0;i<r;i++)(n=e[i])&&n.updateTransform();break;case o.onExitTransitionDidStart:for(i=0;i<r;i++)(n=e[i])&&n.onExitTransitionDidStart();break;case o.sortAllChildren:for(i=0;i<r;i++)(n=e[i])&&n.sortAllChildren();break;default:cc.assert(0,cc._LogInfos.Node__arrayMakeObjectsPerformSelector)}}},attr:function(e){for(var t in e)this[t]=e[t]},getSkewX:function(){return this._skewX},setSkewX:function(e){this._skewX=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(e){this._skewY=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(e){this._localZOrder=e,this._parent&&this._parent.reorderChild(this,e),cc.eventManager._setDirtyForNode(this)},_setLocalZOrder:function(e){this._localZOrder=e},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){return cc.log(cc._LogInfos.Node_getZOrder),this.getLocalZOrder()},setZOrder:function(e){cc.log(cc._LogInfos.Node_setZOrder),this.setLocalZOrder(e)},setGlobalZOrder:function(e){this._globalZOrder!=e&&(this._globalZOrder=e,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(e){this._vertexZ=e},getRotation:function(){return this._rotationX!==this._rotationY&&cc.log(cc._LogInfos.Node_getRotation),this._rotationX},setRotation:function(e){this._rotationX=this._rotationY=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(e){this._rotationX=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(e){this._rotationY=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale),this._scaleX},setScale:function(e,t){this._scaleX=e,this._scaleY=t||0===t?t:e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(e){this._scaleX=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(e){this._scaleY=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setPosition:function(e,t){var i=this._position;if(void 0===t){if(i.x===e.x&&i.y===e.y)return;i.x=e.x,i.y=e.y}else{if(i.x===e.x&&i.y===t)return;i.x=e,i.y=t}this._usingNormalizedPosition=!1,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setNormalizedPosition:function(e,t){var i=this._normalizedPosition;void 0===t?(i.x=e.x,i.y=e.y):(i.x=e,i.y=t),this._normalizedPositionDirty=this._usingNormalizedPosition=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPosition:function(){return cc.p(this._position)},getNormalizedPosition:function(){return cc.p(this._normalizedPosition)},getPositionX:function(){return this._position.x},setPositionX:function(e){this._position.x=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(e){this._position.y=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(e){this._visible!==e&&(this._visible=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(e,t){var i=this._anchorPoint;if(void 0===t){if(e.x===i.x&&e.y===i.y)return;i.x=e.x,i.y=e.y}else{if(e===i.x&&t===i.y)return;i.x=e,i.y=t}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(e){this._anchorPoint.x!==e&&(this._anchorPoint.x=e,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(e){this._anchorPoint.y!==e&&(this._anchorPoint.y=e,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(e){this._contentSize.width=e,this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},_setHeight:function(e){this._contentSize.height=e,this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return cc.size(this._contentSize)},setContentSize:function(e,t){var i=this._contentSize;if(void 0===t){if(e.width===i.width&&e.height===i.height)return;i.width=e.width,i.height=e.height}else{if(e===i.width&&t===i.height)return;i.width=e,i.height=t}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(e){this._parent=e},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},ignoreAnchorPointForPosition:function(e){e!=this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(e){this.tag=e},setName:function(e){this._name=e},getName:function(){return this._name},getUserData:function(){return this.userData},setUserData:function(e){this.userData=e},getUserObject:function(){return this.userObject},setUserObject:function(e){this.userObject!=e&&(this.userObject=e)},getOrderOfArrival:function(){return this.arrivalOrder},setOrderOfArrival:function(e){this.arrivalOrder=e},getActionManager:function(){return this._actionManager||(this._actionManager=cc.director.getActionManager()),this._actionManager},setActionManager:function(e){this._actionManager!=e&&(this.stopAllActions(),this._actionManager=e)},getScheduler:function(){return this._scheduler||(this._scheduler=cc.director.getScheduler()),this._scheduler},setScheduler:function(e){this._scheduler!=e&&(this.unscheduleAllCallbacks(),this._scheduler=e)},boundingBox:function(){return cc.log(cc._LogInfos.Node_boundingBox),this.getBoundingBox()},getBoundingBox:function(){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(e,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),cc.eventManager.removeListeners(this),this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.cleanup)},getChildByTag:function(e){var t=this._children;if(null!=t)for(var i=0;i<t.length;i++){var n=t[i];if(n&&n.tag==e)return n}return null},getChildByName:function(e){if(!e)return cc.log("Invalid name"),null;for(var t=this._children,i=0,n=t.length;i<n;i++)if(t[i]._name==e)return t[i];return null},addChild:function(e,t,i){t=void 0===t?e._localZOrder:t;var n,r=!1;cc.isUndefined(i)?(i=void 0,n=e._name):cc.isString(i)?(n=i,i=void 0):cc.isNumber(i)&&(r=!0,n=""),cc.assert(e,cc._LogInfos.Node_addChild_3),cc.assert(null===e._parent,"child already added. It can't be added again"),this._addChildHelper(e,t,i,n,r)},_addChildHelper:function(e,t,i,n,r){this._children||(this._children=[]),this._insertChild(e,t),r?e.setTag(i):e.setName(n),e.setParent(this),e.setOrderOfArrival(cc.s_globalOrderOfArrival++),this._running&&(e.onEnter(),this._isTransitionFinished&&e.onEnterTransitionDidFinish()),this._cascadeColorEnabled&&e._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),this._cascadeOpacityEnabled&&e._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},removeFromParent:function(e){this._parent&&(null==e&&(e=!0),this._parent.removeChild(this,e))},removeFromParentAndCleanup:function(e){cc.log(cc._LogInfos.Node_removeFromParentAndCleanup),this.removeFromParent(e)},removeChild:function(e,t){0!==this._children.length&&(null==t&&(t=!0),this._children.indexOf(e)>-1&&this._detachChild(e,t),cc.renderer.childrenOrderDirty=!0)},removeChildByTag:function(e,t){e===cc.NODE_TAG_INVALID&&cc.log(cc._LogInfos.Node_removeChildByTag);var i=this.getChildByTag(e);null==i?cc.log(cc._LogInfos.Node_removeChildByTag_2,e):this.removeChild(i,t)},removeAllChildrenWithCleanup:function(e){this.removeAllChildren(e)},removeAllChildren:function(e){var t=this._children;if(null!=t){null==e&&(e=!0);for(var i=0;i<t.length;i++){var n=t[i];n&&(this._running&&(n.onExitTransitionDidStart(),n.onExit()),e&&n.cleanup(),n.parent=null)}this._children.length=0}},_detachChild:function(e,t){this._running&&(e.onExitTransitionDidStart(),e.onExit()),t&&e.cleanup(),e.parent=null,e._renderCmd.detachFromParent(),cc.arrayRemoveObject(this._children,e)},_insertChild:function(e,t){cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,this._children.push(e),e._setLocalZOrder(t)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},reorderChild:function(e,t){cc.assert(e,cc._LogInfos.Node_reorderChild),cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,e.arrivalOrder=cc.s_globalOrderOfArrival,cc.s_globalOrderOfArrival++,e._setLocalZOrder(t)},sortAllChildren:function(){if(this._reorderChildDirty){var e,t,i,n=this._children,r=n.length;for(e=1;e<r;e++){for(i=n[e],t=e-1;t>=0;){if(i._localZOrder<n[t]._localZOrder)n[t+1]=n[t];else{if(!(i._localZOrder===n[t]._localZOrder&&i.arrivalOrder<n[t].arrivalOrder))break;n[t+1]=n[t]}t--}n[t+1]=i}this._reorderChildDirty=!1}},draw:function(e){},transformAncestors:function(){null!=this._parent&&(this._parent.transformAncestors(),this._parent.transform())},onEnter:function(){this._isTransitionFinished=!1,this._running=!0,this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnter),this.resume()},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0,this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExitTransitionDidStart)},onExit:function(){this._running=!1,this.pause(),this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExit),this.removeAllComponents()},runAction:function(e){return cc.assert(e,cc._LogInfos.Node_runAction),this.actionManager.addAction(e,this,!this._running),e},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(e){this.actionManager.removeAction(e)},stopActionByTag:function(e){e!==cc.ACTION_TAG_INVALID?this.actionManager.removeActionByTag(e,this):cc.log(cc._LogInfos.Node_stopActionByTag)},getActionByTag:function(e){return e===cc.ACTION_TAG_INVALID?(cc.log(cc._LogInfos.Node_getActionByTag),null):this.actionManager.getActionByTag(e,this)},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this)},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(e){this.scheduler.scheduleUpdateForTarget(this,e,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdateForTarget(this)},schedule:function(e,t,i,n){t=t||0,cc.assert(e,cc._LogInfos.Node_schedule),cc.assert(t>=0,cc._LogInfos.Node_schedule_2),i=null==i?cc.REPEAT_FOREVER:i,n=n||0,this.scheduler.scheduleCallbackForTarget(this,e,t,i,n,!this._running)},scheduleOnce:function(e,t){this.schedule(e,0,0,t)},unschedule:function(e){e&&this.scheduler.unscheduleCallbackForTarget(this,e)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllCallbacksForTarget(this)},resumeSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_resumeSchedulerAndActions),this.resume()},resume:function(){this.scheduler.resumeTarget(this),this.actionManager&&this.actionManager.resumeTarget(this),cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_pauseSchedulerAndActions),this.pause()},pause:function(){this.scheduler.pauseTarget(this),this.actionManager&&this.actionManager.pauseTarget(this),cc.eventManager.pauseTarget(this)},setAdditionalTransform:function(e){this._additionalTransform=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._additionalTransformDirty=!0},getParentToNodeTransform:function(){this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var e=this.getNodeToParentTransform(),t=this._parent;null!=t;t=t.parent)e=cc.affineTransformConcat(e,t.getNodeToParentTransform());return e},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(e){return cc.pointApplyAffineTransform(e,this.getWorldToNodeTransform())},convertToWorldSpace:function(e){return e=e||cc.p(0,0),cc.pointApplyAffineTransform(e,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(e){return cc.pSub(this.convertToNodeSpace(e),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(e){e=e||cc.p(0,0);var t=cc.pAdd(e,this._renderCmd.getAnchorPointInPoints());return this.convertToWorldSpace(t)},_convertToWindowSpace:function(e){var t=this.convertToWorldSpace(e);return cc.director.convertToUI(t)},convertTouchToNodeSpace:function(e){var t=e.getLocation();return this.convertToNodeSpace(t)},convertTouchToNodeSpaceAR:function(e){var t=cc.director.convertToGL(e.getLocation());return this.convertToNodeSpaceAR(t)},update:function(e){this._componentContainer&&!this._componentContainer.isEmpty()&&this._componentContainer.visit(e)},updateTransform:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.updateTransform)},retain:function(){},release:function(){},getComponent:function(e){return this._componentContainer?this._componentContainer.getComponent(e):null},addComponent:function(e){this._componentContainer&&this._componentContainer.add(e)},removeComponent:function(e){return!!this._componentContainer&&this._componentContainer.remove(e)},removeAllComponents:function(){this._componentContainer&&this._componentContainer.removeAll()},grid:null,visit:function(e){this._renderCmd.visit(e)},transform:function(e,t){this._renderCmd.transform(e,t)},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform()},getCamera:function(){return this._camera||(this._camera=new cc.Camera),this._camera},getGrid:function(){return this.grid},setGrid:function(e){this.grid=e},getShaderProgram:function(){return this._renderCmd.getShaderProgram()},setShaderProgram:function(e){this._renderCmd.setShaderProgram(e)},getGLServerState:function(){return 0},setGLServerState:function(e){},getBoundingBoxToWorld:function(){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height),t=this.getNodeToWorldTransform();if(e=cc.rectApplyAffineTransform(e,t),!this._children)return e;for(var i=this._children,n=0;n<i.length;n++){var r=i[n];if(r&&r._visible){var o=r._getBoundingBoxToCurrentNode(t);o&&(e=cc.rectUnion(e,o))}}return e},_getBoundingBoxToCurrentNode:function(e){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height),i=null==e?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),e);if(t=cc.rectApplyAffineTransform(t,i),!this._children)return t;for(var n=this._children,r=0;r<n.length;r++){var o=n[r];if(o&&o._visible){var s=o._getBoundingBoxToCurrentNode(i);s&&(t=cc.rectUnion(t,s))}}return t},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity()},setOpacity:function(e){this._realOpacity=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},updateDisplayedOpacity:function(e){this._renderCmd._updateDisplayOpacity(e)},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(e){this._cascadeOpacityEnabled!==e&&(this._cascadeOpacityEnabled=e,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var e=this._realColor;return cc.color(e.r,e.g,e.b,e.a)},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor()},setColor:function(e){var t=this._realColor;t.r=e.r,t.g=e.g,t.b=e.b,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},updateDisplayedColor:function(e){this._renderCmd._updateDisplayColor(e)},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(e){this._cascadeColorEnabled!==e&&(this._cascadeColorEnabled=e,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},_initRendererCmd:function(){this._renderCmd=cc.renderer.getRenderCmd(this)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Node.CanvasRenderCmd(this):new cc.Node.WebGLRenderCmd(this)}}),cc.Node.create=function(){return new cc.Node},cc.Node._stateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,updateTransform:5,onExitTransitionDidStart:6,sortAllChildren:7},cc.assert(cc.isFunction(cc._tmp.PrototypeCCNode),cc._LogInfos.MissingFile,"BaseNodesPropertyDefine.js"),cc._tmp.PrototypeCCNode(),delete cc._tmp.PrototypeCCNode,cc.CustomRenderCmd=function(e,t){this._needDraw=!0,this._target=e,this._callback=t,this.rendering=function(e,t,i){this._callback&&this._callback.call(this._target,e,t,i)}},cc.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,all:255},cc.Node.RenderCmd=function(e){this._dirtyFlag=1,this._node=e,this._needDraw=!1,this._anchorPointInPoints=new cc.Point(0,0),this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0},this._displayedOpacity=255,this._displayedColor=cc.color(255,255,255,255),this._cascadeColorEnabledDirty=!1,this._cascadeOpacityEnabledDirty=!1,this._curLevel=-1},cc.Node.RenderCmd.prototype={constructor:cc.Node.RenderCmd,getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints)},getDisplayedColor:function(){var e=this._displayedColor;return cc.color(e.r,e.g,e.b,e.a)},getDisplayedOpacity:function(){return this._displayedOpacity},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=!0,this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0,this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getParentToNodeTransform:function(){return this._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&(this._inverse=cc.affineTransformInvert(this.getNodeToParentTransform())),this._inverse},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var e=this._anchorPointInPoints,t=this._node._contentSize,i=this._node._anchorPoint;e.x=t.width*i.x,e.y=t.height*i.y,this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setDirtyFlag:function(e){0===this._dirtyFlag&&0!==e&&cc.renderer.pushDirtyNode(this),this._dirtyFlag|=e},getParentRenderCmd:function(){return this._node&&this._node._parent&&this._node._parent._renderCmd?this._node._parent._renderCmd:null},_updateDisplayColor:function(e){var t,i,n,r,o=this._node,s=this._displayedColor,a=o._realColor;if(this._cascadeColorEnabledDirty&&!o._cascadeColorEnabled){s.r=a.r,s.g=a.g,s.b=a.b;var c=new cc.Color(255,255,255,255);for(t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&r._renderCmd._updateDisplayColor(c);this._cascadeColorEnabledDirty=!1}else{if(void 0===e){var l=o._parent;e=l&&l._cascadeColorEnabled?l.getDisplayedColor():cc.color.WHITE}if(s.r=0|a.r*e.r/255,s.g=0|a.g*e.g/255,s.b=0|a.b*e.b/255,o._cascadeColorEnabled)for(t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&(r._renderCmd._updateDisplayColor(s),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty^this._dirtyFlag},_updateDisplayOpacity:function(e){var t,i,n,r,o=this._node;if(this._cascadeOpacityEnabledDirty&&!o._cascadeOpacityEnabled){for(this._displayedOpacity=o._realOpacity,t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&r._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(void 0===e){var s=o._parent;e=255,s&&s._cascadeOpacityEnabled&&(e=s.getDisplayedOpacity())}if(this._displayedOpacity=o._realOpacity*e/255,o._cascadeOpacityEnabled)for(t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&(r._renderCmd._updateDisplayOpacity(this._displayedOpacity),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty^this._dirtyFlag},_syncDisplayColor:function(e){var t=this._node,i=this._displayedColor,n=t._realColor;if(void 0===e){var r=t._parent;e=r&&r._cascadeColorEnabled?r.getDisplayedColor():cc.color.WHITE}i.r=0|n.r*e.r/255,i.g=0|n.g*e.g/255,i.b=0|n.b*e.b/255},_syncDisplayOpacity:function(e){var t=this._node;if(void 0===e){var i=t._parent;e=255,i&&i._cascadeOpacityEnabled&&(e=i.getDisplayedOpacity())}this._displayedOpacity=t._realOpacity*e/255},_updateColor:function(){},updateStatus:function(){var e=cc.Node._dirtyFlags,t=this._dirtyFlag,i=t&e.colorDirty,n=t&e.opacityDirty;i&&this._updateDisplayColor(),n&&this._updateDisplayOpacity(),(i||n)&&this._updateColor(),t&e.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag)}},function(){cc.Node.CanvasRenderCmd=function(e){cc.Node.RenderCmd.call(this,e),this._cachedParent=null,this._cacheDirty=!1};var e=cc.Node.CanvasRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);e.constructor=cc.Node.CanvasRenderCmd,e.transform=function(e,t){var i=this.getNodeToParentTransform(),n=this._worldTransform;if(e){var r=e._worldTransform;n.a=i.a*r.a+i.b*r.c,n.b=i.a*r.b+i.b*r.d,n.c=i.c*r.a+i.d*r.c,n.d=i.c*r.b+i.d*r.d;var o=e._transform,s=-(o.b+o.c)*i.ty,a=-(o.b+o.c)*i.tx;n.tx=i.tx*r.a+i.ty*r.c+r.tx+s,n.ty=i.tx*r.b+i.ty*r.d+r.ty+a}else n.a=i.a,n.b=i.b,n.c=i.c,n.d=i.d,n.tx=i.tx,n.ty=i.ty;if(t){var c=this._node._children;if(!c||0===c.length)return;var l,u;for(l=0,u=c.length;l<u;l++)c[l]._renderCmd.transform(this,t)}},e.getNodeToParentTransform=function(){var e=this._node,t=!1;if(e._usingNormalizedPosition&&e._parent){var i=e._parent._contentSize;e._position.x=e._normalizedPosition.x*i.width,e._position.y=e._normalizedPosition.y*i.height,e._normalizedPositionDirty=!1,t=!0}if(t||this._dirtyFlag&cc.Node._dirtyFlags.transformDirty){var n=this._transform;n.tx=e._position.x,n.ty=e._position.y;var r=1,o=0;if(e._rotationX){var s=.017453292519943295*e._rotationX;r=Math.cos(s),o=Math.sin(s)}n.a=n.d=r,n.b=-o,n.c=o;var a=e._scaleX,c=e._scaleY,l=this._anchorPointInPoints.x,u=this._anchorPointInPoints.y,h=a<1e-6&&a>-1e-6?1e-6:a,d=c<1e-6&&c>-1e-6?1e-6:c;if(e._skewX||e._skewY){var p=Math.tan(-e._skewX*Math.PI/180),_=Math.tan(-e._skewY*Math.PI/180);p===1/0&&(p=99999999),_===1/0&&(_=99999999);var f=u*p*h,m=l*_*d;n.a=r+-o*_,n.b=r*p-o,n.c=o+r*_,n.d=o*p+r,n.tx+=r*f+-o*m,n.ty+=o*f+r*m}1===a&&1===c||(n.a*=h,n.c*=h,n.b*=d,n.d*=d),n.tx+=r*-l*h+-o*u*d,n.ty-=o*-l*h+r*u*d,e._ignoreAnchorPointForPosition&&(n.tx+=l,n.ty+=u),e._additionalTransformDirty&&(this._transform=cc.affineTransformConcat(n,e._additionalTransform),e._additionalTransformDirty=!1)}return this._transform},e.visit=function(e){var t=this._node;if(t._visible){(e=e||this.getParentRenderCmd())&&(this._curLevel=e._curLevel+1);var i,n,r=t._children;this._syncStatus(e);var o=r.length;if(o>0){for(t.sortAllChildren(),i=0;i<o&&(n=r[i])._localZOrder<0;i++)n._renderCmd.visit(this);for(cc.renderer.pushRenderCommand(this);i<o;i++)r[i]._renderCmd.visit(this)}else cc.renderer.pushRenderCommand(this);this._dirtyFlag=0}},e._syncStatus=function(e){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e?e._node:null;n&&n._cascadeColorEnabled&&e._dirtyFlag&t.colorDirty&&(i|=t.colorDirty),n&&n._cascadeOpacityEnabled&&e._dirtyFlag&t.opacityDirty&&(i|=t.opacityDirty),e&&e._dirtyFlag&t.transformDirty&&(i|=t.transformDirty);var r=i&t.colorDirty,o=i&t.opacityDirty,s=i&t.transformDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),r&&this._updateColor(),s&&this.transform(e)},e.setDirtyFlag=function(e){cc.Node.RenderCmd.prototype.setDirtyFlag.call(this,e),this._setCacheDirty(),this._cachedParent&&this._cachedParent.setDirtyFlag(e)},e._setCacheDirty=function(){if(!1===this._cacheDirty){this._cacheDirty=!0;var e=this._cachedParent;e&&e!=this&&e._setNodeDirtyForCache&&e._setNodeDirtyForCache()}},e._setCachedParent=function(e){if(this._cachedParent!=e){this._cachedParent=e;for(var t=this._node._children,i=0,n=t.length;i<n;i++)t[i]._renderCmd._setCachedParent(e)}},e.detachFromParent=function(){this._cachedParent=null;for(var e,t=this._node._children,i=0,n=t.length;i<n;i++)(e=t[i])&&e._renderCmd&&e._renderCmd.detachFromParent()},e.setShaderProgram=function(e){},e.getShaderProgram=function(){return null},cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(e){return e?e.src==cc.SRC_ALPHA&&e.dst==cc.ONE||e.src==cc.ONE&&e.dst==cc.ONE?"lighter":e.src==cc.ZERO&&e.dst==cc.SRC_ALPHA?"destination-in":e.src==cc.ZERO&&e.dst==cc.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}}(),function(){cc.Node.WebGLRenderCmd=function(e){cc.Node.RenderCmd.call(this,e);var t=new cc.kmMat4;t.mat[2]=t.mat[3]=t.mat[6]=t.mat[7]=t.mat[8]=t.mat[9]=t.mat[11]=t.mat[14]=0,t.mat[10]=t.mat[15]=1,this._transform4x4=t,this._stackMatrix=new cc.kmMat4,this._shaderProgram=null,this._camera=null};var e=cc.Node.WebGLRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);e.constructor=cc.Node.WebGLRenderCmd,e.getNodeToParentTransform=function(){var e=this._node;if(e._usingNormalizedPosition&&e._parent){var t=e._parent._contentSize;e._position.x=e._normalizedPosition.x*t.width,e._position.y=e._normalizedPosition.y*t.height,e._normalizedPositionDirty=!1}if(this._dirtyFlag&cc.Node._dirtyFlags.transformDirty){var i=e._position.x,n=e._position.y,r=this._anchorPointInPoints.x,o=-r,s=this._anchorPointInPoints.y,a=-s,c=e._scaleX,l=e._scaleY,u=.017453292519943295*e._rotationX,h=.017453292519943295*e._rotationY;e._ignoreAnchorPointForPosition&&(i+=r,n+=s);var d=1,p=0,_=1,f=0;0===e._rotationX&&0===e._rotationY||(d=Math.cos(-u),p=Math.sin(-u),_=Math.cos(-h),f=Math.sin(-h));var m=e._skewX||e._skewY;m||0===r&&0===s||(i+=_*o*c+-p*a*l,n+=f*o*c+d*a*l);var g=this._transform;g.a=_*c,g.b=f*c,g.c=-p*l,g.d=d*l,g.tx=i,g.ty=n,m&&(g=cc.affineTransformConcat({a:1,b:Math.tan(cc.degreesToRadians(e._skewY)),c:Math.tan(cc.degreesToRadians(e._skewX)),d:1,tx:0,ty:0},g),0===r&&0===s||(g=cc.affineTransformTranslate(g,o,a))),e._additionalTransformDirty&&(g=cc.affineTransformConcat(g,e._additionalTransform),e._additionalTransformDirty=!1),this._transform=g}return this._transform},e._syncStatus=function(e){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e?e._node:null;n&&n._cascadeColorEnabled&&e._dirtyFlag&t.colorDirty&&(i|=t.colorDirty),n&&n._cascadeOpacityEnabled&&e._dirtyFlag&t.opacityDirty&&(i|=t.opacityDirty),e&&e._dirtyFlag&t.transformDirty&&(i|=t.transformDirty);var r=i&t.colorDirty,o=i&t.opacityDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),(r||o)&&this._updateColor(),this.transform(e)},e._updateColor=function(){},e.visit=function(e){var t=this._node;if(t._visible){e=e||this.getParentRenderCmd(),t._parent&&t._parent._renderCmd&&(this._curLevel=t._parent._renderCmd._curLevel+1);var i,n=cc.current_stack;n.stack.push(n.top),this._syncStatus(e),n.top=this._stackMatrix;var r=t._children;if(r&&r.length>0){var o=r.length;for(t.sortAllChildren(),i=0;i<o&&(r[i]&&r[i]._localZOrder<0);i++)r[i]._renderCmd.visit(this);for(cc.renderer.pushRenderCommand(this);i<o;i++)r[i]&&r[i]._renderCmd.visit(this)}else cc.renderer.pushRenderCommand(this);this._dirtyFlag=0,n.top=n.stack.pop()}},e.transform=function(e,t){var i=this._transform4x4,n=this._stackMatrix,r=this._node,o=(e=e||this.getParentRenderCmd())?e._stackMatrix:cc.current_stack.top,s=this.getNodeToParentTransform();this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag;var a=i.mat;if(a[0]=s.a,a[4]=s.c,a[12]=s.tx,a[1]=s.b,a[5]=s.d,a[13]=s.ty,a[14]=r._vertexZ,cc.kmMat4Multiply(n,o,i),null!=r._camera&&(null==r.grid||!r.grid.isActive())){var c=this._anchorPointInPoints.x,l=this._anchorPointInPoints.y;if(0!==c||0!==l){cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(c|=0,l|=0);var u=new cc.kmMat4;cc.kmMat4Translation(u,c,l,0),cc.kmMat4Multiply(n,n,u),r._camera._locateForRenderer(n),cc.kmMat4Translation(u,-c,-l,0),cc.kmMat4Multiply(n,n,u)}else r._camera._locateForRenderer(n)}if(t&&r._children&&0!==r._children.length){var h,d,p=r._children;for(h=0,d=p.length;h<d;h++)p[h]._renderCmd.transform(this,t)}},e.setShaderProgram=function(e){this._shaderProgram=e},e.getShaderProgram=function(){return this._shaderProgram}}(),cc.ProtectedNode=cc.Node.extend({_protectedChildren:null,_reorderProtectedChildDirty:!1,_insertProtectedChild:function(e,t){this._reorderProtectedChildDirty=!0,this._protectedChildren.push(e),e._setLocalZOrder(t)},ctor:function(){cc.Node.prototype.ctor.call(this),this._protectedChildren=[]},addProtectedChild:function(e,t,i){cc.assert(null!=e,"child must be non-nil"),cc.assert(!e.parent,"child already added. It can't be added again"),t=t||e.getLocalZOrder(),i&&e.setTag(i),this._insertProtectedChild(e,t),e.setParent(this),e.setOrderOfArrival(cc.s_globalOrderOfArrival),this._running&&(e.onEnter(),this._isTransitionFinished&&e.onEnterTransitionDidFinish()),this._cascadeColorEnabled&&this._renderCmd.setCascadeColorEnabledDirty(),this._cascadeOpacityEnabled&&this._renderCmd.setCascadeOpacityEnabledDirty()},getProtectedChildByTag:function(e){cc.assert(e!=cc.NODE_TAG_INVALID,"Invalid tag");for(var t=this._protectedChildren,i=0,n=t.length;i<n;i++)if(t.getTag()==e)return t[i];return null},removeProtectedChild:function(e,t){null==t&&(t=!0);var i=this._protectedChildren;if(0!==i.length){var n=i.indexOf(e);n>-1&&(this._running&&(e.onExitTransitionDidStart(),e.onExit()),t&&e.cleanup(),e.setParent(null),i.splice(n,1))}},removeProtectedChildByTag:function(e,t){cc.assert(e!=cc.NODE_TAG_INVALID,"Invalid tag"),null==t&&(t=!0);var i=this.getProtectedChildByTag(e);null==i?cc.log("cocos2d: removeChildByTag(tag = %d): child not found!",e):this.removeProtectedChild(i,t)},removeAllProtectedChildren:function(){this.removeAllProtectedChildrenWithCleanup(!0)},removeAllProtectedChildrenWithCleanup:function(e){null==e&&(e=!0);for(var t=this._protectedChildren,i=0,n=t.length;i<n;i++){var r=t[i];this._running&&(r.onExitTransitionDidStart(),r.onExit()),e&&r.cleanup(),r.setParent(null)}t.length=0},reorderProtectedChild:function(e,t){cc.assert(null!=e,"Child must be non-nil"),this._reorderProtectedChildDirty=!0,e.setOrderOfArrival(cc.s_globalOrderOfArrival++),e._setLocalZOrder(t)},sortAllProtectedChildren:function(){if(this._reorderProtectedChildDirty){var e,t,i,n=this._protectedChildren,r=n.length;for(e=1;e<r;e++){for(i=n[e],t=e-1;t>=0;){if(i._localZOrder<n[t]._localZOrder)n[t+1]=n[t];else{if(!(i._localZOrder===n[t]._localZOrder&&i.arrivalOrder<n[t].arrivalOrder))break;n[t+1]=n[t]}t--}n[t+1]=i}this._reorderProtectedChildDirty=!1}},_changePosition:function(){},cleanup:function(){cc.Node.prototype.cleanup.call(this);for(var e=this._protectedChildren,t=0,i=e.length;t<i;t++)e[t].cleanup()},onEnter:function(){cc.Node.prototype.onEnter.call(this);for(var e=this._protectedChildren,t=0,i=e.length;t<i;t++)e[t].onEnter()},onEnterTransitionDidFinish:function(){cc.Node.prototype.onEnterTransitionDidFinish.call(this);for(var e=this._protectedChildren,t=0,i=e.length;t<i;t++)e[t].onEnterTransitionDidFinish()},onExit:function(){cc.Node.prototype.onExit.call(this);for(var e=this._protectedChildren,t=0,i=e.length;t<i;t++)e[t].onExit()},onExitTransitionDidStart:function(){cc.Node.prototype.onExitTransitionDidStart.call(this);for(var e=this._protectedChildren,t=0,i=e.length;t<i;t++)e[t].onExitTransitionDidStart()},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.ProtectedNode.CanvasRenderCmd(this):new cc.ProtectedNode.WebGLRenderCmd(this)}}),cc.ProtectedNode.create=function(){return new cc.ProtectedNode},function(){cc.ProtectedNode.RenderCmd={_updateDisplayColor:function(e){var t,i,n,r,o=this._node,s=this._displayedColor,a=o._realColor;if(this._cascadeColorEnabledDirty&&!o._cascadeColorEnabled){s.r=a.r,s.g=a.g,s.b=a.b;var c=new cc.Color(255,255,255,255);for(t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&r._renderCmd._updateDisplayColor(c);this._cascadeColorEnabledDirty=!1}else{if(void 0===e){var l=o._parent;e=l&&l._cascadeColorEnabled?l.getDisplayedColor():cc.color.WHITE}if(s.r=0|a.r*e.r/255,s.g=0|a.g*e.g/255,s.b=0|a.b*e.b/255,o._cascadeColorEnabled)for(t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&(r._renderCmd._updateDisplayColor(s),r._renderCmd._updateColor());for(t=0,i=(n=o._protectedChildren).length;t<i;t++)(r=n[t])&&r._renderCmd&&(r._renderCmd._updateDisplayColor(s),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty^this._dirtyFlag},_updateDisplayOpacity:function(e){var t,i,n,r,o=this._node;if(this._cascadeOpacityEnabledDirty&&!o._cascadeOpacityEnabled){for(this._displayedOpacity=o._realOpacity,t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&r._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(void 0===e){var s=o._parent;e=255,s&&s._cascadeOpacityEnabled&&(e=s.getDisplayedOpacity())}if(this._displayedOpacity=o._realOpacity*e/255,o._cascadeOpacityEnabled)for(t=0,i=(n=o._children).length;t<i;t++)(r=n[t])&&r._renderCmd&&(r._renderCmd._updateDisplayOpacity(this._displayedOpacity),r._renderCmd._updateColor());for(t=0,i=(n=o._protectedChildren).length;t<i;t++)(r=n[t])&&r._renderCmd&&(r._renderCmd._updateDisplayOpacity(this._displayedOpacity),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty^this._dirtyFlag},_changeProtectedChild:function(e){var t=e._renderCmd,i=t._dirtyFlag,n=cc.Node._dirtyFlags;this._dirtyFlag&n.colorDirty&&(i|=n.colorDirty),this._dirtyFlag&n.opacityDirty&&(i|=n.opacityDirty);var r=i&n.colorDirty,o=i&n.opacityDirty;r&&t._updateDisplayColor(this._displayedColor),o&&t._updateDisplayOpacity(this._displayedOpacity),(r||o)&&t._updateColor()}},cc.ProtectedNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._cachedParent=null,this._cacheDirty=!1};var e=cc.ProtectedNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(cc.ProtectedNode.RenderCmd,e),e.constructor=cc.ProtectedNode.CanvasRenderCmd,e.visit=function(e){var t=this._node;if(t._visible){var i,n,r,o=t._children,s=t._children,a=t._protectedChildren,c=s.length,l=a.length;this._syncStatus(e),t.sortAllChildren(),t.sortAllProtectedChildren();var u;for(i=0;i<c&&(r=o[i])._localZOrder<0;i++)r.visit(this);for(n=0;n<l&&((u=a[n])&&u._localZOrder<0);n++)this._changeProtectedChild(u),u.visit(this);for(cc.renderer.pushRenderCommand(this);i<c;i++)o[i]&&o[i].visit(this);for(;n<l;n++)(u=a[n])&&(this._changeProtectedChild(u),u.visit(this));this._dirtyFlag=0,this._cacheDirty=!1}},e.transform=function(e,t){var i=this._node;i._changePosition&&i._changePosition();var n=i.getNodeToParentTransform(),r=this._worldTransform;if(e){var o=e._worldTransform;if(r.a=n.a*o.a+n.b*o.c,r.b=n.a*o.b+n.b*o.d,r.c=n.c*o.a+n.d*o.c,r.d=n.c*o.b+n.d*o.d,i._skewX||i._skewY){var s=e._transform,a=-(s.b+s.c)*n.ty,c=-(s.b+s.c)*n.tx;r.tx=n.tx*o.a+n.ty*o.c+o.tx+a,r.ty=n.tx*o.b+n.ty*o.d+o.ty+c}else r.tx=n.tx*o.a+n.ty*o.c+o.tx,r.ty=n.tx*o.b+n.ty*o.d+o.ty}else r.a=n.a,r.b=n.b,r.c=n.c,r.d=n.d,r.tx=n.tx,r.ty=n.ty;var l,u,h=i._children;if(t&&h&&0!==h.length)for(l=0,u=h.length;l<u;l++)h[l]._renderCmd.transform(this,t);if(h=i._protectedChildren,t&&h&&0!==h.length)for(l=0,u=h.length;l<u;l++)h[l]._renderCmd.transform(this,t)}}(),function(){cc.ProtectedNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e)};var e=cc.ProtectedNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(cc.ProtectedNode.RenderCmd,e),e.constructor=cc.ProtectedNode.WebGLRenderCmd,e.visit=function(e){var t=this._node;if(t._visible){var i,n,r=cc.current_stack;r.stack.push(r.top),this._syncStatus(e),r.top=this._stackMatrix;var o=t.grid;o&&o._active&&o.beforeDraw();var s=t._children,a=t._protectedChildren,c=s.length,l=a.length;t.sortAllChildren(),t.sortAllProtectedChildren();var u;for(i=0;i<c&&(s[i]&&s[i]._localZOrder<0);i++)s[i].visit(this);for(n=0;n<l&&((u=a[n])&&u._localZOrder<0);n++)this._changeProtectedChild(u),u.visit(this);for(cc.renderer.pushRenderCommand(this);i<c;i++)s[i]&&s[i].visit(this);for(;n<l;n++)(u=a[n])&&(this._changeProtectedChild(u),u.visit(this));o&&o._active&&o.afterDraw(t),this._dirtyFlag=0,r.top=r.stack.pop()}},e.transform=function(e,t){var i=this._node,n=this._transform4x4,r=this._stackMatrix,o=e?e._stackMatrix:cc.current_stack.top,s=i.getNodeToParentTransform();i._changePosition&&i._changePosition(),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag;var a=n.mat;if(a[0]=s.a,a[4]=s.c,a[12]=s.tx,a[1]=s.b,a[5]=s.d,a[13]=s.ty,a[14]=i._vertexZ,cc.kmMat4Multiply(r,o,n),null!=i._camera&&(null==i.grid||!i.grid.isActive())){var c=this._anchorPointInPoints.x,l=this._anchorPointInPoints.y;if(0!==c||0!==l){cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(c|=0,l|=0);var u=new cc.kmMat4;cc.kmMat4Translation(u,c,l,0),cc.kmMat4Multiply(r,r,u),i._camera._locateForRenderer(r),cc.kmMat4Translation(u,-c,-l,0),cc.kmMat4Multiply(r,r,u)}else i._camera._locateForRenderer(r)}var h,d,p=i._children;if(t&&p&&0!==p.length)for(h=0,d=p.length;h<d;h++)p[h]._renderCmd.transform(this,t);if(p=i._protectedChildren,t&&p&&0!==p.length)for(h=0,d=p.length;h<d;h++)p[h]._renderCmd.transform(this,t)}}(),cc.AtlasNode=cc.Node.extend({textureAtlas:null,quadsToDraw:0,_itemsPerRow:0,_itemsPerColumn:0,_itemWidth:0,_itemHeight:0,_opacityModifyRGB:!1,_blendFunc:null,_ignoreContentScaleFactor:!1,_className:"AtlasNode",_textureForCanvas:null,ctor:function(e,t,i,n){cc.Node.prototype.ctor.call(this),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._ignoreContentScaleFactor=!1,void 0!==n&&this.initWithTileFile(e,t,i,n)},_createRenderCmd:function(){cc._renderType===cc._RENDER_TYPE_CANVAS?this._renderCmd=new cc.AtlasNode.CanvasRenderCmd(this):this._renderCmd=new cc.AtlasNode.WebGLRenderCmd(this)},updateAtlasValues:function(){cc.log(cc._LogInfos.AtlasNode_updateAtlasValues)},getColor:function(){return this._opacityModifyRGB?this._renderCmd._colorUnmodified:cc.Node.prototype.getColor.call(this)},setOpacityModifyRGB:function(e){var t=this.color;this._opacityModifyRGB=e,this.setColor(t)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){this._blendFunc=void 0===t?e:{src:e,dst:t}},setTextureAtlas:function(e){this.textureAtlas=e},getTextureAtlas:function(){return this.textureAtlas},getQuadsToDraw:function(){return this.quadsToDraw},setQuadsToDraw:function(e){this.quadsToDraw=e},initWithTileFile:function(e,t,i,n){if(!e)throw"cc.AtlasNode.initWithTileFile(): title should not be null";var r=cc.textureCache.addImage(e);return this.initWithTexture(r,t,i,n)},initWithTexture:function(e,t,i,n){return this._renderCmd.initWithTexture(e,t,i,n)},setColor:function(e){this._renderCmd.setColor(e)},setOpacity:function(e){this._renderCmd.setOpacity(e)},getTexture:function(){return this._renderCmd.getTexture()},setTexture:function(e){this._renderCmd.setTexture(e)},_setIgnoreContentScaleFactor:function(e){this._ignoreContentScaleFactor=e}});var _p=cc.AtlasNode.prototype;cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),cc.defineGetterSetter(_p,"color",_p.getColor,_p.setColor),_p.texture,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),_p.textureAtlas,_p.quadsToDraw,cc.EventHelper.prototype.apply(_p),cc.AtlasNode.create=function(e,t,i,n){return new cc.AtlasNode(e,t,i,n)},function(){cc.AtlasNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!1,this._colorUnmodified=cc.color.WHITE,this._originalTexture=null,this._texture=null};var e=cc.AtlasNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.AtlasNode.CanvasRenderCmd,e.initWithTexture=function(e,t,i,n){var r=this._node;return r._itemWidth=t,r._itemHeight=i,r._opacityModifyRGB=!0,this._originalTexture=e,this._originalTexture?(this._texture=this._originalTexture,this._calculateMaxItems(),r.quadsToDraw=n,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},e.setColor=function(e){var t=this._node._realColor;t.r==e.r&&t.g==e.g&&t.b==e.b||(this._colorUnmodified=e,this._changeTextureColor())},cc.sys._supportCanvasNewBlendModes?e._changeTextureColor=function(){var e=this._node,t=e.getTexture();if(t&&this._originalTexture){var i=this._originalTexture.getHtmlElementObj();if(!i)return;var n=t.getHtmlElementObj(),r=cc.rect(0,0,i.width,i.height);n instanceof HTMLCanvasElement?cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(i,this._colorUnmodified,r,n):(n=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(i,this._colorUnmodified,r),(t=new cc.Texture2D).initWithElement(n),t.handleLoadedTexture(),e.setTexture(t))}}:e._changeTextureColor=function(){var e,t=this._node,i=t.getTexture();if(i&&this._originalTexture){if(!(e=i.getHtmlElementObj()))return;var n=this._originalTexture.getHtmlElementObj(),r=cc.textureCache.getTextureColors(n);if(r){var o=cc.rect(0,0,n.width,n.height);e instanceof HTMLCanvasElement?cc.Sprite.CanvasRenderCmd._generateTintImage(e,r,this._displayedColor,o,e):(e=cc.Sprite.CanvasRenderCmd._generateTintImage(e,r,this._displayedColor,o),(i=new cc.Texture2D).initWithElement(e),i.handleLoadedTexture(),t.setTexture(i))}}},e.setOpacity=function(e){var t=this._node;cc.Node.prototype.setOpacity.call(t,e)},e.getTexture=function(){return this._texture},e.setTexture=function(e){this._texture=e},e._calculateMaxItems=function(){var e=this._node,t=this._texture.getContentSize();e._itemsPerColumn=0|t.height/e._itemHeight,e._itemsPerRow=0|t.width/e._itemWidth}}(),function(){cc.AtlasNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._textureAtlas=null,this._colorUnmodified=cc.color.WHITE,this._colorF32Array=null,this._uniformColor=null,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR),this._uniformColor=cc._renderContext.getUniformLocation(this._shaderProgram.getProgram(),"u_color")};var e=cc.AtlasNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.AtlasNode.WebGLRenderCmd,e._updateBlendFunc=function(){var e=this._node;this._textureAtlas.texture.hasPremultipliedAlpha()||(e._blendFunc.src=cc.SRC_ALPHA,e._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},e._updateOpacityModifyRGB=function(){this._node._opacityModifyRGB=this._textureAtlas.texture.hasPremultipliedAlpha()},e.rendering=function(e){var t=e||cc._renderContext,i=this._node;this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),this._uniformColor&&this._colorF32Array&&(t.uniform4fv(this._uniformColor,this._colorF32Array),this._textureAtlas.drawNumberOfQuads(i.quadsToDraw,0))},e.initWithTexture=function(e,t,i,n){var r=this._node;r._itemWidth=t,r._itemHeight=i,this._colorUnmodified=cc.color.WHITE,r._opacityModifyRGB=!0,r._blendFunc.src=cc.BLEND_SRC,r._blendFunc.dst=cc.BLEND_DST;var o=r._realColor;return this._colorF32Array=new Float32Array([o.r/255,o.g/255,o.b/255,r._realOpacity/255]),this._textureAtlas=new cc.TextureAtlas,this._textureAtlas.initWithTexture(e,n),this._textureAtlas?(this._updateBlendFunc(),this._updateOpacityModifyRGB(),this._calculateMaxItems(),r.quadsToDraw=n,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},e.setColor=function(e){var t=cc.color(e.r,e.g,e.b),i=this._node;this._colorUnmodified=e;var n=this._displayedOpacity;i._opacityModifyRGB&&(t.r=t.r*n/255,t.g=t.g*n/255,t.b=t.b*n/255),cc.Node.prototype.setColor.call(i,t)},e.setOpacity=function(e){var t=this._node;cc.Node.prototype.setOpacity.call(t,e),t._opacityModifyRGB&&(t.color=this._colorUnmodified)},e._updateColor=function(){var e=this._displayedColor;this._colorF32Array=new Float32Array([e.r/255,e.g/255,e.b/255,this._displayedOpacity/255])},e.getTexture=function(){return this._textureAtlas.texture},e.setTexture=function(e){this._textureAtlas.texture=e,this._updateBlendFunc(),this._updateOpacityModifyRGB()},e._calculateMaxItems=function(){var e=this._node,t=this._textureAtlas.texture,i=t.getContentSize();e._ignoreContentScaleFactor&&(i=t.getContentSizeInPixels()),e._itemsPerColumn=0|i.height/e._itemHeight,e._itemsPerRow=0|i.width/e._itemWidth}}(),cc._tmp.WebGLTexture2D=function(){cc.Texture2D=cc.Class.extend({_pVRHaveAlphaPremultiplied:!0,_pixelFormat:null,_pixelsWide:0,_pixelsHigh:0,_name:"",_contentSize:null,maxS:0,maxT:0,_hasPremultipliedAlpha:!1,_hasMipmaps:!1,shaderProgram:null,_textureLoaded:!1,_htmlElementObj:null,_webTextureObj:null,url:null,ctor:function(){this._contentSize=cc.size(0,0),this._pixelFormat=cc.Texture2D.defaultPixelFormat},releaseTexture:function(){this._webTextureObj&&cc._renderContext.deleteTexture(this._webTextureObj),cc.loader.release(this.url)},getPixelFormat:function(){return this._pixelFormat},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getName:function(){return this._webTextureObj},getContentSize:function(){return cc.size(this._contentSize.width/cc.contentScaleFactor(),this._contentSize.height/cc.contentScaleFactor())},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},getMaxS:function(){return this.maxS},setMaxS:function(e){this.maxS=e},getMaxT:function(){return this.maxT},setMaxT:function(e){this.maxT=e},getShaderProgram:function(){return this.shaderProgram},setShaderProgram:function(e){this.shaderProgram=e},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha},hasMipmaps:function(){return this._hasMipmaps},description:function(){var e=this;return"<cc.Texture2D | Name = "+e._name+" | Dimensions = "+e._pixelsWide+" x "+e._pixelsHigh+" | Coordinates = ("+e.maxS+", "+e.maxT+")>"},releaseData:function(e){null},keepData:function(e,t){return e},initWithData:function(e,t,i,n,r){var o=this,s=cc.Texture2D,a=cc._renderContext,c=a.RGBA,l=a.UNSIGNED_BYTE,u=i*cc.Texture2D._B[t]/8;switch(u%8==0?a.pixelStorei(a.UNPACK_ALIGNMENT,8):u%4==0?a.pixelStorei(a.UNPACK_ALIGNMENT,4):u%2==0?a.pixelStorei(a.UNPACK_ALIGNMENT,2):a.pixelStorei(a.UNPACK_ALIGNMENT,1),o._webTextureObj=a.createTexture(),cc.glBindTexture2D(o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),t){case s.PIXEL_FORMAT_RGBA8888:c=a.RGBA;break;case s.PIXEL_FORMAT_RGB888:c=a.RGB;break;case s.PIXEL_FORMAT_RGBA4444:l=a.UNSIGNED_SHORT_4_4_4_4;break;case s.PIXEL_FORMAT_RGB5A1:l=a.UNSIGNED_SHORT_5_5_5_1;break;case s.PIXEL_FORMAT_RGB565:l=a.UNSIGNED_SHORT_5_6_5;break;case s.PIXEL_FORMAT_AI88:c=a.LUMINANCE_ALPHA;break;case s.PIXEL_FORMAT_A8:c=a.ALPHA;break;case s.PIXEL_FORMAT_I8:c=a.LUMINANCE;break;default:cc.assert(0,cc._LogInfos.Texture2D_initWithData)}return a.texImage2D(a.TEXTURE_2D,0,c,i,n,0,c,l,e),o._contentSize.width=r.width,o._contentSize.height=r.height,o._pixelsWide=i,o._pixelsHigh=n,o._pixelFormat=t,o.maxS=r.width/i,o.maxT=r.height/n,o._hasPremultipliedAlpha=!1,o._hasMipmaps=!1,o.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),o._textureLoaded=!0,!0},drawAtPoint:function(e){var t=this,i=[0,t.maxT,t.maxS,t.maxT,0,0,t.maxS,0],n=t._pixelsWide*t.maxS,r=t._pixelsHigh*t.maxT,o=[e.x,e.y,0,n+e.x,e.y,0,e.x,r+e.y,0,n+e.x,r+e.y,0];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS),t._shaderProgram.use(),t._shaderProgram.setUniformsForBuiltins(),cc.glBindTexture2D(t);var s=cc._renderContext;s.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,s.FLOAT,!1,0,o),s.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,s.FLOAT,!1,0,i),s.drawArrays(s.TRIANGLE_STRIP,0,4)},drawInRect:function(e){var t=this,i=[0,t.maxT,t.maxS,t.maxT,0,0,t.maxS,0],n=[e.x,e.y,e.x+e.width,e.y,e.x,e.y+e.height,e.x+e.width,e.y+e.height];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS),t._shaderProgram.use(),t._shaderProgram.setUniformsForBuiltins(),cc.glBindTexture2D(t);var r=cc._renderContext;r.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,r.FLOAT,!1,0,n),r.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,r.FLOAT,!1,0,i),r.drawArrays(r.TRIANGLE_STRIP,0,4)},initWithImage:function(e){if(null==e)return cc.log(cc._LogInfos.Texture2D_initWithImage),!1;var t=e.getWidth(),i=e.getHeight(),n=cc.configuration.getMaxTextureSize();return t>n||i>n?(cc.log(cc._LogInfos.Texture2D_initWithImage_2,t,i,n,n),!1):(this._textureLoaded=!0,this._initPremultipliedATextureWithImage(e,t,i))},initWithElement:function(e){e&&(this._webTextureObj=cc._renderContext.createTexture(),this._htmlElementObj=e,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){var e=this;if(cc._rendererInitialized){if(!e._htmlElementObj){var t=cc.loader.getRes(e.url);if(!t)return;e.initWithElement(t)}if(e._htmlElementObj.width&&e._htmlElementObj.height){var i=cc._renderContext;cc.glBindTexture2D(e),i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e._htmlElementObj),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),e.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),cc.glBindTexture2D(null);var n=e._htmlElementObj.width,r=e._htmlElementObj.height;e._pixelsWide=e._contentSize.width=n,e._pixelsHigh=e._contentSize.height=r,e._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,e.maxS=1,e.maxT=1,e._hasPremultipliedAlpha=!1,e._hasMipmaps=!1,e.dispatchEvent("load")}}},initWithString:function(e,t,i,n,r,o){return cc.log(cc._LogInfos.Texture2D_initWithString),null},initWithETCFile:function(e){return cc.log(cc._LogInfos.Texture2D_initWithETCFile_2),!1},initWithPVRFile:function(e){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2),!1},initWithPVRTCData:function(e,t,i,n,r,o){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2),!1},setTexParameters:function(e,t,i,n){var r=this,o=cc._renderContext;void 0!==t&&(e={minFilter:e,magFilter:t,wrapS:i,wrapT:n}),cc.assert(r._pixelsWide==cc.NextPOT(r._pixelsWide)&&r._pixelsHigh==cc.NextPOT(r._pixelsHigh)||e.wrapS==o.CLAMP_TO_EDGE&&e.wrapT==o.CLAMP_TO_EDGE,"WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures"),cc.glBindTexture2D(r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,e.minFilter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,e.magFilter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,e.wrapS),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,e.wrapT)},setAntiAliasTexParameters:function(){var e=cc._renderContext;cc.glBindTexture2D(this),this._hasMipmaps?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)},setAliasTexParameters:function(){var e=cc._renderContext;cc.glBindTexture2D(this),this._hasMipmaps?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)},generateMipmap:function(){var e=this;cc.assert(e._pixelsWide==cc.NextPOT(e._pixelsWide)&&e._pixelsHigh==cc.NextPOT(e._pixelsHigh),"Mimpap texture only works in POT textures"),cc.glBindTexture2D(e),cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D),e._hasMipmaps=!0},stringForFormat:function(){return cc.Texture2D._M[this._pixelFormat]},bitsPerPixelForFormat:function(e){e=e||this._pixelFormat;var t=cc.Texture2D._B[e];return null!=t?t:(cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat,e),-1)},_initPremultipliedATextureWithImage:function(e,t,i){var n,r=cc.Texture2D,o=e.getData(),s=null,a=null,c=e.hasAlpha(),l=cc.size(e.getWidth(),e.getHeight()),u=r.defaultPixelFormat,h=e.getBitsPerComponent();c||(h>=8?u=r.PIXEL_FORMAT_RGB888:(cc.log(cc._LogInfos.Texture2D__initPremultipliedATextureWithImage),u=r.PIXEL_FORMAT_RGB565));var d=t*i;if(u==r.PIXEL_FORMAT_RGB565)if(c)for(o=new Uint16Array(t*i),s=e.getData(),n=0;n<d;++n)o[n]=(s[n]>>0&255)>>3<<11|(s[n]>>8&255)>>2<<5|(s[n]>>16&255)>>3<<0;else for(o=new Uint16Array(t*i),a=e.getData(),n=0;n<d;++n)o[n]=(255&a[n])>>3<<11|(255&a[n])>>2<<5|(255&a[n])>>3<<0;else if(u==r.PIXEL_FORMAT_RGBA4444)for(o=new Uint16Array(t*i),s=e.getData(),n=0;n<d;++n)o[n]=(s[n]>>0&255)>>4<<12|(s[n]>>8&255)>>4<<8|(s[n]>>16&255)>>4<<4|(s[n]>>24&255)>>4<<0;else if(u==r.PIXEL_FORMAT_RGB5A1)for(o=new Uint16Array(t*i),s=e.getData(),n=0;n<d;++n)o[n]=(s[n]>>0&255)>>3<<11|(s[n]>>8&255)>>3<<6|(s[n]>>16&255)>>3<<1|(s[n]>>24&255)>>7<<0;else if(u==r.PIXEL_FORMAT_A8)for(o=new Uint8Array(t*i),s=e.getData(),n=0;n<d;++n)o[n]=s>>24&255;if(c&&u==r.PIXEL_FORMAT_RGB888)for(s=e.getData(),o=new Uint8Array(t*i*3),n=0;n<d;++n)o[3*n]=s>>0&255,o[3*n+1]=s>>8&255,o[3*n+2]=s>>16&255;return this.initWithData(o,u,t,i,l),o!=e.getData()&&(o=null),this._hasPremultipliedAlpha=e.isPremultipliedAlpha(),!0},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},removeLoadedEventListener:function(e){this.removeEventListener("load",e)}})},cc._tmp.WebGLTextureAtlas=function(){var e=cc.TextureAtlas.prototype;e._setupVBO=function(){var e=this,t=cc._renderContext;e._buffersVBO[0]=t.createBuffer(),e._buffersVBO[1]=t.createBuffer(),e._quadsWebBuffer=t.createBuffer(),e._mapBuffers()},e._mapBuffers=function(){var e=this,t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,e._quadsWebBuffer),t.bufferData(t.ARRAY_BUFFER,e._quadsArrayBuffer,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e._indices,t.STATIC_DRAW)},e.drawNumberOfQuads=function(e,t){var i=this;if(t=t||0,0!==e&&i.texture&&i.texture.isLoaded()){var n=cc._renderContext;cc.glBindTexture2D(i.texture),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),n.bindBuffer(n.ARRAY_BUFFER,i._quadsWebBuffer),i.dirty&&(n.bufferData(n.ARRAY_BUFFER,i._quadsArrayBuffer,n.DYNAMIC_DRAW),i.dirty=!1),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,24,0),n.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,n.UNSIGNED_BYTE,!0,24,12),n.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,24,16),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i._buffersVBO[1]),cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?n.drawElements(n.TRIANGLE_STRIP,6*e,n.UNSIGNED_SHORT,6*t*i._indices.BYTES_PER_ELEMENT):n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,6*t*i._indices.BYTES_PER_ELEMENT),cc.g_NumberOfDraws++}}},cc._tmp.WebGLTextureCache=function(){var e=cc.textureCache;e.handleLoadedTexture=function(e){var t=this._textures;cc._rendererInitialized||(t=this._loadedTexturesBefore);var i=t[e];i||((i=t[e]=new cc.Texture2D).url=e),i.handleLoadedTexture()},e.addImage=function(e,t,i){cc.assert(e,cc._LogInfos.Texture2D_addImage_2);var n=this._textures;cc._rendererInitialized||(n=this._loadedTexturesBefore);var r=n[e]||n[cc.loader._aliases[e]];return r?(t&&t.call(i,r),r):((r=n[e]=new cc.Texture2D).url=e,(cc.loader._checkIsImageURL(e)?cc.loader.load:cc.loader.loadImg).call(cc.loader,e,function(r,o){if(r)return t&&t.call(i,r);cc.textureCache.handleLoadedTexture(e);var s=n[e];t&&t.call(i,s)}),r)},e=null},cc._tmp.PrototypeTexture2D=function(){var e=cc.Texture2D;e.PVRImagesHavePremultipliedAlpha=function(e){cc.PVRHaveAlphaPremultiplied_=e},e.PIXEL_FORMAT_RGBA8888=2,e.PIXEL_FORMAT_RGB888=3,e.PIXEL_FORMAT_RGB565=4,e.PIXEL_FORMAT_A8=5,e.PIXEL_FORMAT_I8=6,e.PIXEL_FORMAT_AI88=7,e.PIXEL_FORMAT_RGBA4444=8,e.PIXEL_FORMAT_RGB5A1=7,e.PIXEL_FORMAT_PVRTC4=9,e.PIXEL_FORMAT_PVRTC2=10,e.PIXEL_FORMAT_DEFAULT=e.PIXEL_FORMAT_RGBA8888;var t=cc.Texture2D._M={};t[e.PIXEL_FORMAT_RGBA8888]="RGBA8888",t[e.PIXEL_FORMAT_RGB888]="RGB888",t[e.PIXEL_FORMAT_RGB565]="RGB565",t[e.PIXEL_FORMAT_A8]="A8",t[e.PIXEL_FORMAT_I8]="I8",t[e.PIXEL_FORMAT_AI88]="AI88",t[e.PIXEL_FORMAT_RGBA4444]="RGBA4444",t[e.PIXEL_FORMAT_RGB5A1]="RGB5A1",t[e.PIXEL_FORMAT_PVRTC4]="PVRTC4",t[e.PIXEL_FORMAT_PVRTC2]="PVRTC2";var i=cc.Texture2D._B={};i[e.PIXEL_FORMAT_RGBA8888]=32,i[e.PIXEL_FORMAT_RGB888]=24,i[e.PIXEL_FORMAT_RGB565]=16,i[e.PIXEL_FORMAT_A8]=8,i[e.PIXEL_FORMAT_I8]=8,i[e.PIXEL_FORMAT_AI88]=16,i[e.PIXEL_FORMAT_RGBA4444]=16,i[e.PIXEL_FORMAT_RGB5A1]=16,i[e.PIXEL_FORMAT_PVRTC4]=4,i[e.PIXEL_FORMAT_PVRTC2]=3;var n=cc.Texture2D.prototype;n.name,cc.defineGetterSetter(n,"name",n.getName),n.pixelFormat,cc.defineGetterSetter(n,"pixelFormat",n.getPixelFormat),n.pixelsWidth,cc.defineGetterSetter(n,"pixelsWidth",n.getPixelsWide),n.pixelsHeight,cc.defineGetterSetter(n,"pixelsHeight",n.getPixelsHigh),n.width,cc.defineGetterSetter(n,"width",n._getWidth),n.height,cc.defineGetterSetter(n,"height",n._getHeight),e.defaultPixelFormat=e.PIXEL_FORMAT_DEFAULT},cc._tmp.PrototypeTextureAtlas=function(){var e=cc.TextureAtlas.prototype;e.totalQuads,cc.defineGetterSetter(e,"totalQuads",e.getTotalQuads),e.capacity,cc.defineGetterSetter(e,"capacity",e.getCapacity),e.quads,cc.defineGetterSetter(e,"quads",e.getQuads,e.setQuads)},cc.ALIGN_CENTER=51,cc.ALIGN_TOP=19,cc.ALIGN_TOP_RIGHT=18,cc.ALIGN_RIGHT=50,cc.ALIGN_BOTTOM_RIGHT=34,cc.ALIGN_BOTTOM=35,cc.ALIGN_BOTTOM_LEFT=33,cc.ALIGN_LEFT=49,cc.ALIGN_TOP_LEFT=17,cc.PVRHaveAlphaPremultiplied_=!1,cc._renderType===cc._RENDER_TYPE_CANVAS?(cc.Texture2D=cc.Class.extend({_contentSize:null,_textureLoaded:!1,_htmlElementObj:null,url:null,_pattern:null,ctor:function(){this._contentSize=cc.size(0,0),this._textureLoaded=!1,this._htmlElementObj=null,this._pattern=""},getPixelsWide:function(){return this._contentSize.width},getPixelsHigh:function(){return this._contentSize.height},getContentSize:function(){var e=cc.contentScaleFactor();return cc.size(this._contentSize.width/e,this._contentSize.height/e)},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(e){e&&(this._htmlElementObj=e,this._contentSize.width=e.width,this._contentSize.height=e.height,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){var e=this;if(!e._textureLoaded){if(!e._htmlElementObj){var t=cc.loader.getRes(e.url);if(!t)return;e.initWithElement(t)}var i=e._htmlElementObj;e._contentSize.width=i.width,e._contentSize.height=i.height,e.dispatchEvent("load")}},description:function(){return"<cc.Texture2D | width = "+this._contentSize.width+" height "+this._contentSize.height+">"},initWithData:function(e,t,i,n,r){return!1},initWithImage:function(e){return!1},initWithString:function(e,t,i,n,r,o){return!1},releaseTexture:function(){cc.loader.release(this.url)},getName:function(){return null},getMaxS:function(){return 1},setMaxS:function(e){},getMaxT:function(){return 1},setMaxT:function(e){},getPixelFormat:function(){return null},getShaderProgram:function(){return null},setShaderProgram:function(e){},hasPremultipliedAlpha:function(){return!1},hasMipmaps:function(){return!1},releaseData:function(e){null},keepData:function(e,t){return e},drawAtPoint:function(e){},drawInRect:function(e){},initWithETCFile:function(e){return cc.log(cc._LogInfos.Texture2D_initWithETCFile),!1},initWithPVRFile:function(e){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile),!1},initWithPVRTCData:function(e,t,i,n,r,o){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData),!1},setTexParameters:function(e,t,i,n){void 0!==t&&(e={minFilter:e,magFilter:t,wrapS:i,wrapT:n}),e.wrapS!==cc.REPEAT||e.wrapT!==cc.REPEAT?e.wrapS!==cc.REPEAT?e.wrapT!==cc.REPEAT?this._pattern="":this._pattern="repeat-y":this._pattern="repeat-x":this._pattern="repeat"},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(e){return-1},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},removeLoadedEventListener:function(e){this.removeEventListener("load",e)},_grayElementObj:null,_backupElement:null,_isGray:!1,_switchToGray:function(e){this._textureLoaded&&this._isGray!=e&&(this._isGray=e,this._isGray?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=cc.Texture2D._generateGrayTexture(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!=this._backupElement&&(this._htmlElementObj=this._backupElement))}}),cc.Texture2D._generateGrayTexture=function(e,t,i){if(null===e)return null;i=i||cc.newElement("canvas"),t=t||cc.rect(0,0,e.width,e.height),i.width=t.width,i.height=t.height;var n=i.getContext("2d");n.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);for(var r=n.getImageData(0,0,t.width,t.height),o=r.data,s=0,a=o.length;s<a;s+=4)o[s]=o[s+1]=o[s+2]=.34*o[s]+.5*o[s+1]+.16*o[s+2];return n.putImageData(r,0,0),i}):(cc.assert(cc.isFunction(cc._tmp.WebGLTexture2D),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTexture2D(),delete cc._tmp.WebGLTexture2D),cc.EventHelper.prototype.apply(cc.Texture2D.prototype),cc.assert(cc.isFunction(cc._tmp.PrototypeTexture2D),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js"),cc._tmp.PrototypeTexture2D(),delete cc._tmp.PrototypeTexture2D,cc.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1e3*Math.random(),_loadedTexturesBefore:{},_initializingRenderer:function(){var e,t=this._loadedTexturesBefore,i=this._textures;for(e in t){var n=t[e];n.handleLoadedTexture(),i[e]=n}this._loadedTexturesBefore={}},addPVRTCImage:function(e){cc.log(cc._LogInfos.textureCache_addPVRTCImage)},addETCImage:function(e){cc.log(cc._LogInfos.textureCache_addETCImage)},description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">"},textureForKey:function(e){return cc.log(cc._LogInfos.textureCache_textureForKey),this.getTextureForKey(e)},getTextureForKey:function(e){return this._textures[e]||this._textures[cc.loader._aliases[e]]},getKeyByTexture:function(e){for(var t in this._textures)if(this._textures[t]==e)return t;return null},_generalTextureKey:function(){return"_textureKey_"+ ++this._textureKeySeq},getTextureColors:function(e){var t=this.getKeyByTexture(e);return t||(t=e instanceof HTMLImageElement?e.src:this._generalTextureKey()),this._textureColorsCache[t]||(this._textureColorsCache[t]=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor(e)),this._textureColorsCache[t]},addPVRImage:function(e){cc.log(cc._LogInfos.textureCache_addPVRImage)},removeAllTextures:function(){var e=this._textures;for(var t in e)e[t]&&e[t].releaseTexture();this._textures={}},removeTexture:function(e){if(e){var t=this._textures;for(var i in t)t[i]==e&&(t[i].releaseTexture(),delete t[i])}},removeTextureForKey:function(e){null!=e&&this._textures[e]&&delete this._textures[e]},cacheImage:function(e,t){if(t instanceof cc.Texture2D)this._textures[e]=t;else{var i=new cc.Texture2D;i.initWithElement(t),i.handleLoadedTexture(),this._textures[e]=i}},addUIImage:function(e,t){if(cc.assert(e,cc._LogInfos.textureCache_addUIImage_2),t&&this._textures[t])return this._textures[t];var i=new cc.Texture2D;return i.initWithImage(e),null!=t&&null!=i?this._textures[t]=i:cc.log(cc._LogInfos.textureCache_addUIImage),i},dumpCachedTextureInfo:function(){var e=0,t=0,i=this._textures;for(var n in i){var r=i[n];e++,r.getHtmlElementObj()instanceof HTMLImageElement?cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo,n,r.getHtmlElementObj().src,r.pixelsWidth,r.pixelsHeight):cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,n,r.pixelsWidth,r.pixelsHeight),t+=r.pixelsWidth*r.pixelsHeight*4}var o=this._textureColorsCache;for(n in o){var s=o[n];for(var a in s){var c=s[a];e++,cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,n,c.width,c.height),t+=c.width*c.height*4}}cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3,e,t/1024,(t/1048576).toFixed(2))},_clear:function(){this._textures={},this._textureColorsCache={},this._textureKeySeq=0|1e3*Math.random(),this._loadedTexturesBefore={}}},cc._renderType===cc._RENDER_TYPE_CANVAS?((_p=cc.textureCache).handleLoadedTexture=function(e){var t=this._textures,i=t[e];i||((i=t[e]=new cc.Texture2D).url=e),i.handleLoadedTexture()},_p.addImage=function(e,t,i){cc.assert(e,cc._LogInfos.Texture2D_addImage);var n=this._textures,r=n[e]||n[cc.loader._aliases[e]];return r?(t&&t.call(i,r),r):((r=n[e]=new cc.Texture2D).url=e,(cc.loader._checkIsImageURL(e)?cc.loader.load:cc.loader.loadImg).call(cc.loader,e,function(r,o){if(r)return t&&t.call(i,r);cc.textureCache.handleLoadedTexture(e);var s=n[e];t&&t.call(i,s)}),r)},_p=null):(cc.assert(cc.isFunction(cc._tmp.WebGLTextureCache),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureCache(),delete cc._tmp.WebGLTextureCache),cc.TextureAtlas=cc.Class.extend({dirty:!1,texture:null,_indices:null,_buffersVBO:null,_capacity:0,_quads:null,_quadsArrayBuffer:null,_quadsWebBuffer:null,_quadsReader:null,ctor:function(e,t){this._buffersVBO=[],cc.isString(e)?this.initWithFile(e,t):e instanceof cc.Texture2D&&this.initWithTexture(e,t)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(e){this.texture=e},setDirty:function(e){this.dirty=e},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(e){this._quads=e},_copyQuadsToTextureAtlas:function(e,t){if(e)for(var i=0;i<e.length;i++)this._setQuadToArray(e[i],t+i)},_setQuadToArray:function(e,t){var i=this._quads;i[t]?(i[t].bl=e.bl,i[t].br=e.br,i[t].tl=e.tl,i[t].tr=e.tr):i[t]=new cc.V3F_C4B_T2F_Quad(e.tl,e.bl,e.tr,e.br,this._quadsArrayBuffer,t*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)},description:function(){return"<cc.TextureAtlas | totalQuads ="+this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var e=this._indices,t=this._capacity,i=0;i<t;i++)cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(e[6*i+0]=4*i+0,e[6*i+1]=4*i+0,e[6*i+2]=4*i+2,e[6*i+3]=4*i+1,e[6*i+4]=4*i+3,e[6*i+5]=4*i+3):(e[6*i+0]=4*i+0,e[6*i+1]=4*i+1,e[6*i+2]=4*i+2,e[6*i+3]=4*i+3,e[6*i+4]=4*i+2,e[6*i+5]=4*i+1)},_setupVBO:function(){var e=cc._renderContext;this._buffersVBO[0]=e.createBuffer(),this._buffersVBO[1]=e.createBuffer(),this._quadsWebBuffer=e.createBuffer(),this._mapBuffers()},_mapBuffers:function(){var e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._quadsWebBuffer),e.bufferData(e.ARRAY_BUFFER,this._quadsArrayBuffer,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW)},initWithFile:function(e,t){var i=cc.textureCache.addImage(e);return i?this.initWithTexture(i,t):(cc.log(cc._LogInfos.TextureAtlas_initWithFile,e),!1)},initWithTexture:function(e,t){cc.assert(e,cc._LogInfos.TextureAtlas_initWithTexture),t|=0,this._capacity=t,this._totalQuads=0,this.texture=e,this._quads=[],this._indices=new Uint16Array(6*t);var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._quadsArrayBuffer=new ArrayBuffer(i*t),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),(!this._quads||!this._indices)&&t>0)return!1;for(var n=this._quads,r=0;r<t;r++)n[r]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,r*i);return this._setupIndices(),this._setupVBO(),this.dirty=!0,!0},updateQuad:function(e,t){cc.assert(e,cc._LogInfos.TextureAtlas_updateQuad),cc.assert(t>=0&&t<this._capacity,cc._LogInfos.TextureAtlas_updateQuad_2),this._totalQuads=Math.max(t+1,this._totalQuads),this._setQuadToArray(e,t),this.dirty=!0},insertQuad:function(e,t){if(cc.assert(t<this._capacity,cc._LogInfos.TextureAtlas_insertQuad_2),++this._totalQuads>this._capacity)cc.log(cc._LogInfos.TextureAtlas_insertQuad);else{var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=t*i,r=(this._totalQuads-1-t)*i;this._quads[this._totalQuads-1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*i),this._quadsReader.set(this._quadsReader.subarray(n,n+r),n+i),this._setQuadToArray(e,t),this.dirty=!0}},insertQuads:function(e,t,i){i=i||e.length,cc.assert(t+i<=this._capacity,cc._LogInfos.TextureAtlas_insertQuads);var n=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=i,this._totalQuads>this._capacity)cc.log(cc._LogInfos.TextureAtlas_insertQuad);else{var r,o=t*n,s=(this._totalQuads-1-t-i)*n,a=this._totalQuads-1-i;for(r=0;r<i;r++)this._quads[a+r]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*n);for(this._quadsReader.set(this._quadsReader.subarray(o,o+s),o+n*i),r=0;r<i;r++)this._setQuadToArray(e[r],t+r);this.dirty=!0}},insertQuadFromIndex:function(e,t){if(e!==t){cc.assert(t>=0||t<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex),cc.assert(e>=0||e<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex_2);var i,n,r=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,o=this._quadsReader,s=o.subarray(e*r,r);e>t?(i=t*r,n=(e-t)*r,o.set(o.subarray(i,i+n),i+r),o.set(s,i)):(i=(e+1)*r,n=(t-e)*r,o.set(o.subarray(i,i+n),i-r),o.set(s,t*r)),this.dirty=!0}},removeQuadAtIndex:function(e){cc.assert(e<this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadAtIndex);var t=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads--,this._quads.length=this._totalQuads,e!==this._totalQuads){var i=(e+1)*t,n=(this._totalQuads-e)*t;this._quadsReader.set(this._quadsReader.subarray(i,i+n),i-t)}this.dirty=!0},removeQuadsAtIndex:function(e,t){if(cc.assert(e+t<=this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadsAtIndex),this._totalQuads-=t,e!==this._totalQuads){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=(e+t)*i,r=(this._totalQuads-e)*i,o=e*i;this._quadsReader.set(this._quadsReader.subarray(n,n+r),o)}this.dirty=!0},removeAllQuads:function(){this._quads.length=0,this._totalQuads=0},_setDirty:function(e){this.dirty=e},resizeCapacity:function(e){if(e==this._capacity)return!0;var t=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=this._capacity;this._totalQuads=Math.min(this._totalQuads,e),this._capacity=0|e;var n,r=this._capacity,o=this._totalQuads;if(null==this._quads)for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(t*r),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),n=0;n<r;n++)this._quads=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,n*t);else{var s,a,c=this._quads;if(r>i){for(s=[],a=new ArrayBuffer(t*r),n=0;n<o;n++)s[n]=new cc.V3F_C4B_T2F_Quad(c[n].tl,c[n].bl,c[n].tr,c[n].br,a,n*t);for(;n<r;n++)s[n]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,a,n*t);this._quadsReader=new Uint8Array(a),this._quads=s,this._quadsArrayBuffer=a}else{var l=Math.max(o,r);for(s=[],a=new ArrayBuffer(t*r),n=0;n<l;n++)s[n]=new cc.V3F_C4B_T2F_Quad(c[n].tl,c[n].bl,c[n].tr,c[n].br,a,n*t);this._quadsReader=new Uint8Array(a),this._quads=s,this._quadsArrayBuffer=a}}if(null==this._indices)this._indices=new Uint16Array(6*r);else if(r>i){var u=new Uint16Array(6*r);u.set(this._indices,0),this._indices=u}else this._indices=this._indices.subarray(0,6*r);return this._setupIndices(),this._mapBuffers(),this.dirty=!0,!0},increaseTotalQuadsWith:function(e){this._totalQuads+=e},moveQuadsFromIndex:function(e,t,i){if(void 0===i){if(i=t,t=this._totalQuads-e,cc.assert(i+(this._totalQuads-e)<=this._capacity,cc._LogInfos.TextureAtlas_moveQuadsFromIndex),0===t)return}else if(cc.assert(i+t<=this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2),cc.assert(e<this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3),e==i)return;var n,r,o=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,s=e*o,a=t*o,c=this._quadsReader,l=c.subarray(s,s+a),u=i*o;i<e?(n=(e-i)*o,r=i*o,c.set(c.subarray(r,r+n),r+a)):(n=(i-e)*o,r=(e+t)*o,c.set(c.subarray(r,r+n),s)),c.set(l,u),this.dirty=!0},fillWithEmptyQuadsFromIndex:function(e,t){for(var i=t*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=new Uint8Array(this._quadsArrayBuffer,e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i),r=0;r<i;r++)n[r]=0},drawQuads:function(){this.drawNumberOfQuads(this._totalQuads,0)},_releaseBuffer:function(){var e=cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&e.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&e.deleteBuffer(this._buffersVBO[1])),this._quadsWebBuffer&&e.deleteBuffer(this._quadsWebBuffer)}}),(_p=cc.TextureAtlas.prototype).totalQuads,cc.defineGetterSetter(_p,"totalQuads",_p.getTotalQuads),_p.capacity,cc.defineGetterSetter(_p,"capacity",_p.getCapacity),_p.quads,cc.defineGetterSetter(_p,"quads",_p.getQuads,_p.setQuads),cc.TextureAtlas.create=function(e,t){return new cc.TextureAtlas(e,t)},cc.TextureAtlas.createWithTexture=cc.TextureAtlas.create,cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTextureAtlas),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureAtlas(),delete cc._tmp.WebGLTextureAtlas),cc.assert(cc.isFunction(cc._tmp.PrototypeTextureAtlas),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js"),cc._tmp.PrototypeTextureAtlas(),delete cc._tmp.PrototypeTextureAtlas,cc.Scene=cc.Node.extend({_className:"Scene",ctor:function(){cc.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.director.getWinSize())}}),cc.Scene.create=function(){return new cc.Scene},cc.LoaderScene=cc.Scene.extend({_interval:null,_label:null,_className:"LoaderScene",init:function(){var e=this,t=160,i=200,n=e._bgLayer=new cc.LayerColor(cc.color(32,32,32,255));e.addChild(n,0);var r=24,o=-i/2+100;cc._loaderImage&&(cc.loader.loadImg(cc._loaderImage,{isCrossOrigin:!1},function(n,r){t=r.width,i=r.height,e._initStage(r,cc.visibleRect.center)}),r=14,o=-i/2-10);var s=e._label=new cc.LabelTTF("Loading... 0%","Arial",r);return s.setPosition(cc.pAdd(cc.visibleRect.center,cc.p(0,o))),s.setColor(cc.color(180,180,180)),n.addChild(this._label,10),!0},_initStage:function(e,t){var i=this,n=i._texture2d=new cc.Texture2D;n.initWithElement(e),n.handleLoadedTexture();var r=i._logo=new cc.Sprite(n);r.setScale(cc.contentScaleFactor()),r.x=t.x,r.y=t.y,i._bgLayer.addChild(r,10)},onEnter:function(){var e=this;cc.Node.prototype.onEnter.call(e),e.schedule(e._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this);this._label.setString("Loading... 0%")},initWithResources:function(e,t){cc.isString(e)&&(e=[e]),this.resources=e||[],this.cb=t},_startLoading:function(){var e=this;e.unschedule(e._startLoading);var t=e.resources;cc.loader.load(t,function(t,i,n){var r=n/i*100|0;r=Math.min(r,100),e._label.setString("Loading... "+r+"%")},function(){e.cb&&e.cb()})}}),cc.LoaderScene.preload=function(e,t){var i=cc;return i.loaderScene||(i.loaderScene=new cc.LoaderScene,i.loaderScene.init()),i.loaderScene.initWithResources(e,t),cc.director.runScene(i.loaderScene),i.loaderScene},cc.Layer=cc.Node.extend({_className:"Layer",ctor:function(){var e=cc.Node.prototype;e.ctor.call(this),this._ignoreAnchorPointForPosition=!0,e.setAnchorPoint.call(this,.5,.5),e.setContentSize.call(this,cc.winSize)},init:function(){var e=this;return e._ignoreAnchorPointForPosition=!0,e.setAnchorPoint(.5,.5),e.setContentSize(cc.winSize),e._cascadeColorEnabled=!1,e._cascadeOpacityEnabled=!1,!0},bake:function(){this._renderCmd.bake()},unbake:function(){this._renderCmd.unbake()},isBaked:function(){return this._isBaked},addChild:function(e,t,i){cc.Node.prototype.addChild.call(this,e,t,i),this._renderCmd._bakeForAddChild(e)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Layer.CanvasRenderCmd(this):new cc.Layer.WebGLRenderCmd(this)}}),cc.Layer.create=function(){return new cc.Layer},cc.LayerColor=cc.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc},changeWidthAndHeight:function(e,t){this.width=e,this.height=t},changeWidth:function(e){this.width=e},changeHeight:function(e){this.height=e},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},ctor:function(e,t,i){cc.Layer.prototype.ctor.call(this),this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),cc.LayerColor.prototype.init.call(this,e,t,i)},init:function(e,t,i){cc._renderType!==cc._RENDER_TYPE_CANVAS&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR));var n=cc.director.getWinSize();e=e||cc.color(0,0,0,255),t=void 0===t?n.width:t,i=void 0===i?n.height:i;var r=this._realColor;return r.r=e.r,r.g=e.g,r.b=e.b,this._realOpacity=e.a,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty),cc.LayerColor.prototype.setContentSize.call(this,t,i),!0},setBlendFunc:function(e,t){var i=this._blendFunc;void 0===t?(i.src=e.src,i.dst=e.dst):(i.src=e,i.dst=t),this._renderCmd.updateBlendFunc(i)},_setWidth:function(e){cc.Node.prototype._setWidth.call(this,e),this._renderCmd._updateSquareVerticesWidth(e)},_setHeight:function(e){cc.Node.prototype._setHeight.call(this,e),this._renderCmd._updateSquareVerticesHeight(e)},setContentSize:function(e,t){cc.Layer.prototype.setContentSize.call(this,e,t),this._renderCmd._updateSquareVertices(e,t)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LayerColor.CanvasRenderCmd(this):new cc.LayerColor.WebGLRenderCmd(this)}}),cc.LayerColor.create=function(e,t,i){return new cc.LayerColor(e,t,i)},function(){var e=cc.LayerColor.prototype;cc.defineGetterSetter(e,"width",e._getWidth,e._setWidth),cc.defineGetterSetter(e,"height",e._getHeight,e._setHeight)}(),cc.LayerGradient=cc.LayerColor.extend({_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:!1,_className:"LayerGradient",ctor:function(e,t,i){var n=this;cc.LayerColor.prototype.ctor.call(n),n._endColor=cc.color(0,0,0,255),n._alongVector=cc.p(0,-1),n._startOpacity=255,n._endOpacity=255,cc.LayerGradient.prototype.init.call(n,e,t,i)},init:function(e,t,i){e=e||cc.color(0,0,0,255),t=t||cc.color(0,0,0,255),i=i||cc.p(0,-1);var n=this,r=n._endColor;return n._startOpacity=e.a,r.r=t.r,r.g=t.g,r.b=t.b,n._endOpacity=t.a,n._alongVector=i,n._compressedInterpolation=!0,cc.LayerColor.prototype.init.call(n,cc.color(e.r,e.g,e.b,255)),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty),!0},setContentSize:function(e,t){cc.LayerColor.prototype.setContentSize.call(this,e,t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setWidth:function(e){cc.LayerColor.prototype._setWidth.call(this,e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setHeight:function(e){cc.LayerColor.prototype._setHeight.call(this,e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getStartColor:function(){return this._realColor},setStartColor:function(e){this.color=e},setEndColor:function(e){this._endColor=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},getEndColor:function(){return this._endColor},setStartOpacity:function(e){this._startOpacity=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getStartOpacity:function(){return this._startOpacity},setEndOpacity:function(e){this._endOpacity=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getEndOpacity:function(){return this._endOpacity},setVector:function(e){this._alongVector.x=e.x,this._alongVector.y=e.y,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getVector:function(){return cc.p(this._alongVector.x,this._alongVector.y)},isCompressedInterpolation:function(){return this._compressedInterpolation},setCompressedInterpolation:function(e){this._compressedInterpolation=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LayerGradient.CanvasRenderCmd(this):new cc.LayerGradient.WebGLRenderCmd(this)}}),cc.LayerGradient.create=function(e,t,i){return new cc.LayerGradient(e,t,i)},function(){var e=cc.LayerGradient.prototype;e.startColor,cc.defineGetterSetter(e,"startColor",e.getStartColor,e.setStartColor),e.endColor,cc.defineGetterSetter(e,"endColor",e.getEndColor,e.setEndColor),e.startOpacity,cc.defineGetterSetter(e,"startOpacity",e.getStartOpacity,e.setStartOpacity),e.endOpacity,cc.defineGetterSetter(e,"endOpacity",e.getEndOpacity,e.setEndOpacity),e.vector,cc.defineGetterSetter(e,"vector",e.getVector,e.setVector)}(),cc.LayerMultiplex=cc.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(e){cc.Layer.prototype.ctor.call(this),e instanceof Array?cc.LayerMultiplex.prototype.initWithLayers.call(this,e):cc.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments))},initWithLayers:function(e){return e.length>0&&null==e[e.length-1]&&cc.log(cc._LogInfos.LayerMultiplex_initWithLayers),this._layers=e,this._enabledLayer=0,this.addChild(this._layers[this._enabledLayer]),!0},switchTo:function(e){e>=this._layers.length?cc.log(cc._LogInfos.LayerMultiplex_switchTo):(this.removeChild(this._layers[this._enabledLayer],!0),this._enabledLayer=e,this.addChild(this._layers[e]))},switchToAndReleaseMe:function(e){e>=this._layers.length?cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe):(this.removeChild(this._layers[this._enabledLayer],!0),this._layers[this._enabledLayer]=null,this._enabledLayer=e,this.addChild(this._layers[e]))},addLayer:function(e){e?this._layers.push(e):cc.log(cc._LogInfos.LayerMultiplex_addLayer)}}),cc.LayerMultiplex.create=function(){return new cc.LayerMultiplex(Array.prototype.slice.call(arguments))},function(){cc.Layer.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._isBaked=!1,this._bakeSprite=null};var e=cc.Layer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.Layer.CanvasRenderCmd,e.bake=function(){if(!this._isBaked){this._needDraw=!0,cc.renderer.childrenOrderDirty=!0,this._isBaked=this._cacheDirty=!0;for(var e=this._node._children,t=0,i=e.length;t<i;t++)e[t]._renderCmd._setCachedParent(this);this._bakeSprite||(this._bakeSprite=new cc.BakeSprite,this._bakeSprite._parent=this._node)}},e.unbake=function(){if(this._isBaked){cc.renderer.childrenOrderDirty=!0,this._needDraw=!1,this._isBaked=!1,this._cacheDirty=!0;for(var e=this._node._children,t=0,i=e.length;t<i;t++)e[t]._renderCmd._setCachedParent(null)}},e.isBaked=function(){return this._isBaked},e.rendering=function(){if(this._cacheDirty){var e=this._node,t=e._children,i=this._bakeSprite;this.transform(this.getParentRenderCmd(),!0);var n=this._getBoundingBoxForBake();n.width=0|n.width+.5,n.height=0|n.height+.5;var r=i.getCacheContext(),o=r.getContext();i.resetCanvasSize(n.width,n.height);var s=i.getAnchorPointInPoints(),a=e._position;if(e._ignoreAnchorPointForPosition)r.setOffset(0-n.x,o.canvas.height-n.height+n.y),i.setPosition(s.x+n.x-a.x,s.y+n.y-a.y);else{var c=this.getAnchorPointInPoints(),l={x:a.x-c.x,y:a.y-c.y};r.setOffset(0-n.x,o.canvas.height-n.height+n.y),i.setPosition(s.x+n.x-l.x,s.y+n.y-l.y)}e.sortAllChildren(),cc.renderer._turnToCacheMode(this.__instanceId);for(var u=0,h=t.length;u<h;u++)t[u].visit(this);cc.renderer._renderingToCacheCanvas(r,this.__instanceId),i.transform(this),this._cacheDirty=!1}},e.visit=function(e){if(this._isBaked){var t=this._node,i=t._children.length;t._visible&&0!==i&&(this._syncStatus(e),cc.renderer.pushRenderCommand(this),this._bakeSprite.visit(this),this._dirtyFlag=0)}else cc.Node.CanvasRenderCmd.prototype.visit.call(this,e)},e._bakeForAddChild=function(e){e._parent==this._node&&this._isBaked&&e._renderCmd._setCachedParent(this)},e._getBoundingBoxForBake=function(){var e=null,t=this._node;if(!t._children||0===t._children.length)return cc.rect(0,0,10,10);for(var i=t.getNodeToWorldTransform(),n=t._children,r=0,o=n.length;r<o;r++){var s=n[r];if(s&&s._visible)if(e){var a=s._getBoundingBoxToCurrentNode(i);a&&(e=cc.rectUnion(e,a))}else e=s._getBoundingBoxToCurrentNode(i)}return e}}(),function(){cc.LayerColor.CanvasRenderCmd=function(e){cc.Layer.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._blendFuncStr="source-over",this._bakeRenderCmd=new cc.CustomRenderCmd(this,this._bakeRendering)};var e=cc.LayerColor.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);e.constructor=cc.LayerColor.CanvasRenderCmd,e.unbake=function(){cc.Layer.CanvasRenderCmd.prototype.unbake.call(this),this._needDraw=!0},e.rendering=function(e,t,i){var n=e||cc._renderContext,r=n.getContext(),o=this._node,s=this._displayedColor,a=this._displayedOpacity/255,c=o._contentSize.width,l=o._contentSize.height;0!==a&&(n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(a),n.setFillStyle("rgba("+(0|s.r)+","+(0|s.g)+","+(0|s.b)+", 1)"),n.setTransform(this._worldTransform,t,i),r.fillRect(0,0,c*t,-l*i),cc.g_NumberOfDraws++)},e.updateBlendFunc=function(e){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(e)},e._updateSquareVertices=e._updateSquareVerticesWidth=e._updateSquareVerticesHeight=function(){},e._bakeRendering=function(){if(this._cacheDirty){var e,t=this._node,i=this._bakeSprite,n=t._children,r=n.length;this.transform(this.getParentRenderCmd(),!0);var o=this._getBoundingBoxForBake();o.width=0|o.width+.5,o.height=0|o.height+.5;var s=i.getCacheContext(),a=s.getContext();i.resetCanvasSize(o.width,o.height);var c=i.getAnchorPointInPoints(),l=t._position;if(t._ignoreAnchorPointForPosition)s.setOffset(0-o.x,a.canvas.height-o.height+o.y),i.setPosition(c.x+o.x-l.x,c.y+o.y-l.y);else{var u=this.getAnchorPointInPoints(),h={x:l.x-u.x,y:l.y-u.y};s.setOffset(0-o.x,a.canvas.height-o.height+o.y),i.setPosition(c.x+o.x-h.x,c.y+o.y-h.y)}var d;if(cc.renderer._turnToCacheMode(this.__instanceId),r>0){for(t.sortAllChildren(),e=0;e<r&&(d=n[e])._localZOrder<0;e++)d._renderCmd.visit(this);for(cc.renderer.pushRenderCommand(this);e<r;e++)n[e]._renderCmd.visit(this)}else cc.renderer.pushRenderCommand(this);cc.renderer._renderingToCacheCanvas(s,this.__instanceId),i.transform(this),this._cacheDirty=!1}},e.visit=function(e){this._isBaked?this._node._visible&&(this._syncStatus(e),cc.renderer.pushRenderCommand(this._bakeRenderCmd),this._bakeSprite._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._bakeSprite.visit(this),this._dirtyFlag=0):cc.Node.CanvasRenderCmd.prototype.visit.call(this)},e._getBoundingBoxForBake=function(){var e=this._node,t=cc.rect(0,0,e._contentSize.width,e._contentSize.height),i=e.getNodeToWorldTransform();if(t=cc.rectApplyAffineTransform(t,e.getNodeToWorldTransform()),!e._children||0===e._children.length)return t;for(var n=e._children,r=0;r<n.length;r++){var o=n[r];if(o&&o._visible){var s=o._getBoundingBoxToCurrentNode(i);t=cc.rectUnion(t,s)}}return t}}(),cc.LayerGradient.RenderCmd={updateStatus:function(){var e=cc.Node._dirtyFlags,t=this._dirtyFlag,i=t&e.colorDirty,n=t&e.opacityDirty;i&&this._updateDisplayColor(),n&&this._updateDisplayOpacity(),t&e.transformDirty&&this.transform(null,!0),(i||n||t&e.gradientDirty)&&this._updateColor(),this._dirtyFlag=0}},function(){cc.LayerGradient.CanvasRenderCmd=function(e){cc.LayerColor.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._startPoint=cc.p(0,0),this._endPoint=cc.p(0,0),this._startStopStr=null,this._endStopStr=null};var e=cc.LayerGradient.CanvasRenderCmd.prototype=Object.create(cc.LayerColor.CanvasRenderCmd.prototype);cc.inject(cc.LayerGradient.RenderCmd,e),e.constructor=cc.LayerGradient.CanvasRenderCmd,e.rendering=function(e,t,i){var n=e||cc._renderContext,r=n.getContext(),o=this._node,s=this._displayedOpacity/255;if(0!==s){var a=o._contentSize.width,c=o._contentSize.height;n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(s);var l=r.createLinearGradient(this._startPoint.x,this._startPoint.y,this._endPoint.x,this._endPoint.y);l.addColorStop(0,this._startStopStr),l.addColorStop(1,this._endStopStr),n.setFillStyle(l),n.setTransform(this._worldTransform,t,i),r.fillRect(0,0,a*t,-c*i),cc.g_NumberOfDraws++}},e._syncStatus=function(e){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e?e._node:null;n&&n._cascadeColorEnabled&&e._dirtyFlag&t.colorDirty&&(i|=t.colorDirty),n&&n._cascadeOpacityEnabled&&e._dirtyFlag&t.opacityDirty&&(i|=t.opacityDirty),e&&e._dirtyFlag&t.transformDirty&&(i|=t.transformDirty);var r=i&t.colorDirty,o=i&t.opacityDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),i&t.transformDirty&&this.transform(e),(r||o||i&t.gradientDirty)&&this._updateColor()},e._updateColor=function(){var e=this._node,t=e._contentSize,i=e._alongVector,n=.5*t.width,r=.5*t.height;this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.gradientDirty^this._dirtyFlag,this._startPoint.x=n*-i.x+n,this._startPoint.y=r*i.y-r,this._endPoint.x=n*i.x+n,this._endPoint.y=r*-i.y-r;var o=this._displayedColor,s=e._endColor,a=e._startOpacity/255,c=e._endOpacity/255;this._startStopStr="rgba("+Math.round(o.r)+","+Math.round(o.g)+","+Math.round(o.b)+","+a.toFixed(4)+")",this._endStopStr="rgba("+Math.round(s.r)+","+Math.round(s.g)+","+Math.round(s.b)+","+c.toFixed(4)+")"}}(),function(){cc.Layer.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e)};var e=cc.Layer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.Layer.WebGLRenderCmd,e.bake=function(){},e.unbake=function(){},e._bakeForAddChild=function(){}}(),function(){cc.LayerColor.WebGLRenderCmd=function(e){cc.Layer.WebGLRenderCmd.call(this,e),this._needDraw=!0;var t=this;t._squareVerticesAB=new ArrayBuffer(32),t._squareColorsAB=new ArrayBuffer(16);var i=t._squareVerticesAB,n=t._squareColorsAB,r=cc.Vertex2F.BYTES_PER_ELEMENT,o=cc.Color.BYTES_PER_ELEMENT;t._squareVertices=[new cc.Vertex2F(0,0,i,0),new cc.Vertex2F(0,0,i,r),new cc.Vertex2F(0,0,i,2*r),new cc.Vertex2F(0,0,i,3*r)],t._squareColors=[cc.color(0,0,0,255,n,0),cc.color(0,0,0,255,n,o),cc.color(0,0,0,255,n,2*o),cc.color(0,0,0,255,n,3*o)],t._verticesFloat32Buffer=cc._renderContext.createBuffer(),t._colorsUint8Buffer=cc._renderContext.createBuffer()};var e=cc.LayerColor.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);e.constructor=cc.LayerColor.WebGLRenderCmd,cc.LayerColor.WebGLRenderCmd.prototype.rendering=function(e){var t=e||cc._renderContext,i=this._node;this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR),cc.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),t.bindBuffer(t.ARRAY_BUFFER,this._verticesFloat32Buffer),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._colorsUint8Buffer),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,0,0),t.drawArrays(t.TRIANGLE_STRIP,0,4)},e._updateSquareVertices=function(e,t){var i=this._squareVertices;void 0===t?(i[1].x=e.width,i[2].y=e.height,i[3].x=e.width,i[3].y=e.height):(i[1].x=e,i[2].y=t,i[3].x=e,i[3].y=t),this._bindLayerVerticesBufferData()},e._updateSquareVerticesWidth=function(e){var t=this._squareVertices;t[1].x=e,t[3].x=e,this._bindLayerVerticesBufferData()},e._updateSquareVerticesHeight=function(e){var t=this._squareVertices;t[2].y=e,t[3].y=e,this._bindLayerVerticesBufferData()},e._updateColor=function(){for(var e=this._displayedColor,t=this._displayedOpacity,i=this._squareColors,n=0;n<4;n++)i[n].r=e.r,i[n].g=e.g,i[n].b=e.b,i[n].a=t;this._bindLayerColorsBufferData()},e._bindLayerVerticesBufferData=function(){var e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._verticesFloat32Buffer),e.bufferData(e.ARRAY_BUFFER,this._squareVerticesAB,e.STATIC_DRAW)},e._bindLayerColorsBufferData=function(){var e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._colorsUint8Buffer),e.bufferData(e.ARRAY_BUFFER,this._squareColorsAB,e.STATIC_DRAW)},e.updateBlendFunc=function(e){}}(),function(){cc.LayerGradient.WebGLRenderCmd=function(e){cc.LayerColor.WebGLRenderCmd.call(this,e),this._needDraw=!0};var e=cc.LayerGradient.WebGLRenderCmd.prototype=Object.create(cc.LayerColor.WebGLRenderCmd.prototype);cc.inject(cc.LayerGradient.RenderCmd,e),e.constructor=cc.LayerGradient.WebGLRenderCmd,e._syncStatus=function(e){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e?e._node:null;n&&n._cascadeColorEnabled&&e._dirtyFlag&t.colorDirty&&(i|=t.colorDirty),n&&n._cascadeOpacityEnabled&&e._dirtyFlag&t.opacityDirty&&(i|=t.opacityDirty),e&&e._dirtyFlag&t.transformDirty&&(i|=t.transformDirty);var r=i&t.colorDirty,o=i&t.opacityDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),this.transform(e),(r||o||i&t.gradientDirty)&&this._updateColor()},e._updateColor=function(){this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.gradientDirty^this._dirtyFlag;var e=this,t=this._node,i=t._alongVector,n=cc.pLength(i);if(0!==n){var r=Math.sqrt(2),o=cc.p(i.x/n,i.y/n);if(t._compressedInterpolation){var s=1/(Math.abs(o.x)+Math.abs(o.y));o=cc.pMult(o,s*r)}var a=e._displayedOpacity/255,c=e._displayedColor,l=t._endColor,u={r:c.r,g:c.g,b:c.b,a:t._startOpacity*a},h={r:l.r,g:l.g,b:l.b,a:t._endOpacity*a},d=e._squareColors,p=d[0],_=d[1],f=d[2],m=d[3];p.r=h.r+(u.r-h.r)*((r+o.x+o.y)/(2*r)),p.g=h.g+(u.g-h.g)*((r+o.x+o.y)/(2*r)),p.b=h.b+(u.b-h.b)*((r+o.x+o.y)/(2*r)),p.a=h.a+(u.a-h.a)*((r+o.x+o.y)/(2*r)),_.r=h.r+(u.r-h.r)*((r-o.x+o.y)/(2*r)),_.g=h.g+(u.g-h.g)*((r-o.x+o.y)/(2*r)),_.b=h.b+(u.b-h.b)*((r-o.x+o.y)/(2*r)),_.a=h.a+(u.a-h.a)*((r-o.x+o.y)/(2*r)),f.r=h.r+(u.r-h.r)*((r+o.x-o.y)/(2*r)),f.g=h.g+(u.g-h.g)*((r+o.x-o.y)/(2*r)),f.b=h.b+(u.b-h.b)*((r+o.x-o.y)/(2*r)),f.a=h.a+(u.a-h.a)*((r+o.x-o.y)/(2*r)),m.r=h.r+(u.r-h.r)*((r-o.x-o.y)/(2*r)),m.g=h.g+(u.g-h.g)*((r-o.x-o.y)/(2*r)),m.b=h.b+(u.b-h.b)*((r-o.x-o.y)/(2*r)),m.a=h.a+(u.a-h.a)*((r-o.x-o.y)/(2*r)),e._bindLayerColorsBufferData()}}}(),cc._tmp.PrototypeSprite=function(){var e=cc.Sprite.prototype;cc.defineGetterSetter(e,"opacityModifyRGB",e.isOpacityModifyRGB,e.setOpacityModifyRGB),cc.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity),cc.defineGetterSetter(e,"color",e.getColor,e.setColor),e.dirty,e.flippedX,cc.defineGetterSetter(e,"flippedX",e.isFlippedX,e.setFlippedX),e.flippedY,cc.defineGetterSetter(e,"flippedY",e.isFlippedY,e.setFlippedY),e.offsetX,cc.defineGetterSetter(e,"offsetX",e._getOffsetX),e.offsetY,cc.defineGetterSetter(e,"offsetY",e._getOffsetY),e.atlasIndex,e.texture,cc.defineGetterSetter(e,"texture",e.getTexture,e.setTexture),e.textureRectRotated,cc.defineGetterSetter(e,"textureRectRotated",e.isTextureRectRotated),e.textureAtlas,e.batchNode,cc.defineGetterSetter(e,"batchNode",e.getBatchNode,e.setBatchNode),e.quad,cc.defineGetterSetter(e,"quad",e.getQuad)},cc.Sprite=cc.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,_hasChildren:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(e,t,i){var n=this;cc.Node.prototype.ctor.call(n),n._shouldBeHidden=!1,n._offsetPosition=cc.p(0,0),n._unflippedOffsetPositionFromCenter=cc.p(0,0),n._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},n._rect=cc.rect(0,0,0,0),n._softInit(e,t,i)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},isDirty:function(){return this.dirty},setDirty:function(e){this.dirty=e},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(e){this.atlasIndex=e},getTextureRect:function(){return cc.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(e){this.textureAtlas=e},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(e){cc.assert(e,cc._LogInfos.Sprite_initWithSpriteFrame),e.textureLoaded()||(this._textureLoaded=!1,e.addEventListener("load",this._renderCmd._spriteFrameLoadedCallback,this));var t=cc._renderType!==cc._RENDER_TYPE_CANVAS&&e._rotated,i=this.initWithTexture(e.getTexture(),e.getRect(),t);return this.setSpriteFrame(e),i},initWithSpriteFrameName:function(e){cc.assert(e,cc._LogInfos.Sprite_initWithSpriteFrameName);var t=cc.spriteFrameCache.getSpriteFrame(e);return cc.assert(t,e+cc._LogInfos.Sprite_initWithSpriteFrameName1),this.initWithSpriteFrame(t)},useBatchNode:function(e){this.textureAtlas=e.getTextureAtlas(),this._batchNode=e},setVertexRect:function(e){var t=this._rect;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},sortAllChildren:function(){if(this._reorderChildDirty){var e,t,i,n=this._children,r=n.length;for(e=1;e<r;e++){for(i=n[e],t=e-1;t>=0;){if(i._localZOrder<n[t]._localZOrder)n[t+1]=n[t];else{if(!(i._localZOrder===n[t]._localZOrder&&i.arrivalOrder<n[t].arrivalOrder))break;n[t+1]=n[t]}t--}n[t+1]=i}this._batchNode&&this._arrayMakeObjectsPerformSelector(n,cc.Node._stateCallbackType.sortAllChildren),this._reorderChildDirty=!1}},reorderChild:function(e,t){cc.assert(e,cc._LogInfos.Sprite_reorderChild_2),-1!==this._children.indexOf(e)?t!==e.zIndex&&(this._batchNode&&!this._reorderChildDirty&&(this._setReorderChildDirtyRecursively(),this._batchNode.reorderBatch(!0)),cc.Node.prototype.reorderChild.call(this,e,t)):cc.log(cc._LogInfos.Sprite_reorderChild)},removeChild:function(e,t){this._batchNode&&this._batchNode.removeSpriteFromAtlas(e),cc.Node.prototype.removeChild.call(this,e,t)},setVisible:function(e){cc.Node.prototype.setVisible.call(this,e),this._renderCmd.setDirtyRecursively(!0)},removeAllChildren:function(e){var t=this._children,i=this._batchNode;if(i&&null!=t)for(var n=0,r=t.length;n<r;n++)i.removeSpriteFromAtlas(t[n]);cc.Node.prototype.removeAllChildren.call(this,e),this._hasChildren=!1},ignoreAnchorPointForPosition:function(e){this._batchNode?cc.log(cc._LogInfos.Sprite_ignoreAnchorPointForPosition):cc.Node.prototype.ignoreAnchorPointForPosition.call(this,e)},setFlippedX:function(e){this._flippedX!=e&&(this._flippedX=e,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(e){this._flippedY!=e&&(this._flippedY=e,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(e){this._opacityModifyRGB!==e&&(this._opacityModifyRGB=e,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(e,t){cc.assert(e,cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);var i=cc.animationCache.getAnimation(e);if(i){var n=i.getFrames()[t];n?this.setSpriteFrame(n.getSpriteFrame()):cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2)}else cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName)},getBatchNode:function(){return this._batchNode},_setReorderChildDirtyRecursively:function(){if(!this._reorderChildDirty){this._reorderChildDirty=!0;for(var e=this._parent;e&&e!=this._batchNode;)e._setReorderChildDirtyRecursively(),e=e.parent}},getTexture:function(){return this._texture},_softInit:function(e,t,i){if(void 0===e)cc.Sprite.prototype.init.call(this);else if(cc.isString(e))if("#"===e[0]){var n=e.substr(1,e.length-1),r=cc.spriteFrameCache.getSpriteFrame(n);this.initWithSpriteFrame(r)}else cc.Sprite.prototype.init.call(this,e,t);else if(cc.isObject(e))if(e instanceof cc.Texture2D)this.initWithTexture(e,t,i);else if(e instanceof cc.SpriteFrame)this.initWithSpriteFrame(e);else if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var o=new cc.Texture2D;o.initWithElement(e),o.handleLoadedTexture(),this.initWithTexture(o)}},getQuad:function(){return this._renderCmd.getQuad()},setBlendFunc:function(e,t){var i=this._blendFunc;void 0===t?(i.src=e.src,i.dst=e.dst):(i.src=e,i.dst=t),this._renderCmd.updateBlendFunc(i)},init:function(){var e=this;return arguments.length>0?e.initWithFile(arguments[0],arguments[1]):(cc.Node.prototype.init.call(e),e.dirty=e._recursiveDirty=!1,e._blendFunc.src=cc.BLEND_SRC,e._blendFunc.dst=cc.BLEND_DST,e.texture=null,e._flippedX=e._flippedY=!1,e.anchorX=.5,e.anchorY=.5,e._offsetPosition.x=0,e._offsetPosition.y=0,e._hasChildren=!1,this._renderCmd._init(),e.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0)),!0)},initWithFile:function(e,t){cc.assert(e,cc._LogInfos.Sprite_initWithFile);var i=cc.textureCache.getTextureForKey(e);if(i){if(!t){var n=i.getContentSize();t=cc.rect(0,0,n.width,n.height)}return this.initWithTexture(i,t)}return i=cc.textureCache.addImage(e),this.initWithTexture(i,t||cc.rect(0,0,i._contentSize.width,i._contentSize.height))},initWithTexture:function(e,t,i,n){var r=this;if(cc.assert(0!=arguments.length,cc._LogInfos.CCSpriteBatchNode_initWithTexture),i=i||!1,e=this._renderCmd._handleTextureForRotatedTexture(e,t,i,n),!cc.Node.prototype.init.call(r))return!1;r._batchNode=null,r._recursiveDirty=!1,r.dirty=!1,r._opacityModifyRGB=!0,r._blendFunc.src=cc.BLEND_SRC,r._blendFunc.dst=cc.BLEND_DST,r._flippedX=r._flippedY=!1,r.setAnchorPoint(.5,.5),r._offsetPosition.x=0,r._offsetPosition.y=0,r._hasChildren=!1,this._renderCmd._init();var o=e.isLoaded();return r._textureLoaded=o,o?(t||(t=cc.rect(0,0,e.width,e.height)),this._renderCmd._checkTextureBoundary(e,t,i),r.texture=e,r.setTextureRect(t,i),r.setBatchNode(null),!0):(r._rectRotated=i,t&&(r._rect.x=t.x,r._rect.y=t.y,r._rect.width=t.width,r._rect.height=t.height),r.texture&&r.texture.removeEventListener("load",r),e.addEventListener("load",r._renderCmd._textureLoadedCallback,r),r.texture=e,!0)},setTextureRect:function(e,t,i,n){var r=this;r._rectRotated=t||!1,r.setContentSize(i||e),r.setVertexRect(e),r._renderCmd._setTextureCoords(e,n);var o=r._unflippedOffsetPositionFromCenter;r._flippedX&&(o.x=-o.x),r._flippedY&&(o.y=-o.y);var s=r._rect;r._offsetPosition.x=o.x+(r._contentSize.width-s.width)/2,r._offsetPosition.y=o.y+(r._contentSize.height-s.height)/2,r._batchNode?r.dirty=!0:this._renderCmd._resetForBatchNode()},updateTransform:function(){this._renderCmd.updateTransform()},addChild:function(e,t,i){cc.assert(e,cc._LogInfos.CCSpriteBatchNode_addChild_2),null==t&&(t=e._localZOrder),null==i&&(i=e.tag),this._renderCmd._setBatchNodeForAddChild(e)&&(cc.Node.prototype.addChild.call(this,e,t,i),this._hasChildren=!0)},setSpriteFrame:function(e){var t=this;cc.isString(e)&&(e=cc.spriteFrameCache.getSpriteFrame(e),cc.assert(e,cc._LogInfos.Sprite_setSpriteFrame)),this.setNodeDirty(!0);var i=e.getOffset();t._unflippedOffsetPositionFromCenter.x=i.x,t._unflippedOffsetPositionFromCenter.y=i.y;var n=e.getTexture();e.textureLoaded()?(n!=t._texture&&(t.texture=n),t.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize())):(t._textureLoaded=!1,e.addEventListener("load",function(e){t._textureLoaded=!0;var i=e.getTexture();i!=t._texture&&(t.texture=i),t.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize()),t.dispatchEvent("load"),t.setColor(t.color)},t)),this._renderCmd._updateForSetSpriteFrame(n)},setDisplayFrame:function(e){cc.log(cc._LogInfos.Sprite_setDisplayFrame),this.setSpriteFrame(e)},isFrameDisplayed:function(e){return this._renderCmd.isFrameDisplayed(e)},displayFrame:function(){return new cc.SpriteFrame(this._texture,cc.rectPointsToPixels(this._rect),this._rectRotated,cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),cc.sizePointsToPixels(this._contentSize))},setBatchNode:function(e){var t=this;t._batchNode=e,t._batchNode?(t._transformToBatch=cc.affineTransformIdentity(),t.textureAtlas=t._batchNode.getTextureAtlas()):(t.atlasIndex=cc.Sprite.INDEX_NOT_INITIALIZED,t.textureAtlas=null,t._recursiveDirty=!1,t.dirty=!1,this._renderCmd._resetForBatchNode())},setTexture:function(e){if(!e)return this._renderCmd._setTexture(null);cc.isString(e)?(e=cc.textureCache.addImage(e))._textureLoaded?(this._renderCmd._setTexture(e),this._changeRectWithTexture(e.getContentSize()),this.setColor(this._realColor),this._textureLoaded=!0):e.addEventListener("load",function(){this._renderCmd._setTexture(e),this._changeRectWithTexture(e.getContentSize()),this.setColor(this._realColor),this._textureLoaded=!0},this):(cc.assert(e instanceof cc.Texture2D,cc._LogInfos.Sprite_setTexture_2),this._changeRectWithTexture(e.getContentSize()),this._renderCmd._setTexture(e))},_changeRectWithTexture:function(e){if(e&&(e.width||e.height)){var t=this.getTextureRect();t.height||t.width||(e.x=e.x||0,e.y=e.y||0,e.width=e.width||0,e.height=e.height||0,this.setTextureRect(e))}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Sprite.CanvasRenderCmd(this):new cc.Sprite.WebGLRenderCmd(this)}}),cc.Sprite.create=function(e,t,i){return new cc.Sprite(e,t,i)},cc.Sprite.createWithTexture=cc.Sprite.create,cc.Sprite.createWithSpriteFrameName=cc.Sprite.create,cc.Sprite.createWithSpriteFrame=cc.Sprite.create,cc.Sprite.INDEX_NOT_INITIALIZED=-1,cc.EventHelper.prototype.apply(cc.Sprite.prototype),cc.assert(cc.isFunction(cc._tmp.PrototypeSprite),cc._LogInfos.MissingFile,"SpritesPropertyDefine.js"),cc._tmp.PrototypeSprite(),delete cc._tmp.PrototypeSprite,function(){cc.Sprite.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1},this._blendFuncStr="source-over",this._colorized=!1,this._originalTexture=null};var e=cc.Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.Sprite.CanvasRenderCmd,e._init=function(){},e._setBlendFuncStr=function(e){this._blendFuncStr=e},e.setDirtyRecursively=function(e){},e._resetForBatchNode=function(){},e._setTexture=function(e){var t=this._node;t._texture!=e&&(e?(e.getHtmlElementObj()instanceof HTMLImageElement&&(this._originalTexture=e),t._textureLoaded=e._textureLoaded):t._textureLoaded=!1,t._texture=e)},e._setColorDirty=function(){this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty)},e.isFrameDisplayed=function(e){var t=this._node;return e.getTexture()==t._texture&&cc.rectEqualToRect(e.getRect(),t._rect)},e.updateBlendFunc=function(e){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(e)},e._setBatchNodeForAddChild=function(e){return!0},e._handleTextureForRotatedTexture=function(e,t,i,n){if(i&&e.isLoaded()){var r=e.getHtmlElementObj();r=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(r,t,n);var o=new cc.Texture2D;o.initWithElement(r),o.handleLoadedTexture(),e=o,t.x=t.y=0,this._node._rect=cc.rect(0,0,t.width,t.height)}return e},e._checkTextureBoundary=function(e,t,i){if(e&&e.url){var n=t.x+t.width,r=t.y+t.height;n>e.width&&cc.error(cc._LogInfos.RectWidth,e.url),r>e.height&&cc.error(cc._LogInfos.RectHeight,e.url)}this._node._originalTexture=e},e.rendering=function(e,t,i){var n=this._node,r=this._textureCoord,o=this._displayedOpacity/255;if((!n._texture||0!==r.width&&0!==r.height&&n._texture._textureLoaded)&&0!==o){var s,a=e||cc._renderContext,c=a.getContext(),l=n._offsetPosition.x,u=n._rect.height,h=n._rect.width,d=-n._offsetPosition.y-u;if(a.setTransform(this._worldTransform,t,i),a.setCompositeOperation(this._blendFuncStr),a.setGlobalAlpha(o),(n._flippedX||n._flippedY)&&a.save(),n._flippedX&&(l=-l-h,c.scale(-1,1)),n._flippedY&&(d=n._offsetPosition.y,c.scale(1,-1)),n._texture)s=n._texture._htmlElementObj,""!=n._texture._pattern?(a.setFillStyle(c.createPattern(s,n._texture._pattern)),c.fillRect(l*t,d*i,h*t,u*i)):this._colorized?c.drawImage(s,0,0,r.width,r.height,l*t,d*i,h*t,u*i):c.drawImage(s,r.renderX,r.renderY,r.width,r.height,l*t,d*i,h*t,u*i);else{var p=n._contentSize;if(r.validRect){var _=this._displayedColor;a.setFillStyle("rgba("+_.r+","+_.g+","+_.b+",1)"),c.fillRect(l*t,d*i,p.width*t,p.height*i)}}(n._flippedX||n._flippedY)&&a.restore(),cc.g_NumberOfDraws++}},cc.sys._supportCanvasNewBlendModes?e._updateColor=function(){var e=this._node,t=this._displayedColor;if(255!==t.r||255!==t.g||255!==t.b){var i,n=e._texture,r=this._textureCoord;if(n&&r.validRect&&this._originalTexture){if(!(i=n.getHtmlElementObj()))return;this._colorized=!0,i instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor&&this._originalTexture._htmlElementObj!=i?cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,t,r,i):(i=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,t,r),(n=new cc.Texture2D).initWithElement(i),n.handleLoadedTexture(),e.texture=n)}}else this._colorized&&(this._colorized=!1,e.texture=this._originalTexture)}:e._updateColor=function(){var e=this._node,t=this._displayedColor;if(255!==t.r||255!==t.g||255!==t.b){var i,n=e._texture,r=this._textureCoord;if(n&&r.validRect&&this._originalTexture){if(!(i=n.getHtmlElementObj()))return;var o=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());o&&(this._colorized=!0,i instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor?cc.Sprite.CanvasRenderCmd._generateTintImage(i,o,t,r,i):(i=cc.Sprite.CanvasRenderCmd._generateTintImage(i,o,t,r),(n=new cc.Texture2D).initWithElement(i),n.handleLoadedTexture(),e.texture=n))}}else this._colorized&&(this._colorized=!1,e.texture=this._originalTexture)},e.getQuad=function(){return null},e._updateForSetSpriteFrame=function(e,t){var i=this._node;if(i._rectRotated&&(i._originalTexture=e),this._colorized=!1,this._textureCoord.renderX=this._textureCoord.x,this._textureCoord.renderY=this._textureCoord.y,t){var n=i.getColor();255===n.r&&255===n.g&&255===n.b||this._updateColor()}},e.updateTransform=function(){var e=this,t=this._node;if(t.dirty){var i=t._parent;!t._visible||i&&i!=t._batchNode&&i._shouldBeHidden?t._shouldBeHidden=!0:(t._shouldBeHidden=!1,i&&i!=t._batchNode?t._transformToBatch=cc.affineTransformConcat(e.getNodeToParentTransform(),i._transformToBatch):t._transformToBatch=e.getNodeToParentTransform()),t._recursiveDirty=!1,t.dirty=!1}t._hasChildren&&t._arrayMakeObjectsPerformSelector(t._children,cc.Node._stateCallbackType.updateTransform)},e._updateDisplayColor=function(e){cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(this,e)},e._spriteFrameLoadedCallback=function(e){var t=this;t.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize()),t._renderCmd._updateColor(),t.dispatchEvent("load")},e._textureLoadedCallback=function(e){var t=this;if(!t._textureLoaded){t._textureLoaded=!0;var i=t._rect,n=this._renderCmd;i?cc._rectEqualToZero(i)&&(i.width=e.width,i.height=e.height):i=cc.rect(0,0,e.width,e.height),n._originalTexture=e,t.texture=e,t.setTextureRect(i,t._rectRotated);var r=n._displayedColor;255==r.r&&255==r.g&&255==r.b||n._updateColor(),t.setBatchNode(t._batchNode),t.dispatchEvent("load")}},e._setTextureCoords=function(e,t){void 0===t&&(t=!0);var i=this._textureCoord,n=t?cc.contentScaleFactor():1;i.renderX=i.x=0|e.x*n,i.renderY=i.y=0|e.y*n,i.width=0|e.width*n,i.height=0|e.height*n,i.validRect=!(0===i.width||0===i.height||i.x<0||i.y<0),this._colorized&&(this._node._texture=this._originalTexture,this._colorized=!1,this._updateColor())},cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply=function(e,t,i,n){n=n||cc.newElement("canvas"),i=i||cc.rect(0,0,e.width,e.height);var r=n.getContext("2d");return n.width!=i.width||n.height!=i.height?(n.width=i.width,n.height=i.height):r.globalCompositeOperation="source-over",r.fillStyle="rgb("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+")",r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="multiply",r.drawImage(e,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(e,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n},cc.Sprite.CanvasRenderCmd._generateTintImage=function(e,t,i,n,r){n||(n=cc.rect(0,0,e.width,e.height));var o,s=i.r/255,a=i.g/255,c=i.b/255,l=Math.min(n.width,t[0].width),u=Math.min(n.height,t[0].height),h=r;h?(o=h.getContext("2d")).clearRect(0,0,l,u):((h=cc.newElement("canvas")).width=l,h.height=u,o=h.getContext("2d")),o.save(),o.globalCompositeOperation="lighter";var d=o.globalAlpha;return s>0&&(o.globalAlpha=s*d,o.drawImage(t[0],n.x,n.y,l,u,0,0,l,u)),a>0&&(o.globalAlpha=a*d,o.drawImage(t[1],n.x,n.y,l,u,0,0,l,u)),c>0&&(o.globalAlpha=c*d,o.drawImage(t[2],n.x,n.y,l,u,0,0,l,u)),s+a+c<1&&(o.globalAlpha=d,o.drawImage(t[3],n.x,n.y,l,u,0,0,l,u)),o.restore(),h},cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor=function(e){function t(){var t=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor,n=e.width,r=e.height;i[0].width=n,i[0].height=r,i[1].width=n,i[1].height=r,i[2].width=n,i[2].height=r,i[3].width=n,i[3].height=r,t.canvas.width=n,t.canvas.height=r;var o=t.canvas.getContext("2d");o.drawImage(e,0,0),t.tempCanvas.width=n,t.tempCanvas.height=r;for(var s=o.getImageData(0,0,n,r).data,a=0;a<4;a++){var c=i[a].getContext("2d");c.getImageData(0,0,n,r).data,t.tempCtx.drawImage(e,0,0);for(var l=t.tempCtx.getImageData(0,0,n,r),u=l.data,h=0;h<s.length;h+=4)u[h]=0===a?s[h]:0,u[h+1]=1===a?s[h+1]:0,u[h+2]=2===a?s[h+2]:0,u[h+3]=s[h+3];c.putImageData(l,0,0)}e.onload=null}if(e.channelCache)return e.channelCache;var i=[cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas")];try{t()}catch(i){e.onload=t}return e.channelCache=i,i},cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.canvas=cc.newElement("canvas"),cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas=cc.newElement("canvas"),cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCtx=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas.getContext("2d"),cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=function(e,t,i){if(!e)return null;if(!t)return e;i=null==i||i;var n=cc.newElement("canvas");n.width=t.width,n.height=t.height;var r=n.getContext("2d");return r.translate(n.width/2,n.height/2),i?r.rotate(-1.5707963267948966):r.rotate(1.5707963267948966),r.drawImage(e,t.x,t.y,t.height,t.width,-t.height/2,-t.width/2,t.height,t.width),n}}(),function(){cc.Sprite.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._quad=new cc.V3F_C4B_T2F_Quad,this._quadWebBuffer=cc._renderContext.createBuffer(),this._quadDirty=!0,this._dirty=!1,this._recursiveDirty=!1};var e=cc.Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.Sprite.WebGLRenderCmd,e.updateBlendFunc=function(e){},e.setDirtyFlag=function(e){cc.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this,e),this._dirty=!0},e.setDirtyRecursively=function(e){this._recursiveDirty=e,this._dirty=e;for(var t,i=this._node._children,n=i?i.length:0,r=0;r<n;r++)(t=i[r])instanceof cc.Sprite&&t._renderCmd.setDirtyRecursively(e)},e._setBatchNodeForAddChild=function(e){var t=this._node;if(t._batchNode){if(!(e instanceof cc.Sprite))return cc.log(cc._LogInfos.Sprite_addChild),!1;e.texture._webTextureObj!==t.textureAtlas.texture._webTextureObj&&cc.log(cc._LogInfos.Sprite_addChild_2),t._batchNode.appendChild(e),t._reorderChildDirty||t._setReorderChildDirtyRecursively()}return!0},e._handleTextureForRotatedTexture=function(e){return e},e.isFrameDisplayed=function(e){var t=this._node;return cc.rectEqualToRect(e.getRect(),t._rect)&&e.getTexture().getName()==t._texture.getName()&&cc.pointEqualToPoint(e.getOffset(),t._unflippedOffsetPositionFromCenter)},e._init=function(){var e={r:255,g:255,b:255,a:255},t=this._quad;t.bl.colors=e,t.br.colors=e,t.tl.colors=e,t.tr.colors=e,this._quadDirty=!0},e._resetForBatchNode=function(){var e=this._node,t=e._offsetPosition.x,i=e._offsetPosition.y,n=t+e._rect.width,r=i+e._rect.height,o=this._quad;o.bl.vertices={x:t,y:i,z:0},o.br.vertices={x:n,y:i,z:0},o.tl.vertices={x:t,y:r,z:0},o.tr.vertices={x:n,y:r,z:0},this._quadDirty=!0},e.getQuad=function(){return this._quad},e._updateForSetSpriteFrame=function(){},e._spriteFrameLoadedCallback=function(e){this.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize()),this.dispatchEvent("load")},e._textureLoadedCallback=function(e){var t=this._renderCmd;if(!this._textureLoaded){this._textureLoaded=!0;var i=this._rect;i?cc._rectEqualToZero(i)&&(i.width=e.width,i.height=e.height):i=cc.rect(0,0,e.width,e.height),this.texture=e,this.setTextureRect(i,this._rectRotated),this.setBatchNode(this._batchNode),t._quadDirty=!0,this.dispatchEvent("load")}},e._setTextureCoords=function(e,t){void 0===t&&(t=!0),t&&(e=cc.rectPointsToPixels(e));var i=this._node,n=i._batchNode?i.textureAtlas.texture:i._texture;if(n){var r,o,s,a,c,l=n.pixelsWidth,u=n.pixelsHeight,h=this._quad;i._rectRotated?(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(o=(r=(2*e.x+1)/(2*l))+(2*e.height-2)/(2*l),a=(s=(2*e.y+1)/(2*u))+(2*e.width-2)/(2*u)):(r=e.x/l,o=(e.x+e.height)/l,s=e.y/u,a=(e.y+e.width)/u),i._flippedX&&(c=s,s=a,a=c),i._flippedY&&(c=r,r=o,o=c),h.bl.texCoords.u=r,h.bl.texCoords.v=s,h.br.texCoords.u=r,h.br.texCoords.v=a,h.tl.texCoords.u=o,h.tl.texCoords.v=s,h.tr.texCoords.u=o,h.tr.texCoords.v=a):(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(o=(r=(2*e.x+1)/(2*l))+(2*e.width-2)/(2*l),a=(s=(2*e.y+1)/(2*u))+(2*e.height-2)/(2*u)):(r=e.x/l,o=(e.x+e.width)/l,s=e.y/u,a=(e.y+e.height)/u),i._flippedX&&(c=r,r=o,o=c),i._flippedY&&(c=s,s=a,a=c),h.bl.texCoords.u=r,h.bl.texCoords.v=a,h.br.texCoords.u=o,h.br.texCoords.v=a,h.tl.texCoords.u=r,h.tl.texCoords.v=s,h.tr.texCoords.u=o,h.tr.texCoords.v=s),this._quadDirty=!0}},e.transform=function(e,t){cc.Node.WebGLRenderCmd.prototype.transform.call(this,e,t),this._dirty=!0},e._setColorDirty=function(){},e._updateColor=function(){var e=this._displayedColor,t=this._displayedOpacity,i=this._node,n={r:e.r,g:e.g,b:e.b,a:t};i._opacityModifyRGB&&(n.r*=t/255,n.g*=t/255,n.b*=t/255);var r=this._quad;r.bl.colors=n,r.br.colors=n,r.tl.colors=n,r.tr.colors=n,i._batchNode&&(i.atlasIndex!=cc.Sprite.INDEX_NOT_INITIALIZED?i.textureAtlas.updateQuad(r,i.atlasIndex):this._dirty=!0),this._quadDirty=!0},e._updateBlendFunc=function(){if(this._batchNode)cc.log(cc._LogInfos.Sprite__updateBlendFunc);else{var e=this._node;e._texture&&e._texture.hasPremultipliedAlpha()?(e._blendFunc.src=cc.BLEND_SRC,e._blendFunc.dst=cc.BLEND_DST,e.opacityModifyRGB=!0):(e._blendFunc.src=cc.SRC_ALPHA,e._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA,e.opacityModifyRGB=!1)}},e._setTexture=function(e){var t=this._node;if(t._batchNode){if(t._batchNode.texture!=e)return void cc.log(cc._LogInfos.Sprite_setTexture)}else t._texture!=e&&(t._textureLoaded=!!e&&e._textureLoaded,t._texture=e,this._updateBlendFunc());this._shaderProgram=e?cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR):cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR)},e.updateTransform=function(){var e=this,t=this._node;if(this._dirty){var i=e._quad,n=t._parent;if(!t._visible||n&&n!=t._batchNode&&n._shouldBeHidden)i.br.vertices=i.tl.vertices=i.tr.vertices=i.bl.vertices={x:0,y:0,z:0},t._shouldBeHidden=!0;else{t._shouldBeHidden=!1,0!==this._dirtyFlag&&(this.updateStatus(),this._dirtyFlag=0),n&&n!=t._batchNode?t._transformToBatch=cc.affineTransformConcat(e.getNodeToParentTransform(),n._transformToBatch):t._transformToBatch=e.getNodeToParentTransform();var r=t._transformToBatch,o=t._rect,s=t._offsetPosition.x,a=t._offsetPosition.y,c=s+o.width,l=a+o.height,u=r.tx,h=r.ty,d=r.a,p=r.b,_=r.d,f=-r.c,m=s*d-a*f+u,g=s*p+a*_+h,y=c*d-a*f+u,T=c*p+a*_+h,v=c*d-l*f+u,S=c*p+l*_+h,C=s*d-l*f+u,E=s*p+l*_+h,b=t._vertexZ;cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(m|=0,g|=0,y|=0,T|=0,v|=0,S|=0,C|=0,E|=0),i.bl.vertices={x:m,y:g,z:b},i.br.vertices={x:y,y:T,z:b},i.tl.vertices={x:C,y:E,z:b},i.tr.vertices={x:v,y:S,z:b}}t.textureAtlas.updateQuad(i,t.atlasIndex),t._recursiveDirty=!1,this._dirty=!1}t._hasChildren&&t._arrayMakeObjectsPerformSelector(t._children,cc.Node._stateCallbackType.updateTransform)},e._checkTextureBoundary=function(e,t,i){if(e&&e.url){var n,r;i?(n=t.x+t.height,r=t.y+t.width):(n=t.x+t.width,r=t.y+t.height),n>e.width&&cc.error(cc._LogInfos.RectWidth,e.url),r>e.height&&cc.error(cc._LogInfos.RectHeight,e.url)}},e.rendering=function(e){var t=this._node,i=t._texture;if((!i||i._textureLoaded)&&0!==this._displayedOpacity){var n=e||cc._renderContext;if(i?i._textureLoaded&&(this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),cc.glBindTexture2DN(0,i),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),n.bindBuffer(n.ARRAY_BUFFER,this._quadWebBuffer),this._quadDirty&&(n.bufferData(n.ARRAY_BUFFER,this._quad.arrayBuffer,n.DYNAMIC_DRAW),this._quadDirty=!1),n.vertexAttribPointer(0,3,n.FLOAT,!1,24,0),n.vertexAttribPointer(1,4,n.UNSIGNED_BYTE,!0,24,12),n.vertexAttribPointer(2,2,n.FLOAT,!1,24,16),n.drawArrays(n.TRIANGLE_STRIP,0,4)):(this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),cc.glBindTexture2D(null),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR),n.bindBuffer(n.ARRAY_BUFFER,this._quadWebBuffer),this._quadDirty&&(n.bufferData(n.ARRAY_BUFFER,this._quad.arrayBuffer,n.STATIC_DRAW),this._quadDirty=!1),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,24,0),n.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,n.UNSIGNED_BYTE,!0,24,12),n.drawArrays(n.TRIANGLE_STRIP,0,4)),cc.g_NumberOfDraws++,0!==cc.SPRITE_DEBUG_DRAW||t._showNode){if(cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.current_stack.stack.push(cc.current_stack.top),cc.current_stack.top=this._stackMatrix,1===cc.SPRITE_DEBUG_DRAW||t._showNode){var r=this._quad,o=[cc.p(r.tl.vertices.x,r.tl.vertices.y),cc.p(r.bl.vertices.x,r.bl.vertices.y),cc.p(r.br.vertices.x,r.br.vertices.y),cc.p(r.tr.vertices.x,r.tr.vertices.y)];cc._drawingUtil.drawPoly(o,4,!0)}else if(2===cc.SPRITE_DEBUG_DRAW){var s=t.getTextureRect(),a=t.getOffsetPosition(),c=[cc.p(a.x,a.y),cc.p(a.x+s.width,a.y),cc.p(a.x+s.width,a.y+s.height),cc.p(a.x,a.y+s.height)];cc._drawingUtil.drawPoly(c,4,!0)}cc.current_stack.top=cc.current_stack.stack.pop()}}}}(),cc.BakeSprite=cc.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);var e=document.createElement("canvas");e.width=e.height=10,this._cacheCanvas=e,this._cacheContext=new cc.CanvasContextWrapper(e.getContext("2d"));var t=new cc.Texture2D;t.initWithElement(e),t.handleLoadedTexture(),this.setTexture(t)},getCacheContext:function(){return this._cacheContext},getCacheCanvas:function(){return this._cacheCanvas},resetCanvasSize:function(e,t){void 0===t&&(t=e.height,e=e.width);var i=this._cacheCanvas;i.width=e,i.height=t,this.getTexture().handleLoadedTexture(),this.setTextureRect(cc.rect(0,0,e,t),!1)}}),cc.AnimationFrame=cc.Class.extend({_spriteFrame:null,_delayPerUnit:0,_userInfo:null,ctor:function(e,t,i){this._spriteFrame=e||null,this._delayPerUnit=t||0,this._userInfo=i||null},clone:function(){var e=new cc.AnimationFrame;return e.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),e},copyWithZone:function(e){return cc.clone(this)},copy:function(e){var t=new cc.AnimationFrame;return t.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),t},initWithSpriteFrame:function(e,t,i){return this._spriteFrame=e,this._delayPerUnit=t,this._userInfo=i,!0},getSpriteFrame:function(){return this._spriteFrame},setSpriteFrame:function(e){this._spriteFrame=e},getDelayUnits:function(){return this._delayPerUnit},setDelayUnits:function(e){this._delayPerUnit=e},getUserInfo:function(){return this._userInfo},setUserInfo:function(e){this._userInfo=e}}),cc.AnimationFrame.create=function(e,t,i){return new cc.AnimationFrame(e,t,i)},cc.Animation=cc.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:!1,_duration:0,_delayPerUnit:0,_totalDelayUnits:0,ctor:function(e,t,i){if(this._frames=[],void 0===e)this.initWithSpriteFrames(null,0);else{var n=e[0];n&&(n instanceof cc.SpriteFrame?this.initWithSpriteFrames(e,t,i):n instanceof cc.AnimationFrame&&this.initWithAnimationFrames(e,t,i))}},getFrames:function(){return this._frames},setFrames:function(e){this._frames=e},addSpriteFrame:function(e){var t=new cc.AnimationFrame;t.initWithSpriteFrame(e,1,null),this._frames.push(t),this._totalDelayUnits++},addSpriteFrameWithFile:function(e){var t=cc.textureCache.addImage(e),i=cc.rect(0,0,0,0);i.width=t.width,i.height=t.height;var n=new cc.SpriteFrame(t,i);this.addSpriteFrame(n)},addSpriteFrameWithTexture:function(e,t){var i=new cc.SpriteFrame(e,t);this.addSpriteFrame(i)},initWithAnimationFrames:function(e,t,i){cc.arrayVerifyType(e,cc.AnimationFrame),this._delayPerUnit=t,this._loops=void 0===i?1:i,this._totalDelayUnits=0;var n=this._frames;n.length=0;for(var r=0;r<e.length;r++){var o=e[r];n.push(o),this._totalDelayUnits+=o.getDelayUnits()}return!0},clone:function(){var e=new cc.Animation;return e.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),e.setRestoreOriginalFrame(this._restoreOriginalFrame),e},copyWithZone:function(e){var t=new cc.Animation;return t.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),t.setRestoreOriginalFrame(this._restoreOriginalFrame),t},_copyFrames:function(){for(var e=[],t=0;t<this._frames.length;t++)e.push(this._frames[t].clone());return e},copy:function(e){return this.copyWithZone(null)},getLoops:function(){return this._loops},setLoops:function(e){this._loops=e},setRestoreOriginalFrame:function(e){this._restoreOriginalFrame=e},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame},getDuration:function(){return this._totalDelayUnits*this._delayPerUnit},getDelayPerUnit:function(){return this._delayPerUnit},setDelayPerUnit:function(e){this._delayPerUnit=e},getTotalDelayUnits:function(){return this._totalDelayUnits},initWithSpriteFrames:function(e,t,i){cc.arrayVerifyType(e,cc.SpriteFrame),this._loops=void 0===i?1:i,this._delayPerUnit=t||0,this._totalDelayUnits=0;var n=this._frames;if(n.length=0,e){for(var r=0;r<e.length;r++){var o=e[r],s=new cc.AnimationFrame;s.initWithSpriteFrame(o,1,null),n.push(s)}this._totalDelayUnits+=e.length}return!0},retain:function(){},release:function(){}}),cc.Animation.create=function(e,t,i){return new cc.Animation(e,t,i)},cc.Animation.createWithAnimationFrames=cc.Animation.create,cc.animationCache={_animations:{},addAnimation:function(e,t){this._animations[t]=e},removeAnimation:function(e){e&&this._animations[e]&&delete this._animations[e]},getAnimation:function(e){return this._animations[e]?this._animations[e]:null},_addAnimationsWithDictionary:function(e,t){var i=e.animations;if(i){var n=1,r=e.properties;if(r){n=null!=r.format?parseInt(r.format):n;for(var o=r.spritesheets,s=cc.spriteFrameCache,a=cc.path,c=0;c<o.length;c++)s.addSpriteFrames(a.changeBasename(t,o[c]))}switch(n){case 1:this._parseVersion1(i);break;case 2:this._parseVersion2(i);break;default:cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2)}}else cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary)},addAnimations:function(e){cc.assert(e,cc._LogInfos.animationCache_addAnimations_2);var t=cc.loader.getRes(e);t?this._addAnimationsWithDictionary(t,e):cc.log(cc._LogInfos.animationCache_addAnimations)},_parseVersion1:function(e){var t=cc.spriteFrameCache;for(var i in e){var n=e[i],r=n.frames,o=parseFloat(n.delay)||0,s=null;if(r){for(var a=[],c=0;c<r.length;c++){var l=t.getSpriteFrame(r[c]);if(l){var u=new cc.AnimationFrame;u.initWithSpriteFrame(l,1,null),a.push(u)}else cc.log(cc._LogInfos.animationCache__parseVersion1_2,i,r[c])}0!==a.length?(a.length!=r.length&&cc.log(cc._LogInfos.animationCache__parseVersion1_4,i),s=new cc.Animation(a,o,1),cc.animationCache.addAnimation(s,i)):cc.log(cc._LogInfos.animationCache__parseVersion1_3,i)}else cc.log(cc._LogInfos.animationCache__parseVersion1,i)}},_parseVersion2:function(e){var t=cc.spriteFrameCache;for(var i in e){var n=e[i],r=n.loop,o=parseInt(n.loops),s=r?cc.REPEAT_FOREVER:isNaN(o)?1:o,a=!(!n.restoreOriginalFrame||1!=n.restoreOriginalFrame),c=n.frames;if(c){for(var l=[],u=0;u<c.length;u++){var h=c[u],d=h.spriteframe,p=t.getSpriteFrame(d);if(p){var _=parseFloat(h.delayUnits)||0,f=h.notification,m=new cc.AnimationFrame;m.initWithSpriteFrame(p,_,f),l.push(m)}else cc.log(cc._LogInfos.animationCache__parseVersion2_2,i,d)}var g=parseFloat(n.delayPerUnit)||0,y=new cc.Animation;y.initWithAnimationFrames(l,g,s),y.setRestoreOriginalFrame(a),cc.animationCache.addAnimation(y,i)}else cc.log(cc._LogInfos.animationCache__parseVersion2,i)}},_clear:function(){this._animations={}}},cc.SpriteFrame=cc.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:!1,_rect:null,_offsetInPixels:null,_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:!1,ctor:function(e,t,i,n,r){this._offset=cc.p(0,0),this._offsetInPixels=cc.p(0,0),this._originalSize=cc.size(0,0),this._rotated=!1,this._originalSizeInPixels=cc.size(0,0),this._textureFilename="",this._texture=null,this._textureLoaded=!1,void 0!==e&&void 0!==t&&(void 0===i||void 0===n||void 0===r?this.initWithTexture(e,t):this.initWithTexture(e,t,i,n,r))},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},getRectInPixels:function(){var e=this._rectInPixels;return cc.rect(e.x,e.y,e.width,e.height)},setRectInPixels:function(e){this._rectInPixels||(this._rectInPixels=cc.rect(0,0,0,0)),this._rectInPixels.x=e.x,this._rectInPixels.y=e.y,this._rectInPixels.width=e.width,this._rectInPixels.height=e.height,this._rect=cc.rectPixelsToPoints(e)},isRotated:function(){return this._rotated},setRotated:function(e){this._rotated=e},getRect:function(){var e=this._rect;return cc.rect(e.x,e.y,e.width,e.height)},setRect:function(e){this._rect||(this._rect=cc.rect(0,0,0,0)),this._rect.x=e.x,this._rect.y=e.y,this._rect.width=e.width,this._rect.height=e.height,this._rectInPixels=cc.rectPointsToPixels(this._rect)},getOffsetInPixels:function(){return cc.p(this._offsetInPixels)},setOffsetInPixels:function(e){this._offsetInPixels.x=e.x,this._offsetInPixels.y=e.y,cc._pointPixelsToPointsOut(this._offsetInPixels,this._offset)},getOriginalSizeInPixels:function(){return cc.size(this._originalSizeInPixels)},setOriginalSizeInPixels:function(e){this._originalSizeInPixels.width=e.width,this._originalSizeInPixels.height=e.height},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(e){this._originalSize.width=e.width,this._originalSize.height=e.height},getTexture:function(){if(this._texture)return this._texture;if(""!==this._textureFilename){var e=cc.textureCache.addImage(this._textureFilename);return e&&(this._textureLoaded=e.isLoaded()),e}return null},setTexture:function(e){if(this._texture!=e){var t=e.isLoaded();this._textureLoaded=t,this._texture=e,t||e.addEventListener("load",function(e){if(this._textureLoaded=!0,this._rotated&&cc._renderType===cc._RENDER_TYPE_CANVAS){var t=e.getHtmlElementObj();t=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(t,this.getRect());var i=new cc.Texture2D;i.initWithElement(t),i.handleLoadedTexture(),this.setTexture(i);var n=this.getRect();this.setRect(cc.rect(0,0,n.width,n.height))}var r=this._rect;if(0===r.width&&0===r.height){var o=e.width,s=e.height;this._rect.width=o,this._rect.height=s,this._rectInPixels=cc.rectPointsToPixels(this._rect),this._originalSizeInPixels.width=this._rectInPixels.width,this._originalSizeInPixels.height=this._rectInPixels.height,this._originalSize.width=o,this._originalSize.height=s}this.dispatchEvent("load")},this)}},getOffset:function(){return cc.p(this._offset)},setOffset:function(e){this._offset.x=e.x,this._offset.y=e.y},clone:function(){var e=new cc.SpriteFrame;return e.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),e.setTexture(this._texture),e},copyWithZone:function(){var e=new cc.SpriteFrame;return e.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),e.setTexture(this._texture),e},copy:function(){return this.copyWithZone()},initWithTexture:function(e,t,i,n,r){if(2===arguments.length&&(t=cc.rectPointsToPixels(t)),n=n||cc.p(0,0),r=r||t,i=i||!1,cc.isString(e)?(this._texture=null,this._textureFilename=e):e instanceof cc.Texture2D&&this.setTexture(e),e=this.getTexture(),this._rectInPixels=t,t=this._rect=cc.rectPixelsToPoints(t),e&&e.url&&e.isLoaded()){var o,s;i?(o=t.x+t.height,s=t.y+t.width):(o=t.x+t.width,s=t.y+t.height),o>e.getPixelsWide()&&cc.error(cc._LogInfos.RectWidth,e.url),s>e.getPixelsHigh()&&cc.error(cc._LogInfos.RectHeight,e.url)}return this._offsetInPixels.x=n.x,this._offsetInPixels.y=n.y,cc._pointPixelsToPointsOut(n,this._offset),this._originalSizeInPixels.width=r.width,this._originalSizeInPixels.height=r.height,cc._sizePixelsToPointsOut(r,this._originalSize),this._rotated=i,!0}}),cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype),cc.SpriteFrame.create=function(e,t,i,n,r){return new cc.SpriteFrame(e,t,i,n,r)},cc.SpriteFrame.createWithTexture=cc.SpriteFrame.create,cc.SpriteFrame._frameWithTextureForCanvas=function(e,t,i,n,r){var o=new cc.SpriteFrame;return o._texture=e,o._rectInPixels=t,o._rect=cc.rectPixelsToPoints(t),o._offsetInPixels.x=n.x,o._offsetInPixels.y=n.y,cc._pointPixelsToPointsOut(o._offsetInPixels,o._offset),o._originalSizeInPixels.width=r.width,o._originalSizeInPixels.height=r.height,cc._sizePixelsToPointsOut(o._originalSizeInPixels,o._originalSize),o._rotated=i,o},cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(e){var t=this._CCNS_REG2.exec(e);return t?cc.rect(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])):cc.rect(0,0,0,0)},_pointFromString:function(e){var t=this._CCNS_REG1.exec(e);return t?cc.p(parseFloat(t[1]),parseFloat(t[2])):cc.p(0,0)},_sizeFromString:function(e){var t=this._CCNS_REG1.exec(e);return t?cc.size(parseFloat(t[1]),parseFloat(t[2])):cc.size(0,0)},_getFrameConfig:function(e){var t=cc.loader.getRes(e);if(cc.assert(t,cc._LogInfos.spriteFrameCache__getFrameConfig_2,e),cc.loader.release(e),t._inited)return this._frameConfigCache[e]=t,t;var i=t.frames,n=t.metadata||t.meta,r={},o={},s=0;if(n){var a=n.format;s=a.length<=1?parseInt(a):a,o.image=n.textureFileName||n.textureFileName||n.image}for(var c in i){var l=i[c];if(l){var u={};if(0==s){u.rect=cc.rect(l.x,l.y,l.width,l.height),u.rotated=!1,u.offset=cc.p(l.offsetX,l.offsetY);var h=l.originalWidth,d=l.originalHeight;h&&d||cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig),h=Math.abs(h),d=Math.abs(d),u.size=cc.size(h,d)}else if(1==s||2==s)u.rect=this._rectFromString(l.frame),u.rotated=l.rotated||!1,u.offset=this._pointFromString(l.offset),u.size=this._sizeFromString(l.sourceSize);else if(3==s){var p=this._sizeFromString(l.spriteSize),_=this._rectFromString(l.textureRect);p&&(_=cc.rect(_.x,_.y,p.width,p.height)),u.rect=_,u.rotated=l.textureRotated||!1,u.offset=this._pointFromString(l.spriteOffset),u.size=this._sizeFromString(l.spriteSourceSize),u.aliases=l.aliases}else{var f=l.frame,m=l.sourceSize;c=l.filename||c,u.rect=cc.rect(f.x,f.y,f.w,f.h),u.rotated=l.rotated||!1,u.offset=cc.p(0,0),u.size=cc.size(m.w,m.h)}r[c]=u}}return this._frameConfigCache[e]={_inited:!0,frames:r,meta:o}},addSpriteFrames:function(e,t){cc.assert(e,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);var i=this._frameConfigCache[e]||cc.loader.getRes(e);if(i&&i.frames){var n=this,r=n._frameConfigCache[e]||n._getFrameConfig(e),o=r.frames,s=r.meta;if(t)t instanceof cc.Texture2D||(cc.isString(t)?t=cc.textureCache.addImage(t):cc.assert(0,cc._LogInfos.spriteFrameCache_addSpriteFrames_3));else{var a=cc.path.changeBasename(e,s.image||".png");t=cc.textureCache.addImage(a)}var c=n._spriteFramesAliases,l=n._spriteFrames;for(var u in o){var h=o[u],d=l[u];if(!d){d=new cc.SpriteFrame(t,h.rect,h.rotated,h.offset,h.size);var p=h.aliases;if(p)for(var _=0,f=p.length;_<f;_++){var m=p[_];c[m]&&cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames,m),c[m]=u}if(cc._renderType===cc._RENDER_TYPE_CANVAS&&d.isRotated()&&d.getTexture().isLoaded()){var g=d.getTexture().getHtmlElementObj();g=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(g,d.getRectInPixels());var y=new cc.Texture2D;y.initWithElement(g),y.handleLoadedTexture(),d.setTexture(y);var T=d._rect;d.setRect(cc.rect(0,0,T.width,T.height))}l[u]=d}}}},_checkConflict:function(e){var t=e.frames;for(var i in t)this._spriteFrames[i]&&cc.log(cc._LogInfos.spriteFrameCache__checkConflict,i)},addSpriteFrame:function(e,t){this._spriteFrames[t]=e},removeSpriteFrames:function(){this._spriteFrames={},this._spriteFramesAliases={}},removeSpriteFrameByName:function(e){e&&(this._spriteFramesAliases[e]&&delete this._spriteFramesAliases[e],this._spriteFrames[e]&&delete this._spriteFrames[e])},removeSpriteFramesFromFile:function(e){var t=this,i=t._spriteFrames,n=t._spriteFramesAliases,r=t._frameConfigCache[e];if(r){var o=r.frames;for(var s in o)if(i[s]){delete i[s];for(var a in n)n[a]==s&&delete n[a]}}},removeSpriteFramesFromTexture:function(e){var t=this,i=t._spriteFrames,n=t._spriteFramesAliases;for(var r in i){var o=i[r];if(o&&o.getTexture()==e){delete i[r];for(var s in n)n[s]==r&&delete n[s]}}},getSpriteFrame:function(e){var t=this,i=t._spriteFrames[e];if(!i){var n=t._spriteFramesAliases[e];n&&((i=t._spriteFrames[n.toString()])||delete t._spriteFramesAliases[e])}return i},_clear:function(){this._spriteFrames={},this._spriteFramesAliases={},this._frameConfigCache={}}},cc.SpriteBatchNode=cc.Node.extend({_blendFunc:null,_descendants:null,_className:"SpriteBatchNode",ctor:function(e,t){cc.Node.prototype.ctor.call(this),this._descendants=[],this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);var i;t=t||cc.SpriteBatchNode.DEFAULT_CAPACITY,cc.isString(e)?(i=cc.textureCache.getTextureForKey(e))||(i=cc.textureCache.addImage(e)):e instanceof cc.Texture2D&&(i=e),i&&this.initWithTexture(i,t)},addSpriteWithoutQuad:function(e,t,i){if(cc.assert(e,cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad_2),!(e instanceof cc.Sprite))return cc.log(cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad),null;e.atlasIndex=t;var n,r=0,o=this._descendants;if(o&&o.length>0)for(r=0,n=o.length;r<n;r++){var s=o[r];if(s&&s.atlasIndex>=t)break}return o.splice(r,0,e),cc.Node.prototype.addChild.call(this,e,t,i),this.reorderBatch(!1),this},getTextureAtlas:function(){return this._renderCmd.getTextureAtlas()},setTextureAtlas:function(e){this._renderCmd.getTextureAtlas(e)},getDescendants:function(){return this._descendants},initWithFile:function(e,t){var i=cc.textureCache.getTextureForKey(e);return i||(i=cc.textureCache.addImage(e)),this.initWithTexture(i,t)},_setNodeDirtyForCache:function(){this._renderCmd&&this._renderCmd._setNodeDirtyForCache&&this._renderCmd._setNodeDirtyForCache()},init:function(e,t){var i=cc.textureCache.getTextureForKey(e);return i||(i=cc.textureCache.addImage(e)),this.initWithTexture(i,t)},increaseAtlasCapacity:function(){this._renderCmd.increaseAtlasCapacity()},removeChildAtIndex:function(e,t){this.removeChild(this._children[e],t)},rebuildIndexInOrder:function(e,t){var i=e.children;if(i&&i.length>0)for(var n=0;n<i.length;n++){var r=i[n];r&&r.zIndex<0&&(t=this.rebuildIndexInOrder(r,t))}if(!e==this&&(e.atlasIndex=t,t++),i&&i.length>0)for(n=0;n<i.length;n++)(r=i[n])&&r.zIndex>=0&&(t=this.rebuildIndexInOrder(r,t));return t},highestAtlasIndexInChild:function(e){var t=e.children;return t&&0!=t.length?this.highestAtlasIndexInChild(t[t.length-1]):e.atlasIndex},lowestAtlasIndexInChild:function(e){var t=e.children;return t&&0!=t.length?this.lowestAtlasIndexInChild(t[t.length-1]):e.atlasIndex},atlasIndexForChild:function(e,t){var i=e.parent,n=i.children,r=n.indexOf(e),o=i==this,s=null;return r>0&&r<cc.UINT_MAX&&(s=n[r-1]),o?0==r?0:this.highestAtlasIndexInChild(s)+1:0==r?t<0?i.atlasIndex:i.atlasIndex+1:s.zIndex<0&&t<0||s.zIndex>=0&&t>=0?this.highestAtlasIndexInChild(s)+1:i.atlasIndex+1},reorderBatch:function(e){this._reorderChildDirty=e},setBlendFunc:function(e,t){this._blendFunc=void 0===t?e:{src:e,dst:t}},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},reorderChild:function(e,t){cc.assert(e,cc._LogInfos.SpriteBatchNode_reorderChild_2),-1!==this._children.indexOf(e)?t!==e.zIndex&&cc.Node.prototype.reorderChild.call(this,e,t):cc.log(cc._LogInfos.SpriteBatchNode_reorderChild)},removeChild:function(e,t){null!=e&&(-1!==this._children.indexOf(e)?(this.removeSpriteFromAtlas(e),cc.Node.prototype.removeChild.call(this,e,t)):cc.log(cc._LogInfos.SpriteBatchNode_removeChild))},updateQuadFromSprite:function(e,t){cc.assert(e,cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2),e instanceof cc.Sprite?(this._renderCmd.checkAtlasCapacity(),e.batchNode=this,e.atlasIndex=t,e.dirty=!0,e.updateTransform()):cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)},insertQuadFromSprite:function(e,t){cc.assert(e,cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite_2),e instanceof cc.Sprite?(this._renderCmd.insertQuad(e,t),e.batchNode=this,e.atlasIndex=t,e.dirty=!0,e.updateTransform(),this._renderCmd.cutting(e,t)):cc.log(cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite)},initWithTexture:function(e,t){return this._children.length=0,this._descendants.length=0,t=t||cc.SpriteBatchNode.DEFAULT_CAPACITY,this._renderCmd.initWithTexture(e,t),!0},insertChild:function(e,t){e.batchNode=this,e.atlasIndex=t,e.dirty=!0,this._renderCmd.insertQuad(e,t),this._descendants.splice(t,0,e);var i=t+1,n=this._descendants;if(n&&n.length>0)for(;i<n.length;i++)n[i].atlasIndex++;var r,o,s=e.children;if(s)for(i=0,o=s.length||0;i<o;i++)if(r=s[i]){var a=this.atlasIndexForChild(r,r.zIndex);this.insertChild(r,a)}},appendChild:function(e){this._reorderChildDirty=!0,e.batchNode=this,e.dirty=!0,this._descendants.push(e);var t=this._descendants.length-1;e.atlasIndex=t,this._renderCmd.insertQuad(e,t);for(var i=e.children,n=0,r=i.length||0;n<r;n++)this.appendChild(i[n])},removeSpriteFromAtlas:function(e){this._renderCmd.removeQuadAtIndex(e.atlasIndex),e.batchNode=null;var t=this._descendants,i=t.indexOf(e);if(-1!=i){t.splice(i,1);for(var n=t.length;i<n;++i)t[i].atlasIndex--}var r=e.children;if(r)for(var o=0,s=r.length||0;o<s;o++)r[o]&&this.removeSpriteFromAtlas(r[o])},getTexture:function(){return this._renderCmd.getTexture()},setTexture:function(e){this._renderCmd.setTexture(e)},addChild:function(e,t,i){cc.assert(null!=e,cc._LogInfos.CCSpriteBatchNode_addChild_3),this._renderCmd.isValidChild(e)&&(t=null==t?e.zIndex:t,i=null==i?e.tag:i,cc.Node.prototype.addChild.call(this,e,t,i),this.appendChild(e))},removeAllChildren:function(e){var t=this._descendants;if(t&&t.length>0)for(var i=0,n=t.length;i<n;i++)t[i]&&(t[i].batchNode=null);cc.Node.prototype.removeAllChildren.call(this,e),this._descendants.length=0,this._renderCmd.removeAllQuads()},sortAllChildren:function(){if(this._reorderChildDirty){var e,t,i=this._children,n=0,r=i.length;for(e=1;e<r;e++){var o=i[e];for(t=i[n=e-1];n>=0&&(o._localZOrder<t._localZOrder||o._localZOrder==t._localZOrder&&o.arrivalOrder<t.arrivalOrder);)i[n+1]=t,t=i[n-=1];i[n+1]=o}i.length>0&&(this._arrayMakeObjectsPerformSelector(i,cc.Node._stateCallbackType.sortAllChildren),this._renderCmd.updateChildrenAtlasIndex(i)),this._reorderChildDirty=!1}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.SpriteBatchNode.CanvasRenderCmd(this):new cc.SpriteBatchNode.WebGLRenderCmd(this)}});var _p=cc.SpriteBatchNode.prototype;cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.defineGetterSetter(_p,"textureAtlas",_p.getTextureAtlas,_p.setTextureAtlas),_p.descendants,cc.defineGetterSetter(_p,"descendants",_p.getDescendants),cc.SpriteBatchNode.DEFAULT_CAPACITY=29,cc.SpriteBatchNode.create=function(e,t){return new cc.SpriteBatchNode(e,t)},cc.SpriteBatchNode.createWithTexture=cc.SpriteBatchNode.create,function(){cc.SpriteBatchNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._texture=null,this._originalTexture=null};var e=cc.SpriteBatchNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.SpriteBatchNode.CanvasRenderCmd,e.checkAtlasCapacity=function(){},e.isValidChild=function(e){return e instanceof cc.Sprite||(cc.log(cc._LogInfos.Sprite_addChild_4),!1)},e.initWithTexture=function(e,t){this._originalTexture=e,this._texture=e},e.insertQuad=function(e,t){},e.increaseAtlasCapacity=function(){},e.removeQuadAtIndex=function(){},e.removeAllQuads=function(){},e.getTexture=function(){return this._texture},e.setTexture=function(e){this._texture=e;for(var t=this._node._children,i=0;i<t.length;i++)t[i].setTexture(e)},e.updateChildrenAtlasIndex=function(e){this._node._descendants.length=0;for(var t=0,i=e.length;t<i;t++)this._updateAtlasIndex(e[t])},e._updateAtlasIndex=function(e){var t,i=this._node._descendants,n=e.children,r=n.length;for(t=0;t<r&&n[t]._localZOrder<0;t++)i.push(n[t]);for(i.push(e);t<r;t++)i.push(n[t])},e.getTextureAtlas=function(){},e.setTextureAtlas=function(e){},e.cutting=function(e,t){this._node._children.splice(t,0,e)}}(),function(){cc.SpriteBatchNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._textureAtlas=null};var e=cc.SpriteBatchNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.SpriteBatchNode.WebGLRenderCmd,e.isValidChild=function(e){return e instanceof cc.Sprite?e.texture==this.getTexture()||(cc.log(cc._LogInfos.Sprite_addChild_5),!1):(cc.log(cc._LogInfos.Sprite_addChild_4),!1)},e.rendering=function(){var e=this._node;0!==this._textureAtlas.totalQuads&&(this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),e._arrayMakeObjectsPerformSelector(e._children,cc.Node._stateCallbackType.updateTransform),cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst),this._textureAtlas.drawQuads())},e.visit=function(e){var t=this._node;if(t._visible){t._parent&&t._parent._renderCmd&&(this._curLevel=t._parent._renderCmd._curLevel+1);var i=cc.current_stack;i.stack.push(i.top),this._dirtyFlag&cc.Node._dirtyFlags.transformDirty||this.transform(e),this.updateStatus(e),i.top=this._stackMatrix,t.sortAllChildren(),cc.renderer.pushRenderCommand(this),this._dirtyFlag=0,i.top=i.stack.pop()}},e.checkAtlasCapacity=function(e){for(var t=this._textureAtlas;e>=t.capacity||t.capacity==t.totalQuads;)this.increaseAtlasCapacity()},e.increaseAtlasCapacity=function(){var e=this._textureAtlas.capacity,t=Math.floor(4*(e+1)/3);cc.log(cc._LogInfos.SpriteBatchNode_increaseAtlasCapacity,e,t),this._textureAtlas.resizeCapacity(t)||cc.log(cc._LogInfos.SpriteBatchNode_increaseAtlasCapacity_2)},e.initWithTexture=function(e,t){this._textureAtlas=new cc.TextureAtlas,this._textureAtlas.initWithTexture(e,t),this._updateBlendFunc(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},e.insertQuad=function(e,t){var i=this._textureAtlas;i.totalQuads>=i.capacity&&this.increaseAtlasCapacity(),i.insertQuad(e.quad,t)},e.removeQuadAtIndex=function(e){this._textureAtlas.removeQuadAtIndex(e)},e.getTexture=function(){return this._textureAtlas.texture},e.setTexture=function(e){this._textureAtlas.setTexture(e),e&&this._updateBlendFunc()},e.removeAllQuads=function(){this._textureAtlas.removeAllQuads()},e._swap=function(e,t){var i=this._node._descendants,n=this._textureAtlas,r=n.quads,o=i[e],s=cc.V3F_C4B_T2F_QuadCopy(r[e]);i[t].atlasIndex=e,i[e]=i[t],n.updateQuad(r[t],e),i[t]=o,n.updateQuad(s,t)},e._updateAtlasIndex=function(e,t){var i=0,n=e.children;n&&(i=n.length);var r=0;if(0===i)r=e.atlasIndex,e.atlasIndex=t,e.arrivalOrder=0,r!=t&&this._swap(r,t),t++;else{var o=!0;n[0].zIndex>=0&&(r=e.atlasIndex,e.atlasIndex=t,e.arrivalOrder=0,r!=t&&this._swap(r,t),t++,o=!1);for(var s=0;s<n.length;s++){var a=n[s];o&&a.zIndex>=0&&(r=e.atlasIndex,e.atlasIndex=t,e.arrivalOrder=0,r!=t&&this._swap(r,t),t++,o=!1),t=this._updateAtlasIndex(a,t)}o&&(r=e.atlasIndex,e.atlasIndex=t,e.arrivalOrder=0,r!=t&&this._swap(r,t),t++)}return t},e.updateChildrenAtlasIndex=function(e){for(var t=0,i=0;i<e.length;i++)t=this._updateAtlasIndex(e[i],t)},e._updateBlendFunc=function(){if(!this._textureAtlas.texture.hasPremultipliedAlpha()){var e=this._node._blendFunc;e.src=cc.SRC_ALPHA,e.dst=cc.ONE_MINUS_SRC_ALPHA}},e.getTextureAtlas=function(){return this._textureAtlas},e.setTextureAtlas=function(e){e!=this._textureAtlas&&(this._textureAtlas=e)},e.cutting=function(){}}(),cc.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var e=this._valueDict;e["cocos2d.x.version"]=cc.ENGINE_VERSION,e["cocos2d.x.compiled_with_profiler"]=!1,e["cocos2d.x.compiled_with_gl_state_cache"]=cc.ENABLE_GL_STATE_CACHE,this._inited=!0},getMaxTextureSize:function(){return this._maxTextureSize},getMaxModelviewStackDepth:function(){return this._maxModelviewStackDepth},getMaxTextureUnits:function(){return this._maxTextureUnits},supportsNPOT:function(){return this._supportsNPOT},supportsPVRTC:function(){return this._supportsPVRTC},supportsETC:function(){return!1},supportsS3TC:function(){return!1},supportsATITC:function(){return!1},supportsBGRA8888:function(){return this._supportsBGRA8888},supportsDiscardFramebuffer:function(){return this._supportsDiscardFramebuffer},supportsShareableVAO:function(){return this._supportsShareableVAO},checkForGLExtension:function(e){return this._GlExtensions.indexOf(e)>-1},getValue:function(e,t){this._inited||this._init();var i=this._valueDict;return i[e]?i[e]:t},setValue:function(e,t){this._valueDict[e]=t},dumpInfo:function(){0===cc.ENABLE_GL_STATE_CACHE&&(cc.log(""),cc.log(cc._LogInfos.configuration_dumpInfo),cc.log(""))},gatherGPUInfo:function(){if(cc._renderType!==cc._RENDER_TYPE_CANVAS){this._inited||this._init();var e=cc._renderContext,t=this._valueDict;t["gl.vendor"]=e.getParameter(e.VENDOR),t["gl.renderer"]=e.getParameter(e.RENDERER),t["gl.version"]=e.getParameter(e.VERSION),this._GlExtensions="";for(var i=e.getSupportedExtensions(),n=0;n<i.length;n++)this._GlExtensions+=i[n]+" ";this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),t["gl.max_texture_size"]=this._maxTextureSize,this._maxTextureUnits=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),t["gl.max_texture_units"]=this._maxTextureUnits,this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc"),t["gl.supports_PVRTC"]=this._supportsPVRTC,this._supportsNPOT=!1,t["gl.supports_NPOT"]=this._supportsNPOT,this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888"),t["gl.supports_BGRA8888"]=this._supportsBGRA8888,this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer"),t["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer,this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object"),t["gl.supports_vertex_array_object"]=this._supportsShareableVAO,cc.checkGLErrorDebug()}},loadConfigFile:function(e){this._inited||this._init();var t=cc.loader.getRes(e);if(!t)throw"Please load the resource first : "+e;cc.assert(t,cc._LogInfos.configuration_loadConfigFile_2,e);var i=t.data;if(i)for(var n in i)this._valueDict[n]=i[n];else cc.log(cc._LogInfos.configuration_loadConfigFile,e)}},cc.g_NumberOfDraws=0,cc.GLToClipTransform=function(e){var t=new cc.kmMat4;cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,t);var i=new cc.kmMat4;cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,i),cc.kmMat4Multiply(e,t,i)},cc.Director=cc.Class.extend({_landscape:!1,_nextDeltaTimeZero:!1,_paused:!1,_purgeDirectorInNextLoop:!1,_sendCleanupToScene:!1,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_accumDt:0,_contentScaleFactor:1,_displayStats:!1,_deltaTime:0,_frameRate:0,_FPSLabel:null,_SPFLabel:null,_drawsLabel:null,_winSizeInPoints:null,_lastUpdate:null,_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_frames:0,_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterDraw:null,_eventAfterVisit:null,_eventAfterUpdate:null,ctor:function(){var e=this;e._lastUpdate=Date.now(),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){e._lastUpdate=Date.now()})},init:function(){return this._oldAnimationInterval=this._animationInterval=1/cc.defaultFPS,this._scenesStack=[],this._projection=cc.Director.PROJECTION_DEFAULT,this._projectionDelegate=null,this._accumDt=0,this._frameRate=0,this._displayStats=!1,this._totalFrames=this._frames=0,this._lastUpdate=Date.now(),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new cc.Scheduler,this._actionManager=cc.ActionManager?new cc.ActionManager:null,this._scheduler.scheduleUpdateForTarget(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._eventAfterDraw=new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW),this._eventAfterDraw.setUserData(this),this._eventAfterVisit=new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT),this._eventAfterVisit.setUserData(this),this._eventAfterUpdate=new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE),this._eventAfterUpdate.setUserData(this),this._eventProjectionChanged=new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED),this._eventProjectionChanged.setUserData(this),!0},calculateDeltaTime:function(){var e=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(e-this._lastUpdate)/1e3,cc.game.config[cc.game.CONFIG_KEY.debugMode]>0&&this._deltaTime>.2&&(this._deltaTime=1/60),this._lastUpdate=e},convertToGL:null,convertToUI:null,drawScene:function(){var e=cc.renderer;this.calculateDeltaTime(),this._paused||(this._scheduler.update(this._deltaTime),cc.eventManager.dispatchEvent(this._eventAfterUpdate)),this._clear(),this._nextScene&&this.setNextScene(),this._beforeVisitScene&&this._beforeVisitScene(),this._runningScene&&(!0===e.childrenOrderDirty?(cc.renderer.clearRenderCommands(),this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),e.resetFlag()):!0===e.transformDirty()&&e.transform(),cc.eventManager.dispatchEvent(this._eventAfterVisit)),this._notificationNode&&this._notificationNode.visit(),this._displayStats&&this._showStats(),this._afterVisitScene&&this._afterVisitScene(),e.rendering(cc._renderContext),cc.eventManager.dispatchEvent(this._eventAfterDraw),this._totalFrames++,this._displayStats&&this._calculateMPF()},_beforeVisitScene:null,_afterVisitScene:null,end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getNotificationNode:function(){return this._notificationNode},getWinSize:function(){return cc.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){cc.assert(this._runningScene,cc._LogInfos.Director_popScene),this._scenesStack.pop();var e=this._scenesStack.length;0==e?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[e-1])},purgeCachedData:function(){cc.animationCache._clear(),cc.spriteFrameCache._clear(),cc.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAllCallbacks(),cc.eventManager&&cc.eventManager.setEnabled(!1),this._runningScene&&(this._runningScene.onExitTransitionDidStart(),this._runningScene.onExit(),this._runningScene.cleanup()),this._runningScene=null,this._nextScene=null,this._scenesStack.length=0,this.stopAnimation(),this.purgeCachedData(),cc.checkGLErrorDebug()},pushScene:function(e){cc.assert(e,cc._LogInfos.Director_pushScene),this._sendCleanupToScene=!1,this._scenesStack.push(e),this._nextScene=e},runScene:function(e){if(cc.assert(e,cc._LogInfos.Director_pushScene),this._runningScene){var t=this._scenesStack.length;0===t?(this._sendCleanupToScene=!0,this._scenesStack[t]=e,this._nextScene=e):(this._sendCleanupToScene=!0,this._scenesStack[t-1]=e,this._nextScene=e)}else this.pushScene(e),this.startAnimation()},resume:function(){this._paused&&(this.setAnimationInterval(this._oldAnimationInterval),this._lastUpdate=Date.now(),this._lastUpdate||cc.log(cc._LogInfos.Director_resume),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(e){e!=this._contentScaleFactor&&(this._contentScaleFactor=e,this._createStatsLabel())},setDepthTest:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(e){this._nextDeltaTimeZero=e},setNextScene:function(){var e=!1,t=!1;if(cc.TransitionScene&&(e=!!this._runningScene&&this._runningScene instanceof cc.TransitionScene,t=!!this._nextScene&&this._nextScene instanceof cc.TransitionScene),!t){var i=this._runningScene;i&&(i.onExitTransitionDidStart(),i.onExit()),this._sendCleanupToScene&&i&&i.cleanup()}this._runningScene=this._nextScene,cc.renderer.childrenOrderDirty=!0,this._nextScene=null,e||null==this._runningScene||(this._runningScene.onEnter(),this._runningScene.onEnterTransitionDidFinish())},setNotificationNode:function(e){this._notificationNode=e},getDelegate:function(){return this._projectionDelegate},setDelegate:function(e){this._projectionDelegate=e},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,_showStats:function(){this._frames++,this._accumDt+=this._deltaTime,this._FPSLabel&&this._SPFLabel&&this._drawsLabel?(this._accumDt>cc.DIRECTOR_FPS_INTERVAL&&(this._SPFLabel.string=this._secondsPerFrame.toFixed(3),this._frameRate=this._frames/this._accumDt,this._frames=0,this._accumDt=0,this._FPSLabel.string=this._frameRate.toFixed(1),this._drawsLabel.string=(0|cc.g_NumberOfDraws).toString()),this._FPSLabel.visit(),this._SPFLabel.visit(),this._drawsLabel.visit()):this._createStatsLabel(),cc.g_NumberOfDraws=0},isSendCleanupToScene:function(){return this._sendCleanupToScene},getRunningScene:function(){return this._runningScene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return this._displayStats},setDisplayStats:function(e){this._displayStats=e},getSecondsPerFrame:function(){return this._secondsPerFrame},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(e){cc.assert(this._runningScene,cc._LogInfos.Director_popToSceneStackLevel_2);var t=this._scenesStack,i=t.length;if(0!=i){if(!(e>i)){for(;i>e;){var n=t.pop();n.running&&(n.onExitTransitionDidStart(),n.onExit()),n.cleanup(),i--}this._nextScene=t[t.length-1],this._sendCleanupToScene=!1}}else this.end()},getScheduler:function(){return this._scheduler},setScheduler:function(e){this._scheduler!=e&&(this._scheduler=e)},getActionManager:function(){return this._actionManager},setActionManager:function(e){this._actionManager!=e&&(this._actionManager=e)},getDeltaTime:function(){return this._deltaTime},_createStatsLabel:null,_calculateMPF:function(){var e=Date.now();this._secondsPerFrame=(e-this._lastUpdate)/1e3}}),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0,this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(e){this._animationInterval=e,this.invalid||(this.stopAnimation(),this.startAnimation())}}),cc.Director.sharedDirector=null,cc.Director.firstUseDirector=!0,cc.Director._getInstance=function(){return cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=new cc.DisplayLinkDirector,cc.Director.sharedDirector.init()),cc.Director.sharedDirector},cc.defaultFPS=60,cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_3D,cc._renderType===cc._RENDER_TYPE_CANVAS?((_p=cc.Director.prototype).setProjection=function(e){this._projection=e,cc.eventManager.dispatchEvent(this._eventProjectionChanged)},_p.setDepthTest=function(){},_p.setOpenGLView=function(e){this._winSizeInPoints.width=cc._canvas.width,this._winSizeInPoints.height=cc._canvas.height,this._openGLView=e||cc.view,cc.eventManager&&cc.eventManager.setEnabled(!0)},_p._clear=function(){var e=this._openGLView.getViewPortRect(),t=cc._renderContext.getContext();t.setTransform(1,0,0,1,0,0),t.clearRect(-e.x,e.y,e.width,e.height)},_p._createStatsLabel=function(){var e=this,t=0;t=e._winSizeInPoints.width>e._winSizeInPoints.height?0|e._winSizeInPoints.height/320*24:0|e._winSizeInPoints.width/320*24,e._FPSLabel=new cc.LabelTTF("000.0","Arial",t),e._SPFLabel=new cc.LabelTTF("0.000","Arial",t),e._drawsLabel=new cc.LabelTTF("0000","Arial",t);var i=cc.DIRECTOR_STATS_POSITION;e._drawsLabel.setPosition(e._drawsLabel.width/2+i.x,5*e._drawsLabel.height/2+i.y),e._SPFLabel.setPosition(e._SPFLabel.width/2+i.x,3*e._SPFLabel.height/2+i.y),e._FPSLabel.setPosition(e._FPSLabel.width/2+i.x,e._FPSLabel.height/2+i.y)},_p.getVisibleSize=function(){return this.getWinSize()},_p.getVisibleOrigin=function(){return cc.p(0,0)}):(cc.Director._fpsImage=new Image,cc._addEventListener(cc.Director._fpsImage,"load",function(){cc.Director._fpsImageLoaded=!0}),cc._fpsImage&&(cc.Director._fpsImage.src=cc._fpsImage)),cc._renderType===cc._RENDER_TYPE_WEBGL&&function(){cc.DirectorDelegate=cc.Class.extend({updateProjection:function(){}});var e=cc.Director.prototype;e.setProjection=function(e){var t=this,i=t._winSizeInPoints;t.setViewport();var n=t._openGLView,r=n._viewPortRect.x/n._scaleX,o=n._viewPortRect.y/n._scaleY;switch(e){case cc.Director.PROJECTION_2D:cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity();var s=new cc.kmMat4;cc.kmMat4OrthographicProjection(s,-r,i.width-r,-o,i.height-o,-1024,1024),cc.kmGLMultMatrix(s),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity();break;case cc.Director.PROJECTION_3D:var a=t.getZEye(),c=new cc.kmMat4,l=new cc.kmMat4;cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity(),cc.kmMat4PerspectiveProjection(c,60,i.width/i.height,.1,2*a),cc.kmGLMultMatrix(c),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity();var u=cc.kmVec3Fill(null,-r+i.width/2,-o+i.height/2,a),h=cc.kmVec3Fill(null,-r+i.width/2,-o+i.height/2,0),d=cc.kmVec3Fill(null,0,1,0);cc.kmMat4LookAt(l,u,h,d),cc.kmGLMultMatrix(l);break;case cc.Director.PROJECTION_CUSTOM:t._projectionDelegate&&t._projectionDelegate.updateProjection();break;default:cc.log(cc._LogInfos.Director_setProjection)}t._projection=e,cc.eventManager.dispatchEvent(t._eventProjectionChanged),cc.setProjectionMatrixDirty(),cc.renderer.childrenOrderDirty=!0},e.setDepthTest=function(e){var t=cc._renderContext;e?(t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL)):t.disable(t.DEPTH_TEST)},e.setOpenGLView=function(e){var t=this;t._winSizeInPoints.width=cc._canvas.width,t._winSizeInPoints.height=cc._canvas.height,t._openGLView=e||cc.view;var i=cc.configuration;i.gatherGPUInfo(),i.dumpInfo(),t._createStatsLabel(),t.setGLDefaultValues(),cc.eventManager&&cc.eventManager.setEnabled(!0)},e._clear=function(){var e=cc._renderContext;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)},e._beforeVisitScene=function(){cc.kmGLPushMatrix()},e._afterVisitScene=function(){cc.kmGLPopMatrix()},e._createStatsLabel=function(){var e=this;if(cc.LabelAtlas){if(null!=cc.Director._fpsImageLoaded&&0!=cc.Director._fpsImageLoaded){var t=new cc.Texture2D;t.initWithElement(cc.Director._fpsImage),t.handleLoadedTexture();var i=cc.view.getDesignResolutionSize().height/320;0===i&&(i=e._winSizeInPoints.height/320);var n=new cc.LabelAtlas;n._setIgnoreContentScaleFactor(!0),n.initWithString("00.0",t,12,32,"."),n.scale=i,e._FPSLabel=n,(n=new cc.LabelAtlas)._setIgnoreContentScaleFactor(!0),n.initWithString("0.000",t,12,32,"."),n.scale=i,e._SPFLabel=n,(n=new cc.LabelAtlas)._setIgnoreContentScaleFactor(!0),n.initWithString("000",t,12,32,"."),n.scale=i,e._drawsLabel=n;var r=cc.DIRECTOR_STATS_POSITION;e._drawsLabel.setPosition(r.x,34*i+r.y),e._SPFLabel.setPosition(r.x,17*i+r.y),e._FPSLabel.setPosition(r)}}else e._createStatsLabelForCanvas()},e._createStatsLabelForCanvas=function(){var e=this,t=0;t=e._winSizeInPoints.width>e._winSizeInPoints.height?0|e._winSizeInPoints.height/320*24:0|e._winSizeInPoints.width/320*24,e._FPSLabel=new cc.LabelTTF("000.0","Arial",t),e._SPFLabel=new cc.LabelTTF("0.000","Arial",t),e._drawsLabel=new cc.LabelTTF("0000","Arial",t);var i=cc.DIRECTOR_STATS_POSITION;e._drawsLabel.setPosition(e._drawsLabel.width/2+i.x,5*e._drawsLabel.height/2+i.y),e._SPFLabel.setPosition(e._SPFLabel.width/2+i.x,3*e._SPFLabel.height/2+i.y),e._FPSLabel.setPosition(e._FPSLabel.width/2+i.x,e._FPSLabel.height/2+i.y)},e.convertToGL=function(e){var t=new cc.kmMat4;cc.GLToClipTransform(t);var i=new cc.kmMat4;cc.kmMat4Inverse(i,t);var n=t.mat[14]/t.mat[15],r=this._openGLView.getDesignResolutionSize(),o=new cc.kmVec3(2*e.x/r.width-1,1-2*e.y/r.height,n),s=new cc.kmVec3;return cc.kmVec3TransformCoord(s,o,i),cc.p(s.x,s.y)},e.convertToUI=function(e){var t=new cc.kmMat4;cc.GLToClipTransform(t);var i=new cc.kmVec3,n=new cc.kmVec3(e.x,e.y,0);cc.kmVec3TransformCoord(i,n,t);var r=this._openGLView.getDesignResolutionSize();return cc.p(r.width*(.5*i.x+.5),r.height*(.5*-i.y+.5))},e.getVisibleSize=function(){return this._openGLView.getVisibleSize()},e.getVisibleOrigin=function(){return this._openGLView.getVisibleOrigin()},e.getZEye=function(){return this._winSizeInPoints.height/1.1566},e.setViewport=function(){var e=this._openGLView;if(e){var t=this._winSizeInPoints;e.setViewPortInPoints(-e._viewPortRect.x/e._scaleX,-e._viewPortRect.y/e._scaleY,t.width,t.height)}},e.getOpenGLView=function(){return this._openGLView},e.getProjection=function(){return this._projection},e.setAlphaBlending=function(e){e?cc.glBlendFunc(cc.BLEND_SRC,cc.BLEND_DST):cc.glBlendFunc(cc._renderContext.ONE,cc._renderContext.ZERO)},e.setGLDefaultValues=function(){var e=this;e.setAlphaBlending(!0),e.setDepthTest(!1),e.setProjection(e._projection),cc._renderContext.clearColor(0,0,0,1)}}(),cc.Camera=cc.Class.extend({_eyeX:null,_eyeY:null,_eyeZ:null,_centerX:null,_centerY:null,_centerZ:null,_upX:null,_upY:null,_upZ:null,_dirty:!1,_lookupMatrix:null,ctor:function(){this._lookupMatrix=new cc.kmMat4,this.restore()},description:function(){return"<CCCamera | center =("+this._centerX+","+this._centerY+","+this._centerZ+")>"},setDirty:function(e){this._dirty=e},isDirty:function(){return this._dirty},restore:function(){this._eyeX=this._eyeY=0,this._eyeZ=cc.Camera.getZEye(),this._centerX=this._centerY=this._centerZ=0,this._upX=0,this._upY=1,this._upZ=0,cc.kmMat4Identity(this._lookupMatrix),this._dirty=!1},locate:function(){if(this._dirty){var e=new cc.kmVec3,t=new cc.kmVec3,i=new cc.kmVec3;cc.kmVec3Fill(e,this._eyeX,this._eyeY,this._eyeZ),cc.kmVec3Fill(t,this._centerX,this._centerY,this._centerZ),cc.kmVec3Fill(i,this._upX,this._upY,this._upZ),cc.kmMat4LookAt(this._lookupMatrix,e,t,i),this._dirty=!1}cc.kmGLMultMatrix(this._lookupMatrix)},_locateForRenderer:function(e){if(this._dirty){var t=new cc.kmVec3,i=new cc.kmVec3,n=new cc.kmVec3;cc.kmVec3Fill(t,this._eyeX,this._eyeY,this._eyeZ),cc.kmVec3Fill(i,this._centerX,this._centerY,this._centerZ),cc.kmVec3Fill(n,this._upX,this._upY,this._upZ),cc.kmMat4LookAt(this._lookupMatrix,t,i,n),this._dirty=!1}cc.kmMat4Multiply(e,e,this._lookupMatrix)},setEyeXYZ:function(e,t,i){this.setEye(e,t,i)},setEye:function(e,t,i){this._eyeX=e,this._eyeY=t,this._eyeZ=i,this._dirty=!0},setCenterXYZ:function(e,t,i){this.setCenter(e,t,i)},setCenter:function(e,t,i){this._centerX=e,this._centerY=t,this._centerZ=i,this._dirty=!0},setUpXYZ:function(e,t,i){this.setUp(e,t,i)},setUp:function(e,t,i){this._upX=e,this._upY=t,this._upZ=i,this._dirty=!0},getEyeXYZ:function(e,t,i){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getEye:function(){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getCenterXYZ:function(e,t,i){return{x:this._centerX,y:this._centerY,z:this._centerZ}},getCenter:function(){return{x:this._centerX,y:this._centerY,z:this._centerZ}},getUpXYZ:function(e,t,i){return{x:this._upX,y:this._upY,z:this._upZ}},getUp:function(){return{x:this._upX,y:this._upY,z:this._upZ}},_DISALLOW_COPY_AND_ASSIGN:function(e){}}),cc.Camera.getZEye=function(){return cc.FLT_EPSILON},cc.PRIORITY_NON_SYSTEM=cc.PRIORITY_SYSTEM+1,cc.ListEntry=function(e,t,i,n,r,o){this.prev=e,this.next=t,this.target=i,this.priority=n,this.paused=r,this.markedForDeletion=o},cc.HashUpdateEntry=function(e,t,i,n){this.list=e,this.entry=t,this.target=i,this.hh=n},cc.HashTimerEntry=function(e,t,i,n,r,o,s){var a=this;a.timers=e,a.target=t,a.timerIndex=i,a.currentTimer=n,a.currentTimerSalvaged=r,a.paused=o,a.hh=s},cc.Timer=cc.Class.extend({_interval:0,_callback:null,_target:null,_elapsed:0,_runForever:!1,_useDelay:!1,_timesExecuted:0,_repeat:0,_delay:0,getInterval:function(){return this._interval},setInterval:function(e){this._interval=e},getCallback:function(){return this._callback},ctor:function(e,t,i,n,r){var o=this;o._target=e,o._callback=t,o._elapsed=-1,o._interval=i||0,o._delay=r||0,o._useDelay=o._delay>0,o._repeat=null==n?cc.REPEAT_FOREVER:n,o._runForever=o._repeat==cc.REPEAT_FOREVER},_doCallback:function(){var e=this;cc.isString(e._callback)?e._target[e._callback](e._elapsed):e._callback.call(e._target,e._elapsed)},update:function(e){var t=this;if(-1==t._elapsed)t._elapsed=0,t._timesExecuted=0;else{var i=t._target,n=t._callback;t._elapsed+=e,t._runForever&&!t._useDelay?t._elapsed>=t._interval&&(i&&n&&t._doCallback(),t._elapsed=0):(t._useDelay?t._elapsed>=t._delay&&(i&&n&&t._doCallback(),t._elapsed=t._elapsed-t._delay,t._timesExecuted+=1,t._useDelay=!1):t._elapsed>=t._interval&&(i&&n&&t._doCallback(),t._elapsed=0,t._timesExecuted+=1),t._timesExecuted>t._repeat&&cc.director.getScheduler().unscheduleCallbackForTarget(i,n))}}}),cc.Scheduler=cc.Class.extend({_timeScale:1,_updates:null,_hashForUpdates:null,_arrayForUpdates:null,_hashForTimers:null,_arrayForTimes:null,_currentTarget:null,_currentTargetSalvaged:!1,_updateHashLocked:!1,ctor:function(){var e=this;e._timeScale=1,e._updates=[[],[],[]],e._hashForUpdates={},e._arrayForUpdates=[],e._hashForTimers={},e._arrayForTimers=[],e._currentTarget=null,e._currentTargetSalvaged=!1,e._updateHashLocked=!1},_removeHashElement:function(e){delete this._hashForTimers[e.target.__instanceId],cc.arrayRemoveObject(this._arrayForTimers,e),e.Timer=null,e.target=null,e=null},_removeUpdateFromHash:function(e){var t=this,i=t._hashForUpdates[e.target.__instanceId];i&&(cc.arrayRemoveObject(i.list,i.entry),delete t._hashForUpdates[i.target.__instanceId],cc.arrayRemoveObject(t._arrayForUpdates,i),i.entry=null,i.target=null)},_priorityIn:function(e,t,i,n){var r=this,o=new cc.ListEntry(null,null,t,i,n,!1);if(e){for(var s=e.length-1,a=0;a<=s;a++)if(i<e[a].priority){s=a;break}e.splice(a,0,o)}else(e=[]).push(o);var c=new cc.HashUpdateEntry(e,o,t,null);return r._arrayForUpdates.push(c),r._hashForUpdates[t.__instanceId]=c,e},_appendIn:function(e,t,i){var n=this,r=new cc.ListEntry(null,null,t,0,i,!1);e.push(r);var o=new cc.HashUpdateEntry(e,r,t,null);n._arrayForUpdates.push(o),n._hashForUpdates[t.__instanceId]=o},setTimeScale:function(e){this._timeScale=e},getTimeScale:function(){return this._timeScale},update:function(e){var t,i,n,r,o=this,s=o._updates,a=o._arrayForTimers;for(o._updateHashLocked=!0,1!=this._timeScale&&(e*=this._timeScale),n=0,r=s.length;n<r&&n>=0;n++)for(var c=0,l=(u=o._updates[n]).length;c<l;c++)(t=u[c]).paused||t.markedForDeletion||t.target.update(e);for(n=0,r=a.length;n<r&&(i=a[n]);n++){if(o._currentTarget=i,o._currentTargetSalvaged=!1,!i.paused)for(i.timerIndex=0;i.timerIndex<i.timers.length;i.timerIndex++)i.currentTimer=i.timers[i.timerIndex],i.currentTimerSalvaged=!1,i.currentTimer.update(e),i.currentTimer=null;o._currentTargetSalvaged&&0==i.timers.length&&(o._removeHashElement(i),n--)}for(n=0,r=s.length;n<r;n++)for(var u=o._updates[n],c=0,l=u.length;c<l&&(t=u[c]);)t.markedForDeletion?o._removeUpdateFromHash(t):c++;o._updateHashLocked=!1,o._currentTarget=null},scheduleCallbackForTarget:function(e,t,i,n,r,o){cc.assert(t,cc._LogInfos.Scheduler_scheduleCallbackForTarget_2),cc.assert(e,cc._LogInfos.Scheduler_scheduleCallbackForTarget_3),i=i||0,n=null==n?cc.REPEAT_FOREVER:n,r=r||0,o=o||!1;var s,a=this,c=a._hashForTimers[e.__instanceId];if(c||(c=new cc.HashTimerEntry(null,e,0,null,null,o,null),a._arrayForTimers.push(c),a._hashForTimers[e.__instanceId]=c),null==c.timers)c.timers=[];else for(var l=0;l<c.timers.length;l++)if(s=c.timers[l],t==s._callback)return cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget,s.getInterval().toFixed(4),i.toFixed(4)),void(s._interval=i);s=new cc.Timer(e,t,i,n,r),c.timers.push(s)},scheduleUpdateForTarget:function(e,t,i){if(null!==e){var n=this,r=n._updates,o=n._hashForUpdates[e.__instanceId];o?o.entry.markedForDeletion=!1:0==t?n._appendIn(r[1],e,i):t<0?r[0]=n._priorityIn(r[0],e,t,i):r[2]=n._priorityIn(r[2],e,t,i)}},unscheduleCallbackForTarget:function(e,t){if(null!=e&&null!=t){var i=this,n=i._hashForTimers[e.__instanceId];if(n)for(var r=n.timers,o=0,s=r.length;o<s;o++){var a=r[o];if(t==a._callback)return a!=n.currentTimer||n.currentTimerSalvaged||(n.currentTimerSalvaged=!0),r.splice(o,1),n.timerIndex>=o&&n.timerIndex--,void(0==r.length&&(i._currentTarget==n?i._currentTargetSalvaged=!0:i._removeHashElement(n)))}}},unscheduleUpdateForTarget:function(e){if(null!=e){var t=this,i=t._hashForUpdates[e.__instanceId];null!=i&&(t._updateHashLocked?i.entry.markedForDeletion=!0:t._removeUpdateFromHash(i.entry))}},unscheduleAllCallbacksForTarget:function(e){if(null!=e){var t=this,i=t._hashForTimers[e.__instanceId];if(i){var n=i.timers;!i.currentTimerSalvaged&&n.indexOf(i.currentTimer)>=0&&(i.currentTimerSalvaged=!0),n.length=0,t._currentTarget==i?t._currentTargetSalvaged=!0:t._removeHashElement(i)}t.unscheduleUpdateForTarget(e)}},unscheduleAllCallbacks:function(){this.unscheduleAllCallbacksWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(e){for(var t=this,i=t._arrayForTimers,n=t._updates,r=0,o=i.length;r<o;r++)t.unscheduleAllCallbacksForTarget(i[r].target);for(r=2;r>=0;r--)if(!(1==r&&e>0||0==r&&e>=0))for(var s=n[r],a=0,c=s.length;a<c;a++)t.unscheduleUpdateForTarget(s[a].target)},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(e){for(var t,i=[],n=this,r=n._arrayForTimers,o=n._updates,s=0,a=r.length;s<a;s++)(t=r[s])&&(t.paused=!0,i.push(t.target));for(var s=0,a=o.length;s<a;s++)for(var c=o[s],l=0,u=c.length;l<u;l++)(t=c[l])&&(t.paused=!0,i.push(t.target));return i},resumeTargets:function(e){if(e)for(var t=0;t<e.length;t++)this.resumeTarget(e[t])},pauseTarget:function(e){cc.assert(e,cc._LogInfos.Scheduler_pauseTarget);var t=this,i=t._hashForTimers[e.__instanceId];i&&(i.paused=!0);var n=t._hashForUpdates[e.__instanceId];n&&(n.entry.paused=!0)},resumeTarget:function(e){cc.assert(e,cc._LogInfos.Scheduler_resumeTarget);var t=this,i=t._hashForTimers[e.__instanceId];i&&(i.paused=!1);var n=t._hashForUpdates[e.__instanceId];n&&(n.entry.paused=!1)},isTargetPaused:function(e){cc.assert(e,cc._LogInfos.Scheduler_isTargetPaused);var t=this._hashForTimers[e.__instanceId];return!!t&&t.paused}}),cc.Scheduler.PRIORITY_SYSTEM=-2147483648,cc.PI2=2*Math.PI,cc.DrawingPrimitiveCanvas=cc.Class.extend({_cacheArray:[],_renderContext:null,ctor:function(e){this._renderContext=e},drawPoint:function(e,t){t||(t=1);var i=cc.view.getScaleX(),n=cc.view.getScaleY(),r=cc.p(e.x*i,e.y*n),o=this._renderContext.getContext();o.beginPath(),o.arc(r.x,-r.y,t*i,0,2*Math.PI,!1),o.closePath(),o.fill()},drawPoints:function(e,t,i){if(null!=e){i||(i=1);var n=this._renderContext.getContext(),r=cc.view.getScaleX(),o=cc.view.getScaleY();n.beginPath();for(var s=0,a=e.length;s<a;s++)n.arc(e[s].x*r,-e[s].y*o,i*r,0,2*Math.PI,!1);n.closePath(),n.fill()}},drawLine:function(e,t){var i=this._renderContext.getContext(),n=cc.view.getScaleX(),r=cc.view.getScaleY();i.beginPath(),i.moveTo(e.x*n,-e.y*r),i.lineTo(t.x*n,-t.y*r),i.closePath(),i.stroke()},drawRect:function(e,t){this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y)),this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y))},drawSolidRect:function(e,t,i){var n=[e,cc.p(t.x,e.y),t,cc.p(e.x,t.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(e,t,i,n){if(n=n||!1,null!=e){if(e.length<3)throw new Error("Polygon's point must greater than 2");var r=e[0],o=this._renderContext.getContext(),s=cc.view.getScaleX(),a=cc.view.getScaleY();o.beginPath(),o.moveTo(r.x*s,-r.y*a);for(var c=1,l=e.length;c<l;c++)o.lineTo(e[c].x*s,-e[c].y*a);i&&o.closePath(),n?o.fill():o.stroke()}},drawSolidPoly:function(e,t,i){this.setDrawColor(i.r,i.g,i.b,i.a),this.drawPoly(e,t,!0,!0)},drawCircle:function(e,t,i,n,r){r=r||!1;var o=this._renderContext.getContext(),s=cc.view.getScaleX(),a=cc.view.getScaleY();o.beginPath();var c=i-2*Math.PI;o.arc(0|e.x*s,0|-e.y*a,t*s,-i,-c,!1),r&&o.lineTo(0|e.x*s,0|-e.y*a),o.stroke()},drawQuadBezier:function(e,t,i,n){var r=this._cacheArray;r.length=0;for(var o=0,s=0;s<n;s++){var a=Math.pow(1-o,2)*e.x+2*(1-o)*o*t.x+o*o*i.x,c=Math.pow(1-o,2)*e.y+2*(1-o)*o*t.y+o*o*i.y;r.push(cc.p(a,c)),o+=1/n}r.push(cc.p(i.x,i.y)),this.drawPoly(r,n+1,!1,!1)},drawCubicBezier:function(e,t,i,n,r){var o=this._cacheArray;o.length=0;for(var s=0,a=0;a<r;a++){var c=Math.pow(1-s,3)*e.x+3*Math.pow(1-s,2)*s*t.x+3*(1-s)*s*s*i.x+s*s*s*n.x,l=Math.pow(1-s,3)*e.y+3*Math.pow(1-s,2)*s*t.y+3*(1-s)*s*s*i.y+s*s*s*n.y;o.push(cc.p(c,l)),s+=1/r}o.push(cc.p(n.x,n.y)),this.drawPoly(o,r+1,!1,!1)},drawCatmullRom:function(e,t){this.drawCardinalSpline(e,.5,t)},drawCardinalSpline:function(e,t,i){cc._renderContext.setStrokeStyle("rgba(255,255,255,1)");var n=this._cacheArray;n.length=0;for(var r,o,s=1/e.length,a=0;a<i+1;a++){var c=a/i;1==c?(r=e.length-1,o=1):o=(c-s*(r=0|c/s))/s;var l=cc.CardinalSplineAt(cc.getControlPointAt(e,r-1),cc.getControlPointAt(e,r-0),cc.getControlPointAt(e,r+1),cc.getControlPointAt(e,r+2),t,o);n.push(l)}this.drawPoly(n,i+1,!1,!1)},drawImage:function(e,t,i,n,r){var o=arguments.length,s=this._renderContext.getContext();switch(o){case 2:var a=e.height;s.drawImage(e,t.x,-(t.y+a));break;case 3:s.drawImage(e,t.x,-(t.y+i.height),i.width,i.height);break;case 5:s.drawImage(e,t.x,t.y,i.width,i.height,n.x,-(n.y+r.height),r.width,r.height);break;default:throw new Error("Argument must be non-nil")}},drawStar:function(e,t,i){var n=e||this._renderContext,r=n.getContext();t*=cc.view.getScaleX();var o="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b);n.setFillStyle(o+",1)");var s=t/10;r.beginPath(),r.moveTo(-t,t),r.lineTo(0,s),r.lineTo(t,t),r.lineTo(s,0),r.lineTo(t,-t),r.lineTo(0,-s),r.lineTo(-t,-t),r.lineTo(-s,0),r.lineTo(-t,t),r.closePath(),r.fill();var a=r.createRadialGradient(0,0,s,0,0,t);a.addColorStop(0,o+", 1)"),a.addColorStop(.3,o+", 0.8)"),a.addColorStop(1,o+", 0.0)"),n.setFillStyle(a),r.beginPath();var c=cc.PI2;r.arc(0,0,t-s,0,c,!1),r.closePath(),r.fill()},drawColorBall:function(e,t,i){var n=e||this._renderContext,r=n.getContext();t*=cc.view.getScaleX();var o="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b),s=t/10,a=r.createRadialGradient(0,0,s,0,0,t);a.addColorStop(0,o+", 1)"),a.addColorStop(.3,o+", 0.8)"),a.addColorStop(.6,o+", 0.4)"),a.addColorStop(1,o+", 0.0)"),n.setFillStyle(a),r.beginPath();var c=cc.PI2;r.arc(0,0,t,0,c,!1),r.closePath(),r.fill()},fillText:function(e,t,i){this._renderContext.getContext().fillText(e,t,-i)},setDrawColor:function(e,t,i,n){this._renderContext.setFillStyle("rgba("+e+","+t+","+i+","+n/255+")"),this._renderContext.setStrokeStyle("rgba("+e+","+t+","+i+","+n/255+")")},setPointSize:function(e){},setLineWidth:function(e){this._renderContext.getContext().lineWidth=e*cc.view.getScaleX()}}),cc.DrawingPrimitiveWebGL=cc.Class.extend({_renderContext:null,_initialized:!1,_shader:null,_colorLocation:-1,_colorArray:null,_pointSizeLocation:-1,_pointSize:-1,ctor:function(e){if(null==e&&(e=cc._renderContext),!e instanceof WebGLRenderingContext)throw"Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext";this._renderContext=e,this._colorArray=new Float32Array([1,1,1,1])},lazy_init:function(){var e=this;e._initialized||(e._shader=cc.shaderCache.programForKey(cc.SHADER_POSITION_UCOLOR),e._colorLocation=e._renderContext.getUniformLocation(e._shader.getProgram(),"u_color"),e._pointSizeLocation=e._renderContext.getUniformLocation(e._shader.getProgram(),"u_pointSize"),e._initialized=!0)},drawInit:function(){this._initialized=!1},drawPoint:function(e){this.lazy_init();var t=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),t.uniform4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([e.x,e.y]),t.STATIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.drawArrays(t.POINTS,0,1),t.deleteBuffer(i),cc.incrementGLDraws(1)},drawPoints:function(e,t){if(e&&0!=e.length){this.lazy_init();var i=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),i.uniform4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var n=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray(e),i.STATIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.POINTS,0,e.length),i.deleteBuffer(n),cc.incrementGLDraws(1)}},_pointsToTypeArray:function(e){for(var t=new Float32Array(2*e.length),i=0;i<e.length;i++)t[2*i]=e[i].x,t[2*i+1]=e[i].y;return t},drawLine:function(e,t){this.lazy_init();var i=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),i.uniform4fv(this._colorLocation,this._colorArray);var n=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray([e,t]),i.STATIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.LINES,0,2),i.deleteBuffer(n),cc.incrementGLDraws(1)},drawRect:function(e,t){this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y)),this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y))},drawSolidRect:function(e,t,i){var n=[e,cc.p(t.x,e.y),t,cc.p(e.x,t.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(e,t,i){this.lazy_init();var n=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),n.uniform4fv(this._colorLocation,this._colorArray);var r=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,this._pointsToTypeArray(e),n.STATIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,0),i?n.drawArrays(n.LINE_LOOP,0,e.length):n.drawArrays(n.LINE_STRIP,0,e.length),n.deleteBuffer(r),cc.incrementGLDraws(1)},drawSolidPoly:function(e,t,i){this.lazy_init(),i&&this.setDrawColor(i.r,i.g,i.b,i.a);var n=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),n.uniform4fv(this._colorLocation,this._colorArray);var r=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,this._pointsToTypeArray(e),n.STATIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLE_FAN,0,e.length),n.deleteBuffer(r),cc.incrementGLDraws(1)},drawCircle:function(e,t,i,n,r){this.lazy_init();var o=1;r&&o++;var s=2*Math.PI/n,a=new Float32Array(2*(n+2));if(a){for(var c=0;c<=n;c++){var l=c*s,u=t*Math.cos(l+i)+e.x,h=t*Math.sin(l+i)+e.y;a[2*c]=u,a[2*c+1]=h}a[2*(n+1)]=e.x,a[2*(n+1)+1]=e.y;var d=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),d.uniform4fv(this._colorLocation,this._colorArray);var p=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,p),d.bufferData(d.ARRAY_BUFFER,a,d.STATIC_DRAW),d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,d.FLOAT,!1,0,0),d.drawArrays(d.LINE_STRIP,0,n+o),d.deleteBuffer(p),cc.incrementGLDraws(1)}},drawQuadBezier:function(e,t,i,n){this.lazy_init();for(var r=new Float32Array(2*(n+1)),o=0,s=0;s<n;s++)r[2*s]=Math.pow(1-o,2)*e.x+2*(1-o)*o*t.x+o*o*i.x,r[2*s+1]=Math.pow(1-o,2)*e.y+2*(1-o)*o*t.y+o*o*i.y,o+=1/n;r[2*n]=i.x,r[2*n+1]=i.y;var a=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),a.uniform4fv(this._colorLocation,this._colorArray);var c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,r,a.STATIC_DRAW),a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,a.FLOAT,!1,0,0),a.drawArrays(a.LINE_STRIP,0,n+1),a.deleteBuffer(c),cc.incrementGLDraws(1)},drawCubicBezier:function(e,t,i,n,r){this.lazy_init();for(var o=new Float32Array(2*(r+1)),s=0,a=0;a<r;a++)o[2*a]=Math.pow(1-s,3)*e.x+3*Math.pow(1-s,2)*s*t.x+3*(1-s)*s*s*i.x+s*s*s*n.x,o[2*a+1]=Math.pow(1-s,3)*e.y+3*Math.pow(1-s,2)*s*t.y+3*(1-s)*s*s*i.y+s*s*s*n.y,s+=1/r;o[2*r]=n.x,o[2*r+1]=n.y;var c=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),c.uniform4fv(this._colorLocation,this._colorArray);var l=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,l),c.bufferData(c.ARRAY_BUFFER,o,c.STATIC_DRAW),c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,c.FLOAT,!1,0,0),c.drawArrays(c.LINE_STRIP,0,r+1),c.deleteBuffer(l),cc.incrementGLDraws(1)},drawCatmullRom:function(e,t){this.drawCardinalSpline(e,.5,t)},drawCardinalSpline:function(e,t,i){this.lazy_init();for(var n,r,o=new Float32Array(2*(i+1)),s=1/e.length,a=0;a<i+1;a++){var c=a/i;1==c?(n=e.length-1,r=1):r=(c-s*(n=0|c/s))/s;var l=cc.CardinalSplineAt(cc.getControlPointAt(e,n-1),cc.getControlPointAt(e,n),cc.getControlPointAt(e,n+1),cc.getControlPointAt(e,n+2),t,r);o[2*a]=l.x,o[2*a+1]=l.y}var u=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION),u.uniform4fv(this._colorLocation,this._colorArray);var h=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,h),u.bufferData(u.ARRAY_BUFFER,o,u.STATIC_DRAW),u.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,u.FLOAT,!1,0,0),u.drawArrays(u.LINE_STRIP,0,i+1),u.deleteBuffer(h),cc.incrementGLDraws(1)},setDrawColor:function(e,t,i,n){this._colorArray[0]=e/255,this._colorArray[1]=t/255,this._colorArray[2]=i/255,this._colorArray[3]=n/255},setPointSize:function(e){this._pointSize=e*cc.contentScaleFactor()},setLineWidth:function(e){this._renderContext.lineWidth&&this._renderContext.lineWidth(e)}}),cc._tmp.PrototypeLabelTTF=function(){var e=cc.LabelTTF.prototype;cc.defineGetterSetter(e,"color",e.getColor,e.setColor),cc.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity),e.string,cc.defineGetterSetter(e,"string",e.getString,e.setString),e.textAlign,cc.defineGetterSetter(e,"textAlign",e.getHorizontalAlignment,e.setHorizontalAlignment),e.verticalAlign,cc.defineGetterSetter(e,"verticalAlign",e.getVerticalAlignment,e.setVerticalAlignment),e.fontSize,cc.defineGetterSetter(e,"fontSize",e.getFontSize,e.setFontSize),e.fontName,cc.defineGetterSetter(e,"fontName",e.getFontName,e.setFontName),e.font,cc.defineGetterSetter(e,"font",e._getFont,e._setFont),e.boundingSize,e.boundingWidth,cc.defineGetterSetter(e,"boundingWidth",e._getBoundingWidth,e._setBoundingWidth),e.boundingHeight,cc.defineGetterSetter(e,"boundingHeight",e._getBoundingHeight,e._setBoundingHeight),e.fillStyle,cc.defineGetterSetter(e,"fillStyle",e._getFillStyle,e.setFontFillColor),e.strokeStyle,cc.defineGetterSetter(e,"strokeStyle",e._getStrokeStyle,e._setStrokeStyle),e.lineWidth,cc.defineGetterSetter(e,"lineWidth",e._getLineWidth,e._setLineWidth),e.shadowOffset,e.shadowOffsetX,cc.defineGetterSetter(e,"shadowOffsetX",e._getShadowOffsetX,e._setShadowOffsetX),e.shadowOffsetY,cc.defineGetterSetter(e,"shadowOffsetY",e._getShadowOffsetY,e._setShadowOffsetY),e.shadowOpacity,cc.defineGetterSetter(e,"shadowOpacity",e._getShadowOpacity,e._setShadowOpacity),e.shadowBlur,cc.defineGetterSetter(e,"shadowBlur",e._getShadowBlur,e._setShadowBlur)},cc.LabelTTF=cc.Sprite.extend({_dimensions:null,_hAlignment:cc.TEXT_ALIGNMENT_CENTER,_vAlignment:cc.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_shadowEnabled:!1,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColor:null,_strokeEnabled:!1,_strokeColor:null,_strokeSize:0,_textFillColor:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,_needUpdateTexture:!1,_lineWidths:null,_className:"LabelTTF",_lineHeight:0,_fontStyle:"normal",_fontWeight:"normal",initWithString:function(e,t,i,n,r,o){var s;return s=e?e+"":"",i=i||16,n=n||cc.size(0,0),r=r||cc.TEXT_ALIGNMENT_LEFT,o=o||cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._dimensions=cc.size(n.width,n.height),this._fontName=t||"Arial",this._hAlignment=r,this._vAlignment=o,this._fontSize=i,this._renderCmd._setFontStyle(this._fontName,i,this._fontStyle,this._fontWeight),this.string=s,this._renderCmd._setColorsString(),this._renderCmd._updateTexture(),this._setUpdateTextureDirty(),!0},_setUpdateTextureDirty:function(){this._needUpdateTexture=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty)},ctor:function(e,t,i,n,r,o){cc.Sprite.prototype.ctor.call(this),this._dimensions=cc.size(0,0),this._hAlignment=cc.TEXT_ALIGNMENT_LEFT,this._vAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._fontName="Arial",this._shadowEnabled=!1,this._shadowOffset=cc.p(0,0),this._shadowOpacity=0,this._shadowBlur=0,this._strokeEnabled=!1,this._strokeColor=cc.color(255,255,255,255),this._strokeSize=0,this._textFillColor=cc.color(255,255,255,255),this._strokeShadowOffsetX=0,this._strokeShadowOffsetY=0,this._needUpdateTexture=!1,this._lineWidths=[],this._renderCmd._setColorsString(),this._textureLoaded=!0,t&&t instanceof cc.FontDefinition?this.initWithStringAndTextDefinition(e,t):cc.LabelTTF.prototype.initWithString.call(this,e,t,i,n,r,o)},init:function(){return this.initWithString(" ",this._fontName,this._fontSize)},description:function(){return"<cc.LabelTTF | FontName ="+this._fontName+" FontSize = "+this._fontSize.toFixed(1)+">"},getLineHeight:function(){return this._lineHeight||this._renderCmd._getFontClientHeight()},setLineHeight:function(e){this._lineHeight=e},getString:function(){return this._string},getHorizontalAlignment:function(){return this._hAlignment},getVerticalAlignment:function(){return this._vAlignment},getDimensions:function(){return cc.size(this._dimensions)},getFontSize:function(){return this._fontSize},getFontName:function(){return this._fontName},initWithStringAndTextDefinition:function(e,t){return this._updateWithTextDefinition(t,!1),this.string=e,!0},setTextDefinition:function(e){e&&this._updateWithTextDefinition(e,!0)},getTextDefinition:function(){return this._prepareTextDefinition(!1)},enableShadow:function(e,t,i,n){null!=e.r&&null!=e.g&&null!=e.b&&null!=e.a?this._enableShadow(e,t,i):this._enableShadowNoneColor(e,t,i,n)},_enableShadowNoneColor:function(e,t,i,n){i=i||.5,!1===this._shadowEnabled&&(this._shadowEnabled=!0);var r=this._shadowOffset;(r&&r.x!=e||r._y!=t)&&(r.x=e,r.y=t),this._shadowOpacity!=i&&(this._shadowOpacity=i),this._renderCmd._setColorsString(),this._shadowBlur!=n&&(this._shadowBlur=n),this._setUpdateTextureDirty()},_enableShadow:function(e,t,i){this._shadowColor||(this._shadowColor=cc.color(255,255,255,128)),this._shadowColor.r=e.r,this._shadowColor.g=e.g,this._shadowColor.b=e.b;var n,r,o,s;n=t.width||t.x||0,r=t.height||t.y||0,o=null!=e.a?e.a/255:.5,s=i,this._enableShadowNoneColor(n,r,o,s)},_getShadowOffsetX:function(){return this._shadowOffset.x},_setShadowOffsetX:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x!=e&&(this._shadowOffset.x=e,this._setUpdateTextureDirty())},_getShadowOffsetY:function(){return this._shadowOffset._y},_setShadowOffsetY:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset._y!=e&&(this._shadowOffset._y=e,this._setUpdateTextureDirty())},_getShadowOffset:function(){return cc.p(this._shadowOffset.x,this._shadowOffset.y)},_setShadowOffset:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x==e.x&&this._shadowOffset.y==e.y||(this._shadowOffset.x=e.x,this._shadowOffset.y=e.y,this._setUpdateTextureDirty())},_getShadowOpacity:function(){return this._shadowOpacity},_setShadowOpacity:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOpacity!=e&&(this._shadowOpacity=e,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getShadowBlur:function(){return this._shadowBlur},_setShadowBlur:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowBlur!=e&&(this._shadowBlur=e,this._setUpdateTextureDirty())},disableShadow:function(){this._shadowEnabled&&(this._shadowEnabled=!1,this._setUpdateTextureDirty())},enableStroke:function(e,t){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var i=this._strokeColor;i.r===e.r&&i.g===e.g&&i.b===e.b||(i.r=e.r,i.g=e.g,i.b=e.b,this._renderCmd._setColorsString()),this._strokeSize!==t&&(this._strokeSize=t||0),this._setUpdateTextureDirty()},_getStrokeStyle:function(){return this._strokeColor},_setStrokeStyle:function(e){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var t=this._strokeColor;t.r===e.r&&t.g===e.g&&t.b===e.b||(t.r=e.r,t.g=e.g,t.b=e.b,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getLineWidth:function(){return this._strokeSize},_setLineWidth:function(e){!1===this._strokeEnabled&&(this._strokeEnabled=!0),this._strokeSize!==e&&(this._strokeSize=e||0,this._setUpdateTextureDirty())},disableStroke:function(){this._strokeEnabled&&(this._strokeEnabled=!1,this._setUpdateTextureDirty())},setFontFillColor:function(e){var t=this._textFillColor;t.r==e.r&&t.g==e.g&&t.b==e.b||(t.r=e.r,t.g=e.g,t.b=e.b,this._renderCmd._setColorsString(),this._needUpdateTexture=!0)},_getFillStyle:function(){return this._textFillColor},_updateWithTextDefinition:function(e,t){e.fontDimensions?(this._dimensions.width=e.boundingWidth,this._dimensions.height=e.boundingHeight):(this._dimensions.width=0,this._dimensions.height=0),this._hAlignment=e.textAlign,this._vAlignment=e.verticalAlign,this._fontName=e.fontName,this._fontSize=e.fontSize||12,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),e.shadowEnabled&&this.enableShadow(e.shadowOffsetX,e.shadowOffsetY,e.shadowOpacity,e.shadowBlur),e.strokeEnabled&&this.enableStroke(e.strokeStyle,e.lineWidth),this.setFontFillColor(e.fillStyle),t&&this._renderCmd._updateTexture();var i=cc.Node._dirtyFlags;this._renderCmd.setDirtyFlag(i.colorDirty|i.opacityDirty|i.textDirty)},_prepareTextDefinition:function(e){var t=new cc.FontDefinition;if(e?(t.fontSize=this._fontSize,t.boundingWidth=cc.contentScaleFactor()*this._dimensions.width,t.boundingHeight=cc.contentScaleFactor()*this._dimensions.height):(t.fontSize=this._fontSize,t.boundingWidth=this._dimensions.width,t.boundingHeight=this._dimensions.height),t.fontName=this._fontName,t.textAlign=this._hAlignment,t.verticalAlign=this._vAlignment,this._strokeEnabled){t.strokeEnabled=!0;var i=this._strokeColor;t.strokeStyle=cc.color(i.r,i.g,i.b),t.lineWidth=this._strokeSize}else t.strokeEnabled=!1;this._shadowEnabled?(t.shadowEnabled=!0,t.shadowBlur=this._shadowBlur,t.shadowOpacity=this._shadowOpacity,t.shadowOffsetX=(e?cc.contentScaleFactor():1)*this._shadowOffset.x,t.shadowOffsetY=(e?cc.contentScaleFactor():1)*this._shadowOffset.y):t._shadowEnabled=!1;var n=this._textFillColor;return t.fillStyle=cc.color(n.r,n.g,n.b),t},setString:function(e){e=String(e),this._originalText!=e&&(this._originalText=e+"",this._updateString(),this._setUpdateTextureDirty(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},_updateString:function(){this._string&&""!==this._string||this._string===this._originalText||(cc.renderer.childrenOrderDirty=!0),this._string=this._originalText},setHorizontalAlignment:function(e){e!==this._hAlignment&&(this._hAlignment=e,this._setUpdateTextureDirty())},setVerticalAlignment:function(e){e!=this._vAlignment&&(this._vAlignment=e,this._setUpdateTextureDirty())},setDimensions:function(e,t){var i;void 0===t?(i=e.width,t=e.height):i=e,i==this._dimensions.width&&t==this._dimensions.height||(this._dimensions.width=i,this._dimensions.height=t,this._updateString(),this._setUpdateTextureDirty())},_getBoundingWidth:function(){return this._dimensions.width},_setBoundingWidth:function(e){e!=this._dimensions.width&&(this._dimensions.width=e,this._updateString(),this._setUpdateTextureDirty())},_getBoundingHeight:function(){return this._dimensions.height},_setBoundingHeight:function(e){e!=this._dimensions.height&&(this._dimensions.height=e,this._updateString(),this._setUpdateTextureDirty())},setFontSize:function(e){this._fontSize!==e&&(this._fontSize=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},setFontName:function(e){this._fontName&&this._fontName!=e&&(this._fontName=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFont:function(){return this._renderCmd._getFontStyle()},_setFont:function(e){var t=cc.LabelTTF._fontStyleRE.exec(e);t&&(this._fontSize=parseInt(t[1]),this._fontName=t[2],this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},getContentSize:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),cc.Sprite.prototype.getContentSize.call(this)},_getWidth:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),cc.Sprite.prototype._getWidth.call(this)},_getHeight:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),cc.Sprite.prototype._getHeight.call(this)},setTextureRect:function(e,t,i){cc.Sprite.prototype.setTextureRect.call(this,e,t,i,!1)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LabelTTF.CanvasRenderCmd(this):new cc.LabelTTF.WebGLRenderCmd(this)},_setFontStyle:function(e){this._fontStyle!=e&&(this._fontStyle=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontStyle:function(){return this._fontStyle},_setFontWeight:function(e){this._fontWeight!=e&&(this._fontWeight=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontWeight:function(){return this._fontWeight}}),cc.assert(cc.isFunction(cc._tmp.PrototypeLabelTTF),cc._LogInfos.MissingFile,"LabelTTFPropertyDefine.js"),cc._tmp.PrototypeLabelTTF(),delete cc._tmp.PrototypeLabelTTF,cc.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/,cc.LabelTTF.create=function(e,t,i,n,r,o){return new cc.LabelTTF(e,t,i,n,r,o)},cc.LabelTTF.createWithFontDefinition=cc.LabelTTF.create,cc.USE_LA88_LABELS?cc.LabelTTF._SHADER_PROGRAM=cc.SHADER_POSITION_TEXTURECOLOR:cc.LabelTTF._SHADER_PROGRAM=cc.SHADER_POSITION_TEXTUREA8COLOR,cc.LabelTTF.__labelHeightDiv=cc.newElement("div"),cc.LabelTTF.__labelHeightDiv.style.fontFamily="Arial",cc.LabelTTF.__labelHeightDiv.style.position="absolute",cc.LabelTTF.__labelHeightDiv.style.left="-100px",cc.LabelTTF.__labelHeightDiv.style.top="-100px",cc.LabelTTF.__labelHeightDiv.style.lineHeight="normal",document.body?document.body.appendChild(cc.LabelTTF.__labelHeightDiv):cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1),document.body.appendChild(cc.LabelTTF.__labelHeightDiv)},!1),cc.LabelTTF.__getFontHeightByDiv=function(e,t){var i=cc.LabelTTF.__fontHeightCache[e+"."+t];if(i>0)return i;var n=cc.LabelTTF.__labelHeightDiv;return n.innerHTML="ajghl~!",n.style.fontFamily=e,n.style.fontSize=t+"px",i=n.clientHeight,cc.LabelTTF.__fontHeightCache[e+"."+t]=i,n.innerHTML="",i},cc.LabelTTF.__fontHeightCache={},cc.LabelTTF._textAlign=["left","center","right"],cc.LabelTTF._textBaseline=["top","middle","bottom"],cc.LabelTTF.wrapInspection=!0,cc.LabelTTF._wordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)/,cc.LabelTTF._symbolRex=/^[!,.:;}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/,cc.LabelTTF._lastWordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)$/,cc.LabelTTF._lastEnglish=/[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+$/,cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]/,function(){cc.LabelTTF.RenderCmd=function(){this._fontClientHeight=18,this._fontStyleStr="",this._shadowColorStr="rgba(128, 128, 128, 0.5)",this._strokeColorStr="",this._fillColorStr="rgba(255,255,255,1)",this._labelCanvas=null,this._labelContext=null,this._lineWidths=[],this._strings=[],this._isMultiLine=!1};var e=cc.LabelTTF.RenderCmd.prototype;e.constructor=cc.LabelTTF.RenderCmd,e._getLabelContext=function(){if(this._labelContext)return this._labelContext;var e=this._node;if(!this._labelCanvas){var t=cc.newElement("canvas");t.width=1,t.height=1;var i=new cc.Texture2D;i.initWithElement(t),e.setTexture(i),this._labelCanvas=t}return this._labelContext=this._labelCanvas.getContext("2d"),this._labelContext},e._setFontStyle=function(e,t,i,n){this._fontStyleStr=i+" "+n+" "+t+"px '"+e+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(e,t)},e._getFontStyle=function(){return this._fontStyleStr},e._getFontClientHeight=function(){return this._fontClientHeight},e._updateTexture=function(){this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.textDirty^this._dirtyFlag;var e=this._node,t=this._getLabelContext(),i=this._labelCanvas,n=e._contentSize;if(0===e._string.length)return i.width=1,i.height=n.height||1,e._texture&&e._texture.handleLoadedTexture(),e.setTextureRect(cc.rect(0,0,1,n.height)),!0;t.font=this._fontStyleStr,this._updateTTF();var r=n.width,o=n.height,s=i.width==r&&i.height==o;return i.width=r,i.height=o,s&&t.clearRect(0,0,r,o),this._drawTTFInCanvas(t),e._texture&&e._texture.handleLoadedTexture(),e.setTextureRect(cc.rect(0,0,r,o)),!0},e._measureConfig=function(){this._getLabelContext().font=this._fontStyleStr},e._measure=function(e){return this._getLabelContext().measureText(e).width},e._updateTTF=function(){var e,t,i=this._node,n=i._dimensions.width,r=this._lineWidths;if(r.length=0,this._isMultiLine=!1,this._measureConfig(),0!==n)for(this._strings=i._string.split("\n"),e=0;e<this._strings.length;e++)this._checkWarp(this._strings,e,n);else for(this._strings=i._string.split("\n"),e=0,t=this._strings.length;e<t;e++)r.push(this._measure(this._strings[e]));this._strings.length>0&&(this._isMultiLine=!0);var o,s=0,a=0;if(i._strokeEnabled&&(s=a=2*i._strokeSize),i._shadowEnabled){var c=i._shadowOffset;s+=2*Math.abs(c.x),a+=2*Math.abs(c.y)}o=0===n?this._isMultiLine?cc.size(Math.ceil(Math.max.apply(Math,r)+s),Math.ceil(this._fontClientHeight*this._strings.length+a)):cc.size(Math.ceil(this._measure(i._string)+s),Math.ceil(this._fontClientHeight+a)):0===i._dimensions.height?this._isMultiLine?cc.size(Math.ceil(n+s),Math.ceil(i.getLineHeight()*this._strings.length+a)):cc.size(Math.ceil(n+s),Math.ceil(i.getLineHeight()+a)):cc.size(Math.ceil(n+s),Math.ceil(i._dimensions.height+a)),"normal"!=i._getFontStyle()&&(o.width=Math.ceil(o.width+.3*i._fontSize)),i.setContentSize(o),i._strokeShadowOffsetX=s,i._strokeShadowOffsetY=a;var l=i._anchorPoint;this._anchorPointInPoints.x=.5*s+(o.width-s)*l.x,this._anchorPointInPoints.y=.5*a+(o.height-a)*l.y},e._drawTTFInCanvas=function(e){if(e){var t=this._node,i=t._strokeShadowOffsetX,n=t._strokeShadowOffsetY,r=t._contentSize.height-n,o=t._vAlignment,s=t._hAlignment,a=t._strokeSize;e.setTransform(1,0,0,1,0+.5*i,r+.5*n),e.font!=this._fontStyleStr&&(e.font=this._fontStyleStr),e.fillStyle=this._fillColorStr;var c=0,l=0,u=t._strokeEnabled;if(u&&(e.lineWidth=2*a,e.strokeStyle=this._strokeColorStr),t._shadowEnabled){var h=t._shadowOffset;e.shadowColor=this._shadowColorStr,e.shadowOffsetX=h.x,e.shadowOffsetY=-h.y,e.shadowBlur=t._shadowBlur}e.textBaseline=cc.LabelTTF._textBaseline[o],e.textAlign=cc.LabelTTF._textAlign[s];var d=t._contentSize.width-i,p=t.getLineHeight(),_=(p-this._fontClientHeight)/2;if(s===cc.TEXT_ALIGNMENT_RIGHT?c+=d:s===cc.TEXT_ALIGNMENT_CENTER?c+=d/2:c+=0,this._isMultiLine){var f=this._strings.length;o===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?l=p-2*_+r-p*f:o===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(l=(p-2*_)/2+(r-p*f)/2);for(var m=0;m<f;m++){var g=this._strings[m],y=-r+(p*m+_)+l;u&&e.strokeText(g,c,y),e.fillText(g,c,y)}}else o===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM||(o===cc.VERTICAL_TEXT_ALIGNMENT_TOP?l-=r:l-=.5*r),u&&e.strokeText(t._string,c,l),e.fillText(t._string,c,l)}},e._checkWarp=function(e,t,i){var n=e[t],r=this._measure(n);if(r>i&&n.length>1){for(var o,s=n.length*(i/r)|0,a=n.substr(s),c=r-this._measure(a),l=0,u=0;c>i&&u++<100;)s*=i/c,s|=0,a=n.substr(s),c=r-this._measure(a);for(u=0;c<i&&u++<100;){if(a){var h=cc.LabelTTF._wordRex.exec(a);l=h?h[0].length:1,o=a}s+=l,a=n.substr(s),c=r-this._measure(a)}0===(s-=l)&&(s=1,o=o.substr(1));var d,p=n.substr(0,s);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(o||a)&&(s-=(d=cc.LabelTTF._lastWordRex.exec(p))?d[0].length:0,o=n.substr(s),p=n.substr(0,s)),cc.LabelTTF._firsrEnglish.test(o)&&(d=cc.LabelTTF._lastEnglish.exec(p))&&p!==d[0]&&(s-=d[0].length,o=n.substr(s),p=n.substr(0,s)),e[t]=o||a,e.splice(t,0,p)}}}(),function(){cc.LabelTTF.CanvasRenderCmd=function(e){cc.Sprite.CanvasRenderCmd.call(this,e),cc.LabelTTF.RenderCmd.call(this)},cc.LabelTTF.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype),cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CanvasRenderCmd.prototype);var e=cc.LabelTTF.CanvasRenderCmd.prototype;e.constructor=cc.LabelTTF.CanvasRenderCmd,e.updateStatus=function(){var e=cc.Node._dirtyFlags,t=this._dirtyFlag,i=t&e.colorDirty,n=t&e.opacityDirty;i&&this._updateDisplayColor(),n&&this._updateDisplayOpacity(),i?this._updateColor():t&e.textDirty&&this._updateTexture(),this._dirtyFlag&e.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag)},e._syncStatus=function(e){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e?e._node:null;n&&n._cascadeColorEnabled&&e._dirtyFlag&t.colorDirty&&(i|=t.colorDirty),n&&n._cascadeOpacityEnabled&&e._dirtyFlag&t.opacityDirty&&(i|=t.opacityDirty),e&&e._dirtyFlag&t.transformDirty&&(i|=t.transformDirty);var r=i&t.colorDirty,o=i&t.opacityDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),r?this._updateColor():i&t.textDirty&&this._updateTexture(),i&t.transformDirty&&this.transform(e)},e._setColorsString=function(){var e=this._displayedColor,t=this._node,i=t._shadowColor||this._displayedColor,n=t._strokeColor,r=t._textFillColor;this._shadowColorStr="rgba("+(0|.5*i.r)+","+(0|.5*i.g)+","+(0|.5*i.b)+","+t._shadowOpacity+")",this._fillColorStr="rgba("+(0|e.r/255*r.r)+","+(0|e.g/255*r.g)+","+(0|e.b/255*r.b)+", 1)",this._strokeColorStr="rgba("+(0|e.r/255*n.r)+","+(0|e.g/255*n.g)+","+(0|e.b/255*n.b)+", 1)"},e._updateColor=function(){this._setColorsString(),this._updateTexture()}}(),function(){cc.LabelTTF.WebGLRenderCmd=function(e){cc.Sprite.WebGLRenderCmd.call(this,e),cc.LabelTTF.RenderCmd.call(this),this.setShaderProgram(cc.shaderCache.programForKey(cc.LabelTTF._SHADER_PROGRAM))};var e=cc.LabelTTF.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);cc.inject(cc.LabelTTF.RenderCmd.prototype,e),e.constructor=cc.LabelTTF.WebGLRenderCmd,e._setColorsString=function(){this.setDirtyFlag(cc.Node._dirtyFlags.textDirty);var e=this._node,t=e._strokeColor,i=e._textFillColor;this._shadowColorStr="rgba(128,128,128,"+e._shadowOpacity+")",this._fillColorStr="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b)+", 1)",this._strokeColorStr="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+", 1)"},e.updateStatus=function(){var e=cc.Node._dirtyFlags,t=this._dirtyFlag,i=t&e.colorDirty,n=t&e.opacityDirty;i&&this._updateDisplayColor(),n&&this._updateDisplayOpacity(),i||n?(this._setColorsString(),this._updateColor(),this._updateTexture()):t&e.textDirty&&this._updateTexture(),this._dirtyFlag&e.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag)},e._syncStatus=function(e){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e?e._node:null;n&&n._cascadeColorEnabled&&e._dirtyFlag&t.colorDirty&&(i|=t.colorDirty),n&&n._cascadeOpacityEnabled&&e._dirtyFlag&t.opacityDirty&&(i|=t.opacityDirty),e&&e._dirtyFlag&t.transformDirty&&(i|=t.transformDirty);var r=i&t.colorDirty,o=i&t.opacityDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),r||o?(this._setColorsString(),this._updateColor(),this._updateTexture()):i&t.textDirty&&this._updateTexture(),this.transform(e)}}(),cc.HashElement=cc.Class.extend({actions:null,target:null,actionIndex:0,currentAction:null,currentActionSalvaged:!1,paused:!1,hh:null,ctor:function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.currentActionSalvaged=!1,this.paused=!1,this.hh=null}}),cc.ActionManager=cc.Class.extend({_hashTargets:null,_arrayTargets:null,_currentTarget:null,_currentTargetSalvaged:!1,_searchElementByTarget:function(e,t){for(var i=0;i<e.length;i++)if(t==e[i].target)return e[i];return null},ctor:function(){this._hashTargets={},this._arrayTargets=[],this._currentTarget=null,this._currentTargetSalvaged=!1},addAction:function(e,t,i){if(!e)throw"cc.ActionManager.addAction(): action must be non-null";if(!t)throw"cc.ActionManager.addAction(): action must be non-null";var n=this._hashTargets[t.__instanceId];n||((n=new cc.HashElement).paused=i,n.target=t,this._hashTargets[t.__instanceId]=n,this._arrayTargets.push(n)),this._actionAllocWithHashElement(n),n.actions.push(e),e.startWithTarget(t)},removeAllActions:function(){for(var e=this._arrayTargets,t=0;t<e.length;t++){var i=e[t];i&&this.removeAllActionsFromTarget(i.target,!0)}},removeAllActionsFromTarget:function(e,t){if(null!=e){var i=this._hashTargets[e.__instanceId];i&&(-1===i.actions.indexOf(i.currentAction)||i.currentActionSalvaged||(i.currentActionSalvaged=!0),i.actions.length=0,this._currentTarget!=i||t?this._deleteHashElement(i):this._currentTargetSalvaged=!0)}},removeAction:function(e){if(null!=e){var t=e.getOriginalTarget(),i=this._hashTargets[t.__instanceId];if(i){for(var n=0;n<i.actions.length;n++)if(i.actions[n]==e){i.actions.splice(n,1);break}}else cc.log(cc._LogInfos.ActionManager_removeAction)}},removeActionByTag:function(e,t){e==cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_addAction),cc.assert(t,cc._LogInfos.ActionManager_addAction);var i=this._hashTargets[t.__instanceId];if(i)for(var n=i.actions.length,r=0;r<n;++r){var o=i.actions[r];if(o&&o.getTag()===e&&o.getOriginalTarget()==t){this._removeActionAtIndex(r,i);break}}},getActionByTag:function(e,t){e==cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_getActionByTag);var i=this._hashTargets[t.__instanceId];if(i){if(null!=i.actions)for(var n=0;n<i.actions.length;++n){var r=i.actions[n];if(r&&r.getTag()===e)return r}cc.log(cc._LogInfos.ActionManager_getActionByTag_2,e)}return null},numberOfRunningActionsInTarget:function(e){var t=this._hashTargets[e.__instanceId];return t&&t.actions?t.actions.length:0},pauseTarget:function(e){var t=this._hashTargets[e.__instanceId];t&&(t.paused=!0)},resumeTarget:function(e){var t=this._hashTargets[e.__instanceId];t&&(t.paused=!1)},pauseAllRunningActions:function(){for(var e=[],t=this._arrayTargets,i=0;i<t.length;i++){var n=t[i];n&&!n.paused&&(n.paused=!0,e.push(n.target))}return e},resumeTargets:function(e){if(e)for(var t=0;t<e.length;t++)e[t]&&this.resumeTarget(e[t])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdateForTarget(this)},_removeActionAtIndex:function(e,t){t.actions[e]!=t.currentAction||t.currentActionSalvaged||(t.currentActionSalvaged=!0),t.actions.splice(e,1),t.actionIndex>=e&&t.actionIndex--,0==t.actions.length&&(this._currentTarget==t?this._currentTargetSalvaged=!0:this._deleteHashElement(t))},_deleteHashElement:function(e){e&&(delete this._hashTargets[e.target.__instanceId],cc.arrayRemoveObject(this._arrayTargets,e),e.actions=null,e.target=null)},_actionAllocWithHashElement:function(e){null==e.actions&&(e.actions=[])},update:function(e){for(var t,i=this._arrayTargets,n=0;n<i.length;n++){if(this._currentTarget=i[n],!(t=this._currentTarget).paused)for(t.actionIndex=0;t.actionIndex<(t.actions?t.actions.length:0);t.actionIndex++)if(t.currentAction=t.actions[t.actionIndex],t.currentAction){if(t.currentActionSalvaged=!1,t.currentAction.step(e*(t.currentAction._speedMethod?t.currentAction._speed:1)),t.currentActionSalvaged)t.currentAction=null;else if(t.currentAction.isDone()){t.currentAction.stop();var r=t.currentAction;t.currentAction=null,this.removeAction(r)}t.currentAction=null}this._currentTargetSalvaged&&0===t.actions.length&&this._deleteHashElement(t)}}}),cc.kmScalar=Number,cc.kmBool=Number,cc.kmEnum=Number,cc.KM_FALSE=0,cc.KM_TRUE=1,cc.kmPI=3.141592,cc.kmPIOver180=.017453,cc.kmPIUnder180=57.295779,cc.kmEpsilon=1/64,cc.kmSQR=function(e){return e*e},cc.kmDegreesToRadians=function(e){return e*cc.kmPIOver180},cc.kmRadiansToDegrees=function(e){return e*cc.kmPIUnder180},cc.kmMin=function(e,t){return e<t?e:t},cc.kmMax=function(e,t){return e>t?e:t},cc.kmAlmostEqual=function(e,t){return e+cc.kmEpsilon>t&&e-cc.kmEpsilon<t},cc.kmVec2=function(e,t){this.x=e||0,this.y=t||0},cc.kmVec2Fill=function(e,t,i){return e.x=t,e.y=i,e},cc.kmVec2Length=function(e){return Math.sqrt(cc.kmSQR(e.x)+cc.kmSQR(e.y))},cc.kmVec2LengthSq=function(e){return cc.kmSQR(e.x)+cc.kmSQR(e.y)},cc.kmVec2Normalize=function(e,t){var i=1/cc.kmVec2Length(t),n=new cc.kmVec2;return n.x=t.x*i,n.y=t.y*i,e.x=n.x,e.y=n.y,e},cc.kmVec2Add=function(e,t,i){return e.x=t.x+i.x,e.y=t.y+i.y,e},cc.kmVec2Dot=function(e,t){return e.x*t.x+e.y*t.y},cc.kmVec2Subtract=function(e,t,i){return e.x=t.x-i.x,e.y=t.y-i.y,e},cc.kmVec2Transform=function(e,t,i){var n=new cc.kmVec2;return n.x=t.x*i.mat[0]+t.y*i.mat[3]+i.mat[6],n.y=t.x*i.mat[1]+t.y*i.mat[4]+i.mat[7],e.x=n.x,e.y=n.y,e},cc.kmVec2TransformCoord=function(e,t,i){return null},cc.kmVec2Scale=function(e,t,i){return e.x=t.x*i,e.y=t.y*i,e},cc.kmVec2AreEqual=function(e,t){return e.x<t.x+cc.kmEpsilon&&e.x>t.x-cc.kmEpsilon&&e.y<t.y+cc.kmEpsilon&&e.y>t.y-cc.kmEpsilon},cc.kmVec3=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},cc.kmVec3Fill=function(e,t,i,n){return e?(e.x=t,e.y=i,e.z=n,e):new cc.kmVec3(t,i,n)},cc.kmVec3Length=function(e){return Math.sqrt(cc.kmSQR(e.x)+cc.kmSQR(e.y)+cc.kmSQR(e.z))},cc.kmVec3LengthSq=function(e){return cc.kmSQR(e.x)+cc.kmSQR(e.y)+cc.kmSQR(e.z)},cc.kmVec3Normalize=function(e,t){var i=1/cc.kmVec3Length(t);return e.x=t.x*i,e.y=t.y*i,e.z=t.z*i,e},cc.kmVec3Cross=function(e,t,i){return e.x=t.y*i.z-t.z*i.y,e.y=t.z*i.x-t.x*i.z,e.z=t.x*i.y-t.y*i.x,e},cc.kmVec3Dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},cc.kmVec3Add=function(e,t,i){return e.x=t.x+i.x,e.y=t.y+i.y,e.z=t.z+i.z,e},cc.kmVec3Subtract=function(e,t,i){return e.x=t.x-i.x,e.y=t.y-i.y,e.z=t.z-i.z,e},cc.kmVec3Transform=function(e,t,i){return e.x=t.x*i.mat[0]+t.y*i.mat[4]+t.z*i.mat[8]+i.mat[12],e.y=t.x*i.mat[1]+t.y*i.mat[5]+t.z*i.mat[9]+i.mat[13],e.z=t.x*i.mat[2]+t.y*i.mat[6]+t.z*i.mat[10]+i.mat[14],e},cc.kmVec3TransformNormal=function(e,t,i){return e.x=t.x*i.mat[0]+t.y*i.mat[4]+t.z*i.mat[8],e.y=t.x*i.mat[1]+t.y*i.mat[5]+t.z*i.mat[9],e.z=t.x*i.mat[2]+t.y*i.mat[6]+t.z*i.mat[10],e},cc.kmVec3TransformCoord=function(e,t,i){var n=new cc.kmVec4,r=new cc.kmVec4;return cc.kmVec4Fill(r,t.x,t.y,t.z,1),cc.kmVec4Transform(n,r,i),e.x=n.x/n.w,e.y=n.y/n.w,e.z=n.z/n.w,e},cc.kmVec3Scale=function(e,t,i){return e.x=t.x*i,e.y=t.y*i,e.z=t.z*i,e},cc.kmVec3AreEqual=function(e,t){return e.x<t.x+cc.kmEpsilon&&e.x>t.x-cc.kmEpsilon&&e.y<t.y+cc.kmEpsilon&&e.y>t.y-cc.kmEpsilon&&e.z<t.z+cc.kmEpsilon&&e.z>t.z-cc.kmEpsilon?1:0},cc.kmVec3InverseTransform=function(e,t,i){var n=new cc.kmVec3(t.x-i.mat[12],t.y-i.mat[13],t.z-i.mat[14]);return e.x=n.x*i.mat[0]+n.y*i.mat[1]+n.z*i.mat[2],e.y=n.x*i.mat[4]+n.y*i.mat[5]+n.z*i.mat[6],e.z=n.x*i.mat[8]+n.y*i.mat[9]+n.z*i.mat[10],e},cc.kmVec3InverseTransformNormal=function(e,t,i){return e.x=t.x*i.mat[0]+t.y*i.mat[1]+t.z*i.mat[2],e.y=t.x*i.mat[4]+t.y*i.mat[5]+t.z*i.mat[6],e.z=t.x*i.mat[8]+t.y*i.mat[9]+t.z*i.mat[10],e},cc.kmVec3Assign=function(e,t){return e==t?e:(e.x=t.x,e.y=t.y,e.z=t.z,e)},cc.kmVec3Zero=function(e){return e.x=0,e.y=0,e.z=0,e},cc.kmVec3ToTypeArray=function(e){if(!e)return null;var t=new Float32Array(3);return t[0]=e.x,t[1]=e.y,t[2]=e.z,t},cc.kmVec4=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=n||0},cc.kmVec4Fill=function(e,t,i,n,r){return e.x=t,e.y=i,e.z=n,e.w=r,e},cc.kmVec4Add=function(e,t,i){return e.x=t.x+i.x,e.y=t.y+i.y,e.z=t.z+i.z,e.w=t.w+i.w,e},cc.kmVec4Dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},cc.kmVec4Length=function(e){return Math.sqrt(cc.kmSQR(e.x)+cc.kmSQR(e.y)+cc.kmSQR(e.z)+cc.kmSQR(e.w))},cc.kmVec4LengthSq=function(e){return cc.kmSQR(e.x)+cc.kmSQR(e.y)+cc.kmSQR(e.z)+cc.kmSQR(e.w)},cc.kmVec4Lerp=function(e,t,i,n){return e},cc.kmVec4Normalize=function(e,t){var i=1/cc.kmVec4Length(t);return e.x*=i,e.y*=i,e.z*=i,e.w*=i,e},cc.kmVec4Scale=function(e,t,i){return cc.kmVec4Normalize(e,t),e.x*=i,e.y*=i,e.z*=i,e.w*=i,e},cc.kmVec4Subtract=function(e,t,i){return e.x=t.x-i.x,e.y=t.y-i.y,e.z=t.z-i.z,e.w=t.w-i.w,e},cc.kmVec4Transform=function(e,t,i){return e.x=t.x*i.mat[0]+t.y*i.mat[4]+t.z*i.mat[8]+t.w*i.mat[12],e.y=t.x*i.mat[1]+t.y*i.mat[5]+t.z*i.mat[9]+t.w*i.mat[13],e.z=t.x*i.mat[2]+t.y*i.mat[6]+t.z*i.mat[10]+t.w*i.mat[14],e.w=t.x*i.mat[3]+t.y*i.mat[7]+t.z*i.mat[11]+t.w*i.mat[15],e},cc.kmVec4TransformArray=function(e,t,i,n,r,o){for(var s=0;s<o;){var a=i+s*n,c=e+s*t;cc.kmVec4Transform(c,a,r),++s}return e},cc.kmVec4AreEqual=function(e,t){return e.x<t.x+cc.kmEpsilon&&e.x>t.x-cc.kmEpsilon&&e.y<t.y+cc.kmEpsilon&&e.y>t.y-cc.kmEpsilon&&e.z<t.z+cc.kmEpsilon&&e.z>t.z-cc.kmEpsilon&&e.w<t.w+cc.kmEpsilon&&e.w>t.w-cc.kmEpsilon},cc.kmVec4Assign=function(e,t){return e==t?(cc.log("destVec and srcVec are same object"),e):(e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e)},cc.kmVec4ToTypeArray=function(e){if(!e)return null;var t=new Float32Array(4);return t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w,t},cc.kmRay2=function(e,t){this.start=e||new cc.kmVec2,this.start=e||new cc.kmVec2},cc.kmRay2Fill=function(e,t,i,n,r){e.start.x=t,e.start.y=i,e.dir.x=n,e.dir.y=r},cc.kmRay2IntersectLineSegment=function(e,t,i,n){var r,o,s,a=e.start.x,c=e.start.y,l=e.start.x+e.dir.x,u=e.start.y+e.dir.y,h=t.x,d=t.y,p=i.x,_=i.y,f=(_-d)*(l-a)-(p-h)*(u-c);return f>-cc.kmEpsilon&&f<cc.kmEpsilon?cc.KM_FALSE:(r=((p-h)*(c-d)-(_-d)*(a-h))/f,o=a+r*(l-a),s=c+r*(u-c),o<cc.kmMin(t.x,i.x)-cc.kmEpsilon||o>cc.kmMax(t.x,i.x)+cc.kmEpsilon||s<cc.kmMin(t.y,i.y)-cc.kmEpsilon||s>cc.kmMax(t.y,i.y)+cc.kmEpsilon?cc.KM_FALSE:o<cc.kmMin(a,l)-cc.kmEpsilon||o>cc.kmMax(a,l)+cc.kmEpsilon||s<cc.kmMin(c,u)-cc.kmEpsilon||s>cc.kmMax(c,u)+cc.kmEpsilon?cc.KM_FALSE:(n.x=o,n.y=s,cc.KM_TRUE))},cc.calculate_line_normal=function(e,t,i){var n=new cc.kmVec2;cc.kmVec2Subtract(n,t,e),i.x=-n.y,i.y=n.x,cc.kmVec2Normalize(i,i)},cc.kmRay2IntersectTriangle=function(e,t,i,n,r,o){var s,a,c=new cc.kmVec2,l=new cc.kmVec2,u=new cc.kmVec2,h=1e4,d=cc.KM_FALSE;return cc.kmRay2IntersectLineSegment(e,t,i,c)&&(s=new cc.kmVec2,d=cc.KM_TRUE,(a=cc.kmVec2Length(cc.kmVec2Subtract(s,c,e.start)))<h&&(l.x=c.x,l.y=c.y,h=a,cc.calculate_line_normal(t,i,u))),cc.kmRay2IntersectLineSegment(e,i,n,c)&&(s=new cc.kmVec2,d=cc.KM_TRUE,(a=cc.kmVec2Length(cc.kmVec2Subtract(s,c,e.start)))<h&&(l.x=c.x,l.y=c.y,h=a,cc.calculate_line_normal(i,n,u))),cc.kmRay2IntersectLineSegment(e,n,t,c)&&(s=new cc.kmVec2,d=cc.KM_TRUE,(a=cc.kmVec2Length(cc.kmVec2Subtract(s,c,e.start)))<h&&(l.x=c.x,l.y=c.y,h=a,cc.calculate_line_normal(n,t,u))),d&&(r.x=l.x,r.y=l.y,o&&(o.x=u.x,o.y=u.y)),d},cc.kmRay2IntersectCircle=function(e,t,i,n){cc.log("cc.kmRay2IntersectCircle() has not been implemented.")};var Float32Array=Float32Array||Array;cc.kmMat3=function(){this.mat=new Float32Array([0,0,0,0,0,0,0,0,0])},cc.kmMat3Fill=function(e,t){for(var i=0;i<9;i++)e.mat[i]=t;return e},cc.kmMat3Adjugate=function(e,t){return e.mat[0]=t.mat[4]*t.mat[8]-t.mat[5]*t.mat[7],e.mat[1]=t.mat[2]*t.mat[7]-t.mat[1]*t.mat[8],e.mat[2]=t.mat[1]*t.mat[5]-t.mat[2]*t.mat[4],e.mat[3]=t.mat[5]*t.mat[6]-t.mat[3]*t.mat[8],e.mat[4]=t.mat[0]*t.mat[8]-t.mat[2]*t.mat[6],e.mat[5]=t.mat[2]*t.mat[3]-t.mat[0]*t.mat[5],e.mat[6]=t.mat[3]*t.mat[7]-t.mat[4]*t.mat[6],e.mat[8]=t.mat[0]*t.mat[4]-t.mat[1]*t.mat[3],e},cc.kmMat3Identity=function(e){return e.mat[1]=e.mat[2]=e.mat[3]=e.mat[5]=e.mat[6]=e.mat[7]=0,e.mat[0]=e.mat[4]=e.mat[8]=1,e},cc.kmMat3Inverse=function(e,t,i){var n,r=new cc.kmMat3;return 0===t?null:(n=1/t,cc.kmMat3Adjugate(r,i),cc.kmMat3ScalarMultiply(e,r,n),e)},cc.kmMat3._identity=new Float32Array([1,0,0,0,1,0,0,0,1]),cc.kmMat3IsIdentity=function(e){for(var t=0;t<9;t++)if(cc.kmMat3._identity[t]!==e.mat[t])return!1;return!0},cc.kmMat3Transpose=function(e,t){var i,n;for(i=0;i<3;++i)for(n=0;n<3;++n)e.mat[3*i+n]=t.mat[3*n+i];return e},cc.kmMat3Determinant=function(e){var t;return t=e.mat[0]*e.mat[4]*e.mat[8]+e.mat[1]*e.mat[5]*e.mat[6]+e.mat[2]*e.mat[3]*e.mat[7],t-=e.mat[2]*e.mat[4]*e.mat[6]+e.mat[0]*e.mat[5]*e.mat[7]+e.mat[1]*e.mat[3]*e.mat[8]},cc.kmMat3Multiply=function(e,t,i){var n=t.mat,r=i.mat;return e.mat[0]=n[0]*r[0]+n[3]*r[1]+n[6]*r[2],e.mat[1]=n[1]*r[0]+n[4]*r[1]+n[7]*r[2],e.mat[2]=n[2]*r[0]+n[5]*r[1]+n[8]*r[2],e.mat[3]=n[0]*r[3]+n[3]*r[4]+n[6]*r[5],e.mat[4]=n[1]*r[3]+n[4]*r[4]+n[7]*r[5],e.mat[5]=n[2]*r[3]+n[5]*r[4]+n[8]*r[5],e.mat[6]=n[0]*r[6]+n[3]*r[7]+n[6]*r[8],e.mat[7]=n[1]*r[6]+n[4]*r[7]+n[7]*r[8],e.mat[8]=n[2]*r[6]+n[5]*r[7]+n[8]*r[8],e},cc.kmMat3ScalarMultiply=function(e,t,i){for(var n=0;n<9;n++)e.mat[n]=t.mat[n]*i;return e},cc.kmMat3RotationAxisAngle=function(e,t,i){var n=Math.cos(i),r=Math.sin(i);return e.mat[0]=n+t.x*t.x*(1-n),e.mat[1]=t.z*r+t.y*t.x*(1-n),e.mat[2]=-t.y*r+t.z*t.x*(1-n),e.mat[3]=-t.z*r+t.x*t.y*(1-n),e.mat[4]=n+t.y*t.y*(1-n),e.mat[5]=t.x*r+t.z*t.y*(1-n),e.mat[6]=t.y*r+t.x*t.z*(1-n),e.mat[7]=-t.x*r+t.y*t.z*(1-n),e.mat[8]=n+t.z*t.z*(1-n),e},cc.kmMat3Assign=function(e,t){if(e==t)return cc.log("cc.kmMat3Assign(): pOut equals pIn"),e;for(var i=0;i<9;i++)e.mat[i]=t.mat[i];return e},cc.kmMat3AreEqual=function(e,t){if(e==t)return!0;for(var i=0;i<9;++i)if(!(e.mat[i]+cc.kmEpsilon>t.mat[i]&&e.mat[i]-cc.kmEpsilon<t.mat[i]))return!1;return!0},cc.kmMat3RotationX=function(e,t){return e.mat[0]=1,e.mat[1]=0,e.mat[2]=0,e.mat[3]=0,e.mat[4]=Math.cos(t),e.mat[5]=Math.sin(t),e.mat[6]=0,e.mat[7]=-Math.sin(t),e.mat[8]=Math.cos(t),e},cc.kmMat3RotationY=function(e,t){return e.mat[0]=Math.cos(t),e.mat[1]=0,e.mat[2]=-Math.sin(t),e.mat[3]=0,e.mat[4]=1,e.mat[5]=0,e.mat[6]=Math.sin(t),e.mat[7]=0,e.mat[8]=Math.cos(t),e},cc.kmMat3RotationZ=function(e,t){return e.mat[0]=Math.cos(t),e.mat[1]=-Math.sin(t),e.mat[2]=0,e.mat[3]=Math.sin(t),e.mat[4]=Math.cos(t),e.mat[5]=0,e.mat[6]=0,e.mat[7]=0,e.mat[8]=1,e},cc.kmMat3Rotation=function(e,t){return e.mat[0]=Math.cos(t),e.mat[1]=Math.sin(t),e.mat[2]=0,e.mat[3]=-Math.sin(t),e.mat[4]=Math.cos(t),e.mat[5]=0,e.mat[6]=0,e.mat[7]=0,e.mat[8]=1,e},cc.kmMat3Scaling=function(e,t,i){return cc.kmMat3Identity(e),e.mat[0]=t,e.mat[4]=i,e},cc.kmMat3Translation=function(e,t,i){return cc.kmMat3Identity(e),e.mat[6]=t,e.mat[7]=i,e},cc.kmMat3RotationQuaternion=function(e,t){return t&&e?(e.mat[0]=1-2*(t.y*t.y+t.z*t.z),e.mat[1]=2*(t.x*t.y-t.w*t.z),e.mat[2]=2*(t.x*t.z+t.w*t.y),e.mat[3]=2*(t.x*t.y+t.w*t.z),e.mat[4]=1-2*(t.x*t.x+t.z*t.z),e.mat[5]=2*(t.y*t.z-t.w*t.x),e.mat[6]=2*(t.x*t.z-t.w*t.y),e.mat[7]=2*(t.y*t.z+t.w*t.x),e.mat[8]=1-2*(t.x*t.x+t.y*t.y),e):null},cc.kmMat3RotationToAxisAngle=function(e,t,i){return cc.kmQuaternionRotationMatrix(void 0,i),cc.kmQuaternionToAxisAngle(void 0,e,t),e},cc.kmMat4=function(){this.mat=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},cc.kmMat4Fill=function(e,t){e.mat[0]=e.mat[1]=e.mat[2]=e.mat[3]=e.mat[4]=e.mat[5]=e.mat[6]=e.mat[7]=e.mat[8]=e.mat[9]=e.mat[10]=e.mat[11]=e.mat[12]=e.mat[13]=e.mat[14]=e.mat[15]=t},cc.kmMat4Identity=function(e){return e.mat[1]=e.mat[2]=e.mat[3]=e.mat[4]=e.mat[6]=e.mat[7]=e.mat[8]=e.mat[9]=e.mat[11]=e.mat[12]=e.mat[13]=e.mat[14]=0,e.mat[0]=e.mat[5]=e.mat[10]=e.mat[15]=1,e},cc.kmMat4._get=function(e,t,i){return e.mat[t+4*i]},cc.kmMat4._set=function(e,t,i,n){e.mat[t+4*i]=n},cc.kmMat4._swap=function(e,t,i,n,r){var o=cc.kmMat4._get(e,t,i);cc.kmMat4._set(e,t,i,cc.kmMat4._get(e,n,r)),cc.kmMat4._set(e,n,r,o)},cc.kmMat4._gaussj=function(e,t){var i,n,r,o,s,a,c,l,u=0,h=0,d=[0,0,0,0],p=[0,0,0,0],_=[0,0,0,0];for(i=0;i<4;i++){for(a=0,n=0;n<4;n++)if(1!=_[n])for(r=0;r<4;r++)0==_[r]&&Math.abs(cc.kmMat4._get(e,n,r))>=a&&(a=Math.abs(cc.kmMat4._get(e,n,r)),h=n,u=r);if(++_[u],h!=u){for(o=0;o<4;o++)cc.kmMat4._swap(e,h,o,u,o);for(o=0;o<4;o++)cc.kmMat4._swap(t,h,o,u,o)}if(p[i]=h,d[i]=u,0==cc.kmMat4._get(e,u,u))return cc.KM_FALSE;for(l=1/cc.kmMat4._get(e,u,u),cc.kmMat4._set(e,u,u,1),o=0;o<4;o++)cc.kmMat4._set(e,u,o,cc.kmMat4._get(e,u,o)*l);for(o=0;o<4;o++)cc.kmMat4._set(t,u,o,cc.kmMat4._get(t,u,o)*l);for(s=0;s<4;s++)if(s!=u){for(c=cc.kmMat4._get(e,s,u),cc.kmMat4._set(e,s,u,0),o=0;o<4;o++)cc.kmMat4._set(e,s,o,cc.kmMat4._get(e,s,o)-cc.kmMat4._get(e,u,o)*c);for(o=0;o<4;o++)cc.kmMat4._set(t,s,o,cc.kmMat4._get(e,s,o)-cc.kmMat4._get(t,u,o)*c)}}for(o=3;o>=0;o--)if(p[o]!=d[o])for(r=0;r<4;r++)cc.kmMat4._swap(e,r,p[o],r,d[o]);return cc.KM_TRUE},cc.kmMat4._identity=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),cc.kmMat4Inverse=function(e,t){var i=new cc.kmMat4,n=new cc.kmMat4;return cc.kmMat4Assign(i,t),cc.kmMat4Identity(n),cc.kmMat4._gaussj(i,n)==cc.KM_FALSE?null:(cc.kmMat4Assign(e,i),e)},cc.kmMat4IsIdentity=function(e){for(var t=0;t<16;t++)if(cc.kmMat4._identity[t]!=e.mat[t])return!1;return!0},cc.kmMat4Transpose=function(e,t){var i,n,r=e.mat,o=t.mat;for(n=0;n<4;++n)for(i=0;i<4;++i)r[4*n+i]=o[4*i+n];return e},cc.kmMat4Multiply=function(e,t,i){var n=e.mat,r=t.mat[0],o=t.mat[1],s=t.mat[2],a=t.mat[3],c=t.mat[4],l=t.mat[5],u=t.mat[6],h=t.mat[7],d=t.mat[8],p=t.mat[9],_=t.mat[10],f=t.mat[11],m=t.mat[12],g=t.mat[13],y=t.mat[14],T=t.mat[15],v=i.mat[0],S=i.mat[1],C=i.mat[2],E=i.mat[3],b=i.mat[4],A=i.mat[5],x=i.mat[6],R=i.mat[7],P=i.mat[8],I=i.mat[9],w=i.mat[10],N=i.mat[11],L=i.mat[12],O=i.mat[13],D=i.mat[14],F=i.mat[15];return n[0]=v*r+S*c+C*d+E*m,n[1]=v*o+S*l+C*p+E*g,n[2]=v*s+S*u+C*_+E*y,n[3]=v*a+S*h+C*f+E*T,n[4]=b*r+A*c+x*d+R*m,n[5]=b*o+A*l+x*p+R*g,n[6]=b*s+A*u+x*_+R*y,n[7]=b*a+A*h+x*f+R*T,n[8]=P*r+I*c+w*d+N*m,n[9]=P*o+I*l+w*p+N*g,n[10]=P*s+I*u+w*_+N*y,n[11]=P*a+I*h+w*f+N*T,n[12]=L*r+O*c+D*d+F*m,n[13]=L*o+O*l+D*p+F*g,n[14]=L*s+O*u+D*_+F*y,n[15]=L*a+O*h+D*f+F*T,e},cc.getMat4MultiplyValue=function(e,t){var i=e.mat,n=t.mat,r=new Float32Array(16);return r[0]=i[0]*n[0]+i[4]*n[1]+i[8]*n[2]+i[12]*n[3],r[1]=i[1]*n[0]+i[5]*n[1]+i[9]*n[2]+i[13]*n[3],r[2]=i[2]*n[0]+i[6]*n[1]+i[10]*n[2]+i[14]*n[3],r[3]=i[3]*n[0]+i[7]*n[1]+i[11]*n[2]+i[15]*n[3],r[4]=i[0]*n[4]+i[4]*n[5]+i[8]*n[6]+i[12]*n[7],r[5]=i[1]*n[4]+i[5]*n[5]+i[9]*n[6]+i[13]*n[7],r[6]=i[2]*n[4]+i[6]*n[5]+i[10]*n[6]+i[14]*n[7],r[7]=i[3]*n[4]+i[7]*n[5]+i[11]*n[6]+i[15]*n[7],r[8]=i[0]*n[8]+i[4]*n[9]+i[8]*n[10]+i[12]*n[11],r[9]=i[1]*n[8]+i[5]*n[9]+i[9]*n[10]+i[13]*n[11],r[10]=i[2]*n[8]+i[6]*n[9]+i[10]*n[10]+i[14]*n[11],r[11]=i[3]*n[8]+i[7]*n[9]+i[11]*n[10]+i[15]*n[11],r[12]=i[0]*n[12]+i[4]*n[13]+i[8]*n[14]+i[12]*n[15],r[13]=i[1]*n[12]+i[5]*n[13]+i[9]*n[14]+i[13]*n[15],r[14]=i[2]*n[12]+i[6]*n[13]+i[10]*n[14]+i[14]*n[15],r[15]=i[3]*n[12]+i[7]*n[13]+i[11]*n[14]+i[15]*n[15],r},cc.getMat4MultiplyWithMat4=function(e,t,i){var n=e.mat,r=t.mat,o=i.mat;return o[0]=n[0]*r[0]+n[4]*r[1]+n[8]*r[2]+n[12]*r[3],o[1]=n[1]*r[0]+n[5]*r[1]+n[9]*r[2]+n[13]*r[3],o[2]=n[2]*r[0]+n[6]*r[1]+n[10]*r[2]+n[14]*r[3],o[3]=n[3]*r[0]+n[7]*r[1]+n[11]*r[2]+n[15]*r[3],o[4]=n[0]*r[4]+n[4]*r[5]+n[8]*r[6]+n[12]*r[7],o[5]=n[1]*r[4]+n[5]*r[5]+n[9]*r[6]+n[13]*r[7],o[6]=n[2]*r[4]+n[6]*r[5]+n[10]*r[6]+n[14]*r[7],o[7]=n[3]*r[4]+n[7]*r[5]+n[11]*r[6]+n[15]*r[7],o[8]=n[0]*r[8]+n[4]*r[9]+n[8]*r[10]+n[12]*r[11],o[9]=n[1]*r[8]+n[5]*r[9]+n[9]*r[10]+n[13]*r[11],o[10]=n[2]*r[8]+n[6]*r[9]+n[10]*r[10]+n[14]*r[11],o[11]=n[3]*r[8]+n[7]*r[9]+n[11]*r[10]+n[15]*r[11],o[12]=n[0]*r[12]+n[4]*r[13]+n[8]*r[14]+n[12]*r[15],o[13]=n[1]*r[12]+n[5]*r[13]+n[9]*r[14]+n[13]*r[15],o[14]=n[2]*r[12]+n[6]*r[13]+n[10]*r[14]+n[14]*r[15],o[15]=n[3]*r[12]+n[7]*r[13]+n[11]*r[14]+n[15]*r[15],i.mat},cc.kmMat4Assign=function(e,t){if(e==t)return cc.log("cc.kmMat4Assign(): pOut equals pIn"),e;var i=e.mat,n=t.mat;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],e},cc.kmMat4AreEqual=function(e,t){if(e==t)return cc.log("cc.kmMat4AreEqual(): pMat1 and pMat2 are same object."),!0;for(var i=0;i<16;i++)if(!(e.mat[i]+cc.kmEpsilon>t.mat[i]&&e.mat[i]-cc.kmEpsilon<t.mat[i]))return!1;return!0},cc.kmMat4RotationX=function(e,t){return e.mat[0]=1,e.mat[1]=0,e.mat[2]=0,e.mat[3]=0,e.mat[4]=0,e.mat[5]=Math.cos(t),e.mat[6]=Math.sin(t),e.mat[7]=0,e.mat[8]=0,e.mat[9]=-Math.sin(t),e.mat[10]=Math.cos(t),e.mat[11]=0,e.mat[12]=0,e.mat[13]=0,e.mat[14]=0,e.mat[15]=1,e},cc.kmMat4RotationY=function(e,t){return e.mat[0]=Math.cos(t),e.mat[1]=0,e.mat[2]=-Math.sin(t),e.mat[3]=0,e.mat[4]=0,e.mat[5]=1,e.mat[6]=0,e.mat[7]=0,e.mat[8]=Math.sin(t),e.mat[9]=0,e.mat[10]=Math.cos(t),e.mat[11]=0,e.mat[12]=0,e.mat[13]=0,e.mat[14]=0,e.mat[15]=1,e},cc.kmMat4RotationZ=function(e,t){return e.mat[0]=Math.cos(t),e.mat[1]=Math.sin(t),e.mat[2]=0,e.mat[3]=0,e.mat[4]=-Math.sin(t),e.mat[5]=Math.cos(t),e.mat[6]=0,e.mat[7]=0,e.mat[8]=0,e.mat[9]=0,e.mat[10]=1,e.mat[11]=0,e.mat[12]=0,e.mat[13]=0,e.mat[14]=0,e.mat[15]=1,e},cc.kmMat4RotationPitchYawRoll=function(e,t,i,n){var r=Math.cos(t),o=Math.sin(t),s=Math.cos(i),a=Math.sin(i),c=Math.cos(n),l=Math.sin(n),u=o*a,h=r*a;return e.mat[0]=s*c,e.mat[4]=s*l,e.mat[8]=-a,e.mat[1]=u*c-r*l,e.mat[5]=u*l+r*c,e.mat[9]=o*s,e.mat[2]=h*c+o*l,e.mat[6]=h*l-o*c,e.mat[10]=r*s,e.mat[3]=e.mat[7]=e.mat[11]=0,e.mat[15]=1,e},cc.kmMat4RotationQuaternion=function(e,t){return e.mat[0]=1-2*(t.y*t.y+t.z*t.z),e.mat[1]=2*(t.x*t.y+t.z*t.w),e.mat[2]=2*(t.x*t.z-t.y*t.w),e.mat[3]=0,e.mat[4]=2*(t.x*t.y-t.z*t.w),e.mat[5]=1-2*(t.x*t.x+t.z*t.z),e.mat[6]=2*(t.z*t.y+t.x*t.w),e.mat[7]=0,e.mat[8]=2*(t.x*t.z+t.y*t.w),e.mat[9]=2*(t.y*t.z-t.x*t.w),e.mat[10]=1-2*(t.x*t.x+t.y*t.y),e.mat[11]=0,e.mat[12]=0,e.mat[13]=0,e.mat[14]=0,e.mat[15]=1,e},cc.kmMat4RotationTranslation=function(e,t,i){return e.mat[0]=t.mat[0],e.mat[1]=t.mat[1],e.mat[2]=t.mat[2],e.mat[3]=0,e.mat[4]=t.mat[3],e.mat[5]=t.mat[4],e.mat[6]=t.mat[5],e.mat[7]=0,e.mat[8]=t.mat[6],e.mat[9]=t.mat[7],e.mat[10]=t.mat[8],e.mat[11]=0,e.mat[12]=i.x,e.mat[13]=i.y,e.mat[14]=i.z,e.mat[15]=1,e},cc.kmMat4Scaling=function(e,t,i,n){return e.mat[0]=t,e.mat[5]=i,e.mat[10]=n,e.mat[15]=1,e.mat[1]=e.mat[2]=e.mat[3]=e.mat[4]=e.mat[6]=e.mat[7]=e.mat[8]=e.mat[9]=e.mat[11]=e.mat[12]=e.mat[13]=e.mat[14]=0,e},cc.kmMat4Translation=function(e,t,i,n){return e.mat[0]=e.mat[5]=e.mat[10]=e.mat[15]=1,e.mat[1]=e.mat[2]=e.mat[3]=e.mat[4]=e.mat[6]=e.mat[7]=e.mat[8]=e.mat[9]=e.mat[11]=0,e.mat[12]=t,e.mat[13]=i,e.mat[14]=n,e},cc.kmMat4GetUpVec3=function(e,t){return e.x=t.mat[4],e.y=t.mat[5],e.z=t.mat[6],cc.kmVec3Normalize(e,e),e},cc.kmMat4GetRightVec3=function(e,t){return e.x=t.mat[0],e.y=t.mat[1],e.z=t.mat[2],cc.kmVec3Normalize(e,e),e},cc.kmMat4GetForwardVec3=function(e,t){return e.x=t.mat[8],e.y=t.mat[9],e.z=t.mat[10],cc.kmVec3Normalize(e,e),e},cc.kmMat4PerspectiveProjection=function(e,t,i,n,r){var o=cc.kmDegreesToRadians(t/2),s=r-n,a=Math.sin(o);if(0==s||0==a||0==i)return null;var c=Math.cos(o)/a;return cc.kmMat4Identity(e),e.mat[0]=c/i,e.mat[5]=c,e.mat[10]=-(r+n)/s,e.mat[11]=-1,e.mat[14]=-2*n*r/s,e.mat[15]=0,e},cc.kmMat4OrthographicProjection=function(e,t,i,n,r,o,s){return cc.kmMat4Identity(e),e.mat[0]=2/(i-t),e.mat[5]=2/(r-n),e.mat[10]=-2/(s-o),e.mat[12]=-(i+t)/(i-t),e.mat[13]=-(r+n)/(r-n),e.mat[14]=-(s+o)/(s-o),e},cc.kmMat4LookAt=function(e,t,i,n){var r=new cc.kmVec3,o=new cc.kmVec3,s=new cc.kmVec3,a=new cc.kmVec3,c=new cc.kmMat4;return cc.kmVec3Subtract(r,i,t),cc.kmVec3Normalize(r,r),cc.kmVec3Assign(o,n),cc.kmVec3Normalize(o,o),cc.kmVec3Cross(s,r,o),cc.kmVec3Normalize(s,s),cc.kmVec3Cross(a,s,r),cc.kmVec3Normalize(s,s),cc.kmMat4Identity(e),e.mat[0]=s.x,e.mat[4]=s.y,e.mat[8]=s.z,e.mat[1]=a.x,e.mat[5]=a.y,e.mat[9]=a.z,e.mat[2]=-r.x,e.mat[6]=-r.y,e.mat[10]=-r.z,cc.kmMat4Translation(c,-t.x,-t.y,-t.z),cc.kmMat4Multiply(e,e,c),e},cc.kmMat4RotationAxisAngle=function(e,t,i){var n=Math.cos(i),r=Math.sin(i),o=new cc.kmVec3;return cc.kmVec3Normalize(o,t),e.mat[0]=n+o.x*o.x*(1-n),e.mat[1]=o.z*r+o.y*o.x*(1-n),e.mat[2]=-o.y*r+o.z*o.x*(1-n),e.mat[3]=0,e.mat[4]=-o.z*r+o.x*o.y*(1-n),e.mat[5]=n+o.y*o.y*(1-n),e.mat[6]=o.x*r+o.z*o.y*(1-n),e.mat[7]=0,e.mat[8]=o.y*r+o.x*o.z*(1-n),e.mat[9]=-o.x*r+o.y*o.z*(1-n),e.mat[10]=n+o.z*o.z*(1-n),e.mat[11]=0,e.mat[12]=0,e.mat[13]=0,e.mat[14]=0,e.mat[15]=1,e},cc.kmMat4ExtractRotation=function(e,t){return e.mat[0]=t.mat[0],e.mat[1]=t.mat[1],e.mat[2]=t.mat[2],e.mat[3]=t.mat[4],e.mat[4]=t.mat[5],e.mat[5]=t.mat[6],e.mat[6]=t.mat[8],e.mat[7]=t.mat[9],e.mat[8]=t.mat[10],e},cc.kmMat4ExtractPlane=function(e,t,i){switch(i){case cc.KM_PLANE_RIGHT:e.a=t.mat[3]-t.mat[0],e.b=t.mat[7]-t.mat[4],e.c=t.mat[11]-t.mat[8],e.d=t.mat[15]-t.mat[12];break;case cc.KM_PLANE_LEFT:e.a=t.mat[3]+t.mat[0],e.b=t.mat[7]+t.mat[4],e.c=t.mat[11]+t.mat[8],e.d=t.mat[15]+t.mat[12];break;case cc.KM_PLANE_BOTTOM:e.a=t.mat[3]+t.mat[1],e.b=t.mat[7]+t.mat[5],e.c=t.mat[11]+t.mat[9],e.d=t.mat[15]+t.mat[13];break;case cc.KM_PLANE_TOP:e.a=t.mat[3]-t.mat[1],e.b=t.mat[7]-t.mat[5],e.c=t.mat[11]-t.mat[9],e.d=t.mat[15]-t.mat[13];break;case cc.KM_PLANE_FAR:e.a=t.mat[3]-t.mat[2],e.b=t.mat[7]-t.mat[6],e.c=t.mat[11]-t.mat[10],e.d=t.mat[15]-t.mat[14];break;case cc.KM_PLANE_NEAR:e.a=t.mat[3]+t.mat[2],e.b=t.mat[7]+t.mat[6],e.c=t.mat[11]+t.mat[10],e.d=t.mat[15]+t.mat[14];break;default:cc.log("cc.kmMat4ExtractPlane(): Invalid plane index")}var n=Math.sqrt(e.a*e.a+e.b*e.b+e.c*e.c);return e.a/=n,e.b/=n,e.c/=n,e.d/=n,e},cc.kmMat4RotationToAxisAngle=function(e,t,i){var n=new cc.kmQuaternion,r=new cc.kmMat3;return cc.kmMat4ExtractRotation(r,i),cc.kmQuaternionRotationMatrix(n,r),cc.kmQuaternionToAxisAngle(n,e,t),e},cc.KM_PLANE_LEFT=0,cc.KM_PLANE_RIGHT=1,cc.KM_PLANE_BOTTOM=2,cc.KM_PLANE_TOP=3,cc.KM_PLANE_NEAR=4,cc.KM_PLANE_FAR=5,cc.kmPlane=function(e,t,i,n){this.a=e||0,this.b=t||0,this.c=i||0,this.d=n||0},cc.POINT_INFRONT_OF_PLANE=0,cc.POINT_BEHIND_PLANE=1,cc.POINT_ON_PLANE=2,cc.kmPlaneDot=function(e,t){return e.a*t.x+e.b*t.y+e.c*t.z+e.d*t.w},cc.kmPlaneDotCoord=function(e,t){return e.a*t.x+e.b*t.y+e.c*t.z+e.d},cc.kmPlaneDotNormal=function(e,t){return e.a*t.x+e.b*t.y+e.c*t.z},cc.kmPlaneFromPointNormal=function(e,t,i){return e.a=i.x,e.b=i.y,e.c=i.z,e.d=-cc.kmVec3Dot(i,t),e},cc.kmPlaneFromPoints=function(e,t,i,n){var r=new cc.kmVec3,o=new cc.kmVec3,s=new cc.kmVec3;return cc.kmVec3Subtract(o,i,t),cc.kmVec3Subtract(s,n,t),cc.kmVec3Cross(r,o,s),cc.kmVec3Normalize(r,r),e.a=r.x,e.b=r.y,e.c=r.z,e.d=cc.kmVec3Dot(cc.kmVec3Scale(r,r,-1),t),e},cc.kmPlaneIntersectLine=function(e,t,i,n){throw"cc.kmPlaneIntersectLine() hasn't been implemented."},cc.kmPlaneNormalize=function(e,t){var i=new cc.kmVec3;i.x=t.a,i.y=t.b,i.z=t.c;var n=1/cc.kmVec3Length(i);return cc.kmVec3Normalize(i,i),e.a=i.x,e.b=i.y,e.c=i.z,e.d=t.d*n,e},cc.kmPlaneScale=function(e,t,i){cc.log("cc.kmPlaneScale() has not been implemented.")},cc.kmPlaneClassifyPoint=function(e,t){var i=e.a*t.x+e.b*t.y+e.c*t.z+e.d;return i>.001?cc.POINT_INFRONT_OF_PLANE:i<-.001?cc.POINT_BEHIND_PLANE:cc.POINT_ON_PLANE},cc.kmQuaternion=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=n||0},cc.kmQuaternionConjugate=function(e,t){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=t.w,e},cc.kmQuaternionDot=function(e,t){return e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z},cc.kmQuaternionExp=function(e,t){return e},cc.kmQuaternionIdentity=function(e){return e.x=0,e.y=0,e.z=0,e.w=1,e},cc.kmQuaternionInverse=function(e,t){var i=cc.kmQuaternionLength(t),n=new cc.kmQuaternion;return Math.abs(i)>cc.kmEpsilon?(e.x=0,e.y=0,e.z=0,e.w=0,e):(cc.kmQuaternionScale(e,cc.kmQuaternionConjugate(n,t),1/i),e)},cc.kmQuaternionIsIdentity=function(e){return 0==e.x&&0==e.y&&0==e.z&&1==e.w},cc.kmQuaternionLength=function(e){return Math.sqrt(cc.kmQuaternionLengthSq(e))},cc.kmQuaternionLengthSq=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},cc.kmQuaternionLn=function(e,t){return e},cc.kmQuaternionMultiply=function(e,t,i){return e.w=t.w*i.w-t.x*i.x-t.y*i.y-t.z*i.z,e.x=t.w*i.x+t.x*i.w+t.y*i.z-t.z*i.y,e.y=t.w*i.y+t.y*i.w+t.z*i.x-t.x*i.z,e.z=t.w*i.z+t.z*i.w+t.x*i.y-t.y*i.x,e},cc.kmQuaternionNormalize=function(e,t){var i=cc.kmQuaternionLength(t);if(Math.abs(i)<=cc.kmEpsilon)throw"cc.kmQuaternionNormalize(): pIn is an invalid value";return cc.kmQuaternionScale(e,t,1/i),e},cc.kmQuaternionRotationAxis=function(e,t,i){var n=.5*i,r=Math.sin(n);return e.w=Math.cos(n),e.x=t.x*r,e.y=t.y*r,e.z=t.z*r,e},cc.kmQuaternionRotationMatrix=function(e,t){var i,n,r,o,s=[],a=0,c=0;if(!t)return null;s[0]=t.mat[0],s[1]=t.mat[3],s[2]=t.mat[6],s[4]=t.mat[1],s[5]=t.mat[4],s[6]=t.mat[7],s[8]=t.mat[2],s[9]=t.mat[5],s[10]=t.mat[8],s[15]=1;var l=s[0];return(c=l[0]+l[5]+l[10]+1)>cc.kmEpsilon?(a=2*Math.sqrt(c),i=(l[9]-l[6])/a,n=(l[2]-l[8])/a,r=(l[4]-l[1])/a,o=.25*a):l[0]>l[5]&&l[0]>l[10]?(i=.25*(a=2*Math.sqrt(1+l[0]-l[5]-l[10])),n=(l[4]+l[1])/a,r=(l[2]+l[8])/a,o=(l[9]-l[6])/a):l[5]>l[10]?(a=2*Math.sqrt(1+l[5]-l[0]-l[10]),i=(l[4]+l[1])/a,n=.25*a,r=(l[9]+l[6])/a,o=(l[2]-l[8])/a):(a=2*Math.sqrt(1+l[10]-l[0]-l[5]),i=(l[2]+l[8])/a,n=(l[9]+l[6])/a,r=.25*a,o=(l[4]-l[1])/a),e.x=i,e.y=n,e.z=r,e.w=o,e},cc.kmQuaternionRotationYawPitchRoll=function(e,t,i,n){var r,o,s,a,c,l,u,h,d,p,_;return r=cc.kmDegreesToRadians(i)/2,o=cc.kmDegreesToRadians(t)/2,s=cc.kmDegreesToRadians(n)/2,a=Math.cos(r),c=Math.cos(o),l=Math.cos(s),u=Math.sin(r),h=Math.sin(o),d=Math.sin(s),p=c*l,_=h*d,e.w=a*p+u*_,e.x=u*p-a*_,e.y=a*h*l+u*c*d,e.z=a*c*d-u*h*l,cc.kmQuaternionNormalize(e,e),e},cc.kmQuaternionSlerp=function(e,t,i,n){if(t.x==i.x&&t.y==i.y&&t.z==i.z&&t.w==i.w)return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e;var r=cc.kmQuaternionDot(t,i),o=Math.acos(r),s=Math.sqrt(1-cc.kmSQR(r)),a=Math.sin(n*o)/s,c=Math.sin((1-n)*o)/s,l=new cc.kmQuaternion,u=new cc.kmQuaternion;return cc.kmQuaternionScale(l,t,c),cc.kmQuaternionScale(u,i,a),cc.kmQuaternionAdd(e,l,u),e},cc.kmQuaternionToAxisAngle=function(e,t,i){var n,r;n=Math.acos(e.w),(r=Math.sqrt(cc.kmSQR(e.x)+cc.kmSQR(e.y)+cc.kmSQR(e.z)))>-cc.kmEpsilon&&r<cc.kmEpsilon||r<2*cc.kmPI+cc.kmEpsilon&&r>2*cc.kmPI-cc.kmEpsilon?(0,t.x=0,t.y=0,t.z=1):(2*n,t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,cc.kmVec3Normalize(t,t))},cc.kmQuaternionScale=function(e,t,i){return e.x=t.x*i,e.y=t.y*i,e.z=t.z*i,e.w=t.w*i,e},cc.kmQuaternionAssign=function(e,t){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e},cc.kmQuaternionAdd=function(e,t,i){return e.x=t.x+i.x,e.y=t.y+i.y,e.z=t.z+i.z,e.w=t.w+i.w,e},cc.kmQuaternionRotationBetweenVec3=function(e,t,i,n){var r,o=new cc.kmVec3,s=new cc.kmVec3;if(cc.kmVec3Assign(o,t),cc.kmVec3Assign(s,i),cc.kmVec3Normalize(o,o),cc.kmVec3Normalize(s,s),(r=cc.kmVec3Dot(o,s))>=1)return cc.kmQuaternionIdentity(e),e;if(r<1e-6-1)if(Math.abs(cc.kmVec3LengthSq(n))<cc.kmEpsilon)cc.kmQuaternionRotationAxis(e,n,cc.kmPI);else{var a=new cc.kmVec3,c=new cc.kmVec3;if(c.x=1,c.y=0,c.z=0,cc.kmVec3Cross(a,c,t),Math.abs(cc.kmVec3LengthSq(a))<cc.kmEpsilon){var l=new cc.kmVec3;l.x=0,l.y=1,l.z=0,cc.kmVec3Cross(a,l,t)}cc.kmVec3Normalize(a,a),cc.kmQuaternionRotationAxis(e,a,cc.kmPI)}else{var u=Math.sqrt(2*(1+r)),h=1/u,d=new cc.kmVec3;cc.kmVec3Cross(d,o,s),e.x=d.x*h,e.y=d.y*h,e.z=d.z*h,e.w=.5*u,cc.kmQuaternionNormalize(e,e)}return e},cc.kmQuaternionMultiplyVec3=function(e,t,i){var n=new cc.kmVec3,r=new cc.kmVec3,o=new cc.kmVec3;return o.x=t.x,o.y=t.y,o.z=t.z,cc.kmVec3Cross(n,o,i),cc.kmVec3Cross(r,o,n),cc.kmVec3Scale(n,n,2*t.w),cc.kmVec3Scale(r,r,2),cc.kmVec3Add(e,i,n),cc.kmVec3Add(e,e,r),e},cc.kmAABB=function(e,t){this.min=e||new cc.kmVec3,this.max=t||new cc.kmVec3},cc.kmAABBContainsPoint=function(e,t){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y&&e.z>=t.min.z&&e.z<=t.max.z?cc.KM_TRUE:cc.KM_FALSE},cc.kmAABBAssign=function(e,t){return cc.kmVec3Assign(e.min,t.min),cc.kmVec3Assign(e.max,t.max),e},cc.kmAABBScale=function(e,t,i){cc.log("cc.kmAABBScale hasn't been supported.")},cc.km_mat4_stack=function(e,t,i,n){this.top=i,this.stack=n},cc.km_mat4_stack.INITIAL_SIZE=30,cc.km_mat4_stack_initialize=function(e){e.stack=[],e.top=null},cc.km_mat4_stack_push=function(e,t){e.stack.push(e.top),e.top=new cc.kmMat4,cc.kmMat4Assign(e.top,t)},cc.km_mat4_stack_pop=function(e,t){e.top=e.stack.pop()},cc.km_mat4_stack_release=function(e){e.stack=null,e.top=null,e=null},cc.KM_GL_MODELVIEW=5888,cc.KM_GL_PROJECTION=5889,cc.KM_GL_TEXTURE=5890,cc.modelview_matrix_stack=new cc.km_mat4_stack,cc.projection_matrix_stack=new cc.km_mat4_stack,cc.texture_matrix_stack=new cc.km_mat4_stack,cc.current_stack=null,cc.initialized=!1,cc.lazyInitialize=function(){if(!cc.initialized){var e=new cc.kmMat4;cc.km_mat4_stack_initialize(cc.modelview_matrix_stack),cc.km_mat4_stack_initialize(cc.projection_matrix_stack),cc.km_mat4_stack_initialize(cc.texture_matrix_stack),cc.current_stack=cc.modelview_matrix_stack,cc.initialized=!0,cc.kmMat4Identity(e),cc.km_mat4_stack_push(cc.modelview_matrix_stack,e),cc.km_mat4_stack_push(cc.projection_matrix_stack,e),cc.km_mat4_stack_push(cc.texture_matrix_stack,e)}},cc.lazyInitialize(),cc.kmGLFreeAll=function(){cc.km_mat4_stack_release(cc.modelview_matrix_stack),cc.km_mat4_stack_release(cc.projection_matrix_stack),cc.km_mat4_stack_release(cc.texture_matrix_stack),cc.initialized=!1,cc.current_stack=null},cc.kmGLPushMatrix=function(){cc.km_mat4_stack_push(cc.current_stack,cc.current_stack.top)},cc.kmGLPushMatrixWitMat4=function(e){cc.current_stack.stack.push(cc.current_stack.top),cc.kmMat4Assign(e,cc.current_stack.top),cc.current_stack.top=e},cc.kmGLPopMatrix=function(){cc.current_stack.top=cc.current_stack.stack.pop()},cc.kmGLMatrixMode=function(e){switch(e){case cc.KM_GL_MODELVIEW:cc.current_stack=cc.modelview_matrix_stack;break;case cc.KM_GL_PROJECTION:cc.current_stack=cc.projection_matrix_stack;break;case cc.KM_GL_TEXTURE:cc.current_stack=cc.texture_matrix_stack;break;default:throw"Invalid matrix mode specified"}},cc.kmGLLoadIdentity=function(){cc.kmMat4Identity(cc.current_stack.top)},cc.kmGLLoadMatrix=function(e){cc.kmMat4Assign(cc.current_stack.top,e)},cc.kmGLMultMatrix=function(e){cc.kmMat4Multiply(cc.current_stack.top,cc.current_stack.top,e)},cc.kmGLTranslatef=function(e,t,i){var n=new cc.kmMat4;cc.kmMat4Translation(n,e,t,i),cc.kmMat4Multiply(cc.current_stack.top,cc.current_stack.top,n)},cc.kmGLRotatef=function(e,t,i,n){var r=new cc.kmVec3(t,i,n),o=new cc.kmMat4;cc.kmMat4RotationAxisAngle(o,r,cc.kmDegreesToRadians(e)),cc.kmMat4Multiply(cc.current_stack.top,cc.current_stack.top,o)},cc.kmGLScalef=function(e,t,i){var n=new cc.kmMat4;cc.kmMat4Scaling(n,e,t,i),cc.kmMat4Multiply(cc.current_stack.top,cc.current_stack.top,n)},cc.kmGLGetMatrix=function(e,t){switch(e){case cc.KM_GL_MODELVIEW:cc.kmMat4Assign(t,cc.modelview_matrix_stack.top);break;case cc.KM_GL_PROJECTION:cc.kmMat4Assign(t,cc.projection_matrix_stack.top);break;case cc.KM_GL_TEXTURE:cc.kmMat4Assign(t,cc.texture_matrix_stack.top);break;default:throw"Invalid matrix mode specified"}},cc.SHADER_POSITION_UCOLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor = v_fragmentColor;      \n}\n",cc.SHADER_POSITION_UCOLOR_VERT="attribute vec4 a_position;\nuniform    vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    gl_PointSize = u_pointSize;          \n    v_fragmentColor = u_color;           \n}",cc.SHADER_POSITION_COLOR_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor = v_fragmentColor; \n} ",cc.SHADER_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color;             \n}",cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG="// #extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\t\n{ \n// #if defined GL_OES_standard_derivatives\t\n// gl_FragColor = v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else\t\ngl_FragColor = v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}",cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT="attribute mediump vec4 a_position; \nattribute mediump vec2 a_texcoord; \nattribute mediump vec4 a_color;\t\nvarying mediump vec4 v_color; \nvarying mediump vec2 v_texcoord;\t\nvoid main() \n{ \n     v_color = a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord = a_texcoord; \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n}",cc.SHADER_POSITION_TEXTURE_FRAG="precision lowp float;   \nvarying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord);   \n}",cc.SHADER_POSITION_TEXTURE_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;               \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG="precision lowp float;  \nuniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT="attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;                 \n}",cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG="precision lowp float;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}",cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_POSITION_TEXTURE_COLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}",cc.SHADER_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG="precision lowp float;   \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor = texture2D(CC_Texture0, v_texCoord);  \n    if ( texColor.a <= CC_alpha_value )          \n        discard; \n    gl_FragColor = texColor * v_fragmentColor;  \n}",cc.SHADEREX_SWITCHMASK_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   = texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  = texture2D(u_mask, v_texCoord); \n    vec4 finalColor = vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    = v_fragmentColor * finalColor; \n}",cc.shaderCache={TYPE_POSITION_TEXTURECOLOR:0,TYPE_POSITION_TEXTURECOLOR_ALPHATEST:1,TYPE_POSITION_COLOR:2,TYPE_POSITION_TEXTURE:3,TYPE_POSITION_TEXTURE_UCOLOR:4,TYPE_POSITION_TEXTURE_A8COLOR:5,TYPE_POSITION_UCOLOR:6,TYPE_POSITION_LENGTH_TEXTURECOLOR:7,TYPE_MAX:8,_programs:{},_init:function(){return this.loadDefaultShaders(),!0},_loadDefaultShader:function(e,t){switch(t){case this.TYPE_POSITION_TEXTURECOLOR:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_FRAG),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_COLOR:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_VERT,cc.SHADER_POSITION_COLOR_FRAG),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;case this.TYPE_POSITION_TEXTURE:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_VERT,cc.SHADER_POSITION_TEXTURE_FRAG),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURE_UCOLOR:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT,cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURE_A8COLOR:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT,cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_UCOLOR:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_UCOLOR_VERT,cc.SHADER_POSITION_UCOLOR_FRAG),e.addAttribute("aVertex",cc.VERTEX_ATTRIB_POSITION);break;case this.TYPE_POSITION_LENGTH_TEXTURECOLOR:e.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT,cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),e.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;default:return void cc.log("cocos2d: cc.shaderCache._loadDefaultShader, error shader type")}e.link(),e.updateUniforms()},loadDefaultShaders:function(){var e=new cc.GLProgram;this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURECOLOR),this._programs[cc.SHADER_POSITION_TEXTURECOLOR]=e,this._programs.ShaderPositionTextureColor=e,e=new cc.GLProgram,this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST),this._programs[cc.SHADER_POSITION_TEXTURECOLORALPHATEST]=e,this._programs.ShaderPositionTextureColorAlphaTest=e,e=new cc.GLProgram,this._loadDefaultShader(e,this.TYPE_POSITION_COLOR),this._programs[cc.SHADER_POSITION_COLOR]=e,this._programs.ShaderPositionColor=e,e=new cc.GLProgram,this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURE),this._programs[cc.SHADER_POSITION_TEXTURE]=e,this._programs.ShaderPositionTexture=e,e=new cc.GLProgram,this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURE_UCOLOR),this._programs[cc.SHADER_POSITION_TEXTURE_UCOLOR]=e,this._programs.ShaderPositionTextureUColor=e,e=new cc.GLProgram,this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURE_A8COLOR),this._programs[cc.SHADER_POSITION_TEXTUREA8COLOR]=e,this._programs.ShaderPositionTextureA8Color=e,e=new cc.GLProgram,this._loadDefaultShader(e,this.TYPE_POSITION_UCOLOR),this._programs[cc.SHADER_POSITION_UCOLOR]=e,this._programs.ShaderPositionUColor=e,e=new cc.GLProgram,this._loadDefaultShader(e,this.TYPE_POSITION_LENGTH_TEXTURECOLOR),this._programs[cc.SHADER_POSITION_LENGTHTEXTURECOLOR]=e,this._programs.ShaderPositionLengthTextureColor=e},reloadDefaultShaders:function(){var e=this.programForKey(cc.SHADER_POSITION_TEXTURECOLOR);e.reset(),this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURECOLOR),(e=this.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST)).reset(),this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST),(e=this.programForKey(cc.SHADER_POSITION_COLOR)).reset(),this._loadDefaultShader(e,this.TYPE_POSITION_COLOR),(e=this.programForKey(cc.SHADER_POSITION_TEXTURE)).reset(),this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURE),(e=this.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR)).reset(),this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURE_UCOLOR),(e=this.programForKey(cc.SHADER_POSITION_TEXTUREA8COLOR)).reset(),this._loadDefaultShader(e,this.TYPE_POSITION_TEXTURE_A8COLOR),(e=this.programForKey(cc.SHADER_POSITION_UCOLOR)).reset(),this._loadDefaultShader(e,this.TYPE_POSITION_UCOLOR)},programForKey:function(e){return this._programs[e]},getProgram:function(e){return this._programs[e]},addProgram:function(e,t){this._programs[t]=e}},cc.HashUniformEntry=function(e,t,i){this.value=e,this.location=t,this.hh=i||{}},cc.GLProgram=cc.Class.extend({_glContext:null,_programObj:null,_vertShader:null,_fragShader:null,_uniforms:null,_hashForUniforms:null,_usesTime:!1,_updateUniformLocation:function(e,t,i){if(null==e)return!1;for(var n=!0,r=null,o=0;o<this._hashForUniforms.length;o++)this._hashForUniforms[o].location==e&&(r=this._hashForUniforms[o]);return r?r.value==t?n=!1:r.value=t:((r=new cc.HashUniformEntry).location=e,r.value=t,this._hashForUniforms.push(r)),n},_description:function(){return"<CCGLProgram = "+this.toString()+" | Program = "+this._programObj.toString()+", VertexShader = "+this._vertShader.toString()+", FragmentShader = "+this._fragShader.toString()+">"},_compileShader:function(e,t,i){if(!i||!e)return!1;i=(cc.GLProgram._isHighpSupported()?"precision highp float;\n":"precision mediump float;\n")+"uniform mat4 CC_PMatrix;         \nuniform mat4 CC_MVMatrix;        \nuniform mat4 CC_MVPMatrix;       \nuniform vec4 CC_Time;            \nuniform vec4 CC_SinTime;         \nuniform vec4 CC_CosTime;         \nuniform vec4 CC_Random01;        \nuniform sampler2D CC_Texture0;   \n//CC INCLUDES END                \n"+i,this._glContext.shaderSource(e,i),this._glContext.compileShader(e);var n=this._glContext.getShaderParameter(e,this._glContext.COMPILE_STATUS);return n||(cc.log("cocos2d: ERROR: Failed to compile shader:\n"+this._glContext.getShaderSource(e)),t==this._glContext.VERTEX_SHADER?cc.log("cocos2d: \n"+this.vertexShaderLog()):cc.log("cocos2d: \n"+this.fragmentShaderLog())),1==n},ctor:function(e,t,i){this._uniforms=[],this._hashForUniforms=[],this._glContext=i||cc._renderContext,e&&t&&this.init(e,t)},destroyProgram:function(){this._vertShader=null,this._fragShader=null,this._uniforms=null,this._hashForUniforms=null,this._glContext.deleteProgram(this._programObj)},initWithVertexShaderByteArray:function(e,t){var i=this._glContext;return this._programObj=i.createProgram(),this._vertShader=null,this._fragShader=null,e&&(this._vertShader=i.createShader(i.VERTEX_SHADER),this._compileShader(this._vertShader,i.VERTEX_SHADER,e)||cc.log("cocos2d: ERROR: Failed to compile vertex shader")),t&&(this._fragShader=i.createShader(i.FRAGMENT_SHADER),this._compileShader(this._fragShader,i.FRAGMENT_SHADER,t)||cc.log("cocos2d: ERROR: Failed to compile fragment shader")),this._vertShader&&i.attachShader(this._programObj,this._vertShader),cc.checkGLErrorDebug(),this._fragShader&&i.attachShader(this._programObj,this._fragShader),this._hashForUniforms.length=0,cc.checkGLErrorDebug(),!0},initWithString:function(e,t){return this.initWithVertexShaderByteArray(e,t)},initWithVertexShaderFilename:function(e,t){var i=cc.loader.getRes(e);if(!i)throw"Please load the resource firset : "+e;var n=cc.loader.getRes(t);if(!n)throw"Please load the resource firset : "+t;return this.initWithVertexShaderByteArray(i,n)},init:function(e,t){return this.initWithVertexShaderFilename(e,t)},addAttribute:function(e,t){this._glContext.bindAttribLocation(this._programObj,t,e)},link:function(){return this._programObj?(this._glContext.linkProgram(this._programObj),this._vertShader&&this._glContext.deleteShader(this._vertShader),this._fragShader&&this._glContext.deleteShader(this._fragShader),this._vertShader=null,this._fragShader=null,!(cc.game.config[cc.game.CONFIG_KEY.debugMode]&&!this._glContext.getProgramParameter(this._programObj,this._glContext.LINK_STATUS))||(cc.log("cocos2d: ERROR: Failed to link program: "+this._glContext.getProgramInfoLog(this._programObj)),cc.glDeleteProgram(this._programObj),this._programObj=null,!1)):(cc.log("cc.GLProgram.link(): Cannot link invalid program"),!1)},use:function(){cc.glUseProgram(this._programObj)},updateUniforms:function(){this._uniforms[cc.UNIFORM_PMATRIX]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_PMATRIX_S),this._uniforms[cc.UNIFORM_MVMATRIX]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_MVMATRIX_S),this._uniforms[cc.UNIFORM_MVPMATRIX]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_MVPMATRIX_S),this._uniforms[cc.UNIFORM_TIME]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_TIME_S),this._uniforms[cc.UNIFORM_SINTIME]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_SINTIME_S),this._uniforms[cc.UNIFORM_COSTIME]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_COSTIME_S),this._usesTime=null!=this._uniforms[cc.UNIFORM_TIME]||null!=this._uniforms[cc.UNIFORM_SINTIME]||null!=this._uniforms[cc.UNIFORM_COSTIME],this._uniforms[cc.UNIFORM_RANDOM01]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_RANDOM01_S),this._uniforms[cc.UNIFORM_SAMPLER]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_SAMPLER_S),this.use(),this.setUniformLocationWith1i(this._uniforms[cc.UNIFORM_SAMPLER],0)},getUniformLocationForName:function(e){if(!e)throw"cc.GLProgram.getUniformLocationForName(): uniform name should be non-null";if(!this._programObj)throw"cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized";return this._glContext.getUniformLocation(this._programObj,e)},getUniformMVPMatrix:function(){return this._uniforms[cc.UNIFORM_MVPMATRIX]},getUniformSampler:function(){return this._uniforms[cc.UNIFORM_SAMPLER]},setUniformLocationWith1i:function(e,t){this._updateUniformLocation(e,t)&&this._glContext.uniform1i(e,t)},setUniformLocationWith2i:function(e,t,i){var n=[t,i];this._updateUniformLocation(e,n)&&this._glContext.uniform2i(e,t,i)},setUniformLocationWith3i:function(e,t,i,n){var r=[t,i,n];this._updateUniformLocation(e,r)&&this._glContext.uniform3i(e,t,i,n)},setUniformLocationWith4i:function(e,t,i,n,r){var o=[t,i,n,r];this._updateUniformLocation(e,o)&&this._glContext.uniform4i(e,t,i,n,r)},setUniformLocationWith2iv:function(e,t,i){this._updateUniformLocation(e,t)&&this._glContext.uniform2iv(e,t)},setUniformLocationWith3iv:function(e,t,i){this._updateUniformLocation(e,t)&&this._glContext.uniform3iv(e,t)},setUniformLocationWith4iv:function(e,t,i){this._updateUniformLocation(e,t)&&this._glContext.uniform4iv(e,t)},setUniformLocationI32:function(e,t){this.setUniformLocationWith1i(arguments[0],arguments[1])},setUniformLocationWith1f:function(e,t){this._updateUniformLocation(e,t)&&this._glContext.uniform1f(e,t)},setUniformLocationWith2f:function(e,t,i){var n=[t,i];this._updateUniformLocation(e,n)&&this._glContext.uniform2f(e,t,i)},setUniformLocationWith3f:function(e,t,i,n){var r=[t,i,n];this._updateUniformLocation(e,r)&&this._glContext.uniform3f(e,t,i,n)},setUniformLocationWith4f:function(e,t,i,n,r){var o=[t,i,n,r];this._updateUniformLocation(e,o)&&this._glContext.uniform4f(e,t,i,n,r)},setUniformLocationWith2fv:function(e,t,i){this._updateUniformLocation(e,t)&&this._glContext.uniform2fv(e,t)},setUniformLocationWith3fv:function(e,t,i){this._updateUniformLocation(e,t)&&this._glContext.uniform3fv(e,t)},setUniformLocationWith4fv:function(e,t,i){this._updateUniformLocation(e,t)&&this._glContext.uniform4fv(e,t)},setUniformLocationWithMatrix4fv:function(e,t,i){this._updateUniformLocation(e,t)&&this._glContext.uniformMatrix4fv(e,!1,t)},setUniformLocationF32:function(){if(!(arguments.length<2))switch(arguments.length){case 2:this.setUniformLocationWith1f(arguments[0],arguments[1]);break;case 3:this.setUniformLocationWith2f(arguments[0],arguments[1],arguments[2]);break;case 4:this.setUniformLocationWith3f(arguments[0],arguments[1],arguments[2],arguments[3]);break;case 5:this.setUniformLocationWith4f(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}},setUniformsForBuiltins:function(){var e=new cc.kmMat4,t=new cc.kmMat4,i=new cc.kmMat4;if(cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,e),cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,t),cc.kmMat4Multiply(i,e,t),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],i.mat,1),this._usesTime){var n=cc.director,r=n.getTotalFrames()*n.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME],r/10,r,2*r,4*r),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME],r/8,r/4,r/2,Math.sin(r)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME],r/8,r/4,r/2,Math.cos(r))}-1!=this._uniforms[cc.UNIFORM_RANDOM01]&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())},_setUniformsForBuiltinsForRenderer:function(e){if(e&&e._renderCmd){var t=new cc.kmMat4,i=new cc.kmMat4;if(cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,t),cc.kmMat4Multiply(i,t,e._renderCmd._stackMatrix),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],e._renderCmd._stackMatrix.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],i.mat,1),this._usesTime){var n=cc.director,r=n.getTotalFrames()*n.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME],r/10,r,2*r,4*r),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME],r/8,r/4,r/2,Math.sin(r)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME],r/8,r/4,r/2,Math.cos(r))}-1!=this._uniforms[cc.UNIFORM_RANDOM01]&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())}},setUniformForModelViewProjectionMatrix:function(){this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],!1,cc.getMat4MultiplyValue(cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top))},setUniformForModelViewProjectionMatrixWithMat4:function(e){cc.kmMat4Multiply(e,cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top),this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],!1,e.mat)},setUniformForModelViewAndProjectionMatrixWithMat4:function(){this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],!1,cc.modelview_matrix_stack.top.mat),this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],!1,cc.projection_matrix_stack.top.mat)},_setUniformForMVPMatrixWithMat4:function(e){if(!e)throw"modelView matrix is undefined.";this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],!1,e.mat),this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],!1,cc.projection_matrix_stack.top.mat)},vertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getVertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getFragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},fragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._fragShader)},programLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},getProgramLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},reset:function(){this._vertShader=null,this._fragShader=null,this._uniforms.length=0,this._glContext.deleteProgram(this._programObj),this._programObj=null;for(var e=0;e<this._hashForUniforms.length;e++)this._hashForUniforms[e].value=null,this._hashForUniforms[e]=null;this._hashForUniforms.length=0},getProgram:function(){return this._programObj},retain:function(){},release:function(){}}),cc.GLProgram.create=function(e,t){return new cc.GLProgram(e,t)},cc.GLProgram._highpSupported=null,cc.GLProgram._isHighpSupported=function(){if(null==cc.GLProgram._highpSupported){var e=cc._renderContext,t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);cc.GLProgram._highpSupported=0!=t.precision}return cc.GLProgram._highpSupported},cc.setProgram=function(e,t){e.shaderProgram=t;var i=e.children;if(i)for(var n=0;n<i.length;n++)cc.setProgram(i[n],t)},cc._currentProjectionMatrix=-1,cc._vertexAttribPosition=!1,cc._vertexAttribColor=!1,cc._vertexAttribTexCoords=!1,cc.ENABLE_GL_STATE_CACHE&&(cc.MAX_ACTIVETEXTURE=16,cc._currentShaderProgram=-1,cc._currentBoundTexture=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],cc._blendingSource=-1,cc._blendingDest=-1,cc._GLServerState=0,cc.TEXTURE_ATLAS_USE_VAO&&(cc._uVAO=0)),cc.glInvalidateStateCache=function(){if(cc.kmGLFreeAll(),cc._currentProjectionMatrix=-1,cc._vertexAttribPosition=!1,cc._vertexAttribColor=!1,cc._vertexAttribTexCoords=!1,cc.ENABLE_GL_STATE_CACHE){cc._currentShaderProgram=-1;for(var e=0;e<cc.MAX_ACTIVETEXTURE;e++)cc._currentBoundTexture[e]=-1;cc._blendingSource=-1,cc._blendingDest=-1,cc._GLServerState=0}},cc.glUseProgram=function(e){e!==cc._currentShaderProgram&&(cc._currentShaderProgram=e,cc._renderContext.useProgram(e))},cc.ENABLE_GL_STATE_CACHE||(cc.glUseProgram=function(e){cc._renderContext.useProgram(e)}),cc.glDeleteProgram=function(e){cc.ENABLE_GL_STATE_CACHE&&e===cc._currentShaderProgram&&(cc._currentShaderProgram=-1),gl.deleteProgram(e)},cc.glBlendFunc=function(e,t){e===cc._blendingSource&&t===cc._blendingDest||(cc._blendingSource=e,cc._blendingDest=t,cc.setBlending(e,t))},cc.setBlending=function(e,t){var i=cc._renderContext;e===i.ONE&&t===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),cc._renderContext.blendFunc(e,t))},cc.glBlendFuncForParticle=function(e,t){if(e!==cc._blendingSource||t!==cc._blendingDest){cc._blendingSource=e,cc._blendingDest=t;var i=cc._renderContext;e===i.ONE&&t===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,t,e,t))}},cc.ENABLE_GL_STATE_CACHE||(cc.glBlendFunc=cc.setBlending),cc.glBlendResetToCache=function(){var e=cc._renderContext;e.blendEquation(e.FUNC_ADD),cc.ENABLE_GL_STATE_CACHE?cc.setBlending(cc._blendingSource,cc._blendingDest):cc.setBlending(e.BLEND_SRC,e.BLEND_DST)},cc.setProjectionMatrixDirty=function(){cc._currentProjectionMatrix=-1},cc.glEnableVertexAttribs=function(e){var t=cc._renderContext,i=e&cc.VERTEX_ATTRIB_FLAG_POSITION;i!==cc._vertexAttribPosition&&(i?t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION):t.disableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),cc._vertexAttribPosition=i);var n=e&cc.VERTEX_ATTRIB_FLAG_COLOR;n!==cc._vertexAttribColor&&(n?t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR):t.disableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),cc._vertexAttribColor=n);var r=e&cc.VERTEX_ATTRIB_FLAG_TEX_COORDS;r!==cc._vertexAttribTexCoords&&(r?t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS):t.disableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),cc._vertexAttribTexCoords=r)},cc.glBindTexture2D=function(e){cc.glBindTexture2DN(0,e)},cc.glBindTexture2DN=function(e,t){if(cc._currentBoundTexture[e]!=t){cc._currentBoundTexture[e]=t;var i=cc._renderContext;i.activeTexture(i.TEXTURE0+e),t?i.bindTexture(i.TEXTURE_2D,t._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)}},cc.ENABLE_GL_STATE_CACHE||(cc.glBindTexture2DN=function(e,t){var i=cc._renderContext;i.activeTexture(i.TEXTURE0+e),t?i.bindTexture(i.TEXTURE_2D,t._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)}),cc.glDeleteTexture=function(e){cc.glDeleteTextureN(0,e)},cc.glDeleteTextureN=function(e,t){cc.ENABLE_GL_STATE_CACHE&&t==cc._currentBoundTexture[e]&&(cc._currentBoundTexture[e]=-1),cc._renderContext.deleteTexture(t)},cc.glBindVAO=function(e){cc.TEXTURE_ATLAS_USE_VAO&&cc.ENABLE_GL_STATE_CACHE&&cc._uVAO!=e&&(cc._uVAO=e)},cc.glEnable=function(e){cc.ENABLE_GL_STATE_CACHE},cc.IMAGE_FORMAT_JPEG=0,cc.IMAGE_FORMAT_PNG=1,cc.IMAGE_FORMAT_RAWDATA=9,cc.NextPOT=function(e){return e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1},cc.RenderTexture=cc.Node.extend({sprite:null,clearFlags:0,clearDepthVal:0,autoDraw:!1,_texture:null,_pixelFormat:cc.Texture2D.PIXEL_FORMAT_RGBA8888,clearStencilVal:0,_clearColor:null,_className:"RenderTexture",ctor:function(e,t,i,n){cc.Node.prototype.ctor.call(this),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this._clearColor=new cc.Color(0,0,0,255),void 0!==e&&void 0!==t&&(i=i||cc.Texture2D.PIXEL_FORMAT_RGBA8888,n=n||0,this.initWithWidthAndHeight(e,t,i,n)),this.setAnchorPoint(0,0)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.RenderTexture.CanvasRenderCmd(this):new cc.RenderTexture.WebGLRenderCmd(this)},cleanup:function(){cc.Node.prototype.onExit.call(this),this._renderCmd.cleanup()},getSprite:function(){return this.sprite},setSprite:function(e){this.sprite=e},initWithWidthAndHeight:function(e,t,i,n){return this._renderCmd.initWithWidthAndHeight(e,t,i,n)},begin:function(){cc.renderer._turnToCacheMode(this.__instanceId),this._renderCmd.begin()},beginWithClear:function(e,t,i,n,r,o){var s=cc._renderContext;r=r||s.COLOR_BUFFER_BIT,o=o||s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT,this._beginWithClear(e,t,i,n,r,o,s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT|s.STENCIL_BUFFER_BIT)},_beginWithClear:function(e,t,i,n,r,o,s){this.begin(),this._renderCmd._beginWithClear(e,t,i,n,r,o,s)},end:function(){this._renderCmd.end()},clear:function(e,t,i,n){this.beginWithClear(e,t,i,n),this.end()},clearRect:function(e,t,i,n){this._renderCmd.clearRect(e,t,i,n)},clearDepth:function(e){this._renderCmd.clearDepth(e)},clearStencil:function(e){this._renderCmd.clearStencil(e)},getClearFlags:function(){return this.clearFlags},setClearFlags:function(e){this.clearFlags=e},getClearColor:function(){return this._clearColor},setClearColor:function(e){var t=this._clearColor;t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a,this._renderCmd.updateClearColor(e)},getClearDepth:function(){return this.clearDepthVal},setClearDepth:function(e){this.clearDepthVal=e},getClearStencil:function(){return this.clearStencilVal},setClearStencil:function(e){this.clearStencilVal=e},isAutoDraw:function(){return this.autoDraw},setAutoDraw:function(e){this.autoDraw=e},saveToFile:function(e,t){cc.log("saveToFile isn't supported on Cocos2d-Html5")},newCCImage:function(e){return cc.log("saveToFile isn't supported on cocos2d-html5"),null},listenToBackground:function(e){},listenToForeground:function(e){}}),(_p=cc.RenderTexture.prototype).clearColorVal,cc.defineGetterSetter(_p,"clearColorVal",_p.getClearColor,_p.setClearColor),cc.RenderTexture.create=function(e,t,i,n){return new cc.RenderTexture(e,t,i,n)},function(){cc.RenderTexture.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._clearColorStr="rgba(255,255,255,1)",this._cacheCanvas=cc.newElement("canvas"),this._cacheContext=new cc.CanvasContextWrapper(this._cacheCanvas.getContext("2d"))};var e=cc.RenderTexture.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.RenderTexture.CanvasRenderCmd,e.cleanup=function(){this._cacheContext=null,this._cacheCanvas=null},e.clearStencil=function(e){},e.updateClearColor=function(e){this._clearColorStr="rgba("+(0|e.r)+","+(0|e.g)+","+(0|e.b)+","+e.a/255+")"},e.initWithWidthAndHeight=function(e,t,i,n){var r=this._node,o=this._cacheCanvas,s=cc.contentScaleFactor();o.width=0|e*s,o.height=0|t*s;var a=new cc.Texture2D;a.initWithElement(o),a.handleLoadedTexture();var c=r.sprite=new cc.Sprite(a);return c.setBlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA),r.autoDraw=!1,r.addChild(c),!0},e.begin=function(){},e._beginWithClear=function(e,t,i,n,r,o,s){e=e||0,t=t||0,i=i||0,n=isNaN(n)?1:n;var a=this._cacheContext.getContext(),c=this._cacheCanvas;a.setTransform(1,0,0,1,0,0),this._cacheContext.setFillStyle("rgba("+(0|e)+","+(0|t)+","+(0|i)+","+n/255+")"),a.clearRect(0,0,c.width,c.height),a.fillRect(0,0,c.width,c.height)},e.end=function(){var e=this._node,t=cc.contentScaleFactor();cc.renderer._renderingToCacheCanvas(this._cacheContext,e.__instanceId,t,t)},e.clearRect=function(e,t,i,n){this._cacheContext.clearRect(e,t,i,-n)},e.clearDepth=function(e){cc.log("clearDepth isn't supported on Cocos2d-Html5")},e.visit=function(e){var t=this._node;this._syncStatus(e),t.sprite.visit(this),this._dirtyFlag=0}}(),function(){cc.RenderTexture.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._fBO=null,this._oldFBO=null,this._textureCopy=null,this._depthRenderBuffer=null};var e=cc.RenderTexture.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.RenderTexture.WebGLRenderCmd,e.rendering=function(e){var t=e||cc._renderContext,i=this._node;if(i.autoDraw){i.begin();var n=i.clearFlags;if(n){var r=[0,0,0,0],o=0,s=0;n&t.COLOR_BUFFER_BIT&&(r=t.getParameter(t.COLOR_CLEAR_VALUE),t.clearColor(i._clearColor.r/255,i._clearColor.g/255,i._clearColor.b/255,i._clearColor.a/255)),n&t.DEPTH_BUFFER_BIT&&(o=t.getParameter(t.DEPTH_CLEAR_VALUE),t.clearDepth(i.clearDepthVal)),n&t.STENCIL_BUFFER_BIT&&(s=t.getParameter(t.STENCIL_CLEAR_VALUE),t.clearStencil(i.clearStencilVal)),t.clear(n),n&t.COLOR_BUFFER_BIT&&t.clearColor(r[0],r[1],r[2],r[3]),n&t.DEPTH_BUFFER_BIT&&t.clearDepth(o),n&t.STENCIL_BUFFER_BIT&&t.clearStencil(s)}i.sortAllChildren();for(var a=i._children,c=0;c<a.length;c++){var l=a[c];l!=i.sprite&&l._renderCmd.visit(i.sprite._renderCmd)}i.end()}},e.clearStencil=function(e){var t=cc._renderContext,i=t.getParameter(t.STENCIL_CLEAR_VALUE);t.clearStencil(e),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(i)},e.cleanup=function(){this._node;this._textureCopy=null;var e=cc._renderContext;e.deleteFramebuffer(this._fBO),this._depthRenderBuffer&&e.deleteRenderbuffer(this._depthRenderBuffer)},e.updateClearColor=function(e){},e.initWithWidthAndHeight=function(e,t,i,n){var r=this._node;i==cc.Texture2D.PIXEL_FORMAT_A8&&cc.log("cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;");var o=cc._renderContext,s=cc.contentScaleFactor();e=0|e*s,t=0|t*s,this._oldFBO=o.getParameter(o.FRAMEBUFFER_BINDING);var a,c;cc.configuration.supportsNPOT()?(a=e,c=t):(a=cc.NextPOT(e),c=cc.NextPOT(t));for(var l=new Uint8Array(a*c*4),u=0;u<a*c*4;u++)l[u]=0;this._pixelFormat=i;var h=r._texture=new cc.Texture2D;if(!r._texture)return!1;h.initWithData(l,r._pixelFormat,a,c,cc.size(e,t));var d=o.getParameter(o.RENDERBUFFER_BINDING);if(cc.configuration.checkForGLExtension("GL_QCOM")){if(this._textureCopy=new cc.Texture2D,!this._textureCopy)return!1;this._textureCopy.initWithData(l,r._pixelFormat,a,c,cc.size(e,t))}this._fBO=o.createFramebuffer(),o.bindFramebuffer(o.FRAMEBUFFER,this._fBO),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,h._webTextureObj,0),0!=n&&(this._depthRenderBuffer=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,this._depthRenderBuffer),o.renderbufferStorage(o.RENDERBUFFER,n,a,c),n===o.DEPTH_STENCIL?o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer):n===o.STENCIL_INDEX||n===o.STENCIL_INDEX8?o.framebufferRenderbuffer(o.FRAMEBUFFER,o.STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer):n===o.DEPTH_COMPONENT16&&o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer)),o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&cc.log("Could not attach texture to the framebuffer"),h.setAliasTexParameters();var p=r.sprite=new cc.Sprite(h);return p.scaleY=-1,p.setBlendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.bindRenderbuffer(o.RENDERBUFFER,d),o.bindFramebuffer(o.FRAMEBUFFER,this._oldFBO),r.autoDraw=!1,r.addChild(p),!0},e.begin=function(){var e=this._node;cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPushMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPushMatrix();var t=cc.director;t.setProjection(t.getProjection());var i=e._texture.getContentSizeInPixels(),n=cc.director.getWinSizeInPixels(),r=n.width/i.width,o=n.height/i.height,s=cc._renderContext;s.viewport(0,0,i.width,i.height);var a=new cc.kmMat4;cc.kmMat4OrthographicProjection(a,-1/r,1/r,-1/o,1/o,-1,1),cc.kmGLMultMatrix(a),this._oldFBO=s.getParameter(s.FRAMEBUFFER_BINDING),s.bindFramebuffer(s.FRAMEBUFFER,this._fBO),cc.configuration.checkForGLExtension("GL_QCOM")&&(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,this._textureCopy._webTextureObj,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e._texture._webTextureObj,0))},e._beginWithClear=function(e,t,i,n,r,o,s){e/=255,t/=255,i/=255,n/=255;var a=cc._renderContext,c=[0,0,0,0],l=0,u=0;s&a.COLOR_BUFFER_BIT&&(c=a.getParameter(a.COLOR_CLEAR_VALUE),a.clearColor(e,t,i,n)),s&a.DEPTH_BUFFER_BIT&&(l=a.getParameter(a.DEPTH_CLEAR_VALUE),a.clearDepth(r)),s&a.STENCIL_BUFFER_BIT&&(u=a.getParameter(a.STENCIL_CLEAR_VALUE),a.clearStencil(o)),a.clear(s),s&a.COLOR_BUFFER_BIT&&a.clearColor(c[0],c[1],c[2],c[3]),s&a.DEPTH_BUFFER_BIT&&a.clearDepth(l),s&a.STENCIL_BUFFER_BIT&&a.clearStencil(u)},e.end=function(){var e=this._node;cc.renderer._renderingToBuffer(e.__instanceId);var t=cc._renderContext,i=cc.director;t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO),i.setViewport(),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPopMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPopMatrix()},e.clearRect=function(e,t,i,n){},e.clearDepth=function(e){var t=this._node;t.begin();var i=cc._renderContext,n=i.getParameter(i.DEPTH_CLEAR_VALUE);i.clearDepth(e),i.clear(i.DEPTH_BUFFER_BIT),i.clearDepth(n),t.end()},e.visit=function(e){var t=this._node;t._visible&&(cc.kmGLPushMatrix(),this._syncStatus(e),cc.renderer.pushRenderCommand(this),t.sprite.visit(this),this._dirtyFlag=0,cc.kmGLPopMatrix())}}(),cc.LabelAtlas=cc.AtlasNode.extend({_string:null,_mapStartChar:null,_textureLoaded:!1,_className:"LabelAtlas",ctor:function(e,t,i,n,r){cc.AtlasNode.prototype.ctor.call(this),this._renderCmd.setCascade(),t&&cc.LabelAtlas.prototype.initWithString.call(this,e,t,i,n,r)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.LabelAtlas.WebGLRenderCmd(this):new cc.LabelAtlas.CanvasRenderCmd(this)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},initWithString:function(e,t,i,n,r){var o,s,a,c,l=e+"";if(void 0===i){var u=cc.loader.getRes(t);if(1!==parseInt(u.version,10))return cc.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),!1;o=cc.path.changeBasename(t,u.textureFilename);var h=cc.contentScaleFactor();s=parseInt(u.itemWidth,10)/h,a=parseInt(u.itemHeight,10)/h,c=String.fromCharCode(parseInt(u.firstChar,10))}else o=t,s=i||0,a=n||0,c=r||" ";var d=null,p=(d=o instanceof cc.Texture2D?o:cc.textureCache.addImage(o)).isLoaded();return this._textureLoaded=p,p||d.addEventListener("load",function(e){this.initWithTexture(d,s,a,l.length),this.string=l,this.setColor(this._renderCmd._displayedColor),this.dispatchEvent("load")},this),!!this.initWithTexture(d,s,a,l.length)&&(this._mapStartChar=c,this.string=l,!0)},setColor:function(e){cc.AtlasNode.prototype.setColor.call(this,e),this._renderCmd.updateAtlasValues()},getString:function(){return this._string},addChild:function(e,t,i){this._renderCmd._addChild(e),cc.Node.prototype.addChild.call(this,e,t,i)},updateAtlasValues:function(){this._renderCmd.updateAtlasValues()},setString:function(e){var t=(e=String(e)).length;this._string=e,this.setContentSize(t*this._itemWidth,this._itemHeight),this._renderCmd.setString(e),this._renderCmd.updateAtlasValues(),this.quadsToDraw=t}}),function(){var e=cc.LabelAtlas.prototype;cc.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity),cc.defineGetterSetter(e,"color",e.getColor,e.setColor),e.string,cc.defineGetterSetter(e,"string",e.getString,e.setString)}(),cc.LabelAtlas.create=function(e,t,i,n,r){return new cc.LabelAtlas(e,t,i,n,r)},function(){cc.LabelAtlas.CanvasRenderCmd=function(e){cc.AtlasNode.CanvasRenderCmd.call(this,e),this._needDraw=!1};var e=cc.LabelAtlas.CanvasRenderCmd.prototype=Object.create(cc.AtlasNode.CanvasRenderCmd.prototype);e.constructor=cc.LabelAtlas.CanvasRenderCmd,e.setCascade=function(){var e=this._node;e._cascadeOpacityEnabled=!0,e._cascadeColorEnabled=!1},e.updateAtlasValues=function(){for(var e=this._node,t=e._string||"",i=t.length,n=this._texture,r=e._itemWidth,o=e._itemHeight,s=0;s<i;s++){var a=t.charCodeAt(s)-e._mapStartChar.charCodeAt(0),c=parseInt(a%e._itemsPerRow,10),l=parseInt(a/e._itemsPerRow,10),u=cc.rect(c*r,l*o,r,o),h=t.charCodeAt(s),d=e.getChildByTag(s);d?32==h?(d.init(),d.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):(d.initWithTexture(n,u),d.visible=!0):(d=new cc.Sprite,32==h?(d.init(),d.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):d.initWithTexture(n,u),cc.Node.prototype.addChild.call(e,d,0,s)),d.setPosition(s*r+r/2,o/2)}},e.setString=function(e){var t=this._node;if(t._children)for(var i=t._children,n=i.length,r=0;r<n;r++){var o=i[r];o&&!o._lateChild&&(o.visible=!1)}},e._addChild=function(){child._lateChild=!0}}(),function(){cc.LabelAtlas.WebGLRenderCmd=function(e){cc.AtlasNode.WebGLRenderCmd.call(this,e),this._needDraw=!0};var e=cc.LabelAtlas.WebGLRenderCmd.prototype=Object.create(cc.AtlasNode.WebGLRenderCmd.prototype);e.constructor=cc.LabelAtlas.WebGLRenderCmd,e.setCascade=function(){var e=this._node;e._cascadeOpacityEnabled=!0,e._cascadeColorEnabled=!0},e.rendering=function(e){if(cc.AtlasNode.WebGLRenderCmd.prototype.rendering.call(this,e),cc.LABELATLAS_DEBUG_DRAW){var t=this._node.getContentSize(),i=[cc.p(0,0),cc.p(t.width,0),cc.p(t.width,t.height),cc.p(0,t.height)];cc._drawingUtil.drawPoly(i,4,!0)}},e.updateAtlasValues=function(){var e=this._node,t=e._string,i=t.length,n=this._textureAtlas,r=n.texture,o=r.pixelsWidth,s=r.pixelsHeight,a=e._itemWidth,c=e._itemHeight;e._ignoreContentScaleFactor||(a=e._itemWidth*cc.contentScaleFactor(),c=e._itemHeight*cc.contentScaleFactor()),i>n.getCapacity()&&cc.log("cc.LabelAtlas._updateAtlasValues(): Invalid String length");for(var l=n.quads,u=this._displayedColor,h={r:u.r,g:u.g,b:u.b,a:e._displayedOpacity},d=e._itemWidth,p=0;p<i;p++){var _,f,m,g,y=t.charCodeAt(p)-e._mapStartChar.charCodeAt(0),T=y%e._itemsPerRow,v=0|y/e._itemsPerRow;cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(f=(_=(2*T*a+1)/(2*o))+(2*a-2)/(2*o),g=(m=(2*v*c+1)/(2*s))+(2*c-2)/(2*s)):(f=(_=T*a/o)+a/o,g=(m=v*c/s)+c/s);var S=l[p],C=S.tl,E=S.tr,b=S.bl,A=S.br;C.texCoords.u=_,C.texCoords.v=m,E.texCoords.u=f,E.texCoords.v=m,b.texCoords.u=_,b.texCoords.v=g,A.texCoords.u=f,A.texCoords.v=g,b.vertices.x=p*d,b.vertices.y=0,b.vertices.z=0,A.vertices.x=p*d+d,A.vertices.y=0,A.vertices.z=0,C.vertices.x=p*d,C.vertices.y=e._itemHeight,C.vertices.z=0,E.vertices.x=p*d+d,E.vertices.y=e._itemHeight,E.vertices.z=0,C.colors=h,E.colors=h,b.colors=h,A.colors=h}if(i>0){n.dirty=!0;var x=n.totalQuads;i>x&&n.increaseTotalQuadsWith(i-x)}},e.setString=function(e){var t=e.length;t>this._textureAtlas.totalQuads&&this._textureAtlas.resizeCapacity(t)},e._addChild=function(){}}(),cc.LABEL_AUTOMATIC_WIDTH=-1,cc.LabelBMFont=cc.SpriteBatchNode.extend({_opacityModifyRGB:!1,_string:"",_config:null,_fntFile:"",_initialString:"",_alignment:cc.TEXT_ALIGNMENT_CENTER,_width:-1,_lineBreakWithoutSpaces:!1,_imageOffset:null,_reusedChar:null,_textureLoaded:!1,_className:"LabelBMFont",_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.LabelBMFont.WebGLRenderCmd(this):new cc.LabelBMFont.CanvasRenderCmd(this)},_setString:function(e,t){t?this._initialString=e:this._string=e;var i=this._children;if(i)for(var n=0;n<i.length;n++){var r=i[n];r&&r.setVisible(!1)}this._textureLoaded&&(this.createFontChars(),t&&this.updateLabel())},ctor:function(e,t,i,n,r){cc.SpriteBatchNode.prototype.ctor.call(this),this._imageOffset=cc.p(0,0),this._reusedChar=[],this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this.initWithString(e,t,i,n,r)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(e){this._opacityModifyRGB=e;var t=this._children;if(t)for(var i=0;i<t.length;i++){var n=t[i];n&&(n.opacityModifyRGB=this._opacityModifyRGB)}},_changeTextureColor:function(){this._renderCmd._changeTextureColor()},init:function(){return this.initWithString(null,null,null,null,null)},initWithString:function(e,t,i,n,r){var o=this,s=e||"";this._renderCmd;o._config&&cc.log("cc.LabelBMFont.initWithString(): re-init is no longer supported");var a;if(t){var c=cc.loader.getRes(t);if(!c)return cc.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),!1;o._config=c,o._fntFile=t;var l=(a=cc.textureCache.addImage(c.atlasName)).isLoaded();o._textureLoaded=l,l||a.addEventListener("load",function(e){var t=this;t._textureLoaded=!0,t.initWithTexture(e,t._initialString.length),t.setString(t._initialString,!0),t.dispatchEvent("load")},o)}else{a=new cc.Texture2D;var u=new Image;a.initWithElement(u),o._textureLoaded=!1}return!!o.initWithTexture(a,s.length)&&(o._alignment=n||cc.TEXT_ALIGNMENT_LEFT,o._imageOffset=r||cc.p(0,0),o._width=null==i?-1:i,o._realOpacity=255,o._realColor=cc.color(255,255,255,255),o._contentSize.width=0,o._contentSize.height=0,o.setAnchorPoint(.5,.5),this._renderCmd._initBatchTexture(),o.setString(s,!0),!0)},createFontChars:function(){var e=this,t=this._renderCmd._texture||e.textureAtlas.texture,i=0,n=cc.size(0,0),r=0,o=1,s=e._string,a=s?s.length:0;if(0!==a){var c,l=e._config,u=l.kerningDict,h=l.commonHeight,d=l.fontDefDictionary;for(c=0;c<a-1;c++)10==s.charCodeAt(c)&&o++;var p=h*o,_=-(h-h*o),f=-1;for(c=0;c<a;c++){var m=s.charCodeAt(c);if(0!=m)if(10!==m){var g=u[f<<16|65535&m]||0,y=d[m];if(y){var T=cc.rect(y.rect.x,y.rect.y,y.rect.width,y.rect.height);(T=cc.rectPixelsToPoints(T)).x+=e._imageOffset.x,T.y+=e._imageOffset.y;var v=e.getChildByTag(c);v?this._renderCmd._updateCharTexture(v,T,m):((v=new cc.Sprite).initWithTexture(t,T,!1),v._newTextureWhenChangeColor=!0,this.addChild(v,0,c)),v.opacityModifyRGB=this._opacityModifyRGB,this._renderCmd._updateCharColorAndOpacity(v);var S=l.commonHeight-y.yOffset,C=cc.p(i+y.xOffset+.5*y.rect.width+g,_+S-.5*T.height*cc.contentScaleFactor());v.setPosition(cc.pointPixelsToPoints(C)),f=m,r<(i+=y.xAdvance+g)&&(r=i)}else cc.log("cocos2d: LabelBMFont: character not found "+s[c])}else i=0,_-=l.commonHeight}y&&y.xAdvance<y.rect.width?n.width=r-y.xAdvance+y.rect.width:n.width=r,n.height=p,e.setContentSize(cc.sizePixelsToPoints(n))}},updateString:function(e){var t=this,i=t._children;if(i)for(var n=0,r=i.length;n<r;n++){var o=i[n];o&&(o.visible=!1)}t._config&&t.createFontChars(),e||t.updateLabel()},getString:function(){return this._initialString},setString:function(e,t){e=String(e),null==t&&(t=!0),null!=e&&cc.isString(e)||(e+=""),this._initialString=e,this._setString(e,t)},_setStringForSetter:function(e){this.setString(e,!1)},setCString:function(e){this.setString(e,!0)},_getCharsWidth:function(e,t){if(t<=0)return 0;var i=this.getChildByTag(e),n=this.getChildByTag(e+t);return this._getLetterPosXLeft(n)-this._getLetterPosXLeft(i)},_checkWarp:function(e,t,i,n){for(var r=this,o=e[t],s=0,a=0;a<t;a++)s+=e[a].length;s=s+t-n;var c=r._getCharsWidth(s,e[t].length-1);if(c>i&&o.length>1){for(var l,u=o.length*(i/c)|0,h=o.substr(u),d=c-this._getCharsWidth(s+u,h.length-1),p=0,_=0;d>i&&_++<100;)u*=i/d,u|=0,h=o.substr(u),d=c-this._getCharsWidth(s+u,h.length-1);for(_=0;d<i&&_++<100;){if(h){var f=cc.LabelTTF._wordRex.exec(h);p=f?f[0].length:1,l=h}r._lineBreakWithoutSpaces&&(p=0),u+=p,h=o.substr(u),d=c-this._getCharsWidth(s+u,h.length-1)}0===(u-=p)&&(u=1,l=l.substr(1));var m,g=o.substr(0,u);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(l||h)&&(p=(m=cc.LabelTTF._lastWordRex.exec(g))?m[0].length:0,r._lineBreakWithoutSpaces&&(p=0),u-=p,l=o.substr(u),g=o.substr(0,u)),cc.LabelTTF._firsrEnglish.test(l)&&(m=cc.LabelTTF._lastEnglish.exec(g))&&g!==m[0]&&(p=m[0].length,r._lineBreakWithoutSpaces&&(p=0),u-=p,l=o.substr(u),g=o.substr(0,u)),e[t]=l||h,e.splice(t,0,g)}},updateLabel:function(){var e=this;if(e.string=e._initialString,e._width>0){var t=e.string.split("\n"),n="",r=0,o=0;for(i=0;i<t.length;i++)o=t.length,this._checkWarp(t,i,e._width*this._scaleX,r),o<t.length&&r++,i>0&&(n+="\n"),n+=t[i];n+=String.fromCharCode(0),e._setString(n,!1)}if(e._alignment!=cc.TEXT_ALIGNMENT_LEFT){i=0;for(var s=0,a=e._string.length,c=[],l=0;l<a;l++)if(10!=e._string[l].charCodeAt(0)&&0!=e._string[l].charCodeAt(0))c.push(e._string[i]);else{var u=0,h=c.length;if(0==h){s++;continue}var d=i+h-1+s;if(d<0)continue;var p=e.getChildByTag(d);if(null==p)continue;u=p.getPositionX()+p._getWidth()/2;var _=0;switch(e._alignment){case cc.TEXT_ALIGNMENT_CENTER:_=e.width/2-u/2;break;case cc.TEXT_ALIGNMENT_RIGHT:_=e.width-u}if(0!=_)for(j=0;j<h;j++)if(!((d=i+j+s)<0)){var f=e.getChildByTag(d);f&&(f.x+=_)}i+=h,s++,c.length=0}}},setAlignment:function(e){this._alignment=e,this.updateLabel()},_getAlignment:function(){return this._alignment},setBoundingWidth:function(e){this._width=e,this.updateLabel()},_getBoundingWidth:function(){return this._width},setLineBreakWithoutSpace:function(e){this._lineBreakWithoutSpaces=e,this.updateLabel()},setScale:function(e,t){cc.Node.prototype.setScale.call(this,e,t),this.updateLabel()},setScaleX:function(e){cc.Node.prototype.setScaleX.call(this,e),this.updateLabel()},setScaleY:function(e){cc.Node.prototype.setScaleY.call(this,e),this.updateLabel()},setFntFile:function(e){var t=this;if(null!=e&&e!=t._fntFile){var i=cc.loader.getRes(e);if(!i)return void cc.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file");t._fntFile=e,t._config=i;var n=cc.textureCache.addImage(i.atlasName),r=n.isLoaded();t._textureLoaded=r,t.texture=n,this._renderCmd._updateFntFileTexture(),r?t.createFontChars():n.addEventListener("load",function(e){var t=this;t._textureLoaded=!0,t.texture=e,t.createFontChars(),t._changeTextureColor(),t.updateLabel(),t.dispatchEvent("load")},t)}},getFntFile:function(){return this._fntFile},setTexture:function(e){this._renderCmd.setTexture(e)},setAnchorPoint:function(e,t){cc.Node.prototype.setAnchorPoint.call(this,e,t),this.updateLabel()},_setAnchorX:function(e){cc.Node.prototype._setAnchorX.call(this,e),this.updateLabel()},_setAnchorY:function(e){cc.Node.prototype._setAnchorY.call(this,e),this.updateLabel()},_atlasNameFromFntFile:function(e){},_kerningAmountForFirst:function(e,t){var i=0,n=e<<16|65535&t;if(this._configuration.kerningDictionary){var r=this._configuration.kerningDictionary[n.toString()];r&&(i=r.amount)}return i},_getLetterPosXLeft:function(e){return e.getPositionX()*this._scaleX-e._getWidth()*this._scaleX*e._getAnchorX()},_getLetterPosXRight:function(e){return e.getPositionX()*this._scaleX+e._getWidth()*this._scaleX*e._getAnchorX()},_isspace_unicode:function(e){return(e=e.charCodeAt(0))>=9&&e<=13||32==e||133==e||160==e||5760==e||e>=8192&&e<=8202||8232==e||8233==e||8239==e||8287==e||12288==e},_utf8_trim_ws:function(e){var t=e.length;if(!(t<=0)){var i=t-1;if(this._isspace_unicode(e[i])){for(var n=i-1;n>=0&&this._isspace_unicode(e[n]);--n)i=n;this._utf8_trim_from(e,i)}}},_utf8_trim_from:function(e,t){var i=e.length;t>=i||t<0||e.splice(t,i)}}),function(){var e=cc.LabelBMFont.prototype;cc.EventHelper.prototype.apply(e),e.string,cc.defineGetterSetter(e,"string",e.getString,e._setStringForSetter),e.boundingWidth,cc.defineGetterSetter(e,"boundingWidth",e._getBoundingWidth,e.setBoundingWidth),e.textAlign,cc.defineGetterSetter(e,"textAlign",e._getAlignment,e.setAlignment)}(),cc.LabelBMFont.create=function(e,t,i,n,r){return new cc.LabelBMFont(e,t,i,n,r)},cc._fntLoader={INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/,_parseStrToObj:function(e){var t=e.match(this.ITEM_EXP),i={};if(t)for(var n=0,r=t.length;n<r;n++){var o=t[n],s=o.indexOf("="),a=o.substring(0,s),c=o.substring(s+1);c.match(this.INT_EXP)?c=parseInt(c):'"'==c[0]&&(c=c.substring(1,c.length-1)),i[a]=c}return i},parseFnt:function(e,t){var i=this,n={},r=i._parseStrToObj(e.match(i.INFO_EXP)[0]).padding.split(","),o=(parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3]),i._parseStrToObj(e.match(i.COMMON_EXP)[0]));if(n.commonHeight=o.lineHeight,cc._renderType===cc._RENDER_TYPE_WEBGL){var s=cc.configuration.getMaxTextureSize();(o.scaleW>s.width||o.scaleH>s.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==o.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");var a=i._parseStrToObj(e.match(i.PAGE_EXP)[0]);0!==a.id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found"),n.atlasName=cc.path.changeBasename(t,a.file);for(var c=e.match(i.CHAR_EXP),l=n.fontDefDictionary={},u=0,h=c.length;u<h;u++){var d=i._parseStrToObj(c[u]);l[d.id]={rect:{x:d.x,y:d.y,width:d.width,height:d.height},xOffset:d.xoffset,yOffset:d.yoffset,xAdvance:d.xadvance}}var p=n.kerningDict={},_=e.match(i.KERNING_EXP);if(_)for(var u=0,h=_.length;u<h;u++){var f=i._parseStrToObj(_[u]);p[f.first<<16|65535&f.second]=f.amount}return n},load:function(e,t,i,n){var r=this;cc.loader.loadTxt(e,function(e,i){if(e)return n(e);n(null,r.parseFnt(i,t))})}},cc.loader.register(["fnt"],cc._fntLoader),function(){cc.LabelBMFont.CanvasRenderCmd=function(e){cc.SpriteBatchNode.CanvasRenderCmd.call(this,e),this._needDraw=!0};var e=cc.LabelBMFont.CanvasRenderCmd.prototype=Object.create(cc.SpriteBatchNode.CanvasRenderCmd.prototype);e.constructor=cc.LabelBMFont.CanvasRenderCmd,e.rendering=function(){},e._updateCharTexture=function(e,t,i){32===i?e.setTextureRect(t,!1,cc.size(0,0)):(e.setTextureRect(t,!1),e.visible=!0)},e._updateCharColorAndOpacity=function(e){e._displayedColor=this._displayedColor,e._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),e._displayedOpacity=this._displayedOpacity,e._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},e._updateFntFileTexture=function(){var e=this._node;e._originalTexture=e.texture},e.setTexture=function(e){for(var t=this._node._children,i=this._displayedColor,n=0;n<t.length;n++){var r=t[n],o=r._renderCmd,s=o._displayedColor;(this._texture==o._texture||s.r===i.r&&s.g===i.g&&s.b===i.b)&&(r.texture=e)}this._texture=e},cc.sys._supportCanvasNewBlendModes?e._changeTextureColor=function(){var e=this._node,t=e.getTexture();if(t&&t.getContentSize().width>0){var i=this._originalTexture.getHtmlElementObj();if(!i)return;var n=t.getHtmlElementObj(),r=cc.rect(0,0,i.width,i.height);n instanceof HTMLCanvasElement&&!e._rectRotated?(cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(i,this._displayedColor,r,n),e.setTexture(t)):(n=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(i,this._displayedColor,r),(t=new cc.Texture2D).initWithElement(n),t.handleLoadedTexture(),e.setTexture(t))}}:e._changeTextureColor=function(){var e,t=this._node,i=t.getTexture();if(i&&i.getContentSize().width>0){if(!(e=i.getHtmlElementObj()))return;var n=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());n&&(e instanceof HTMLCanvasElement&&!this._rectRotated?(cc.Sprite.CanvasRenderCmd._generateTintImage(e,n,this._displayedColor,null,e),this.setTexture(i)):(e=cc.Sprite.CanvasRenderCmd._generateTintImage(e,n,this._displayedColor),(i=new cc.Texture2D).initWithElement(e),i.handleLoadedTexture(),t.setTexture(i)))}},e._updateChildrenDisplayedOpacity=function(e){cc.Node.prototype.updateDisplayedOpacity.call(e,this._displayedOpacity)},e._updateChildrenDisplayedColor=function(e){cc.Node.prototype.updateDisplayedColor.call(e,this._displayedColor)},e._initBatchTexture=function(){}}(),function(){cc.LabelBMFont.WebGLRenderCmd=function(e){cc.SpriteBatchNode.WebGLRenderCmd.call(this,e),this._needDraw=!0};var e=cc.LabelBMFont.WebGLRenderCmd.prototype=Object.create(cc.SpriteBatchNode.WebGLRenderCmd.prototype);e.constructor=cc.LabelBMFont.WebGLRenderCmd,e._updateCharTexture=function(e,t,i){e.setTextureRect(t,!1),e.visible=!0},e._updateFntFileTexture=function(){},e._changeTextureColor=function(){},e._updateChildrenDisplayedOpacity=function(e){e.updateDisplayedOpacity(this._displayedOpacity)},e._updateChildrenDisplayedColor=function(e){e.updateDisplayedColor(this._displayedColor)},e._initBatchTexture=function(){var e=this._node,t=e.textureAtlas.texture;e._opacityModifyRGB=t.hasPremultipliedAlpha();var i=e._reusedChar=new cc.Sprite;i.initWithTexture(t,cc.rect(0,0,0,0),!1),i.batchNode=e},e.rendering=function(e){cc.SpriteBatchNode.WebGLRenderCmd.prototype.rendering.call(this,e);var t=this._node;if(cc.LABELBMFONT_DEBUG_DRAW){var i=t.getContentSize(),n=cc.p(0|-this._anchorPointInPoints.x,0|-this._anchorPointInPoints.y),r=[cc.p(n.x,n.y),cc.p(n.x+i.width,n.y),cc.p(n.x+i.width,n.y+i.height),cc.p(n.x,n.y+i.height)];cc._drawingUtil.setDrawColor(0,255,0,255),cc._drawingUtil.drawPoly(r,4,!0)}},e._updateCharColorAndOpacity=function(){}}(),cc.MotionStreak=cc.Node.extend({_texture:null,fastMode:!1,startingPositionInitialized:!1,_blendFunc:null,_stroke:0,_fadeDelta:0,_minSeg:0,_maxPoints:0,_nuPoints:0,_previousNuPoints:0,_pointVertexes:null,_pointState:null,_vertices:null,_colorPointer:null,_texCoords:null,_verticesBuffer:null,_colorPointerBuffer:null,_texCoordsBuffer:null,_className:"MotionStreak",ctor:function(e,t,i,n,r){cc.Node.prototype.ctor.call(this),this._positionR=cc.p(0,0),this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this.fastMode=!1,this.startingPositionInitialized=!1,this._texture=null,this._stroke=0,this._fadeDelta=0,this._minSeg=0,this._maxPoints=0,this._nuPoints=0,this._previousNuPoints=0,this._pointVertexes=null,this._pointState=null,this._vertices=null,this._colorPointer=null,this._texCoords=null,this._verticesBuffer=null,this._colorPointerBuffer=null,this._texCoordsBuffer=null,void 0!==r&&this.initWithFade(e,t,i,n,r)},getTexture:function(){return this._texture},setTexture:function(e){this._texture!=e&&(this._texture=e)},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){void 0===t?this._blendFunc=e:(this._blendFunc.src=e,this._blendFunc.dst=t)},getOpacity:function(){return cc.log("cc.MotionStreak.getOpacity has not been supported."),0},setOpacity:function(e){this._realOpacity=e},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},isFastMode:function(){return this.fastMode},setFastMode:function(e){this.fastMode=e},isStartingPositionInitialized:function(){return this.startingPositionInitialized},setStartingPositionInitialized:function(e){this.startingPositionInitialized=e},initWithFade:function(e,t,i,n,r){if(!r)throw"cc.MotionStreak.initWithFade(): Invalid filename or texture";cc.isString(r)&&(r=cc.textureCache.addImage(r)),cc.Node.prototype.setPosition.call(this,cc.p(0,0)),this.anchorX=0,this.anchorY=0,this.ignoreAnchor=!0,this.startingPositionInitialized=!1,this.fastMode=!0,this._minSeg=-1===t?i/5:t,this._minSeg*=this._minSeg,this._stroke=i,this._fadeDelta=1/e;var o=2+(0|60*e);return this._maxPoints=o,this._nuPoints=0,this._pointState=new Float32Array(o),this._pointVertexes=new Float32Array(2*o),this._vertices=new Float32Array(4*o),this._texCoords=new Float32Array(4*o),this._colorPointer=new Uint8Array(8*o),this._verticesBuffer=gl.createBuffer(),this._texCoordsBuffer=gl.createBuffer(),this._colorPointerBuffer=gl.createBuffer(),this._blendFunc.src=gl.SRC_ALPHA,this._blendFunc.dst=gl.ONE_MINUS_SRC_ALPHA,this._texture=r,this.color=n,this.scheduleUpdate(),gl.bindBuffer(gl.ARRAY_BUFFER,this._verticesBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._vertices,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._texCoordsBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._texCoords,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._colorPointerBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._colorPointer,gl.DYNAMIC_DRAW),!0},tintWithColor:function(e){this.color=e;for(var t=this._colorPointer,i=0,n=2*this._nuPoints;i<n;i++)t[4*i]=e.r,t[4*i+1]=e.g,t[4*i+2]=e.b},reset:function(){this._nuPoints=0},setPosition:function(e,t){this.startingPositionInitialized=!0,void 0===t?(this._positionR.x=e.x,this._positionR.y=e.y):(this._positionR.x=e,this._positionR.y=t)},getPositionX:function(){return this._positionR.x},setPositionX:function(e){this._positionR.x=e,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},getPositionY:function(){return this._positionR.y},setPositionY:function(e){this._positionR.y=e,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},update:function(e){if(this.startingPositionInitialized){this._renderCmd._updateDisplayColor(),e*=this._fadeDelta;var t,i,n,r,o=0,s=this._nuPoints,a=this._pointState,c=this._pointVertexes,l=this._vertices,u=this._colorPointer;for(n=0;n<s;n++)if(a[n]-=e,a[n]<=0)o++;else{t=n-o,o>0?(a[t]=a[n],c[2*t]=c[2*n],c[2*t+1]=c[2*n+1],r=2*n,l[2*(i=2*t)]=l[2*r],l[2*i+1]=l[2*r+1],l[2*(i+1)]=l[2*(r+1)],l[2*(i+1)+1]=l[2*(r+1)+1],r*=4,u[(i*=4)+0]=u[r+0],u[i+1]=u[r+1],u[i+2]=u[r+2],u[i+4]=u[r+4],u[i+5]=u[r+5],u[i+6]=u[r+6]):i=8*t;var h=a[t]*this._realOpacity;u[i+3]=h,u[i+7]=h}var d=!0;if((s-=o)>=this._maxPoints)d=!1;else if(s>0){var p=cc.pDistanceSQ(cc.p(c[2*(s-1)],c[2*(s-1)+1]),this._positionR)<this._minSeg,_=1!=s&&cc.pDistanceSQ(cc.p(c[2*(s-2)],c[2*(s-2)+1]),this._positionR)<2*this._minSeg;(p||_)&&(d=!1)}if(d){c[2*s]=this._positionR.x,c[2*s+1]=this._positionR.y,a[s]=1;var f=8*s,m=this.getDisplayedColor();u[f]=m.r,u[f+1]=m.g,u[f+2]=m.b,u[f+4]=m.r,u[f+5]=m.g,u[f+6]=m.b,u[f+3]=this._realOpacity,u[f+7]=this._realOpacity,s>0&&this.fastMode&&(s>1?cc.vertexLineToPolygon(c,this._stroke,this._vertices,s,1):cc.vertexLineToPolygon(c,this._stroke,this._vertices,0,2)),s++}if(this.fastMode||cc.vertexLineToPolygon(c,this._stroke,this._vertices,0,s),s&&this._previousNuPoints!=s){var g=1/s,y=this._texCoords;for(n=0;n<s;n++)y[4*n]=0,y[4*n+1]=g*n,y[2*(2*n+1)]=1,y[2*(2*n+1)+1]=g*n;this._previousNuPoints=s}this._nuPoints=s}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.MotionStreak.WebGLRenderCmd(this):null}}),cc.MotionStreak.create=function(e,t,i,n,r){return new cc.MotionStreak(e,t,i,n,r)},cc.MotionStreak.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},cc.MotionStreak.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.MotionStreak.WebGLRenderCmd.prototype.constructor=cc.MotionStreak.WebGLRenderCmd,cc.MotionStreak.WebGLRenderCmd.prototype.rendering=function(e){var t=this._node;t._nuPoints<=1||t._texture&&t._texture.isLoaded()&&(e=e||cc._renderContext,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),cc.glBindTexture2D(t._texture),e.bindBuffer(e.ARRAY_BUFFER,t._verticesBuffer),e.bufferData(e.ARRAY_BUFFER,t._vertices,e.DYNAMIC_DRAW),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t._texCoordsBuffer),e.bufferData(e.ARRAY_BUFFER,t._texCoords,e.DYNAMIC_DRAW),e.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t._colorPointerBuffer),e.bufferData(e.ARRAY_BUFFER,t._colorPointer,e.DYNAMIC_DRAW),e.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,0,0),e.drawArrays(e.TRIANGLE_STRIP,0,2*t._nuPoints),cc.g_NumberOfDraws++)},cc.NodeGrid=cc.Node.extend({grid:null,_target:null,getGrid:function(){return this.grid},setGrid:function(e){this.grid=e},setTarget:function(e){this._target=e},_transformForWebGL:function(){var e=this._transform4x4,t=cc.current_stack.top,i=this.getNodeToParentTransform(),n=e.mat;if(n[0]=i.a,n[4]=i.c,n[12]=i.tx,n[1]=i.b,n[5]=i.d,n[13]=i.ty,n[14]=this._vertexZ,cc.kmMat4Multiply(t,t,e),!(null==this._camera||this.grid&&this.grid.isActive())){var r=this._renderCmd._anchorPointInPoints,o=r.x,s=r.y;0!==o||0!==s?(cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(o|=0,s|=0),cc.kmGLTranslatef(o,s,0),this._camera.locate(),cc.kmGLTranslatef(-o,-s,0)):this._camera.locate()}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.NodeGrid.WebGLRenderCmd(this):new cc.Node.CanvasRenderCmd(this)}}),(_p=cc.NodeGrid.prototype).grid,_p.target,cc.defineGetterSetter(_p,"target",null,_p.setTarget),cc.NodeGrid.create=function(){return new cc.NodeGrid},function(){cc.NodeGrid.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!1,this._gridBeginCommand=new cc.CustomRenderCmd(this,this.onGridBeginDraw),this._gridEndCommand=new cc.CustomRenderCmd(this,this.onGridEndDraw)};var e=cc.NodeGrid.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.NodeGrid.WebGLRenderCmd,e.visit=function(e){var t=this._node;if(t._visible){e=e||this.getParentRenderCmd(),t._parent&&t._parent._renderCmd&&(this._curLevel=t._parent._renderCmd._curLevel+1);var i=cc.current_stack;i.stack.push(i.top),this._syncStatus(e),i.top=this._stackMatrix,cc.renderer.pushRenderCommand(this._gridBeginCommand),t._target&&t._target.visit();var n=t._children;if(n&&n.length>0){var r=n.length;t.sortAllChildren();for(var o=0;o<r;o++){var s=n[o];s&&s.visit()}}cc.renderer.pushRenderCommand(this._gridEndCommand),this._dirtyFlag=0,i.top=i.stack.pop()}},e.onGridBeginDraw=function(){var e=this._node.grid;e&&e._active&&e.beforeDraw()},e.onGridEndDraw=function(){var e=this._node.grid;e&&e._active&&e.afterDraw(this._node)}}(),cc.v2fzero=function(){return{x:0,y:0}},cc.v2f=function(e,t){return{x:e,y:t}},cc.v2fadd=function(e,t){return cc.v2f(e.x+t.x,e.y+t.y)},cc.v2fsub=function(e,t){return cc.v2f(e.x-t.x,e.y-t.y)},cc.v2fmult=function(e,t){return cc.v2f(e.x*t,e.y*t)},cc.v2fperp=function(e){return cc.v2f(-e.y,e.x)},cc.v2fneg=function(e){return cc.v2f(-e.x,-e.y)},cc.v2fdot=function(e,t){return e.x*t.x+e.y*t.y},cc.v2fforangle=function(e){return cc.v2f(Math.cos(e),Math.sin(e))},cc.v2fnormalize=function(e){var t=cc.pNormalize(cc.p(e.x,e.y));return cc.v2f(t.x,t.y)},cc.__v2f=function(e){return cc.v2f(e.x,e.y)},cc.__t=function(e){return{u:e.x,v:e.y}},cc.DrawNodeCanvas=cc.Node.extend({_buffer:null,_blendFunc:null,_lineWidth:1,_drawColor:null,_className:"DrawNodeCanvas",ctor:function(){cc.Node.prototype.ctor.call(this);var e=this._renderCmd;e._buffer=this._buffer=[],e._drawColor=this._drawColor=cc.color(255,255,255,255),e._blendFunc=this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.init()},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){void 0===t?(this._blendFunc.src=e.src,this._blendFunc.dst=e.dst):(this._blendFunc.src=e,this._blendFunc.dst=t)},setLineWidth:function(e){this._lineWidth=e},getLineWidth:function(){return this._lineWidth},setDrawColor:function(e){var t=this._drawColor;t.r=e.r,t.g=e.g,t.b=e.b,t.a=null==e.a?255:e.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)},drawRect:function(e,t,i,n,r){n=n||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);var o=[e,cc.p(t.x,e.y),t,cc.p(e.x,t.y)],s=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);s.verts=o,s.lineWidth=n,s.lineColor=r,s.isClosePolygon=!0,s.isStroke=!0,s.lineCap="butt",s.fillColor=i,i&&(null==i.a&&(i.a=255),s.isFill=!0),this._buffer.push(s)},drawCircle:function(e,t,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var a=2*Math.PI/n,c=[],l=0;l<=n;l++){var u=l*a,h=t*Math.cos(u+i)+e.x,d=t*Math.sin(u+i)+e.y;c.push(cc.p(h,d))}r&&c.push(cc.p(e.x,e.y));var p=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);p.verts=c,p.lineWidth=o,p.lineColor=s,p.isClosePolygon=!0,p.isStroke=!0,this._buffer.push(p)},drawQuadBezier:function(e,t,i,n,r,o){r=r||this._lineWidth,null==(o=o||this.getDrawColor()).a&&(o.a=255);for(var s=[],a=0,c=0;c<n;c++){var l=Math.pow(1-a,2)*e.x+2*(1-a)*a*t.x+a*a*i.x,u=Math.pow(1-a,2)*e.y+2*(1-a)*a*t.y+a*a*i.y;s.push(cc.p(l,u)),a+=1/n}s.push(cc.p(i.x,i.y));var h=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);h.verts=s,h.lineWidth=r,h.lineColor=o,h.isStroke=!0,h.lineCap="round",this._buffer.push(h)},drawCubicBezier:function(e,t,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var a=[],c=0,l=0;l<r;l++){var u=Math.pow(1-c,3)*e.x+3*Math.pow(1-c,2)*c*t.x+3*(1-c)*c*c*i.x+c*c*c*n.x,h=Math.pow(1-c,3)*e.y+3*Math.pow(1-c,2)*c*t.y+3*(1-c)*c*c*i.y+c*c*c*n.y;a.push(cc.p(u,h)),c+=1/r}a.push(cc.p(n.x,n.y));var d=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);d.verts=a,d.lineWidth=o,d.lineColor=s,d.isStroke=!0,d.lineCap="round",this._buffer.push(d)},drawCatmullRom:function(e,t,i,n){this.drawCardinalSpline(e,.5,t,i,n)},drawCardinalSpline:function(e,t,i,n,r){n=n||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);for(var o,s,a=[],c=1/e.length,l=0;l<i+1;l++){var u=l/i;1==u?(o=e.length-1,s=1):s=(u-c*(o=0|u/c))/c;var h=cc.cardinalSplineAt(cc.getControlPointAt(e,o-1),cc.getControlPointAt(e,o-0),cc.getControlPointAt(e,o+1),cc.getControlPointAt(e,o+2),t,s);a.push(h)}var d=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);d.verts=a,d.lineWidth=n,d.lineColor=r,d.isStroke=!0,d.lineCap="round",this._buffer.push(d)},drawDot:function(e,t,i){null==(i=i||this.getDrawColor()).a&&(i.a=255);var n=new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);n.verts=[e],n.lineWidth=t,n.fillColor=i,this._buffer.push(n)},drawDots:function(e,t,i){if(e&&0!=e.length){null==(i=i||this.getDrawColor()).a&&(i.a=255);for(var n=0,r=e.length;n<r;n++)this.drawDot(e[n],t,i)}},drawSegment:function(e,t,i,n){i=i||this._lineWidth,null==(n=n||this.getDrawColor()).a&&(n.a=255);var r=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);r.verts=[e,t],r.lineWidth=2*i,r.lineColor=n,r.isStroke=!0,r.lineCap="round",this._buffer.push(r)},drawPoly_:function(e,t,i,n){i=i||this._lineWidth,null==(n=n||this.getDrawColor()).a&&(n.a=255);var r=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);r.verts=e,r.fillColor=t,r.lineWidth=i,r.lineColor=n,r.isClosePolygon=!0,r.isStroke=!0,r.lineCap="round",t&&(r.isFill=!0),this._buffer.push(r)},drawPoly:function(e,t,i,n){for(var r=[],o=0;o<e.length;o++)r.push(cc.p(e[o].x,e[o].y));return this.drawPoly_(r,t,i,n)},clear:function(){this._buffer.length=0},_createRenderCmd:function(){return new cc.DrawNode.CanvasRenderCmd(this)}}),cc.DrawNodeWebGL=cc.Node.extend({_bufferCapacity:0,_buffer:null,_trianglesArrayBuffer:null,_trianglesWebBuffer:null,_trianglesReader:null,_lineWidth:1,_drawColor:null,_blendFunc:null,_dirty:!1,_className:"DrawNodeWebGL",getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){void 0===t?(this._blendFunc.src=e.src,this._blendFunc.dst=e.dst):(this._blendFunc.src=e,this._blendFunc.dst=t)},ctor:function(){cc.Node.prototype.ctor.call(this),this._buffer=[],this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this._drawColor=cc.color(255,255,255,255),this.init()},init:function(){return!!cc.Node.prototype.init.call(this)&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_LENGTHTEXTURECOLOR),this._ensureCapacity(64),this._trianglesWebBuffer=cc._renderContext.createBuffer(),this._dirty=!0,!0)},setLineWidth:function(e){this._lineWidth=e},getLineWidth:function(){return this._lineWidth},setDrawColor:function(e){var t=this._drawColor;t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)},drawRect:function(e,t,i,n,r){n=n||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);var o=[e,cc.p(t.x,e.y),t,cc.p(e.x,t.y)];null==i?this._drawSegments(o,n,r,!0):this.drawPoly(o,i,n,r)},drawCircle:function(e,t,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);var a,c,l=2*Math.PI/n,u=[];for(a=0;a<=n;a++){var h=a*l,d=t*Math.cos(h+i)+e.x,p=t*Math.sin(h+i)+e.y;u.push(cc.p(d,p))}for(r&&u.push(cc.p(e.x,e.y)),o*=.5,a=0,c=u.length;a<c-1;a++)this.drawSegment(u[a],u[a+1],o,s)},drawQuadBezier:function(e,t,i,n,r,o){r=r||this._lineWidth,null==(o=o||this.getDrawColor()).a&&(o.a=255);for(var s=[],a=0,c=0;c<n;c++){var l=Math.pow(1-a,2)*e.x+2*(1-a)*a*t.x+a*a*i.x,u=Math.pow(1-a,2)*e.y+2*(1-a)*a*t.y+a*a*i.y;s.push(cc.p(l,u)),a+=1/n}s.push(cc.p(i.x,i.y)),this._drawSegments(s,r,o,!1)},drawCubicBezier:function(e,t,i,n,r,o,s){o=o||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var a=[],c=0,l=0;l<r;l++){var u=Math.pow(1-c,3)*e.x+3*Math.pow(1-c,2)*c*t.x+3*(1-c)*c*c*i.x+c*c*c*n.x,h=Math.pow(1-c,3)*e.y+3*Math.pow(1-c,2)*c*t.y+3*(1-c)*c*c*i.y+c*c*c*n.y;a.push(cc.p(u,h)),c+=1/r}a.push(cc.p(n.x,n.y)),this._drawSegments(a,o,s,!1)},drawCatmullRom:function(e,t,i,n){this.drawCardinalSpline(e,.5,t,i,n)},drawCardinalSpline:function(e,t,i,n,r){n=n||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);for(var o,s,a=[],c=1/e.length,l=0;l<i+1;l++){var u=l/i;1==u?(o=e.length-1,s=1):s=(u-c*(o=0|u/c))/c;var h=cc.cardinalSplineAt(cc.getControlPointAt(e,o-1),cc.getControlPointAt(e,o-0),cc.getControlPointAt(e,o+1),cc.getControlPointAt(e,o+2),t,s);a.push(h)}n*=.5;for(var d=0,p=a.length;d<p-1;d++)this.drawSegment(a[d],a[d+1],n,r)},_render:function(){var e=cc._renderContext;cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),e.bindBuffer(e.ARRAY_BUFFER,this._trianglesWebBuffer),this._dirty&&(e.bufferData(e.ARRAY_BUFFER,this._trianglesArrayBuffer,e.STREAM_DRAW),this._dirty=!1);var t=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,t,0),e.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,t,8),e.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,e.FLOAT,!1,t,12),e.drawArrays(e.TRIANGLES,0,3*this._buffer.length),cc.incrementGLDraws(1)},_ensureCapacity:function(e){var t=this,i=t._buffer;if(i.length+e>t._bufferCapacity){var n=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;if(t._bufferCapacity+=Math.max(t._bufferCapacity,e),null==i||0===i.length)t._buffer=[],t._trianglesArrayBuffer=new ArrayBuffer(n*t._bufferCapacity),t._trianglesReader=new Uint8Array(t._trianglesArrayBuffer);else{for(var r=[],o=new ArrayBuffer(n*t._bufferCapacity),s=0;s<i.length;s++)r[s]=new cc.V2F_C4B_T2F_Triangle(i[s].a,i[s].b,i[s].c,o,s*n);t._trianglesReader=new Uint8Array(o),t._trianglesArrayBuffer=o,t._buffer=r}}},drawDot:function(e,t,i){null==(i=i||this.getDrawColor()).a&&(i.a=255);var n={r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},r={vertices:{x:e.x-t,y:e.y-t},colors:n,texCoords:{u:-1,v:-1}},o={vertices:{x:e.x-t,y:e.y+t},colors:n,texCoords:{u:-1,v:1}},s={vertices:{x:e.x+t,y:e.y+t},colors:n,texCoords:{u:1,v:1}},a={vertices:{x:e.x+t,y:e.y-t},colors:n,texCoords:{u:1,v:-1}};this._ensureCapacity(6),this._buffer.push(new cc.V2F_C4B_T2F_Triangle(r,o,s,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT)),this._buffer.push(new cc.V2F_C4B_T2F_Triangle(r,s,a,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT)),this._dirty=!0},drawDots:function(e,t,i){if(e&&0!=e.length){null==(i=i||this.getDrawColor()).a&&(i.a=255);for(var n=0,r=e.length;n<r;n++)this.drawDot(e[n],t,i)}},drawSegment:function(e,t,i,n){null==(n=n||this.getDrawColor()).a&&(n.a=255),i=i||.5*this._lineWidth;this._ensureCapacity(18);var r={r:0|n.r,g:0|n.g,b:0|n.b,a:0|n.a},o=cc.__v2f(e),s=cc.__v2f(t),a=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(s,o))),c=cc.v2fperp(a),l=cc.v2fmult(a,i),u=cc.v2fmult(c,i),h=cc.v2fsub(s,cc.v2fadd(l,u)),d=cc.v2fadd(s,cc.v2fsub(l,u)),p=cc.v2fsub(s,l),_=cc.v2fadd(s,l),f=cc.v2fsub(o,l),m=cc.v2fadd(o,l),g=cc.v2fsub(o,cc.v2fsub(l,u)),y=cc.v2fadd(o,cc.v2fadd(l,u)),T=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,v=this._trianglesArrayBuffer,S=this._buffer;S.push(new cc.V2F_C4B_T2F_Triangle({vertices:h,colors:r,texCoords:cc.__t(cc.v2fneg(cc.v2fadd(a,c)))},{vertices:d,colors:r,texCoords:cc.__t(cc.v2fsub(a,c))},{vertices:p,colors:r,texCoords:cc.__t(cc.v2fneg(a))},v,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:_,colors:r,texCoords:cc.__t(a)},{vertices:d,colors:r,texCoords:cc.__t(cc.v2fsub(a,c))},{vertices:p,colors:r,texCoords:cc.__t(cc.v2fneg(a))},v,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:_,colors:r,texCoords:cc.__t(a)},{vertices:f,colors:r,texCoords:cc.__t(cc.v2fneg(a))},{vertices:p,colors:r,texCoords:cc.__t(cc.v2fneg(a))},v,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:_,colors:r,texCoords:cc.__t(a)},{vertices:f,colors:r,texCoords:cc.__t(cc.v2fneg(a))},{vertices:m,colors:r,texCoords:cc.__t(a)},v,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:g,colors:r,texCoords:cc.__t(cc.v2fsub(c,a))},{vertices:f,colors:r,texCoords:cc.__t(cc.v2fneg(a))},{vertices:m,colors:r,texCoords:cc.__t(a)},v,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:g,colors:r,texCoords:cc.__t(cc.v2fsub(c,a))},{vertices:y,colors:r,texCoords:cc.__t(cc.v2fadd(a,c))},{vertices:m,colors:r,texCoords:cc.__t(a)},v,S.length*T)),this._dirty=!0},drawPoly:function(e,t,i,n){if(null!=t){null==t.a&&(t.a=255),null==n.a&&(n.a=255),i=i||this._lineWidth,i*=.5;var r,o,s,a,c={r:0|t.r,g:0|t.g,b:0|t.b,a:0|t.a},l={r:0|n.r,g:0|n.g,b:0|n.b,a:0|n.a},u=[],h=e.length;for(r=0;r<h;r++){o=cc.__v2f(e[(r-1+h)%h]),s=cc.__v2f(e[r]),a=cc.__v2f(e[(r+1)%h]);var d=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(s,o))),p=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(a,s))),_=cc.v2fmult(cc.v2fadd(d,p),1/(cc.v2fdot(d,p)+1));u[r]={offset:_,n:p}}var f=i>0,m=3*(3*h-2);this._ensureCapacity(m);var g=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,y=this._trianglesArrayBuffer,T=this._buffer,v=0==f?.5:0;for(r=0;r<h-2;r++)o=cc.v2fsub(cc.__v2f(e[0]),cc.v2fmult(u[0].offset,v)),s=cc.v2fsub(cc.__v2f(e[r+1]),cc.v2fmult(u[r+1].offset,v)),a=cc.v2fsub(cc.__v2f(e[r+2]),cc.v2fmult(u[r+2].offset,v)),T.push(new cc.V2F_C4B_T2F_Triangle({vertices:o,colors:c,texCoords:cc.__t(cc.v2fzero())},{vertices:s,colors:c,texCoords:cc.__t(cc.v2fzero())},{vertices:a,colors:c,texCoords:cc.__t(cc.v2fzero())},y,T.length*g));for(r=0;r<h;r++){var S=(r+1)%h;o=cc.__v2f(e[r]),s=cc.__v2f(e[S]);var C=u[r].n,E=u[r].offset,b=u[S].offset,A=f?cc.v2fsub(o,cc.v2fmult(E,i)):cc.v2fsub(o,cc.v2fmult(E,.5)),x=f?cc.v2fsub(s,cc.v2fmult(b,i)):cc.v2fsub(s,cc.v2fmult(b,.5)),R=f?cc.v2fadd(o,cc.v2fmult(E,i)):cc.v2fadd(o,cc.v2fmult(E,.5)),P=f?cc.v2fadd(s,cc.v2fmult(b,i)):cc.v2fadd(s,cc.v2fmult(b,.5));f?(T.push(new cc.V2F_C4B_T2F_Triangle({vertices:A,colors:l,texCoords:cc.__t(cc.v2fneg(C))},{vertices:x,colors:l,texCoords:cc.__t(cc.v2fneg(C))},{vertices:P,colors:l,texCoords:cc.__t(C)},y,T.length*g)),T.push(new cc.V2F_C4B_T2F_Triangle({vertices:A,colors:l,texCoords:cc.__t(cc.v2fneg(C))},{vertices:R,colors:l,texCoords:cc.__t(C)},{vertices:P,colors:l,texCoords:cc.__t(C)},y,T.length*g))):(T.push(new cc.V2F_C4B_T2F_Triangle({vertices:A,colors:c,texCoords:cc.__t(cc.v2fzero())},{vertices:x,colors:c,texCoords:cc.__t(cc.v2fzero())},{vertices:P,colors:c,texCoords:cc.__t(C)},y,T.length*g)),T.push(new cc.V2F_C4B_T2F_Triangle({vertices:A,colors:c,texCoords:cc.__t(cc.v2fzero())},{vertices:R,colors:c,texCoords:cc.__t(C)},{vertices:P,colors:c,texCoords:cc.__t(C)},y,T.length*g)))}u=null,this._dirty=!0}else this._drawSegments(e,i,n,!0)},_drawSegments:function(e,t,i,n){if(t=t||this._lineWidth,null==(i=i||this._drawColor).a&&(i.a=255),!((t*=.5)<=0)){var r,o,s,a,c={r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},l=[],u=e.length;for(r=0;r<u;r++){o=cc.__v2f(e[(r-1+u)%u]),s=cc.__v2f(e[r]),a=cc.__v2f(e[(r+1)%u]);var h=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(s,o))),d=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(a,s))),p=cc.v2fmult(cc.v2fadd(h,d),1/(cc.v2fdot(h,d)+1));l[r]={offset:p,n:d}}var _=3*(3*u-2);this._ensureCapacity(_);var f=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,m=this._trianglesArrayBuffer,g=this._buffer,y=n?u:u-1;for(r=0;r<y;r++){var T=(r+1)%u;o=cc.__v2f(e[r]),s=cc.__v2f(e[T]);var v=l[r].n,S=l[r].offset,C=l[T].offset,E=cc.v2fsub(o,cc.v2fmult(S,t)),b=cc.v2fsub(s,cc.v2fmult(C,t)),A=cc.v2fadd(o,cc.v2fmult(S,t)),x=cc.v2fadd(s,cc.v2fmult(C,t));g.push(new cc.V2F_C4B_T2F_Triangle({vertices:E,colors:c,texCoords:cc.__t(cc.v2fneg(v))},{vertices:b,colors:c,texCoords:cc.__t(cc.v2fneg(v))},{vertices:x,colors:c,texCoords:cc.__t(v)},m,g.length*f)),g.push(new cc.V2F_C4B_T2F_Triangle({vertices:E,colors:c,texCoords:cc.__t(cc.v2fneg(v))},{vertices:A,colors:c,texCoords:cc.__t(v)},{vertices:x,colors:c,texCoords:cc.__t(v)},m,g.length*f))}l=null,this._dirty=!0}},clear:function(){this._buffer.length=0,this._dirty=!0},_createRenderCmd:function(){return new cc.DrawNode.WebGLRenderCmd(this)}}),cc.DrawNode=cc._renderType==cc._RENDER_TYPE_WEBGL?cc.DrawNodeWebGL:cc.DrawNodeCanvas,cc.DrawNode.create=function(){return new cc.DrawNode},cc._DrawNodeElement=function(e,t,i,n,r,o,s,a,c){var l=this;l.type=e,l.verts=t||null,l.fillColor=i||null,l.lineWidth=n||0,l.lineColor=r||null,l.lineCap=o||"butt",l.isClosePolygon=s||!1,l.isFill=a||!1,l.isStroke=c||!1},cc.DrawNode.TYPE_DOT=0,cc.DrawNode.TYPE_SEGMENT=1,cc.DrawNode.TYPE_POLY=2,cc.DrawNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._buffer=null,this._drawColor=null,this._blendFunc=null},cc.DrawNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype),cc.DrawNode.CanvasRenderCmd.prototype.constructor=cc.DrawNode.CanvasRenderCmd,cc.DrawNode.CanvasRenderCmd.prototype.rendering=function(e,t,i){var n=e||cc._renderContext,r=(n.getContext(),this._node._displayedOpacity/255);if(0!==r){n.setTransform(this._worldTransform,t,i),n.setGlobalAlpha(r),this._blendFunc&&this._blendFunc.src==cc.SRC_ALPHA&&this._blendFunc.dst==cc.ONE&&n.setCompositeOperation("lighter");for(var o=this._buffer,s=0,a=o.length;s<a;s++){var c=o[s];switch(c.type){case cc.DrawNode.TYPE_DOT:this._drawDot(n,c,t,i);break;case cc.DrawNode.TYPE_SEGMENT:this._drawSegment(n,c,t,i);break;case cc.DrawNode.TYPE_POLY:this._drawPoly(n,c,t,i)}}}},cc.DrawNode.CanvasRenderCmd.prototype._drawDot=function(e,t,i,n){var r=t.fillColor,o=t.verts[0],s=t.lineWidth,a=e.getContext();e.setFillStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+","+r.a/255+")"),a.beginPath(),a.arc(o.x*i,-o.y*n,s*i,0,2*Math.PI,!1),a.closePath(),a.fill()},cc.DrawNode.CanvasRenderCmd.prototype._drawSegment=function(e,t,i,n){var r=t.lineColor,o=t.verts[0],s=t.verts[1],a=t.lineWidth,c=t.lineCap,l=e.getContext();e.setStrokeStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+","+r.a/255+")"),l.lineWidth=a*i,l.beginPath(),l.lineCap=c,l.moveTo(o.x*i,-o.y*n),l.lineTo(s.x*i,-s.y*n),l.stroke()},cc.DrawNode.CanvasRenderCmd.prototype._drawPoly=function(e,t,i,n){var r=t.verts,o=t.lineCap;if(null!=r){var s=t.fillColor,a=t.lineWidth,c=t.lineColor,l=t.isClosePolygon,u=t.isFill,h=t.isStroke,d=e.getContext(),p=r[0];d.lineCap=o,s&&e.setFillStyle("rgba("+(0|s.r)+","+(0|s.g)+","+(0|s.b)+","+s.a/255+")"),a&&(d.lineWidth=a*i),c&&e.setStrokeStyle("rgba("+(0|c.r)+","+(0|c.g)+","+(0|c.b)+","+c.a/255+")"),d.beginPath(),d.moveTo(p.x*i,-p.y*n);for(var _=1,f=r.length;_<f;_++)d.lineTo(r[_].x*i,-r[_].y*n);l&&d.closePath(),u&&d.fill(),h&&d.stroke()}},cc.DrawNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0},cc.DrawNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.DrawNode.WebGLRenderCmd.prototype.constructor=cc.DrawNode.WebGLRenderCmd,cc.DrawNode.WebGLRenderCmd.prototype.rendering=function(e){var t=this._node;cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),t._render()},cc.stencilBits=-1,cc.ClippingNode=cc.Node.extend({alphaThreshold:0,inverted:!1,_stencil:null,_className:"ClippingNode",ctor:function(e){e=e||null,cc.Node.prototype.ctor.call(this),this._stencil=e,this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits()},init:function(e){return this._stencil=e,this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits(),!0},onEnter:function(){cc.Node.prototype.onEnter.call(this),this._stencil.onEnter()},onEnterTransitionDidFinish:function(){cc.Node.prototype.onEnterTransitionDidFinish.call(this),this._stencil.onEnterTransitionDidFinish()},onExitTransitionDidStart:function(){this._stencil.onExitTransitionDidStart(),cc.Node.prototype.onExitTransitionDidStart.call(this)},onExit:function(){this._stencil.onExit(),cc.Node.prototype.onExit.call(this)},getAlphaThreshold:function(){return this.alphaThreshold},setAlphaThreshold:function(e){this.alphaThreshold=e},isInverted:function(){return this.inverted},setInverted:function(e){this.inverted=e},getStencil:function(){return this._stencil},setStencil:function(e){this._stencil!=e&&this._renderCmd.setStencil(e)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.ClippingNode.CanvasRenderCmd(this):new cc.ClippingNode.WebGLRenderCmd(this)}});var _p=cc.ClippingNode.prototype;cc.defineGetterSetter(_p,"stencil",_p.getStencil,_p.setStencil),_p.stencil,cc.ClippingNode.create=function(e){return new cc.ClippingNode(e)},function(){cc.ClippingNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!1,this._godhelpme=!1,this._clipElemType=!1,this._rendererSaveCmd=new cc.CustomRenderCmd(this,this._saveCmdCallback),this._rendererClipCmd=new cc.CustomRenderCmd(this,this._clipCmdCallback),this._rendererRestoreCmd=new cc.CustomRenderCmd(this,this._restoreCmdCallback)};var e=cc.ClippingNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.ClippingNode.CanvasRenderCmd,e.initStencilBits=function(){},e.setStencil=function(e){if(null!=e)if(this._node._stencil=e,e instanceof cc.DrawNode){if(e._buffer)for(var t=0;t<e._buffer.length;t++)e._buffer[t].isFill=!1,e._buffer[t].isStroke=!1;e._renderCmd.rendering=function(t,i,n){i=i||cc.view.getScaleX(),n=n||cc.view.getScaleY();var r=t||cc._renderContext,o=r.getContext(),s=this._transform;r.save(),o.transform(s.a,s.b,s.c,s.d,s.tx*i,-s.ty*n),o.beginPath();for(var a=0;a<e._buffer.length;a++){var c=e._buffer[a].verts,l=c[0];o.moveTo(l.x*i,-l.y*n);for(var u=1,h=c.length;u<h;u++)o.lineTo(c[u].x*i,-c[u].y*n)}r.restore()}}else e._parent=this._node},e._saveCmdCallback=function(e,t,i){var n=e||cc._renderContext,r=n.getContext();if(this._clipElemType){var o=cc.ClippingNode.CanvasRenderCmd._getSharedCache(),s=r.canvas;o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0)}else n.save(),n.save(),n.setTransform(this._worldTransform,t,i)},e._setStencilCompositionOperation=function(e){if(e){var t=this._node;if(e._renderCmd&&e._renderCmd._setBlendFuncStr&&e._renderCmd._setBlendFuncStr(t.inverted?"destination-out":"destination-in"),e._children)for(var i=e._children,n=0,r=i.length;n<r;n++)this._setStencilCompositionOperation(i[n])}},e._clipCmdCallback=function(e){var t=this._node,i=e||cc._renderContext,n=i.getContext();if(this._clipElemType)this._setStencilCompositionOperation(t._stencil);else{if(i.restore(),t.inverted){var r=n.canvas;i.save(),n.setTransform(1,0,0,1,0,0),n.moveTo(0,0),n.lineTo(0,r.height),n.lineTo(r.width,r.height),n.lineTo(r.width,0),n.lineTo(0,0),i.restore()}n.closePath(),n.clip()}},e._restoreCmdCallback=function(e){var t=cc.ClippingNode.CanvasRenderCmd._getSharedCache(),i=e||cc._renderContext,n=i.getContext();this._clipElemType?(n.save(),n.setTransform(1,0,0,1,0,0),n.globalCompositeOperation="destination-over",n.drawImage(t,0,0),n.restore(),this._dirtyFlag=0):i.restore()},e.transform=function(e,t){cc.Node.CanvasRenderCmd.prototype.transform.call(this,e,t);var i=this._node;i._stencil&&i._stencil._renderCmd&&i._stencil._renderCmd.transform(this,t)},e._cangodhelpme=function(e){return!0!==e&&!1!==e||(cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme=e),cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme},e.visit=function(e){var t=this._node;if(t._visible){(e=e||this.getParentRenderCmd())&&(this._curLevel=e._curLevel+1);var i=t._stencil instanceof cc.Sprite?this:null;if(this._clipElemType=this._cangodhelpme()||t._stencil instanceof cc.Sprite,t._stencil&&t._stencil.visible){if(this._syncStatus(e),cc.renderer.pushRenderCommand(this._rendererSaveCmd),this._clipElemType?cc.Node.CanvasRenderCmd.prototype.visit.call(this,e):t._stencil.visit(this),cc.renderer.pushRenderCommand(this._rendererClipCmd),this._clipElemType)t._stencil.visit(i);else{var n,r=t._children;this._cangodhelpme(!0);var o=r.length;if(o>0)for(t.sortAllChildren(),n=0;n<o;n++)r[n]._renderCmd.visit(this);this._cangodhelpme(!1)}cc.renderer.pushRenderCommand(this._rendererRestoreCmd),this._dirtyFlag=0}else this.inverted&&cc.Node.CanvasRenderCmd.prototype.visit.call(this,e)}},cc.ClippingNode.CanvasRenderCmd._sharedCache=null,cc.ClippingNode.CanvasRenderCmd._getSharedCache=function(){return cc.ClippingNode.CanvasRenderCmd._sharedCache||(cc.ClippingNode.CanvasRenderCmd._sharedCache=document.createElement("canvas"))}}(),function(){cc.ClippingNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!1,this._beforeVisitCmd=new cc.CustomRenderCmd(this,this._onBeforeVisit),this._afterDrawStencilCmd=new cc.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmd=new cc.CustomRenderCmd(this,this._onAfterVisit),this._currentStencilFunc=null,this._currentStencilRef=null,this._currentStencilValueMask=null,this._currentStencilFail=null,this._currentStencilPassDepthFail=null,this._currentStencilPassDepthPass=null,this._currentStencilWriteMask=null,this._currentStencilEnabled=null,this._currentDepthWriteMask=null,this._mask_layer_le=null};var e=cc.ClippingNode.WebGLRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.ClippingNode.WebGLRenderCmd,cc.ClippingNode.WebGLRenderCmd._init_once=null,cc.ClippingNode.WebGLRenderCmd._visit_once=null,cc.ClippingNode.WebGLRenderCmd._layer=-1,e.initStencilBits=function(){cc.ClippingNode.WebGLRenderCmd._init_once=!0,cc.ClippingNode.WebGLRenderCmd._init_once&&(cc.stencilBits=cc._renderContext.getParameter(cc._renderContext.STENCIL_BITS),cc.stencilBits<=0&&cc.log("Stencil buffer is not enabled."),cc.ClippingNode.WebGLRenderCmd._init_once=!1)},e.transform=function(e,t){var i=this._node;cc.Node.WebGLRenderCmd.prototype.transform.call(this,e,t),i._stencil&&i._stencil._renderCmd.transform(this,t)},e.visit=function(e){var t=this._node;if(t._visible)if(t._parent&&t._parent._renderCmd&&(this._curLevel=t._parent._renderCmd._curLevel+1),cc.stencilBits<1)cc.Node.WebGLRenderCmd.prototype.visit.call(this,e);else if(t._stencil&&t._stencil.visible){if(cc.ClippingNode.WebGLRenderCmd._layer+1==cc.stencilBits)return cc.ClippingNode.WebGLRenderCmd._visit_once=!0,cc.ClippingNode.WebGLRenderCmd._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its children."),cc.ClippingNode.WebGLRenderCmd._visit_once=!1),void cc.Node.WebGLRenderCmd.prototype.visit.call(this,e);cc.renderer.pushRenderCommand(this._beforeVisitCmd);var i=cc.current_stack;i.stack.push(i.top),this._syncStatus(e),i.top=this._stackMatrix,t._stencil._renderCmd.visit(this),cc.renderer.pushRenderCommand(this._afterDrawStencilCmd);var n=t._children;if(n&&n.length>0){var r=n.length;t.sortAllChildren();for(var o=0;o<r;o++)n[o]._renderCmd.visit(this)}cc.renderer.pushRenderCommand(this._afterVisitCmd),this._dirtyFlag=0,i.top=i.stack.pop()}else t.inverted&&cc.Node.WebGLRenderCmd.prototype.visit.call(this,e)},e.setStencil=function(e){var t=this._node;t._stencil&&(t._stencil._parent=null),t._stencil=e,t._stencil&&(t._stencil._parent=t)},e._drawFullScreenQuadClearStencil=function(){cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPushMatrix(),cc.kmGLLoadIdentity(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPushMatrix(),cc.kmGLLoadIdentity(),cc._drawingUtil.drawSolidRect(cc.p(-1,-1),cc.p(1,1),cc.color(255,255,255,255)),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPopMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPopMatrix()},e._onBeforeVisit=function(e){var t=e||cc._renderContext,i=this._node;cc.ClippingNode.WebGLRenderCmd._layer++;var n=1<<cc.ClippingNode.WebGLRenderCmd._layer,r=n-1;if(this._mask_layer_le=n|r,this._currentStencilEnabled=t.isEnabled(t.STENCIL_TEST),this._currentStencilWriteMask=t.getParameter(t.STENCIL_WRITEMASK),this._currentStencilFunc=t.getParameter(t.STENCIL_FUNC),this._currentStencilRef=t.getParameter(t.STENCIL_REF),this._currentStencilValueMask=t.getParameter(t.STENCIL_VALUE_MASK),this._currentStencilFail=t.getParameter(t.STENCIL_FAIL),this._currentStencilPassDepthFail=t.getParameter(t.STENCIL_PASS_DEPTH_FAIL),this._currentStencilPassDepthPass=t.getParameter(t.STENCIL_PASS_DEPTH_PASS),t.enable(t.STENCIL_TEST),t.stencilMask(n),this._currentDepthWriteMask=t.getParameter(t.DEPTH_WRITEMASK),t.depthMask(!1),t.stencilFunc(t.NEVER,n,n),t.stencilOp(i.inverted?t.REPLACE:t.ZERO,t.KEEP,t.KEEP),this._drawFullScreenQuadClearStencil(),t.stencilFunc(t.NEVER,n,n),t.stencilOp(i.inverted?t.ZERO:t.REPLACE,t.KEEP,t.KEEP),i.alphaThreshold<1){var o=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST),s=t.getUniformLocation(o.getProgram(),cc.UNIFORM_ALPHA_TEST_VALUE_S);cc.glUseProgram(o.getProgram()),o.setUniformLocationWith1f(s,i.alphaThreshold),cc.setProgram(i._stencil,o)}},e._onAfterDrawStencil=function(e){var t=e||cc._renderContext;t.depthMask(this._currentDepthWriteMask),t.stencilFunc(t.EQUAL,this._mask_layer_le,this._mask_layer_le),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e._onAfterVisit=function(e){var t=e||cc._renderContext;t.stencilFunc(this._currentStencilFunc,this._currentStencilRef,this._currentStencilValueMask),t.stencilOp(this._currentStencilFail,this._currentStencilPassDepthFail,this._currentStencilPassDepthPass),t.stencilMask(this._currentStencilWriteMask),this._currentStencilEnabled||t.disable(t.STENCIL_TEST),cc.ClippingNode.WebGLRenderCmd._layer--}}(),cc.GridBase=cc.Class.extend({_active:!1,_reuseGrid:0,_gridSize:null,_texture:null,_step:null,_grabber:null,_isTextureFlipped:!1,_shaderProgram:null,_directorProjection:0,_dirty:!1,ctor:function(e,t,i){cc._checkWebGLRenderMode(),this._active=!1,this._reuseGrid=0,this._gridSize=null,this._texture=null,this._step=cc.p(0,0),this._grabber=null,this._isTextureFlipped=!1,this._shaderProgram=null,this._directorProjection=0,this._dirty=!1,void 0!==e&&this.initWithSize(e,t,i)},isActive:function(){return this._active},setActive:function(e){if(this._active=e,!e){var t=cc.director,i=t.getProjection();t.setProjection(i)}},getReuseGrid:function(){return this._reuseGrid},setReuseGrid:function(e){this._reuseGrid=e},getGridSize:function(){return cc.size(this._gridSize.width,this._gridSize.height)},setGridSize:function(e){this._gridSize.width=parseInt(e.width),this._gridSize.height=parseInt(e.height)},getStep:function(){return cc.p(this._step.x,this._step.y)},setStep:function(e){this._step.x=e.x,this._step.y=e.y},isTextureFlipped:function(){return this._isTextureFlipped},setTextureFlipped:function(e){this._isTextureFlipped!=e&&(this._isTextureFlipped=e,this.calculateVertexPoints())},initWithSize:function(e,t,i){if(!t){var n=cc.director.getWinSizeInPixels(),r=cc.NextPOT(n.width),o=cc.NextPOT(n.height),s=new Uint8Array(r*o*4);if(!s)return cc.log("cocos2d: CCGrid: not enough memory."),!1;if((t=new cc.Texture2D).initWithData(s,cc.Texture2D.PIXEL_FORMAT_RGBA8888,r,o,n),!t)return cc.log("cocos2d: CCGrid: error creating texture"),!1}return i=i||!1,this._active=!1,this._reuseGrid=0,this._gridSize=e,this._texture=t,this._isTextureFlipped=i,this._step.x=this._texture.width/e.width,this._step.y=this._texture.height/e.height,this._grabber=new cc.Grabber,!!this._grabber&&(this._grabber.grab(this._texture),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),this.calculateVertexPoints(),!0)},beforeDraw:function(){this._directorProjection=cc.director.getProjection(),this._grabber.beforeRender(this._texture)},afterDraw:function(e){if(this._grabber.afterRender(this._texture),e&&e.getCamera().isDirty()){var t=e.getAnchorPointInPoints(),i=e._renderCmd._stackMatrix,n=new cc.kmMat4;cc.kmMat4Translation(n,t.x,t.y,0),cc.kmMat4Multiply(i,i,n),e._camera._locateForRenderer(i),cc.kmMat4Translation(n,-t.x,-t.y,0),cc.kmMat4Multiply(i,i,n)}cc.glBindTexture2D(this._texture),this.blit(e)},blit:function(){cc.log("cc.GridBase.blit(): Shall be overridden in subclass.")},reuse:function(){cc.log("cc.GridBase.reuse(): Shall be overridden in subclass.")},calculateVertexPoints:function(){cc.log("cc.GridBase.calculateVertexPoints(): Shall be overridden in subclass.")},set2DProjection:function(){var e=cc.director.getWinSizeInPixels();cc._renderContext.viewport(0,0,e.width,e.height),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity();var t=new cc.kmMat4;cc.kmMat4OrthographicProjection(t,0,e.width,0,e.height,-1,1),cc.kmGLMultMatrix(t),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity(),cc.setProjectionMatrixDirty()}}),cc.GridBase.create=function(e,t,i){return new cc.GridBase(e,t,i)},cc.Grid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,ctor:function(e,t,i){cc.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,void 0!==e&&this.initWithSize(e,t,i)},vertex:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.Grid3D.vertex() : Numbers must be integers");var t=0|3*(e.x*(this._gridSize.height+1)+e.y),i=this._vertices;return new cc.Vertex3F(i[t],i[t+1],i[t+2])},originalVertex:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.Grid3D.originalVertex() : Numbers must be integers");var t=0|3*(e.x*(this._gridSize.height+1)+e.y),i=this._originalVertices;return new cc.Vertex3F(i[t],i[t+1],i[t+2])},setVertex:function(e,t){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.Grid3D.setVertex() : Numbers must be integers");var i=0|3*(e.x*(this._gridSize.height+1)+e.y),n=this._vertices;n[i]=t.x,n[i+1]=t.y,n[i+2]=t.z,this._dirty=!0},blit:function(e){var t=this._gridSize.width*this._gridSize.height;cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS),this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(e._renderCmd._stackMatrix);var i=cc._renderContext,n=this._dirty;i.bindBuffer(i.ARRAY_BUFFER,this._verticesBuffer),n&&i.bufferData(i.ARRAY_BUFFER,this._vertices,i.DYNAMIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this._texCoordinateBuffer),n&&i.bufferData(i.ARRAY_BUFFER,this._texCoordinates,i.DYNAMIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),n&&i.bufferData(i.ELEMENT_ARRAY_BUFFER,this._indices,i.STATIC_DRAW),i.drawElements(i.TRIANGLES,6*t,i.UNSIGNED_SHORT,0),n&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(this._reuseGrid>0){for(var e=this._originalVertices,t=this._vertices,i=0,n=this._vertices.length;i<n;i++)e[i]=t[i];--this._reuseGrid}},calculateVertexPoints:function(){var e=cc._renderContext,t=this._texture.pixelsWidth,i=this._texture.pixelsHeight,n=this._texture.getContentSizeInPixels().height,r=this._gridSize,o=(r.width+1)*(r.height+1);this._vertices=new Float32Array(3*o),this._texCoordinates=new Float32Array(2*o),this._indices=new Uint16Array(r.width*r.height*6),this._verticesBuffer&&e.deleteBuffer(this._verticesBuffer),this._verticesBuffer=e.createBuffer(),this._texCoordinateBuffer&&e.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=e.createBuffer(),this._indicesBuffer&&e.deleteBuffer(this._indicesBuffer),this._indicesBuffer=e.createBuffer();var s,a,c,l=this._indices,u=this._texCoordinates,h=this._isTextureFlipped,d=this._vertices;for(s=0;s<r.width;++s)for(a=0;a<r.height;++a){var p=a*r.width+s,_=s*this._step.x,f=_+this._step.x,m=a*this._step.y,g=m+this._step.y,y=s*(r.height+1)+a,T=(s+1)*(r.height+1)+a,v=(s+1)*(r.height+1)+(a+1),S=s*(r.height+1)+(a+1);l[6*p]=y,l[6*p+1]=T,l[6*p+2]=S,l[6*p+3]=T,l[6*p+4]=v,l[6*p+5]=S;var C=[3*y,3*T,3*v,3*S],E=[{x:_,y:m,z:0},{x:f,y:m,z:0},{x:f,y:g,z:0},{x:_,y:g,z:0}],b=[2*y,2*T,2*v,2*S],A=[cc.p(_,m),cc.p(f,m),cc.p(f,g),cc.p(_,g)];for(c=0;c<4;++c)d[C[c]]=E[c].x,d[C[c]+1]=E[c].y,d[C[c]+2]=E[c].z,u[b[c]]=A[c].x/t,u[b[c]+1]=h?(n-A[c].y)/i:A[c].y/i}this._originalVertices=new Float32Array(this._vertices),e.bindBuffer(e.ARRAY_BUFFER,this._verticesBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._texCoordinateBuffer),e.bufferData(e.ARRAY_BUFFER,this._texCoordinates,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW),this._dirty=!0}}),cc.Grid3D.create=function(e,t,i){return new cc.Grid3D(e,t,i)},cc.TiledGrid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,ctor:function(e,t,i){cc.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,void 0!==e&&this.initWithSize(e,t,i)},tile:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.TiledGrid3D.tile() : Numbers must be integers");var t=4*(this._gridSize.height*e.x+e.y)*3,i=this._vertices;return new cc.Quad3(new cc.Vertex3F(i[t],i[t+1],i[t+2]),new cc.Vertex3F(i[t+3],i[t+4],i[t+5]),new cc.Vertex3F(i[t+6],i[t+7],i[t+8]),new cc.Vertex3F(i[t+9],i[t+10],i[t+11]))},originalTile:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.TiledGrid3D.originalTile() : Numbers must be integers");var t=4*(this._gridSize.height*e.x+e.y)*3,i=this._originalVertices;return new cc.Quad3(new cc.Vertex3F(i[t],i[t+1],i[t+2]),new cc.Vertex3F(i[t+3],i[t+4],i[t+5]),new cc.Vertex3F(i[t+6],i[t+7],i[t+8]),new cc.Vertex3F(i[t+9],i[t+10],i[t+11]))},setTile:function(e,t){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.TiledGrid3D.setTile() : Numbers must be integers");var i=12*(this._gridSize.height*e.x+e.y),n=this._vertices;n[i]=t.bl.x,n[i+1]=t.bl.y,n[i+2]=t.bl.z,n[i+3]=t.br.x,n[i+4]=t.br.y,n[i+5]=t.br.z,n[i+6]=t.tl.x,n[i+7]=t.tl.y,n[i+8]=t.tl.z,n[i+9]=t.tr.x,n[i+10]=t.tr.y,n[i+11]=t.tr.z,this._dirty=!0},blit:function(e){var t=this._gridSize.width*this._gridSize.height;this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(e._renderCmd._stackMatrix);var i=cc._renderContext,n=this._dirty;cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS),i.bindBuffer(i.ARRAY_BUFFER,this._verticesBuffer),n&&i.bufferData(i.ARRAY_BUFFER,this._vertices,i.DYNAMIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,0,this._vertices),i.bindBuffer(i.ARRAY_BUFFER,this._texCoordinateBuffer),n&&i.bufferData(i.ARRAY_BUFFER,this._texCoordinates,i.DYNAMIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,0,this._texCoordinates),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),n&&i.bufferData(i.ELEMENT_ARRAY_BUFFER,this._indices,i.STATIC_DRAW),i.drawElements(i.TRIANGLES,6*t,i.UNSIGNED_SHORT,0),n&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(this._reuseGrid>0){for(var e=this._vertices,t=this._originalVertices,i=0;i<e.length;i++)t[i]=e[i];--this._reuseGrid}},calculateVertexPoints:function(){var e=this._texture.pixelsWidth,t=this._texture.pixelsHeight,i=this._texture.getContentSizeInPixels().height,n=this._gridSize,r=n.width*n.height;this._vertices=new Float32Array(12*r),this._texCoordinates=new Float32Array(8*r),this._indices=new Uint16Array(6*r);var o=cc._renderContext;this._verticesBuffer&&o.deleteBuffer(this._verticesBuffer),this._verticesBuffer=o.createBuffer(),this._texCoordinateBuffer&&o.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=o.createBuffer(),this._indicesBuffer&&o.deleteBuffer(this._indicesBuffer),this._indicesBuffer=o.createBuffer();var s,a,c=0,l=this._step,u=this._vertices,h=this._texCoordinates,d=this._isTextureFlipped;for(s=0;s<n.width;s++)for(a=0;a<n.height;a++){var p=s*l.x,_=p+l.x,f=a*l.y,m=f+l.y;u[12*c]=p,u[12*c+1]=f,u[12*c+2]=0,u[12*c+3]=_,u[12*c+4]=f,u[12*c+5]=0,u[12*c+6]=p,u[12*c+7]=m,u[12*c+8]=0,u[12*c+9]=_,u[12*c+10]=m,u[12*c+11]=0;var g=f,y=m;d&&(g=i-f,y=i-m),h[8*c]=p/e,h[8*c+1]=g/t,h[8*c+2]=_/e,h[8*c+3]=g/t,h[8*c+4]=p/e,h[8*c+5]=y/t,h[8*c+6]=_/e,h[8*c+7]=y/t,c++}var T=this._indices;for(s=0;s<r;s++)T[6*s+0]=4*s+0,T[6*s+1]=4*s+1,T[6*s+2]=4*s+2,T[6*s+3]=4*s+1,T[6*s+4]=4*s+2,T[6*s+5]=4*s+3;this._originalVertices=new Float32Array(this._vertices),o.bindBuffer(o.ARRAY_BUFFER,this._verticesBuffer),o.bufferData(o.ARRAY_BUFFER,this._vertices,o.DYNAMIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,this._texCoordinateBuffer),o.bufferData(o.ARRAY_BUFFER,this._texCoordinates,o.DYNAMIC_DRAW),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,this._indices,o.DYNAMIC_DRAW),this._dirty=!0}}),cc.TiledGrid3D.create=function(e,t,i){return new cc.TiledGrid3D(e,t,i)},cc.Grabber=cc.Class.extend({_FBO:null,_oldFBO:null,_oldClearColor:null,_gl:null,ctor:function(){cc._checkWebGLRenderMode(),this._gl=cc._renderContext,this._oldClearColor=[0,0,0,0],this._oldFBO=null,this._FBO=this._gl.createFramebuffer()},grab:function(e){var t=this._gl;this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._FBO),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e._webTextureObj,0),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&cc.log("Frame Grabber: could not attach texture to frmaebuffer"),t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO)},beforeRender:function(e){var t=this._gl;this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._FBO),this._oldClearColor=t.getParameter(t.COLOR_CLEAR_VALUE),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},afterRender:function(e){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO),t.colorMask(!0,!0,!0,!0)},destroy:function(){this._gl.deleteFramebuffer(this._FBO)}}),cc.ACTION_TAG_INVALID=-1,cc.Action=cc.Class.extend({originalTarget:null,target:null,tag:cc.ACTION_TAG_INVALID,ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.ACTION_TAG_INVALID},copy:function(){return cc.log("copy is deprecated. Please use clone instead."),this.clone()},clone:function(){var e=new cc.Action;return e.originalTarget=null,e.target=null,e.tag=this.tag,e},isDone:function(){return!0},startWithTarget:function(e){this.originalTarget=e,this.target=e},stop:function(){this.target=null},step:function(e){cc.log("[Action step]. override me")},update:function(e){cc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(e){this.target=e},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(e){this.originalTarget=e},getTag:function(){return this.tag},setTag:function(e){this.tag=e},retain:function(){},release:function(){}}),cc.action=function(){return new cc.Action},cc.Action.create=cc.action,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(e){this._duration=e},reverse:function(){return cc.log("cocos2d: FiniteTimeAction#reverse: Implement me"),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(e,t){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,e&&this.initWithAction(e,t)},getSpeed:function(){return this._speed},setSpeed:function(e){this._speed=e},initWithAction:function(e,t){if(!e)throw"cc.Speed.initWithAction(): action must be non nil";return this._innerAction=e,this._speed=t,!0},clone:function(){var e=new cc.Speed;return e.initWithAction(this._innerAction.clone(),this._speed),e},startWithTarget:function(e){cc.Action.prototype.startWithTarget.call(this,e),this._innerAction.startWithTarget(e)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(e){this._innerAction.step(e*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(e){this._innerAction!=e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(e,t){return new cc.Speed(e,t)},cc.Speed.create=cc.speed,cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(e,t){cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),e&&(t?this.initWithTarget(e,t):this.initWithTarget(e))},clone:function(){var e=new cc.Follow,t=this._worldRect,i=new cc.Rect(t.x,t.y,t.width,t.height);return e.initWithTarget(this._followedNode,i),e},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(e){this._boundarySet=e},initWithTarget:function(e,t){if(!e)throw"cc.Follow.initWithAction(): followedNode must be non nil";var i=this;t=t||cc.rect(0,0,0,0),i._followedNode=e,i._worldRect=t,i._boundarySet=!cc._rectEqualToZero(t),i._boundaryFullyCovered=!1;var n=cc.director.getWinSize();return i._fullScreenSize=cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(t.x+t.width-i._fullScreenSize.x),i.rightBoundary=-t.x,i.topBoundary=-t.y,i.bottomBoundary=-(t.y+t.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary==i.bottomBoundary&&i.leftBoundary==i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(e){var t=this._followedNode.x,i=this._followedNode.y;if(t=this._halfScreenSize.x-t,i=this._halfScreenSize.y-i,this.target._renderCmd._dirtyFlag=0,this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(cc.clampf(t,this.leftBoundary,this.rightBoundary),cc.clampf(i,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(t,i)},isDone:function(){return!this._followedNode.running},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(e,t){return new cc.Follow(e,t)},cc.Follow.create=cc.follow,cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(e){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(e)},getElapsed:function(){return this._elapsed},initWithDuration:function(e){return this._duration=0===e?cc.FLT_EPSILON:e,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(e){e._repeatForever=this._repeatForever,e._speed=this._speed,e._timesForRepeat=this._timesForRepeat,e._easeList=this._easeList,e._speedMethod=this._speedMethod,e._repeatMethod=this._repeatMethod},_reverseEaseList:function(e){if(this._easeList){e._easeList=[];for(var t=0;t<this._easeList.length;t++)e._easeList.push(this._easeList[t].reverse())}},clone:function(){var e=new cc.ActionInterval(this._duration);return this._cloneDecoration(e),e},easing:function(e){this._easeList?this._easeList.length=0:this._easeList=[];for(var t=0;t<arguments.length;t++)this._easeList.push(arguments[t]);return this},_computeEaseTime:function(e){var t=this._easeList;if(!t||0===t.length)return e;for(var i=0,n=t.length;i<n;i++)e=t[i].easing(e);return e},step:function(e){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=e;var t=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);t=1>t?t:1,this.update(t>0?t:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(e){cc.Action.prototype.startWithTarget.call(this,e),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.log("cc.IntervalAction: reverse not implemented."),null},setAmplitudeRate:function(e){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){return cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass."),0},speed:function(e){return e<=0?(cc.log("The speed parameter error"),this):(this._speedMethod=!0,this._speed*=e,this)},getSpeed:function(){return this._speed},setSpeed:function(e){return this._speed=e,this},repeat:function(e){return e=Math.round(e),isNaN(e)||e<1?(cc.log("The repeat parameter error"),this):(this._repeatMethod=!0,this._timesForRepeat*=e,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(e){return new cc.ActionInterval(e)},cc.ActionInterval.create=cc.actionInterval,cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var t=e instanceof Array?e:arguments,i=t.length-1;if(i>=0&&null==t[i]&&cc.log("parameters should not be ending with null in Javascript"),i>=0){for(var n,r=t[0],o=1;o<i;o++)t[o]&&(n=r,r=cc.Sequence._actionOneTwo(n,t[o]));this.initWithTwoActions(r,t[i])}},initWithTwoActions:function(e,t){if(!e||!t)throw"cc.Sequence.initWithTwoActions(): arguments must all be non nil";var i=e._duration+t._duration;return this.initWithDuration(i),this._actions[0]=e,this._actions[1]=t,!0},clone:function(){var e=new cc.Sequence;return this._cloneDecoration(e),e.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(e){var t,i,n=0,r=this._split,o=this._actions,s=this._last;(e=this._computeEaseTime(e))<r?(t=0!==r?e/r:1,0===n&&1===s&&(o[1].update(0),o[1].stop())):(n=1,t=1===r?1:(e-r)/(1-r),-1===s&&(o[0].startWithTarget(this.target),o[0].update(1),o[0].stop()),s||(o[0].update(1),o[0].stop())),i=o[n],s===n&&i.isDone()||(s!==n&&i.startWithTarget(this.target),t*=i._timesForRepeat,i.update(t>1?t%1:t),this._last=n)},reverse:function(){var e=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.sequence=function(e){var t=e instanceof Array?e:arguments;t.length>0&&null==t[t.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var i,n,r,o;t&&t.length>0;)for(o=(n=Array.prototype.shift.call(t))._timesForRepeat||1,n._repeatMethod=!1,n._timesForRepeat=1,r=0,i||(i=n,r=1),r;r<o;r++)i=cc.Sequence._actionOneTwo(i,n);return i},cc.Sequence.create=cc.sequence,cc.Sequence._actionOneTwo=function(e,t){var i=new cc.Sequence;return i.initWithTwoActions(e,t),i},cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(e,t){cc.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithAction(e,t)},initWithAction:function(e,t){var i=e._duration*t;return!!this.initWithDuration(i)&&(this._times=t,this._innerAction=e,e instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0)},clone:function(){var e=new cc.Repeat;return this._cloneDecoration(e),e.initWithAction(this._innerAction.clone(),this._times),e},startWithTarget:function(e){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,e),this._innerAction.startWithTarget(e)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(e){e=this._computeEaseTime(e);var t=this._innerAction,i=this._duration,n=this._times,r=this._nextDt;if(e>=r){for(;e>r&&this._total<n;)t.update(1),this._total++,t.stop(),t.startWithTarget(this.target),r+=t._duration/i,this._nextDt=r;e>=1&&this._total<n&&this._total++,this._actionInstant||(this._total===n?(t.update(1),t.stop()):t.update(e-(r-t._duration/i)))}else t.update(e*n%1)},isDone:function(){return this._total==this._times},reverse:function(){var e=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(e),this._reverseEaseList(e),e},setInnerAction:function(e){this._innerAction!=e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(e,t){return new cc.Repeat(e,t)},cc.Repeat.create=cc.repeat,cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,e&&this.initWithAction(e)},initWithAction:function(e){if(!e)throw"cc.RepeatForever.initWithAction(): action must be non null";return this._innerAction=e,!0},clone:function(){var e=new cc.RepeatForever;return this._cloneDecoration(e),e.initWithAction(this._innerAction.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._innerAction.startWithTarget(e)},step:function(e){var t=this._innerAction;t.step(e),t.isDone()&&(t.startWithTarget(this.target),t.step(t.getElapsed()-t._duration))},isDone:function(){return!1},reverse:function(){var e=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e},setInnerAction:function(e){this._innerAction!=e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(e){return new cc.RepeatForever(e)},cc.RepeatForever.create=cc.repeatForever,cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var t=e instanceof Array?e:arguments,i=t.length-1;if(i>=0&&null==t[i]&&cc.log("parameters should not be ending with null in Javascript"),i>=0){for(var n,r=t[0],o=1;o<i;o++)t[o]&&(n=r,r=cc.Spawn._actionOneTwo(n,t[o]));this.initWithTwoActions(r,t[i])}},initWithTwoActions:function(e,t){if(!e||!t)throw"cc.Spawn.initWithTwoActions(): arguments must all be non null";var i=!1,n=e._duration,r=t._duration;return this.initWithDuration(Math.max(n,r))&&(this._one=e,this._two=t,n>r?this._two=cc.Sequence._actionOneTwo(t,cc.delayTime(n-r)):n<r&&(this._one=cc.Sequence._actionOneTwo(e,cc.delayTime(r-n))),i=!0),i},clone:function(){var e=new cc.Spawn;return this._cloneDecoration(e),e.initWithTwoActions(this._one.clone(),this._two.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._one.startWithTarget(e),this._two.startWithTarget(e)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(e){e=this._computeEaseTime(e),this._one&&this._one.update(e),this._two&&this._two.update(e)},reverse:function(){var e=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.spawn=function(e){var t=e instanceof Array?e:arguments;t.length>0&&null==t[t.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var i=t[0],n=1;n<t.length;n++)null!=t[n]&&(i=cc.Spawn._actionOneTwo(i,t[n]));return i},cc.Spawn.create=cc.spawn,cc.Spawn._actionOneTwo=function(e,t){var i=new cc.Spawn;return i.initWithTwoActions(e,t),i},cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(e,t,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._dstAngleX=t||0,this._dstAngleY=i||this._dstAngleX,!0)},clone:function(){var e=new cc.RotateTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.rotationX%360,i=this._dstAngleX-t;i>180&&(i-=360),i<-180&&(i+=360),this._startAngleX=t,this._diffAngleX=i,this._startAngleY=e.rotationY%360;var n=this._dstAngleY-this._startAngleY;n>180&&(n-=360),n<-180&&(n+=360),this._diffAngleY=n},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(e){e=this._computeEaseTime(e),this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*e,this.target.rotationY=this._startAngleY+this._diffAngleY*e)}}),cc.rotateTo=function(e,t,i){return new cc.RotateTo(e,t,i)},cc.RotateTo.create=cc.rotateTo,cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(e,t,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._angleX=t||0,this._angleY=i||this._angleX,!0)},clone:function(){var e=new cc.RotateBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._angleX,this._angleY),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._startAngleX=e.rotationX,this._startAngleY=e.rotationY},update:function(e){e=this._computeEaseTime(e),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*e,this.target.rotationY=this._startAngleY+this._angleY*e)},reverse:function(){var e=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.rotateBy=function(e,t,i){return new cc.RotateBy(e,t,i)},cc.RotateBy.create=cc.rotateBy,cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(e,t,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(void 0!==t.x&&(i=t.y,t=t.x),this._positionDelta.x=t,this._positionDelta.y=i,!0)},clone:function(){var e=new cc.MoveBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._positionDelta),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.getPositionX(),i=e.getPositionY();this._previousPosition.x=t,this._previousPosition.y=i,this._startPosition.x=t,this._startPosition.y=i},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=this._positionDelta.x*e,i=this._positionDelta.y*e,n=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var r=this.target.getPositionX(),o=this.target.getPositionY(),s=this._previousPosition;n.x=n.x+r-s.x,n.y=n.y+o-s.y,t+=n.x,i+=n.y,s.x=t,s.y=i,this.target.setPosition(t,i)}else this.target.setPosition(n.x+t,n.y+i)}},reverse:function(){var e=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.moveBy=function(e,t,i){return new cc.MoveBy(e,t,i)},cc.MoveBy.create=cc.moveBy,cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(e,t,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.MoveBy.prototype.initWithDuration.call(this,e,t,i)&&(void 0!==t.x&&(i=t.y,t=t.x),this._endPosition.x=t,this._endPosition.y=i,!0)},clone:function(){var e=new cc.MoveTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endPosition),e},startWithTarget:function(e){cc.MoveBy.prototype.startWithTarget.call(this,e),this._positionDelta.x=this._endPosition.x-e.getPositionX(),this._positionDelta.y=this._endPosition.y-e.getPositionY()}}),cc.moveTo=function(e,t,i){return new cc.MoveTo(e,t,i)},cc.MoveTo.create=cc.moveTo,cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(e,t,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){var n=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._endSkewX=t,this._endSkewY=i,n=!0),n},clone:function(){var e=new cc.SkewTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endSkewX,this._endSkewY),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._startSkewX=e.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=e.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(e){e=this._computeEaseTime(e),this.target.skewX=this._startSkewX+this._deltaX*e,this.target.skewY=this._startSkewY+this._deltaY*e}}),cc.skewTo=function(e,t,i){return new cc.SkewTo(e,t,i)},cc.SkewTo.create=cc.skewTo,cc.SkewBy=cc.SkewTo.extend({ctor:function(e,t,i){cc.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){var n=!1;return cc.SkewTo.prototype.initWithDuration.call(this,e,t,i)&&(this._skewX=t,this._skewY=i,n=!0),n},clone:function(){var e=new cc.SkewBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._skewX,this._skewY),e},startWithTarget:function(e){cc.SkewTo.prototype.startWithTarget.call(this,e),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var e=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.skewBy=function(e,t,i){return new cc.SkewBy(e,t,i)},cc.SkewBy.create=cc.skewBy,cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(e,t,i,n,r){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void 0!==n&&this.initWithDuration(e,t,i,n,r)},initWithDuration:function(e,t,i,n,r){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(void 0===r&&(r=n,n=i,i=t.y,t=t.x),this._delta.x=t,this._delta.y=i,this._height=n,this._jumps=r,!0)},clone:function(){var e=new cc.JumpBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._delta,this._height,this._jumps),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.getPositionX(),i=e.getPositionY();this._previousPosition.x=t,this._previousPosition.y=i,this._startPosition.x=t,this._startPosition.y=i},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=e*this._jumps%1,i=4*this._height*t*(1-t);i+=this._delta.y*e;var n=this._delta.x*e,r=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var o=this.target.getPositionX(),s=this.target.getPositionY(),a=this._previousPosition;r.x=r.x+o-a.x,r.y=r.y+s-a.y,n+=r.x,i+=r.y,a.x=n,a.y=i,this.target.setPosition(n,i)}else this.target.setPosition(r.x+n,r.y+i)}},reverse:function(){var e=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.jumpBy=function(e,t,i,n,r){return new cc.JumpBy(e,t,i,n,r)},cc.JumpBy.create=cc.jumpBy,cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(e,t,i,n,r){cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==n&&this.initWithDuration(e,t,i,n,r)},initWithDuration:function(e,t,i,n,r){return!!cc.JumpBy.prototype.initWithDuration.call(this,e,t,i,n,r)&&(void 0===r&&(i=t.y,t=t.x),this._endPosition.x=t,this._endPosition.y=i,!0)},startWithTarget:function(e){cc.JumpBy.prototype.startWithTarget.call(this,e),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var e=new cc.JumpTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),e}}),cc.jumpTo=function(e,t,i,n,r){return new cc.JumpTo(e,t,i,n,r)},cc.JumpTo.create=cc.jumpTo,cc.bezierAt=function(e,t,i,n,r){return Math.pow(1-r,3)*e+3*r*Math.pow(1-r,2)*t+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(e,t){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._config=t,!0)},clone:function(){var e=new cc.BezierBy;this._cloneDecoration(e);for(var t=[],i=0;i<this._config.length;i++){var n=this._config[i];t.push(cc.p(n.x,n.y))}return e.initWithDuration(this._duration,t),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.getPositionX(),i=e.getPositionY();this._previousPosition.x=t,this._previousPosition.y=i,this._startPosition.x=t,this._startPosition.y=i},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=this._config,i=t[0].x,n=t[1].x,r=t[2].x,o=t[0].y,s=t[1].y,a=t[2].y,c=cc.bezierAt(0,i,n,r,e),l=cc.bezierAt(0,o,s,a,e),u=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var h=this.target.getPositionX(),d=this.target.getPositionY(),p=this._previousPosition;u.x=u.x+h-p.x,u.y=u.y+d-p.y,c+=u.x,l+=u.y,p.x=c,p.y=l,this.target.setPosition(c,l)}else this.target.setPosition(u.x+c,u.y+l)}},reverse:function(){var e=this._config,t=[cc.pAdd(e[1],cc.pNeg(e[2])),cc.pAdd(e[0],cc.pNeg(e[2])),cc.pNeg(e[2])],i=new cc.BezierBy(this._duration,t);return this._cloneDecoration(i),this._reverseEaseList(i),i}}),cc.bezierBy=function(e,t){return new cc.BezierBy(e,t)},cc.BezierBy.create=cc.bezierBy,cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(e,t){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._toConfig=t,!0)},clone:function(){var e=new cc.BezierTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toConfig),e},startWithTarget:function(e){cc.BezierBy.prototype.startWithTarget.call(this,e);var t=this._startPosition,i=this._toConfig,n=this._config;n[0]=cc.pSub(i[0],t),n[1]=cc.pSub(i[1],t),n[2]=cc.pSub(i[2],t)}}),cc.bezierTo=function(e,t){return new cc.BezierTo(e,t)},cc.BezierTo.create=cc.bezierTo,cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(e,t,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._endScaleX=t,this._endScaleY=null!=i?i:t,!0)},clone:function(){var e=new cc.ScaleTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endScaleX,this._endScaleY),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._startScaleX=e.scaleX,this._startScaleY=e.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(e){e=this._computeEaseTime(e),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*e,this.target.scaleY=this._startScaleY+this._deltaY*e)}}),cc.scaleTo=function(e,t,i){return new cc.ScaleTo(e,t,i)},cc.ScaleTo.create=cc.scaleTo,cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(e){cc.ScaleTo.prototype.startWithTarget.call(this,e),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var e=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.ScaleBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endScaleX,this._endScaleY),e}}),cc.scaleBy=function(e,t,i){return new cc.ScaleBy(e,t,i)},cc.ScaleBy.create=cc.scaleBy,cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(e,t){cc.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._times=t,!0)},clone:function(){var e=new cc.Blink;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._times),e},update:function(e){if(e=this._computeEaseTime(e),this.target&&!this.isDone()){var t=1/this._times,i=e%t;this.target.visible=i>t/2}},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._originalState=e.visible},stop:function(){this.target.visible=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var e=new cc.Blink(this._duration,this._times);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.blink=function(e,t){return new cc.Blink(e,t)},cc.Blink.create=cc.blink,cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(e,t){cc.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._toOpacity=t,!0)},clone:function(){var e=new cc.FadeTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e},update:function(e){e=this._computeEaseTime(e);var t=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=t+(this._toOpacity-t)*e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._fromOpacity=e.opacity}}),cc.fadeTo=function(e,t){return new cc.FadeTo(e,t)},cc.FadeTo.create=cc.fadeTo,cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(e){cc.FadeTo.prototype.ctor.call(this),null==e&&(e=0),this.initWithDuration(e,255)},reverse:function(){var e=new cc.FadeOut;return e.initWithDuration(this._duration,0),this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.FadeIn;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e},startWithTarget:function(e){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,e)}}),cc.fadeIn=function(e){return new cc.FadeIn(e)},cc.FadeIn.create=cc.fadeIn,cc.FadeOut=cc.FadeTo.extend({ctor:function(e){cc.FadeTo.prototype.ctor.call(this),null==e&&(e=0),this.initWithDuration(e,0)},reverse:function(){var e=new cc.FadeIn;return e._reverseAction=this,e.initWithDuration(this._duration,255),this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.FadeOut;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e}}),cc.fadeOut=function(e){return new cc.FadeOut(e)},cc.FadeOut.create=cc.fadeOut,cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(e,t,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=cc.color(t,i,n),!0)},clone:function(){var e=new cc.TintTo;this._cloneDecoration(e);var t=this._to;return e.initWithDuration(this._duration,t.r,t.g,t.b),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._from=this.target.color},update:function(e){e=this._computeEaseTime(e);var t=this._from,i=this._to;t&&(this.target.color=cc.color(t.r+(i.r-t.r)*e,t.g+(i.g-t.g)*e,t.b+(i.b-t.b)*e))}}),cc.tintTo=function(e,t,i,n){return new cc.TintTo(e,t,i,n)},cc.TintTo.create=cc.tintTo,cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(e,t,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._deltaR=t,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var e=new cc.TintBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.color;this._fromR=t.r,this._fromG=t.g,this._fromB=t.b},update:function(e){e=this._computeEaseTime(e),this.target.color=cc.color(this._fromR+this._deltaR*e,this._fromG+this._deltaG*e,this._fromB+this._deltaB*e)},reverse:function(){var e=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.tintBy=function(e,t,i,n){return new cc.TintBy(e,t,i,n)},cc.TintBy.create=cc.tintBy,cc.DelayTime=cc.ActionInterval.extend({update:function(e){},reverse:function(){var e=new cc.DelayTime(this._duration);return this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.DelayTime;return this._cloneDecoration(e),e.initWithDuration(this._duration),e}}),cc.delayTime=function(e){return new cc.DelayTime(e)},cc.DelayTime.create=cc.delayTime,cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this),this._other=null,e&&this.initWithAction(e)},initWithAction:function(e){if(!e)throw"cc.ReverseTime.initWithAction(): action must be non null";if(e==this._other)throw"cc.ReverseTime.initWithAction(): the action was already passed in.";return!!cc.ActionInterval.prototype.initWithDuration.call(this,e._duration)&&(this._other=e,!0)},clone:function(){var e=new cc.ReverseTime;return this._cloneDecoration(e),e.initWithAction(this._other.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._other.startWithTarget(e)},update:function(e){e=this._computeEaseTime(e),this._other&&this._other.update(1-e)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(e){return new cc.ReverseTime(e)},cc.ReverseTime.create=cc.reverseTime,cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],e&&this.initWithAnimation(e)},getAnimation:function(){return this._animation},setAnimation:function(e){this._animation=e},initWithAnimation:function(e){if(!e)throw"cc.Animate.initWithAnimation(): animation must be non-NULL";var t=e.getDuration();if(this.initWithDuration(t*e.getLoops())){this._nextFrame=0,this.setAnimation(e),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,r=t/e.getTotalDelayUnits(),o=e.getFrames();cc.arrayVerifyType(o,cc.AnimationFrame);for(var s=0;s<o.length;s++){var a=n*r/t;n+=o[s].getDelayUnits(),i.push(a)}return!0}return!1},clone:function(){var e=new cc.Animate;return this._cloneDecoration(e),e.initWithAnimation(this._animation.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._animation.getRestoreOriginalFrame()&&(this._origFrame=e.displayFrame()),this._nextFrame=0,this._executedLoops=0},update:function(e){(e=this._computeEaseTime(e))<1&&((0|(e*=this._animation.getLoops()))>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),e%=1);for(var t=this._animation.getFrames(),i=t.length,n=this._splitTimes,r=this._nextFrame;r<i&&n[r]<=e;r++)this.target.setSpriteFrame(t[r].getSpriteFrame()),this._nextFrame=r+1},reverse:function(){var e=this._animation,t=e.getFrames(),i=[];if(cc.arrayVerifyType(t,cc.AnimationFrame),t.length>0)for(var n=t.length-1;n>=0;n--){var r=t[n];if(!r)break;i.push(r.clone())}var o=new cc.Animation(i,e.getDelayPerUnit(),e.getLoops());o.setRestoreOriginalFrame(e.getRestoreOriginalFrame());var s=new cc.Animate(o);return this._cloneDecoration(s),this._reverseEaseList(s),s},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),cc.Action.prototype.stop.call(this)}}),cc.animate=function(e){return new cc.Animate(e)},cc.Animate.create=cc.animate,cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(e,t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithTarget(e,t)},initWithTarget:function(e,t){return!!this.initWithDuration(t._duration)&&(this._forcedTarget=e,this._action=t,!0)},clone:function(){var e=new cc.TargetedAction;return this._cloneDecoration(e),e.initWithTarget(this._forcedTarget,this._action.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(e){e=this._computeEaseTime(e),this._action.update(e)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(e){this._forcedTarget!=e&&(this._forcedTarget=e)}}),cc.targetedAction=function(e,t){return new cc.TargetedAction(e,t)},cc.TargetedAction.create=cc.targetedAction,cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(e){this.update(1)},update:function(e){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.ActionInstant.extend({update:function(e){this.target.visible=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Show.create=cc.show,cc.Hide=cc.ActionInstant.extend({update:function(e){this.target.visible=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.Hide.create=cc.hide,cc.ToggleVisibility=cc.ActionInstant.extend({update:function(e){this.target.visible=!this.target.visible},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.ToggleVisibility.create=cc.toggleVisibility,cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(e){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==e&&this.init(e)},update:function(e){this.target.removeFromParent(this._isNeedCleanUp)},init:function(e){return this._isNeedCleanUp=e,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(e){return new cc.RemoveSelf(e)},cc.RemoveSelf.create=cc.removeSelf,cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(e){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==e&&this.initWithFlipX(e)},initWithFlipX:function(e){return this._flippedX=e,!0},update:function(e){this.target.flippedX=this._flippedX},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var e=new cc.FlipX;return e.initWithFlipX(this._flippedX),e}}),cc.flipX=function(e){return new cc.FlipX(e)},cc.FlipX.create=cc.flipX,cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(e){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==e&&this.initWithFlipY(e)},initWithFlipY:function(e){return this._flippedY=e,!0},update:function(e){this.target.flippedY=this._flippedY},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var e=new cc.FlipY;return e.initWithFlipY(this._flippedY),e}}),cc.flipY=function(e){return new cc.FlipY(e)},cc.FlipY.create=cc.flipY,cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(e,t){cc.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void 0!==e&&(void 0!==e.x&&(t=e.y,e=e.x),this.initWithPosition(e,t))},initWithPosition:function(e,t){return this._x=e,this._y=t,!0},update:function(e){this.target.setPosition(this._x,this._y)},clone:function(){var e=new cc.Place;return e.initWithPosition(this._x,this._y),e}}),cc.place=function(e,t){return new cc.Place(e,t)},cc.Place.create=cc.place,cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_callFunc:null,_function:null,_data:null,ctor:function(e,t,i){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==e&&(void 0===t?this.initWithFunction(e):this.initWithFunction(e,t,i))},initWithFunction:function(e,t,i){return t?(this._data=i,this._callFunc=e,this._selectorTarget=t):e&&(this._function=e),!0},execute:function(){null!=this._callFunc?this._callFunc.call(this._selectorTarget,this.target,this._data):this._function&&this._function.call(null,this.target)},update:function(e){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(e){e!=this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=e)},clone:function(){var e=new cc.CallFunc;return this._selectorTarget?e.initWithFunction(this._callFunc,this._selectorTarget,this._data):this._function&&e.initWithFunction(this._function),e}}),cc.callFunc=function(e,t,i){return new cc.CallFunc(e,t,i)},cc.CallFunc.create=cc.callFunc,cc.ActionCamera=cc.ActionInterval.extend({_centerXOrig:0,_centerYOrig:0,_centerZOrig:0,_eyeXOrig:0,_eyeYOrig:0,_eyeZOrig:0,_upXOrig:0,_upYOrig:0,_upZOrig:0,ctor:function(){var e=this;cc.ActionInterval.prototype.ctor.call(e),e._centerXOrig=0,e._centerYOrig=0,e._centerZOrig=0,e._eyeXOrig=0,e._eyeYOrig=0,e._eyeZOrig=0,e._upXOrig=0,e._upYOrig=0,e._upZOrig=0},startWithTarget:function(e){var t=this;cc.ActionInterval.prototype.startWithTarget.call(t,e);var i=e.getCamera(),n=i.getCenter();t._centerXOrig=n.x,t._centerYOrig=n.y,t._centerZOrig=n.z;var r=i.getEye();t._eyeXOrig=r.x,t._eyeYOrig=r.y,t._eyeZOrig=r.z;var o=i.getUp();t._upXOrig=o.x,t._upYOrig=o.y,t._upZOrig=o.z},clone:function(){return new cc.ActionCamera},reverse:function(){return new cc.ReverseTime(this)}}),cc.OrbitCamera=cc.ActionCamera.extend({_radius:0,_deltaRadius:0,_angleZ:0,_deltaAngleZ:0,_angleX:0,_deltaAngleX:0,_radZ:0,_radDeltaZ:0,_radX:0,_radDeltaX:0,ctor:function(e,t,i,n,r,o,s){cc.ActionCamera.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,i,n,r,o,s)},initWithDuration:function(e,t,i,n,r,o,s){if(cc.ActionInterval.prototype.initWithDuration.call(this,e)){var a=this;return a._radius=t,a._deltaRadius=i,a._angleZ=n,a._deltaAngleZ=r,a._angleX=o,a._deltaAngleX=s,a._radDeltaZ=cc.degreesToRadians(r),a._radDeltaX=cc.degreesToRadians(s),!0}return!1},sphericalRadius:function(){var e,t,i,n=this.target.getCamera(),r=n.getEye(),o=n.getCenter(),s=r.x-o.x,a=r.y-o.y,c=r.z-o.z,l=Math.sqrt(Math.pow(s,2)+Math.pow(a,2)+Math.pow(c,2)),u=Math.sqrt(Math.pow(s,2)+Math.pow(a,2));return 0===u&&(u=cc.FLT_EPSILON),0===l&&(l=cc.FLT_EPSILON),t=Math.acos(c/l),i=s<0?Math.PI-Math.asin(a/u):Math.asin(a/u),e=l/cc.Camera.getZEye(),{newRadius:e,zenith:t,azimuth:i}},startWithTarget:function(e){var t=this;cc.ActionInterval.prototype.startWithTarget.call(t,e);var i=t.sphericalRadius();isNaN(t._radius)&&(t._radius=i.newRadius),isNaN(t._angleZ)&&(t._angleZ=cc.radiansToDegrees(i.zenith)),isNaN(t._angleX)&&(t._angleX=cc.radiansToDegrees(i.azimuth)),t._radZ=cc.degreesToRadians(t._angleZ),t._radX=cc.degreesToRadians(t._angleX)},clone:function(){var e=new cc.OrbitCamera,t=this;return e.initWithDuration(t._duration,t._radius,t._deltaRadius,t._angleZ,t._deltaAngleZ,t._angleX,t._deltaAngleX),e},update:function(e){e=this._computeEaseTime(e);var t=(this._radius+this._deltaRadius*e)*cc.Camera.getZEye(),i=this._radZ+this._radDeltaZ*e,n=this._radX+this._radDeltaX*e,r=Math.sin(i)*Math.cos(n)*t+this._centerXOrig,o=Math.sin(i)*Math.sin(n)*t+this._centerYOrig,s=Math.cos(i)*t+this._centerZOrig;this.target.getCamera().setEye(r,o,s),this.target.setNodeDirty()}}),cc.orbitCamera=function(e,t,i,n,r,o,s){return new cc.OrbitCamera(e,t,i,n,r,o,s)},cc.OrbitCamera.create=cc.orbitCamera,cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithAction(e)},initWithAction:function(e){if(!e)throw"cc.ActionEase.initWithAction(): action must be non nil";return!!this.initWithDuration(e.getDuration())&&(this._inner=e,!0)},clone:function(){var e=new cc.ActionEase;return e.initWithAction(this._inner.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),cc.ActionInterval.prototype.stop.call(this)},update:function(e){this._inner.update(e)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),cc.actionEase=function(e){return new cc.ActionEase(e)},cc.ActionEase.create=cc.actionEase,cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(e,t){cc.ActionEase.prototype.ctor.call(this),void 0!==t&&this.initWithAction(e,t)},setRate:function(e){this._rate=e},getRate:function(){return this._rate},initWithAction:function(e,t){return!!cc.ActionEase.prototype.initWithAction.call(this,e)&&(this._rate=t,!0)},clone:function(){var e=new cc.EaseRateAction;return e.initWithAction(this._inner.clone(),this._rate),e},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}}),cc.easeRateAction=function(e,t){return new cc.EaseRateAction(e,t)},cc.EaseRateAction.create=cc.easeRateAction,cc.EaseIn=cc.EaseRateAction.extend({update:function(e){this._inner.update(Math.pow(e,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var e=new cc.EaseIn;return e.initWithAction(this._inner.clone(),this._rate),e}}),cc.EaseIn.create=function(e,t){return new cc.EaseIn(e,t)},cc.easeIn=function(e){return{_rate:e,easing:function(e){return Math.pow(e,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.EaseOut=cc.EaseRateAction.extend({update:function(e){this._inner.update(Math.pow(e,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var e=new cc.EaseOut;return e.initWithAction(this._inner.clone(),this._rate),e}}),cc.EaseOut.create=function(e,t){return new cc.EaseOut(e,t)},cc.easeOut=function(e){return{_rate:e,easing:function(e){return Math.pow(e,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.EaseInOut=cc.EaseRateAction.extend({update:function(e){(e*=2)<1?this._inner.update(.5*Math.pow(e,this._rate)):this._inner.update(1-.5*Math.pow(2-e,this._rate))},clone:function(){var e=new cc.EaseInOut;return e.initWithAction(this._inner.clone(),this._rate),e},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}}),cc.EaseInOut.create=function(e,t){return new cc.EaseInOut(e,t)},cc.easeInOut=function(e){return{_rate:e,easing:function(e){return(e*=2)<1?.5*Math.pow(e,this._rate):1-.5*Math.pow(2-e,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}},cc.EaseExponentialIn=cc.ActionEase.extend({update:function(e){this._inner.update(0===e?0:Math.pow(2,10*(e-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var e=new cc.EaseExponentialIn;return e.initWithAction(this._inner.clone()),e}}),cc.EaseExponentialIn.create=function(e){return new cc.EaseExponentialIn(e)},cc._easeExponentialInObj={easing:function(e){return 0===e?0:Math.pow(2,10*(e-1))},reverse:function(){return cc._easeExponentialOutObj}},cc.easeExponentialIn=function(){return cc._easeExponentialInObj},cc.EaseExponentialOut=cc.ActionEase.extend({update:function(e){this._inner.update(1==e?1:1-Math.pow(2,-10*e))},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var e=new cc.EaseExponentialOut;return e.initWithAction(this._inner.clone()),e}}),cc.EaseExponentialOut.create=function(e){return new cc.EaseExponentialOut(e)},cc._easeExponentialOutObj={easing:function(e){return 1==e?1:1-Math.pow(2,-10*e)},reverse:function(){return cc._easeExponentialInObj}},cc.easeExponentialOut=function(){return cc._easeExponentialOutObj},cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(e){1!=e&&0!==e&&(e=(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))),this._inner.update(e)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var e=new cc.EaseExponentialInOut;return e.initWithAction(this._inner.clone()),e}}),cc.EaseExponentialInOut.create=function(e){return new cc.EaseExponentialInOut(e)},cc._easeExponentialInOutObj={easing:function(e){return 1!==e&&0!==e?(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1))):e},reverse:function(){return cc._easeExponentialInOutObj}},cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj},cc.EaseSineIn=cc.ActionEase.extend({update:function(e){e=0===e||1===e?e:-1*Math.cos(e*Math.PI/2)+1,this._inner.update(e)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var e=new cc.EaseSineIn;return e.initWithAction(this._inner.clone()),e}}),cc.EaseSineIn.create=function(e){return new cc.EaseSineIn(e)},cc._easeSineInObj={easing:function(e){return 0===e||1===e?e:-1*Math.cos(e*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}},cc.easeSineIn=function(){return cc._easeSineInObj},cc.EaseSineOut=cc.ActionEase.extend({update:function(e){e=0===e||1===e?e:Math.sin(e*Math.PI/2),this._inner.update(e)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var e=new cc.EaseSineOut;return e.initWithAction(this._inner.clone()),e}}),cc.EaseSineOut.create=function(e){return new cc.EaseSineOut(e)},cc._easeSineOutObj={easing:function(e){return 0===e||1==e?e:Math.sin(e*Math.PI/2)},reverse:function(){return cc._easeSineInObj}},cc.easeSineOut=function(){return cc._easeSineOutObj},cc.EaseSineInOut=cc.ActionEase.extend({update:function(e){e=0===e||1===e?e:-.5*(Math.cos(Math.PI*e)-1),this._inner.update(e)},clone:function(){var e=new cc.EaseSineInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}}),cc.EaseSineInOut.create=function(e){return new cc.EaseSineInOut(e)},cc._easeSineInOutObj={easing:function(e){return 0===e||1===e?e:-.5*(Math.cos(Math.PI*e)-1)},reverse:function(){return cc._easeSineInOutObj}},cc.easeSineInOut=function(){return cc._easeSineInOutObj},cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(e,t){cc.ActionEase.prototype.ctor.call(this),e&&this.initWithAction(e,t)},getPeriod:function(){return this._period},setPeriod:function(e){this._period=e},initWithAction:function(e,t){return cc.ActionEase.prototype.initWithAction.call(this,e),this._period=null==t?.3:t,!0},reverse:function(){return cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass."),null},clone:function(){var e=new cc.EaseElastic;return e.initWithAction(this._inner.clone(),this._period),e}}),cc.EaseElastic.create=function(e,t){return new cc.EaseElastic(e,t)},cc.EaseElasticIn=cc.EaseElastic.extend({update:function(e){var t=0;if(0===e||1===e)t=e;else{var i=this._period/4;e-=1,t=-Math.pow(2,10*e)*Math.sin((e-i)*Math.PI*2/this._period)}this._inner.update(t)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var e=new cc.EaseElasticIn;return e.initWithAction(this._inner.clone(),this._period),e}}),cc.EaseElasticIn.create=function(e,t){return new cc.EaseElasticIn(e,t)},cc._easeElasticInObj={easing:function(e){return 0===e||1===e?e:(e-=1,-Math.pow(2,10*e)*Math.sin((e-.075)*Math.PI*2/.3))},reverse:function(){return cc._easeElasticOutObj}},cc.easeElasticIn=function(e){return e&&.3!==e?{_period:e,easing:function(e){return 0===e||1===e?e:(e-=1,-Math.pow(2,10*e)*Math.sin((e-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj},cc.EaseElasticOut=cc.EaseElastic.extend({update:function(e){var t=0;if(0===e||1==e)t=e;else{var i=this._period/4;t=Math.pow(2,-10*e)*Math.sin((e-i)*Math.PI*2/this._period)+1}this._inner.update(t)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var e=new cc.EaseElasticOut;return e.initWithAction(this._inner.clone(),this._period),e}}),cc.EaseElasticOut.create=function(e,t){return new cc.EaseElasticOut(e,t)},cc._easeElasticOutObj={easing:function(e){return 0===e||1===e?e:Math.pow(2,-10*e)*Math.sin((e-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}},cc.easeElasticOut=function(e){return e&&.3!==e?{_period:e,easing:function(e){return 0===e||1===e?e:Math.pow(2,-10*e)*Math.sin((e-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj},cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(e){var t=0,i=this._period;if(0===e||1==e)t=e;else{e*=2,i||(i=this._period=.3*1.5);var n=i/4;t=(e-=1)<0?-.5*Math.pow(2,10*e)*Math.sin((e-n)*Math.PI*2/i):Math.pow(2,-10*e)*Math.sin((e-n)*Math.PI*2/i)*.5+1}this._inner.update(t)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var e=new cc.EaseElasticInOut;return e.initWithAction(this._inner.clone(),this._period),e}}),cc.EaseElasticInOut.create=function(e,t){return new cc.EaseElasticInOut(e,t)},cc.easeElasticInOut=function(e){return e=e||.3,{_period:e,easing:function(e){var t=0,i=this._period;if(0===e||1===e)t=e;else{e*=2,i||(i=this._period=.3*1.5);var n=i/4;t=(e-=1)<0?-.5*Math.pow(2,10*e)*Math.sin((e-n)*Math.PI*2/i):Math.pow(2,-10*e)*Math.sin((e-n)*Math.PI*2/i)*.5+1}return t},reverse:function(){return cc.easeElasticInOut(this._period)}}},cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},clone:function(){var e=new cc.EaseBounce;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}}),cc.EaseBounce.create=function(e){return new cc.EaseBounce(e)},cc.EaseBounceIn=cc.EaseBounce.extend({update:function(e){var t=1-this.bounceTime(1-e);this._inner.update(t)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var e=new cc.EaseBounceIn;return e.initWithAction(this._inner.clone()),e}}),cc.EaseBounceIn.create=function(e){return new cc.EaseBounceIn(e)},cc._bounceTime=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},cc._easeBounceInObj={easing:function(e){return 1-cc._bounceTime(1-e)},reverse:function(){return cc._easeBounceOutObj}},cc.easeBounceIn=function(){return cc._easeBounceInObj},cc.EaseBounceOut=cc.EaseBounce.extend({update:function(e){var t=this.bounceTime(e);this._inner.update(t)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var e=new cc.EaseBounceOut;return e.initWithAction(this._inner.clone()),e}}),cc.EaseBounceOut.create=function(e){return new cc.EaseBounceOut(e)},cc._easeBounceOutObj={easing:function(e){return cc._bounceTime(e)},reverse:function(){return cc._easeBounceInObj}},cc.easeBounceOut=function(){return cc._easeBounceOutObj},cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(e){var t=0;e<.5?(e*=2,t=.5*(1-this.bounceTime(1-e))):t=.5*this.bounceTime(2*e-1)+.5,this._inner.update(t)},clone:function(){var e=new cc.EaseBounceInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}}),cc.EaseBounceInOut.create=function(e){return new cc.EaseBounceInOut(e)},cc._easeBounceInOutObj={easing:function(e){var t;return e<.5?(e*=2,t=.5*(1-cc._bounceTime(1-e))):t=.5*cc._bounceTime(2*e-1)+.5,t},reverse:function(){return cc._easeBounceInOutObj}},cc.easeBounceInOut=function(){return cc._easeBounceInOutObj},cc.EaseBackIn=cc.ActionEase.extend({update:function(e){e=0===e||1==e?e:e*e*(2.70158*e-1.70158),this._inner.update(e)},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var e=new cc.EaseBackIn;return e.initWithAction(this._inner.clone()),e}}),cc.EaseBackIn.create=function(e){return new cc.EaseBackIn(e)},cc._easeBackInObj={easing:function(e){return 0===e||1===e?e:e*e*(2.70158*e-1.70158)},reverse:function(){return cc._easeBackOutObj}},cc.easeBackIn=function(){return cc._easeBackInObj},cc.EaseBackOut=cc.ActionEase.extend({update:function(e){e-=1,this._inner.update(e*e*(2.70158*e+1.70158)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var e=new cc.EaseBackOut;return e.initWithAction(this._inner.clone()),e}}),cc.EaseBackOut.create=function(e){return new cc.EaseBackOut(e)},cc._easeBackOutObj={easing:function(e){return(e-=1)*e*(2.70158*e+1.70158)+1},reverse:function(){return cc._easeBackInObj}},cc.easeBackOut=function(){return cc._easeBackOutObj},cc.EaseBackInOut=cc.ActionEase.extend({update:function(e){(e*=2)<1?this._inner.update(e*e*(3.5949095*e-2.5949095)/2):(e-=2,this._inner.update(e*e*(3.5949095*e+2.5949095)/2+1))},clone:function(){var e=new cc.EaseBackInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}}),cc.EaseBackInOut.create=function(e){return new cc.EaseBackInOut(e)},cc._easeBackInOutObj={easing:function(e){return(e*=2)<1?e*e*(3.5949095*e-2.5949095)/2:(e-=2)*e*(3.5949095*e+2.5949095)/2+1},reverse:function(){return cc._easeBackInOutObj}},cc.easeBackInOut=function(){return cc._easeBackInOutObj},cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(e){cc.ActionEase.prototype.ctor.call(this,e)},_updateTime:function(e,t,i,n,r){return Math.pow(1-r,3)*e+3*r*Math.pow(1-r,2)*t+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},update:function(e){var t=this._updateTime(this._p0,this._p1,this._p2,this._p3,e);this._inner.update(t)},clone:function(){var e=new cc.EaseBezierAction;return e.initWithAction(this._inner.clone()),e.setBezierParamer(this._p0,this._p1,this._p2,this._p3),e},reverse:function(){var e=new cc.EaseBezierAction(this._inner.reverse());return e.setBezierParamer(this._p3,this._p2,this._p1,this._p0),e},setBezierParamer:function(e,t,i,n){this._p0=e||0,this._p1=t||0,this._p2=i||0,this._p3=n||0}}),cc.EaseBezierAction.create=function(e){return new cc.EaseBezierAction(e)},cc.easeBezierAction=function(e,t,i,n){return{easing:function(r){return cc.EaseBezierAction.prototype._updateTime(e,t,i,n,r)},reverse:function(){return cc.easeBezierAction(n,i,t,e)}}},cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(e){return Math.pow(e,2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuadraticActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}}),cc.EaseQuadraticActionIn.create=function(e){return new cc.EaseQuadraticActionIn(e)},cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}},cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn},cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(e){return-e*(e-2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuadraticActionOut;return e.initWithAction(),e},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}}),cc.EaseQuadraticActionOut.create=function(e){return new cc.EaseQuadraticActionOut(e)},cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}},cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut},cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(e){return e*=2,e<1?e*e*.5:-.5*(--e*(e-2)-1)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuadraticActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}}),cc.EaseQuadraticActionInOut.create=function(e){return new cc.EaseQuadraticActionInOut(e)},cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}},cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut},cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(e){return e*e*e*e},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuarticActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}}),cc.EaseQuarticActionIn.create=function(e){return new cc.EaseQuarticActionIn(e)},cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}},cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn},cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(e){return-((e-=1)*e*e*e-1)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuarticActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}}),cc.EaseQuarticActionOut.create=function(e){return new cc.EaseQuarticActionOut(e)},cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}},cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut},cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuarticActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}}),cc.EaseQuarticActionInOut.create=function(e){return new cc.EaseQuarticActionInOut(e)},cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}},cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut},cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(e){return e*e*e*e*e},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuinticActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}}),cc.EaseQuinticActionIn.create=function(e){return new cc.EaseQuinticActionIn(e)},cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}},cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn},cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(e){return(e-=1)*e*e*e*e+1},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuinticActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}}),cc.EaseQuinticActionOut.create=function(e){return new cc.EaseQuinticActionOut(e)},cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}},cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut},cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseQuinticActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}}),cc.EaseQuinticActionInOut.create=function(e){return new cc.EaseQuinticActionInOut(e)},cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}},cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut},cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(e){return-1*(Math.sqrt(1-e*e)-1)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseCircleActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}}),cc.EaseCircleActionIn.create=function(e){return new cc.EaseCircleActionIn(e)},cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}},cc.easeCircleActionIn=function(){return cc._easeCircleActionIn},cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(e){return e-=1,Math.sqrt(1-e*e)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseCircleActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}}),cc.EaseCircleActionOut.create=function(e){return new cc.EaseCircleActionOut(e)},cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}},cc.easeCircleActionOut=function(){return cc._easeCircleActionOut},cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):(e-=2,.5*(Math.sqrt(1-e*e)+1))},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseCircleActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}}),cc.EaseCircleActionInOut.create=function(e){return new cc.EaseCircleActionInOut(e)},cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}},cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut},cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(e){return e*e*e},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseCubicActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}}),cc.EaseCubicActionIn.create=function(e){return new cc.EaseCubicActionIn(e)},cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}},cc.easeCubicActionIn=function(){return cc._easeCubicActionIn},cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(e){return(e-=1)*e*e+1},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseCubicActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}}),cc.EaseCubicActionOut.create=function(e){return new cc.EaseCubicActionOut(e)},cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}},cc.easeCubicActionOut=function(){return cc._easeCubicActionOut},cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new cc.EaseCubicActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}}),cc.EaseCubicActionInOut.create=function(e){return new cc.EaseCubicActionInOut(e)},cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}},cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut},cc.cardinalSplineAt=function(e,t,i,n,r,o){var s=o*o,a=s*o,c=(1-r)/2,l=c*(2*s-a-o),u=c*(-a+s)+(2*a-3*s+1),h=c*(a-2*s+o)+(-2*a+3*s),d=c*(a-s),p=e.x*l+t.x*u+i.x*h+n.x*d,_=e.y*l+t.y*u+i.y*h+n.y*d;return cc.p(p,_)},cc.reverseControlPoints=function(e){for(var t=[],i=e.length-1;i>=0;i--)t.push(cc.p(e[i].x,e[i].y));return t},cc.cloneControlPoints=function(e){for(var t=[],i=0;i<e.length;i++)t.push(cc.p(e[i].x,e[i].y));return t},cc.copyControlPoints=cc.cloneControlPoints,cc.getControlPointAt=function(e,t){return e[Math.min(e.length-1,Math.max(t,0))]},cc.reverseControlPointsInline=function(e){for(var t=e.length,i=0|t/2,n=0;n<i;++n){var r=e[n];e[n]=e[t-n-1],e[t-n-1]=r}},cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(e,t,i){cc.ActionInterval.prototype.ctor.call(this),this._points=[],void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){if(!t||0==t.length)throw"Invalid configuration. It must at least have one control point";return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this.setPoints(t),this._tension=i,!0)},clone:function(){var e=new cc.CardinalSplineTo;return e.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=cc.p(0,0)},update:function(e){e=this._computeEaseTime(e);var t,i,n=this._points;if(1==e)t=n.length-1,i=1;else{var r=this._deltaT;i=(e-r*(t=0|e/r))/r}var o=cc.cardinalSplineAt(cc.getControlPointAt(n,t-1),cc.getControlPointAt(n,t-0),cc.getControlPointAt(n,t+1),cc.getControlPointAt(n,t+2),this._tension,i);if(cc.ENABLE_STACKABLE_ACTIONS){var s,a;if(s=this.target.getPositionX()-this._previousPosition.x,a=this.target.getPositionY()-this._previousPosition.y,0!=s||0!=a){var c=this._accumulatedDiff;s=c.x+s,a=c.y+a,c.x=s,c.y=a,o.x+=s,o.y+=a}}this.updatePosition(o)},reverse:function(){var e=cc.reverseControlPoints(this._points);return cc.cardinalSplineTo(this._duration,e,this._tension)},updatePosition:function(e){this.target.setPosition(e),this._previousPosition=e},getPoints:function(){return this._points},setPoints:function(e){this._points=e}}),cc.cardinalSplineTo=function(e,t,i){return new cc.CardinalSplineTo(e,t,i)},cc.CardinalSplineTo.create=cc.cardinalSplineTo,cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(e,t,i){cc.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=cc.p(0,0),void 0!==i&&this.initWithDuration(e,t,i)},startWithTarget:function(e){cc.CardinalSplineTo.prototype.startWithTarget.call(this,e),this._startPosition.x=e.getPositionX(),this._startPosition.y=e.getPositionY()},reverse:function(){for(var e,t=this._points.slice(),i=t[0],n=1;n<t.length;++n)e=t[n],t[n]=cc.pSub(e,i),i=e;var r=cc.reverseControlPoints(t);i=r[r.length-1],r.pop(),i.x=-i.x,i.y=-i.y,r.unshift(i);for(n=1;n<r.length;++n)(e=r[n]).x=-e.x,e.y=-e.y,e.x+=i.x,e.y+=i.y,r[n]=e,i=e;return cc.cardinalSplineBy(this._duration,r,this._tension)},updatePosition:function(e){var t=this._startPosition,i=e.x+t.x,n=e.y+t.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var e=new cc.CardinalSplineBy;return e.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),e}}),cc.cardinalSplineBy=function(e,t,i){return new cc.CardinalSplineBy(e,t,i)},cc.CardinalSplineBy.create=cc.cardinalSplineBy,cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(e,t){t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,e,t,.5)},clone:function(){var e=new cc.CatmullRomTo;return e.initWithDuration(this._duration,cc.copyControlPoints(this._points)),e}}),cc.catmullRomTo=function(e,t){return new cc.CatmullRomTo(e,t)},cc.CatmullRomTo.create=cc.catmullRomTo,cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(e,t){cc.CardinalSplineBy.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,e,t,.5)},clone:function(){var e=new cc.CatmullRomBy;return e.initWithDuration(this._duration,cc.copyControlPoints(this._points)),e}}),cc.catmullRomBy=function(e,t){return new cc.CatmullRomBy(e,t)},cc.CatmullRomBy.create=cc.catmullRomBy,cc.ActionTweenDelegate=cc.Class.extend({updateTweenAction:function(e,t){}}),cc.ActionTween=cc.ActionInterval.extend({key:"",from:0,to:0,delta:0,ctor:function(e,t,i,n){cc.ActionInterval.prototype.ctor.call(this),this.key="",void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this.key=t,this.to=n,this.from=i,!0)},startWithTarget:function(e){if(!e||!e.updateTweenAction)throw"cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function";cc.ActionInterval.prototype.startWithTarget.call(this,e),this.delta=this.to-this.from},update:function(e){this.target.updateTweenAction(this.to-this.delta*(1-e),this.key)},reverse:function(){return new cc.ActionTween(this.duration,this.key,this.to,this.from)},clone:function(){var e=new cc.ActionTween;return e.initWithDuration(this._duration,this.key,this.from,this.to),e}}),cc.actionTween=function(e,t,i,n){return new cc.ActionTween(e,t,i,n)},cc.ActionTween.create=cc.actionTween,cc.GridAction=cc.ActionInterval.extend({_gridSize:null,ctor:function(e,t){cc._checkWebGLRenderMode(),cc.ActionInterval.prototype.ctor.call(this),this._gridSize=cc.size(0,0),t&&this.initWithDuration(e,t)},clone:function(){var e=new cc.GridAction,t=this._gridSize;return e.initWithDuration(this._duration,cc.size(t.width,t.height)),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),cc.renderer.childrenOrderDirty=!0;var t=this.getGrid(),i=this.target,n=i.grid;if(n&&n.getReuseGrid()>0){var r=n.getGridSize();n.isActive()&&r.width==this._gridSize.width&&r.height==this._gridSize.height&&n.reuse()}else n&&n.isActive()&&n.setActive(!1),i.grid=t,i.grid.setActive(!0)},reverse:function(){return new cc.ReverseTime(this)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._gridSize.width=t.width,this._gridSize.height=t.height,!0)},getGrid:function(){cc.log("cc.GridAction.getGrid(): it should be overridden in subclass.")}}),cc.gridAction=function(e,t){return new cc.GridAction(e,t)},cc.GridAction.create=cc.gridAction,cc.Grid3DAction=cc.GridAction.extend({getGrid:function(){return new cc.Grid3D(this._gridSize)},vertex:function(e){return this.target.grid.vertex(e)},originalVertex:function(e){return this.target.grid.originalVertex(e)},setVertex:function(e,t){this.target.grid.setVertex(e,t)}}),cc.grid3DAction=function(e,t){return new cc.Grid3DAction(e,t)},cc.Grid3DAction.create=cc.grid3DAction,cc.TiledGrid3DAction=cc.GridAction.extend({tile:function(e){return this.target.grid.tile(e)},originalTile:function(e){return this.target.grid.originalTile(e)},setTile:function(e,t){this.target.grid.setTile(e,t)},getGrid:function(){return new cc.TiledGrid3D(this._gridSize)}}),cc.tiledGrid3DAction=function(e,t){return new cc.TiledGrid3DAction(e,t)},cc.TiledGrid3DAction.create=cc.tiledGrid3DAction,cc.StopGrid=cc.ActionInstant.extend({startWithTarget:function(e){cc.ActionInstant.prototype.startWithTarget.call(this,e),cc.renderer.childrenOrderDirty=!0;var t=this.target.grid;t&&t.isActive()&&t.setActive(!1)}}),cc.stopGrid=function(){return new cc.StopGrid},cc.StopGrid.create=cc.stopGrid,cc.ReuseGrid=cc.ActionInstant.extend({_times:null,ctor:function(e){cc.ActionInstant.prototype.ctor.call(this),void 0!==e&&this.initWithTimes(e)},initWithTimes:function(e){return this._times=e,!0},startWithTarget:function(e){cc.ActionInstant.prototype.startWithTarget.call(this,e),cc.renderer.childrenOrderDirty=!0,this.target.grid&&this.target.grid.isActive()&&this.target.grid.setReuseGrid(this.target.grid.getReuseGrid()+this._times)}}),cc.reuseGrid=function(e){return new cc.ReuseGrid(e)},cc.ReuseGrid.create=cc.reuseGrid,cc.Waves3D=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t=this._gridSize,i=this._amplitude,n=cc.p(0,0),r=this._amplitudeRate,o=this._waves,s=0;s<t.width+1;++s)for(var a=0;a<t.height+1;++a){n.x=s,n.y=a;var c=this.originalVertex(n);c.z+=Math.sin(Math.PI*e*o*2+.01*(c.y+c.x))*i*r,this.setVertex(n,c)}}}),cc.waves3D=function(e,t,i,n){return new cc.Waves3D(e,t,i,n)},cc.Waves3D.create=cc.waves3D,cc.FlipX3D=cc.Grid3DAction.extend({ctor:function(e){void 0!==e?cc.GridAction.prototype.ctor.call(this,e,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},initWithDuration:function(e){return cc.Grid3DAction.prototype.initWithDuration.call(this,e,cc.size(1,1))},initWithSize:function(e,t){return 1!=e.width||1!=e.height?(cc.log("Grid size must be (1,1)"),!1):cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)},update:function(e){var t=Math.PI*e,i=Math.sin(t);t/=2;var n=Math.cos(t),r=new cc.Vertex3F,o=cc.p(0,0);o.x=o.y=1;var s=this.originalVertex(o);o.x=o.y=0;var a,c,l,u,h,d=this.originalVertex(o),p=s.x,_=d.x;p>_?(c=cc.p(0,0),l=cc.p(0,1),u=cc.p(1,0),h=cc.p(1,1),a=p):(u=cc.p(0,0),h=cc.p(0,1),c=cc.p(1,0),l=cc.p(1,1),a=_),r.x=a-a*n,r.z=Math.abs(parseFloat(a*i/4));var f=this.originalVertex(c);f.x=r.x,f.z+=r.z,this.setVertex(c,f),(f=this.originalVertex(l)).x=r.x,f.z+=r.z,this.setVertex(l,f),(f=this.originalVertex(u)).x-=r.x,f.z-=r.z,this.setVertex(u,f),(f=this.originalVertex(h)).x-=r.x,f.z-=r.z,this.setVertex(h,f)}}),cc.flipX3D=function(e){return new cc.FlipX3D(e)},cc.FlipX3D.create=cc.flipX3D,cc.FlipY3D=cc.FlipX3D.extend({ctor:function(e){void 0!==e?cc.GridAction.prototype.ctor.call(this,e,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},update:function(e){var t=Math.PI*e,i=Math.sin(t);t/=2;var n=Math.cos(t),r=new cc.Vertex3F,o=cc.p(0,0);o.x=o.y=1;var s=this.originalVertex(o);o.x=o.y=0;var a,c,l,u,h,d=this.originalVertex(o),p=s.y,_=d.y;p>_?(c=cc.p(0,0),l=cc.p(0,1),u=cc.p(1,0),h=cc.p(1,1),a=p):(l=cc.p(0,0),c=cc.p(0,1),h=cc.p(1,0),u=cc.p(1,1),a=_),r.y=a-a*n,r.z=Math.abs(parseFloat(a*i)/4);var f=this.originalVertex(c);f.y=r.y,f.z+=r.z,this.setVertex(c,f),(f=this.originalVertex(l)).y-=r.y,f.z-=r.z,this.setVertex(l,f),(f=this.originalVertex(u)).y=r.y,f.z+=r.z,this.setVertex(u,f),(f=this.originalVertex(h)).y-=r.y,f.z-=r.z,this.setVertex(h,f)}}),cc.flipY3D=function(e){return new cc.FlipY3D(e)},cc.FlipY3D.create=cc.flipY3D,cc.Lens3D=cc.Grid3DAction.extend({_position:null,_radius:0,_lensEffect:0,_concave:!1,_dirty:!1,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==n&&this.initWithDuration(e,t,i,n)},getLensEffect:function(){return this._lensEffect},setLensEffect:function(e){this._lensEffect=e},setConcave:function(e){this._concave=e},getPosition:function(){return this._position},setPosition:function(e){cc.pointEqualToPoint(e,this._position)||(this._position.x=e.x,this._position.y=e.y,this._dirty=!0)},initWithDuration:function(e,t,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(i),this._radius=n,this._lensEffect=.7,this._dirty=!0,!0)},update:function(e){if(this._dirty){for(var t,i,n,r,o,s=this._gridSize.width,a=this._gridSize.height,c=this._radius,l=this._lensEffect,u=cc.p(0,0),h=cc.p(0,0),d=0;d<s+1;++d)for(var p=0;p<a+1;++p)u.x=d,u.y=p,t=this.originalVertex(u),h.x=this._position.x-t.x,h.y=this._position.y-t.y,(i=cc.pLength(h))<c&&(0==(o=(i=c-i)/c)&&(o=.001),n=Math.log(o)*l,r=Math.exp(n)*c,(i=cc.pLength(h))>0&&(h.x=h.x/i,h.y=h.y/i,h.x=h.x*r,h.y=h.y*r,t.z+=cc.pLength(h)*l)),this.setVertex(u,t);this._dirty=!1}}}),cc.lens3D=function(e,t,i,n){return new cc.Lens3D(e,t,i,n)},cc.Lens3D.create=cc.lens3D,cc.Ripple3D=cc.Grid3DAction.extend({_position:null,_radius:0,_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n,r,o){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==o&&this.initWithDuration(e,t,i,n,r,o)},getPosition:function(){return this._position},setPosition:function(e){this._position.x=e.x,this._position.y=e.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n,r,o){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(i),this._radius=n,this._waves=r,this._amplitude=o,this._amplitudeRate=1,!0)},update:function(e){for(var t,i,n=this._gridSize.width,r=this._gridSize.height,o=cc.p(0,0),s=this._radius,a=this._waves,c=this._amplitude,l=this._amplitudeRate,u=cc.p(0,0),h=0;h<n+1;++h)for(var d=0;d<r+1;++d){if(o.x=h,o.y=d,t=this.originalVertex(o),u.x=this._position.x-t.x,u.y=this._position.y-t.y,(i=cc.pLength(u))<s){i=s-i;var p=Math.pow(i/s,2);t.z+=Math.sin(e*Math.PI*a*2+.1*i)*c*l*p}this.setVertex(o,t)}}}),cc.ripple3D=function(e,t,i,n,r,o){return new cc.Ripple3D(e,t,i,n,r,o)},cc.Ripple3D.create=cc.ripple3D,cc.Shaky3D=cc.Grid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(e){for(var t,i=this._gridSize.width,n=this._gridSize.height,r=this._randRange,o=this._shakeZ,s=cc.p(0,0),a=0;a<i+1;++a)for(var c=0;c<n+1;++c)s.x=a,s.y=c,(t=this.originalVertex(s)).x+=cc.rand()%(2*r)-r,t.y+=cc.rand()%(2*r)-r,o&&(t.z+=cc.rand()%(2*r)-r),this.setVertex(s,t)}}),cc.shaky3D=function(e,t,i,n){return new cc.Shaky3D(e,t,i,n)},cc.Shaky3D.create=cc.shaky3D,cc.Liquid=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t,i=this._gridSize.width,n=this._gridSize.height,r=cc.p(0,0),o=this._waves,s=this._amplitude,a=this._amplitudeRate,c=1;c<i;++c)for(var l=1;l<n;++l)r.x=c,r.y=l,(t=this.originalVertex(r)).x=t.x+Math.sin(e*Math.PI*o*2+.01*t.x)*s*a,t.y=t.y+Math.sin(e*Math.PI*o*2+.01*t.y)*s*a,this.setVertex(r,t)}}),cc.liquid=function(e,t,i,n){return new cc.Liquid(e,t,i,n)},cc.Liquid.create=cc.liquid,cc.Waves=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,_vertical:!1,_horizontal:!1,ctor:function(e,t,i,n,r,o){cc.GridAction.prototype.ctor.call(this),void 0!==o&&this.initWithDuration(e,t,i,n,r,o)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n,r,o){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,this._horizontal=r,this._vertical=o,!0)},update:function(e){for(var t,i=this._gridSize.width,n=this._gridSize.height,r=cc.p(0,0),o=this._vertical,s=this._horizontal,a=this._waves,c=this._amplitude,l=this._amplitudeRate,u=0;u<i+1;++u)for(var h=0;h<n+1;++h)r.x=u,r.y=h,t=this.originalVertex(r),o&&(t.x=t.x+Math.sin(e*Math.PI*a*2+.01*t.y)*c*l),s&&(t.y=t.y+Math.sin(e*Math.PI*a*2+.01*t.x)*c*l),this.setVertex(r,t)}}),cc.waves=function(e,t,i,n,r,o){return new cc.Waves(e,t,i,n,r,o)},cc.Waves.create=cc.waves,cc.Twirl=cc.Grid3DAction.extend({_position:null,_twirls:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n,r){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==r&&this.initWithDuration(e,t,i,n,r)},getPosition:function(){return this._position},setPosition:function(e){this._position.x=e.x,this._position.y=e.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n,r){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(i),this._twirls=n,this._amplitude=r,this._amplitudeRate=1,!0)},update:function(e){for(var t,i,n,r,o=this._position,s=this._gridSize.width,a=this._gridSize.height,c=cc.p(0,0),l=.1*this._amplitude*this._amplitudeRate,u=this._twirls,h=cc.p(0,0),d=0;d<s+1;++d)for(var p=0;p<a+1;++p)c.x=d,c.y=p,t=this.originalVertex(c),h.x=d-s/2,h.y=p-a/2,i=cc.pLength(h)*Math.cos(Math.PI/2+e*Math.PI*u*2)*l,n=Math.sin(i)*(t.y-o.y)+Math.cos(i)*(t.x-o.x),r=Math.cos(i)*(t.y-o.y)-Math.sin(i)*(t.x-o.x),t.x=o.x+n,t.y=o.y+r,this.setVertex(c,t)}}),cc.twirl=function(e,t,i,n,r){return new cc.Twirl(e,t,i,n,r)},cc.Twirl.create=cc.twirl,cc.ShakyTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(e){for(var t=this._gridSize,i=this._randRange,n=cc.p(0,0),r=0;r<t.width;++r)for(var o=0;o<t.height;++o){n.x=r,n.y=o;var s=this.originalTile(n);s.bl.x+=cc.rand()%(2*i)-i,s.br.x+=cc.rand()%(2*i)-i,s.tl.x+=cc.rand()%(2*i)-i,s.tr.x+=cc.rand()%(2*i)-i,s.bl.y+=cc.rand()%(2*i)-i,s.br.y+=cc.rand()%(2*i)-i,s.tl.y+=cc.rand()%(2*i)-i,s.tr.y+=cc.rand()%(2*i)-i,this._shakeZ&&(s.bl.z+=cc.rand()%(2*i)-i,s.br.z+=cc.rand()%(2*i)-i,s.tl.z+=cc.rand()%(2*i)-i,s.tr.z+=cc.rand()%(2*i)-i),this.setTile(n,s)}}}),cc.shakyTiles3D=function(e,t,i,n){return new cc.ShakyTiles3D(e,t,i,n)},cc.ShakyTiles3D.create=cc.shakyTiles3D,cc.ShatteredTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_once:!1,_shatterZ:!1,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._once=!1,this._randRange=i,this._shatterZ=n,!0)},update:function(e){if(!1===this._once){for(var t,i=this._gridSize,n=this._randRange,r=cc.p(0,0),o=0;o<i.width;++o)for(var s=0;s<i.height;++s)r.x=o,r.y=s,(t=this.originalTile(r)).bl.x+=cc.rand()%(2*n)-n,t.br.x+=cc.rand()%(2*n)-n,t.tl.x+=cc.rand()%(2*n)-n,t.tr.x+=cc.rand()%(2*n)-n,t.bl.y+=cc.rand()%(2*n)-n,t.br.y+=cc.rand()%(2*n)-n,t.tl.y+=cc.rand()%(2*n)-n,t.tr.y+=cc.rand()%(2*n)-n,this._shatterZ&&(t.bl.z+=cc.rand()%(2*n)-n,t.br.z+=cc.rand()%(2*n)-n,t.tl.z+=cc.rand()%(2*n)-n,t.tr.z+=cc.rand()%(2*n)-n),this.setTile(r,t);this._once=!0}}}),cc.shatteredTiles3D=function(e,t,i,n){return new cc.ShatteredTiles3D(e,t,i,n)},cc.ShatteredTiles3D.create=cc.shatteredTiles3D,cc.Tile=function(e,t,i){this.position=e||cc.p(0,0),this.startPosition=t||cc.p(0,0),this.delta=i||cc.p(0,0)},cc.ShuffleTiles=cc.TiledGrid3DAction.extend({_seed:0,_tilesCount:0,_tilesOrder:null,_tiles:null,ctor:function(e,t,i){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],this._tiles=[],void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._seed=i,this._tilesOrder.length=0,this._tiles.length=0,!0)},shuffle:function(e,t){for(var i=t-1;i>=0;i--){var n=0|cc.rand()%(i+1),r=e[i];e[i]=e[n],e[n]=r}},getDelta:function(e){var t=this._gridSize,i=e.width*t.height+e.height;return cc.size(this._tilesOrder[i]/t.height-e.width,this._tilesOrder[i]%t.height-e.height)},placeTile:function(e,t){var i=this.originalTile(e),n=this.target.grid.getStep(),r=t.position;i.bl.x+=r.x*n.x,i.bl.y+=r.y*n.y,i.br.x+=r.x*n.x,i.br.y+=r.y*n.y,i.tl.x+=r.x*n.x,i.tl.y+=r.y*n.y,i.tr.x+=r.x*n.x,i.tr.y+=r.y*n.y,this.setTile(e,i)},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e);var t=this._gridSize;this._tilesCount=t.width*t.height;var i=this._tilesOrder;i.length=0;for(var n=0;n<this._tilesCount;++n)i[n]=n;this.shuffle(i,this._tilesCount);var r=this._tiles;r.length=0;for(var o=0,s=cc.size(0,0),a=0;a<t.width;++a)for(var c=0;c<t.height;++c)r[o]=new cc.Tile,r[o].position=cc.p(a,c),r[o].startPosition=cc.p(a,c),s.width=a,s.height=c,r[o].delta=this.getDelta(s),++o},update:function(e){for(var t,i=0,n=this._gridSize,r=this._tiles,o=cc.p(0,0),s=0;s<n.width;++s)for(var a=0;a<n.height;++a)o.x=s,o.y=a,(t=r[i]).position.x=t.delta.width*e,t.position.y=t.delta.height*e,this.placeTile(o,t),++i}}),cc.shuffleTiles=function(e,t,i){return new cc.ShuffleTiles(e,t,i)},cc.ShuffleTiles.create=cc.shuffleTiles,cc.FadeOutTRTiles=cc.TiledGrid3DAction.extend({testFunc:function(e,t){var i=this._gridSize.width*t,n=this._gridSize.height*t;return i+n==0?1:Math.pow((e.width+e.height)/(i+n),6)},turnOnTile:function(e){this.setTile(e,this.originalTile(e))},turnOffTile:function(e){this.setTile(e,new cc.Quad3)},transformTile:function(e,t){var i=this.originalTile(e),n=this.target.grid.getStep();i.bl.x+=n.x/2*(1-t),i.bl.y+=n.y/2*(1-t),i.br.x-=n.x/2*(1-t),i.br.y+=n.y/2*(1-t),i.tl.x+=n.x/2*(1-t),i.tl.y-=n.y/2*(1-t),i.tr.x-=n.x/2*(1-t),i.tr.y-=n.y/2*(1-t),this.setTile(e,i)},update:function(e){for(var t,i=this._gridSize,n=cc.p(0,0),r=cc.size(0,0),o=0;o<i.width;++o)for(var s=0;s<i.height;++s)n.x=o,n.y=s,r.width=o,r.height=s,0==(t=this.testFunc(r,e))?this.turnOffTile(n):t<1?this.transformTile(n,t):this.turnOnTile(n)}}),cc.fadeOutTRTiles=function(e,t){return new cc.FadeOutTRTiles(e,t)},cc.FadeOutTRTiles.create=cc.fadeOutTRTiles,cc.FadeOutBLTiles=cc.FadeOutTRTiles.extend({testFunc:function(e,t){var i=this._gridSize.width*(1-t),n=this._gridSize.height*(1-t);return e.width+e.height==0?1:Math.pow((i+n)/(e.width+e.height),6)}}),cc.fadeOutBLTiles=function(e,t){return new cc.FadeOutBLTiles(e,t)},cc.FadeOutBLTiles.create=cc.fadeOutBLTiles,cc.FadeOutUpTiles=cc.FadeOutTRTiles.extend({testFunc:function(e,t){var i=this._gridSize.height*t;return 0==i?1:Math.pow(e.height/i,6)},transformTile:function(e,t){var i=this.originalTile(e),n=this.target.grid.getStep();i.bl.y+=n.y/2*(1-t),i.br.y+=n.y/2*(1-t),i.tl.y-=n.y/2*(1-t),i.tr.y-=n.y/2*(1-t),this.setTile(e,i)}}),cc.fadeOutUpTiles=function(e,t){return new cc.FadeOutUpTiles(e,t)},cc.FadeOutUpTiles.create=cc.fadeOutUpTiles,cc.FadeOutDownTiles=cc.FadeOutUpTiles.extend({testFunc:function(e,t){var i=this._gridSize.height*(1-t);return 0==e.height?1:Math.pow(i/e.height,6)}}),cc.fadeOutDownTiles=function(e,t){return new cc.FadeOutDownTiles(e,t)},cc.FadeOutDownTiles.create=cc.fadeOutDownTiles,cc.TurnOffTiles=cc.TiledGrid3DAction.extend({_seed:null,_tilesCount:0,_tilesOrder:null,ctor:function(e,t,i){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._seed=i||0,this._tilesOrder.length=0,!0)},shuffle:function(e,t){for(var i=t-1;i>=0;i--){var n=0|cc.rand()%(i+1),r=e[i];e[i]=e[n],e[n]=r}},turnOnTile:function(e){this.setTile(e,this.originalTile(e))},turnOffTile:function(e){this.setTile(e,new cc.Quad3)},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._tilesCount=this._gridSize.width*this._gridSize.height;var t=this._tilesOrder;t.length=0;for(var i=0;i<this._tilesCount;++i)t[i]=i;this.shuffle(t,this._tilesCount)},update:function(e){for(var t,i=0|e*this._tilesCount,n=this._gridSize,r=cc.p(0,0),o=this._tilesOrder,s=0;s<this._tilesCount;s++)t=o[s],r.x=0|t/n.height,r.y=t%(0|n.height),s<i?this.turnOffTile(r):this.turnOnTile(r)}}),cc.turnOffTiles=function(e,t,i){return new cc.TurnOffTiles(e,t,i)},cc.TurnOffTiles.create=cc.turnOffTiles,cc.WavesTiles3D=cc.TiledGrid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t,i=this._gridSize,n=this._waves,r=this._amplitude,o=this._amplitudeRate,s=cc.p(0,0),a=0;a<i.width;a++)for(var c=0;c<i.height;c++)s.x=a,s.y=c,(t=this.originalTile(s)).bl.z=Math.sin(e*Math.PI*n*2+.01*(t.bl.y+t.bl.x))*r*o,t.br.z=t.bl.z,t.tl.z=t.bl.z,t.tr.z=t.bl.z,this.setTile(s,t)}}),cc.wavesTiles3D=function(e,t,i,n){return new cc.WavesTiles3D(e,t,i,n)},cc.WavesTiles3D.create=cc.wavesTiles3D,cc.JumpTiles3D=cc.TiledGrid3DAction.extend({_jumps:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._jumps=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t,i=Math.sin(Math.PI*e*this._jumps*2)*this._amplitude*this._amplitudeRate,n=Math.sin(Math.PI*(e*this._jumps*2+1))*this._amplitude*this._amplitudeRate,r=this._gridSize,o=this.target.grid,s=cc.p(0,0),a=0;a<r.width;a++)for(var c=0;c<r.height;c++)s.x=a,s.y=c,t=o.originalTile(s),(a+c)%2==0?(t.bl.z+=i,t.br.z+=i,t.tl.z+=i,t.tr.z+=i):(t.bl.z+=n,t.br.z+=n,t.tl.z+=n,t.tr.z+=n),o.setTile(s,t)}}),cc.jumpTiles3D=function(e,t,i,n){return new cc.JumpTiles3D(e,t,i,n)},cc.JumpTiles3D.create=cc.jumpTiles3D,cc.SplitRows=cc.TiledGrid3DAction.extend({_rows:0,_winSize:null,ctor:function(e,t){cc.GridAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return this._rows=t,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,cc.size(1,t))},update:function(e){for(var t,i,n=this._gridSize,r=this._winSize.width,o=cc.p(0,0),s=0;s<n.height;++s)o.y=s,t=this.originalTile(o),i=1,s%2==0&&(i=-1),t.bl.x+=i*r*e,t.br.x+=i*r*e,t.tl.x+=i*r*e,t.tr.x+=i*r*e,this.setTile(o,t)},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitRows=function(e,t){return new cc.SplitRows(e,t)},cc.SplitRows.create=cc.splitRows,cc.SplitCols=cc.TiledGrid3DAction.extend({_cols:0,_winSize:null,ctor:function(e,t){cc.GridAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return this._cols=t,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,cc.size(t,1))},update:function(e){for(var t,i,n=this._gridSize.width,r=this._winSize.height,o=cc.p(0,0),s=0;s<n;++s)o.x=s,t=this.originalTile(o),i=1,s%2==0&&(i=-1),t.bl.y+=i*r*e,t.br.y+=i*r*e,t.tl.y+=i*r*e,t.tr.y+=i*r*e,this.setTile(o,t);cc.renderer.childrenOrderDirty=!0},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitCols=function(e,t){return new cc.SplitCols(e,t)},cc.SplitCols.create=cc.splitCols,cc.PageTurn3D=cc.Grid3DAction.extend({update:function(e){for(var t=Math.max(0,e-.25),i=-100-t*t*500,n=-Math.PI/2*Math.sqrt(e),r=+Math.PI/2+n,o=Math.sin(r),s=Math.cos(r),a=this._gridSize,c=cc.p(0,0),l=0;l<=a.width;++l)for(var u=0;u<=a.height;++u){c.x=l,c.y=u;var h=this.originalVertex(c),d=Math.sqrt(h.x*h.x+(h.y-i)*(h.y-i)),p=d*o,_=Math.asin(h.x/d)/o,f=Math.cos(_);_<=Math.PI?h.x=p*Math.sin(_):h.x=0,h.y=d+i-p*(1-f)*o,h.z=p*(1-f)*s/7,h.z<.5&&(h.z=.5),this.setVertex(c,h)}}}),cc.pageTurn3D=function(e,t){return new cc.PageTurn3D(e,t)},cc.PageTurn3D.create=cc.pageTurn3D,cc.ProgressTimer=cc.Node.extend({_type:null,_percentage:0,_sprite:null,_midPoint:null,_barChangeRate:null,_reverseDirection:!1,_className:"ProgressTimer",ctor:function(e){cc.Node.prototype.ctor.call(this),this._type=cc.ProgressTimer.TYPE_RADIAL,this._percentage=0,this._midPoint=cc.p(0,0),this._barChangeRate=cc.p(0,0),this._reverseDirection=!1,this._sprite=null,e&&this.initWithSprite(e)},getMidpoint:function(){return cc.p(this._midPoint.x,this._midPoint.y)},setMidpoint:function(e){this._midPoint=cc.pClamp(e,cc.p(0,0),cc.p(1,1))},getBarChangeRate:function(){return cc.p(this._barChangeRate.x,this._barChangeRate.y)},setBarChangeRate:function(e){this._barChangeRate=cc.pClamp(e,cc.p(0,0),cc.p(1,1))},getType:function(){return this._type},getPercentage:function(){return this._percentage},getSprite:function(){return this._sprite},setPercentage:function(e){this._percentage!=e&&(this._percentage=cc.clampf(e,0,100),this._renderCmd._updateProgress())},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},isReverseDirection:function(){return this._reverseDirection},setColor:function(e){this._sprite.color=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setOpacity:function(e){this._sprite.opacity=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getColor:function(){return this._sprite.color},getOpacity:function(){return this._sprite.opacity},setReverseProgress:function(e){this._reverseDirection!==e&&(this._reverseDirection=e,this._renderCmd.releaseData())},setSprite:function(e){this._sprite!=e&&(this._sprite=e,e?this.setContentSize(e.width,e.height):this.setContentSize(0,0),this._renderCmd.releaseData())},setType:function(e){e!==this._type&&(this._type=e,this._renderCmd.releaseData())},setReverseDirection:function(e){this._reverseDirection!==e&&(this._reverseDirection=e,this._renderCmd.releaseData())},initWithSprite:function(e){return this.percentage=0,this.setAnchorPoint(.5,.5),this._type=cc.ProgressTimer.TYPE_RADIAL,this._reverseDirection=!1,this.midPoint=cc.p(.5,.5),this.barChangeRate=cc.p(1,1),this.setSprite(e),this._renderCmd.initCmd(),!0},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.ProgressTimer.CanvasRenderCmd(this):new cc.ProgressTimer.WebGLRenderCmd(this)}}),(_p=cc.ProgressTimer.prototype).midPoint,cc.defineGetterSetter(_p,"midPoint",_p.getMidpoint,_p.setMidpoint),_p.barChangeRate,cc.defineGetterSetter(_p,"barChangeRate",_p.getBarChangeRate,_p.setBarChangeRate),_p.type,cc.defineGetterSetter(_p,"type",_p.getType,_p.setType),_p.percentage,cc.defineGetterSetter(_p,"percentage",_p.getPercentage,_p.setPercentage),_p.sprite,cc.defineGetterSetter(_p,"sprite",_p.getSprite,_p.setSprite),_p.reverseDir,cc.defineGetterSetter(_p,"reverseDir",_p.isReverseDirection,_p.setReverseDirection),cc.ProgressTimer.create=function(e){return new cc.ProgressTimer(e)},cc.ProgressTimer.TEXTURE_COORDS_COUNT=4,cc.ProgressTimer.TEXTURE_COORDS=75,cc.ProgressTimer.TYPE_RADIAL=0,cc.ProgressTimer.TYPE_BAR=1,function(){cc.ProgressTimer.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._PI180=Math.PI/180,this._barRect=cc.rect(0,0,0,0),this._origin=cc.p(0,0),this._radius=0,this._startAngle=270,this._endAngle=270,this._counterClockWise=!1};var e=cc.ProgressTimer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.ProgressTimer.CanvasRenderCmd,e.rendering=function(e,t,i){var n=e||cc._renderContext,r=n.getContext(),o=this._node,s=o._sprite,a=s._renderCmd._textureCoord,c=s._renderCmd._displayedOpacity/255;if(0!==a.width&&0!==a.height&&s._texture&&a.validRect&&0!==c){n.setTransform(this._worldTransform,t,i),n.setCompositeOperation(s._blendFuncStr),n.setGlobalAlpha(c);var l=s._rect,u=s._offsetPosition,h=u.x,d=-u.y-l.height,p=l.width,_=l.height;if(n.save(),s._flippedX&&(h=-h-p,r.scale(-1,1)),s._flippedY&&(d=u.y,r.scale(1,-1)),o._type==cc.ProgressTimer.TYPE_BAR){var f=this._barRect;r.beginPath(),r.rect(f.x*t,f.y*i,f.width*t,f.height*i),r.clip(),r.closePath()}else if(o._type==cc.ProgressTimer.TYPE_RADIAL){var m=this._origin.x*t,g=this._origin.y*i;r.beginPath(),r.arc(m,g,this._radius*i,this._PI180*this._startAngle,this._PI180*this._endAngle,this._counterClockWise),r.lineTo(m,g),r.clip(),r.closePath()}var y=s._texture.getHtmlElementObj();s._colorized?r.drawImage(y,0,0,a.width,a.height,h*t,d*i,p*t,_*i):r.drawImage(y,a.renderX,a.renderY,a.width,a.height,h*t,d*i,p*t,_*i),n.restore(),cc.g_NumberOfDraws++}},e.releaseData=function(){},e.initCmd=function(){},e._updateProgress=function(){var e=this._node,t=e._sprite,i=t.width,n=t.height,r=e._midPoint;if(e._type==cc.ProgressTimer.TYPE_RADIAL){this._radius=Math.round(Math.sqrt(i*i+n*n));var o,s,a=!1,c=this._origin;c.x=i*r.x,c.y=-n*r.y,e._reverseDirection?(s=270,o=270-3.6*e._percentage):(o=-90,s=3.6*e._percentage-90),t._flippedX&&(c.x-=i*e._midPoint.x*2,o=-o,s=-s,o-=180,s-=180,a=!a),t._flippedY&&(c.y+=n*e._midPoint.y*2,a=!a,o=-o,s=-s),this._startAngle=o,this._endAngle=s,this._counterClockWise=a}else{var l=e._barChangeRate,u=e._percentage/100,h=this._barRect,d=cc.size(i*(1-l.x),n*(1-l.y)),p=cc.size((i-d.width)*u,(n-d.height)*u),_=cc.size(d.width+p.width,d.height+p.height),f=cc.p(i*r.x,n*r.y),m=f.x-_.width/2;r.x>.5&&_.width/2>=i-f.x&&(m=i-_.width);var g=f.y-_.height/2;r.y>.5&&_.height/2>=n-f.y&&(g=n-_.height),h.x=0;var y=1;t._flippedX&&(h.x-=_.width,y=-1),m>0&&(h.x+=m*y),h.y=0;var T=1;t._flippedY&&(h.y+=_.height,T=-1),g>0&&(h.y-=g*T),h.width=_.width,h.height=-_.height}},e._updateColor=function(){},e._syncStatus=function(e){var t=this._node;if(t._sprite){var i=cc.Node._dirtyFlags,n=this._dirtyFlag,r=e?e._node:null;r&&r._cascadeColorEnabled&&e._dirtyFlag&i.colorDirty&&(n|=i.colorDirty),r&&r._cascadeOpacityEnabled&&e._dirtyFlag&i.opacityDirty&&(n|=i.opacityDirty),e&&e._dirtyFlag&i.transformDirty&&(n|=i.transformDirty),this._dirtyFlag=n;var o=t._sprite._renderCmd,s=o._dirtyFlag,a=s&i.colorDirty,c=s&i.opacityDirty;a&&o._syncDisplayColor(),c&&o._syncDisplayOpacity(),n&i.transformDirty&&this.transform(e)}},e.updateStatus=function(){var e=this._node;if(e._sprite){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e._sprite._renderCmd,r=n._dirtyFlag,o=r&t.colorDirty,s=r&t.opacityDirty;o&&n._updateDisplayColor(),s&&n._updateDisplayOpacity(),i&t.transformDirty&&this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag=0}}}(),function(){cc.ProgressTimer.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._vertexWebGLBuffer=cc._renderContext.createBuffer(),this._vertexDataCount=0,this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataDirty=!1};var e=cc.ProgressTimer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.ProgressTimer.WebGLRenderCmd,e.rendering=function(e){var t=this._node,i=e||cc._renderContext;if(this._vertexData&&t._sprite){this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix);var n=t._sprite._blendFunc;cc.glBlendFunc(n.src,n.dst),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),cc.glBindTexture2D(t._sprite.texture),i.bindBuffer(i.ARRAY_BUFFER,this._vertexWebGLBuffer),this._vertexDataDirty&&(i.bufferData(i.ARRAY_BUFFER,this._vertexArrayBuffer,i.DYNAMIC_DRAW),this._vertexDataDirty=!1);var r=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,r,0),i.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,r,8),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,r,12),t._type===cc.ProgressTimer.TYPE_RADIAL?i.drawArrays(i.TRIANGLE_FAN,0,this._vertexDataCount):t._type==cc.ProgressTimer.TYPE_BAR&&(t._reverseDirection?(i.drawArrays(i.TRIANGLE_STRIP,0,this._vertexDataCount/2),i.drawArrays(i.TRIANGLE_STRIP,4,this._vertexDataCount/2),cc.g_NumberOfDraws++):i.drawArrays(i.TRIANGLE_STRIP,0,this._vertexDataCount)),cc.g_NumberOfDraws++}},e._syncStatus=function(e){var t=this._node;if(t._sprite){var i=cc.Node._dirtyFlags,n=this._dirtyFlag,r=e?e._node:null;r&&r._cascadeColorEnabled&&e._dirtyFlag&i.colorDirty&&(n|=i.colorDirty),r&&r._cascadeOpacityEnabled&&e._dirtyFlag&i.opacityDirty&&(n|=i.opacityDirty),e&&e._dirtyFlag&i.transformDirty&&(n|=i.transformDirty),this._dirtyFlag=n;var o=t._sprite._renderCmd,s=o._dirtyFlag,a=s&i.colorDirty,c=s&i.opacityDirty;a&&o._syncDisplayColor(),c&&o._syncDisplayOpacity(),(a||c)&&(o._updateColor(),this._updateColor()),this.transform(e),o._dirtyFlag=0}},e.updateStatus=function(){var e=this._node;if(e._sprite){var t=cc.Node._dirtyFlags,i=this._dirtyFlag,n=e._sprite._renderCmd,r=n._dirtyFlag,o=r&t.colorDirty,s=r&t.opacityDirty;o&&(n._updateDisplayColor(),this._dirtyFlag=this._dirtyFlag&t.colorDirty^this._dirtyFlag),s&&(n._updateDisplayOpacity(),this._dirtyFlag=this._dirtyFlag&t.opacityDirty^this._dirtyFlag),(o||s)&&(n._updateColor(),this._updateColor()),i&t.transformDirty&&this.transform(this.getParentRenderCmd(),!0)}},e.releaseData=function(){this._vertexData&&(this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0)},e.initCmd=function(){this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},e._updateProgress=function(){var e=this._node._type;e===cc.ProgressTimer.TYPE_RADIAL?this._updateRadial():e===cc.ProgressTimer.TYPE_BAR&&this._updateBar(),this._vertexDataDirty=!0},e._updateBar=function(){var e=this._node;if(e._sprite){var t,i=e._percentage/100,n=e._barChangeRate,r=cc.pMult(cc.p(1-n.x+i*n.x,1-n.y+i*n.y),.5),o=cc.pSub(e._midPoint,r),s=cc.pAdd(e._midPoint,r);o.x<0&&(s.x+=-o.x,o.x=0),s.x>1&&(o.x-=s.x-1,s.x=1),o.y<0&&(s.y+=-o.y,o.y=0),s.y>1&&(o.y-=s.y-1,s.y=1);var a;if(this._reverseDirection){if(!this._vertexData){this._vertexDataCount=8;var c=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=new ArrayBuffer(8*c);var l=[];for(t=0;t<8;t++)l[t]=new cc.V2F_C4B_T2F(null,null,null,this._vertexArrayBuffer,t*c);l[0].texCoords=this._textureCoordFromAlphaPoint(cc.p(0,1)),l[0].vertices=this._vertexFromAlphaPoint(cc.p(0,1)),l[1].texCoords=this._textureCoordFromAlphaPoint(cc.p(0,0)),l[1].vertices=this._vertexFromAlphaPoint(cc.p(0,0)),l[6].texCoords=this._textureCoordFromAlphaPoint(cc.p(1,1)),l[6].vertices=this._vertexFromAlphaPoint(cc.p(1,1)),l[7].texCoords=this._textureCoordFromAlphaPoint(cc.p(1,0)),l[7].vertices=this._vertexFromAlphaPoint(cc.p(1,0)),this._vertexData=l}(a=this._vertexData)[2].texCoords=this._textureCoordFromAlphaPoint(cc.p(o.x,s.y)),a[2].vertices=this._vertexFromAlphaPoint(cc.p(o.x,s.y)),a[3].texCoords=this._textureCoordFromAlphaPoint(cc.p(o.x,o.y)),a[3].vertices=this._vertexFromAlphaPoint(cc.p(o.x,o.y)),a[4].texCoords=this._textureCoordFromAlphaPoint(cc.p(s.x,s.y)),a[4].vertices=this._vertexFromAlphaPoint(cc.p(s.x,s.y)),a[5].texCoords=this._textureCoordFromAlphaPoint(cc.p(s.x,o.y)),a[5].vertices=this._vertexFromAlphaPoint(cc.p(s.x,o.y))}else{if(!this._vertexData){this._vertexDataCount=4;var u=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;for(this._vertexArrayBuffer=new ArrayBuffer(4*u),this._vertexData=[],t=0;t<4;t++)this._vertexData[t]=new cc.V2F_C4B_T2F(null,null,null,this._vertexArrayBuffer,t*u)}(a=this._vertexData)[0].texCoords=this._textureCoordFromAlphaPoint(cc.p(o.x,s.y)),a[0].vertices=this._vertexFromAlphaPoint(cc.p(o.x,s.y)),a[1].texCoords=this._textureCoordFromAlphaPoint(cc.p(o.x,o.y)),a[1].vertices=this._vertexFromAlphaPoint(cc.p(o.x,o.y)),a[2].texCoords=this._textureCoordFromAlphaPoint(cc.p(s.x,s.y)),a[2].vertices=this._vertexFromAlphaPoint(cc.p(s.x,s.y)),a[3].texCoords=this._textureCoordFromAlphaPoint(cc.p(s.x,o.y)),a[3].vertices=this._vertexFromAlphaPoint(cc.p(s.x,o.y))}this._updateColor()}},e._updateRadial=function(){var e=this._node;if(e._sprite){var t,i,n=e._midPoint,r=e._percentage/100,o=2*cc.PI*(e._reverseDirection?r:1-r),s=cc.p(n.x,1),a=cc.pRotateByAngle(s,n,o),c=0;if(0==r)i=s,c=0;else if(1==r)i=s,c=4;else{var l=cc.FLT_MAX,u=cc.ProgressTimer.TEXTURE_COORDS_COUNT;for(t=0;t<=u;++t){var h=(t+(u-1))%u,d=this._boundaryTexCoord(t%u),p=this._boundaryTexCoord(h);0==t?p=cc.pLerp(d,p,1-n.x):4==t&&(d=cc.pLerp(d,p,1-n.x));var _=cc.p(0,0);if(cc.pLineIntersect(d,p,n,a,_)){if(!(0!=t&&4!=t||0<=_.x&&_.x<=1))continue;_.y>=0&&_.y<l&&(l=_.y,c=t)}}i=cc.pAdd(n,cc.pMult(cc.pSub(a,n),l))}var f=!0;if(this._vertexDataCount!=c+3&&(f=!1,this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0),!this._vertexData){this._vertexDataCount=c+3;var m=this._vertexDataCount,g=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=new ArrayBuffer(m*g);var y=[];for(t=0;t<m;t++)y[t]=new cc.V2F_C4B_T2F(null,null,null,this._vertexArrayBuffer,t*g);if(this._vertexData=y,!this._vertexData)return void cc.log("cc.ProgressTimer._updateRadial() : Not enough memory")}this._updateColor();var T=this._vertexData;if(!f)for(T[0].texCoords=this._textureCoordFromAlphaPoint(n),T[0].vertices=this._vertexFromAlphaPoint(n),T[1].texCoords=this._textureCoordFromAlphaPoint(s),T[1].vertices=this._vertexFromAlphaPoint(s),t=0;t<c;t++){var v=this._boundaryTexCoord(t);T[t+2].texCoords=this._textureCoordFromAlphaPoint(v),T[t+2].vertices=this._vertexFromAlphaPoint(v)}T[this._vertexDataCount-1].texCoords=this._textureCoordFromAlphaPoint(i),T[this._vertexDataCount-1].vertices=this._vertexFromAlphaPoint(i)}},e._boundaryTexCoord=function(e){if(e<cc.ProgressTimer.TEXTURE_COORDS_COUNT){var t=cc.ProgressTimer.TEXTURE_COORDS;return this._node._reverseDirection?cc.p(t>>7-(e<<1)&1,t>>7-(1+(e<<1))&1):cc.p(t>>1+(e<<1)&1,t>>(e<<1)&1)}return cc.p(0,0)},e._textureCoordFromAlphaPoint=function(e){var t=this._node._sprite;if(!t)return{u:0,v:0};var i=t.quad,n=cc.p(i.bl.texCoords.u,i.bl.texCoords.v),r=cc.p(i.tr.texCoords.u,i.tr.texCoords.v);if(t.textureRectRotated){var o=e.x;e.x=e.y,e.y=o}return{u:n.x*(1-e.x)+r.x*e.x,v:n.y*(1-e.y)+r.y*e.y}},e._vertexFromAlphaPoint=function(e){var t=this._node._sprite;if(!t)return{x:0,y:0};var i=t.quad,n=cc.p(i.bl.vertices.x,i.bl.vertices.y),r=cc.p(i.tr.vertices.x,i.tr.vertices.y);return{x:n.x*(1-e.x)+r.x*e.x,y:n.y*(1-e.y)+r.y*e.y}},e._updateColor=function(){var e=this._node;if(e._sprite&&this._vertexData){for(var t=e._sprite.quad.tl.colors,i=this._vertexData,n=0,r=this._vertexDataCount;n<r;++n)i[n].colors=t;this._vertexDataDirty=!0}}}(),cc.ProgressTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(e,t){cc.ActionInterval.prototype.ctor.call(this),this._to=0,this._from=0,void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=t,!0)},clone:function(){var e=new cc.ProgressTo;return e.initWithDuration(this._duration,this._to),e},reverse:function(){return cc.log("cc.ProgressTo.reverse(): reverse hasn't been supported."),null},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._from=e.percentage},update:function(e){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*e)}}),cc.progressTo=function(e,t){return new cc.ProgressTo(e,t)},cc.ProgressTo.create=cc.progressTo,cc.ProgressFromTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(e,t,i){cc.ActionInterval.prototype.ctor.call(this),this._to=0,this._from=0,void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=i,this._from=t,!0)},clone:function(){var e=new cc.ProgressFromTo;return e.initWithDuration(this._duration,this._from,this._to),e},reverse:function(){return cc.progressFromTo(this._duration,this._to,this._from)},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e)},update:function(e){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*e)}}),cc.progressFromTo=function(e,t,i){return new cc.ProgressFromTo(e,t,i)},cc.ProgressFromTo.create=cc.progressFromTo,cc.SCENE_FADE=4208917214,cc.TRANSITION_ORIENTATION_LEFT_OVER=0,cc.TRANSITION_ORIENTATION_RIGHT_OVER=1,cc.TRANSITION_ORIENTATION_UP_OVER=0,cc.TRANSITION_ORIENTATION_DOWN_OVER=1,cc.TransitionScene=cc.Scene.extend({_inScene:null,_outScene:null,_duration:null,_isInSceneOnTop:!1,_isSendCleanupToScene:!1,_className:"TransitionScene",ctor:function(e,t){cc.Scene.prototype.ctor.call(this),void 0!==e&&void 0!==t&&this.initWithDuration(e,t)},_setNewScene:function(e){this.unschedule(this._setNewScene);var t=cc.director;this._isSendCleanupToScene=t.isSendCleanupToScene(),t.runScene(this._inScene),cc.eventManager.setEnabled(!0),this._outScene.visible=!0},_sceneOrder:function(){this._isInSceneOnTop=!0},visit:function(){this._isInSceneOnTop?(this._outScene.visit(),this._inScene.visit()):(this._inScene.visit(),this._outScene.visit()),cc.Node.prototype.visit.call(this)},onEnter:function(){cc.Node.prototype.onEnter.call(this),cc.eventManager.setEnabled(!1),this._outScene.onExitTransitionDidStart(),this._inScene.onEnter()},onExit:function(){cc.Node.prototype.onExit.call(this),cc.eventManager.setEnabled(!0),this._outScene.onExit(),this._inScene.onEnterTransitionDidFinish()},cleanup:function(){cc.Node.prototype.cleanup.call(this),this._isSendCleanupToScene&&this._outScene.cleanup()},initWithDuration:function(e,t){if(!t)throw"cc.TransitionScene.initWithDuration(): Argument scene must be non-nil";if(this.init()){if(this._duration=e,this.attr({x:0,y:0,anchorX:0,anchorY:0}),this._inScene=t,this._outScene=cc.director.getRunningScene(),this._outScene||(this._outScene=new cc.Scene,this._outScene.init()),this._inScene==this._outScene)throw"cc.TransitionScene.initWithDuration(): Incoming scene must be different from the outgoing scene";return this._sceneOrder(),!0}return!1},finish:function(){this._inScene.attr({visible:!0,x:0,y:0,scale:1,rotation:0}),cc._renderType===cc._RENDER_TYPE_WEBGL&&this._inScene.getCamera().restore(),this._outScene.attr({visible:!1,x:0,y:0,scale:1,rotation:0}),cc._renderType===cc._RENDER_TYPE_WEBGL&&this._outScene.getCamera().restore(),this.schedule(this._setNewScene,0)},hideOutShowIn:function(){this._inScene.visible=!0,this._outScene.visible=!1}}),cc.TransitionScene.create=function(e,t){return new cc.TransitionScene(e,t)},cc.TransitionSceneOriented=cc.TransitionScene.extend({_orientation:0,ctor:function(e,t,i){cc.TransitionScene.prototype.ctor.call(this),void 0!=i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return cc.TransitionScene.prototype.initWithDuration.call(this,e,t)&&(this._orientation=i),!0}}),cc.TransitionSceneOriented.create=function(e,t,i){return new cc.TransitionSceneOriented(e,t,i)},cc.TransitionRotoZoom=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:.5,anchorY:.5}),this._outScene.attr({scale:1,anchorX:.5,anchorY:.5});var e=cc.sequence(cc.spawn(cc.scaleBy(this._duration/2,.001),cc.rotateBy(this._duration/2,720)),cc.delayTime(this._duration/2));this._outScene.runAction(e),this._inScene.runAction(cc.sequence(e.reverse(),cc.callFunc(this.finish,this)))}}),cc.TransitionRotoZoom.create=function(e,t){return new cc.TransitionRotoZoom(e,t)},cc.TransitionJumpZoom=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e=cc.director.getWinSize();this._inScene.attr({scale:.5,x:e.width,y:0,anchorX:.5,anchorY:.5}),this._outScene.anchorX=.5,this._outScene.anchorY=.5;var t=cc.jumpBy(this._duration/4,cc.p(-e.width,0),e.width/4,2),i=cc.scaleTo(this._duration/4,1),n=cc.scaleTo(this._duration/4,.5),r=cc.sequence(n,t),o=cc.sequence(t,i),s=cc.delayTime(this._duration/2);this._outScene.runAction(r),this._inScene.runAction(cc.sequence(s,o,cc.callFunc(this.finish,this)))}}),cc.TransitionJumpZoom.create=function(e,t){return new cc.TransitionJumpZoom(e,t)},cc.TransitionMoveInL=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var e=this.action();this._inScene.runAction(cc.sequence(this.easeActionWithAction(e),cc.callFunc(this.finish,this)))},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width,0)},action:function(){return cc.moveTo(this._duration,cc.p(0,0))},easeActionWithAction:function(e){return new cc.EaseOut(e,2)}}),cc.TransitionMoveInL.create=function(e,t){return new cc.TransitionMoveInL(e,t)},cc.TransitionMoveInR=cc.TransitionMoveInL.extend({ctor:function(e,t){cc.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width,0)}}),cc.TransitionMoveInR.create=function(e,t){return new cc.TransitionMoveInR(e,t)},cc.TransitionMoveInT=cc.TransitionMoveInL.extend({ctor:function(e,t){cc.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(0,cc.director.getWinSize().height)}}),cc.TransitionMoveInT.create=function(e,t){return new cc.TransitionMoveInT(e,t)},cc.TransitionMoveInB=cc.TransitionMoveInL.extend({ctor:function(e,t){cc.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(0,-cc.director.getWinSize().height)}}),cc.TransitionMoveInB.create=function(e,t){return new cc.TransitionMoveInB(e,t)},cc.ADJUST_FACTOR=.5,cc.TransitionSlideInL=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var e=this.action(),t=this.action(),i=this.easeActionWithAction(e),n=cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this));this._inScene.runAction(i),this._outScene.runAction(n)},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width+cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0))},easeActionWithAction:function(e){return new cc.EaseInOut(e,2)}}),cc.TransitionSlideInL.create=function(e,t){return new cc.TransitionSlideInL(e,t)},cc.TransitionSlideInR=cc.TransitionSlideInL.extend({ctor:function(e,t){cc.TransitionSlideInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(-(cc.director.getWinSize().width-cc.ADJUST_FACTOR),0))}}),cc.TransitionSlideInR.create=function(e,t){return new cc.TransitionSlideInR(e,t)},cc.TransitionSlideInB=cc.TransitionSlideInL.extend({ctor:function(e,t){cc.TransitionSlideInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},initScenes:function(){this._inScene.setPosition(0,-(cc.director.getWinSize().height-cc.ADJUST_FACTOR))},action:function(){return cc.moveBy(this._duration,cc.p(0,cc.director.getWinSize().height-cc.ADJUST_FACTOR))}}),cc.TransitionSlideInB.create=function(e,t){return new cc.TransitionSlideInB(e,t)},cc.TransitionSlideInT=cc.TransitionSlideInL.extend({ctor:function(e,t){cc.TransitionSlideInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(0,cc.director.getWinSize().height-cc.ADJUST_FACTOR)},action:function(){return cc.moveBy(this._duration,cc.p(0,-(cc.director.getWinSize().height-cc.ADJUST_FACTOR)))}}),cc.TransitionSlideInT.create=function(e,t){return new cc.TransitionSlideInT(e,t)},cc.TransitionShrinkGrow=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:2/3,anchorY:.5}),this._outScene.attr({scale:1,anchorX:1/3,anchorY:.5});var e=cc.scaleTo(this._duration,.01),t=cc.scaleTo(this._duration,1);this._inScene.runAction(this.easeActionWithAction(t)),this._outScene.runAction(cc.sequence(this.easeActionWithAction(e),cc.callFunc(this.finish,this)))},easeActionWithAction:function(e){return new cc.EaseOut(e,2)}}),cc.TransitionShrinkGrow.create=function(e,t){return new cc.TransitionShrinkGrow(e,t)},cc.TransitionFlipX=cc.TransitionSceneOriented.extend({ctor:function(e,t,i){cc.TransitionSceneOriented.prototype.ctor.call(this),null==i&&(i=cc.TRANSITION_ORIENTATION_RIGHT_OVER),t&&this.initWithDuration(e,t,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e,t;this._inScene.visible=!1;var i,n,r,o;this._orientation===cc.TRANSITION_ORIENTATION_RIGHT_OVER?(i=90,n=270,r=90,o=0):(i=-90,n=90,r=-90,o=0),e=cc.sequence(cc.delayTime(this._duration/2),cc.show(),cc.orbitCamera(this._duration/2,1,0,n,i,0,0),cc.callFunc(this.finish,this)),t=cc.sequence(cc.orbitCamera(this._duration/2,1,0,o,r,0,0),cc.hide(),cc.delayTime(this._duration/2)),this._inScene.runAction(e),this._outScene.runAction(t)}}),cc.TransitionFlipX.create=function(e,t,i){return new cc.TransitionFlipX(e,t,i)},cc.TransitionFlipY=cc.TransitionSceneOriented.extend({ctor:function(e,t,i){cc.TransitionSceneOriented.prototype.ctor.call(this),null==i&&(i=cc.TRANSITION_ORIENTATION_UP_OVER),t&&this.initWithDuration(e,t,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e,t;this._inScene.visible=!1;var i,n,r,o;this._orientation==cc.TRANSITION_ORIENTATION_UP_OVER?(i=90,n=270,r=90,o=0):(i=-90,n=90,r=-90,o=0),e=cc.sequence(cc.delayTime(this._duration/2),cc.show(),cc.orbitCamera(this._duration/2,1,0,n,i,90,0),cc.callFunc(this.finish,this)),t=cc.sequence(cc.orbitCamera(this._duration/2,1,0,o,r,90,0),cc.hide(),cc.delayTime(this._duration/2)),this._inScene.runAction(e),this._outScene.runAction(t)}}),cc.TransitionFlipY.create=function(e,t,i){return new cc.TransitionFlipY(e,t,i)},cc.TransitionFlipAngular=cc.TransitionSceneOriented.extend({ctor:function(e,t,i){cc.TransitionSceneOriented.prototype.ctor.call(this),null==i&&(i=cc.TRANSITION_ORIENTATION_RIGHT_OVER),t&&this.initWithDuration(e,t,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e,t;this._inScene.visible=!1;var i,n,r,o;this._orientation===cc.TRANSITION_ORIENTATION_RIGHT_OVER?(i=90,n=270,r=90,o=0):(i=-90,n=90,r=-90,o=0),e=cc.sequence(cc.delayTime(this._duration/2),cc.show(),cc.orbitCamera(this._duration/2,1,0,n,i,-45,0),cc.callFunc(this.finish,this)),t=cc.sequence(cc.orbitCamera(this._duration/2,1,0,o,r,45,0),cc.hide(),cc.delayTime(this._duration/2)),this._inScene.runAction(e),this._outScene.runAction(t)}}),cc.TransitionFlipAngular.create=function(e,t,i){return new cc.TransitionFlipAngular(e,t,i)},cc.TransitionZoomFlipX=cc.TransitionSceneOriented.extend({ctor:function(e,t,i){cc.TransitionSceneOriented.prototype.ctor.call(this),null==i&&(i=cc.TRANSITION_ORIENTATION_RIGHT_OVER),t&&this.initWithDuration(e,t,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e,t;this._inScene.visible=!1;var i,n,r,o;this._orientation===cc.TRANSITION_ORIENTATION_RIGHT_OVER?(i=90,n=270,r=90,o=0):(i=-90,n=90,r=-90,o=0),e=cc.sequence(cc.delayTime(this._duration/2),cc.spawn(cc.orbitCamera(this._duration/2,1,0,n,i,0,0),cc.scaleTo(this._duration/2,1),cc.show()),cc.callFunc(this.finish,this)),t=cc.sequence(cc.spawn(cc.orbitCamera(this._duration/2,1,0,o,r,0,0),cc.scaleTo(this._duration/2,.5)),cc.hide(),cc.delayTime(this._duration/2)),this._inScene.scale=.5,this._inScene.runAction(e),this._outScene.runAction(t)}}),cc.TransitionZoomFlipX.create=function(e,t,i){return new cc.TransitionZoomFlipX(e,t,i)},cc.TransitionZoomFlipY=cc.TransitionSceneOriented.extend({ctor:function(e,t,i){cc.TransitionSceneOriented.prototype.ctor.call(this),null==i&&(i=cc.TRANSITION_ORIENTATION_UP_OVER),t&&this.initWithDuration(e,t,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e,t;this._inScene.visible=!1;var i,n,r,o;this._orientation===cc.TRANSITION_ORIENTATION_UP_OVER?(i=90,n=270,r=90,o=0):(i=-90,n=90,r=-90,o=0),e=cc.sequence(cc.delayTime(this._duration/2),cc.spawn(cc.orbitCamera(this._duration/2,1,0,n,i,90,0),cc.scaleTo(this._duration/2,1),cc.show()),cc.callFunc(this.finish,this)),t=cc.sequence(cc.spawn(cc.orbitCamera(this._duration/2,1,0,o,r,90,0),cc.scaleTo(this._duration/2,.5)),cc.hide(),cc.delayTime(this._duration/2)),this._inScene.scale=.5,this._inScene.runAction(e),this._outScene.runAction(t)}}),cc.TransitionZoomFlipY.create=function(e,t,i){return new cc.TransitionZoomFlipY(e,t,i)},cc.TransitionZoomFlipAngular=cc.TransitionSceneOriented.extend({ctor:function(e,t,i){cc.TransitionSceneOriented.prototype.ctor.call(this),null==i&&(i=cc.TRANSITION_ORIENTATION_RIGHT_OVER),t&&this.initWithDuration(e,t,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e,t;this._inScene.visible=!1;var i,n,r,o;this._orientation===cc.TRANSITION_ORIENTATION_RIGHT_OVER?(i=90,n=270,r=90,o=0):(i=-90,n=90,r=-90,o=0),e=cc.sequence(cc.delayTime(this._duration/2),cc.spawn(cc.orbitCamera(this._duration/2,1,0,n,i,-45,0),cc.scaleTo(this._duration/2,1),cc.show()),cc.show(),cc.callFunc(this.finish,this)),t=cc.sequence(cc.spawn(cc.orbitCamera(this._duration/2,1,0,o,r,45,0),cc.scaleTo(this._duration/2,.5)),cc.hide(),cc.delayTime(this._duration/2)),this._inScene.scale=.5,this._inScene.runAction(e),this._outScene.runAction(t)}}),cc.TransitionZoomFlipAngular.create=function(e,t,i){return new cc.TransitionZoomFlipAngular(e,t,i)},cc.TransitionFade=cc.TransitionScene.extend({_color:null,ctor:function(e,t,i){cc.TransitionScene.prototype.ctor.call(this),this._color=cc.color(),t&&this.initWithDuration(e,t,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e=new cc.LayerColor(this._color);this._inScene.visible=!1,this.addChild(e,2,cc.SCENE_FADE);var t=this.getChildByTag(cc.SCENE_FADE),i=cc.sequence(cc.fadeIn(this._duration/2),cc.callFunc(this.hideOutShowIn,this),cc.fadeOut(this._duration/2),cc.callFunc(this.finish,this));t.runAction(i)},onExit:function(){cc.TransitionScene.prototype.onExit.call(this),this.removeChildByTag(cc.SCENE_FADE,!1)},initWithDuration:function(e,t,i){return i=i||cc.color.BLACK,cc.TransitionScene.prototype.initWithDuration.call(this,e,t)&&(this._color.r=i.r,this._color.g=i.g,this._color.b=i.b,this._color.a=0),!0}}),cc.TransitionFade.create=function(e,t,i){return new cc.TransitionFade(e,t,i)},cc.TransitionCrossFade=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e=cc.color(0,0,0,0),t=cc.director.getWinSize(),i=new cc.LayerColor(e),n=new cc.RenderTexture(t.width,t.height);if(null!=n){n.sprite.anchorX=.5,n.sprite.anchorY=.5,n.attr({x:t.width/2,y:t.height/2,anchorX:.5,anchorY:.5}),n.begin(),this._inScene.visit(),n.end();var r=new cc.RenderTexture(t.width,t.height);r.setPosition(t.width/2,t.height/2),r.sprite.anchorX=r.anchorX=.5,r.sprite.anchorY=r.anchorY=.5,r.begin(),this._outScene.visit(),r.end(),n.sprite.setBlendFunc(cc.ONE,cc.ONE),r.sprite.setBlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),i.addChild(n),i.addChild(r),n.sprite.opacity=255,r.sprite.opacity=255;var o=cc.sequence(cc.fadeTo(this._duration,0),cc.callFunc(this.hideOutShowIn,this),cc.callFunc(this.finish,this));r.sprite.runAction(o),this.addChild(i,2,cc.SCENE_FADE)}},onExit:function(){this.removeChildByTag(cc.SCENE_FADE,!1),cc.TransitionScene.prototype.onExit.call(this)},visit:function(){cc.Node.prototype.visit.call(this)},draw:function(){}}),cc.TransitionCrossFade.create=function(e,t){return new cc.TransitionCrossFade(e,t)},cc.TransitionTurnOffTiles=cc.TransitionScene.extend({_gridProxy:null,ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var e=cc.director.getWinSize(),t=0|12*(e.width/e.height),i=cc.turnOffTiles(this._duration,cc.size(t,12)),n=this.easeActionWithAction(i);this._gridProxy.runAction(cc.sequence(n,cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(e){return e}}),cc.TransitionTurnOffTiles.create=function(e,t){return new cc.TransitionTurnOffTiles(e,t)},cc.TransitionSplitCols=cc.TransitionScene.extend({_gridProxy:null,_switchTargetToInscene:function(){this._gridProxy.setTarget(this._inScene)},ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var e=this.action(),t=cc.sequence(e,cc.callFunc(this._switchTargetToInscene,this),e.reverse());this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this),cc.stopGrid()))},onExit:function(){this._gridProxy.setTarget(null),this._gridProxy.onExit(),cc.TransitionScene.prototype.onExit.call(this)},visit:function(){this._gridProxy.visit()},easeActionWithAction:function(e){return new cc.EaseInOut(e,3)},action:function(){return cc.splitCols(this._duration/2,3)}}),cc.TransitionSplitCols.create=function(e,t){return new cc.TransitionSplitCols(e,t)},cc.TransitionSplitRows=cc.TransitionSplitCols.extend({ctor:function(e,t){cc.TransitionSplitCols.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},action:function(){return cc.splitRows(this._duration/2,3)}}),cc.TransitionSplitRows.create=function(e,t){return new cc.TransitionSplitRows(e,t)},cc.TransitionFadeTR=cc.TransitionScene.extend({_gridProxy:null,ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var e=cc.director.getWinSize(),t=0|12*(e.width/e.height),i=this.actionWithSize(cc.size(t,12));this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(i),cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(e){return e},actionWithSize:function(e){return cc.fadeOutTRTiles(this._duration,e)}}),cc.TransitionFadeTR.create=function(e,t){return new cc.TransitionFadeTR(e,t)},cc.TransitionFadeBL=cc.TransitionFadeTR.extend({ctor:function(e,t){cc.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return cc.fadeOutBLTiles(this._duration,e)}}),cc.TransitionFadeBL.create=function(e,t){return new cc.TransitionFadeBL(e,t)},cc.TransitionFadeUp=cc.TransitionFadeTR.extend({ctor:function(e,t){cc.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return new cc.FadeOutUpTiles(this._duration,e)}}),cc.TransitionFadeUp.create=function(e,t){return new cc.TransitionFadeUp(e,t)},cc.TransitionFadeDown=cc.TransitionFadeTR.extend({ctor:function(e,t){cc.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return cc.fadeOutDownTiles(this._duration,e)}}),cc.TransitionFadeDown.create=function(e,t){return new cc.TransitionFadeDown(e,t)},cc.SCENE_RADIAL=49153,cc.TransitionProgress=cc.TransitionScene.extend({_to:0,_from:0,_sceneToBeModified:null,_className:"TransitionProgress",ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_setAttrs:function(e,t,i){e.attr({x:t,y:i,anchorX:.5,anchorY:.5})},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._setupTransition();var e=cc.director.getWinSize(),t=new cc.RenderTexture(e.width,e.height);t.sprite.anchorX=.5,t.sprite.anchorY=.5,this._setAttrs(t,e.width/2,e.height/2),t.clear(0,0,0,1),t.begin(),this._sceneToBeModified.visit(),t.end(),this._sceneToBeModified==this._outScene&&this.hideOutShowIn();var i=this._progressTimerNodeWithRenderTexture(t),n=cc.sequence(cc.progressFromTo(this._duration,this._from,this._to),cc.callFunc(this.finish,this));i.runAction(n),this.addChild(i,2,cc.SCENE_RADIAL)},onExit:function(){this.removeChildByTag(cc.SCENE_RADIAL,!0),cc.TransitionScene.prototype.onExit.call(this)},_setupTransition:function(){this._sceneToBeModified=this._outScene,this._from=100,this._to=0},_progressTimerNodeWithRenderTexture:function(e){return cc.log("cc.TransitionProgress._progressTimerNodeWithRenderTexture(): should be overridden in subclass"),null},_sceneOrder:function(){this._isInSceneOnTop=!1}}),cc.TransitionProgress.create=function(e,t){return new cc.TransitionProgress(e,t)},cc.TransitionProgressRadialCCW=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),i=new cc.ProgressTimer(e.sprite);return cc._renderType===cc._RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_RADIAL,i.reverseDir=!1,i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),cc.TransitionProgressRadialCCW.create=function(e,t){return new cc.TransitionProgressRadialCCW(e,t)},cc.TransitionProgressRadialCW=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),i=new cc.ProgressTimer(e.sprite);return cc._renderType===cc._RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_RADIAL,i.reverseDir=!0,i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),cc.TransitionProgressRadialCW.create=function(e,t){var i=new cc.TransitionProgressRadialCW;return null!=i&&i.initWithDuration(e,t)?i:new cc.TransitionProgressRadialCW(e,t)},cc.TransitionProgressHorizontal=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),i=new cc.ProgressTimer(e.sprite);return cc._renderType===cc._RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(1,0),i.barChangeRate=cc.p(1,0),i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),cc.TransitionProgressHorizontal.create=function(e,t){return new cc.TransitionProgressHorizontal(e,t)},cc.TransitionProgressVertical=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),i=new cc.ProgressTimer(e.sprite);return cc._renderType===cc._RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(0,0),i.barChangeRate=cc.p(0,1),i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),cc.TransitionProgressVertical.create=function(e,t){return new cc.TransitionProgressVertical(e,t)},cc.TransitionProgressInOut=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),i=new cc.ProgressTimer(e.sprite);return cc._renderType===cc._RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(.5,.5),i.barChangeRate=cc.p(1,1),i.percentage=0,this._setAttrs(i,t.width/2,t.height/2),i},_sceneOrder:function(){this._isInSceneOnTop=!1},_setupTransition:function(){this._sceneToBeModified=this._inScene,this._from=0,this._to=100}}),cc.TransitionProgressInOut.create=function(e,t){return new cc.TransitionProgressInOut(e,t)},cc.TransitionProgressOutIn=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),i=new cc.ProgressTimer(e.sprite);return cc._renderType===cc._RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(.5,.5),i.barChangeRate=cc.p(1,1),i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),cc.TransitionProgressOutIn.create=function(e,t){return new cc.TransitionProgressOutIn(e,t)},cc.TransitionPageTurn=cc.TransitionScene.extend({ctor:function(e,t,i){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,this.initWithDuration(e,t,i)},_back:!0,_gridProxy:null,_className:"TransitionPageTurn",initWithDuration:function(e,t,i){return this._back=i,cc.TransitionScene.prototype.initWithDuration.call(this,e,t),!0},actionWithSize:function(e){return this._back?cc.reverseTime(cc.pageTurn3D(this._duration,e)):cc.pageTurn3D(this._duration,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e,t,i=cc.director.getWinSize();i.width>i.height?(e=16,t=12):(e=12,t=16);var n=this.actionWithSize(cc.size(e,t)),r=this._gridProxy;this._back?(r.setTarget(this._inScene),r.onEnter(),this._inScene.visible=!1,r.runAction(cc.sequence(n,cc.callFunc(this.finish,this),cc.stopGrid())),this._inScene.runAction(cc.show())):(r.setTarget(this._outScene),r.onEnter(),r.runAction(cc.sequence(n,cc.callFunc(this.finish,this),cc.stopGrid())))},visit:function(){this._back?this._outScene.visit():this._inScene.visit(),this._gridProxy.visit()},_sceneOrder:function(){this._isInSceneOnTop=this._back}}),cc.TransitionPageTurn.create=function(e,t,i){return new cc.TransitionPageTurn(e,t,i)},cc.Codec={name:"Jacob__Codec"},cc.unzip=function(){return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip,arguments)},cc.unzipBase64=function(){var e=cc.Codec.Base64.decode.apply(cc.Codec.Base64,arguments);return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip,[e])},cc.unzipBase64AsArray=function(e,t){t=t||1;var i,n,r,o=this.unzipBase64(e),s=[];for(i=0,r=o.length/t;i<r;i++)for(s[i]=0,n=t-1;n>=0;--n)s[i]+=o.charCodeAt(i*t+n)<<8*n;return s},cc.unzipAsArray=function(e,t){t=t||1;var i,n,r,o=this.unzip(e),s=[];for(i=0,r=o.length/t;i<r;i++)for(s[i]=0,n=t-1;n>=0;--n)s[i]+=o.charCodeAt(i*t+n)<<8*n;return s},cc.StringToArray=function(e){var t,i=e.split(","),n=[];for(t=0;t<i.length;t++)n.push(parseInt(i[t]));return n},cc.Codec.Base64={name:"Jacob__Codec__Base64"},cc.Codec.Base64._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",cc.Codec.Base64.decode=function(e){var t,i,n,r,o,s,a=[],c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(r=this._keyStr.indexOf(e.charAt(c++)))>>4,i=(15&r)<<4|(o=this._keyStr.indexOf(e.charAt(c++)))>>2,n=(3&o)<<6|(s=this._keyStr.indexOf(e.charAt(c++))),a.push(String.fromCharCode(t)),64!=o&&a.push(String.fromCharCode(i)),64!=s&&a.push(String.fromCharCode(n));return a=a.join("")},cc.Codec.Base64.decodeAsArray=function(e,t){var i,n,r,o=this.decode(e),s=[];for(i=0,r=o.length/t;i<r;i++)for(s[i]=0,n=t-1;n>=0;--n)s[i]+=o.charCodeAt(i*t+n)<<8*n;return s},cc.uint8ArrayToUint32Array=function(e){if(e.length%4!=0)return null;for(var t=e.length/4,i=window.Uint32Array?new Uint32Array(t):[],n=0;n<t;n++){var r=4*n;i[n]=e[r]+256*e[r+1]+65536*e[r+2]+e[r+3]*(1<<24)}return i},cc.Codec.GZip=function(e){this.data=e,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=new Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=new Array(cc.Codec.GZip.LITERALS),this.distanceTree=new Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=new Array(17),this.fpos[0]=0,this.flens=void 0,this.fmax=void 0},cc.Codec.GZip.gunzip=function(e){return e.constructor===Array||(e.constructor,String),new cc.Codec.GZip(e).gunzip()[0][0]},cc.Codec.GZip.HufNode=function(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1},cc.Codec.GZip.LITERALS=288,cc.Codec.GZip.NAMEMAX=256,cc.Codec.GZip.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],cc.Codec.GZip.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],cc.Codec.GZip.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],cc.Codec.GZip.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],cc.Codec.GZip.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],cc.Codec.GZip.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],cc.Codec.GZip.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},cc.Codec.GZip.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},cc.Codec.GZip.prototype.byteAlign=function(){this.bb=1},cc.Codec.GZip.prototype.readBit=function(){var e;return this.bits++,e=1&this.bb,this.bb>>=1,0==this.bb&&(this.bb=this.readByte(),e=1&this.bb,this.bb=this.bb>>1|128),e},cc.Codec.GZip.prototype.readBits=function(e){for(var t=0,i=e;i--;)t=t<<1|this.readBit();return e&&(t=cc.Codec.GZip.bitReverse[t]>>8-e),t},cc.Codec.GZip.prototype.flushBuffer=function(){this.bIdx=0},cc.Codec.GZip.prototype.addBuffer=function(e){this.buf32k[this.bIdx++]=e,this.outputArr.push(String.fromCharCode(e)),32768==this.bIdx&&(this.bIdx=0)},cc.Codec.GZip.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]==this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},cc.Codec.GZip.prototype.Rec=function(){var e,t=this.Places[this.treepos];if(17==this.len)return-1;if(this.treepos++,this.len++,(e=this.IsPat())>=0)t.b0=e;else if(t.b0=32768,this.Rec())return-1;if((e=this.IsPat())>=0)t.b1=e,t.jump=null;else if(t.b1=32768,t.jump=this.Places[this.treepos],t.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},cc.Codec.GZip.prototype.CreateTree=function(e,t,i,n){var r;for(this.Places=e,this.treepos=0,this.flens=i,this.fmax=t,r=0;r<17;r++)this.fpos[r]=0;return this.len=0,this.Rec()?-1:0},cc.Codec.GZip.prototype.DecodeValue=function(e){for(var t,i,n=0,r=e[n];;)if(this.readBit()){if(!(32768&r.b1))return r.b1;for(r=r.jump,t=e.length,i=0;i<t;i++)if(e[i]===r){n=i;break}}else{if(!(32768&r.b0))return r.b0;r=e[++n]}return-1},cc.Codec.GZip.prototype.DeflateLoop=function(){var e,t,i;do{if(e=this.readBit(),0==(t=this.readBits(2))){var n,r;for(this.byteAlign(),n=this.readByte(),n|=this.readByte()<<8,r=this.readByte(),65535&(n^~(r|=this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");n--;)f=this.readByte(),this.addBuffer(f)}else if(1==t)for(;;)if((o=cc.Codec.GZip.bitReverse[this.readBits(7)]>>1)>23?(o=o<<1|this.readBit())>199?o=(o-=128)<<1|this.readBit():(o-=48)>143&&(o+=136):o+=256,o<256)this.addBuffer(o);else{if(256==o)break;for(o-=257,p=this.readBits(cc.Codec.GZip.cplext[o])+cc.Codec.GZip.cplens[o],o=cc.Codec.GZip.bitReverse[this.readBits(5)]>>3,cc.Codec.GZip.cpdext[o]>8?(_=this.readBits(8),_|=this.readBits(cc.Codec.GZip.cpdext[o]-8)<<8):_=this.readBits(cc.Codec.GZip.cpdext[o]),_+=cc.Codec.GZip.cpdist[o],o=0;o<p;o++){f=this.buf32k[this.bIdx-_&32767];this.addBuffer(f)}}else if(2==t){var o,s,a,c,l,u=new Array(320);for(a=257+this.readBits(5),c=1+this.readBits(5),l=4+this.readBits(4),o=0;o<19;o++)u[o]=0;for(o=0;o<l;o++)u[cc.Codec.GZip.border[o]]=this.readBits(3);for(p=this.distanceTree.length,i=0;i<p;i++)this.distanceTree[i]=new cc.Codec.GZip.HufNode;if(this.CreateTree(this.distanceTree,19,u,0))return this.flushBuffer(),1;s=a+c,i=0;for(;i<s;)if(0,(o=this.DecodeValue(this.distanceTree))<16)u[i++]=o;else if(16==o){var h;if(o=3+this.readBits(2),i+o>s)return this.flushBuffer(),1;for(h=i?u[i-1]:0;o--;)u[i++]=h}else{if(o=17==o?3+this.readBits(3):11+this.readBits(7),i+o>s)return this.flushBuffer(),1;for(;o--;)u[i++]=0}for(p=this.literalTree.length,i=0;i<p;i++)this.literalTree[i]=new cc.Codec.GZip.HufNode;if(this.CreateTree(this.literalTree,a,u,0))return this.flushBuffer(),1;for(p=this.literalTree.length,i=0;i<p;i++)this.distanceTree[i]=new cc.Codec.GZip.HufNode;var d=new Array;for(i=a;i<u.length;i++)d[i-a]=u[i];if(this.CreateTree(this.distanceTree,c,d,0))return this.flushBuffer(),1;for(;;)if((o=this.DecodeValue(this.literalTree))>=256){var p,_;if(0==(o-=256))break;for(o--,p=this.readBits(cc.Codec.GZip.cplext[o])+cc.Codec.GZip.cplens[o],o=this.DecodeValue(this.distanceTree),cc.Codec.GZip.cpdext[o]>8?(_=this.readBits(8),_|=this.readBits(cc.Codec.GZip.cpdext[o]-8)<<8):_=this.readBits(cc.Codec.GZip.cpdext[o]),_+=cc.Codec.GZip.cpdist[o];p--;){var f=this.buf32k[this.bIdx-_&32767];this.addBuffer(f)}}else this.addBuffer(o)}}while(!e);return this.flushBuffer(),this.byteAlign(),0},cc.Codec.GZip.prototype.unzipFile=function(e){var t;for(this.gunzip(),t=0;t<this.unzipped.length;t++)if(this.unzipped[t][1]==e)return this.unzipped[t][0]},cc.Codec.GZip.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var e=[];if(e[0]=this.readByte(),e[1]=this.readByte(),120==e[0]&&218==e[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31==e[0]&&139==e[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80==e[0]&&75==e[1]&&(this.modeZIP=!0,e[2]=this.readByte(),e[3]=this.readByte(),3==e[2]&&4==e[3])){e[0]=this.readByte(),e[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8;var t=this.readByte();t|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte();this.readByte();this.readByte()<<8,this.readByte()<<16,this.readByte()<<24;this.readByte();this.readByte()<<8,this.readByte()<<16,this.readByte()<<24;var i=this.readByte();i|=this.readByte()<<8;var n=this.readByte();for(n|=this.readByte()<<8,o=0,this.nameBuf=[];i--;){var r=this.readByte();"/"==r|":"==r?o=0:o<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[o++]=String.fromCharCode(r))}this.fileout||(this.fileout=this.nameBuf);for(var o=0;o<n;)r=this.readByte(),o++;8==t&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},cc.Codec.GZip.prototype.skipdir=function(){var e,t,i,n,r=[];if(8&this.gpflags&&(r[0]=this.readByte(),r[1]=this.readByte(),r[2]=this.readByte(),r[3]=this.readByte(),e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24,t=this.readByte(),t|=this.readByte()<<8,t|=this.readByte()<<16,t|=this.readByte()<<24),this.modeZIP&&this.nextFile(),r[0]=this.readByte(),8!=r[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(r[0]=this.readByte(),r[2]=this.readByte(),this.len=r[0]+256*r[1],i=0;i<this.len;i++)this.readByte();if(8&this.gpflags)for(i=0,this.nameBuf=[];n=this.readByte();)"7"!=n&&":"!=n||(i=0),i<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[i++]=n);if(16&this.gpflags)for(;n=this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),t=this.readByte(),t|=this.readByte()<<8,t|=this.readByte()<<16,t|=this.readByte()<<24,this.modeZIP&&this.nextFile()},function(){function e(e){throw e}function t(e,t){var i=e.split("."),n=T;!(i[0]in n)&&n.execScript&&n.execScript("var "+i[0]);for(var r;i.length&&(r=i.shift());)i.length||t===g?n=n[r]?n[r]:n[r]={}:n[r]=t}function i(e){if("string"==typeof e){var t,i,n=e.split("");for(t=0,i=n.length;t<i;t++)n[t]=(255&n[t].charCodeAt(0))>>>0;e=n}for(var r,o=1,s=0,a=e.length,c=0;0<a;){a-=r=1024<a?1024:a;do{s+=o+=e[c++]}while(--r);o%=65521,s%=65521}return(s<<16|o)>>>0}function n(t,i){this.index="number"==typeof i?i:0,this.i=0,this.buffer=t instanceof(v?Uint8Array:Array)?t:new(v?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&e(Error("invalid index")),this.buffer.length<=this.index&&this.f()}function r(e){this.buffer=new(v?Uint16Array:Array)(2*e),this.length=0}function o(e){var t,i,n,r,o,s,a,c,l,u=e.length,h=0,d=Number.POSITIVE_INFINITY;for(c=0;c<u;++c)e[c]>h&&(h=e[c]),e[c]<d&&(d=e[c]);for(t=1<<h,i=new(v?Uint32Array:Array)(t),n=1,r=0,o=2;n<=h;){for(c=0;c<u;++c)if(e[c]===n){for(s=0,a=r,l=0;l<n;++l)s=s<<1|1&a,a>>=1;for(l=s;l<t;l+=o)i[l]=n<<16|c;++r}++n,r<<=1,o<<=1}return[i,h,d]}function s(e,t){this.h=I,this.w=0,this.input=e,this.b=0,t&&(t.lazy&&(this.w=t.lazy),"number"==typeof t.compressionType&&(this.h=t.compressionType),t.outputBuffer&&(this.a=v&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.b=t.outputIndex)),this.a||(this.a=new(v?Uint8Array:Array)(32768))}function a(e,t){this.length=e,this.G=t}function c(t,i){function n(t,i){var n,r=t.G,o=[],s=0;n=F[t.length],o[s++]=65535&n,o[s++]=n>>16&255,o[s++]=n>>24;var a;switch(y){case 1===r:a=[0,r-1,0];break;case 2===r:a=[1,r-2,0];break;case 3===r:a=[2,r-3,0];break;case 4===r:a=[3,r-4,0];break;case 6>=r:a=[4,r-5,1];break;case 8>=r:a=[5,r-7,1];break;case 12>=r:a=[6,r-9,2];break;case 16>=r:a=[7,r-13,2];break;case 24>=r:a=[8,r-17,3];break;case 32>=r:a=[9,r-25,3];break;case 48>=r:a=[10,r-33,4];break;case 64>=r:a=[11,r-49,4];break;case 96>=r:a=[12,r-65,5];break;case 128>=r:a=[13,r-97,5];break;case 192>=r:a=[14,r-129,6];break;case 256>=r:a=[15,r-193,6];break;case 384>=r:a=[16,r-257,7];break;case 512>=r:a=[17,r-385,7];break;case 768>=r:a=[18,r-513,8];break;case 1024>=r:a=[19,r-769,8];break;case 1536>=r:a=[20,r-1025,9];break;case 2048>=r:a=[21,r-1537,9];break;case 3072>=r:a=[22,r-2049,10];break;case 4096>=r:a=[23,r-3073,10];break;case 6144>=r:a=[24,r-4097,11];break;case 8192>=r:a=[25,r-6145,11];break;case 12288>=r:a=[26,r-8193,12];break;case 16384>=r:a=[27,r-12289,12];break;case 24576>=r:a=[28,r-16385,13];break;case 32768>=r:a=[29,r-24577,13];break;default:e("invalid distance")}n=a,o[s++]=n[0],o[s++]=n[1],o[s++]=n[2];var c,l;for(c=0,l=o.length;c<l;++c)f[m++]=o[c];S[o[0]]++,C[o[3]]++,T=t.length+i-1,d=null}var r,o,s,c,l,u,h,d,p,_={},f=v?new Uint16Array(2*i.length):[],m=0,T=0,S=new(v?Uint32Array:Array)(286),C=new(v?Uint32Array:Array)(30),E=t.w;if(!v){for(s=0;285>=s;)S[s++]=0;for(s=0;29>=s;)C[s++]=0}for(S[256]=1,r=0,o=i.length;r<o;++r){for(s=l=0,c=3;s<c&&r+s!==o;++s)l=l<<8|i[r+s];if(_[l]===g&&(_[l]=[]),u=_[l],!(0<T--)){for(;0<u.length&&32768<r-u[0];)u.shift();if(r+3>=o){for(d&&n(d,-1),s=0,c=o-r;s<c;++s)p=i[r+s],f[m++]=p,++S[p];break}if(0<u.length){var b=g,A=g,x=0,R=g,P=g,I=g,w=g,N=i.length,P=0,w=u.length;e:for(;P<w;P++){if(b=u[w-P-1],R=3,3<x){for(I=x;3<I;I--)if(i[b+I-1]!==i[r+I-1])continue e;R=x}for(;258>R&&r+R<N&&i[b+R]===i[r+R];)++R;if(R>x&&(A=b,x=R),258===R)break}h=new a(x,r-A),d?d.length<h.length?(p=i[r-1],f[m++]=p,++S[p],n(h,0)):n(d,-1):h.length<E?d=h:n(h,0)}else d?n(d,-1):(p=i[r],f[m++]=p,++S[p])}u.push(r)}return f[m++]=256,S[256]++,t.L=S,t.K=C,v?f.subarray(0,m):f}function l(e,t){function i(e){var t=E[e][b[e]];t===g?(i(e+1),i(e+1)):--S[t],++b[e]}var n,o,s,a,c,l=e.length,u=new r(572),h=new(v?Uint8Array:Array)(l);if(!v)for(a=0;a<l;a++)h[a]=0;for(a=0;a<l;++a)0<e[a]&&u.push(a,e[a]);if(n=Array(u.length/2),o=new(v?Uint32Array:Array)(u.length/2),1===n.length)return h[u.pop().index]=1,h;for(a=0,c=u.length/2;a<c;++a)n[a]=u.pop(),o[a]=n[a].value;var d,p,_,f,m,g=o.length,y=new(v?Uint16Array:Array)(t),T=new(v?Uint8Array:Array)(t),S=new(v?Uint8Array:Array)(g),C=Array(t),E=Array(t),b=Array(t),A=(1<<t)-g,x=1<<t-1;for(y[t-1]=g,p=0;p<t;++p)A<x?T[p]=0:(T[p]=1,A-=x),A<<=1,y[t-2-p]=(y[t-1-p]/2|0)+g;for(y[0]=T[0],C[0]=Array(y[0]),E[0]=Array(y[0]),p=1;p<t;++p)y[p]>2*y[p-1]+T[p]&&(y[p]=2*y[p-1]+T[p]),C[p]=Array(y[p]),E[p]=Array(y[p]);for(d=0;d<g;++d)S[d]=t;for(_=0;_<y[t-1];++_)C[t-1][_]=o[_],E[t-1][_]=_;for(d=0;d<t;++d)b[d]=0;for(1===T[t-1]&&(--S[0],++b[t-1]),p=t-2;0<=p;--p){for(f=d=0,m=b[p+1],_=0;_<y[p];_++)(f=C[p+1][m]+C[p+1][m+1])>o[d]?(C[p][_]=f,E[p][_]=g,m+=2):(C[p][_]=o[d],E[p][_]=d,++d);b[p]=0,1===T[p]&&i(p)}for(s=S,a=0,c=n.length;a<c;++a)h[n[a].index]=s[a];return h}function u(t){var i,n,r,o,s=new(v?Uint16Array:Array)(t.length),a=[],c=[],l=0;for(i=0,n=t.length;i<n;i++)a[t[i]]=1+(0|a[t[i]]);for(i=1,n=16;i<=n;i++)c[i]=l,(l+=0|a[i])>1<<i&&e("overcommitted"),l<<=1;for(65536>l&&e("undercommitted"),i=0,n=t.length;i<n;i++)for(l=c[t[i]],c[t[i]]+=1,r=s[i]=0,o=t[i];r<o;r++)s[i]=s[i]<<1|1&l,l>>>=1;return s}function h(e,t){this.input=e,this.a=new(v?Uint8Array:Array)(32768),this.h=B.j;var i,n={};!t&&(t={})||"number"!=typeof t.compressionType||(this.h=t.compressionType);for(i in t)n[i]=t[i];n.outputBuffer=this.a,this.z=new s(this.input,n)}function d(t,i){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=v?new Uint8Array(t):t,this.s=!1,this.m=k,this.B=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.l=i.bufferSize),i.bufferType&&(this.m=i.bufferType),i.resize&&(this.B=i.resize)),this.m){case M:this.b=32768,this.a=new(v?Uint8Array:Array)(32768+this.l+258);break;case k:this.b=0,this.a=new(v?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:e(Error("invalid inflate mode"))}}function p(t,i){for(var n,r=t.g,o=t.e,s=t.input,a=t.c;o<i;)(n=s[a++])===g&&e(Error("input buffer is broken")),r|=n<<o,o+=8;return n=r&(1<<i)-1,t.g=r>>>i,t.e=o-i,t.c=a,n}function _(t,i){for(var n,r,o,s=t.g,a=t.e,c=t.input,l=t.c,u=i[0],h=i[1];a<h;)(n=c[l++])===g&&e(Error("input buffer is broken")),s|=n<<a,a+=8;return r=u[s&(1<<h)-1],o=r>>>16,t.g=s>>o,t.e=a-o,t.c=l,65535&r}function f(e){function t(e,t,i){var n,r,o,s;for(s=0;s<e;)switch(n=_(this,t)){case 16:for(o=3+p(this,2);o--;)i[s++]=r;break;case 17:for(o=3+p(this,3);o--;)i[s++]=0;r=0;break;case 18:for(o=11+p(this,7);o--;)i[s++]=0;r=0;break;default:r=i[s++]=n}return i}var i,n,r,s,a=p(e,5)+257,c=p(e,5)+1,l=p(e,4)+4,u=new(v?Uint8Array:Array)(U.length);for(s=0;s<l;++s)u[U[s]]=p(e,3);i=o(u),n=new(v?Uint8Array:Array)(a),r=new(v?Uint8Array:Array)(c),e.o(o(t.call(e,a,i,n)),o(t.call(e,c,i,r)))}function m(t,i){var n,r;switch(this.input=t,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify)),n=t[this.c++],r=t[this.c++],15&n){case fe:this.method=fe;break;default:e(Error("unsupported compression method"))}0!=((n<<8)+r)%31&&e(Error("invalid fcheck flag:"+((n<<8)+r)%31)),32&r&&e(Error("fdict flag is not supported")),this.A=new d(t,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}var g=void 0,y=!0,T=this,v=void 0!==Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;n.prototype.f=function(){var e,t=this.buffer,i=t.length,n=new(v?Uint8Array:Array)(i<<1);if(v)n.set(t);else for(e=0;e<i;++e)n[e]=t[e];return this.buffer=n},n.prototype.d=function(e,t,i){var n,r=this.buffer,o=this.index,s=this.i,a=r[o];if(i&&1<t&&(e=8<t?(x[255&e]<<24|x[e>>>8&255]<<16|x[e>>>16&255]<<8|x[e>>>24&255])>>32-t:x[e]>>8-t),8>t+s)a=a<<t|e,s+=t;else for(n=0;n<t;++n)a=a<<1|e>>t-n-1&1,8==++s&&(s=0,r[o++]=x[a],a=0,o===r.length&&(r=this.f()));r[o]=a,this.buffer=r,this.i=s,this.index=o},n.prototype.finish=function(){var e,t=this.buffer,i=this.index;return 0<this.i&&(t[i]<<=8-this.i,t[i]=x[t[i]],i++),v?e=t.subarray(0,i):(t.length=i,e=t),e};var S,C=new(v?Uint8Array:Array)(256);for(S=0;256>S;++S){for(var E=A=S,b=7,A=A>>>1;A;A>>>=1)E<<=1,E|=1&A,--b;C[S]=(E<<b&255)>>>0}var x=C,R=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];v&&new Uint32Array(R),r.prototype.getParent=function(e){return 2*((e-2)/4|0)},r.prototype.push=function(e,t){var i,n,r,o=this.buffer;for(i=this.length,o[this.length++]=t,o[this.length++]=e;0<i&&(n=this.getParent(i),o[i]>o[n]);)r=o[i],o[i]=o[n],o[n]=r,r=o[i+1],o[i+1]=o[n+1],o[n+1]=r,i=n;return this.length},r.prototype.pop=function(){var e,t,i,n,r,o=this.buffer;for(t=o[0],e=o[1],this.length-=2,o[0]=o[this.length],o[1]=o[this.length+1],r=0;!((n=2*r+2)>=this.length)&&(n+2<this.length&&o[n+2]>o[n]&&(n+=2),o[n]>o[r]);)i=o[r],o[r]=o[n],o[n]=i,i=o[r+1],o[r+1]=o[n+1],o[n+1]=i,r=n;return{index:e,value:t,length:this.length}};var P,I=2,w={NONE:0,r:1,j:I,N:3},N=[];for(P=0;288>P;P++)switch(y){case 143>=P:N.push([P+48,8]);break;case 255>=P:N.push([P-144+400,9]);break;case 279>=P:N.push([P-256+0,7]);break;case 287>=P:N.push([P-280+192,8]);break;default:e("invalid literal: "+P)}s.prototype.n=function(){var t,i,r,o,s=this.input;switch(this.h){case 0:for(r=0,o=s.length;r<o;){var a=i=v?s.subarray(r,r+65535):s.slice(r,r+65535),h=(r+=i.length)===o,d=g,p=g,_=g,f=g,m=g,T=this.a,S=this.b;if(v){for(T=new Uint8Array(this.a.buffer);T.length<=S+a.length+5;)T=new Uint8Array(T.length<<1);T.set(this.a)}if(d=h?1:0,T[S++]=0|d,p=a.length,_=65536+~p&65535,T[S++]=255&p,T[S++]=p>>>8&255,T[S++]=255&_,T[S++]=_>>>8&255,v)T.set(a,S),S+=a.length,T=T.subarray(0,S);else{for(f=0,m=a.length;f<m;++f)T[S++]=a[f];T.length=S}this.b=S,this.a=T}break;case 1:var C=new n(new Uint8Array(this.a.buffer),this.b);C.d(1,1,y),C.d(1,2,y);var E,b,A,x=c(this,s);for(E=0,b=x.length;E<b;E++)if(A=x[E],n.prototype.d.apply(C,N[A]),256<A)C.d(x[++E],x[++E],y),C.d(x[++E],5),C.d(x[++E],x[++E],y);else if(256===A)break;this.a=C.finish(),this.b=this.a.length;break;case I:var R,P,w,L,O,D,F,B,M,k,W,V,z,G,U,Y=new n(new Uint8Array(this.a),this.b),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=Array(19);for(R=I,Y.d(1,1,y),Y.d(R,2,y),P=c(this,s),F=u(D=l(this.L,15)),M=u(B=l(this.K,7)),w=286;257<w&&0===D[w-1];w--);for(L=30;1<L&&0===B[L-1];L--);var q,j,K,Q,Z,J,$=w,ee=L,te=new(v?Uint32Array:Array)($+ee),ie=new(v?Uint32Array:Array)(316),ne=new(v?Uint8Array:Array)(19);for(q=j=0;q<$;q++)te[j++]=D[q];for(q=0;q<ee;q++)te[j++]=B[q];if(!v)for(q=0,Q=ne.length;q<Q;++q)ne[q]=0;for(q=Z=0,Q=te.length;q<Q;q+=j){for(j=1;q+j<Q&&te[q+j]===te[q];++j);if(K=j,0===te[q])if(3>K)for(;0<K--;)ie[Z++]=0,ne[0]++;else for(;0<K;)(J=138>K?K:138)>K-3&&J<K&&(J=K-3),10>=J?(ie[Z++]=17,ie[Z++]=J-3,ne[17]++):(ie[Z++]=18,ie[Z++]=J-11,ne[18]++),K-=J;else if(ie[Z++]=te[q],ne[te[q]]++,3>--K)for(;0<K--;)ie[Z++]=te[q],ne[te[q]]++;else for(;0<K;)(J=6>K?K:6)>K-3&&J<K&&(J=K-3),ie[Z++]=16,ie[Z++]=J-3,ne[16]++,K-=J}for(t=v?ie.subarray(0,Z):ie.slice(0,Z),k=l(ne,7),G=0;19>G;G++)X[G]=k[H[G]];for(O=19;4<O&&0===X[O-1];O--);for(W=u(k),Y.d(w-257,5,y),Y.d(L-1,5,y),Y.d(O-4,4,y),G=0;G<O;G++)Y.d(X[G],3,y);for(G=0,U=t.length;G<U;G++)if(V=t[G],Y.d(W[V],k[V],y),16<=V){switch(G++,V){case 16:z=2;break;case 17:z=3;break;case 18:z=7;break;default:e("invalid code: "+V)}Y.d(t[G],z,y)}var re,oe,se,ae,ce,le,ue,he,de=[F,D],pe=[M,B];for(ce=de[0],le=de[1],ue=pe[0],he=pe[1],re=0,oe=P.length;re<oe;++re)if(se=P[re],Y.d(ce[se],le[se],y),256<se)Y.d(P[++re],P[++re],y),ae=P[++re],Y.d(ue[ae],he[ae],y),Y.d(P[++re],P[++re],y);else if(256===se)break;this.a=Y.finish(),this.b=this.a.length;break;default:e("invalid compression type")}return this.a};var L,O,D=[];for(L=3;258>=L;L++)O=function(){var t=L;switch(y){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case 12>=t:return[265,t-11,1];case 14>=t:return[266,t-13,1];case 16>=t:return[267,t-15,1];case 18>=t:return[268,t-17,1];case 22>=t:return[269,t-19,2];case 26>=t:return[270,t-23,2];case 30>=t:return[271,t-27,2];case 34>=t:return[272,t-31,2];case 42>=t:return[273,t-35,3];case 50>=t:return[274,t-43,3];case 58>=t:return[275,t-51,3];case 66>=t:return[276,t-59,3];case 82>=t:return[277,t-67,4];case 98>=t:return[278,t-83,4];case 114>=t:return[279,t-99,4];case 130>=t:return[280,t-115,4];case 162>=t:return[281,t-131,5];case 194>=t:return[282,t-163,5];case 226>=t:return[283,t-195,5];case 257>=t:return[284,t-227,5];case 258===t:return[285,t-258,0];default:e("invalid length: "+t)}}(),D[L]=O[2]<<24|O[1]<<16|O[0];var F=v?new Uint32Array(D):D,B=w;h.prototype.n=function(){var t,n,r,o,s,a,c,l=0;switch(c=this.a,t=fe){case fe:n=Math.LOG2E*Math.log(32768)-8;break;default:e(Error("invalid compression method"))}switch(r=n<<4|t,c[l++]=r,t){case fe:switch(this.h){case B.NONE:s=0;break;case B.r:s=1;break;case B.j:s=2;break;default:e(Error("unsupported compression type"))}break;default:e(Error("invalid compression method"))}return o=s<<6|0,c[l++]=o|31-(256*r+o)%31,a=i(this.input),this.z.b=l,c=this.z.n(),l=c.length,v&&((c=new Uint8Array(c.buffer)).length<=l+4&&(this.a=new Uint8Array(c.length+4),this.a.set(c),c=this.a),c=c.subarray(0,l+4)),c[l++]=a>>24&255,c[l++]=a>>16&255,c[l++]=a>>8&255,c[l++]=255&a,c},t("Zlib.Deflate",h),t("Zlib.Deflate.compress",function(e,t){return new h(e,t).n()}),t("Zlib.Deflate.CompressionType",B),t("Zlib.Deflate.CompressionType.NONE",B.NONE),t("Zlib.Deflate.CompressionType.FIXED",B.r),t("Zlib.Deflate.CompressionType.DYNAMIC",B.j);var M=0,k=1,W={D:M,C:k};d.prototype.p=function(){for(;!this.s;){var t=p(this,3);switch(1&t&&(this.s=y),t>>>=1){case 0:var i=this.input,n=this.c,r=this.a,o=this.b,s=g,a=g,c=g,l=r.length,u=g;switch(this.e=this.g=0,(s=i[n++])===g&&e(Error("invalid uncompressed block header: LEN (first byte)")),a=s,(s=i[n++])===g&&e(Error("invalid uncompressed block header: LEN (second byte)")),a|=s<<8,(s=i[n++])===g&&e(Error("invalid uncompressed block header: NLEN (first byte)")),c=s,(s=i[n++])===g&&e(Error("invalid uncompressed block header: NLEN (second byte)")),c|=s<<8,a===~c&&e(Error("invalid uncompressed block header: length verify")),n+a>i.length&&e(Error("input buffer is broken")),this.m){case M:for(;o+a>r.length;){if(u=l-o,a-=u,v)r.set(i.subarray(n,n+u),o),o+=u,n+=u;else for(;u--;)r[o++]=i[n++];this.b=o,r=this.f(),o=this.b}break;case k:for(;o+a>r.length;)r=this.f({v:2});break;default:e(Error("invalid inflate mode"))}if(v)r.set(i.subarray(n,n+a),o),o+=a,n+=a;else for(;a--;)r[o++]=i[n++];this.c=n,this.b=o,this.a=r;break;case 1:this.o(te,ne);break;case 2:f(this);break;default:e(Error("unknown BTYPE: "+t))}}return this.t()};var V,z,G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=v?new Uint16Array(G):G,Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],H=v?new Uint16Array(Y):Y,X=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],q=v?new Uint8Array(X):X,j=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],K=v?new Uint16Array(j):j,Q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=v?new Uint8Array(Q):Q,J=new(v?Uint8Array:Array)(288);for(V=0,z=J.length;V<z;++V)J[V]=143>=V?8:255>=V?9:279>=V?7:8;var $,ee,te=o(J),ie=new(v?Uint8Array:Array)(30);for($=0,ee=ie.length;$<ee;++$)ie[$]=5;var ne=o(ie);d.prototype.o=function(e,t){var i=this.a,n=this.b;this.u=e;for(var r,o,s,a,c=i.length-258;256!==(r=_(this,e));)if(256>r)n>=c&&(this.b=n,i=this.f(),n=this.b),i[n++]=r;else for(a=H[o=r-257],0<q[o]&&(a+=p(this,q[o])),r=_(this,t),s=K[r],0<Z[r]&&(s+=p(this,Z[r])),n>=c&&(this.b=n,i=this.f(),n=this.b);a--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.I=function(e,t){var i=this.a,n=this.b;this.u=e;for(var r,o,s,a,c=i.length;256!==(r=_(this,e));)if(256>r)n>=c&&(i=this.f(),c=i.length),i[n++]=r;else for(a=H[o=r-257],0<q[o]&&(a+=p(this,q[o])),r=_(this,t),s=K[r],0<Z[r]&&(s+=p(this,Z[r])),n+a>c&&(i=this.f(),c=i.length);a--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.f=function(){var e,t,i=new(v?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.a;if(v)i.set(r.subarray(32768,i.length));else for(e=0,t=i.length;e<t;++e)i[e]=r[e+32768];if(this.k.push(i),this.q+=i.length,v)r.set(r.subarray(n,n+32768));else for(e=0;32768>e;++e)r[e]=r[n+e];return this.b=32768,r},d.prototype.J=function(e){var t,i,n,r,o=this.input.length/this.c+1|0,s=this.input,a=this.a;return e&&("number"==typeof e.v&&(o=e.v),"number"==typeof e.F&&(o+=e.F)),2>o?(i=(s.length-this.c)/this.u[2],r=i/2*258|0,n=r<a.length?a.length+r:a.length<<1):n=a.length*o,v?(t=new Uint8Array(n)).set(a):t=a,this.a=t},d.prototype.t=function(){var e,t,i,n,r,o=0,s=this.a,a=this.k,c=new(v?Uint8Array:Array)(this.q+(this.b-32768));if(0===a.length)return v?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(t=0,i=a.length;t<i;++t)for(n=0,r=(e=a[t]).length;n<r;++n)c[o++]=e[n];for(t=32768,i=this.b;t<i;++t)c[o++]=s[t];return this.k=[],this.buffer=c},d.prototype.H=function(){var e,t=this.b;return v?this.B?(e=new Uint8Array(t)).set(this.a.subarray(0,t)):e=this.a.subarray(0,t):(this.a.length>t&&(this.a.length=t),e=this.a),this.buffer=e},m.prototype.p=function(){var t,n=this.input;return t=this.A.p(),this.c=this.A.c,this.M&&(n[this.c++]<<24|n[this.c++]<<16|n[this.c++]<<8|n[this.c++])>>>0!==i(t)&&e(Error("invalid adler-32 checksum")),t},t("Zlib.Inflate",m),t("Zlib.Inflate.BufferType",W),W.ADAPTIVE=W.C,W.BLOCK=W.D,t("Zlib.Inflate.prototype.decompress",m.prototype.p);var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];v&&new Uint16Array(re);var oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];v&&new Uint16Array(oe);var se=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];v&&new Uint8Array(se);var ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];v&&new Uint16Array(ae);var ce=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];v&&new Uint8Array(ce);var le,ue,he=new(v?Uint8Array:Array)(288);for(le=0,ue=he.length;le<ue;++le)he[le]=143>=le?8:255>=le?9:279>=le?7:8;o(he);var de,pe,_e=new(v?Uint8Array:Array)(30);for(de=0,pe=_e.length;de<pe;++de)_e[de]=5;o(_e);var fe=8}.call(this),(_p=(_p=window).Zlib=_p.Zlib).Deflate=_p.Deflate,_p.Deflate.compress=_p.Deflate.compress,_p.Inflate=_p.Inflate,_p.Inflate.BufferType=_p.Inflate.BufferType,_p.Inflate.prototype.decompress=_p.Inflate.prototype.decompress,cc.PNGReader=cc.Class.extend({ctor:function(e){var t,i,n,r,o,s,a,c,l,u,h,d,p,_;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},o=null;;){switch(t=this.readUInt32(),l=function(){var e,t;for(t=[],s=e=0;e<4;s=++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":o&&this.animation.frames.push(o),this.pos+=4,o={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},r=this.readUInt16(),n=this.readUInt16()||100,o.delay=1e3*r/n,o.disposeOp=this.data[this.pos++],o.blendOp=this.data[this.pos++],o.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,t-=4),e=(null!=o?o.data:void 0)||this.imgData,s=d=0;0<=t?d<t:d>t;s=0<=t?++d:--d)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(t),(u=255-this.transparency.indexed.length)>0)for(s=p=0;0<=u?p<u:p>u;s=0<=u?++p:--p)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":a=(h=this.read(t)).indexOf(0),c=String.fromCharCode.apply(String,h.slice(0,a)),this.text[c]=String.fromCharCode.apply(String,h.slice(a+1));break;case"IEND":return o&&this.animation.frames.push(o),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(_=this.colorType)||6===_,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}},read:function(e){var t,i;for(i=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)i.push(this.data[this.pos++]);return i},readUInt32:function(){var e,t,i,n;return e=this.data[this.pos++]<<24,t=this.data[this.pos++]<<16,i=this.data[this.pos++]<<8,n=this.data[this.pos++],e|t|i|n},readUInt16:function(){var e,t;return e=this.data[this.pos++]<<8,t=this.data[this.pos++],e|t},decodePixels:function(e){var t,i,n,r,o,s,a,c,l,u,h,d,p,_,f,m,g,y,T,v,S,C,E;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);for(e=new Zlib.Inflate(e,{index:0,verify:!1}).decompress(),m=(d=this.pixelBitlength/8)*this.width,p=new Uint8Array(m*this.height),s=e.length,f=0,_=0,i=0;_<s;){switch(e[_++]){case 0:for(r=T=0;T<m;r=T+=1)p[i++]=e[_++];break;case 1:for(r=v=0;v<m;r=v+=1)t=e[_++],o=r<d?0:p[i-d],p[i++]=(t+o)%256;break;case 2:for(r=S=0;S<m;r=S+=1)t=e[_++],n=(r-r%d)/d,g=f&&p[(f-1)*m+n*d+r%d],p[i++]=(g+t)%256;break;case 3:for(r=C=0;C<m;r=C+=1)t=e[_++],n=(r-r%d)/d,o=r<d?0:p[i-d],g=f&&p[(f-1)*m+n*d+r%d],p[i++]=(t+Math.floor((o+g)/2))%256;break;case 4:for(r=E=0;E<m;r=E+=1)t=e[_++],n=(r-r%d)/d,o=r<d?0:p[i-d],0===f?g=y=0:(g=p[(f-1)*m+n*d+r%d],y=n&&p[(f-1)*m+(n-1)*d+r%d]),a=o+g-y,c=Math.abs(a-o),u=Math.abs(a-g),h=Math.abs(a-y),l=c<=u&&c<=h?o:u<=h?g:y,p[i++]=(t+l)%256;break;default:throw new Error("Invalid filter algorithm: "+e[_-1])}f++}return p},copyToImageData:function(e,t){var i,n,r,o,s,a,c,l,u,h,d;if(n=this.colors,u=null,i=this.hasAlphaChannel,this.palette.length&&(u=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),n=4,i=!0),r=e.data||e,l=r.length,s=u||t,o=a=0,1===n)for(;o<l;)c=u?4*t[o/4]:a,h=s[c++],r[o++]=h,r[o++]=h,r[o++]=h,r[o++]=i?s[c++]:255,a=c;else for(;o<l;)c=u?4*t[o/4]:a,r[o++]=s[c++],r[o++]=s[c++],r[o++]=s[c++],r[o++]=i?s[c++]:255,a=c},decodePalette:function(){var e,t,i,n,r,o,s,a,c;for(i=this.palette,o=this.transparency.indexed||[],r=new Uint8Array((o.length||0)+i.length),n=0,e=0,t=s=0,a=i.length;s<a;t=s+=3)r[n++]=i[t],r[n++]=i[t+1],r[n++]=i[t+2],r[n++]=null!=(c=o[e++])?c:255;return r},render:function(e){var t,i;return e.width=this.width,e.height=this.height,t=e.getContext("2d"),i=t.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),t.putImageData(i,0,0)}}),cc.tiffReader={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(e){return this._tiffData[e]},getUint16:function(e){return this._littleEndian?this._tiffData[e+1]<<8|this._tiffData[e]:this._tiffData[e]<<8|this._tiffData[e+1]},getUint32:function(e){var t=this._tiffData;return this._littleEndian?t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]:t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]},checkLittleEndian:function(){var e=this.getUint16(0);if(18761===e)this.littleEndian=!0;else{if(19789!==e)throw console.log(e),TypeError("Invalid byte order value.");this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getUint16(2))throw RangeError("You forgot your towel!");return!0},getFieldTypeName:function(e){var t=this.fieldTypeNames;return e in t?t[e]:null},getFieldTagName:function(e){var t=this.fieldTagNames;return e in t?t[e]:(console.log("Unknown Field Tag:",e),"Tag"+e)},getFieldTypeLength:function(e){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(e)?1:-1!==["SHORT","SSHORT"].indexOf(e)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(e)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(e)?8:null},getFieldValues:function(e,t,i,n){var r=[],o=this.getFieldTypeLength(t);if(o*i<=4)!1===this.littleEndian?r.push(n>>>8*(4-o)):r.push(n);else for(var s=0;s<i;s++){var a=o*s;o>=8?-1!==["RATIONAL","SRATIONAL"].indexOf(t)?(r.push(this.getUint32(n+a)),r.push(this.getUint32(n+a+4))):cc.log("Can't handle this field type or size"):r.push(this.getBytes(o,n+a))}return"ASCII"===t&&r.forEach(function(e,t,i){i[t]=String.fromCharCode(e)}),r},getBytes:function(e,t){if(e<=0)cc.log("No bytes requested");else{if(e<=1)return this.getUint8(t);if(e<=2)return this.getUint16(t);if(e<=3)return this.getUint32(t)>>>8;if(e<=4)return this.getUint32(t);cc.log("Too many bytes requested")}},getBits:function(e,t,i){i=i||0;var n,r,o=t+Math.floor(i/8),s=i+e,a=32-e;return s<=0?console.log("No bits requested"):s<=8?(n=24+i,r=this.getUint8(o)):s<=16?(n=16+i,r=this.getUint16(o)):s<=32?(n=i,r=this.getUint32(o)):console.log("Too many bits requested"),{bits:r<<n>>>a,byteOffset:o+Math.floor(s/8),bitOffset:s%8}},parseFileDirectory:function(e){for(var t=this.getUint16(e),i=[],n=e+2,r=0;r<t;n+=12,r++){var o=this.getUint16(n),s=this.getUint16(n+2),a=this.getUint32(n+4),c=this.getUint32(n+8),l=this.getFieldTagName(o),u=this.getFieldTypeName(s),h=this.getFieldValues(l,u,a,c);i[l]={type:u,values:h}}this._fileDirectories.push(i);var d=this.getUint32(n);0!==d&&this.parseFileDirectory(d)},clampColorSample:function(e,t){var i=Math.pow(2,8-t);return Math.floor(e*i+(i-1))},parseTIFF:function(e,t){if(t=t||cc.newElement("canvas"),this._tiffData=e,this.canvas=t,this.checkLittleEndian(),this.hasTowel()){var i=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(i);var n=this._fileDirectories[0],r=n.ImageWidth.values[0],o=n.ImageLength.values[0];this.canvas.width=r,this.canvas.height=o;var s=[],a=n.Compression?n.Compression.values[0]:1,c=n.SamplesPerPixel.values[0],l=[],u=0,h=!1;if(n.BitsPerSample.values.forEach(function(e,t,i){l[t]={bitsPerSample:e,hasBytesPerSample:!1,bytesPerSample:void 0},e%8==0&&(l[t].hasBytesPerSample=!0,l[t].bytesPerSample=e/8),u+=e},this),u%8==0){h=!0;var d=u/8}var p=n.StripOffsets.values,_=p.length;if(n.StripByteCounts)f=n.StripByteCounts.values;else{if(cc.log("Missing StripByteCounts!"),1!==_)throw Error("Cannot recover from missing StripByteCounts");var f=[Math.ceil(r*o*u/8)]}for(H=0;H<_;H++){var m=p[H];s[H]=[];for(var g=f[H],y=0,T=0,v=1,S=!0,C=[],E=0,b=0,A=0;y<g;y+=v)switch(a){case 1:for(var x=0,C=[];x<c;x++){if(!l[x].hasBytesPerSample){var R=this.getBits(l[x].bitsPerSample,m+y,T);throw C.push(R.bits),y=R.byteOffset-m,T=R.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}var P=l[x].bytesPerSample*x;C.push(this.getBytes(l[x].bytesPerSample,m+y+P))}if(s[H].push(C),!h)throw v=0,RangeError("Cannot handle sub-byte bits per pixel");v=d;break;case 2:case 3:case 4:case 5:case 6:case 7:break;case 32773:if(S){S=!1;var I=1,w=1,N=this.getInt8(m+y);N>=0&&N<=127?I=N+1:N>=-127&&N<=-1?w=1-N:S=!0}else{for(var L=this.getUint8(m+y),x=0;x<w;x++){if(!l[b].hasBytesPerSample)throw RangeError("Cannot handle sub-byte bits per sample");A=A<<8*E|L,++E===l[b].bytesPerSample&&(C.push(A),A=E=0,b++),b===c&&(s[H].push(C),C=[],b=0)}0===--I&&(S=!0)}v=1}}if(t.getContext){var O=this.canvas.getContext("2d");O.fillStyle="rgba(255, 255, 255, 0)";var D=n.RowsPerStrip?n.RowsPerStrip.values[0]:o,F=s.length,B=o%D,M=0===B?D:B,k=D,W=0,V=n.PhotometricInterpretation.values[0],z=[],G=0;if(n.ExtraSamples&&(G=(z=n.ExtraSamples.values).length),n.ColorMap)var U=n.ColorMap.values,Y=Math.pow(2,l[0].bitsPerSample);for(var H=0;H<F;H++){H+1===F&&(k=M);for(var X=s[H].length,q=W*H,j=0,K=0;K<X;j++)for(var Q=0;Q<r;Q++,K++){var Z=s[H][K],J=0,$=0,ee=0,te=1;if(G>0)for(var ie=0;ie<G;ie++)if(1===z[ie]||2===z[ie]){te=Z[3+ie]/256;break}switch(V){case 0:if(l[0].hasBytesPerSample)var ne=Math.pow(16,2*l[0].bytesPerSample);Z.forEach(function(e,t,i){i[t]=ne-e});case 1:J=$=ee=this.clampColorSample(Z[0],l[0].bitsPerSample);break;case 2:J=this.clampColorSample(Z[0],l[0].bitsPerSample),$=this.clampColorSample(Z[1],l[1].bitsPerSample),ee=this.clampColorSample(Z[2],l[2].bitsPerSample);break;case 3:if(void 0===U)throw Error("Palette image missing color map");var re=Z[0];J=this.clampColorSample(U[re],16),$=this.clampColorSample(U[Y+re],16),ee=this.clampColorSample(U[2*Y+re],16);break;default:throw RangeError("Unknown Photometric Interpretation:",V)}O.fillStyle="rgba("+J+", "+$+", "+ee+", "+te+")",O.fillRect(Q,q+j,1,1)}W=k}}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}},cc.Particle=function(e,t,i,n,r,o,s,a,c,l,u,h){this.pos=e||cc.p(0,0),this.startPos=t||cc.p(0,0),this.color=i||{r:0,g:0,b:0,a:255},this.deltaColor=n||{r:0,g:0,b:0,a:255},this.size=r||0,this.deltaSize=o||0,this.rotation=s||0,this.deltaRotation=a||0,this.timeToLive=c||0,this.atlasIndex=l||0,this.modeA=u||new cc.Particle.ModeA,this.modeB=h||new cc.Particle.ModeB,this.isChangeColor=!1,this.drawPos=cc.p(0,0)},cc.Particle.ModeA=function(e,t,i){this.dir=e||cc.p(0,0),this.radialAccel=t||0,this.tangentialAccel=i||0},cc.Particle.ModeB=function(e,t,i,n){this.angle=e||0,this.degreesPerSecond=t||0,this.radius=i||0,this.deltaRadius=n||0},cc.Particle.TemporaryPoints=[cc.p(),cc.p(),cc.p(),cc.p()],cc.ParticleSystem=cc.Node.extend({_className:"ParticleSystem",_plistFile:"",_elapsed:0,_dontTint:!1,modeA:null,modeB:null,_pointZeroForParticle:cc.p(0,0),_particles:null,_emitCounter:0,_particleIdx:0,_batchNode:null,atlasIndex:0,_transformSystemDirty:!1,_allocatedParticles:0,_isActive:!1,particleCount:0,duration:0,_sourcePosition:null,_posVar:null,life:0,lifeVar:0,angle:0,angleVar:0,startSize:0,startSizeVar:0,endSize:0,endSizeVar:0,_startColor:null,_startColorVar:null,_endColor:null,_endColorVar:null,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,emissionRate:0,_totalParticles:0,_texture:null,_blendFunc:null,_opacityModifyRGB:!1,positionType:null,autoRemoveOnFinish:!1,emitterMode:0,_textureLoaded:null,ctor:function(e){if(cc.Node.prototype.ctor.call(this),this.emitterMode=cc.ParticleSystem.MODE_GRAVITY,this.modeA=new cc.ParticleSystem.ModeA,this.modeB=new cc.ParticleSystem.ModeB,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._particles=[],this._sourcePosition=cc.p(0,0),this._posVar=cc.p(0,0),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._endColorVar=cc.color(255,255,255,255),this._plistFile="",this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=cc.p(0,0),this._emitCounter=0,this._particleIdx=0,this._batchNode=null,this.atlasIndex=0,this._transformSystemDirty=!1,this._allocatedParticles=0,this._isActive=!1,this.particleCount=0,this.duration=0,this.life=0,this.lifeVar=0,this.angle=0,this.angleVar=0,this.startSize=0,this.startSizeVar=0,this.endSize=0,this.endSizeVar=0,this.startSpin=0,this.startSpinVar=0,this.endSpin=0,this.endSpinVar=0,this.emissionRate=0,this._totalParticles=0,this._texture=null,this._opacityModifyRGB=!1,this.positionType=cc.ParticleSystem.TYPE_FREE,this.autoRemoveOnFinish=!1,this._textureLoaded=!0,!e||cc.isNumber(e)){var t=e||100;this.setDrawMode(cc.ParticleSystem.TEXTURE_MODE),this.initWithTotalParticles(t)}else e&&this.initWithFile(e)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.ParticleSystem.CanvasRenderCmd(this):new cc.ParticleSystem.WebGLRenderCmd(this)},ignoreColor:function(e){this._dontTint=e},initTexCoordsWithRect:function(e){this._renderCmd.initTexCoordsWithRect(e)},getBatchNode:function(){return this._batchNode},setBatchNode:function(e){this._renderCmd.setBatchNode(e)},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(e){this.atlasIndex=e},getDrawMode:function(){return this._renderCmd.getDrawMode()},setDrawMode:function(e){this._renderCmd.setDrawMode(e)},getShapeType:function(){return this._renderCmd.getShapeType()},setShapeType:function(e){this._renderCmd.setShapeType(e)},isActive:function(){return this._isActive},getParticleCount:function(){return this.particleCount},setParticleCount:function(e){this.particleCount=e},getDuration:function(){return this.duration},setDuration:function(e){this.duration=e},getSourcePosition:function(){return{x:this._sourcePosition.x,y:this._sourcePosition.y}},setSourcePosition:function(e){this._sourcePosition=e},getPosVar:function(){return{x:this._posVar.x,y:this._posVar.y}},setPosVar:function(e){this._posVar=e},getLife:function(){return this.life},setLife:function(e){this.life=e},getLifeVar:function(){return this.lifeVar},setLifeVar:function(e){this.lifeVar=e},getAngle:function(){return this.angle},setAngle:function(e){this.angle=e},getAngleVar:function(){return this.angleVar},setAngleVar:function(e){this.angleVar=e},getGravity:function(){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getGravity() : Particle Mode should be Gravity");var e=this.modeA.gravity;return cc.p(e.x,e.y)},setGravity:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setGravity() : Particle Mode should be Gravity"),this.modeA.gravity=e},getSpeed:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getSpeed() : Particle Mode should be Gravity"),this.modeA.speed},setSpeed:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setSpeed() : Particle Mode should be Gravity"),this.modeA.speed=e},getSpeedVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar},setSpeedVar:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar=e},getTangentialAccel:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel},setTangentialAccel:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel=e},getTangentialAccelVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar},setTangentialAccelVar:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar=e},getRadialAccel:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel},setRadialAccel:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel=e},getRadialAccelVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar},setRadialAccelVar:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar=e},getRotationIsDir:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir},setRotationIsDir:function(e){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir=e},getStartRadius:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius},setStartRadius:function(e){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius=e},getStartRadiusVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar},setStartRadiusVar:function(e){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar=e},getEndRadius:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius},setEndRadius:function(e){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius=e},getEndRadiusVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar},setEndRadiusVar:function(e){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar=e},getRotatePerSecond:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond},setRotatePerSecond:function(e){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond=e},getRotatePerSecondVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar},setRotatePerSecondVar:function(e){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar=e},setScale:function(e,t){this._transformSystemDirty=!0,cc.Node.prototype.setScale.call(this,e,t)},setRotation:function(e){this._transformSystemDirty=!0,cc.Node.prototype.setRotation.call(this,e)},setScaleX:function(e){this._transformSystemDirty=!0,cc.Node.prototype.setScaleX.call(this,e)},setScaleY:function(e){this._transformSystemDirty=!0,cc.Node.prototype.setScaleY.call(this,e)},getStartSize:function(){return this.startSize},setStartSize:function(e){this.startSize=e},getStartSizeVar:function(){return this.startSizeVar},setStartSizeVar:function(e){this.startSizeVar=e},getEndSize:function(){return this.endSize},setEndSize:function(e){this.endSize=e},getEndSizeVar:function(){return this.endSizeVar},setEndSizeVar:function(e){this.endSizeVar=e},getStartColor:function(){return cc.color(this._startColor.r,this._startColor.g,this._startColor.b,this._startColor.a)},setStartColor:function(e){this._startColor=cc.color(e)},getStartColorVar:function(){return cc.color(this._startColorVar.r,this._startColorVar.g,this._startColorVar.b,this._startColorVar.a)},setStartColorVar:function(e){this._startColorVar=cc.color(e)},getEndColor:function(){return cc.color(this._endColor.r,this._endColor.g,this._endColor.b,this._endColor.a)},setEndColor:function(e){this._endColor=cc.color(e)},getEndColorVar:function(){return cc.color(this._endColorVar.r,this._endColorVar.g,this._endColorVar.b,this._endColorVar.a)},setEndColorVar:function(e){this._endColorVar=cc.color(e)},getStartSpin:function(){return this.startSpin},setStartSpin:function(e){this.startSpin=e},getStartSpinVar:function(){return this.startSpinVar},setStartSpinVar:function(e){this.startSpinVar=e},getEndSpin:function(){return this.endSpin},setEndSpin:function(e){this.endSpin=e},getEndSpinVar:function(){return this.endSpinVar},setEndSpinVar:function(e){this.endSpinVar=e},getEmissionRate:function(){return this.emissionRate},setEmissionRate:function(e){this.emissionRate=e},getTotalParticles:function(){return this._totalParticles},setTotalParticles:function(e){this._renderCmd.setTotalParticles(e)},getTexture:function(){return this._texture},setTexture:function(e){e&&(e.isLoaded()?this.setTextureWithRect(e,cc.rect(0,0,e.width,e.height)):(this._textureLoaded=!1,e.addEventListener("load",function(e){this._textureLoaded=!0,this.setTextureWithRect(e,cc.rect(0,0,e.width,e.height))},this)))},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){void 0===t?this._blendFunc!=e&&(this._blendFunc=e,this._updateBlendFunc()):this._blendFunc.src==e&&this._blendFunc.dst==t||(this._blendFunc={src:e,dst:t},this._updateBlendFunc())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(e){this._opacityModifyRGB=e},isBlendAdditive:function(){return this._blendFunc.src==cc.SRC_ALPHA&&this._blendFunc.dst==cc.ONE||this._blendFunc.src==cc.ONE&&this._blendFunc.dst==cc.ONE},setBlendAdditive:function(e){var t=this._blendFunc;e?(t.src=cc.SRC_ALPHA,t.dst=cc.ONE):this._renderCmd._setBlendAdditive()},getPositionType:function(){return this.positionType},setPositionType:function(e){this.positionType=e},isAutoRemoveOnFinish:function(){return this.autoRemoveOnFinish},setAutoRemoveOnFinish:function(e){this.autoRemoveOnFinish=e},getEmitterMode:function(){return this.emitterMode},setEmitterMode:function(e){this.emitterMode=e},init:function(){return this.initWithTotalParticles(150)},initWithFile:function(e){this._plistFile=e;var t=cc.loader.getRes(e);return t?this.initWithDictionary(t,""):(cc.log("cc.ParticleSystem.initWithFile(): Particles: file not found"),!1)},getBoundingBoxToWorld:function(){return cc.rect(0,0,cc._canvas.width,cc._canvas.height)},initWithDictionary:function(e,t){var i=!1,n=null,r=this._valueForKey,o=parseInt(r("maxParticles",e));if(this.initWithTotalParticles(o)){this.angle=parseFloat(r("angle",e)),this.angleVar=parseFloat(r("angleVariance",e)),this.duration=parseFloat(r("duration",e)),this._blendFunc.src=parseInt(r("blendFuncSource",e)),this._blendFunc.dst=parseInt(r("blendFuncDestination",e));var s=this._startColor;s.r=255*parseFloat(r("startColorRed",e)),s.g=255*parseFloat(r("startColorGreen",e)),s.b=255*parseFloat(r("startColorBlue",e)),s.a=255*parseFloat(r("startColorAlpha",e));var a=this._startColorVar;a.r=255*parseFloat(r("startColorVarianceRed",e)),a.g=255*parseFloat(r("startColorVarianceGreen",e)),a.b=255*parseFloat(r("startColorVarianceBlue",e)),a.a=255*parseFloat(r("startColorVarianceAlpha",e));var c=this._endColor;c.r=255*parseFloat(r("finishColorRed",e)),c.g=255*parseFloat(r("finishColorGreen",e)),c.b=255*parseFloat(r("finishColorBlue",e)),c.a=255*parseFloat(r("finishColorAlpha",e));var l=this._endColorVar;if(l.r=255*parseFloat(r("finishColorVarianceRed",e)),l.g=255*parseFloat(r("finishColorVarianceGreen",e)),l.b=255*parseFloat(r("finishColorVarianceBlue",e)),l.a=255*parseFloat(r("finishColorVarianceAlpha",e)),this.startSize=parseFloat(r("startParticleSize",e)),this.startSizeVar=parseFloat(r("startParticleSizeVariance",e)),this.endSize=parseFloat(r("finishParticleSize",e)),this.endSizeVar=parseFloat(r("finishParticleSizeVariance",e)),this.setPosition(parseFloat(r("sourcePositionx",e)),parseFloat(r("sourcePositiony",e))),this._posVar.x=parseFloat(r("sourcePositionVariancex",e)),this._posVar.y=parseFloat(r("sourcePositionVariancey",e)),this.startSpin=parseFloat(r("rotationStart",e)),this.startSpinVar=parseFloat(r("rotationStartVariance",e)),this.endSpin=parseFloat(r("rotationEnd",e)),this.endSpinVar=parseFloat(r("rotationEndVariance",e)),this.emitterMode=parseInt(r("emitterType",e)),this.emitterMode==cc.ParticleSystem.MODE_GRAVITY){var u=this.modeA;u.gravity.x=parseFloat(r("gravityx",e)),u.gravity.y=parseFloat(r("gravityy",e)),u.speed=parseFloat(r("speed",e)),u.speedVar=parseFloat(r("speedVariance",e));var h=r("radialAcceleration",e);u.radialAccel=h?parseFloat(h):0,h=r("radialAccelVariance",e),u.radialAccelVar=h?parseFloat(h):0,h=r("tangentialAcceleration",e),u.tangentialAccel=h?parseFloat(h):0,h=r("tangentialAccelVariance",e),u.tangentialAccelVar=h?parseFloat(h):0;var d=r("rotationIsDir",e).toLowerCase();u.rotationIsDir=null!=d&&("true"===d||"1"===d)}else{if(this.emitterMode!=cc.ParticleSystem.MODE_RADIUS)return cc.log("cc.ParticleSystem.initWithDictionary(): Invalid emitterType in config file"),!1;var p=this.modeB;p.startRadius=parseFloat(r("maxRadius",e)),p.startRadiusVar=parseFloat(r("maxRadiusVariance",e)),p.endRadius=parseFloat(r("minRadius",e)),p.endRadiusVar=0,p.rotatePerSecond=parseFloat(r("rotatePerSecond",e)),p.rotatePerSecondVar=parseFloat(r("rotatePerSecondVariance",e))}if(this.life=parseFloat(r("particleLifespan",e)),this.lifeVar=parseFloat(r("particleLifespanVariance",e)),this.emissionRate=this._totalParticles/this.life,!this._batchNode){this._opacityModifyRGB=!1;var _=r("textureFileName",e),f=cc.path.changeBasename(this._plistFile,_),m=cc.textureCache.getTextureForKey(f);if(m)this.setTexture(m);else{var g=r("textureImageData",e);if(g&&0!==g.length){if(!(n=cc.unzipBase64AsArray(g,1)))return cc.log("cc.ParticleSystem: error decoding or ungzipping textureImageData"),!1;var y=cc.getImageFormatByData(n);if(y!==cc.FMT_TIFF&&y!==cc.FMT_PNG)return cc.log("cc.ParticleSystem: unknown image format with Data"),!1;var T=cc.newElement("canvas");y===cc.FMT_PNG?new cc.PNGReader(n).render(T):cc.tiffReader.parseTIFF(n,T),cc.textureCache.cacheImage(f,T);var v=cc.textureCache.getTextureForKey(f);v||cc.log("cc.ParticleSystem.initWithDictionary() : error loading the texture"),this.setTexture(v)}else{if(!(m=cc.textureCache.addImage(f)))return!1;this.setTexture(m)}}}i=!0}return i},initWithTotalParticles:function(e){this._totalParticles=e;var t,i=this._particles;for(i.length=0,t=0;t<e;t++)i[t]=new cc.Particle;if(!i)return cc.log("Particle system: not enough memory"),!1;if(this._allocatedParticles=e,this._batchNode)for(t=0;t<this._totalParticles;t++)i[t].atlasIndex=t;return this._isActive=!0,this._blendFunc.src=cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this.positionType=cc.ParticleSystem.TYPE_FREE,this.emitterMode=cc.ParticleSystem.MODE_GRAVITY,this.autoRemoveOnFinish=!1,this._transformSystemDirty=!1,this.scheduleUpdateWithPriority(1),this._renderCmd._initWithTotalParticles(e),!0},destroyParticleSystem:function(){this.unscheduleUpdate()},addParticle:function(){if(this.isFull())return!1;var e=this._renderCmd.addParticle();return this.initParticle(e),++this.particleCount,!0},initParticle:function(e){var t=cc.randomMinus1To1;e.timeToLive=this.life+this.lifeVar*t(),e.timeToLive=Math.max(0,e.timeToLive),e.pos.x=this._sourcePosition.x+this._posVar.x*t(),e.pos.y=this._sourcePosition.y+this._posVar.y*t();var i,n,r=this._startColor,o=this._startColorVar,s=this._endColor,a=this._endColorVar;i={r:cc.clampf(r.r+o.r*t(),0,255),g:cc.clampf(r.g+o.g*t(),0,255),b:cc.clampf(r.b+o.b*t(),0,255),a:cc.clampf(r.a+o.a*t(),0,255)},n={r:cc.clampf(s.r+a.r*t(),0,255),g:cc.clampf(s.g+a.g*t(),0,255),b:cc.clampf(s.b+a.b*t(),0,255),a:cc.clampf(s.a+a.a*t(),0,255)},e.color=i;var c=e.deltaColor,l=e.timeToLive;c.r=(n.r-i.r)/l,c.g=(n.g-i.g)/l,c.b=(n.b-i.b)/l,c.a=(n.a-i.a)/l;var u=this.startSize+this.startSizeVar*t();if(u=Math.max(0,u),e.size=u,this.endSize===cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE)e.deltaSize=0;else{var h=this.endSize+this.endSizeVar*t();h=Math.max(0,h),e.deltaSize=(h-u)/l}var d=this.startSpin+this.startSpinVar*t(),p=this.endSpin+this.endSpinVar*t();e.rotation=d,e.deltaRotation=(p-d)/l,this.positionType==cc.ParticleSystem.TYPE_FREE?e.startPos=this.convertToWorldSpace(this._pointZeroForParticle):this.positionType==cc.ParticleSystem.TYPE_RELATIVE&&(e.startPos.x=this._position.x,e.startPos.y=this._position.y);var _=cc.degreesToRadians(this.angle+this.angleVar*t());if(this.emitterMode===cc.ParticleSystem.MODE_GRAVITY){var f=this.modeA,m=e.modeA,g=f.speed+f.speedVar*t();m.dir.x=Math.cos(_),m.dir.y=Math.sin(_),cc.pMultIn(m.dir,g),m.radialAccel=f.radialAccel+f.radialAccelVar*t(),m.tangentialAccel=f.tangentialAccel+f.tangentialAccelVar*t(),f.rotationIsDir&&(e.rotation=-cc.radiansToDegrees(cc.pToAngle(m.dir)))}else{var y=this.modeB,T=e.modeB,v=y.startRadius+y.startRadiusVar*t(),S=y.endRadius+y.endRadiusVar*t();T.radius=v,T.deltaRadius=y.endRadius===cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(S-v)/l,T.angle=_,T.degreesPerSecond=cc.degreesToRadians(y.rotatePerSecond+y.rotatePerSecondVar*t())}},stopSystem:function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},resetSystem:function(){this._isActive=!0,this._elapsed=0;var e=this._particles;for(this._particleIdx=0;this._particleIdx<this.particleCount;++this._particleIdx)e[this._particleIdx].timeToLive=0},isFull:function(){return this.particleCount>=this._totalParticles},updateQuadWithParticle:function(e,t){this._renderCmd.updateQuadWithParticle(e,t)},postStep:function(){this._renderCmd.postStep()},update:function(e){if(this._isActive&&this.emissionRate){var t=1/this.emissionRate;for(this.particleCount<this._totalParticles&&(this._emitCounter+=e);this.particleCount<this._totalParticles&&this._emitCounter>t;)this.addParticle(),this._emitCounter-=t;this._elapsed+=e,-1!=this.duration&&this.duration<this._elapsed&&this.stopSystem()}this._particleIdx=0;var i=cc.Particle.TemporaryPoints[0];if(this.positionType==cc.ParticleSystem.TYPE_FREE?cc.pIn(i,this.convertToWorldSpace(this._pointZeroForParticle)):this.positionType==cc.ParticleSystem.TYPE_RELATIVE&&(i.x=this._position.x,i.y=this._position.y),this._visible){for(var n=cc.Particle.TemporaryPoints[1],r=cc.Particle.TemporaryPoints[2],o=cc.Particle.TemporaryPoints[3],s=this._particles;this._particleIdx<this.particleCount;){cc.pZeroIn(n),cc.pZeroIn(r),cc.pZeroIn(o);var a=s[this._particleIdx];if(a.timeToLive-=e,a.timeToLive>0){if(this.emitterMode==cc.ParticleSystem.MODE_GRAVITY){var c=o,l=n,u=r;a.pos.x||a.pos.y?(cc.pIn(l,a.pos),cc.pNormalizeIn(l)):cc.pZeroIn(l),cc.pIn(u,l),cc.pMultIn(l,a.modeA.radialAccel);var h=u.x;u.x=-u.y,u.y=h,cc.pMultIn(u,a.modeA.tangentialAccel),cc.pIn(c,l),cc.pAddIn(c,u),cc.pAddIn(c,this.modeA.gravity),cc.pMultIn(c,e),cc.pAddIn(a.modeA.dir,c),cc.pIn(c,a.modeA.dir),cc.pMultIn(c,e),cc.pAddIn(a.pos,c)}else{var d=a.modeB;d.angle+=d.degreesPerSecond*e,d.radius+=d.deltaRadius*e,a.pos.x=-Math.cos(d.angle)*d.radius,a.pos.y=-Math.sin(d.angle)*d.radius}this._renderCmd._updateDeltaColor(a,e),a.size+=a.deltaSize*e,a.size=Math.max(0,a.size),a.rotation+=a.deltaRotation*e;var p=n;if(this.positionType==cc.ParticleSystem.TYPE_FREE||this.positionType==cc.ParticleSystem.TYPE_RELATIVE){var _=r;cc.pIn(_,i),cc.pSubIn(_,a.startPos),cc.pIn(p,a.pos),cc.pSubIn(p,_)}else cc.pIn(p,a.pos);this._batchNode&&(p.x+=this._position.x,p.y+=this._position.y),this._renderCmd.updateParticlePosition(a,p),++this._particleIdx}else{var f=a.atlasIndex;if(this._particleIdx!==this.particleCount-1){var m=s[this._particleIdx];s[this._particleIdx]=s[this.particleCount-1],s[this.particleCount-1]=m}if(this._batchNode&&(this._batchNode.disableParticle(this.atlasIndex+f),s[this.particleCount-1].atlasIndex=f),0==--this.particleCount&&this.autoRemoveOnFinish)return this.unscheduleUpdate(),void this._parent.removeChild(this,!0)}}this._transformSystemDirty=!1}this._batchNode||this.postStep()},updateWithNoTime:function(){this.update(0)},_valueForKey:function(e,t){if(t){var i=t[e];return null!=i?i:""}return""},_updateBlendFunc:function(){if(this._batchNode)cc.log("Can't change blending functions when the particle is being batched");else{var e=this._texture;if(e&&e instanceof cc.Texture2D){this._opacityModifyRGB=!1;var t=this._blendFunc;t.src==cc.BLEND_SRC&&t.dst==cc.BLEND_DST&&(e.hasPremultipliedAlpha()?this._opacityModifyRGB=!0:(t.src=cc.SRC_ALPHA,t.dst=cc.ONE_MINUS_SRC_ALPHA))}}},clone:function(){var e=new cc.ParticleSystem;if(e.initWithTotalParticles(this.getTotalParticles())){e.setAngle(this.getAngle()),e.setAngleVar(this.getAngleVar()),e.setDuration(this.getDuration());var t=this.getBlendFunc();if(e.setBlendFunc(t.src,t.dst),e.setStartColor(this.getStartColor()),e.setStartColorVar(this.getStartColorVar()),e.setEndColor(this.getEndColor()),e.setEndColorVar(this.getEndColorVar()),e.setStartSize(this.getStartSize()),e.setStartSizeVar(this.getStartSizeVar()),e.setEndSize(this.getEndSize()),e.setEndSizeVar(this.getEndSizeVar()),e.setPosition(cc.p(this.x,this.y)),e.setPosVar(cc.p(this.getPosVar().x,this.getPosVar().y)),e.setStartSpin(this.getStartSpin()||0),e.setStartSpinVar(this.getStartSpinVar()||0),e.setEndSpin(this.getEndSpin()||0),e.setEndSpinVar(this.getEndSpinVar()||0),e.setEmitterMode(this.getEmitterMode()),this.getEmitterMode()==cc.ParticleSystem.MODE_GRAVITY){var i=this.getGravity();e.setGravity(cc.p(i.x,i.y)),e.setSpeed(this.getSpeed()),e.setSpeedVar(this.getSpeedVar()),e.setRadialAccel(this.getRadialAccel()),e.setRadialAccelVar(this.getRadialAccelVar()),e.setTangentialAccel(this.getTangentialAccel()),e.setTangentialAccelVar(this.getTangentialAccelVar())}else this.getEmitterMode()==cc.ParticleSystem.MODE_RADIUS&&(e.setStartRadius(this.getStartRadius()),e.setStartRadiusVar(this.getStartRadiusVar()),e.setEndRadius(this.getEndRadius()),e.setEndRadiusVar(this.getEndRadiusVar()),e.setRotatePerSecond(this.getRotatePerSecond()),e.setRotatePerSecondVar(this.getRotatePerSecondVar()));if(e.setLife(this.getLife()),e.setLifeVar(this.getLifeVar()),e.setEmissionRate(this.getEmissionRate()),!this.getBatchNode()){e.setOpacityModifyRGB(this.isOpacityModifyRGB());var n=this.getTexture();if(n){var r=n.getContentSize();e.setTextureWithRect(n,cc.rect(0,0,r.width,r.height))}}}return e},setDisplayFrame:function(e){if(e){var t=e.getOffsetInPixels();0==t.x&&0==t.y||cc.log("cc.ParticleSystem.setDisplayFrame(): QuadParticle only supports SpriteFrames with no offsets");var i=e.getTexture();this._texture!=i&&this.setTexture(i)}},setTextureWithRect:function(e,t){this._texture!=e&&(this._texture=e,this._updateBlendFunc()),this.initTexCoordsWithRect(t)},listenBackToForeground:function(e){}}),(_p=cc.ParticleSystem.prototype).opacityModifyRGB,cc.defineGetterSetter(_p,"opacityModifyRGB",_p.isOpacityModifyRGB,_p.setOpacityModifyRGB),_p.batchNode,cc.defineGetterSetter(_p,"batchNode",_p.getBatchNode,_p.setBatchNode),_p.drawMode,cc.defineGetterSetter(_p,"drawMode",_p.getDrawMode,_p.setDrawMode),_p.shapeType,cc.defineGetterSetter(_p,"shapeType",_p.getShapeType,_p.setShapeType),_p.active,cc.defineGetterSetter(_p,"active",_p.isActive),_p.sourcePos,cc.defineGetterSetter(_p,"sourcePos",_p.getSourcePosition,_p.setSourcePosition),_p.posVar,cc.defineGetterSetter(_p,"posVar",_p.getPosVar,_p.setPosVar),_p.gravity,cc.defineGetterSetter(_p,"gravity",_p.getGravity,_p.setGravity),_p.speed,cc.defineGetterSetter(_p,"speed",_p.getSpeed,_p.setSpeed),_p.speedVar,cc.defineGetterSetter(_p,"speedVar",_p.getSpeedVar,_p.setSpeedVar),_p.tangentialAccel,cc.defineGetterSetter(_p,"tangentialAccel",_p.getTangentialAccel,_p.setTangentialAccel),_p.tangentialAccelVar,cc.defineGetterSetter(_p,"tangentialAccelVar",_p.getTangentialAccelVar,_p.setTangentialAccelVar),_p.radialAccel,cc.defineGetterSetter(_p,"radialAccel",_p.getRadialAccel,_p.setRadialAccel),_p.radialAccelVar,cc.defineGetterSetter(_p,"radialAccelVar",_p.getRadialAccelVar,_p.setRadialAccelVar),_p.rotationIsDir,cc.defineGetterSetter(_p,"rotationIsDir",_p.getRotationIsDir,_p.setRotationIsDir),_p.startRadius,cc.defineGetterSetter(_p,"startRadius",_p.getStartRadius,_p.setStartRadius),_p.startRadiusVar,cc.defineGetterSetter(_p,"startRadiusVar",_p.getStartRadiusVar,_p.setStartRadiusVar),_p.endRadius,cc.defineGetterSetter(_p,"endRadius",_p.getEndRadius,_p.setEndRadius),_p.endRadiusVar,cc.defineGetterSetter(_p,"endRadiusVar",_p.getEndRadiusVar,_p.setEndRadiusVar),_p.rotatePerS,cc.defineGetterSetter(_p,"rotatePerS",_p.getRotatePerSecond,_p.setRotatePerSecond),_p.rotatePerSVar,cc.defineGetterSetter(_p,"rotatePerSVar",_p.getRotatePerSecondVar,_p.setRotatePerSecondVar),_p.startColor,cc.defineGetterSetter(_p,"startColor",_p.getStartColor,_p.setStartColor),_p.startColorVar,cc.defineGetterSetter(_p,"startColorVar",_p.getStartColorVar,_p.setStartColorVar),_p.endColor,cc.defineGetterSetter(_p,"endColor",_p.getEndColor,_p.setEndColor),_p.endColorVar,cc.defineGetterSetter(_p,"endColorVar",_p.getEndColorVar,_p.setEndColorVar),_p.totalParticles,cc.defineGetterSetter(_p,"totalParticles",_p.getTotalParticles,_p.setTotalParticles),_p.texture,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.ParticleSystem.create=function(e){return new cc.ParticleSystem(e)},cc.ParticleSystem.createWithTotalParticles=cc.ParticleSystem.create,cc.ParticleSystem.ModeA=function(e,t,i,n,r,o,s,a){this.gravity=e||cc.p(0,0),this.speed=t||0,this.speedVar=i||0,this.tangentialAccel=n||0,this.tangentialAccelVar=r||0,this.radialAccel=o||0,this.radialAccelVar=s||0,this.rotationIsDir=a||!1},cc.ParticleSystem.ModeB=function(e,t,i,n,r,o){this.startRadius=e||0,this.startRadiusVar=t||0,this.endRadius=i||0,this.endRadiusVar=n||0,this.rotatePerSecond=r||0,this.rotatePerSecondVar=o||0},cc.ParticleSystem.SHAPE_MODE=0,cc.ParticleSystem.TEXTURE_MODE=1,cc.ParticleSystem.STAR_SHAPE=0,cc.ParticleSystem.BALL_SHAPE=1,cc.ParticleSystem.DURATION_INFINITY=-1,cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE=-1,cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS=-1,cc.ParticleSystem.MODE_GRAVITY=0,cc.ParticleSystem.MODE_RADIUS=1,cc.ParticleSystem.TYPE_FREE=0,cc.ParticleSystem.TYPE_RELATIVE=1,cc.ParticleSystem.TYPE_GROUPED=2,function(){cc.ParticleSystem.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._drawMode=cc.ParticleSystem.SHAPE_MODE,this._shapeType=cc.ParticleSystem.BALL_SHAPE,this._pointRect=cc.rect(0,0,0,0)};var e=cc.ParticleSystem.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.ParticleSystem.CanvasRenderCmd,e.getDrawMode=function(){return this._drawMode},e.setDrawMode=function(e){this._drawMode=e},e.getShapeType=function(){return this._shapeType},e.setShapeType=function(e){this._shapeType=e},e.setBatchNode=function(e){this._batchNode!=e&&(this._node._batchNode=e)},e.updateQuadWithParticle=function(e,t){},e.updateParticlePosition=function(e,t){cc.pIn(e.drawPos,t)},e.rendering=function(e,t,i){var n=e||cc._renderContext,r=n.getContext(),o=this._node,s=this._pointRect;n.setTransform(this._worldTransform,t,i),n.save(),o.isBlendAdditive()?r.globalCompositeOperation="lighter":r.globalCompositeOperation="source-over";var a,c,l,u,h=this._node.particleCount,d=this._node._particles;if(o.drawMode==cc.ParticleSystem.TEXTURE_MODE){if(!o._texture||!o._texture._textureLoaded)return void n.restore();var p=o._texture.getHtmlElementObj();if(!p.width||!p.height)return void n.restore();var _=p;for(a=0;a<h;a++)if(c=d[a],l=0|.5*c.size,0!==(u=c.color.a/255)){r.globalAlpha=u,r.save(),r.translate(0|c.drawPos.x,-(0|c.drawPos.y));var f=4*Math.floor(c.size/4),m=s.width,g=s.height;r.scale(Math.max(1/m*f,1e-6),Math.max(1/g*f,1e-6)),c.rotation&&r.rotate(cc.degreesToRadians(c.rotation)),_=c.isChangeColor?this._changeTextureColor(p,c.color,this._pointRect):p,r.drawImage(_,-(0|m/2),-(0|g/2)),r.restore()}}else{var y=cc._drawingUtil;for(a=0;a<h;a++)l=0|.5*(c=d[a]).size,0!==(u=c.color.a/255)&&(r.globalAlpha=u,r.save(),r.translate(0|c.drawPos.x,-(0|c.drawPos.y)),o.shapeType==cc.ParticleSystem.STAR_SHAPE?(c.rotation&&r.rotate(cc.degreesToRadians(c.rotation)),y.drawStar(n,l,c.color)):y.drawColorBall(n,l,c.color),r.restore())}n.restore(),cc.g_NumberOfDraws++},cc.sys._supportCanvasNewBlendModes?e._changeTextureColor=function(e,t,i){return e.tintCache||(e.tintCache=document.createElement("canvas"),e.tintCache.width=e.width,e.tintCache.height=e.height),cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(e,t,i,e.tintCache)}:e._changeTextureColor=function(e,t,i){var n=cc.textureCache.getTextureColors(e);return n?(n.tintCache||(n.tintCache=document.createElement("canvas"),n.tintCache.width=e.width,n.tintCache.height=e.height),cc.Sprite.CanvasRenderCmd._generateTintImage(e,n,t,i,n.tintCache),n.tintCache):null},e.initTexCoordsWithRect=function(e){this._pointRect=e},e.setTotalParticles=function(e){this._node._totalParticles=e<200?e:200},e.addParticle=function(){var e,t=this._node,i=t._particles;return t.particleCount<i.length?e=i[t.particleCount]:(e=new cc.Particle,i.push(e)),e},e._setupVBO=function(){},e._allocMemory=function(){return!0},e.postStep=function(){},e._setBlendAdditive=function(){var e=this._node._blendFunc;e.src=cc.BLEND_SRC,e.dst=cc.BLEND_DST},e._initWithTotalParticles=function(e){},e._updateDeltaColor=function(e,t){this._dontTint||(e.color.r+=e.deltaColor.r*t,e.color.g+=e.deltaColor.g*t,e.color.b+=e.deltaColor.b*t,e.color.a+=e.deltaColor.a*t,e.isChangeColor=!0)}}(),function(){cc.ParticleSystem.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._buffersVBO=[0,0],this._quads=[],this._indices=[],this._quadsArrayBuffer=null};var e=cc.ParticleSystem.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.ParticleSystem.CanvasRenderCmd,e.getDrawMode=function(){},e.setDrawMode=function(e){},e.getShapeType=function(){},e.setShapeType=function(e){},e.setBatchNode=function(e){var t=this._node;if(t._batchNode!=e){var i=t._batchNode;if(t._batchNode=e,e)for(var n=t._particles,r=0;r<t._totalParticles;r++)n[r].atlasIndex=r;e?i||(t._batchNode.textureAtlas._copyQuadsToTextureAtlas(this._quads,t.atlasIndex),cc._renderContext.deleteBuffer(this._buffersVBO[1])):(this._allocMemory(),this.initIndices(t._totalParticles),t.setTexture(i.getTexture()),this._setupVBO())}},e.initIndices=function(e){for(var t=this._indices,i=0,n=e;i<n;++i){var r=6*i,o=4*i;t[r+0]=o+0,t[r+1]=o+1,t[r+2]=o+2,t[r+5]=o+1,t[r+4]=o+2,t[r+3]=o+3}},e.isDifferentTexture=function(e,t){if(e==t)return!0},e.updateParticlePosition=function(e,t){this.updateQuadWithParticle(e,t)},e.updateQuadWithParticle=function(e,t){var i=null,n=this._node;n._batchNode?(i=n._batchNode.textureAtlas.quads[n.atlasIndex+e.atlasIndex],n._batchNode.textureAtlas.dirty=!0):i=this._quads[n._particleIdx];var r,o,s,a;n._opacityModifyRGB?(r=0|e.color.r*e.color.a/255,o=0|e.color.g*e.color.a/255,s=0|e.color.b*e.color.a/255):(r=0|e.color.r,o=0|e.color.g,s=0|e.color.b),a=0|e.color.a;var c=i.bl.colors,l=i.br.colors,u=i.tl.colors,h=i.tr.colors;c.r=l.r=u.r=h.r=r,c.g=l.g=u.g=h.g=o,c.b=l.b=u.b=h.b=s,c.a=l.a=u.a=h.a=a;var d=e.size/2;if(e.rotation){var p=-d,_=-d,f=d,m=d,g=t.x,y=t.y,T=-cc.degreesToRadians(e.rotation),v=Math.cos(T),S=Math.sin(T),C=p*v-_*S+g,E=p*S+_*v+y,b=f*v-_*S+g,A=f*S+_*v+y,x=f*v-m*S+g,R=f*S+m*v+y,P=p*v-m*S+g,I=p*S+m*v+y;i.bl.vertices.x=C,i.bl.vertices.y=E,i.br.vertices.x=b,i.br.vertices.y=A,i.tl.vertices.x=P,i.tl.vertices.y=I,i.tr.vertices.x=x,i.tr.vertices.y=R}else i.bl.vertices.x=t.x-d,i.bl.vertices.y=t.y-d,i.br.vertices.x=t.x+d,i.br.vertices.y=t.y-d,i.tl.vertices.x=t.x-d,i.tl.vertices.y=t.y+d,i.tr.vertices.x=t.x+d,i.tr.vertices.y=t.y+d},e.rendering=function(e){var t=this._node;if(t._texture){var i=e||cc._renderContext;this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glBindTexture2D(t._texture),cc.glBlendFuncForParticle(t._blendFunc.src,t._blendFunc.dst),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),i.bindBuffer(i.ARRAY_BUFFER,this._buffersVBO[0]),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,24,0),i.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,24,12),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,24,16),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),i.drawElements(i.TRIANGLES,6*t._particleIdx,i.UNSIGNED_SHORT,0)}},e.initTexCoordsWithRect=function(e){var t=this._node,i=t.texture,n=cc.contentScaleFactor(),r=cc.rect(e.x*n,e.y*n,e.width*n,e.height*n),o=e.width,s=e.height;i&&(o=i.pixelsWidth,s=i.pixelsHeight);var a,c,l,u;cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(a=(2*r.x+1)/(2*o),c=(2*r.y+1)/(2*s),l=a+(2*r.width-2)/(2*o),u=c+(2*r.height-2)/(2*s)):(a=r.x/o,c=r.y/s,l=a+r.width/o,u=c+r.height/s);var h=u;u=c,c=h;var d,p=0,_=0;t._batchNode?(d=t._batchNode.textureAtlas.quads,p=t.atlasIndex,_=t.atlasIndex+t._totalParticles):(d=this._quads,p=0,_=t._totalParticles);for(var f=p;f<_;f++){d[f]||(d[f]=cc.V3F_C4B_T2F_QuadZero());var m=d[f];m.bl.texCoords.u=a,m.bl.texCoords.v=c,m.br.texCoords.u=l,m.br.texCoords.v=c,m.tl.texCoords.u=a,m.tl.texCoords.v=u,m.tr.texCoords.u=l,m.tr.texCoords.v=u}},e.setTotalParticles=function(e){var t=this._node;if(e>t._allocatedParticles){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._indices=new Uint16Array(6*e);var n=new ArrayBuffer(e*i),r=t._particles;r.length=0;var o=this._quads;o.length=0;for(var s=0;s<e;s++)r[s]=new cc.Particle,o[s]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,n,s*i);if(t._allocatedParticles=e,t._totalParticles=e,t._batchNode)for(var a=0;a<e;a++)r[a].atlasIndex=a;this._quadsArrayBuffer=n,this.initIndices(e),this._setupVBO(),t._texture&&this.initTexCoordsWithRect(cc.rect(0,0,t._texture.width,t._texture.height))}else t._totalParticles=e;t.resetSystem()},e.addParticle=function(){var e=this._node;return e._particles[e.particleCount]},e._setupVBO=function(){var e=cc._renderContext;this._buffersVBO[0]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._buffersVBO[0]),e.bufferData(e.ARRAY_BUFFER,this._quadsArrayBuffer,e.DYNAMIC_DRAW),this._buffersVBO[1]=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW)},e._allocMemory=function(){var e=this._node;if(e._batchNode)return cc.log("cc.ParticleSystem._allocMemory(): Memory should not be allocated when not using batchNode"),!1;var t=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=e._totalParticles,n=this._quads;n.length=0,this._indices=new Uint16Array(6*i);for(var r=new ArrayBuffer(t*i),o=0;o<i;o++)n[o]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,r,o*t);return n&&this._indices?(this._quadsArrayBuffer=r,!0):(cc.log("cocos2d: Particle system: not enough memory"),!1)},e.postStep=function(){var e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._buffersVBO[0]),e.bufferData(e.ARRAY_BUFFER,this._quadsArrayBuffer,e.DYNAMIC_DRAW)},e._setBlendAdditive=function(){var e=this._node._blendFunc;this._texture&&!this._texture.hasPremultipliedAlpha()?(e.src=cc.SRC_ALPHA,e.dst=cc.ONE_MINUS_SRC_ALPHA):(e.src=cc.BLEND_SRC,e.dst=cc.BLEND_DST)},e._initWithTotalParticles=function(e){if(!this._allocMemory())return!1;this.initIndices(e),this._setupVBO(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},e._updateDeltaColor=function(e,t){e.color.r+=e.deltaColor.r*t,e.color.g+=e.deltaColor.g*t,e.color.b+=e.deltaColor.b*t,e.color.a+=e.deltaColor.a*t,e.isChangeColor=!0}}(),cc.ParticleFire=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?300:150)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(60),this.setSpeedVar(20),this.setAngle(90),this.setAngleVar(10);var t=cc.director.getWinSize();return this.setPosition(t.width/2,60),this.setPosVar(cc.p(40,20)),this.setLife(3),this.setLifeVar(.25),this.setStartSize(54),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(194,64,31,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleFire.create=function(){return new cc.ParticleFire},cc.ParticleFireworks=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?1500:150)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,-90)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(180),this.setSpeedVar(50);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setAngle(90),this.setAngleVar(20),this.setLife(3.5),this.setLifeVar(1),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,255)),this.setEndColor(cc.color(26,26,26,51)),this.setEndColorVar(cc.color(26,26,26,51)),this.setStartSize(8),this.setStartSizeVar(2),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleFireworks.create=function(){return new cc.ParticleFireworks},cc.ParticleSun=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?350:150)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setBlendAdditive(!0),this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(20),this.setSpeedVar(5),this.setAngle(90),this.setAngleVar(360);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(1),this.setLifeVar(.5),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(194,64,31,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),!0}return!1}}),cc.ParticleSun.create=function(){return new cc.ParticleSun},cc.ParticleGalaxy=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(60),this.setSpeedVar(10),this.setRadialAccel(-80),this.setRadialAccelVar(0),this.setTangentialAccel(80),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(37),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(31,64,194,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleGalaxy.create=function(){return new cc.ParticleGalaxy},cc.ParticleFlower=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?250:100)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(80),this.setSpeedVar(10),this.setRadialAccel(-60),this.setRadialAccelVar(0),this.setTangentialAccel(15),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,128)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleFlower.create=function(){return new cc.ParticleFlower},cc.ParticleMeteor=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?150:100)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(-200,200)),this.setSpeed(15),this.setSpeedVar(5),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(2),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(51,102,179)),this.setStartColorVar(cc.color(0,0,51,26)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleMeteor.create=function(){return new cc.ParticleMeteor},cc.ParticleSpiral=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?500:100)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(150),this.setSpeedVar(0),this.setRadialAccel(-380),this.setRadialAccelVar(0),this.setTangentialAccel(45),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(0);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(12),this.setLifeVar(0),this.setStartSize(20),this.setStartSizeVar(0),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,0)),this.setEndColor(cc.color(128,128,128,255)),this.setEndColorVar(cc.color(128,128,128,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleSpiral.create=function(){return new cc.ParticleSpiral},cc.ParticleExplosion=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?700:300)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(.1),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(70),this.setSpeedVar(40),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(5),this.setLifeVar(2),this.setStartSize(15),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getDuration()),this.setStartColor(cc.color(179,26,51,255)),this.setStartColorVar(cc.color(128,128,128,0)),this.setEndColor(cc.color(128,128,128,0)),this.setEndColorVar(cc.color(128,128,128,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleExplosion.create=function(){return new cc.ParticleExplosion},cc.ParticleSmoke=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(25),this.setSpeedVar(10),this.setAngle(90),this.setAngleVar(5);var t=cc.director.getWinSize();return this.setPosition(t.width/2,0),this.setPosVar(cc.p(20,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(204,204,204,255)),this.setStartColorVar(cc.color(5,5,5,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleSmoke.create=function(){return new cc.ParticleSmoke},cc.ParticleSnow=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?700:250)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,-1)),this.setSpeed(5),this.setSpeedVar(1),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height+10),this.setPosVar(cc.p(t.width/2,0)),this.setAngle(-90),this.setAngleVar(5),this.setLife(45),this.setLifeVar(15),this.setStartSize(10),this.setStartSizeVar(5),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(10),this.setStartColor(cc.color(255,255,255,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(255,255,255,0)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleSnow.create=function(){return new cc.ParticleSnow},cc.ParticleRain=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc._RENDER_TYPE_WEBGL?1e3:300)},initWithTotalParticles:function(e){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(10,-10)),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1),this.setSpeed(130),this.setSpeedVar(30),this.setAngle(-90),this.setAngleVar(5);var t=cc.director.getWinSize();return this.setPosition(t.width/2,t.height),this.setPosVar(cc.p(t.width/2,0)),this.setLife(4.5),this.setLifeVar(0),this.setStartSize(4),this.setStartSizeVar(2),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(20),this.setStartColor(cc.color(179,204,255,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(179,204,255,128)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleRain.create=function(){return new cc.ParticleRain},cc.PARTICLE_DEFAULT_CAPACITY=500,cc.ParticleBatchNode=cc.Node.extend({textureAtlas:null,_blendFunc:null,_className:"ParticleBatchNode",ctor:function(e,t){cc.Node.prototype.ctor.call(this),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},cc.isString(e)?this.init(e,t):e instanceof cc.Texture2D&&this.initWithTexture(e,t)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.ParticleBatchNode.CanvasRenderCmd(this):new cc.ParticleBatchNode.WebGLRenderCmd(this)},initWithTexture:function(e,t){return this.textureAtlas=new cc.TextureAtlas,this.textureAtlas.initWithTexture(e,t),this._children.length=0,this._renderCmd._initWithTexture(),!0},initWithFile:function(e,t){var i=cc.textureCache.addImage(e);return this.initWithTexture(i,t)},init:function(e,t){var i=cc.textureCache.addImage(e);return this.initWithTexture(i,t)},addChild:function(e,t,i){if(!e)throw"cc.ParticleBatchNode.addChild() : child should be non-null";if(!(e instanceof cc.ParticleSystem))throw"cc.ParticleBatchNode.addChild() : only supports cc.ParticleSystem as children";if(t=null==t?e.zIndex:t,i=null==i?e.tag:i,e.getTexture()!=this.textureAtlas.texture)throw"cc.ParticleSystem.addChild() : the child is not using the same texture id";var n=e.getBlendFunc();if(0===this._children.length)this.setBlendFunc(n);else if(n.src!=this._blendFunc.src||n.dst!=this._blendFunc.dst)return void cc.log("cc.ParticleSystem.addChild() : Can't add a ParticleSystem that uses a different blending function");var r=this._addChildHelper(e,t,i),o=0;if(0!=r){var s=this._children[r-1];o=s.getAtlasIndex()+s.getTotalParticles()}else o=0;this.insertChild(e,o),e.setBatchNode(this)},insertChild:function(e,t){var i=e.getTotalParticles(),n=this.textureAtlas,r=n.totalQuads;e.setAtlasIndex(t),r+i>n.getCapacity()&&(this._increaseAtlasCapacityTo(r+i),n.fillWithEmptyQuadsFromIndex(n.getCapacity()-i,i)),e.getAtlasIndex()+i!=r&&n.moveQuadsFromIndex(t,t+i),n.increaseTotalQuadsWith(i),this._updateAllAtlasIndexes()},removeChild:function(e,t){if(null!=e){if(!(e instanceof cc.ParticleSystem))throw"cc.ParticleBatchNode.removeChild(): only supports cc.ParticleSystem as children";if(-1!=this._children.indexOf(e)){cc.Node.prototype.removeChild.call(this,e,t);var i=this.textureAtlas;i.removeQuadsAtIndex(e.getAtlasIndex(),e.getTotalParticles()),i.fillWithEmptyQuadsFromIndex(i.totalQuads,e.getTotalParticles()),e.setBatchNode(null),this._updateAllAtlasIndexes()}else cc.log("cc.ParticleBatchNode.removeChild(): doesn't contain the sprite. Can't remove it")}},reorderChild:function(e,t){if(!e)throw"cc.ParticleBatchNode.reorderChild(): child should be non-null";if(!(e instanceof cc.ParticleSystem))throw"cc.ParticleBatchNode.reorderChild(): only supports cc.QuadParticleSystems as children";if(-1!==this._children.indexOf(e)){if(t!=e.zIndex){if(this._children.length>1){var i=this._getCurrentIndex(e,t);if(i.oldIndex!=i.newIndex){this._children.splice(i.oldIndex,1),this._children.splice(i.newIndex,0,e);var n=e.getAtlasIndex();this._updateAllAtlasIndexes();for(var r=0,o=this._children,s=0;s<o.length;s++)if(o[s]==e){r=e.getAtlasIndex();break}this.textureAtlas.moveQuadsFromIndex(n,e.getTotalParticles(),r),e.updateWithNoTime()}}e._setLocalZOrder(t)}}else cc.log("cc.ParticleBatchNode.reorderChild(): Child doesn't belong to batch")},removeChildAtIndex:function(e,t){this.removeChild(this._children[i],t)},removeAllChildren:function(e){for(var t=this._children,i=0;i<t.length;i++)t[i].setBatchNode(null);cc.Node.prototype.removeAllChildren.call(this,e),this.textureAtlas.removeAllQuads()},disableParticle:function(e){var t=this.textureAtlas.quads[e];t.br.vertices.x=t.br.vertices.y=t.tr.vertices.x=t.tr.vertices.y=t.tl.vertices.x=t.tl.vertices.y=t.bl.vertices.x=t.bl.vertices.y=0,this.textureAtlas._setDirty(!0)},getTexture:function(){return this.textureAtlas.texture},setTexture:function(e){this.textureAtlas.texture=e;var t=this._blendFunc;e&&!e.hasPremultipliedAlpha()&&t.src==cc.BLEND_SRC&&t.dst==cc.BLEND_DST&&(t.src=cc.SRC_ALPHA,t.dst=cc.ONE_MINUS_SRC_ALPHA)},setBlendFunc:function(e,t){void 0===t?(this._blendFunc.src=e.src,this._blendFunc.dst=e.dst):(this._blendFunc.src=e,this._blendFunc.src=t)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},_updateAllAtlasIndexes:function(){for(var e=0,t=this._children,i=0;i<t.length;i++){var n=t[i];n.setAtlasIndex(e),e+=n.getTotalParticles()}},_increaseAtlasCapacityTo:function(e){cc.log("cocos2d: cc.ParticleBatchNode: resizing TextureAtlas capacity from ["+this.textureAtlas.getCapacity()+"] to ["+e+"]."),this.textureAtlas.resizeCapacity(e)||cc.log("cc.ParticleBatchNode._increaseAtlasCapacityTo() : WARNING: Not enough memory to resize the atlas")},_searchNewPositionInChildrenForZ:function(e){for(var t=this._children,i=t.length,n=0;n<i;n++)if(t[n].zIndex>e)return n;return i},_getCurrentIndex:function(e,t){for(var i=!1,n=!1,r=0,o=0,s=0,a=this._children,c=a.length,l=0;l<c;l++){var u=a[l];if(u.zIndex>t&&!n&&(r=l,n=!0,i&&n))break;if(e==u&&(o=l,i=!0,n||(s=-1),i&&n))break}return n||(r=c),r+=s,{newIndex:r,oldIndex:o}},_addChildHelper:function(e,t,i){if(!e)throw"cc.ParticleBatchNode._addChildHelper(): child should be non-null";if(e.parent)return cc.log("cc.ParticleBatchNode._addChildHelper(): child already added. It can't be added again"),null;this._children||(this._children=[]);var n=this._searchNewPositionInChildrenForZ(t);return this._children.splice(n,0,e),e.tag=i,e._setLocalZOrder(t),e.parent=this,this._running&&(e.onEnter(),e.onEnterTransitionDidFinish()),n},_updateBlendFunc:function(){this.textureAtlas.texture.hasPremultipliedAlpha()||(this._blendFunc.src=cc.SRC_ALPHA,this._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(e){this.textureAtlas=e}}),(_p=cc.ParticleBatchNode.prototype).texture,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.ParticleBatchNode.create=function(e,t){return new cc.ParticleBatchNode(e,t)},function(){cc.ParticleBatchNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!1};var e=cc.ParticleBatchNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.ParticleBatchNode.CanvasRenderCmd,e._initWithTexture=function(){}}(),function(){cc.ParticleBatchNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0};var e=cc.ParticleBatchNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.ParticleBatchNode.WebGLRenderCmd,e.rendering=function(e){var t=this._node;0!=t.textureAtlas.totalQuads&&(this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glBlendFuncForParticle(t._blendFunc.src,t._blendFunc.dst),t.textureAtlas.drawQuads())},e._initWithTexture=function(){this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},e.visit=function(e){if(this._node._visible){var t=cc.current_stack;t.stack.push(t.top),this._syncStatus(e),t.top=this._stackMatrix,cc.renderer.pushRenderCommand(this),this._dirtyFlag=0,cc.kmGLPopMatrix()}}}(),cc.IMEKeyboardNotificationInfo=function(e,t,i){this.begin=e||cc.rect(0,0,0,0),this.end=t||cc.rect(0,0,0,0),this.duration=i||0},cc.IMEDelegate=cc.Class.extend({ctor:function(){cc.imeDispatcher.addDelegate(this)},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!1},didAttachWithIME:function(){},canDetachWithIME:function(){return!1},didDetachWithIME:function(){},insertText:function(e,t){},deleteBackward:function(){},getContentText:function(){return""},keyboardWillShow:function(e){},keyboardDidShow:function(e){},keyboardWillHide:function(e){},keyboardDidHide:function(e){}}),cc.IMEDispatcher=cc.Class.extend({_domInputControl:null,impl:null,_currentInputString:"",_lastClickPosition:null,ctor:function(){this.impl=new cc.IMEDispatcher.Impl,this._lastClickPosition=cc.p(0,0)},init:function(){if(!cc.sys.isMobile){this._domInputControl=cc.$("#imeDispatcherInput"),this._domInputControl||(this._domInputControl=cc.$new("input"),this._domInputControl.setAttribute("type","text"),this._domInputControl.setAttribute("id","imeDispatcherInput"),this._domInputControl.resize(0,0),this._domInputControl.translates(0,0),this._domInputControl.style.opacity="0",this._domInputControl.style.fontSize="1px",this._domInputControl.setAttribute("tabindex",2),this._domInputControl.style.position="absolute",this._domInputControl.style.top=0,this._domInputControl.style.left=0,document.body.appendChild(this._domInputControl));var e=this;cc._addEventListener(this._domInputControl,"input",function(){e._processDomInputString(e._domInputControl.value)},!1),cc._addEventListener(this._domInputControl,"keydown",function(t){t.keyCode===cc.KEY.tab?(t.stopPropagation(),t.preventDefault()):t.keyCode==cc.KEY.enter&&(e.dispatchInsertText("\n",1),t.stopPropagation(),t.preventDefault())},!1),/msie/i.test(navigator.userAgent)&&cc._addEventListener(this._domInputControl,"keyup",function(t){t.keyCode==cc.KEY.backspace&&e._processDomInputString(e._domInputControl.value)},!1),cc._addEventListener(window,"mousedown",function(t){var i=t.pageX||0,n=t.pageY||0;e._lastClickPosition.x=i,e._lastClickPosition.y=n},!1)}},_processDomInputString:function(e){var t,i,n=this._currentInputString.length<e.length?this._currentInputString.length:e.length;for(i=0;i<n&&e[i]===this._currentInputString[i];i++);var r=this._currentInputString.length-i,o=e.length-i;for(t=0;t<r;t++)this.dispatchDeleteBackward();for(t=0;t<o;t++)this.dispatchInsertText(e[i+t],1);this._currentInputString=e},dispatchInsertText:function(e,t){!this.impl||!e||t<=0||this.impl._delegateWithIme&&this.impl._delegateWithIme.insertText(e,t)},dispatchDeleteBackward:function(){this.impl&&this.impl._delegateWithIme&&this.impl._delegateWithIme.deleteBackward()},getContentText:function(){if(this.impl&&this.impl._delegateWithIme){var e=this.impl._delegateWithIme.getContentText();return e||""}return""},dispatchKeyboardWillShow:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardWillShow(e)}},dispatchKeyboardDidShow:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardDidShow(e)}},dispatchKeyboardWillHide:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardWillHide(e)}},dispatchKeyboardDidHide:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardDidHide(e)}},addDelegate:function(e){e&&this.impl&&(this.impl._delegateList.indexOf(e)>-1||this.impl._delegateList.splice(0,0,e))},attachDelegateWithIME:function(e){if(!this.impl||!e)return!1;if(-1==this.impl._delegateList.indexOf(e))return!1;if(this.impl._delegateWithIme){if(!this.impl._delegateWithIme.canDetachWithIME()||!e.canAttachWithIME())return!1;var t=this.impl._delegateWithIme;return this.impl._delegateWithIme=null,t.didDetachWithIME(),this._focusDomInput(e),!0}return!!e.canAttachWithIME()&&(this._focusDomInput(e),!0)},_focusDomInput:function(e){if(cc.sys.isMobile){this.impl._delegateWithIme=e,e.didAttachWithIME(),this._currentInputString=e.string||"";var t=prompt("please enter your word:",this._currentInputString);null!=t&&this._processDomInputString(t),this.dispatchInsertText("\n",1)}else this.impl._delegateWithIme=e,this._currentInputString=e.string||"",e.didAttachWithIME(),this._domInputControl.focus(),this._domInputControl.value=this._currentInputString,this._domInputControlTranslate()},_domInputControlTranslate:function(){/msie/i.test(navigator.userAgent)?(this._domInputControl.style.left=this._lastClickPosition.x+"px",this._domInputControl.style.top=this._lastClickPosition.y+"px"):this._domInputControl.translates(this._lastClickPosition.x,this._lastClickPosition.y)},detachDelegateWithIME:function(e){return!(!this.impl||!e)&&(this.impl._delegateWithIme==e&&(!!e.canDetachWithIME()&&(this.impl._delegateWithIme=null,e.didDetachWithIME(),cc._canvas.focus(),!0)))},removeDelegate:function(e){this.impl&&e&&-1!=this.impl._delegateList.indexOf(e)&&(this.impl._delegateWithIme&&e==this.impl._delegateWithIme&&(this.impl._delegateWithIme=null),cc.arrayRemoveObject(this.impl._delegateList,e))},processKeycode:function(e){e<32?e==cc.KEY.backspace?this.dispatchDeleteBackward():e==cc.KEY.enter?this.dispatchInsertText("\n",1):e==cc.KEY.tab||cc.KEY.escape:e<255&&this.dispatchInsertText(String.fromCharCode(e),1)}}),cc.IMEDispatcher.Impl=cc.Class.extend({_delegateWithIme:null,_delegateList:null,ctor:function(){this._delegateList=[]},findDelegate:function(e){for(var t=0;t<this._delegateList.length;t++)if(this._delegateList[t]==e)return t;return null}}),cc.imeDispatcher=new cc.IMEDispatcher,document.body?cc.imeDispatcher.init():cc._addEventListener(window,"load",function(){cc.imeDispatcher.init()},!1),cc.TextFieldDelegate=cc.Class.extend({onTextFieldAttachWithIME:function(e){return!1},onTextFieldDetachWithIME:function(e){return!1},onTextFieldInsertText:function(e,t,i){return!1},onTextFieldDeleteBackward:function(e,t,i){return!1},onDraw:function(e){return!1}}),cc.TextFieldTTF=cc.LabelTTF.extend({delegate:null,colorSpaceHolder:null,_colorText:null,_lens:null,_inputText:"",_placeHolder:"",_charCount:0,_className:"TextFieldTTF",ctor:function(e,t,i,n,r){this.colorSpaceHolder=cc.color(127,127,127),this._colorText=cc.color(255,255,255,255),cc.imeDispatcher.addDelegate(this),cc.LabelTTF.prototype.ctor.call(this),void 0!==r?(this.initWithPlaceHolder("",t,i,n,r),e&&this.setPlaceHolder(e)):void 0===n&&void 0!==i&&(this.initWithString("",arguments[1],arguments[2]),e&&this.setPlaceHolder(e))},getDelegate:function(){return this.delegate},setDelegate:function(e){this.delegate=e},getCharCount:function(){return this._charCount},getColorSpaceHolder:function(){return cc.color(this.colorSpaceHolder)},setColorSpaceHolder:function(e){this.colorSpaceHolder.r=e.r,this.colorSpaceHolder.g=e.g,this.colorSpaceHolder.b=e.b,this.colorSpaceHolder.a=cc.isUndefined(e.a)?255:e.a,this._inputText.length||this.setColor(this.colorSpaceHolder)},setTextColor:function(e){this._colorText.r=e.r,this._colorText.g=e.g,this._colorText.b=e.b,this._colorText.a=cc.isUndefined(e.a)?255:e.a,this._inputText.length&&this.setColor(this._colorText)},initWithPlaceHolder:function(e,t,i,n,r){switch(arguments.length){case 5:return e&&this.setPlaceHolder(e),this.initWithString(this._placeHolder,n,r,t,i);case 3:return e&&this.setPlaceHolder(e),this.initWithString(this._placeHolder,arguments[1],arguments[2]);default:throw"Argument must be non-nil "}},setString:function(e){e=String(e),this._inputText=e||"",this._inputText.length?(cc.LabelTTF.prototype.setString.call(this,this._inputText),this.setColor(this._colorText)):(cc.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder)),cc._renderType===cc._RENDER_TYPE_CANVAS&&this._renderCmd._updateTexture(),this._charCount=this._inputText.length},getString:function(){return this._inputText},setPlaceHolder:function(e){this._placeHolder=e||"",this._inputText.length||(cc.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder))},getPlaceHolder:function(){return this._placeHolder},draw:function(e){var t=e||cc._renderContext;this.delegate&&this.delegate.onDraw(this)||cc.LabelTTF.prototype.draw.call(this,t)},visit:function(e){this._super(e)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldAttachWithIME(this)},didAttachWithIME:function(){},canDetachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldDetachWithIME(this)},didDetachWithIME:function(){},deleteBackward:function(){var e=this._inputText.length;if(0!=e){if(!this.delegate||!this.delegate.onTextFieldDeleteBackward(this,this._inputText[e-1],1))return e<=1?(this._inputText="",this._charCount=0,cc.LabelTTF.prototype.setString.call(this,this._placeHolder),void this.setColor(this.colorSpaceHolder)):void(this.string=this._inputText.substring(0,e-1))}},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},insertText:function(e,t){var i=e,n=i.indexOf("\n");if(n>-1&&(i=i.substring(0,n)),i.length>0){if(this.delegate&&this.delegate.onTextFieldInsertText(this,i,i.length))return;var r=this._inputText+i;this._charCount=r.length,this.string=r}-1!=n&&(this.delegate&&this.delegate.onTextFieldInsertText(this,"\n",1)||this.detachWithIME())},getContentText:function(){return this._inputText},keyboardWillShow:function(e){},keyboardDidShow:function(e){},keyboardWillHide:function(e){},keyboardDidHide:function(e){}}),(_p=cc.TextFieldTTF.prototype).charCount,cc.defineGetterSetter(_p,"charCount",_p.getCharCount),_p.placeHolder,cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),cc.TextFieldTTF.create=function(e,t,i,n,r){return new cc.TextFieldTTF(e,t,i,n,r)},cc._globalFontSize=cc.ITEM_SIZE,cc._globalFontName="Arial",cc._globalFontNameRelease=!1,cc.MenuItem=cc.Node.extend({_enabled:!1,_target:null,_callback:null,_isSelected:!1,_className:"MenuItem",ctor:function(e,t){var i=cc.Node.prototype;i.ctor.call(this),this._target=null,this._callback=null,this._isSelected=!1,this._enabled=!1,i.setAnchorPoint.call(this,.5,.5),this._target=t||null,this._callback=e||null,this._callback&&(this._enabled=!0)},isSelected:function(){return this._isSelected},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},setTarget:function(e,t){this._target=t,this._callback=e},isEnabled:function(){return this._enabled},setEnabled:function(e){this._enabled=e},initWithCallback:function(e,t){return this.anchorX=.5,this.anchorY=.5,this._target=t,this._callback=e,this._enabled=!0,this._isSelected=!1,!0},rect:function(){var e=this._position,t=this._contentSize,i=this._anchorPoint;return cc.rect(e.x-t.width*i.x,e.y-t.height*i.y,t.width,t.height)},selected:function(){this._isSelected=!0},unselected:function(){this._isSelected=!1},setCallback:function(e,t){this._target=t,this._callback=e},activate:function(){if(this._enabled){var e=this._target,t=this._callback;if(!t)return;e&&cc.isString(t)?e[t](this):e&&cc.isFunction(t)?t.call(e,this):t(this)}}}),(_p=cc.MenuItem.prototype).enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),cc.MenuItem.create=function(e,t){return new cc.MenuItem(e,t)},cc.MenuItemLabel=cc.MenuItem.extend({_disabledColor:null,_label:null,_originalScale:0,_colorBackup:null,ctor:function(e,t,i){cc.MenuItem.prototype.ctor.call(this,t,i),this._disabledColor=null,this._label=null,this._colorBackup=null,e&&(this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(e),this.cascadeColor=!0,this.cascadeOpacity=!0)},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(e){this._disabledColor=e},getLabel:function(){return this._label},setLabel:function(e){e&&(this.addChild(e),e.anchorX=0,e.anchorY=0,this.width=e.width,this.height=e.height),this._label&&this.removeChild(this._label,!0),this._label=e},setEnabled:function(e){if(this._enabled!=e){var t=this._label;e?t.color=this._colorBackup:(this._colorBackup=t.color,t.color=this._disabledColor)}cc.MenuItem.prototype.setEnabled.call(this,e)},setOpacity:function(e){this._label.opacity=e},getOpacity:function(){return this._label.opacity},setColor:function(e){this._label.color=e},getColor:function(){return this._label.color},initWithLabel:function(e,t,i){return this.initWithCallback(t,i),this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(e),this.cascadeColor=!0,this.cascadeOpacity=!0,!0},setString:function(e){this._label.string=e,this.width=this._label.width,this.height=this._label.height},getString:function(){return this._label.string},activate:function(){this._enabled&&(this.stopAllActions(),this.scale=this._originalScale,cc.MenuItem.prototype.activate.call(this))},selected:function(){if(this._enabled){cc.MenuItem.prototype.selected.call(this);var e=this.getActionByTag(cc.ZOOM_ACTION_TAG);e?this.stopAction(e):this._originalScale=this.scale;var t=cc.scaleTo(.1,1.2*this._originalScale);t.setTag(cc.ZOOM_ACTION_TAG),this.runAction(t)}},unselected:function(){if(this._enabled){cc.MenuItem.prototype.unselected.call(this),this.stopActionByTag(cc.ZOOM_ACTION_TAG);var e=cc.scaleTo(.1,this._originalScale);e.setTag(cc.ZOOM_ACTION_TAG),this.runAction(e)}}}),(_p=cc.MenuItemLabel.prototype).string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.disabledColor,cc.defineGetterSetter(_p,"disabledColor",_p.getDisabledColor,_p.setDisabledColor),_p.label,cc.defineGetterSetter(_p,"label",_p.getLabel,_p.setLabel),cc.MenuItemLabel.create=function(e,t,i){return new cc.MenuItemLabel(e,t,i)},cc.MenuItemAtlasFont=cc.MenuItemLabel.extend({ctor:function(e,t,i,n,r,o,s){var a;e&&e.length>0&&(a=new cc.LabelAtlas(e,t,i,n,r)),cc.MenuItemLabel.prototype.ctor.call(this,a,o,s)},initWithString:function(e,t,i,n,r,o,s){if(!e||0==e.length)throw"cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0";var a=new cc.LabelAtlas;return a.initWithString(e,t,i,n,r),this.initWithLabel(a,o,s),!0}}),cc.MenuItemAtlasFont.create=function(e,t,i,n,r,o,s){return new cc.MenuItemAtlasFont(e,t,i,n,r,o,s)},cc.MenuItemFont=cc.MenuItemLabel.extend({_fontSize:null,_fontName:null,ctor:function(e,t,i){var n;e&&e.length>0?(this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize,n=new cc.LabelTTF(e,this._fontName,this._fontSize)):(this._fontSize=0,this._fontName=""),cc.MenuItemLabel.prototype.ctor.call(this,n,t,i)},initWithString:function(e,t,i){if(!e||0==e.length)throw"Value should be non-null and its length should be greater than 0";this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize;var n=new cc.LabelTTF(e,this._fontName,this._fontSize);return this.initWithLabel(n,t,i),!0},setFontSize:function(e){this._fontSize=e,this._recreateLabel()},getFontSize:function(){return this._fontSize},setFontName:function(e){this._fontName=e,this._recreateLabel()},getFontName:function(){return this._fontName},_recreateLabel:function(){var e=new cc.LabelTTF(this._label.string,this._fontName,this._fontSize);this.setLabel(e)}}),cc.MenuItemFont.setFontSize=function(e){cc._globalFontSize=e},cc.MenuItemFont.fontSize=function(){return cc._globalFontSize},cc.MenuItemFont.setFontName=function(e){cc._globalFontNameRelease&&(cc._globalFontName=""),cc._globalFontName=e,cc._globalFontNameRelease=!0},(_p=cc.MenuItemFont.prototype).fontSize,cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),_p.fontName,cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),cc.MenuItemFont.fontName=function(){return cc._globalFontName},cc.MenuItemFont.create=function(e,t,i){return new cc.MenuItemFont(e,t,i)},cc.MenuItemSprite=cc.MenuItem.extend({_normalImage:null,_selectedImage:null,_disabledImage:null,ctor:function(e,t,i,n,r){if(cc.MenuItem.prototype.ctor.call(this),this._normalImage=null,this._selectedImage=null,this._disabledImage=null,void 0!==t){e=e,t=t;var o,s,a;void 0!==r?(o=i,a=n,s=r):void 0!==n&&cc.isFunction(n)?(o=i,a=n):void 0!==n&&cc.isFunction(i)?(s=n,a=i,o=new cc.Sprite(t.getTexture(),t.getTextureRect())):void 0===i&&(o=new cc.Sprite(t.getTexture(),t.getTextureRect())),this.initWithNormalSprite(e,t,o,a,s)}},getNormalImage:function(){return this._normalImage},setNormalImage:function(e){this._normalImage!=e&&(e&&(this.addChild(e,0,cc.NORMAL_TAG),e.anchorX=0,e.anchorY=0),this._normalImage&&this.removeChild(this._normalImage,!0),this._normalImage=e,this.width=this._normalImage.width,this.height=this._normalImage.height,this._updateImagesVisibility(),e.textureLoaded&&!e.textureLoaded()&&e.addEventListener("load",function(e){this.width=e.width,this.height=e.height},this))},getSelectedImage:function(){return this._selectedImage},setSelectedImage:function(e){this._selectedImage!=e&&(e&&(this.addChild(e,0,cc.SELECTED_TAG),e.anchorX=0,e.anchorY=0),this._selectedImage&&this.removeChild(this._selectedImage,!0),this._selectedImage=e,this._updateImagesVisibility())},getDisabledImage:function(){return this._disabledImage},setDisabledImage:function(e){this._disabledImage!=e&&(e&&(this.addChild(e,0,cc.DISABLE_TAG),e.anchorX=0,e.anchorY=0),this._disabledImage&&this.removeChild(this._disabledImage,!0),this._disabledImage=e,this._updateImagesVisibility())},initWithNormalSprite:function(e,t,i,n,r){this.initWithCallback(n,r),this.setNormalImage(e),this.setSelectedImage(t),this.setDisabledImage(i);var o=this._normalImage;return o&&(this.width=o.width,this.height=o.height,o.textureLoaded&&!o.textureLoaded()&&o.addEventListener("load",function(e){this.width=e.width,this.height=e.height,this.cascadeColor=!0,this.cascadeOpacity=!0},this)),this.cascadeColor=!0,this.cascadeOpacity=!0,!0},setColor:function(e){this._normalImage.color=e,this._selectedImage&&(this._selectedImage.color=e),this._disabledImage&&(this._disabledImage.color=e)},getColor:function(){return this._normalImage.color},setOpacity:function(e){this._normalImage.opacity=e,this._selectedImage&&(this._selectedImage.opacity=e),this._disabledImage&&(this._disabledImage.opacity=e)},getOpacity:function(){return this._normalImage.opacity},selected:function(){cc.MenuItem.prototype.selected.call(this),this._normalImage&&(this._disabledImage&&(this._disabledImage.visible=!1),this._selectedImage?(this._normalImage.visible=!1,this._selectedImage.visible=!0):this._normalImage.visible=!0)},unselected:function(){cc.MenuItem.prototype.unselected.call(this),this._normalImage&&(this._normalImage.visible=!0,this._selectedImage&&(this._selectedImage.visible=!1),this._disabledImage&&(this._disabledImage.visible=!1))},setEnabled:function(e){this._enabled!=e&&(cc.MenuItem.prototype.setEnabled.call(this,e),this._updateImagesVisibility())},_updateImagesVisibility:function(){var e=this._normalImage,t=this._selectedImage,i=this._disabledImage;this._enabled?(e&&(e.visible=!0),t&&(t.visible=!1),i&&(i.visible=!1)):i?(e&&(e.visible=!1),t&&(t.visible=!1),i&&(i.visible=!0)):(e&&(e.visible=!0),t&&(t.visible=!1))}}),(_p=cc.MenuItemSprite.prototype).normalImage,cc.defineGetterSetter(_p,"normalImage",_p.getNormalImage,_p.setNormalImage),_p.selectedImage,cc.defineGetterSetter(_p,"selectedImage",_p.getSelectedImage,_p.setSelectedImage),_p.disabledImage,cc.defineGetterSetter(_p,"disabledImage",_p.getDisabledImage,_p.setDisabledImage),cc.MenuItemSprite.create=function(e,t,i,n,r){return new cc.MenuItemSprite(e,t,i,n,r||void 0)},cc.MenuItemImage=cc.MenuItemSprite.extend({ctor:function(e,t,i,n,r){var o=null,s=null,a=null,c=null,l=null;void 0===e?cc.MenuItemSprite.prototype.ctor.call(this):(o=new cc.Sprite(e),t&&(s=new cc.Sprite(t)),void 0===n?c=i:void 0===r?(c=i,l=n):r&&(a=new cc.Sprite(i),c=n,l=r),cc.MenuItemSprite.prototype.ctor.call(this,o,s,a,c,l))},setNormalSpriteFrame:function(e){this.setNormalImage(new cc.Sprite(e))},setSelectedSpriteFrame:function(e){this.setSelectedImage(new cc.Sprite(e))},setDisabledSpriteFrame:function(e){this.setDisabledImage(new cc.Sprite(e))},initWithNormalImage:function(e,t,i,n,r){var o=null,s=null,a=null;return e&&(o=new cc.Sprite(e)),t&&(s=new cc.Sprite(t)),i&&(a=new cc.Sprite(i)),this.initWithNormalSprite(o,s,a,n,r)}}),cc.MenuItemImage.create=function(e,t,i,n,r){return new cc.MenuItemImage(e,t,i,n,r)},cc.MenuItemToggle=cc.MenuItem.extend({subItems:null,_selectedIndex:0,_opacity:null,_color:null,ctor:function(){cc.MenuItem.prototype.ctor.call(this),this._selectedIndex=0,this.subItems=[],this._opacity=0,this._color=cc.color.WHITE,arguments.length>0&&this.initWithItems(Array.prototype.slice.apply(arguments))},getOpacity:function(){return this._opacity},setOpacity:function(e){if(this._opacity=e,this.subItems&&this.subItems.length>0)for(var t=0;t<this.subItems.length;t++)this.subItems[t].opacity=e;this._color.a=e},getColor:function(){var e=this._color;return cc.color(e.r,e.g,e.b,e.a)},setColor:function(e){var t=this._color;if(t.r=e.r,t.g=e.g,t.b=e.b,this.subItems&&this.subItems.length>0)for(var i=0;i<this.subItems.length;i++)this.subItems[i].setColor(e);void 0===e.a||e.a_undefined||this.setOpacity(e.a)},getSelectedIndex:function(){return this._selectedIndex},setSelectedIndex:function(e){if(e!=this._selectedIndex){this._selectedIndex=e;var t=this.getChildByTag(cc.CURRENT_ITEM);t&&t.removeFromParent(!1);var i=this.subItems[this._selectedIndex];this.addChild(i,0,cc.CURRENT_ITEM);var n=i.width,r=i.height;this.width=n,this.height=r,i.setPosition(n/2,r/2)}},getSubItems:function(){return this.subItems},setSubItems:function(e){this.subItems=e},initWithItems:function(e){var t=e.length;cc.isFunction(e[e.length-2])?(this.initWithCallback(e[e.length-2],e[e.length-1]),t-=2):cc.isFunction(e[e.length-1])?(this.initWithCallback(e[e.length-1],null),t-=1):this.initWithCallback(null,null);var i=this.subItems;i.length=0;for(var n=0;n<t;n++)e[n]&&i.push(e[n]);return this._selectedIndex=cc.UINT_MAX,this.setSelectedIndex(0),this.cascadeColor=!0,this.cascadeOpacity=!0,!0},addSubItem:function(e){this.subItems.push(e)},activate:function(){if(this._enabled){var e=(this._selectedIndex+1)%this.subItems.length;this.setSelectedIndex(e)}cc.MenuItem.prototype.activate.call(this)},selected:function(){cc.MenuItem.prototype.selected.call(this),this.subItems[this._selectedIndex].selected()},unselected:function(){cc.MenuItem.prototype.unselected.call(this),this.subItems[this._selectedIndex].unselected()},setEnabled:function(e){if(this._enabled!=e){cc.MenuItem.prototype.setEnabled.call(this,e);var t=this.subItems;if(t&&t.length>0)for(var i=0;i<t.length;i++)t[i].enabled=e}},selectedItem:function(){return this.subItems[this._selectedIndex]},getSelectedItem:function(){return this.subItems[this._selectedIndex]},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.setSelectedIndex(this._selectedIndex)}}),(_p=cc.MenuItemToggle.prototype).selectedIndex,cc.defineGetterSetter(_p,"selectedIndex",_p.getSelectedIndex,_p.setSelectedIndex),cc.MenuItemToggle.create=function(){arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var e=new cc.MenuItemToggle;return e.initWithItems(Array.prototype.slice.apply(arguments)),e},cc.MENU_STATE_WAITING=0,cc.MENU_STATE_TRACKING_TOUCH=1,cc.MENU_HANDLER_PRIORITY=-128,cc.DEFAULT_PADDING=5,cc.Menu=cc.Layer.extend({enabled:!1,_selectedItem:null,_state:-1,_touchListener:null,_className:"Menu",ctor:function(e){cc.Layer.prototype.ctor.call(this),this._color=cc.color.WHITE,this.enabled=!1,this._opacity=255,this._selectedItem=null,this._state=-1,this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this._onTouchBegan,onTouchMoved:this._onTouchMoved,onTouchEnded:this._onTouchEnded,onTouchCancelled:this._onTouchCancelled}),arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var t,i=arguments.length;if(0==i)t=[];else if(1==i)t=e instanceof Array?e:[e];else if(i>1){t=[];for(var n=0;n<i;n++)arguments[n]&&t.push(arguments[n])}this.initWithArray(t)},onEnter:function(){var e=this._touchListener;e._isRegistered()||cc.eventManager.addListener(e,this),cc.Node.prototype.onEnter.call(this)},isEnabled:function(){return this.enabled},setEnabled:function(e){this.enabled=e},initWithItems:function(e){var t=[];if(e)for(var i=0;i<e.length;i++)e[i]&&t.push(e[i]);return this.initWithArray(t)},initWithArray:function(e){if(cc.Layer.prototype.init.call(this)){this.enabled=!0;var t=cc.winSize;if(this.setPosition(t.width/2,t.height/2),this.setContentSize(t),this.setAnchorPoint(.5,.5),this.ignoreAnchorPointForPosition(!0),e)for(var i=0;i<e.length;i++)this.addChild(e[i],i);return this._selectedItem=null,this._state=cc.MENU_STATE_WAITING,this.cascadeColor=!0,this.cascadeOpacity=!0,!0}return!1},addChild:function(e,t,i){if(!(e instanceof cc.MenuItem))throw"cc.Menu.addChild() : Menu only supports MenuItem objects as children";cc.Layer.prototype.addChild.call(this,e,t,i)},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(e){var t,i,n,r,o,s=-e,a=this._children;if(a&&a.length>0){for(i=0,t=a.length;i<t;i++)s+=a[i].height*a[i].scaleY+e;var c=s/2;for(i=0,t=a.length;i<t;i++)r=(o=a[i]).height,n=o.scaleY,o.setPosition(0,c-r*n/2),c-=r*n+e}},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(e){var t,i,n,r,o,s=-e,a=this._children;if(a&&a.length>0){for(t=0,i=a.length;t<i;t++)s+=a[t].width*a[t].scaleX+e;var c=-s/2;for(t=0,i=a.length;t<i;t++)n=(o=a[t]).scaleX,r=a[t].width,o.setPosition(c+r*n/2,0),c+=r*n+e}},alignItemsInColumns:function(){arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);var i,n,r,o=-5,s=0,a=0,c=0,l=this._children;if(l&&l.length>0)for(t=0,r=l.length;t<r;t++)s>=e.length||(i=e[s])&&(a=a>=(n=l[t].height)||isNaN(n)?a:n,++c>=i&&(o+=a+5,c=0,a=0,++s));var u=cc.director.getWinSize();s=0,a=0,i=0;var h=0,d=0,p=o/2;if(l&&l.length>0)for(t=0,r=l.length;t<r;t++){var _=l[t];0==i&&(i=e[s],d=h=u.width/(1+i)),a=a>=(n=_._getHeight())||isNaN(n)?a:n,_.setPosition(d-u.width/2,p-n/2),d+=h,++c>=i&&(p-=a+5,c=0,i=0,a=0,++s)}},alignItemsInRows:function(){arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var e,t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);var i,n,r,o,s=[],a=[],c=-10,l=-5,u=0,h=0,d=0,p=this._children;if(p&&p.length>0)for(e=0,r=p.length;e<r;e++)n=p[e],u>=t.length||(i=t[u])&&(h=h>=(o=n.width)||isNaN(o)?h:o,l+=n.height+5,++d>=i&&(s.push(h),a.push(l),c+=h+10,d=0,h=0,l=-5,++u));var _=cc.director.getWinSize();u=0,h=0,i=0;var f=-c/2,m=0;if(p&&p.length>0)for(e=0,r=p.length;e<r;e++)n=p[e],0==i&&(i=t[u],m=a[u]),h=h>=(o=n._getWidth())||isNaN(o)?h:o,n.setPosition(f+s[u]/2,m-_.height/2),m-=n.height+10,++d>=i&&(f+=h+5,d=0,i=0,h=0,++u)},removeChild:function(e,t){null!=e&&(e instanceof cc.MenuItem?(this._selectedItem==e&&(this._selectedItem=null),cc.Node.prototype.removeChild.call(this,e,t)):cc.log("cc.Menu.removeChild():Menu only supports MenuItem objects as children"))},_onTouchBegan:function(e,t){var i=t.getCurrentTarget();if(i._state!=cc.MENU_STATE_WAITING||!i._visible||!i.enabled)return!1;for(var n=i.parent;null!=n;n=n.parent)if(!n.isVisible())return!1;return i._selectedItem=i._itemForTouch(e),!!i._selectedItem&&(i._state=cc.MENU_STATE_TRACKING_TOUCH,i._selectedItem.selected(),i._selectedItem.setNodeDirty(),!0)},_onTouchEnded:function(e,t){var i=t.getCurrentTarget();i._state===cc.MENU_STATE_TRACKING_TOUCH?(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty(),i._selectedItem.activate()),i._state=cc.MENU_STATE_WAITING):cc.log("cc.Menu.onTouchEnded(): invalid state")},_onTouchCancelled:function(e,t){var i=t.getCurrentTarget();i._state===cc.MENU_STATE_TRACKING_TOUCH?(this._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty()),i._state=cc.MENU_STATE_WAITING):cc.log("cc.Menu.onTouchCancelled(): invalid state")},_onTouchMoved:function(e,t){var i=t.getCurrentTarget();if(i._state===cc.MENU_STATE_TRACKING_TOUCH){var n=i._itemForTouch(e);n!=i._selectedItem&&(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty()),i._selectedItem=n,i._selectedItem&&(i._selectedItem.selected(),i._selectedItem.setNodeDirty()))}else cc.log("cc.Menu.onTouchMoved(): invalid state")},onExit:function(){this._state==cc.MENU_STATE_TRACKING_TOUCH&&(this._selectedItem&&(this._selectedItem.unselected(),this._selectedItem=null),this._state=cc.MENU_STATE_WAITING),cc.Node.prototype.onExit.call(this)},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},_itemForTouch:function(e){var t,i=e.getLocation(),n=this._children;if(n&&n.length>0)for(var r=n.length-1;r>=0;r--)if((t=n[r]).isVisible()&&t.isEnabled()){var o=t.convertToNodeSpace(i),s=t.rect();if(s.x=0,s.y=0,cc.rectContainsPoint(s,o))return t}return null}}),(_p=cc.Menu.prototype).enabled,cc.Menu.create=function(e){var t=arguments.length;t>0&&null==arguments[t-1]&&cc.log("parameters should not be ending with null in Javascript");return 0==t?new cc.Menu:1==t?new cc.Menu(e):new cc.Menu(Array.prototype.slice.call(arguments,0))},cc.TGA_OK=0,cc.TGA_ERROR_FILE_OPEN=1,cc.TGA_ERROR_READING_FILE=2,cc.TGA_ERROR_INDEXED_COLOR=3,cc.TGA_ERROR_MEMORY=4,cc.TGA_ERROR_COMPRESSED_FILE=5,cc.ImageTGA=function(e,t,i,n,r,o,s){this.status=e||0,this.type=t||0,this.pixelDepth=i||0,this.width=n||0,this.height=r||0,this.imageData=o||[],this.flipped=s||0},cc.tgaLoadHeader=function(e,t,i){var n=2;if(n+1>t)return!1;var r=new cc.BinaryStreamReader(e);if(r.setOffset(n),i.type=r.readByte(),(n+=10)+4+1>t)return!1;if(r.setOffset(n),i.width=r.readUnsignedShort(),i.height=r.readUnsignedInteger(),i.pixelDepth=r.readByte(),(n+=5)+1>t)return!1;var o=r.readByte();return i.flipped=0,32&o&&(i.flipped=1),!0},cc.tgaLoadImageData=function(e,t,i){var n,r,o,s;if(n=0|i.pixelDepth/2,18+(r=i.height*i.width*n)>t)return!1;if(i.imageData=cc.__getSubArray(e,18,18+r),n>=3)for(o=0;o<r;o+=n)s=i.imageData[o],i.imageData[o]=i.imageData[o+2],i.imageData[o+2]=s;return!0},cc.tgaRGBtogreyscale=function(e){var t,i;if(8!==e.pixelDepth){var n=e.pixelDepth/8,r=new Uint8Array(e.height*e.width);if(null!==r){for(t=0,i=0;i<e.width*e.height;t+=n,i++)r[i]=.3*e.imageData[t]+.59*e.imageData[t+1]+.11*e.imageData[t+2];e.pixelDepth=8,e.type=3,e.imageData=r}}},cc.tgaDestroy=function(e){e&&(e.imageData=null,e=null)},cc.tgaLoadRLEImageData=function(e,t,i){var n,r,o,s=0,a=0,c=0,l=[],u=0,h=18;for(n=i.pixelDepth/8,r=i.height*i.width,o=0;o<r;o++){if(0!=u)u--,a=0!=c;else{if(h+1>t)break;u=e[h],h+=1,(c=128&u)&&(u-=128),a=0}if(!a){if(h+n>t)break;if(l=cc.__getSubArray(e,h,h+n),h+=n,n>=3){var d=l[0];l[0]=l[2],l[2]=d}}for(var p=0;p<n;p++)i.imageData[s+p]=l[p];s+=n}return!0},cc.tgaFlipImage=function(e){for(var t=e.pixelDepth/8,i=e.width*t,n=0;n<e.height/2;n++){var r=cc.__getSubArray(e.imageData,n*i,n*i+i);cc.__setDataToArray(cc.__getSubArray(e.imageData,(e.height-(n+1))*i,i),e.imageData,n*i),cc.__setDataToArray(r,e.imageData,(e.height-(n+1))*i)}e.flipped=0},cc.__getSubArray=function(e,t,i){return e instanceof Array?e.slice(t,i):e.subarray(t,i)},cc.__setDataToArray=function(e,t,i){for(var n=0;n<e.length;n++)t[i+n]=e[n]},cc.BinaryStreamReader=cc.Class.extend({_binaryData:null,_offset:0,ctor:function(e){this._binaryData=e},setBinaryData:function(e){this._binaryData=e,this._offset=0},getBinaryData:function(){return this._binaryData},_checkSize:function(e){if(!(this._offset+Math.ceil(e/8)<this._data.length))throw new Error("Index out of bound")},_decodeFloat:function(e,t){var i=e+t+1,n=i>>3;this._checkSize(i);var r=Math.pow(2,t-1)-1,o=this._readBits(e+t,1,n),s=this._readBits(e,t,n),a=0,c=2,l=0;do{for(var u=this._readByte(++l,n),h=e%8||8,d=1<<h;d>>=1;)u&d&&(a+=1/c),c*=2}while(e-=h);return this._offset+=n,s==1+(r<<1)?a?NaN:o?-1/0:1/0:(1+-2*o)*(s||a?s?Math.pow(2,s-r)*(1+a):Math.pow(2,1-r)*a:0)},_readByte:function(e,t){return this._data[this._offset+t-e-1]},_decodeInt:function(e,t){var i=this._readBits(0,e,e/8),n=Math.pow(2,e),r=t&&i>=n/2?i-n:i;return this._offset+=e/8,r},_shl:function(e,t){for(++t;--t;e=1073741824==(1073741824&(e%=2147483648))?2*e:2*(e-1073741824)+2147483647+1);return e},_readBits:function(e,t,i){var n=(e+t)%8,r=e%8,o=i-(e>>3)-1,s=i+(-(e+t)>>3),a=o-s,c=this._readByte(o,i)>>r&(1<<(a?8-r:t))-1;for(a&&n&&(c+=(this._readByte(s++,i)&(1<<n)-1)<<(a--<<3)-r);a;)c+=this._shl(this._readByte(s++,i),(a--<<3)-r);return c},readInteger:function(){return this._decodeInt(32,!0)},readUnsignedInteger:function(){return this._decodeInt(32,!1)},readSingle:function(){return this._decodeFloat(23,8)},readShort:function(){return this._decodeInt(16,!0)},readUnsignedShort:function(){return this._decodeInt(16,!1)},readByte:function(){var e=this._data[this._offset];return this._offset+=1,e},readData:function(e,t){return this._binaryData instanceof Array?this._binaryData.slice(e,t):this._binaryData.subarray(e,t)},setOffset:function(e){this._offset=e},getOffset:function(){return this._offset}}),cc.TMX_ORIENTATION_ORTHO=0,cc.TMX_ORIENTATION_HEX=1,cc.TMX_ORIENTATION_ISO=2,cc.TMXTiledMap=cc.Node.extend({properties:null,mapOrientation:null,objectGroups:null,_mapSize:null,_tileSize:null,_tileProperties:null,_className:"TMXTiledMap",ctor:function(e,t){cc.Node.prototype.ctor.call(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),void 0!==t?this.initWithXML(e,t):void 0!==e&&this.initWithTMXFile(e)},getMapSize:function(){return cc.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(e){this._mapSize.width=e.width,this._mapSize.height=e.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(e){this._mapSize.width=e},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(e){this._mapSize.height=e},getTileSize:function(){return cc.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(e){this._tileSize.width=e.width,this._tileSize.height=e.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(e){this._tileSize.width=e},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(e){this._tileSize.height=e},getMapOrientation:function(){return this.mapOrientation},setMapOrientation:function(e){this.mapOrientation=e},getObjectGroups:function(){return this.objectGroups},setObjectGroups:function(e){this.objectGroups=e},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e},initWithTMXFile:function(e){if(!e||0==e.length)throw"cc.TMXTiledMap.initWithTMXFile(): tmxFile should be non-null or non-empty string.";this.width=0,this.height=0;var t=new cc.TMXMapInfo(e);if(!t)return!1;var i=t.getTilesets();return i&&0!==i.length||cc.log("cc.TMXTiledMap.initWithTMXFile(): Map not found. Please check the filename."),this._buildWithMapInfo(t),!0},initWithXML:function(e,t){this.width=0,this.height=0;var i=new cc.TMXMapInfo(e,t),n=i.getTilesets();return n&&0!==n.length||cc.log("cc.TMXTiledMap.initWithXML(): Map not found. Please check the filename."),this._buildWithMapInfo(i),!0},_buildWithMapInfo:function(e){this._mapSize=e.getMapSize(),this._tileSize=e.getTileSize(),this.mapOrientation=e.orientation,this.objectGroups=e.getObjectGroups(),this.properties=e.properties,this._tileProperties=e.getTileProperties();var t=0,i=e.getLayers();if(i)for(var n=null,r=0,o=i.length;r<o;r++)if((n=i[r])&&n.visible){var s=this._parseLayer(n,e);this.addChild(s,t,t),this.width=Math.max(this.width,s.width),this.height=Math.max(this.height,s.height),t++}},allLayers:function(){for(var e=[],t=this._children,i=0,n=t.length;i<n;i++){var r=t[i];r&&r instanceof cc.TMXLayer&&e.push(r)}return e},getLayer:function(e){if(!e||0===e.length)throw"cc.TMXTiledMap.getLayer(): layerName should be non-null or non-empty string.";for(var t=this._children,i=0;i<t.length;i++){var n=t[i];if(n&&n.layerName==e)return n}return null},getObjectGroup:function(e){if(!e||0===e.length)throw"cc.TMXTiledMap.getObjectGroup(): groupName should be non-null or non-empty string.";if(this.objectGroups)for(var t=0;t<this.objectGroups.length;t++){var i=this.objectGroups[t];if(i&&i.groupName==e)return i}return null},getProperty:function(e){return this.properties[e.toString()]},propertiesForGID:function(e){return cc.log("propertiesForGID is deprecated. Please use getPropertiesForGID instead."),this.getPropertiesForGID[e]},getPropertiesForGID:function(e){return this._tileProperties[e]},_parseLayer:function(e,t){var i=this._tilesetForLayer(e,t),n=new cc.TMXLayer(i,e,t);return e.ownTiles=!1,n.setupTiles(),n},_tilesetForLayer:function(e,t){var i=e._layerSize,n=t.getTilesets();if(n)for(var r=n.length-1;r>=0;r--){var o=n[r];if(o)for(var s=0;s<i.height;s++)for(var a=0;a<i.width;a++){var c=a+i.width*s,l=e._tiles[c];if(0!=l&&(l&cc.TMX_TILE_FLIPPED_MASK)>>>0>=o.firstGid)return o}}return cc.log("cocos2d: Warning: TMX Layer "+e.name+" has no tiles"),null}}),(_p=cc.TMXTiledMap.prototype).mapWidth,cc.defineGetterSetter(_p,"mapWidth",_p._getMapWidth,_p._setMapWidth),_p.mapHeight,cc.defineGetterSetter(_p,"mapHeight",_p._getMapHeight,_p._setMapHeight),_p.tileWidth,cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),_p.tileHeight,cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXTiledMap.create=function(e,t){return new cc.TMXTiledMap(e,t)},cc.TMX_PROPERTY_NONE=0,cc.TMX_PROPERTY_MAP=1,cc.TMX_PROPERTY_LAYER=2,cc.TMX_PROPERTY_OBJECTGROUP=3,cc.TMX_PROPERTY_OBJECT=4,cc.TMX_PROPERTY_TILE=5,cc.TMX_TILE_HORIZONTAL_FLAG=2147483648,cc.TMX_TILE_VERTICAL_FLAG=1073741824,cc.TMX_TILE_DIAGONAL_FLAG=536870912,cc.TMX_TILE_FLIPPED_ALL=(cc.TMX_TILE_HORIZONTAL_FLAG|cc.TMX_TILE_VERTICAL_FLAG|cc.TMX_TILE_DIAGONAL_FLAG)>>>0,cc.TMX_TILE_FLIPPED_MASK=~cc.TMX_TILE_FLIPPED_ALL>>>0,cc.TMXLayerInfo=cc.Class.extend({properties:null,name:"",_layerSize:null,_tiles:null,visible:null,_opacity:null,ownTiles:!0,_minGID:1e5,_maxGID:0,offset:null,ctor:function(){this.properties=[],this.name="",this._layerSize=null,this._tiles=[],this.visible=!0,this._opacity=0,this.ownTiles=!0,this._minGID=1e5,this._maxGID=0,this.offset=cc.p(0,0)},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e}}),cc.TMXTilesetInfo=cc.Class.extend({name:"",firstGid:0,_tileSize:null,spacing:0,margin:0,sourceImage:"",imageSize:null,ctor:function(){this._tileSize=cc.size(0,0),this.imageSize=cc.size(0,0)},rectForGID:function(e){var t=cc.rect(0,0,0,0);t.width=this._tileSize.width,t.height=this._tileSize.height,e&=cc.TMX_TILE_FLIPPED_MASK,e-=parseInt(this.firstGid,10);var i=parseInt((this.imageSize.width-2*this.margin+this.spacing)/(this._tileSize.width+this.spacing),10);return t.x=parseInt(e%i*(this._tileSize.width+this.spacing)+this.margin,10),t.y=parseInt(parseInt(e/i,10)*(this._tileSize.height+this.spacing)+this.margin,10),t}}),cc.TMXMapInfo=cc.SAXParser.extend({properties:null,orientation:null,parentElement:null,parentGID:null,layerAttrs:0,storingCharacters:!1,tmxFileName:null,currentString:null,_objectGroups:null,_mapSize:null,_tileSize:null,_layers:null,_tilesets:null,_tileProperties:null,_resources:"",_currentFirstGID:0,ctor:function(e,t){cc.SAXParser.prototype.ctor.apply(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),this._layers=[],this._tilesets=[],this._objectGroups=[],this.properties=[],this._tileProperties={},this._currentFirstGID=0,void 0!==t?this.initWithXML(e,t):void 0!==e&&this.initWithTMXFile(e)},getOrientation:function(){return this.orientation},setOrientation:function(e){this.orientation=e},getMapSize:function(){return cc.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(e){this._mapSize.width=e.width,this._mapSize.height=e.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(e){this._mapSize.width=e},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(e){this._mapSize.height=e},getTileSize:function(){return cc.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(e){this._tileSize.width=e.width,this._tileSize.height=e.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(e){this._tileSize.width=e},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(e){this._tileSize.height=e},getLayers:function(){return this._layers},setLayers:function(e){this._layers.push(e)},getTilesets:function(){return this._tilesets},setTilesets:function(e){this._tilesets.push(e)},getObjectGroups:function(){return this._objectGroups},setObjectGroups:function(e){this._objectGroups.push(e)},getParentElement:function(){return this.parentElement},setParentElement:function(e){this.parentElement=e},getParentGID:function(){return this.parentGID},setParentGID:function(e){this.parentGID=e},getLayerAttribs:function(){return this.layerAttrs},setLayerAttribs:function(e){this.layerAttrs=e},getStoringCharacters:function(){return this.storingCharacters},setStoringCharacters:function(e){this.storingCharacters=e},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e},initWithTMXFile:function(e){return this._internalInit(e,null),this.parseXMLFile(e)},initWithXML:function(e,t){return this._internalInit(null,t),this.parseXMLString(e)},parseXMLFile:function(e,t){var i=(t=t||!1)?e:cc.loader.getRes(e);if(!i)throw"Please load the resource first : "+e;var n,r,o=this._parseXML(i).documentElement,s=o.getAttribute("version"),a=o.getAttribute("orientation");if("map"==o.nodeName){"1.0"!=s&&null!==s&&cc.log("cocos2d: TMXFormat: Unsupported TMX version:"+s),"orthogonal"==a?this.orientation=cc.TMX_ORIENTATION_ORTHO:"isometric"==a?this.orientation=cc.TMX_ORIENTATION_ISO:"hexagonal"==a?this.orientation=cc.TMX_ORIENTATION_HEX:null!==a&&cc.log("cocos2d: TMXFomat: Unsupported orientation:"+a);var c=cc.size(0,0);c.width=parseFloat(o.getAttribute("width")),c.height=parseFloat(o.getAttribute("height")),this.setMapSize(c),(c=cc.size(0,0)).width=parseFloat(o.getAttribute("tilewidth")),c.height=parseFloat(o.getAttribute("tileheight")),this.setTileSize(c);var l=o.querySelectorAll("map > properties >  property");if(l){var u={};for(n=0;n<l.length;n++)u[l[n].getAttribute("name")]=l[n].getAttribute("value");this.properties=u}}var h=o.getElementsByTagName("tileset");for("map"!==o.nodeName&&(h=[]).push(o),n=0;n<h.length;n++){var d=h[n],p=d.getAttribute("source");if(p){var _=t?cc.path.join(this._resources,p):cc.path.changeBasename(e,p);this.parseXMLFile(_)}else{var f=new cc.TMXTilesetInfo;f.name=d.getAttribute("name")||"",f.firstGid=parseInt(d.getAttribute("firstgid"))||0,f.spacing=parseInt(d.getAttribute("spacing"))||0,f.margin=parseInt(d.getAttribute("margin"))||0;var m=cc.size(0,0);m.width=parseFloat(d.getAttribute("tilewidth")),m.height=parseFloat(d.getAttribute("tileheight")),f._tileSize=m;var g=d.getElementsByTagName("image")[0].getAttribute("source"),y=-1;if(this.tmxFileName&&(y=this.tmxFileName.lastIndexOf("/")),-1!==y){var T=this.tmxFileName.substr(0,y+1);f.sourceImage=T+g}else f.sourceImage=this._resources+(this._resources?"/":"")+g;this.setTilesets(f);var v=d.getElementsByTagName("tile");if(v)for(var S=0;S<v.length;S++){var C=v[S];this.parentGID=parseInt(f.firstGid)+parseInt(C.getAttribute("id")||0);var E=C.querySelectorAll("properties > property");if(E){var b={};for(r=0;r<E.length;r++)b[E[r].getAttribute("name")]=E[r].getAttribute("value");this._tileProperties[this.parentGID]=b}}}}var A=o.getElementsByTagName("layer");if(A)for(n=0;n<A.length;n++){var x=A[n],R=x.getElementsByTagName("data")[0],P=new cc.TMXLayerInfo;P.name=x.getAttribute("name");var I=cc.size(0,0);I.width=parseFloat(x.getAttribute("width")),I.height=parseFloat(x.getAttribute("height")),P._layerSize=I;var w=x.getAttribute("visible");P.visible=!("0"==w);var N=x.getAttribute("opacity")||1;P._opacity=N?parseInt(255*parseFloat(N)):255,P.offset=cc.p(parseFloat(x.getAttribute("x"))||0,parseFloat(x.getAttribute("y"))||0);var L="";for(r=0;r<R.childNodes.length;r++)L+=R.childNodes[r].nodeValue;L=L.trim();var O=R.getAttribute("compression"),D=R.getAttribute("encoding");if(O&&"gzip"!==O&&"zlib"!==O)return cc.log("cc.TMXMapInfo.parseXMLFile(): unsupported compression method"),null;switch(O){case"gzip":P._tiles=cc.unzipBase64AsArray(L,4);break;case"zlib":var F=new Zlib.Inflate(cc.Codec.Base64.decodeAsArray(L,1));P._tiles=cc.uint8ArrayToUint32Array(F.decompress());break;case null:case"":if("base64"==D)P._tiles=cc.Codec.Base64.decodeAsArray(L,4);else if("csv"===D){P._tiles=[];for(var B=L.split(","),M=0;M<B.length;M++)P._tiles.push(parseInt(B[M]))}else{var k=R.getElementsByTagName("tile");P._tiles=[];for(var W=0;W<k.length;W++)P._tiles.push(parseInt(k[W].getAttribute("gid")))}break;default:this.layerAttrs==cc.TMXLayerInfo.ATTRIB_NONE&&cc.log("cc.TMXMapInfo.parseXMLFile(): Only base64 and/or gzip/zlib maps are supported")}var V=x.querySelectorAll("properties > property");if(V){var z={};for(r=0;r<V.length;r++)z[V[r].getAttribute("name")]=V[r].getAttribute("value");P.properties=z}this.setLayers(P)}var G=o.getElementsByTagName("objectgroup");if(G)for(n=0;n<G.length;n++){var U=G[n],Y=new cc.TMXObjectGroup;Y.groupName=U.getAttribute("name"),Y.setPositionOffset(cc.p(parseFloat(U.getAttribute("x"))*this.getTileSize().width||0,parseFloat(U.getAttribute("y"))*this.getTileSize().height||0));var H=U.querySelectorAll("objectgroup > properties > property");if(H)for(r=0;r<H.length;r++){var X={};X[H[r].getAttribute("name")]=H[r].getAttribute("value"),Y.properties=X}var q=U.querySelectorAll("object");if(q)for(r=0;r<q.length;r++){var j=q[r],K={};K.name=j.getAttribute("name")||"",K.type=j.getAttribute("type")||"",K.x=parseInt(j.getAttribute("x")||0)+Y.getPositionOffset().x;var Q=parseInt(j.getAttribute("y")||0)+Y.getPositionOffset().y;K.width=parseInt(j.getAttribute("width"))||0,K.height=parseInt(j.getAttribute("height"))||0,K.y=parseInt(this.getMapSize().height*this.getTileSize().height)-Q-K.height,K.rotation=parseInt(j.getAttribute("rotation"))||0;var Z=j.querySelectorAll("properties > property");if(Z)for(var J=0;J<Z.length;J++)K[Z[J].getAttribute("name")]=Z[J].getAttribute("value");var $=j.querySelectorAll("polygon");if($&&$.length>0){var ee=$[0].getAttribute("points");ee&&(K.polygonPoints=this._parsePointsString(ee))}var te=j.querySelectorAll("polyline");if(te&&te.length>0){var ie=te[0].getAttribute("points");ie&&(K.polylinePoints=this._parsePointsString(ie))}Y.setObjects(K)}this.setObjectGroups(Y)}return o},_parsePointsString:function(e){if(!e)return null;for(var t=[],i=e.split(" "),n=0;n<i.length;n++){var r=i[n].split(",");t.push({x:r[0],y:r[1]})}return t},parseXMLString:function(e){return this.parseXMLFile(e,!0)},getTileProperties:function(){return this._tileProperties},setTileProperties:function(e){this._tileProperties.push(e)},getCurrentString:function(){return this.currentString},setCurrentString:function(e){this.currentString=e},getTMXFileName:function(){return this.tmxFileName},setTMXFileName:function(e){this.tmxFileName=e},_internalInit:function(e,t){this._tilesets.length=0,this._layers.length=0,this.tmxFileName=e,t&&(this._resources=t),this._objectGroups.length=0,this.properties.length=0,this._tileProperties.length=0,this.currentString="",this.storingCharacters=!1,this.layerAttrs=cc.TMXLayerInfo.ATTRIB_NONE,this.parentElement=cc.TMX_PROPERTY_NONE,this._currentFirstGID=0}}),(_p=cc.TMXMapInfo.prototype).mapWidth,cc.defineGetterSetter(_p,"mapWidth",_p._getMapWidth,_p._setMapWidth),_p.mapHeight,cc.defineGetterSetter(_p,"mapHeight",_p._getMapHeight,_p._setMapHeight),_p.tileWidth,cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),_p.tileHeight,cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXMapInfo.create=function(e,t){return new cc.TMXMapInfo(e,t)},cc.loader.register(["tmx","tsx"],cc._txtLoader),cc.TMXLayerInfo.ATTRIB_NONE=1,cc.TMXLayerInfo.ATTRIB_BASE64=2,cc.TMXLayerInfo.ATTRIB_GZIP=4,cc.TMXLayerInfo.ATTRIB_ZLIB=8,cc.TMXObjectGroup=cc.Class.extend({properties:null,groupName:"",_positionOffset:null,_objects:null,ctor:function(){this.groupName="",this._positionOffset=cc.p(0,0),this.properties=[],this._objects=[]},getPositionOffset:function(){return cc.p(this._positionOffset)},setPositionOffset:function(e){this._positionOffset.x=e.x,this._positionOffset.y=e.y},getProperties:function(){return this.properties},setProperties:function(e){this.properties.push(e)},getGroupName:function(){return this.groupName.toString()},setGroupName:function(e){this.groupName=e},propertyNamed:function(e){return this.properties[e]},objectNamed:function(e){if(this._objects&&this._objects.length>0)for(var t=this._objects,i=0,n=t.length;i<n;i++){var r=t[i].name;if(r&&r==e)return t[i]}return null},getObjects:function(){return this._objects},setObjects:function(e){this._objects.push(e)}}),cc.TMXLayer=cc.SpriteBatchNode.extend({tiles:null,tileset:null,layerOrientation:null,properties:null,layerName:"",_layerSize:null,_mapTileSize:null,_opacity:255,_minGID:null,_maxGID:null,_vertexZvalue:null,_useAutomaticVertexZ:null,_reusedTile:null,_atlasIndexArray:null,_contentScaleFactor:null,_className:"TMXLayer",ctor:function(e,t,i){cc.SpriteBatchNode.prototype.ctor.call(this),this._descendants=[],this._layerSize=cc.size(0,0),this._mapTileSize=cc.size(0,0),void 0!==i&&this.initWithTilesetInfo(e,t,i)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.TMXLayer.CanvasRenderCmd(this):new cc.TMXLayer.WebGLRenderCmd(this)},setContentSize:function(e,t){cc.Node.prototype.setContentSize.call(this,e,t),this._renderCmd._updateCacheContext(e,t)},getTexture:function(){return this._renderCmd.getTexture()},getLayerSize:function(){return cc.size(this._layerSize.width,this._layerSize.height)},setLayerSize:function(e){this._layerSize.width=e.width,this._layerSize.height=e.height},_getLayerWidth:function(){return this._layerSize.width},_setLayerWidth:function(e){this._layerSize.width=e},_getLayerHeight:function(){return this._layerSize.height},_setLayerHeight:function(e){this._layerSize.height=e},getMapTileSize:function(){return cc.size(this._mapTileSize.width,this._mapTileSize.height)},setMapTileSize:function(e){this._mapTileSize.width=e.width,this._mapTileSize.height=e.height},_getTileWidth:function(){return this._mapTileSize.width},_setTileWidth:function(e){this._mapTileSize.width=e},_getTileHeight:function(){return this._mapTileSize.height},_setTileHeight:function(e){this._mapTileSize.height=e},getTiles:function(){return this.tiles},setTiles:function(e){this.tiles=e},getTileset:function(){return this.tileset},setTileset:function(e){this.tileset=e},getLayerOrientation:function(){return this.layerOrientation},setLayerOrientation:function(e){this.layerOrientation=e},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e},initWithTilesetInfo:function(e,t,i){var n,r=t._layerSize,o=.35*parseInt(r.width*r.height)+1;if(e&&(n=cc.textureCache.addImage(e.sourceImage)),this.initWithTexture(n,o)){this.layerName=t.name,this._layerSize=r,this.tiles=t._tiles,this._minGID=t._minGID,this._maxGID=t._maxGID,this._opacity=t._opacity,this.properties=t.properties,this._contentScaleFactor=cc.director.getContentScaleFactor(),this.tileset=e,this._mapTileSize=i.getTileSize(),this.layerOrientation=i.orientation;var s=this._calculateLayerOffset(t.offset);return this.setPosition(cc.pointPixelsToPoints(s)),this._atlasIndexArray=[],this.setContentSize(cc.sizePixelsToPoints(cc.size(this._layerSize.width*this._mapTileSize.width,this._layerSize.height*this._mapTileSize.height))),this._useAutomaticVertexZ=!1,this._vertexZvalue=0,!0}return!1},releaseMap:function(){this.tiles&&(this.tiles=null),this._atlasIndexArray&&(this._atlasIndexArray=null)},getTileAt:function(e,t){if(!e)throw"cc.TMXLayer.getTileAt(): pos should be non-null";if(void 0!==t&&(e=cc.p(e,t)),e.x>=this._layerSize.width||e.y>=this._layerSize.height||e.x<0||e.y<0)throw"cc.TMXLayer.getTileAt(): invalid position";if(!this.tiles||!this._atlasIndexArray)return cc.log("cc.TMXLayer.getTileAt(): TMXLayer: the tiles map has been released"),null;var i=null,n=this.getTileGIDAt(e);if(0===n)return i;var r=0|e.x+e.y*this._layerSize.width;if(!(i=this.getChildByTag(r))){var o=this.tileset.rectForGID(n);o=cc.rectPixelsToPoints(o),(i=new cc.Sprite).initWithTexture(this.texture,o),i.batchNode=this,i.setPosition(this.getPositionAt(e)),i.vertexZ=this._vertexZForPos(e),i.anchorX=0,i.anchorY=0,i.opacity=this._opacity;var s=this._atlasIndexForExistantZ(r);this.addSpriteWithoutQuad(i,s,r)}return i},getTileGIDAt:function(e,t){if(!e)throw"cc.TMXLayer.getTileGIDAt(): pos should be non-null";if(void 0!==t&&(e=cc.p(e,t)),e.x>=this._layerSize.width||e.y>=this._layerSize.height||e.x<0||e.y<0)throw"cc.TMXLayer.getTileGIDAt(): invalid position";if(!this.tiles||!this._atlasIndexArray)return cc.log("cc.TMXLayer.getTileGIDAt(): TMXLayer: the tiles map has been released"),null;var i=0|e.x+e.y*this._layerSize.width;return(this.tiles[i]&cc.TMX_TILE_FLIPPED_MASK)>>>0},getTileFlagsAt:function(e,t){if(!e)throw"cc.TMXLayer.getTileFlagsAt(): pos should be non-null";if(void 0!==t&&(e=cc.p(e,t)),e.x>=this._layerSize.width||e.y>=this._layerSize.height||e.x<0||e.y<0)throw"cc.TMXLayer.getTileFlagsAt(): invalid position";if(!this.tiles||!this._atlasIndexArray)return cc.log("cc.TMXLayer.getTileFlagsAt(): TMXLayer: the tiles map has been released"),null;var i=0|e.x+e.y*this._layerSize.width;return(this.tiles[i]&cc.TMX_TILE_FLIPPED_ALL)>>>0},setTileGID:function(e,t,i,n){if(!t)throw"cc.TMXLayer.setTileGID(): pos should be non-null";var r;if(void 0!==n?r=cc.p(t,i):(r=t,n=i),r.x>=this._layerSize.width||r.y>=this._layerSize.height||r.x<0||r.y<0)throw"cc.TMXLayer.setTileGID(): invalid position";if(this.tiles&&this._atlasIndexArray)if(0!==e&&e<this.tileset.firstGid)cc.log("cc.TMXLayer.setTileGID(): invalid gid:"+e);else{n=n||0,this._setNodeDirtyForCache();var o=this.getTileFlagsAt(r),s=this.getTileGIDAt(r);if(s!=e||o!=n){var a=(e|n)>>>0;if(0===e)this.removeTileAt(r);else if(0===s)this._insertTileForGID(a,r);else{var c=r.x+r.y*this._layerSize.width,l=this.getChildByTag(c);if(l){var u=this.tileset.rectForGID(e);u=cc.rectPixelsToPoints(u),l.setTextureRect(u,!1),null!=n&&this._setupTileSprite(l,r,a),this.tiles[c]=a}else this._updateTileForGID(a,r)}}}else cc.log("cc.TMXLayer.setTileGID(): TMXLayer: the tiles map has been released")},removeTileAt:function(e,t){if(!e)throw"cc.TMXLayer.removeTileAt(): pos should be non-null";if(void 0!==t&&(e=cc.p(e,t)),e.x>=this._layerSize.width||e.y>=this._layerSize.height||e.x<0||e.y<0)throw"cc.TMXLayer.removeTileAt(): invalid position";if(this.tiles&&this._atlasIndexArray){if(0!==this.getTileGIDAt(e)){cc._renderType===cc._RENDER_TYPE_CANVAS&&this._setNodeDirtyForCache();var i=0|e.x+e.y*this._layerSize.width,n=this._atlasIndexForExistantZ(i);this.tiles[i]=0,this._atlasIndexArray.splice(n,1);var r=this.getChildByTag(i);if(r)cc.SpriteBatchNode.prototype.removeChild.call(this,r,!0);else if(cc._renderType===cc._RENDER_TYPE_WEBGL&&this.textureAtlas.removeQuadAtIndex(n),this._children)for(var o=this._children,s=0,a=o.length;s<a;s++){var c=o[s];if(c){var l=c.atlasIndex;l>=n&&(c.atlasIndex=l-1)}}}}else cc.log("cc.TMXLayer.removeTileAt(): TMXLayer: the tiles map has been released")},getPositionAt:function(e,t){void 0!==t&&(e=cc.p(e,t));var i=cc.p(0,0);switch(this.layerOrientation){case cc.TMX_ORIENTATION_ORTHO:i=this._positionForOrthoAt(e);break;case cc.TMX_ORIENTATION_ISO:i=this._positionForIsoAt(e);break;case cc.TMX_ORIENTATION_HEX:i=this._positionForHexAt(e)}return cc.pointPixelsToPoints(i)},getProperty:function(e){return this.properties[e]},setupTiles:function(){this._renderCmd.initImageSize(),this._parseInternalProperties(),cc._renderType===cc._RENDER_TYPE_CANVAS&&this._setNodeDirtyForCache();for(var e=this._layerSize.height,t=this._layerSize.width,i=0;i<e;i++)for(var n=0;n<t;n++){var r=n+t*i,o=this.tiles[r];0!==o&&(this._appendTileForGID(o,cc.p(n,i)),this._minGID=Math.min(o,this._minGID),this._maxGID=Math.max(o,this._maxGID))}this._maxGID>=this.tileset.firstGid&&this._minGID>=this.tileset.firstGid||cc.log("cocos2d:TMX: Only 1 tileset per layer is supported")},addChild:function(e,t,i){cc.log("addChild: is not supported on cc.TMXLayer. Instead use setTileGID or tileAt.")},removeChild:function(e,t){if(e)if(-1!==this._children.indexOf(e)){cc._renderType===cc._RENDER_TYPE_CANVAS&&this._setNodeDirtyForCache();var i=e.atlasIndex,n=this._atlasIndexArray[i];this.tiles[n]=0,this._atlasIndexArray.splice(i,1),cc.SpriteBatchNode.prototype.removeChild.call(this,e,t),cc.renderer.childrenOrderDirty=!0}else cc.log("cc.TMXLayer.removeChild(): Tile does not belong to TMXLayer")},getLayerName:function(){return this.layerName},setLayerName:function(e){this.layerName=e},_positionForIsoAt:function(e){return cc.p(this._mapTileSize.width/2*(this._layerSize.width+e.x-e.y-1),this._mapTileSize.height/2*(2*this._layerSize.height-e.x-e.y-2))},_positionForOrthoAt:function(e){return cc.p(e.x*this._mapTileSize.width,(this._layerSize.height-e.y-1)*this._mapTileSize.height)},_positionForHexAt:function(e){var t=e.x%2==1?-this._mapTileSize.height/2:0;return cc.p(e.x*this._mapTileSize.width*3/4,(this._layerSize.height-e.y-1)*this._mapTileSize.height+t)},_calculateLayerOffset:function(e){var t=cc.p(0,0);switch(this.layerOrientation){case cc.TMX_ORIENTATION_ORTHO:t=cc.p(e.x*this._mapTileSize.width,-e.y*this._mapTileSize.height);break;case cc.TMX_ORIENTATION_ISO:t=cc.p(this._mapTileSize.width/2*(e.x-e.y),this._mapTileSize.height/2*(-e.x-e.y));break;case cc.TMX_ORIENTATION_HEX:0===e.x&&0===e.y||cc.log("offset for hexagonal map not implemented yet")}return t},_appendTileForGID:function(e,t){var i=this.tileset.rectForGID(e);i=cc.rectPixelsToPoints(i);var n=0|t.x+t.y*this._layerSize.width,r=this._renderCmd._reusedTileWithRect(i);this._setupTileSprite(r,t,e);var o=this._atlasIndexArray.length;return this.insertQuadFromSprite(r,o),this._atlasIndexArray.splice(o,0,n),r},_insertTileForGID:function(e,t){var i=this.tileset.rectForGID(e);i=cc.rectPixelsToPoints(i);var n=0|t.x+t.y*this._layerSize.width,r=this._renderCmd._reusedTileWithRect(i);this._setupTileSprite(r,t,e);var o=this._atlasIndexForNewZ(n);if(this.insertQuadFromSprite(r,o),this._atlasIndexArray.splice(o,0,n),this._children)for(var s=this._children,a=0,c=s.length;a<c;a++){var l=s[a];if(l){var u=l.atlasIndex;u>=o&&(l.atlasIndex=u+1)}}return this.tiles[n]=e,r},_updateTileForGID:function(e,t){var i=this.tileset.rectForGID(e),n=this._contentScaleFactor;i=cc.rect(i.x/n,i.y/n,i.width/n,i.height/n);var r=t.x+t.y*this._layerSize.width,o=this._renderCmd._reusedTileWithRect(i);return this._setupTileSprite(o,t,e),o.atlasIndex=this._atlasIndexForExistantZ(r),o.dirty=!0,o.updateTransform(),this.tiles[r]=e,o},_parseInternalProperties:function(){var e=this.getProperty("cc_vertexz");if(e)if("automatic"==e){this._useAutomaticVertexZ=!0;var t=this.getProperty("cc_alpha_func"),i=0;if(t&&(i=parseFloat(t)),cc._renderType===cc._RENDER_TYPE_WEBGL){this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST);var n=cc._renderContext.getUniformLocation(this.shaderProgram.getProgram(),cc.UNIFORM_ALPHA_TEST_VALUE_S);this.shaderProgram.use(),this.shaderProgram.setUniformLocationWith1f(n,i)}}else this._vertexZvalue=parseInt(e,10)},_setupTileSprite:function(e,t,i){var n=t.x+t.y*this._layerSize.width;if(e.setPosition(this.getPositionAt(t)),cc._renderType===cc._RENDER_TYPE_WEBGL?e.vertexZ=this._vertexZForPos(t):e.tag=n,e.anchorX=0,e.anchorY=0,e.opacity=this._opacity,cc._renderType===cc._RENDER_TYPE_WEBGL&&(e.rotation=0),e.setFlippedX(!1),e.setFlippedY(!1),(i&cc.TMX_TILE_DIAGONAL_FLAG)>>>0){e.anchorX=.5,e.anchorY=.5,e.x=this.getPositionAt(t).x+e.width/2,e.y=this.getPositionAt(t).y+e.height/2;var r=(i&(cc.TMX_TILE_HORIZONTAL_FLAG|cc.TMX_TILE_VERTICAL_FLAG)>>>0)>>>0;r==cc.TMX_TILE_HORIZONTAL_FLAG?e.rotation=90:r==cc.TMX_TILE_VERTICAL_FLAG?e.rotation=270:r==(cc.TMX_TILE_VERTICAL_FLAG|cc.TMX_TILE_HORIZONTAL_FLAG)>>>0?(e.rotation=90,e.setFlippedX(!0)):(e.rotation=270,e.setFlippedX(!0))}else(i&cc.TMX_TILE_HORIZONTAL_FLAG)>>>0&&e.setFlippedX(!0),(i&cc.TMX_TILE_VERTICAL_FLAG)>>>0&&e.setFlippedY(!0)},_vertexZForPos:function(e){var t=0;if(this._useAutomaticVertexZ)switch(this.layerOrientation){case cc.TMX_ORIENTATION_ISO:t=-(this._layerSize.width+this._layerSize.height-(e.x+e.y));break;case cc.TMX_ORIENTATION_ORTHO:t=-(this._layerSize.height-e.y);break;case cc.TMX_ORIENTATION_HEX:cc.log("TMX Hexa zOrder not supported");break;default:cc.log("TMX invalid value")}else t=this._vertexZvalue;return t},_atlasIndexForExistantZ:function(e){var t;if(this._atlasIndexArray)for(var i=this._atlasIndexArray,n=0,r=i.length;n<r&&(t=i[n])!=e;n++);return cc.isNumber(t)||cc.log("cc.TMXLayer._atlasIndexForExistantZ(): TMX atlas index not found. Shall not happen"),n},_atlasIndexForNewZ:function(e){for(var t=this._atlasIndexArray,i=0,n=t.length;i<n&&!(e<t[i]);i++);return i}});var _p=cc.TMXLayer.prototype;cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),_p.layerWidth,cc.defineGetterSetter(_p,"layerWidth",_p._getLayerWidth,_p._setLayerWidth),_p.layerHeight,cc.defineGetterSetter(_p,"layerHeight",_p._getLayerHeight,_p._setLayerHeight),_p.tileWidth,cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),_p.tileHeight,cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXLayer.create=function(e,t,i){return new cc.TMXLayer(e,t,i)},function(){cc.TMXLayer.CanvasRenderCmd=function(e){cc.SpriteBatchNode.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._realWorldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._childrenRenderCmds=[];var t=cc._canvas,i=cc.newElement("canvas");i.width=t.width,i.height=t.height,this._cacheCanvas=i,this._cacheContext=new cc.CanvasContextWrapper(this._cacheCanvas.getContext("2d"));var n=new cc.Texture2D;n.initWithElement(i),n.handleLoadedTexture(),this._cacheTexture=n,this._cacheDirty=!1};var e=cc.TMXLayer.CanvasRenderCmd.prototype=Object.create(cc.SpriteBatchNode.CanvasRenderCmd.prototype);e.constructor=cc.TMXLayer.CanvasRenderCmd,e._copyRendererCmds=function(e){if(e){var t=this._childrenRenderCmds;t.length=0;for(var i=0,n=e.length;i<n;i++)t[i]=e[i]}},e._setNodeDirtyForCache=function(){this._cacheDirty=!0},e._renderingChildToCache=function(e,t){if(this._cacheDirty){var i=this._childrenRenderCmds,n=this._cacheContext,r=n.getContext(),o=this._cacheCanvas;r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,o.width,o.height);for(var s=0,a=i.length;s<a;s++)i[s].rendering(n,e,t),i[s]._cacheDirty=!1;this._cacheDirty=!1}},e.rendering=function(e,t,i){var n=this._displayedOpacity/255;if(!(n<=0)){var r=this._node;this._renderingChildToCache(t,i);var o=e||cc._renderContext,s=o.getContext();o.setGlobalAlpha(n);var a=0|-this._anchorPointInPoints.x,c=0|-this._anchorPointInPoints.y,l=this._cacheCanvas;if(l&&0!==l.width&&0!==l.height){o.setTransform(this._realWorldTransform,t,i);var u=l.height*i;if(r.layerOrientation===cc.TMX_ORIENTATION_HEX){var h=.5*r._mapTileSize.height*i;s.drawImage(l,0,0,l.width,l.height,a,-(c+u)+h,l.width*t,u)}else s.drawImage(l,0,0,l.width,l.height,a,-(c+u),l.width*t,u)}cc.g_NumberOfDraws++}},e._updateCacheContext=function(e,t){var i=this._node,n=i._contentSize,r=this._cacheCanvas,o=cc.contentScaleFactor();r.width=0|1.5*n.width*o,r.height=0|1.5*n.height*o,i.layerOrientation===cc.TMX_ORIENTATION_HEX?this._cacheContext.setOffset(0,.5*-i._mapTileSize.height):this._cacheContext.setOffset(0,0);var s=this._cacheTexture._contentSize;s.width=r.width,s.height=r.height},e.getTexture=function(){return this._cacheTexture},e.visit=function(e){var t,i,n=this._node,r=n._children;if(n._visible&&r&&0!==r.length){if((e=e||this.getParentRenderCmd())&&(this._curLevel=e._curLevel+1),this._syncStatus(e),this._cacheDirty){var o=this._cacheContext,s=this._cacheCanvas,a=o.getContext(),c=n.__instanceId,l=cc.renderer;for(l._turnToCacheMode(c),n.sortAllChildren(),t=0,i=r.length;t<i;t++)if(r[t]){var u=r[t]._renderCmd;u&&(u.visit(this),u._cacheDirty=!1)}this._copyRendererCmds(l._cacheToCanvasCmds[c]),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,s.width,s.height),l._renderingToCacheCanvas(o,c),this._cacheDirty=!1}cc.renderer.pushRenderCommand(this),this._dirtyFlag=0}},e.transform=function(e,t){var i=this.getNodeToParentTransform(),n=this._realWorldTransform;if(e){var r=e._worldTransform;n.a=i.a*r.a+i.b*r.c,n.b=i.a*r.b+i.b*r.d,n.c=i.c*r.a+i.d*r.c,n.d=i.c*r.b+i.d*r.d;var o=e._transform,s=-(o.b+o.c)*i.ty,a=-(o.b+o.c)*i.tx;n.tx=i.tx*r.a+i.ty*r.c+r.tx+s,n.ty=i.tx*r.b+i.ty*r.d+r.ty+a}else n.a=i.a,n.b=i.b,n.c=i.c,n.d=i.d,n.tx=i.tx,n.ty=i.ty;if(t){var c=this._node._children;if(!c||0===c.length)return;var l,u;for(l=0,u=c.length;l<u;l++)c[l]._renderCmd.transform(this,t)}},e.initImageSize=function(){this._node.tileset.imageSize=this._originalTexture.getContentSizeInPixels()},e._reusedTileWithRect=function(e){var t=this._node;return t._reusedTile=new cc.Sprite,t._reusedTile.initWithTexture(t._renderCmd._texture,e,!1),t._reusedTile.batchNode=t,t._reusedTile.parent=t,t._reusedTile._renderCmd._cachedParent=t._renderCmd,t._reusedTile}}(),function(){cc.TMXLayer.WebGLRenderCmd=function(e){cc.SpriteBatchNode.WebGLRenderCmd.call(this,e),this._needDraw=!0};var e=cc.TMXLayer.WebGLRenderCmd.prototype=Object.create(cc.SpriteBatchNode.WebGLRenderCmd.prototype);e.constructor=cc.TMXLayer.WebGLRenderCmd,e._updateCacheContext=function(){},e.initImageSize=function(){this._node.tileset.imageSize=this._textureAtlas.texture.getContentSizeInPixels(),this._textureAtlas.texture.setAliasTexParameters()},e._reusedTileWithRect=function(e){var t=this._node;return t._reusedTile?(t._reusedTile.batchNode=null,t._reusedTile.setTextureRect(e,!1),t._reusedTile.batchNode=t):(t._reusedTile=new cc.Sprite,t._reusedTile.initWithTexture(t.texture,e,!1),t._reusedTile.batchNode=t),t._reusedTile}}(),cc.PointObject=cc.Class.extend({_ratio:null,_offset:null,_child:null,ctor:function(e,t){this.initWithCCPoint(e,t)},getRatio:function(){return this._ratio},setRatio:function(e){this._ratio=e},getOffset:function(){return this._offset},setOffset:function(e){this._offset=e},getChild:function(){return this._child},setChild:function(e){this._child=e},initWithCCPoint:function(e,t){return this._ratio=e,this._offset=t,this._child=null,!0}}),cc.PointObject.create=function(e,t){return new cc.PointObject(e,t)},cc.ParallaxNode=cc.Node.extend({parallaxArray:null,_lastPosition:null,_className:"ParallaxNode",getParallaxArray:function(){return this.parallaxArray},setParallaxArray:function(e){this.parallaxArray=e},ctor:function(){cc.Node.prototype.ctor.call(this),this.parallaxArray=[],this._lastPosition=cc.p(-100,-100)},addChild:function(e,t,i,n){if(3!==arguments.length){if(!e)throw"cc.ParallaxNode.addChild(): child should be non-null";var r=new cc.PointObject(i,n);r.setChild(e),this.parallaxArray.push(r),e.setPosition(this._position.x*i.x+n.x,this._position.y*i.y+n.y),cc.Node.prototype.addChild.call(this,e,t,e.tag)}else cc.log("ParallaxNode: use addChild(child, z, ratio, offset) instead")},removeChild:function(e,t){for(var i=this.parallaxArray,n=0;n<i.length;n++)if(i[n].getChild()==e){i.splice(n,1);break}cc.Node.prototype.removeChild.call(this,e,t)},removeAllChildren:function(e){this.parallaxArray.length=0,cc.Node.prototype.removeAllChildren.call(this,e)},_updateParallaxPosition:function(){var e=this._absolutePosition();if(!cc.pointEqualToPoint(e,this._lastPosition)){for(var t=this.parallaxArray,i=0,n=t.length;i<n;i++){var r=t[i];r.getChild().setPosition(-e.x+e.x*r.getRatio().x+r.getOffset().x,-e.y+e.y*r.getRatio().y+r.getOffset().y)}this._lastPosition=e}},_absolutePosition:function(){for(var e=this._position,t=this;null!=t.parent;)t=t.parent,e=cc.pAdd(e,t.getPosition());return e},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.ParallaxNode.CanvasRenderCmd(this):new cc.ParallaxNode.WebGLRenderCmd(this)}}),cc.ParallaxNode.create=function(){return new cc.ParallaxNode},function(){cc.ParallaxNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!1};var e=cc.ParallaxNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.ParallaxNode.CanvasRenderCmd,e.updateStatus=function(){this._node._updateParallaxPosition(),cc.Node.CanvasRenderCmd.prototype.updateStatus.call(this)},e._syncStatus=function(e){this._node._updateParallaxPosition(),cc.Node.CanvasRenderCmd.prototype._syncStatus.call(this,e)}}(),function(){if(cc._renderType===cc._RENDER_TYPE_WEBGL){cc.ParallaxNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!1};var e=cc.ParallaxNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.ParallaxNode.WebGLRenderCmd,e.updateStatus=function(){this._node._updateParallaxPosition(),cc.Node.WebGLRenderCmd.prototype.updateStatus.call(this)},e._syncStatus=function(e){this._node._updateParallaxPosition(),cc.Node.WebGLRenderCmd.prototype._syncStatus.call(this,e)}}}(),function(){var e=cc.sys,t={common:{multichannel:!0,webAudio:cc.sys._supportWebAudio,auto:!0}};t[e.BROWSER_TYPE_IE]={multichannel:!0,webAudio:cc.sys._supportWebAudio,auto:!0,emptied:!0},t[e.BROWSER_TYPE_ANDROID]={multichannel:!1,webAudio:!1,auto:!1},t[e.BROWSER_TYPE_CHROME]={multichannel:!0,webAudio:!0,auto:!1},t[e.BROWSER_TYPE_FIREFOX]={multichannel:!0,webAudio:!0,auto:!0},t[e.BROWSER_TYPE_UC]={multichannel:!0,webAudio:!1,auto:!1},t[e.BROWSER_TYPE_QQ]={multichannel:!1,webAudio:!1,auto:!0},t[e.BROWSER_TYPE_OUPENG]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0},t[e.BROWSER_TYPE_WECHAT]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0},t[e.BROWSER_TYPE_360]={multichannel:!1,webAudio:!1,auto:!0},t[e.BROWSER_TYPE_MIUI]={multichannel:!1,webAudio:!1,auto:!0},t[e.BROWSER_TYPE_LIEBAO]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0},t[e.BROWSER_TYPE_SOUGOU]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0},t[e.BROWSER_TYPE_BAIDU]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0},t[e.BROWSER_TYPE_BAIDU_APP]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0},t[e.BROWSER_TYPE_SAFARI]={multichannel:!0,webAudio:!0,auto:!1,webAudioCallback:function(e){document.createElement("audio").src=e}};var i,n;try{var r=navigator.userAgent.toLowerCase();switch(e.browserType){case e.BROWSER_TYPE_IE:n=r.match(/(msie |rv:)([\d.]+)/);break;case e.BROWSER_TYPE_FIREFOX:n=r.match(/(firefox\/|rv:)([\d.]+)/);break;case e.BROWSER_TYPE_CHROME:n=r.match(/chrome\/([\d.]+)/);break;case e.BROWSER_TYPE_BAIDU:n=r.match(/baidubrowser\/([\d.]+)/);break;case e.BROWSER_TYPE_UC:n=r.match(/ucbrowser\/([\d.]+)/);break;case e.BROWSER_TYPE_QQ:n=r.match(/qqbrowser\/([\d.]+)/);break;case e.BROWSER_TYPE_OUPENG:n=r.match(/oupeng\/([\d.]+)/);break;case e.BROWSER_TYPE_WECHAT:n=r.match(/micromessenger\/([\d.]+)/);break;case e.BROWSER_TYPE_SAFARI:n=r.match(/safari\/([\d.]+)/);break;case e.BROWSER_TYPE_MIUI:n=r.match(/miuibrowser\/([\d.]+)/)}i=n?n[1]:""}catch(e){console.log(e)}if(i)switch(e.browserType){case e.BROWSER_TYPE_CHROME:parseInt(i)<30&&(t[e.BROWSER_TYPE_CHROME]={multichannel:!1,webAudio:!0,auto:!1});break;case e.BROWSER_TYPE_MIUI:((i=i.match(/\d+/g))[0]<2||2==i[0]&&0==i[1]&&i[2]<=1)&&(t[e.BROWSER_TYPE_MIUI].auto=!1)}cc.sys.isMobile?cc.sys.os!=cc.sys.OS_IOS?cc.__audioSupport=t[e.browserType]||t.common:cc.__audioSupport=t[e.BROWSER_TYPE_SAFARI]:cc.sys.browserType!=cc.sys.BROWSER_TYPE_IE?cc.__audioSupport=t.common:cc.__audioSupport=t[e.BROWSER_TYPE_IE]}(),cc.Audio=cc.Class.extend({volume:1,loop:!1,src:null,_touch:!1,_playing:!1,_AUDIO_TYPE:"AUDIO",_pause:!1,_buffer:null,_currentSource:null,_startTime:null,_currentTime:null,_context:null,_volume:null,_ignoreEnded:!1,_element:null,ctor:function(e,t,i){e&&(this._context=e),t&&(this._volume=t),e&&t&&(this._AUDIO_TYPE="WEBAUDIO"),this.src=i},_setBufferCallback:null,setBuffer:function(e){if(e){var t=this._playing;this._AUDIO_TYPE="WEBAUDIO",this._buffer&&this._buffer!=e&&this.getPlaying()&&this.stop(),this._buffer=e,t&&this.play(),this._volume.gain.value=this.volume,this._setBufferCallback&&this._setBufferCallback(e)}},_setElementCallback:null,setElement:function(e){if(e){var t=this._playing;this._AUDIO_TYPE="AUDIO",this._element&&this._element!=e&&this.getPlaying()&&this.stop(),this._element=e,t&&this.play(),e.volume=this.volume,e.loop=this.loop,this._setElementCallback&&this._setElementCallback(e)}},play:function(e,t){this._playing=!0,this.loop=void 0===t?this.loop:t,"AUDIO"===this._AUDIO_TYPE?this._playOfAudio(e):this._playOfWebAudio(e)},getPlaying:function(){if(!this._playing)return this._playing;if("AUDIO"===this._AUDIO_TYPE){var e=this._element;return!e||this._pause?(this._playing=!1,!1):!e.ended||(this._playing=!1,!1)}var t=this._currentSource;return!this._playing&&!t||(null==t.playbackState?this._playing:this._currentTime+this._context.currentTime-this._startTime<this._currentSource.buffer.duration)},_playOfWebAudio:function(e){var t=this._currentSource;if(this._buffer){if(!this._pause&&t){if(!(0===this._context.currentTime||this._currentTime+this._context.currentTime-this._startTime>this._currentSource.buffer.duration))return;this._stopOfWebAudio()}var i=this._context.createBufferSource();if(i.buffer=this._buffer,i.connect(this._volume),i.loop=this.loop,this._startTime=this._context.currentTime,this._currentTime=0,i.start)i.start(0,e||0);else if(i.noteGrainOn){var n=i.buffer.duration;this.loop?i.noteGrainOn(0,e,n):i.noteGrainOn(0,e,n-e)}else i.noteOn(0);this._currentSource=i;var r=this;i.onended=function(){r._ignoreEnded?r._ignoreEnded=!1:r._playing=!1}}},_playOfAudio:function(){var e=this._element;e&&(e.loop=this.loop,e.play())},stop:function(){this._playing=!1,"AUDIO"===this._AUDIO_TYPE?this._stopOfAudio():this._stopOfWebAudio()},_stopOfWebAudio:function(){var e=this._currentSource;this._ignoreEnded=!0,e&&(e.stop(0),this._currentSource=null)},_stopOfAudio:function(){var e=this._element;e&&(e.pause(),e.duration&&e.duration!=1/0&&(e.currentTime=0))},pause:function(){this._playing=!1,this._pause=!0,"AUDIO"===this._AUDIO_TYPE?this._pauseOfAudio():this._pauseOfWebAudio()},_pauseOfWebAudio:function(){this._currentTime+=this._context.currentTime-this._startTime;var e=this._currentSource;e&&e.stop(0)},_pauseOfAudio:function(){var e=this._element;e&&e.pause()},resume:function(){this._pause&&("AUDIO"===this._AUDIO_TYPE?this._resumeOfAudio():this._resumeOfWebAudio(),this._pause=!1,this._playing=!0)},_resumeOfWebAudio:function(){var e=this._currentSource;if(e){this._startTime=this._context.currentTime;var t=this._currentTime%e.buffer.duration;this._playOfWebAudio(t)}},_resumeOfAudio:function(){var e=this._element;e&&e.play()},setVolume:function(e){e>1&&(e=1),e<0&&(e=0),this.volume=e,"AUDIO"===this._AUDIO_TYPE?this._element&&(this._element.volume=e):this._volume&&(this._volume.gain.value=e)},getVolume:function(){return this.volume},cloneNode:function(){var e,t;if("AUDIO"===this._AUDIO_TYPE){e=new cc.Audio;var i=document.createElement("audio");i.src=this.src,e.setElement(i)}else{var n=this._context.createGain();n.gain.value=1,n.connect(this._context.destination),e=new cc.Audio(this._context,n,this.src),this._buffer?e.setBuffer(this._buffer):(t=this,this._setBufferCallback=function(i){e.setBuffer(i),t._setBufferCallback=null})}return e._AUDIO_TYPE=this._AUDIO_TYPE,e}}),function(e){var t=e.webAudio,i=e.multichannel,n=e.auto,r=[];!function(){var e=document.createElement("audio");if(e.canPlayType){var t=e.canPlayType('audio/ogg; codecs="vorbis"');t&&""!==t&&r.push(".ogg");var i=e.canPlayType("audio/mpeg");i&&""!==i&&r.push(".mp3");var n=e.canPlayType('audio/wav; codecs="1"');n&&""!==n&&r.push(".wav");var o=e.canPlayType("audio/mp4");o&&""!==o&&r.push(".mp4");var s=e.canPlayType("audio/x-m4a");s&&""!==s&&r.push(".m4a")}}();try{if(t)var o=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}catch(e){t=!1,cc.log("browser don't support webAudio")}var s={cache:{},load:function(e,i,n,a){if(0===r.length)return a("can not support audio!");var c,l=cc.path.extname(e),u=[l];for(c=0;c<r.length;c++)l!==r[c]&&u.push(r[c]);var h;if(s.cache[i])return a(null,s.cache[i]);if(t){var d=o.createGain();d.gain.value=1,d.connect(o.destination),h=new cc.Audio(o,d,e)}else h=new cc.Audio(null,null,e);this.loadAudioFromExtList(e,u,h,a),s.cache[i]=h},loadAudioFromExtList:function(i,n,a,c){if(0===n.length){var l="can not found the resource of audio! Last match url is : ";return l+=i.replace(/\.(.*)?$/,"("),r.forEach(function(e){l+=e+"|"}),l=l.replace(/\|$/,")"),c(l)}if(i=cc.path.changeExtname(i,n.splice(0,1)),t){e.webAudioCallback&&e.webAudioCallback(i);var u=new XMLHttpRequest;u.open("GET",i,!0),u.responseType="arraybuffer",u.onload=function(){o.decodeAudioData(u.response,function(e){a.setBuffer(e),c(null,a)},function(){s.loadAudioFromExtList(i,n,a,c)})},u.send()}else{var h=document.createElement("audio"),d=!1,p=!1,_=setTimeout(function(){0==h.readyState?g():(p=!0,c("audio load timeout : "+i,a))},1e4),f=function(){d||(a.setElement(h),h.removeEventListener("canplaythrough",f,!1),h.removeEventListener("error",m,!1),h.removeEventListener("emptied",g,!1),!p&&c(null,a),d=!0,clearTimeout(_))},m=function(){d&&(h.removeEventListener("canplaythrough",f,!1),h.removeEventListener("error",m,!1),h.removeEventListener("emptied",g,!1),!p&&s.loadAudioFromExtList(i,n,a,c),d=!0,clearTimeout(_))},g=function(){p=!0,f(),c(null,a)};cc._addEventListener(h,"canplaythrough",f,!1),cc._addEventListener(h,"error",m,!1),e.emptied&&cc._addEventListener(h,"emptied",g,!1),h.src=i,h.load()}}};if(cc.loader.register(["mp3","ogg","wav","mp4","m4a"],s),cc.audioEngine={_currMusic:null,_musicVolume:1,willPlayMusic:function(){return!1},playMusic:function(e,t){var i=this._currMusic;i&&i.src!==e&&i.getPlaying()&&i.stop();var n=s.cache[e];n||(cc.loader.load(e),n=s.cache[e]),n.play(0,t),n.setVolume(this._musicVolume),this._currMusic=n},stopMusic:function(e){var t=this._currMusic;t&&(t.stop(),e&&cc.loader.release(t.src))},pauseMusic:function(){var e=this._currMusic;e&&e.pause()},resumeMusic:function(){var e=this._currMusic;e&&e.resume()},rewindMusic:function(){var e=this._currMusic;e&&(e.stop(),e.play())},getMusicVolume:function(){return this._musicVolume},setMusicVolume:function(e){e-=0,isNaN(e)&&(e=1),e>1&&(e=1),e<0&&(e=0),this._musicVolume=e;var t=this._currMusic;t&&t.setVolume(e)},isMusicPlaying:function(){var e=this._currMusic;return!!e&&e.getPlaying()},_audioPool:{},_maxAudioInstance:5,_effectVolume:1,playEffect:function(e,n){if(!i)return null;var r=this._audioPool[e];r||(r=this._audioPool[e]=[]);var o;for(o=0;o<r.length&&r[o].getPlaying();o++);if(r[o])(a=r[o]).setVolume(this._effectVolume),a.play(0,n);else if(!t&&o>this._maxAudioInstance)cc.log("Error: %s greater than %d",e,this._maxAudioInstance);else{var a=s.cache[e];a||(cc.loader.load(e),a=s.cache[e]),(a=a.cloneNode()).setVolume(this._effectVolume),a.loop=n||!1,a.play(),r.push(a)}return a},setEffectsVolume:function(e){e-=0,isNaN(e)&&(e=1),e>1&&(e=1),e<0&&(e=0),this._effectVolume=e;var t=this._audioPool;for(var i in t){var n=t[i];if(Array.isArray(n))for(var r=0;r<n.length;r++)n[r].setVolume(e)}},getEffectsVolume:function(){return this._effectVolume},pauseEffect:function(e){e&&e.pause()},pauseAllEffects:function(){var e=this._audioPool;for(var t in e)for(var i=e[t],n=0;n<e[t].length;n++)i[n].getPlaying()&&i[n].pause()},resumeEffect:function(e){e&&e.resume()},resumeAllEffects:function(){var e=this._audioPool;for(var t in e)for(var i=e[t],n=0;n<e[t].length;n++)i[n].resume()},stopEffect:function(e){e&&e.stop()},stopAllEffects:function(){var e=this._audioPool;for(var t in e)for(var i=e[t],n=0;n<e[t].length;n++)i[n].stop()},unloadEffect:function(e){if(e){cc.loader.release(e);var t=this._audioPool[e];t&&(t.length=0),delete this._audioPool[e],delete s.cache[e]}},end:function(){this.stopMusic(),this.stopAllEffects()},_pauseCache:[],_pausePlaying:function(){var e=this._currMusic;e&&e.getPlaying()&&(e.pause(),this._pauseCache.push(e));var t=this._audioPool;for(var i in t)for(var n=t[i],r=0;r<t[i].length;r++)n[r].getPlaying()&&(n[r].pause(),this._pauseCache.push(n[r]))},_resumePlaying:function(){for(var e=this._pauseCache,t=0;t<e.length;t++)e[t].resume();e.length=0}},!n){var a=function(){var t=cc.audioEngine._currMusic;t&&!1===t._touch&&t._playing&&t.getPlaying()&&(t._touch=!0,t.play(0,t.loop),!e.replay&&cc._canvas.removeEventListener("touchstart",a))};setTimeout(function(){cc._canvas&&cc._canvas.addEventListener("touchstart",a,!1)},150)}cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.audioEngine._pausePlaying()}),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.audioEngine._resumePlaying()})}(cc.__audioSupport),cc.CONTROL_EVENT_TOTAL_NUMBER=9,cc.CONTROL_EVENT_TOUCH_DOWN=1,cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE=2,cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE=4,cc.CONTROL_EVENT_TOUCH_DRAG_ENTER=8,cc.CONTROL_EVENT_TOUCH_DRAG_EXIT=16,cc.CONTROL_EVENT_TOUCH_UP_INSIDE=32,cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE=64,cc.CONTROL_EVENT_TOUCH_CANCEL=128,cc.CONTROL_EVENT_VALUECHANGED=256,cc.CONTROL_STATE_NORMAL=1,cc.CONTROL_STATE_HIGHLIGHTED=2,cc.CONTROL_STATE_DISABLED=4,cc.CONTROL_STATE_SELECTED=8,cc.CONTROL_STATE_INITIAL=8,cc.Control=cc.Layer.extend({_isOpacityModifyRGB:!1,_hasVisibleParents:!1,_touchListener:null,_className:"Control",isOpacityModifyRGB:function(){return this._isOpacityModifyRGB},setOpacityModifyRGB:function(e){this._isOpacityModifyRGB=e;for(var t=this.getChildren(),i=0,n=t.length;i<n;i++){var r=t[i];r&&r.setOpacityModifyRGB(e)}},_state:cc.CONTROL_STATE_NORMAL,getState:function(){return this._state},_enabled:!1,_selected:!1,_highlighted:!1,_dispatchTable:null,setEnabled:function(e){this._enabled=e,this._state=e?cc.CONTROL_STATE_NORMAL:cc.CONTROL_STATE_DISABLED,this.needsLayout()},isEnabled:function(){return this._enabled},setSelected:function(e){this._selected=e,this.needsLayout()},isSelected:function(){return this._selected},setHighlighted:function(e){this._highlighted=e,this.needsLayout()},isHighlighted:function(){return this._highlighted},hasVisibleParents:function(){for(var e=this.getParent();null!=e;e=e.getParent())if(!e.isVisible())return!1;return!0},ctor:function(){cc.Layer.prototype.ctor.call(this),this._dispatchTable={},this._color=cc.color.WHITE},init:function(){if(cc.Layer.prototype.init.call(this)){this._state=cc.CONTROL_STATE_NORMAL,this._enabled=!0,this._selected=!1,this._highlighted=!1;var e=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0});return this.onTouchBegan&&(e.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(e.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(e.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(e.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=e,!0}return!1},onEnter:function(){var e=this._touchListener;e._isRegistered()||cc.eventManager.addListener(e,this),cc.Node.prototype.onEnter.call(this)},sendActionsForControlEvents:function(e){for(var t=0,i=cc.CONTROL_EVENT_TOTAL_NUMBER;t<i;t++)if(e&1<<t)for(var n=this._dispatchListforControlEvent(1<<t),r=0,o=n.length;r<o;r++)n[r].invoke(this)},addTargetWithActionForControlEvents:function(e,t,i){for(var n=0,r=cc.CONTROL_EVENT_TOTAL_NUMBER;n<r;n++)i&1<<n&&this._addTargetWithActionForControlEvent(e,t,1<<n)},removeTargetWithActionForControlEvents:function(e,t,i){for(var n=0,r=cc.CONTROL_EVENT_TOTAL_NUMBER;n<r;n++)i&1<<n&&this._removeTargetWithActionForControlEvent(e,t,1<<n)},getTouchLocation:function(e){var t=e.getLocation();return this.convertToNodeSpace(t)},isTouchInside:function(e){var t=e.getLocation();return t=this.getParent().convertToNodeSpace(t),cc.rectContainsPoint(this.getBoundingBox(),t)},_invocationWithTargetAndActionForControlEvent:function(e,t,i){return null},_dispatchListforControlEvent:function(e){return e=e.toString(),this._dispatchTable[e]||(this._dispatchTable[e]=[]),this._dispatchTable[e]},_addTargetWithActionForControlEvent:function(e,t,i){var n=new cc.Invocation(e,t,i);this._dispatchListforControlEvent(i).push(n)},_removeTargetWithActionForControlEvent:function(e,t,i){var n=this._dispatchListforControlEvent(i);if(e||t)for(var r=0;r<n.length;){var o=n[r],s=!0;e&&(s=e==o.getTarget()),t&&(s=s&&t==o.getAction()),s?cc.arrayRemoveObject(n,o):r++}else n.length=0},needsLayout:function(){}}),(_p=cc.Control.prototype).state,cc.defineGetterSetter(_p,"state",_p.getState),_p.enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),_p.selected,cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),_p.highlighted,cc.defineGetterSetter(_p,"highlighted",_p.isHighlighted,_p.setHighlighted),_p=null,cc.Control.create=function(){var e=new cc.Control;return e&&e.init()?e:null},cc.CONTROL_ZOOM_ACTION_TAG=3435855873,cc.ControlButton=cc.Control.extend({_doesAdjustBackgroundImage:!1,zoomOnTouchDown:!1,_preferredSize:null,_labelAnchorPoint:null,_currentTitle:null,_currentTitleColor:null,_titleLabel:null,_backgroundSprite:null,_opacity:0,_isPushed:!1,_titleDispatchTable:null,_titleColorDispatchTable:null,_titleLabelDispatchTable:null,_backgroundSpriteDispatchTable:null,_parentInited:!1,_marginV:0,_marginH:0,_className:"ControlButton",ctor:function(e,t,i){cc.Control.prototype.ctor.call(this),this._preferredSize=cc.size(0,0),this._labelAnchorPoint=cc.p(0,0),this._currentTitle="",this._currentTitleColor=cc.color.WHITE,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},void 0!=i?this.initWithTitleAndFontNameAndFontSize(e,t,i):void 0!=t?this.initWithLabelAndBackgroundSprite(e,t):void 0!=e?this.initWithBackgroundSprite(e):this.init()},init:function(){return this.initWithLabelAndBackgroundSprite(new cc.LabelTTF("","Arial",12),new cc.Scale9Sprite)},needsLayout:function(){if(this._parentInited){this._titleLabel&&this._titleLabel.setVisible(!1),this._backgroundSprite&&this._backgroundSprite.setVisible(!1),this.setLabelAnchorPoint(this._labelAnchorPoint);var e=this._state;this._currentTitle=this.getTitleForState(e),this._currentTitleColor=this.getTitleColorForState(e),this._titleLabel=this.getTitleLabelForState(e);var t=this._titleLabel;t&&t.setString&&t.setString(this._currentTitle),t&&t.setColor(this._currentTitleColor);var i=this.getContentSize();t&&t.setPosition(i.width/2,i.height/2),this._backgroundSprite=this.getBackgroundSpriteForState(e);var n=this._backgroundSprite;n&&n.setPosition(i.width/2,i.height/2);var r=cc.size(0,0);if(t){var o=t.getBoundingBox();r.width=o.width,r.height=o.height}if(this._doesAdjustBackgroundImage)n&&n.setContentSize(r.width+2*this._marginH,r.height+2*this._marginV);else if(n){var s=n.getPreferredSize();(s=cc.size(s.width,s.height)).width<=0&&(s.width=r.width),s.height<=0&&(s.height=r.height),n.setContentSize(s)}var a=t?t.getBoundingBox():cc.rect(0,0,0,0),c=n?n.getBoundingBox():cc.rect(0,0,0,0),l=cc.rectUnion(a,c);this.setContentSize(l.width,l.height),i=this.getContentSize(),t&&(t.setPosition(i.width/2,i.height/2),t.setVisible(!0)),n&&(n.setPosition(i.width/2,i.height/2),n.setVisible(!0))}},initWithLabelAndBackgroundSprite:function(e,t){if(!e)throw"cc.ControlButton.initWithLabelAndBackgroundSprite(): label should be non-null";if(!t)throw"cc.ControlButton.initWithLabelAndBackgroundSprite(): backgroundSprite should be non-null";if(cc.Control.prototype.init.call(this,!0)){this._parentInited=!0,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},this._isPushed=!1,this.zoomOnTouchDown=!0,this._currentTitle=null,this.setAdjustBackgroundImage(!0),this.setPreferredSize(cc.size(0,0)),this.zoomOnTouchDown=!0,this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this._titleLabel=e,this._backgroundSprite=t,this.setOpacity(255),this.setOpacityModifyRGB(!0);var i=e.getString();return this.setTitleForState(i,cc.CONTROL_STATE_NORMAL),this.setTitleColorForState(e.getColor(),cc.CONTROL_STATE_NORMAL),this.setTitleLabelForState(e,cc.CONTROL_STATE_NORMAL),this.setBackgroundSpriteForState(t,cc.CONTROL_STATE_NORMAL),this._state=cc.CONTROL_STATE_NORMAL,this._marginH=24,this._marginV=12,this._labelAnchorPoint=cc.p(.5,.5),this.setPreferredSize(cc.size(0,0)),this.needsLayout(),!0}return!1},initWithTitleAndFontNameAndFontSize:function(e,t,i){var n=new cc.LabelTTF(e,t,i);return this.initWithLabelAndBackgroundSprite(n,new cc.Scale9Sprite)},initWithBackgroundSprite:function(e){var t=new cc.LabelTTF("","Arial",30);return this.initWithLabelAndBackgroundSprite(t,e)},doesAdjustBackgroundImage:function(){return this._doesAdjustBackgroundImage},setAdjustBackgroundImage:function(e){this._doesAdjustBackgroundImage=e,this.needsLayout()},getZoomOnTouchDown:function(){return this.zoomOnTouchDown},setZoomOnTouchDown:function(e){return this.zoomOnTouchDown=e},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(e){if(0===e.width&&0===e.height)this._doesAdjustBackgroundImage=!0;else{this._doesAdjustBackgroundImage=!1;var t=this._backgroundSpriteDispatchTable;for(var i in t)t[i].setPreferredSize(e)}this._preferredSize=e,this.needsLayout()},getLabelAnchorPoint:function(){return this._labelAnchorPoint},setLabelAnchorPoint:function(e){this._labelAnchorPoint=e,this._titleLabel&&this._titleLabel.setAnchorPoint(e)},_getCurrentTitle:function(){return this._currentTitle},_getCurrentTitleColor:function(){return this._currentTitleColor},getOpacity:function(){return this._opacity},setOpacity:function(e){cc.Control.prototype.setOpacity.call(this,e);var t=this._backgroundSpriteDispatchTable;for(var i in t)t[i].setOpacity(e)},setColor:function(e){cc.Control.prototype.setColor.call(this,e);var t=this._backgroundSpriteDispatchTable;for(var i in t)t[i].setColor(e)},getColor:function(){var e=this._realColor;return cc.color(e.r,e.g,e.b,e.a)},isPushed:function(){return this._isPushed},_getVerticalMargin:function(){return this._marginV},_getHorizontalOrigin:function(){return this._marginH},setMargins:function(e,t){this._marginV=t,this._marginH=e,this.needsLayout()},setEnabled:function(e){cc.Control.prototype.setEnabled.call(this,e),this.needsLayout()},setSelected:function(e){cc.Control.prototype.setSelected.call(this,e),this.needsLayout()},setHighlighted:function(e){this._state=e?cc.CONTROL_STATE_HIGHLIGHTED:cc.CONTROL_STATE_NORMAL,cc.Control.prototype.setHighlighted.call(this,e);var t=this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG);if(t&&this.stopAction(t),this.zoomOnTouchDown){var i=this.isHighlighted()&&this.isEnabled()&&!this.isSelected()?1.1:1,n=cc.scaleTo(.05,i);n.setTag(cc.CONTROL_ZOOM_ACTION_TAG),this.runAction(n)}},onTouchBegan:function(e,t){return!!(this.isTouchInside(e)&&this.isEnabled()&&this.isVisible()&&this.hasVisibleParents())&&(this._isPushed=!0,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),!0)},onTouchMoved:function(e,t){if(this._enabled&&this._isPushed&&!this._selected){var i=this.isTouchInside(e);i&&!this._highlighted?(this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER)):i&&this._highlighted?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE):!i&&this._highlighted?(this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT)):i||this._highlighted||this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE)}else this._highlighted&&this.setHighlighted(!1)},onTouchEnded:function(e,t){this._isPushed=!1,this.setHighlighted(!1),this.isTouchInside(e)?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_INSIDE):this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE)},onTouchCancelled:function(e,t){this._isPushed=!1,this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL)},getTitleForState:function(e){var t=this._titleDispatchTable;return t?t[e]?t[e]:t[cc.CONTROL_STATE_NORMAL]:""},setTitleForState:function(e,t){this._titleDispatchTable[t]=e||"",this.getState()==t&&this.needsLayout()},getTitleColorForState:function(e){var t=this._titleColorDispatchTable[e];return t||((t=this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL])||cc.color.WHITE)},setTitleColorForState:function(e,t){this._titleColorDispatchTable[t]=e,this.getState()==t&&this.needsLayout()},getTitleLabelForState:function(e){var t=this._titleLabelDispatchTable;return t[e]?t[e]:t[cc.CONTROL_STATE_NORMAL]},setTitleLabelForState:function(e,t){var i=this._titleLabelDispatchTable;if(i[t]){var n=i[t];n&&this.removeChild(n,!0)}i[t]=e,e.setVisible(!1),e.setAnchorPoint(.5,.5),this.addChild(e,1),this.getState()==t&&this.needsLayout()},setTitleTTFForState:function(e,t){var i=this.getTitleForState(t);i||(i=""),this.setTitleLabelForState(new cc.LabelTTF(i,e,12),t)},getTitleTTFForState:function(e){var t=this.getTitleLabelForState(e);return null!=t&&t instanceof cc.LabelTTF?t.getFontName():""},setTitleTTFSizeForState:function(e,t){var i=this.getTitleLabelForState(t);null!=i&&i instanceof cc.LabelTTF&&i.setFontSize(e)},getTitleTTFSizeForState:function(e){var t=this.getTitleLabelForState(e);return null!=t&&t instanceof cc.LabelTTF?t.getFontSize():0},setTitleBMFontForState:function(e,t){var i=this.getTitleForState(t);i||(i=""),this.setTitleLabelForState(new cc.LabelBMFont(i,e),t)},getTitleBMFontForState:function(e){var t=this.getTitleLabelForState(e);return null!=t&&t instanceof cc.LabelBMFont?t.getFntFile():""},getBackgroundSpriteForState:function(e){var t=this._backgroundSpriteDispatchTable;return t[e]?t[e]:t[cc.CONTROL_STATE_NORMAL]},setBackgroundSpriteForState:function(e,t){var i=this._backgroundSpriteDispatchTable;if(i[t]){var n=i[t];n&&this.removeChild(n,!0)}i[t]=e,e.setVisible(!1),e.setAnchorPoint(.5,.5),this.addChild(e);var r=this._preferredSize;0===r.width&&0===r.height||e.setPreferredSize(r),this._state===t&&this.needsLayout()},setBackgroundSpriteFrameForState:function(e,t){var i=cc.Scale9Sprite.createWithSpriteFrame(e);this.setBackgroundSpriteForState(i,t)}}),(_p=cc.ControlButton.prototype).adjustBackground,cc.defineGetterSetter(_p,"adjustBackground",_p.getAdjustBackgroundImage,_p.setAdjustBackgroundImage),_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.labelAnchor,cc.defineGetterSetter(_p,"labelAnchor",_p.getLabelAnchorPoint,_p.setLabelAnchorPoint),_p=null,cc.ControlButton.create=function(e,t,i){return new cc.ControlButton(e,t,i)},cc.RGBA=function(e,t,i,n){this.r=e,this.g=t,this.b=i,this.a=n},cc.HSV=function(e,t,i){this.h=e,this.s=t,this.v=i},cc.ControlUtils={},cc.ControlUtils.addSpriteToTargetWithPosAndAnchor=function(e,t,i,n){var r=new cc.Sprite("#"+e);return r?(r.setPosition(i),r.setAnchorPoint(n),t.addChild(r),r):null},cc.ControlUtils.HSVfromRGB=function(e){var t,i,n,r=new cc.HSV;return t=e.r<e.g?e.r:e.g,t=t<e.b?t:e.b,i=e.r>e.g?e.r:e.g,i=i>e.b?i:e.b,r.v=i,n=i-t,i>0?(r.s=n/i,e.r>=i?r.h=(e.g-e.b)/n:e.g>=i?r.h=2+(e.b-e.r)/n:r.h=4+(e.r-e.g)/n,r.h*=60,r.h<0&&(r.h+=360),r):(r.s=0,r.h=-1,r)},cc.ControlUtils.RGBfromHSV=function(e){var t,i,n,r,o,s,a=new cc.RGBA;if(a.a=1,e.s<=0)return e.h?(a.r=0,a.g=0,a.b=0,a):(a.r=e.v,a.g=e.v,a.b=e.v,a);switch((t=e.h)>=360&&(t=0),t/=60,s=0|t,o=t-s,i=e.v*(1-e.s),n=e.v*(1-e.s*o),r=e.v*(1-e.s*(1-o)),s){case 0:a.r=e.v,a.g=r,a.b=i;break;case 1:a.r=n,a.g=e.v,a.b=i;break;case 2:a.r=i,a.g=e.v,a.b=r;break;case 3:a.r=i,a.g=n,a.b=e.v;break;case 4:a.r=r,a.g=i,a.b=e.v;break;default:a.r=e.v,a.g=i,a.b=n}return a},cc.ControlUtils.CCRectUnion=function(e,t){return cc.rectUnion(e,t)},cc.Invocation=cc.Class.extend({_action:null,_target:null,_controlEvent:null,ctor:function(e,t,i){this._target=e,this._action=t,this._controlEvent=i},getAction:function(){return this._action},getTarget:function(){return this._target},getControlEvent:function(){return this._controlEvent},invoke:function(e){this._target&&this._action&&(cc.isString(this._action)?this._target[this._action](e,this._controlEvent):this._action.call(this._target,e,this._controlEvent))}}),cc.Scale9Sprite=cc.Node.extend({_spriteRect:null,_capInsetsInternal:null,_positionsAreDirty:!1,_scale9Image:null,_topLeft:null,_top:null,_topRight:null,_left:null,_centre:null,_right:null,_bottomLeft:null,_bottom:null,_bottomRight:null,_scale9Dirty:!0,_opacityModifyRGB:!1,_originalSize:null,_preferredSize:null,_opacity:0,_color:null,_capInsets:null,_insetLeft:0,_insetTop:0,_insetRight:0,_insetBottom:0,_spritesGenerated:!1,_spriteFrameRotated:!1,_textureLoaded:!1,_className:"Scale9Sprite",_flippedX:!1,_flippedY:!1,textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},_updateCapInset:function(){var e,t=this._insetLeft,i=this._insetTop,n=this._insetRight,r=this._spriteRect,o=this._insetBottom;e=0===t&&0===i&&0===n&&0===o?cc.rect(0,0,0,0):this._spriteFrameRotated?cc.rect(o,t,r.width-n-t,r.height-i-o):cc.rect(t,i,r.width-t-n,r.height-i-o),this.setCapInsets(e)},_updatePositions:function(){if(this._topLeft&&this._topRight&&this._bottomRight&&this._bottomLeft&&this._centre){var e=this._contentSize,t=this._topLeft,i=this._topRight,n=this._bottomRight,r=this._bottomLeft,o=this._centre,s=this._centre.getContentSize(),a=t.getContentSize(),c=r.getContentSize(),l=e.width-a.width-i.getContentSize().width,u=e.height-a.height-n.getContentSize().height,h=l/s.width,d=u/s.height,p=s.width*h,_=s.height*d,f=c.width,m=c.height;if(cc._renderType==cc._RENDER_TYPE_WEBGL){var g=Math.round(p);p!=g&&(h=(p=g)/s.width);var y=Math.round(_);_!=y&&(d=(_=y)/s.height)}o.setScaleX(h),o.setScaleY(d);var T=this._left,v=this._right,S=this._top,C=this._bottom,E=cc.p(0,0);r.setAnchorPoint(E),n.setAnchorPoint(E),t.setAnchorPoint(E),i.setAnchorPoint(E),T.setAnchorPoint(E),v.setAnchorPoint(E),S.setAnchorPoint(E),C.setAnchorPoint(E),o.setAnchorPoint(E),r.setPosition(0,0),n.setPosition(f+p,0),t.setPosition(0,m+_),i.setPosition(f+p,m+_),T.setPosition(0,m),T.setScaleY(d),v.setPosition(f+p,m),v.setScaleY(d),C.setPosition(f,0),C.setScaleX(h),S.setPosition(f,m+_),S.setScaleX(h),o.setPosition(f,m)}},ctor:function(e,t,i){if(cc.Node.prototype.ctor.call(this),this._spriteRect=cc.rect(0,0,0,0),this._capInsetsInternal=cc.rect(0,0,0,0),this._originalSize=cc.size(0,0),this._preferredSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),void 0!=e)if(e instanceof cc.SpriteFrame)this.initWithSpriteFrame(e,t);else{var n=cc.spriteFrameCache.getSpriteFrame(e);null!=n?this.initWithSpriteFrame(n,t):this.initWithFile(e,t,i)}else this.init()},getSprite:function(){return this._scale9Image},getOriginalSize:function(){return cc.size(this._originalSize)},getPreferredSize:function(){return cc.size(this._preferredSize)},_getPreferredWidth:function(){return this._preferredSize.width},_getPreferredHeight:function(){return this._preferredSize.height},setPreferredSize:function(e){this.setContentSize(e),this._preferredSize=e,this._positionsAreDirty&&(this._updatePositions(),this._positionsAreDirty=!1,this._scale9Dirty=!0)},_setPreferredWidth:function(e){this._setWidth(e),this._preferredSize.width=e},_setPreferredHeight:function(e){this._setHeight(e),this._preferredSize.height=e},setOpacity:function(e){if(this._scale9Image){cc.Node.prototype.setOpacity.call(this,e);for(var t=this._scale9Image.getChildren(),i=0;i<t.length;i++){var n=t[i];n&&n.setOpacity(e)}this._scale9Dirty=!0}},setColor:function(e){if(this._scale9Image){cc.Node.prototype.setColor.call(this,e);for(var t=this._scale9Image.getChildren(),i=0;i<t.length;i++){var n=t[i];n&&n.setColor(e)}this._scale9Dirty=!0}},getCapInsets:function(){return cc.rect(this._capInsets)},setCapInsets:function(e){if(this._scale9Image){var t=this._contentSize,i=t.width,n=t.height;this.updateWithBatchNode(this._scale9Image,this._spriteRect,this._spriteFrameRotated,e),this.setContentSize(i,n)}},getInsetLeft:function(){return this._insetLeft},setInsetLeft:function(e){this._insetLeft=e,this._updateCapInset()},getInsetTop:function(){return this._insetTop},setInsetTop:function(e){this._insetTop=e,this._updateCapInset()},getInsetRight:function(){return this._insetRight},setInsetRight:function(e){this._insetRight=e,this._updateCapInset()},getInsetBottom:function(){return this._insetBottom},setInsetBottom:function(e){this._insetBottom=e,this._updateCapInset()},setContentSize:function(e,t){cc.Node.prototype.setContentSize.call(this,e,t),this._positionsAreDirty=!0},_setWidth:function(e){cc.Node.prototype._setWidth.call(this,e),this._positionsAreDirty=!0},_setHeight:function(e){cc.Node.prototype._setHeight.call(this,e),this._positionsAreDirty=!0},init:function(){return this.initWithBatchNode(null,cc.rect(0,0,0,0),!1,cc.rect(0,0,0,0))},initWithBatchNode:function(e,t,i,n){return void 0===n&&(n=i,i=!1),e&&this.updateWithBatchNode(e,t,i,n),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint(.5,.5),this._positionsAreDirty=!0,!0},initWithFile:function(e,t,i){if(e instanceof cc.Rect?(e=arguments[1],i=arguments[0],t=cc.rect(0,0,0,0)):(t=t||cc.rect(0,0,0,0),i=i||cc.rect(0,0,0,0)),!e)throw"cc.Scale9Sprite.initWithFile(): file should be non-null";var n=cc.textureCache.getTextureForKey(e);n||(n=cc.textureCache.addImage(e));var r=n.isLoaded();return this._textureLoaded=r,r||n.addEventListener("load",function(e){var t=this._preferredSize;t=cc.size(t.width,t.height);var i=e.getContentSize();this.updateWithBatchNode(this._scale9Image,cc.rect(0,0,i.width,i.height),!1,this._capInsets),this.setPreferredSize(t),this._positionsAreDirty=!0,this.dispatchEvent("load")},this),this.initWithBatchNode(new cc.SpriteBatchNode(e,9),t,!1,i)},initWithSpriteFrame:function(e,t){if(!e||!e.getTexture())throw"cc.Scale9Sprite.initWithSpriteFrame(): spriteFrame should be non-null and its texture should be non-null";t=t||cc.rect(0,0,0,0);var i=e.textureLoaded();this._textureLoaded=i,i||e.addEventListener("load",function(e){var t=this._preferredSize;t=cc.size(t.width,t.height),this.updateWithBatchNode(this._scale9Image,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),this._capInsets),this.setPreferredSize(t),this._positionsAreDirty=!0,this.dispatchEvent("load")},this);var n=new cc.SpriteBatchNode(e.getTexture(),9);return this.initWithBatchNode(n,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),t)},initWithSpriteFrameName:function(e,t){if(!e)throw"cc.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null";t=t||cc.rect(0,0,0,0);var i=cc.spriteFrameCache.getSpriteFrame(e);return null==i?(cc.log("cc.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),!1):this.initWithSpriteFrame(i,t)},resizableSpriteWithCapInsets:function(e){var t=new cc.Scale9Sprite;return t&&t.initWithBatchNode(this._scale9Image,this._spriteRect,!1,e)?t:null},setOpacityModifyRGB:function(e){if(this._scale9Image){this._opacityModifyRGB=e;var t=this._scale9Image.getChildren();if(t)for(var i=0,n=t.length;i<n;i++)t[i].setOpacityModifyRGB(e)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},updateWithBatchNode:function(e,t,i,n){var r=this.getOpacity(),o=this.getColor(),s=cc.rect(t.x,t.y,t.width,t.height);if(this.removeAllChildren(!0),this._scale9Image!=e&&(this._scale9Image=e),!this._scale9Image)return!1;var a=e.getTexture(),c=a.isLoaded();if(this._textureLoaded=c,!c)return a.addEventListener("load",function(e){this._positionsAreDirty=!0,this.dispatchEvent("load")},this),!0;var l=this._scale9Image;l.removeAllChildren(!0);var u=this._capInsets;u.x=n.x,u.y=n.y,u.width=n.width,u.height=n.height,this._spriteFrameRotated=i;var h=l.getTexture();if(cc._rectEqualToZero(s)){var d=h.getContentSize();s=cc.rect(0,0,d.width,d.height)}this._spriteRect=s;var p=this._spriteRect;p.x=s.x,p.y=s.y,p.width=s.width,p.height=s.height,this._originalSize.width=s.width,this._originalSize.height=s.height;var _=this._preferredSize;0===_.width&&0===_.height&&(_.width=s.width,_.height=s.height);var f=this._capInsetsInternal;n&&(f.x=n.x,f.y=n.y,f.width=n.width,f.height=n.height);var m=s.width,g=s.height;cc._rectEqualToZero(f)&&(f.x=m/3,f.y=g/3,f.width=m/3,f.height=g/3);var y=f.x,T=f.width,v=m-(y+T),S=f.y,C=f.height,E=g-(S+C),b=0,A=0,x=cc.rect(b+.5|0,A+.5|0,y+.5|0,S+.5|0);b+=y;var R=cc.rect(b+.5|0,A+.5|0,T+.5|0,S+.5|0);b+=T;var P=cc.rect(b+.5|0,A+.5|0,v+.5|0,S+.5|0);b=0,A=0,A+=S;var I=cc.rect(b+.5|0,A+.5|0,y+.5|0,C+.5|0);b+=y;var w=cc.rect(b+.5|0,A+.5|0,T+.5|0,C+.5|0);b+=T;var N=cc.rect(b+.5|0,A+.5|0,v+.5|0,C+.5|0);b=0,A=0,A+=S,A+=C;var L=cc.rect(b+.5|0,A+.5|0,y+.5|0,E+.5|0);b+=y;var O=cc.rect(b+.5|0,A+.5|0,T+.5|0,E+.5|0);b+=T;var D=cc.rect(b+.5|0,A+.5|0,v+.5|0,E+.5|0),F=cc.affineTransformMakeIdentity();if(i){var B=w,M=D,k=L,W=P,V=x,z=N,G=I,U=O,Y=R;F=cc.affineTransformTranslate(F,s.height+s.x,s.y),F=cc.affineTransformRotate(F,1.57079633),w=cc.rectApplyAffineTransform(w,F),D=cc.rectApplyAffineTransform(D,F),L=cc.rectApplyAffineTransform(L,F),P=cc.rectApplyAffineTransform(P,F),x=cc.rectApplyAffineTransform(x,F),N=cc.rectApplyAffineTransform(N,F),I=cc.rectApplyAffineTransform(I,F),O=cc.rectApplyAffineTransform(O,F),R=cc.rectApplyAffineTransform(R,F),B.x=w.x,B.y=w.y,M.x=D.x,M.y=D.y,k.x=L.x,k.y=L.y,W.x=P.x,W.y=P.y,V.x=x.x,V.y=x.y,z.x=N.x,z.y=N.y,G.x=I.x,G.y=I.y,U.x=O.x,U.y=O.y,Y.x=R.x,Y.y=R.y,this._centre=new cc.Sprite,this._centre.initWithTexture(h,B,!0),l.addChild(this._centre,0,cc.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(h,Y,!0),l.addChild(this._top,1,cc.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(h,U,!0),l.addChild(this._bottom,1,cc.Scale9Sprite.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(h,G,!0),l.addChild(this._left,1,cc.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(h,z,!0),l.addChild(this._right,1,cc.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(h,V,!0),l.addChild(this._topLeft,2,cc.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(h,W,!0),l.addChild(this._topRight,2,cc.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(h,k,!0),l.addChild(this._bottomLeft,2,cc.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(h,M,!0),l.addChild(this._bottomRight,2,cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT)}else F=cc.affineTransformTranslate(F,s.x,s.y),cc._rectApplyAffineTransformIn(w,F),cc._rectApplyAffineTransformIn(D,F),cc._rectApplyAffineTransformIn(L,F),cc._rectApplyAffineTransformIn(P,F),cc._rectApplyAffineTransformIn(x,F),cc._rectApplyAffineTransformIn(N,F),cc._rectApplyAffineTransformIn(I,F),cc._rectApplyAffineTransformIn(O,F),cc._rectApplyAffineTransformIn(R,F),this._centre=new cc.Sprite,this._centre.initWithTexture(h,w),l.addChild(this._centre,0,cc.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(h,R),l.addChild(this._top,1,cc.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(h,O),l.addChild(this._bottom,1,cc.Scale9Sprite.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(h,I),l.addChild(this._left,1,cc.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(h,N),l.addChild(this._right,1,cc.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(h,x),l.addChild(this._topLeft,2,cc.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(h,P),l.addChild(this._topRight,2,cc.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(h,L),l.addChild(this._bottomLeft,2,cc.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(h,D),l.addChild(this._bottomRight,2,cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT);return this.setContentSize(s.width,s.height),cc._renderType===cc._RENDER_TYPE_WEBGL&&this.addChild(l),this._spritesGenerated&&(this.setOpacity(r),this.setColor(o)),this._spritesGenerated=!0,!0},setSpriteFrame:function(e){var t=new cc.SpriteBatchNode(e.getTexture(),9),i=e.textureLoaded();this._textureLoaded=i,i||e.addEventListener("load",function(e){var t=this._preferredSize;t=cc.size(t.width,t.height),this.updateWithBatchNode(this._scale9Image,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),this._capInsets),this.setPreferredSize(t),this._positionsAreDirty=!0,this.dispatchEvent("load")},this),this.updateWithBatchNode(t,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),cc.rect(0,0,0,0)),this._insetLeft=0,this._insetTop=0,this._insetRight=0,this._insetBottom=0},setState:function(e){this._renderCmd.setState(e)},setFlippedX:function(e){var t=this.getScaleX();this._flippedX=e,this.setScaleX(t)},isFlippedX:function(){return this._flippedX},setFlippedY:function(e){var t=this.getScaleY();this._flippedY=e,this.setScaleY(t)},isFlippedY:function(){return this._flippedY},setScaleX:function(e){this._flippedX&&(e*=-1),cc.Node.prototype.setScaleX.call(this,e)},setScaleY:function(e){this._flippedY&&(e*=-1),cc.Node.prototype.setScaleY.call(this,e)},setScale:function(e,t){void 0===t&&(t=e),this.setScaleX(e),this.setScaleY(t)},getScaleX:function(){var e=cc.Node.prototype.getScaleX.call(this);return this._flippedX&&(e*=-1),e},getScaleY:function(){var e=cc.Node.prototype.getScaleY.call(this);return this._flippedY&&(e*=-1),e},getScale:function(){return this.getScaleX()!==this.getScaleY()&&cc.log("Scale9Sprite#scale. ScaleX != ScaleY. Don't know which one to return"),this.getScaleX()},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Scale9Sprite.CanvasRenderCmd(this):new cc.Scale9Sprite.WebGLRenderCmd(this)}});var _p=cc.Scale9Sprite.prototype;cc.EventHelper.prototype.apply(_p),_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.capInsets,cc.defineGetterSetter(_p,"capInsets",_p.getCapInsets,_p.setCapInsets),_p.insetLeft,cc.defineGetterSetter(_p,"insetLeft",_p.getInsetLeft,_p.setInsetLeft),_p.insetTop,cc.defineGetterSetter(_p,"insetTop",_p.getInsetTop,_p.setInsetTop),_p.insetRight,cc.defineGetterSetter(_p,"insetRight",_p.getInsetRight,_p.setInsetRight),_p.insetBottom,cc.defineGetterSetter(_p,"insetBottom",_p.getInsetBottom,_p.setInsetBottom),_p=null,cc.Scale9Sprite.create=function(e,t,i){return new cc.Scale9Sprite(e,t,i)},cc.Scale9Sprite.createWithSpriteFrame=function(e,t){return new cc.Scale9Sprite(e,t)},cc.Scale9Sprite.createWithSpriteFrameName=function(e,t){return new cc.Scale9Sprite(e,t)},cc.Scale9Sprite.POSITIONS_CENTRE=0,cc.Scale9Sprite.POSITIONS_TOP=1,cc.Scale9Sprite.POSITIONS_LEFT=2,cc.Scale9Sprite.POSITIONS_RIGHT=3,cc.Scale9Sprite.POSITIONS_BOTTOM=4,cc.Scale9Sprite.POSITIONS_TOPRIGHT=5,cc.Scale9Sprite.POSITIONS_TOPLEFT=6,cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT=7,cc.Scale9Sprite.state={NORMAL:0,GRAY:1},function(){cc.Scale9Sprite.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._cachedParent=null,this._cacheDirty=!1,this._state=cc.Scale9Sprite.state.NORMAL;var t=this._node,i=this._cacheCanvas=cc.newElement("canvas");i.width=1,i.height=1,this._cacheContext=new cc.CanvasContextWrapper(i.getContext("2d"));var n=this._cacheTexture=new cc.Texture2D;n.initWithElement(i),n.handleLoadedTexture(),this._cacheSprite=new cc.Sprite(n),this._cacheSprite.setAnchorPoint(0,0),t.addChild(this._cacheSprite)};var e=cc.Scale9Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.Scale9Sprite.CanvasRenderCmd,e.visit=function(e){var t=this._node;t._visible&&(t._positionsAreDirty&&(t._updatePositions(),t._positionsAreDirty=!1,t._scale9Dirty=!0),t._scale9Dirty=!1,this._cacheScale9Sprite(),cc.Node.CanvasRenderCmd.prototype.visit.call(this,e))},e.transform=function(e){var t=this._node;cc.Node.CanvasRenderCmd.prototype.transform.call(this,e),t._positionsAreDirty&&(t._updatePositions(),t._positionsAreDirty=!1,t._scale9Dirty=!0),this._cacheScale9Sprite();for(var i=t._children,n=0;n<i.length;n++)i[n].transform(this)},e._updateDisplayColor=function(e){cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(this,e);var t=this._node._scale9Image;if(t){for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n];r&&r._renderCmd._updateDisplayColor(e)}this._cacheScale9Sprite()}},e._cacheScale9Sprite=function(){var e=this._node;if(e._scale9Image){var t=cc.contentScaleFactor(),i=e._contentSize,n=cc.size(i.width*t,i.height*t),r=this._cacheCanvas,o=this._cacheContext,s=o.getContext(),a=!1;r.width==n.width&&r.height==n.height||(r.width=n.width,r.height=n.height,a=!0),cc.renderer._turnToCacheMode(e.__instanceId),e._scale9Image.visit();var c=e._scale9Image.getTexture();c&&this._state===cc.Scale9Sprite.state.GRAY&&c._switchToGray(!0),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,n.width,n.height),cc.renderer._renderingToCacheCanvas(o,e.__instanceId,t,t),c&&this._state===cc.Scale9Sprite.state.GRAY&&c._switchToGray(!1),a&&this._cacheSprite.setTextureRect(cc.rect(0,0,i.width,i.height)),this._cacheSprite.getParent()||e.addChild(this._cacheSprite,-1)}},e.setState=function(e){this._node._scale9Image&&(this._state=e,this._cacheScale9Sprite())}}(),function(){cc.Scale9Sprite.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._cachedParent=null,this._cacheDirty=!1};var e=cc.Scale9Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.Scale9Sprite.WebGLRenderCmd,e.visit=function(e){var t=this._node;t._visible&&(t._positionsAreDirty&&(t._updatePositions(),t._positionsAreDirty=!1,t._scale9Dirty=!0),cc.Node.WebGLRenderCmd.prototype.visit.call(this,e))},e.transform=function(e,t){var i=this._node;cc.Node.WebGLRenderCmd.prototype.transform.call(this,e,t),i._positionsAreDirty&&(i._updatePositions(),i._positionsAreDirty=!1,i._scale9Dirty=!0)},e._updateDisplayColor=function(e){cc.Node.WebGLRenderCmd.prototype._updateDisplayColor.call(this,e);var t=this._node._scale9Image;if(t)for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n];r&&(r._renderCmd._updateDisplayColor(e),r._renderCmd._updateColor())}},e._updateDisplayOpacity=function(e){cc.Node.WebGLRenderCmd.prototype._updateDisplayOpacity.call(this,e);var t=this._node._scale9Image;if(t)for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n];r&&(r._renderCmd._updateDisplayOpacity(e),r._renderCmd._updateColor())}},e.setState=function(e){var t=this._node._scale9Image;null!=t&&(e===cc.Scale9Sprite.state.NORMAL?t.setShaderProgram(cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)):e===cc.Scale9Sprite.state.GRAY&&t.setShaderProgram(cc.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram()))},cc.Scale9Sprite.WebGLRenderCmd._grayShaderProgram=null,cc.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram=function(){var e=cc.Scale9Sprite.WebGLRenderCmd._grayShaderProgram;return e||((e=new cc.GLProgram).initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.Scale9Sprite.WebGLRenderCmd._grayShaderFragment),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),e.link(),e.updateUniforms(),cc.Scale9Sprite.WebGLRenderCmd._grayShaderProgram=e,e)},cc.Scale9Sprite.WebGLRenderCmd._grayShaderFragment="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    gl_FragColor.xyz = vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b); \n     gl_FragColor.w = c.w ; \n}"}(),cc.Spacer=cc.Layer.extend({}),cc.Spacer.verticalSpacer=function(e){var t=new cc.Spacer;return t.init(),t.setContentSize(0,e),t},cc.Spacer.horizontalSpacer=function(e){var t=new cc.Spacer;return t.init(),t.setContentSize(e,0),t},cc.MenuPassive=cc.Layer.extend({_color:null,_opacity:0,_className:"MenuPassive",ctor:function(){},getColor:function(){var e=this._color;return cc.color(e.r,e.g,e.b,e.a)},setColor:function(e){var t=this._color;if(t.r=e.r,t.g=e.g,t.b=e.b,this._children&&this._children.length>0)for(var i=0;i<this._children.length;i++)this._children[i]&&this._children[i].setColor(e);void 0===e.a||e.a_undefined||this.setOpacity(e.a)},getOpacity:function(){return this._opacity},setOpacity:function(e){if(this._opacity=e,this._children&&this._children.length>0)for(var t=0;t<this._children.length;t++)this._children[t]&&this._children[t].setOpacity(e);this._color.a=e},initWithItems:function(e,t){if(this.init()){var i=cc.director.getWinSize();this.ignoreAnchorPointForPosition(!0),this.setAnchorPoint(.5,.5),this.setContentSize(i),this.setPosition(i.width/2,i.height/2);var n=0;if(e){this.addChild(e,n);for(var r=0;r<t.length;r++)t[r]&&(n++,this.addChild(t[r],n))}return!0}return!1},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(e){var t,i=-e;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)this._children[t]&&(i+=this._children[t].getContentSize().height*this._children[t].getScaleY()+e);var n=0,r=i/2;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)this._children[t]&&(n=Math.max(n,this._children[t].getContentSize().width),this._children[t].setPosition(0,r-this._children[t].getContentSize().height*this._children[t].getScaleY()/2),r-=this._children[t].getContentSize().height*this._children[t].getScaleY()+e);this.setContentSize(n,i)},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(e){var t,i=-e;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)this._children[t]&&(i+=this._children[t].getContentSize().width*this._children[t].getScaleX()+e);var n=0,r=-i/2;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)this._children[t]&&(n=Math.max(n,this._children[t].getContentSize().height),this._children[t].setPosition(r+this._children[t].getContentSize().width*this._children[t].getScaleX()/2,0),r+=this._children[t].getContentSize().width*this._children[t].getScaleX()+e);this.setContentSize(i,n)},alignItemsInColumns:function(e){var t,i=[];for(t=1;t<arguments.length;t++)i.push(arguments[t]);var n,r,o=-5,s=0,a=0,c=0;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)if(this._children[t]){if(s>=i.length){cc.log("cc.MenuPassive.alignItemsInColumns(): invalid row index");continue}if(!(n=i[s])){cc.log("cc.MenuPassive.alignItemsInColumns(): can not have zero columns on a row");continue}a=0|(a>=(r=this._children[t].getContentSize().height)||null==r?a:r),++c>=n&&(o+=a+5,c=0,a=0,++s)}var l=cc.director.getWinSize();s=0,a=0,n=0;var u=0,h=0,d=o/2;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)this._children[t]&&(0==n&&(n=i[s],h=u=l.width/(1+n)),a=0|(a>=(r=this._children[t].getContentSize().height)||null==r?a:r),this._children[t].setPosition(h-l.width/2,d-this._children[t].getContentSize().height/2),h+=u,++c>=n&&(d-=a+5,c=0,n=0,a=0,++s))},alignItemsInRows:function(e){var t,i=[];for(t=1;t<arguments.length;t++)i.push(arguments[t]);var n,r,o=[],s=[],a=-10,c=-5,l=0,u=0,h=0;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)if(this._children[t]){if(l>=i.length){cc.log("cc.MenuPassive.alignItemsInRows(): invalid row index");continue}if(!(n=i[l])){cc.log("cc.MenuPassive.alignItemsInColumns(): can't have zero rows on a column");continue}u=0|(u>=(r=this._children[t].getContentSize().width)||null==r?u:r),c+=0|this._children[t].getContentSize().height+5,++h>=n&&(o.push(u),s.push(c),a+=u+10,h=0,u=0,c=-5,++l)}var d=cc.director.getWinSize();l=0,u=0,n=null;var p=-a/2,_=0;if(this._children&&this._children.length>0)for(t=0;t<this._children.length;t++)this._children[t]&&(null==n&&(n=i[l],_=s[l]),u=0|(u>=(r=this._children[t].getContentSize().width)||null==r?u:r),this._children[t].setPosition(p+o[l]/2,_-d.height/2),_-=this._children[t].getContentSize().height+10,++h>=n&&(p+=u+5,h=0,n=0,u=0,++l))},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1}}),cc.MenuPassive.create=function(e){e||(e=null);for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=new cc.MenuPassive;return n&&n.initWithItems(e,t)?n:null},cc.MenuPassive.createWithItem=function(e){return cc.MenuPassive.create(e,null)},cc.ControlSaturationBrightnessPicker=cc.Control.extend({_saturation:0,_brightness:0,_background:null,_overlay:null,_shadow:null,_slider:null,_startPos:null,_boxPos:0,_boxSize:0,_className:"ControlSaturationBrightnessPicker",ctor:function(e,t){cc.Control.prototype.ctor.call(this),t&&this.initWithTargetAndPos(e,t)},getSaturation:function(){return this._saturation},getBrightness:function(){return this._brightness},getBackground:function(){return this._background},getOverlay:function(){return this._brightness},getShadow:function(){return this._shadow},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(e,t){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerBackground.png",e,t,cc.p(0,0)),this._overlay=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerOverlay.png",e,t,cc.p(0,0)),this._shadow=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerShadow.png",e,t,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",e,t,cc.p(.5,.5)),this._startPos=t,this._boxPos=35,this._boxSize=this._background.getContentSize().width/2,!0)},setEnabled:function(e){cc.Control.prototype.setEnabled.call(this,e),this._slider&&this._slider.setOpacity(e?255:128)},updateWithHSV:function(e){var t=new cc.HSV;t.s=1,t.h=e.h,t.v=1;var i=cc.ControlUtils.RGBfromHSV(t);this._background.setColor(cc.color(0|255*i.r,0|255*i.g,0|255*i.b))},updateDraggerWithHSV:function(e){var t=cc.p(this._startPos.x+this._boxPos+this._boxSize*(1-e.s),this._startPos.y+this._boxPos+this._boxSize*e.v);this._updateSliderPosition(t)},_updateSliderPosition:function(e){var t=this._startPos.x+.5*this._background.getBoundingBox().width,i=this._startPos.y+.5*this._background.getBoundingBox().height,n=e.x-t,r=e.y-i,o=Math.sqrt(n*n+r*r),s=Math.atan2(r,n),a=.5*this._background.getBoundingBox().width;o>a&&(e.x=t+a*Math.cos(s),e.y=i+a*Math.sin(s)),this._slider.setPosition(e),e.x<this._startPos.x+this._boxPos?e.x=this._startPos.x+this._boxPos:e.x>this._startPos.x+this._boxPos+this._boxSize-1&&(e.x=this._startPos.x+this._boxPos+this._boxSize-1),e.y<this._startPos.y+this._boxPos?e.y=this._startPos.y+this._boxPos:e.y>this._startPos.y+this._boxPos+this._boxSize&&(e.y=this._startPos.y+this._boxPos+this._boxSize),this._saturation=1-Math.abs((this._startPos.x+this._boxPos-e.x)/this._boxSize),this._brightness=Math.abs((this._startPos.y+this._boxPos-e.y)/this._boxSize)},_checkSliderPosition:function(e){var t=this._startPos.x+.5*this._background.getBoundingBox().width,i=this._startPos.y+.5*this._background.getBoundingBox().height,n=e.x-t,r=e.y-i;return Math.sqrt(n*n+r*r)<=.5*this._background.getBoundingBox().width&&(this._updateSliderPosition(e),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),!0)},onTouchBegan:function(e,t){if(!this.isEnabled()||!this.isVisible())return!1;var i=this.getTouchLocation(e);return this._checkSliderPosition(i)},onTouchMoved:function(e,t){var i=this.getTouchLocation(e);this._checkSliderPosition(i)}}),(_p=cc.ControlSaturationBrightnessPicker.prototype).saturation,cc.defineGetterSetter(_p,"saturation",_p.getSaturation),_p.brightness,cc.defineGetterSetter(_p,"brightness",_p.getBrightness),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.overlay,cc.defineGetterSetter(_p,"overlay",_p.getOverlay),_p.shadow,cc.defineGetterSetter(_p,"shadow",_p.getShadow),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlSaturationBrightnessPicker.create=function(e,t){return new cc.ControlSaturationBrightnessPicker(e,t)},cc.ControlHuePicker=cc.Control.extend({_hue:0,_huePercentage:0,_background:null,_slider:null,_startPos:null,_className:"ControlHuePicker",ctor:function(e,t){cc.Control.prototype.ctor.call(this),t&&this.initWithTargetAndPos(e,t)},getHue:function(){return this._hue},setHue:function(e){this._hue=e,this.setHuePercentage(this._hue/360)},getHuePercentage:function(){return this._huePercentage},setHuePercentage:function(e){this._huePercentage=e,this._hue=360*this._huePercentage;var t=this._background.getBoundingBox(),i=this._startPos.x+.5*t.width,n=this._startPos.y+.5*t.height,r=.5*t.width-15,o=360*this._huePercentage-180,s=cc.degreesToRadians(o),a=i+r*Math.cos(s),c=n+r*Math.sin(s);this._slider.setPosition(a,c)},setEnabled:function(e){cc.Control.prototype.setEnabled.call(this,e),this._slider&&this._slider.setOpacity(e?255:128)},getBackground:function(){return this._background},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(e,t){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("huePickerBackground.png",e,t,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",e,t,cc.p(.5,.5)),this._slider.setPosition(t.x,t.y+.5*this._background.getBoundingBox().height),this._startPos=t,this._hue=0,this._huePercentage=0,!0)},_updateSliderPosition:function(e){var t=this._background.getBoundingBox(),i=this._startPos.x+.5*t.width,n=this._startPos.y+.5*t.height,r=e.x-i,o=e.y-n,s=Math.atan2(o,r),a=cc.radiansToDegrees(s)+180;this.setHue(a),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},_checkSliderPosition:function(e){var t=Math.sqrt(Math.pow(e.x+10,2)+Math.pow(e.y,2));return 80>t&&t>59&&(this._updateSliderPosition(e),!0)},onTouchBegan:function(e,t){if(!this.isEnabled()||!this.isVisible())return!1;var i=this.getTouchLocation(e);return this._checkSliderPosition(i)},onTouchMoved:function(e,t){var i=this.getTouchLocation(e);this._checkSliderPosition(i)}}),(_p=cc.ControlHuePicker.prototype).hue,cc.defineGetterSetter(_p,"hue",_p.getHue,_p.setHue),_p.huePercent,cc.defineGetterSetter(_p,"huePercent",_p.getHuePercentage,_p.setHuePercentage),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlHuePicker.create=function(e,t){return new cc.ControlHuePicker(e,t)},cc.ControlColourPicker=cc.Control.extend({_hsv:null,_colourPicker:null,_huePicker:null,_background:null,_className:"ControlColourPicker",ctor:function(){cc.Control.prototype.ctor.call(this),this.init()},hueSliderValueChanged:function(e,t){this._hsv.h=e.getHue();var i=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*i.r,0|255*i.g,0|255*i.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),this._updateControlPicker()},colourSliderValueChanged:function(e,t){this._hsv.s=e.getSaturation(),this._hsv.v=e.getBrightness();var i=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*i.r,0|255*i.g,0|255*i.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},setColor:function(e){cc.Control.prototype.setColor.call(this,e);var t=new cc.RGBA;t.r=e.r/255,t.g=e.g/255,t.b=e.b/255,t.a=1,this._hsv=cc.ControlUtils.HSVfromRGB(t),this._updateHueAndControlPicker()},getBackground:function(){return this._background},init:function(){if(cc.Control.prototype.init.call(this)){cc.spriteFrameCache.addSpriteFrames(res.CCControlColourPickerSpriteSheet_plist);var e=new cc.SpriteBatchNode(res.CCControlColourPickerSpriteSheet_png);this.addChild(e),this._hsv=new cc.HSV(0,0,0),this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("menuColourPanelBackground.png",e,cc.p(0,0),cc.p(.5,.5));var t=cc.pSub(this._background.getPosition(),cc.p(this._background.getContentSize().width/2,this._background.getContentSize().height/2));return this._huePicker=new cc.ControlHuePicker(e,cc.p(t.x+8,t.y+8)),this._colourPicker=new cc.ControlSaturationBrightnessPicker(e,cc.p(t.x+28,t.y+28)),this._huePicker.addTargetWithActionForControlEvents(this,this.hueSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._colourPicker.addTargetWithActionForControlEvents(this,this.colourSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._updateHueAndControlPicker(),this.addChild(this._huePicker),this.addChild(this._colourPicker),this.setContentSize(this._background.getContentSize()),!0}return!1},_updateControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv)},_updateHueAndControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv),this._colourPicker.updateDraggerWithHSV(this._hsv)},setEnabled:function(e){cc.Control.prototype.setEnabled.call(this,e),null!=this._huePicker&&this._huePicker.setEnabled(e),this._colourPicker&&this._colourPicker.setEnabled(e)},onTouchBegan:function(){return!1}}),(_p=cc.ControlColourPicker.prototype).background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p=null,cc.ControlColourPicker.create=function(){return new cc.ControlColourPicker};var res=res||{};res.CCControlColourPickerSpriteSheet_plist=res.CCControlColourPickerSpriteSheet_plist||"res/extensions/CCControlColourPickerSpriteSheet.plist",res.CCControlColourPickerSpriteSheet_png=res.CCControlColourPickerSpriteSheet_png||"res/extensions/CCControlColourPickerSpriteSheet.png",cc.SLIDER_MARGIN_H=24,cc.SLIDER_MARGIN_V=8,cc.ControlSlider=cc.Control.extend({_value:0,_minimumValue:0,_maximumValue:0,_minimumAllowedValue:0,_maximumAllowedValue:0,_thumbSprite:null,_progressSprite:null,_backgroundSprite:null,_className:"ControlSlider",ctor:function(e,t,i){if(cc.Control.prototype.ctor.call(this),void 0!=i){var n=new cc.Sprite(e),r=new cc.Sprite(t),o=new cc.Sprite(i);this.initWithSprites(n,r,o)}},getValue:function(){return this._value},setValue:function(e){e=Math.max(e,this._minimumValue),e=Math.min(e,this._maximumValue),this._value=e,this.needsLayout(),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getMinimumValue:function(){return this._minimumValue},setMinimumValue:function(e){this._minimumValue=e,this._minimumAllowedValue=e,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setMaximumValue:function(e){this._maximumValue=e,this._maximumAllowedValue=e,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._value)},isTouchInside:function(e){var t=e.getLocation();t=this.getParent().convertToNodeSpace(t);var i=this.getBoundingBox();return i.width+=this._thumbSprite.getContentSize().width,i.x-=this._thumbSprite.getContentSize().width/2,cc.rectContainsPoint(i,t)},locationFromTouch:function(e){var t=e.getLocation();return(t=this.convertToNodeSpace(t)).x<0?t.x=0:t.x>this._backgroundSprite.getContentSize().width&&(t.x=this._backgroundSprite.getContentSize().width),t},getMinimumAllowedValue:function(){return this._minimumAllowedValue},setMinimumAllowedValue:function(e){this._minimumAllowedValue=e},getMaximumAllowedValue:function(){return this._maximumAllowedValue},setMaximumAllowedValue:function(e){this._maximumAllowedValue=e},getThumbSprite:function(){return this._thumbSprite},getProgressSprite:function(){return this._progressSprite},getBackgroundSprite:function(){return this._backgroundSprite},initWithSprites:function(e,t,i){if(cc.Control.prototype.init.call(this)){this.ignoreAnchorPointForPosition(!1),this._backgroundSprite=e,this._progressSprite=t,this._thumbSprite=i;var n=cc.ControlUtils.CCRectUnion(e.getBoundingBox(),i.getBoundingBox());return this.setContentSize(n.width,n.height),this._backgroundSprite.setAnchorPoint(.5,.5),this._backgroundSprite.setPosition(n.width/2,n.height/2),this.addChild(this._backgroundSprite),this._progressSprite.setAnchorPoint(0,.5),this._progressSprite.setPosition(0,n.height/2),this.addChild(this._progressSprite),this._thumbSprite.setPosition(0,n.height/2),this.addChild(this._thumbSprite),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0}return!1},setEnabled:function(e){cc.Control.prototype.setEnabled.call(this,e),this._thumbSprite&&this._thumbSprite.setOpacity(e?255:128)},sliderBegan:function(e){this.setSelected(!0),this._thumbSprite.setColor(cc.color.GRAY),this.setValue(this.valueForLocation(e))},sliderMoved:function(e){this.setValue(this.valueForLocation(e))},sliderEnded:function(e){this.isSelected()&&this.setValue(this.valueForLocation(this._thumbSprite.getPosition())),this._thumbSprite.setColor(cc.color.WHITE),this.setSelected(!1)},getTouchLocationInControl:function(e){var t=e.getLocation();return(t=this.convertToNodeSpace(t)).x<0?t.x=0:t.x>this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H&&(t.x=this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H),t},onTouchBegan:function(e,t){if(!this.isTouchInside(e)||!this.isEnabled()||!this.isVisible())return!1;var i=this.locationFromTouch(e);return this.sliderBegan(i),!0},onTouchMoved:function(e,t){var i=this.locationFromTouch(e);this.sliderMoved(i)},onTouchEnded:function(e,t){this.sliderEnded(cc.p(0,0))},needsLayout:function(){var e=(this._value-this._minimumValue)/(this._maximumValue-this._minimumValue);this._thumbSprite.setPositionX(e*this._backgroundSprite.getContentSize().width);var t=this._progressSprite.getTextureRect();t=cc.rect(t.x,t.y,this._thumbSprite.getPositionX(),t.height),this._progressSprite.setTextureRect(t,this._progressSprite.isTextureRectRotated()),this._thumbSprite._renderCmd.transform(this._renderCmd)},valueForLocation:function(e){var t=e.x/this._backgroundSprite.getContentSize().width;return Math.max(Math.min(this._minimumValue+t*(this._maximumValue-this._minimumValue),this._maximumAllowedValue),this._minimumAllowedValue)}}),(_p=cc.ControlSlider.prototype).value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.minAllowedValue,cc.defineGetterSetter(_p,"minAllowedValue",_p.getMinimumAllowedValue,_p.setMinimumAllowedValue),_p.maxAllowedValue,cc.defineGetterSetter(_p,"maxAllowedValue",_p.getMaximumAllowedValue,_p.setMaximumAllowedValue),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite),_p.progressSprite,cc.defineGetterSetter(_p,"progressSprite",_p.getProgressSprite),_p.backgroundSprite,cc.defineGetterSetter(_p,"backgroundSprite",_p.getBackgroundSprite),_p=null,cc.ControlSlider.create=function(e,t,i){return new cc.ControlSlider(e,t,i)},cc.ControlSwitch=cc.Control.extend({_switchSprite:null,_initialTouchXPosition:0,_moved:!1,_on:!1,_className:"ControlSwitch",ctor:function(e,t,i,n,r,o){cc.Control.prototype.ctor.call(this),o&&this.initWithMaskSprite(e,t,i,n,r,o)},initWithMaskSprite:function(e,t,i,n,r,o){if(!e)throw"cc.ControlSwitch.initWithMaskSprite(): maskSprite should be non-null.";if(!t)throw"cc.ControlSwitch.initWithMaskSprite(): onSprite should be non-null.";if(!i)throw"cc.ControlSwitch.initWithMaskSprite(): offSprite should be non-null.";if(!n)throw"cc.ControlSwitch.initWithMaskSprite(): thumbSprite should be non-null.";return!!this.init()&&(this._on=!0,this._switchSprite=new cc.ControlSwitchSprite,this._switchSprite.initWithMaskSprite(e,t,i,n,r,o),this._switchSprite.setPosition(this._switchSprite.getContentSize().width/2,this._switchSprite.getContentSize().height/2),this.addChild(this._switchSprite),this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this.setContentSize(this._switchSprite.getContentSize()),!0)},setOn:function(e,t){t=t||!1,this._on=e;var i=this._on?this._switchSprite.getOnPosition():this._switchSprite.getOffPosition();t?this._switchSprite.runAction(new cc.ActionTween(.2,"sliderXPosition",this._switchSprite.getSliderXPosition(),i)):this._switchSprite.setSliderXPosition(i),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},isOn:function(){return this._on},hasMoved:function(){return this._moved},setEnabled:function(e){this._enabled=e,this._switchSprite.setOpacity(e?255:128)},locationFromTouch:function(e){var t=e.getLocation();return t=this.convertToNodeSpace(t)},onTouchBegan:function(e,t){if(!this.isTouchInside(e)||!this.isEnabled()||!this.isVisible())return!1;this._moved=!1;var i=this.locationFromTouch(e);return this._initialTouchXPosition=i.x-this._switchSprite.getSliderXPosition(),this._switchSprite.getThumbSprite().setColor(cc.color.GRAY),this._switchSprite.needsLayout(),!0},onTouchMoved:function(e,t){var i=this.locationFromTouch(e);i=cc.p(i.x-this._initialTouchXPosition,0),this._moved=!0,this._switchSprite.setSliderXPosition(i.x)},onTouchEnded:function(e,t){var i=this.locationFromTouch(e);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(i.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)},onTouchCancelled:function(e,t){var i=this.locationFromTouch(e);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(i.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)}}),cc.ControlSwitch.create=function(e,t,i,n,r,o){return new cc.ControlSwitch(e,t,i,n,r,o)},cc.ControlSwitchSprite=cc.Sprite.extend({_sliderXPosition:0,_onPosition:0,_offPosition:0,_textureLocation:0,_maskLocation:0,_maskSize:null,_onSprite:null,_offSprite:null,_thumbSprite:null,_onLabel:null,_offLabel:null,_clipper:null,_stencil:null,_backRT:null,ctor:function(){cc.Sprite.prototype.ctor.call(this),this._sliderXPosition=0,this._onPosition=0,this._offPosition=0,this._maskLocation=0,this._maskSize=cc.size(0,0),this._onSprite=null,this._offSprite=null,this._thumbSprite=null,this._onLabel=null,this._offLabel=null},initWithMaskSprite:function(e,t,i,n,r,o){if(cc.Sprite.prototype.init.call(this)){this.setSpriteFrame(e.displayFrame()),this._onPosition=0,this._offPosition=-t.getContentSize().width+n.getContentSize().width/2,this._sliderXPosition=this._onPosition,this.setOnSprite(t),this.setOffSprite(i),this.setThumbSprite(n),this.setOnLabel(r),this.setOffLabel(o),this._stencil=e;var s=this._maskSize=this._stencil.getContentSize();return this._stencil.setPosition(0,0),this._clipper=new cc.ClippingNode,this._clipper.setAnchorPoint(.5,.5),this._clipper.setPosition(s.width/2,s.height/2),this._clipper.setStencil(this._stencil),this.addChild(this._clipper),this._clipper.addChild(t),this._clipper.addChild(i),this._clipper.addChild(r),this._clipper.addChild(o),this.addChild(this._thumbSprite),this.needsLayout(),!0}return!1},needsLayout:function(){var e=this._maskSize;this._onSprite.setPosition(this._onSprite.getContentSize().width/2+this._sliderXPosition-e.width/2,this._onSprite.getContentSize().height/2-e.height/2),this._offSprite.setPosition(this._onSprite.getContentSize().width+this._offSprite.getContentSize().width/2+this._sliderXPosition-e.width/2,this._offSprite.getContentSize().height/2-e.height/2),this._onLabel&&this._onLabel.setPosition(this._onSprite.getPositionX()-this._thumbSprite.getContentSize().width/6,this._onSprite.getContentSize().height/2-e.height/2),this._offLabel&&this._offLabel.setPosition(this._offSprite.getPositionX()+this._thumbSprite.getContentSize().width/6,this._offSprite.getContentSize().height/2-e.height/2),this._thumbSprite.setPosition(this._onSprite.getContentSize().width+this._sliderXPosition,this._maskSize.height/2)},setSliderXPosition:function(e){e<=this._offPosition?e=this._offPosition:e>=this._onPosition&&(e=this._onPosition),this._sliderXPosition=e,this.needsLayout()},getSliderXPosition:function(){return this._sliderXPosition},_getOnSideWidth:function(){return this._onSprite.getContentSize().width},_getOffSideWidth:function(){return this._offSprite.getContentSize().height},updateTweenAction:function(e,t){"sliderXPosition"===t&&this.setSliderXPosition(e)},setOnPosition:function(e){this._onPosition=e},getOnPosition:function(){return this._onPosition},setOffPosition:function(e){this._offPosition=e},getOffPosition:function(){return this._offPosition},setMaskTexture:function(e){this._stencil.setTexture(e)},getMaskTexture:function(){return this._stencil.getTexture()},setTextureLocation:function(e){this._textureLocation=e},getTextureLocation:function(){return this._textureLocation},setMaskLocation:function(e){this._maskLocation=e},getMaskLocation:function(){return this._maskLocation},setOnSprite:function(e){this._onSprite=e},getOnSprite:function(){return this._onSprite},setOffSprite:function(e){this._offSprite=e},getOffSprite:function(){return this._offSprite},setThumbSprite:function(e){this._thumbSprite=e},getThumbSprite:function(){return this._thumbSprite},setOnLabel:function(e){this._onLabel=e},getOnLabel:function(){return this._onLabel},setOffLabel:function(e){this._offLabel=e},getOffLabel:function(){return this._offLabel}}),(_p=cc.ControlSwitchSprite.prototype).sliderX,cc.defineGetterSetter(_p,"sliderX",_p.getSliderXPosition,_p.setSliderXPosition),_p.onPos,cc.defineGetterSetter(_p,"onPos",_p.getOnPosition,_p.setOnPosition),_p.offPos,cc.defineGetterSetter(_p,"offPos",_p.getOffPosition,_p.setOffPosition),_p.maskTexture,cc.defineGetterSetter(_p,"maskTexture",_p.getMaskTexture,_p.setMaskTexture),_p.maskPos,cc.defineGetterSetter(_p,"maskPos",_p.getMaskLocation,_p.setMaskLocation),_p.onSprite,cc.defineGetterSetter(_p,"onSprite",_p.getOnSprite,_p.setOnSprite),_p.offSprite,cc.defineGetterSetter(_p,"offSprite",_p.getOffSprite,_p.setOffSprite),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.onLabel,cc.defineGetterSetter(_p,"onLabel",_p.getOnLabel,_p.setOnLabel),_p.offLabel,cc.defineGetterSetter(_p,"offLabel",_p.getOffLabel,_p.setOffLabel),_p.onSideWidth,cc.defineGetterSetter(_p,"onSideWidth",_p._getOnSideWidth),_p.offSideWidth,cc.defineGetterSetter(_p,"offSideWidth",_p._getOffSideWidth),_p=null,cc.CONTROL_STEPPER_PARTMINUS=0,cc.CONTROL_STEPPER_PARTPLUS=1,cc.CONTROL_STEPPER_PARTNONE=2,cc.CONTROL_STEPPER_LABELCOLOR_ENABLED=cc.color(55,55,55),cc.CONTROL_STEPPER_LABELCOLOR_DISABLED=cc.color(147,147,147),cc.CONTROL_STEPPER_LABELFONT="CourierNewPSMT",cc.AUTOREPEAT_DELTATIME=.15,cc.AUTOREPEAT_INCREASETIME_INCREMENT=12,cc.ControlStepper=cc.Control.extend({_minusSprite:null,_plusSprite:null,_minusLabel:null,_plusLabel:null,_value:0,_continuous:!1,_autorepeat:!1,_wraps:!1,_minimumValue:0,_maximumValue:0,_stepValue:0,_touchInsideFlag:!1,_touchedPart:cc.CONTROL_STEPPER_PARTNONE,_autorepeatCount:0,_className:"ControlStepper",ctor:function(e,t){cc.Control.prototype.ctor.call(this),this._minusSprite=null,this._plusSprite=null,this._minusLabel=null,this._plusLabel=null,this._value=0,this._continuous=!1,this._autorepeat=!1,this._wraps=!1,this._minimumValue=0,this._maximumValue=0,this._stepValue=0,this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._autorepeatCount=0,t&&this.initWithMinusSpriteAndPlusSprite(e,t)},initWithMinusSpriteAndPlusSprite:function(e,t){if(!e)throw"cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Minus sprite should be non-null.";if(!t)throw"cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Plus sprite should be non-null.";if(this.init()){this._autorepeat=!0,this._continuous=!0,this._minimumValue=0,this._maximumValue=100,this._value=0,this._stepValue=1,this._wraps=!1,this.ignoreAnchorPointForPosition(!1),this.setMinusSprite(e),this._minusSprite.setPosition(e.getContentSize().width/2,e.getContentSize().height/2),this.addChild(this._minusSprite),this.setMinusLabel(new cc.LabelTTF("-",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_DISABLED),this._minusLabel.setPosition(this._minusSprite.getContentSize().width/2,this._minusSprite.getContentSize().height/2),this._minusSprite.addChild(this._minusLabel),this.setPlusSprite(t),this._plusSprite.setPosition(e.getContentSize().width+t.getContentSize().width/2,e.getContentSize().height/2),this.addChild(this._plusSprite),this.setPlusLabel(new cc.LabelTTF("+",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setPosition(this._plusSprite.getContentSize().width/2,this._plusSprite.getContentSize().height/2),this._plusSprite.addChild(this._plusLabel);var i=cc.ControlUtils.CCRectUnion(this._minusSprite.getBoundingBox(),this._plusSprite.getBoundingBox());return this.setContentSize(this._minusSprite.getContentSize().width+this._plusSprite.getContentSize().height,i.height),!0}return!1},setWraps:function(e){this._wraps=e,this._wraps&&(this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),this.setValue(this._value)},getWraps:function(){return this._wraps},setMinimumValue:function(e){if(e>=this._maximumValue)throw"cc.ControlStepper.setMinimumValue(): minimumValue should be numerically less than maximumValue.";this._minimumValue=e,this.setValue(this._value)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(e){if(e<=this._minimumValue)throw"cc.ControlStepper.setMaximumValue(): maximumValue should be numerically less than maximumValue.";this._maximumValue=e,this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setValue:function(e){this.setValueWithSendingEvent(e,!0)},getValue:function(){return this._value},setStepValue:function(e){if(e<=0)throw"cc.ControlStepper.setMaximumValue(): stepValue should be numerically greater than 0.";this._stepValue=e},getStepValue:function(){return this._stepValue},isContinuous:function(){return this._continuous},setValueWithSendingEvent:function(e,t){e<this._minimumValue?e=this._wraps?this._maximumValue:this._minimumValue:e>this._maximumValue&&(e=this._wraps?this._minimumValue:this._maximumValue),this._value=e,this._wraps||(this._minusLabel.setColor(e==this._minimumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(e==this._maximumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),t&&this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},startAutorepeat:function(){this._autorepeatCount=-1,this.schedule(this.update,cc.AUTOREPEAT_DELTATIME,cc.REPEAT_FOREVER,3*cc.AUTOREPEAT_DELTATIME)},stopAutorepeat:function(){this.unschedule(this.update)},update:function(e){++this._autorepeatCount<cc.AUTOREPEAT_INCREASETIME_INCREMENT&&this._autorepeatCount%3!=0||(this._touchedPart==cc.CONTROL_STEPPER_PARTMINUS?this.setValueWithSendingEvent(this._value-this._stepValue,this._continuous):this._touchedPart==cc.CONTROL_STEPPER_PARTPLUS&&this.setValueWithSendingEvent(this._value+this._stepValue,this._continuous))},updateLayoutUsingTouchLocation:function(e){e.x<this._minusSprite.getContentSize().width&&this._value>this._minimumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTMINUS,this._minusSprite.setColor(cc.color.GRAY),this._plusSprite.setColor(cc.color.WHITE)):e.x>=this._minusSprite.getContentSize().width&&this._value<this._maximumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTPLUS,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.GRAY)):(this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE))},onTouchBegan:function(e,t){if(!this.isTouchInside(e)||!this.isEnabled()||!this.isVisible())return!1;var i=this.getTouchLocation(e);return this.updateLayoutUsingTouchLocation(i),this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat(),!0},onTouchMoved:function(e,t){if(this.isTouchInside(e)){var i=this.getTouchLocation(e);this.updateLayoutUsingTouchLocation(i),this._touchInsideFlag||(this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat())}else this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat()},onTouchEnded:function(e,t){if(this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat(),this.isTouchInside(e)){var i=this.getTouchLocation(e);this.setValue(this._value+(i.x<this._minusSprite.getContentSize().width?0-this._stepValue:this._stepValue))}},setMinusSprite:function(e){this._minusSprite=e},getMinusSprite:function(){return this._minusSprite},setPlusSprite:function(e){this._plusSprite=e},getPlusSprite:function(){return this._plusSprite},setMinusLabel:function(e){this._minusLabel=e},getMinusLabel:function(){return this._minusLabel},setPlusLabel:function(e){this._plusLabel=e},getPlusLabel:function(){return this._plusLabel}}),(_p=cc.ControlStepper.prototype).wraps,cc.defineGetterSetter(_p,"wraps",_p.getWraps,_p.setWraps),_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.stepValue,cc.defineGetterSetter(_p,"stepValue",_p.getStepValue,_p.setStepValue),_p.continuous,cc.defineGetterSetter(_p,"continuous",_p.isContinuous),_p.minusSprite,cc.defineGetterSetter(_p,"minusSprite",_p.getMinusSprite,_p.setMinusSprite),_p.plusSprite,cc.defineGetterSetter(_p,"plusSprite",_p.getPlusSprite,_p.setPlusSprite),_p.minusLabel,cc.defineGetterSetter(_p,"minusLabel",_p.getMinusLabel,_p.setMinusLabel),_p.plusLabel,cc.defineGetterSetter(_p,"plusLabel",_p.getPlusLabel,_p.setPlusLabel),_p=null,cc.ControlStepper.create=function(e,t){return new cc.ControlStepper(e,t)},cc.ControlPotentiometer=cc.Control.extend({_thumbSprite:null,_progressTimer:null,_previousLocation:null,_value:0,_minimumValue:0,_maximumValue:1,_className:"ControlPotentiometer",ctor:function(e,t,i){if(cc.Control.prototype.ctor.call(this),void 0!=i){var n=new cc.Sprite(e),r=new cc.Sprite(i),o=new cc.ProgressTimer(new cc.Sprite(t));this.initWithTrackSprite_ProgressTimer_ThumbSprite(n,o,r)}},initWithTrackSprite_ProgressTimer_ThumbSprite:function(e,t,i){return!!this.init()&&(this.setProgressTimer(t),this.setThumbSprite(i),this._thumbSprite.setPosition(t.getPosition()),this.addChild(i,2),this.addChild(t,1),this.addChild(e),this.setContentSize(e.getContentSize()),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0)},setEnabled:function(e){this.setEnabled(e),this._thumbSprite!=NULL&&this._thumbSprite.setOpacity(e?255:128)},setValue:function(e){e<this._minimumValue&&(e=this._minimumValue),e>this._maximumValue&&(e=this._maximumValue),this._value=e;var t=(e-this._minimumValue)/(this._maximumValue-this._minimumValue);this._progressTimer.setPercentage(100*t),this._thumbSprite.setRotation(360*t),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getValue:function(){return this._value},setMinimumValue:function(e){this._minimumValue=e,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._maximumValue)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(e){this._maximumValue=e,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._minimumValue)},getMaximumValue:function(){return this._maximumValue},isTouchInside:function(e){var t=this.getTouchLocation(e);return this.distanceBetweenPointAndPoint(this._progressTimer.getPosition(),t)<Math.min(this.getContentSize().width/2,this.getContentSize().height/2)},onTouchBegan:function(e,t){return!!(this.isTouchInside(e)&&this.isEnabled()&&this.isVisible())&&(this._previousLocation=this.getTouchLocation(e),this.potentiometerBegan(this._previousLocation),!0)},onTouchMoved:function(e,t){var i=this.getTouchLocation(e);this.potentiometerMoved(i)},onTouchEnded:function(e,t){this.potentiometerEnded(cc.p(0,0))},distanceBetweenPointAndPoint:function(e,t){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint:function(e,t,i,n){var r=t.x-e.x,o=t.y-e.y,s=n.x-i.x,a=n.y-i.y;return 180*(Math.atan2(r,o)-Math.atan2(s,a))/Math.PI},potentiometerBegan:function(e){this.setSelected(!0),this.getThumbSprite().setColor(cc.color.GRAY)},potentiometerMoved:function(e){var t=this.angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint(this._progressTimer.getPosition(),e,this._progressTimer.getPosition(),this._previousLocation);t>180?t-=360:t<-180&&(t+=360),this.setValue(this._value+t/360*(this._maximumValue-this._minimumValue)),this._previousLocation=e},potentiometerEnded:function(e){this.getThumbSprite().setColor(cc.color.WHITE),this.setSelected(!1)},setThumbSprite:function(e){this._thumbSprite=e},getThumbSprite:function(){return this._thumbSprite},setProgressTimer:function(e){this._progressTimer=e},getProgressTimer:function(){return this._progressTimer},setPreviousLocation:function(e){this._previousLocation=e},getPreviousLocation:function(){return this._previousLocation}}),(_p=cc.ControlPotentiometer.prototype).value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.progressTimer,cc.defineGetterSetter(_p,"progressTimer",_p.getProgressTimer,_p.setProgressTimer),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.prevLocation,cc.defineGetterSetter(_p,"prevLocation",_p.getPreviousLocation,_p.setPreviousLocation),_p=null,cc.ControlPotentiometer.create=function(e,t,i){return new cc.ControlPotentiometer(e,t,i)},cc.SCROLLVIEW_DIRECTION_NONE=-1,cc.SCROLLVIEW_DIRECTION_HORIZONTAL=0,cc.SCROLLVIEW_DIRECTION_VERTICAL=1,cc.SCROLLVIEW_DIRECTION_BOTH=2;var SCROLL_DEACCEL_RATE=.95,SCROLL_DEACCEL_DIST=1,BOUNCE_DURATION=.15,INSET_RATIO=.2,MOVE_INCH=7/160,BOUNCE_BACK_FACTOR=.35;cc.convertDistanceFromPointToInch=function(e){var t=cc.view;return e*((t.getScaleX()+t.getScaleY())/2)/160},cc.ScrollViewDelegate=cc.Class.extend({scrollViewDidScroll:function(e){},scrollViewDidZoom:function(e){}}),cc.ScrollView=cc.Layer.extend({_zoomScale:0,_minZoomScale:0,_maxZoomScale:0,_delegate:null,_direction:cc.SCROLLVIEW_DIRECTION_BOTH,_dragging:!1,_contentOffset:null,_container:null,_touchMoved:!1,_maxInset:null,_minInset:null,_bounceable:!1,_clippingToBounds:!1,_scrollDistance:null,_touchPoint:null,_touchLength:0,_touches:null,_viewSize:null,_minScale:0,_maxScale:0,_parentScissorRect:null,_scissorRestored:!1,_tmpViewRect:null,_touchListener:null,_className:"ScrollView",ctor:function(e,t){cc.Layer.prototype.ctor.call(this),this._contentOffset=cc.p(0,0),this._maxInset=cc.p(0,0),this._minInset=cc.p(0,0),this._scrollDistance=cc.p(0,0),this._touchPoint=cc.p(0,0),this._touches=[],this._viewSize=cc.size(0,0),this._parentScissorRect=new cc.Rect(0,0,0,0),this._tmpViewRect=new cc.Rect(0,0,0,0),void 0!=t?this.initWithViewSize(e,t):this.initWithViewSize(cc.size(200,200),null)},init:function(){return this.initWithViewSize(cc.size(200,200),null)},initWithViewSize:function(e,t){var i=cc.p(0,0);return!!cc.Layer.prototype.init.call(this)&&(this._container=t,this._container||(this._container=new cc.Layer,this._container.ignoreAnchorPointForPosition(!1),this._container.setAnchorPoint(i)),this.setViewSize(e),this.setTouchEnabled(!0),this._touches.length=0,this._delegate=null,this._bounceable=!0,this._clippingToBounds=!0,this._direction=cc.SCROLLVIEW_DIRECTION_BOTH,this._container.setPosition(i),this._touchLength=0,this.addChild(this._container),this._minScale=this._maxScale=1,!0)},setContentOffset:function(e,t){if(t)this.setContentOffsetInDuration(e,BOUNCE_DURATION);else{if(!this._bounceable){var i=this.minContainerOffset(),n=this.maxContainerOffset();e.x=Math.max(i.x,Math.min(n.x,e.x)),e.y=Math.max(i.y,Math.min(n.y,e.y))}this._container.setPosition(e);var r=this._delegate;null!=r&&r.scrollViewDidScroll&&r.scrollViewDidScroll(this)}},getContentOffset:function(){var e=this._container.getPosition();return cc.p(e.x,e.y)},setContentOffsetInDuration:function(e,t){var i=cc.moveTo(t,e),n=cc.callFunc(this._stoppedAnimatedScroll,this);this._container.runAction(cc.sequence(i,n)),this.schedule(this._performedAnimatedScroll)},setZoomScale:function(e,t){if(t)this.setZoomScaleInDuration(e,BOUNCE_DURATION);else{var i=this._container;if(i.getScale()!=e){var n,r,o;if(0==this._touchLength){var s=this._viewSize;o=cc.p(.5*s.width,.5*s.height),o=this.convertToWorldSpace(o)}else o=this._touchPoint;n=i.convertToNodeSpace(o),i.setScale(Math.max(this._minScale,Math.min(this._maxScale,e))),r=i.convertToWorldSpace(n);var a=cc.pSub(o,r);this._delegate&&this._delegate.scrollViewDidZoom&&this._delegate.scrollViewDidZoom(this),this.setContentOffset(cc.pAdd(i.getPosition(),a))}}},getZoomScale:function(){return this._container.getScale()},setZoomScaleInDuration:function(e,t){if(t>0){var i=this._container.getScale();if(i!=e){var n=cc.actionTween(t,"zoomScale",i,e);this.runAction(n)}}else this.setZoomScale(e)},minContainerOffset:function(){var e=this._container,t=e.getContentSize(),i=this._viewSize;return cc.p(i.width-t.width*e.getScaleX(),i.height-t.height*e.getScaleY())},maxContainerOffset:function(){return cc.p(0,0)},isNodeVisible:function(e){var t=this.getContentOffset(),i=this.getViewSize(),n=this.getZoomScale(),r=cc.rect(-t.x/n,-t.y/n,i.width/n,i.height/n);return cc.rectIntersectsRect(r,e.getBoundingBox())},pause:function(e){this._container.pause();for(var t=this._container.getChildren(),i=0;i<t.length;i++)t[i].pause();this._super()},resume:function(e){for(var t=this._container.getChildren(),i=0,n=t.length;i<n;i++)t[i].resume();this._container.resume(),this._super()},isDragging:function(){return this._dragging},isTouchMoved:function(){return this._touchMoved},isBounceable:function(){return this._bounceable},setBounceable:function(e){this._bounceable=e},getViewSize:function(){return this._viewSize},setViewSize:function(e){this._viewSize=e,cc.Node.prototype.setContentSize.call(this,e)},getContainer:function(){return this._container},setContainer:function(e){e&&(this.removeAllChildren(!0),this._container=e,e.ignoreAnchorPointForPosition(!1),e.setAnchorPoint(0,0),this.addChild(e),this.setViewSize(this._viewSize))},getDirection:function(){return this._direction},setDirection:function(e){this._direction=e},getDelegate:function(){return this._delegate},setDelegate:function(e){this._delegate=e},onTouchBegan:function(e,t){if(!this.isVisible())return!1;var i=this._getViewRect(),n=this._container,r=n.convertToWorldSpace(n.convertTouchToNodeSpace(e)),o=this._touches;return!(o.length>2||this._touchMoved||!cc.rectContainsPoint(i,r))&&(o.push(e),1===o.length?(this._touchPoint=this.convertTouchToNodeSpace(e),this._touchMoved=!1,this._dragging=!0,this._scrollDistance.x=0,this._scrollDistance.y=0,this._touchLength=0):2==o.length&&(this._touchPoint=cc.pMidpoint(this.convertTouchToNodeSpace(o[0]),this.convertTouchToNodeSpace(o[1])),this._touchLength=cc.pDistance(n.convertTouchToNodeSpace(o[0]),n.convertTouchToNodeSpace(o[1])),this._dragging=!1),!0)},onTouchMoved:function(e,t){if(this.isVisible())if(this.setNodeDirty(),1===this._touches.length&&this._dragging){this._touchMoved=!0;this._getViewRect();var i,n=this.convertTouchToNodeSpace(e),r=cc.pSub(n,this._touchPoint),o=0,s=this._direction;if(s===cc.SCROLLVIEW_DIRECTION_VERTICAL)o=r.y,i=this._container.getPositionY(),this.minContainerOffset().y<=i&&i<=this.maxContainerOffset().y||(r.y*=BOUNCE_BACK_FACTOR);else if(s===cc.SCROLLVIEW_DIRECTION_HORIZONTAL)o=r.x,i=this._container.getPositionX(),this.minContainerOffset().x<=i&&i<=this.maxContainerOffset().x||(r.x*=BOUNCE_BACK_FACTOR);else{o=Math.sqrt(r.x*r.x+r.y*r.y),i=this._container.getPositionY();var a=this.minContainerOffset(),c=this.maxContainerOffset();a.y<=i&&i<=c.y||(r.y*=BOUNCE_BACK_FACTOR),i=this._container.getPositionX(),a.x<=i&&i<=c.x||(r.x*=BOUNCE_BACK_FACTOR)}if(!this._touchMoved&&Math.abs(cc.convertDistanceFromPointToInch(o))<MOVE_INCH)return;if(this._touchMoved||(r.x=0,r.y=0),this._touchPoint=n,this._touchMoved=!0,this._dragging){switch(s){case cc.SCROLLVIEW_DIRECTION_VERTICAL:r.x=0;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:r.y=0}var l=this._container.getPosition(),u=l.x+r.x,h=l.y+r.y;this._scrollDistance=r,this.setContentOffset(cc.p(u,h))}}else if(2===this._touches.length&&!this._dragging){var d=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1]));this.setZoomScale(this.getZoomScale()*d/this._touchLength)}},onTouchEnded:function(e,t){this.isVisible()&&(1==this._touches.length&&this._touchMoved&&this.schedule(this._deaccelerateScrolling),this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},onTouchCancelled:function(e,t){this.isVisible()&&(this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},setContentSize:function(e,t){null!=this.getContainer()&&(void 0===t?this.getContainer().setContentSize(e):this.getContainer().setContentSize(e,t),this.updateInset())},_setWidth:function(e){var t=this.getContainer();null!=t&&(t._setWidth(e),this.updateInset())},_setHeight:function(e){var t=this.getContainer();null!=t&&(t._setHeight(e),this.updateInset())},getContentSize:function(){return this._container.getContentSize()},updateInset:function(){if(null!=this.getContainer()){var e=this._viewSize,t=this.maxContainerOffset();this._maxInset.x=t.x+e.width*INSET_RATIO,this._maxInset.y=t.y+e.height*INSET_RATIO,t=this.minContainerOffset(),this._minInset.x=t.x-e.width*INSET_RATIO,this._minInset.y=t.y-e.height*INSET_RATIO}},isClippingToBounds:function(){return this._clippingToBounds},setClippingToBounds:function(e){this._clippingToBounds=e},visit:function(e){this.isVisible()&&this._renderCmd.visit(e)},addChild:function(e,t,i){if(!e)throw new Error("child must not nil!");t=t||e.getLocalZOrder(),i=i||e.getTag(),this._container!=e?this._container.addChild(e,t,i):cc.Layer.prototype.addChild.call(this,e,t,i)},isTouchEnabled:function(){return null!=this._touchListener},setTouchEnabled:function(e){if(this._touchListener&&cc.eventManager.removeListener(this._touchListener),this._touchListener=null,e){var t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE});this.onTouchBegan&&(t.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(t.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(t.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(t.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=t,cc.eventManager.addListener(t,this)}else this._dragging=!1,this._touchMoved=!1,this._touches.length=0},_initWithViewSize:function(e){return null},_relocateContainer:function(e){var t=this.minContainerOffset(),i=this.maxContainerOffset(),n=this._direction,r=this._container.getPosition(),o=r.x,s=r.y;n!==cc.SCROLLVIEW_DIRECTION_BOTH&&n!==cc.SCROLLVIEW_DIRECTION_HORIZONTAL||(o=Math.max(o,t.x),o=Math.min(o,i.x)),n!=cc.SCROLLVIEW_DIRECTION_BOTH&&n!=cc.SCROLLVIEW_DIRECTION_VERTICAL||(s=Math.min(s,i.y),s=Math.max(s,t.y)),s==r.y&&o==r.x||this.setContentOffset(cc.p(o,s),e)},_deaccelerateScrolling:function(e){if(this._dragging)this.unschedule(this._deaccelerateScrolling);else{var t,i,n=this._container.getPosition(),r=this._scrollDistance;this._container.setPosition(n.x+r.x,n.y+r.y),this._bounceable?(t=this._maxInset,i=this._minInset):(t=this.maxContainerOffset(),i=this.minContainerOffset());var o=this._container.getPositionX(),s=this._container.getPositionY();r.x=r.x*SCROLL_DEACCEL_RATE,r.y=r.y*SCROLL_DEACCEL_RATE,this.setContentOffset(cc.p(o,s)),(Math.abs(r.x)<=SCROLL_DEACCEL_DIST&&Math.abs(r.y)<=SCROLL_DEACCEL_DIST||s>t.y||s<i.y||o>t.x||o<i.x||o==t.x||o==i.x||s==t.y||s==i.y)&&(this.unschedule(this._deaccelerateScrolling),this._relocateContainer(!0))}},_performedAnimatedScroll:function(e){this._dragging?this.unschedule(this._performedAnimatedScroll):this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)},_stoppedAnimatedScroll:function(e){this.unschedule(this._performedAnimatedScroll),this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)},_handleZoom:function(){},_getViewRect:function(){for(var e=this.convertToWorldSpace(cc.p(0,0)),t=this._viewSize,i=this.getScaleX(),n=this.getScaleY(),r=this._parent;null!=r;r=r.getParent())i*=r.getScaleX(),n*=r.getScaleY();i<0&&(e.x+=t.width*i,i=-i),n<0&&(e.y+=t.height*n,n=-n);var o=this._tmpViewRect;return o.x=e.x,o.y=e.y,o.width=t.width*i,o.height=t.height*n,o},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.ScrollView.CanvasRenderCmd(this):new cc.ScrollView.WebGLRenderCmd(this)}}),(_p=cc.ScrollView.prototype).minOffset,cc.defineGetterSetter(_p,"minOffset",_p.minContainerOffset),_p.maxOffset,cc.defineGetterSetter(_p,"maxOffset",_p.maxContainerOffset),_p.bounceable,cc.defineGetterSetter(_p,"bounceable",_p.isBounceable,_p.setBounceable),_p.viewSize,cc.defineGetterSetter(_p,"viewSize",_p.getViewSize,_p.setViewSize),_p.container,cc.defineGetterSetter(_p,"container",_p.getContainer,_p.setContainer),_p.direction,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.clippingToBounds,cc.defineGetterSetter(_p,"clippingToBounds",_p.isClippingToBounds,_p.setClippingToBounds),_p=null,cc.ScrollView.create=function(e,t){return new cc.ScrollView(e,t)},function(){cc.ScrollView.CanvasRenderCmd=function(e){cc.Layer.CanvasRenderCmd.call(this,e),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.endCmd=new cc.CustomRenderCmd(this,this._endCmd)};var e=cc.ScrollView.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);e.constructor=cc.ScrollView.CanvasRenderCmd,e._startCmd=function(e,t,i){var n=this._node,r=e||cc._renderContext,o=r.getContext();if(r.save(),n._clippingToBounds){this._scissorRestored=!1,r.setTransform(this._worldTransform,t,i);var s=n.getScaleX(),a=n.getScaleY(),c=n._viewSize.width*s*t,l=n._viewSize.height*a*i;o.beginPath(),o.rect(0,0,c,-l),o.closePath(),o.clip()}},e._endCmd=function(e){(e=e||cc._renderContext).restore()},e.visit=function(e){var t,i,n=this._node,r=n._children;if(this.transform(e),cc.renderer.pushRenderCommand(this.startCmd),r&&r.length>0)for(i=r.length,n.sortAllChildren(),t=0;t<i;t++)r[t]._renderCmd.visit(this);cc.renderer.pushRenderCommand(this.endCmd)}}(),function(){cc.ScrollView.WebGLRenderCmd=function(e){cc.Layer.WebGLRenderCmd.call(this,e),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.endCmd=new cc.CustomRenderCmd(this,this._endCmd)};var e=cc.ScrollView.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);e.constructor=cc.ScrollView.WebGLRenderCmd,e._startCmd=function(){var e=this._node,t=cc.view,i=e._getViewRect();if(t.isScissorEnabled()){if(e._scissorRestored=!0,e._parentScissorRect=t.getScissorRect(),cc.rectIntersection(i,e._parentScissorRect)){var n=e._parentScissorRect,r=Math.max(i.x,n.x),o=Math.max(i.y,n.y),s=Math.min(i.x+i.width,n.x+n.width),a=Math.min(i.y+i.height,n.y+n.height);t.setScissorInPoints(r,o,s-r,a-o)}}else{var c=cc._renderContext;c.enable(c.SCISSOR_TEST),t.setScissorInPoints(i.x,i.y,i.width,i.height)}},e._endCmd=function(){var e=this._node;if(e._scissorRestored){var t=e._parentScissorRect;cc.view.setScissorInPoints(t.x,t.y,t.width,t.height)}else{var i=cc._renderContext;i.disable(i.SCISSOR_TEST)}},e.visit=function(e){var t,i,n,r=this._node,o=r._children;if(cc.kmGLPushMatrix(),this.transform(e),r._clippingToBounds&&cc.renderer.pushRenderCommand(this.startCmd),o&&o.length>0){for(n=o.length,t=0;t<n&&((i=o[t])&&i._localZOrder<0);t++)i._renderCmd.visit();for(;t<n;t++)o[t]._renderCmd.visit()}r._clippingToBounds&&cc.renderer.pushRenderCommand(this.endCmd),this._dirtyFlag=0,cc.kmGLPopMatrix()}}(),cc.SortableObject=cc.Class.extend({setObjectID:function(e){},getObjectID:function(){return 0}}),cc.SortedObject=cc.SortableObject.extend({_objectID:0,ctor:function(){this._objectID=0},setObjectID:function(e){this._objectID=e},getObjectID:function(){return this._objectID}});var _compareObject=function(e,t){return e.getObjectID()-t.getObjectID()};cc.ArrayForObjectSorting=cc.Class.extend({_saveObjectArr:null,ctor:function(){this._saveObjectArr=[]},insertSortedObject:function(e){if(!e)throw"cc.ArrayForObjectSorting.insertSortedObject(): addObject should be non-null.";var t=this.indexOfSortedObject(e);this.insertObject(e,t)},removeSortedObject:function(e){if(0!=this.count()){var t=this.indexOfSortedObject(e);t<this.count()&&t!=cc.INVALID_INDEX&&this.objectAtIndex(t).getObjectID()==e.getObjectID()&&this.removeObjectAtIndex(t)}},setObjectID_ofSortedObject:function(e,t){var i=this.indexOfSortedObject(t);if(i<this.count()&&i!=cc.INVALID_INDEX){var n=this.objectAtIndex(i);n.getObjectID()==t.getObjectID()&&(this.removeObjectAtIndex(i),n.setObjectID(e),this.insertSortedObject(n))}},objectWithObjectID:function(e){if(0==this.count())return null;var t=new cc.SortedObject;t.setObjectID(e);var i=this.indexOfSortedObject(t);return i<this.count()&&i!=cc.INVALID_INDEX&&(t=this.objectAtIndex(i)).getObjectID()!=e&&(t=null),t},getObjectWithObjectID:function(e){return null},indexOfSortedObject:function(e){var t=0;if(e)for(var i=0,n=e.getObjectID(),r=this._saveObjectArr,o=0;o<r.length;o++){var s=r[o].getObjectID();if(n==s||n>=i&&n<s)break;i=s,t++}else t=cc.INVALID_INDEX;return t},count:function(){return this._saveObjectArr.length},lastObject:function(){var e=this._saveObjectArr;return 0==e.length?null:e[e.length-1]},objectAtIndex:function(e){return this._saveObjectArr[e]},addObject:function(e){this._saveObjectArr.push(e),this._saveObjectArr.sort(_compareObject)},removeObjectAtIndex:function(e){this._saveObjectArr.splice(e,1),this._saveObjectArr.sort(_compareObject)},insertObject:function(e,t){this._saveObjectArr.splice(t,0,e),this._saveObjectArr.sort(_compareObject)}}),cc.TABLEVIEW_FILL_TOPDOWN=0,cc.TABLEVIEW_FILL_BOTTOMUP=1,cc.TableViewCell=cc.Node.extend({_idx:0,_className:"TableViewCell",getIdx:function(){return this._idx},setIdx:function(e){this._idx=e},reset:function(){this._idx=cc.INVALID_INDEX},setObjectID:function(e){this._idx=e},getObjectID:function(){return this._idx}}),(_p=cc.TableViewCell.prototype).objectId,cc.defineGetterSetter(_p,"objectId",_p.getObjectID,_p.setObjectID),_p=null,cc.TableViewDelegate=cc.ScrollViewDelegate.extend({tableCellTouched:function(e,t){},tableCellHighlight:function(e,t){},tableCellUnhighlight:function(e,t){},tableCellWillRecycle:function(e,t){}}),cc.TableViewDataSource=cc.Class.extend({tableCellSizeForIndex:function(e,t){return this.cellSizeForTable(e)},cellSizeForTable:function(e){return cc.size(0,0)},tableCellAtIndex:function(e,t){return null},numberOfCellsInTableView:function(e){return 0}}),cc.TableView=cc.ScrollView.extend({_vOrdering:null,_indices:null,_cellsFreed:null,_dataSource:null,_tableViewDelegate:null,_oldDirection:null,_cellsPositions:null,_touchedCell:null,ctor:function(e,t,i){cc.ScrollView.prototype.ctor.call(this),this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE,this._cellsPositions=[],this.initWithViewSize(t,i),this.setDataSource(e),this._updateCellPositions(),this._updateContentSize()},__indexFromOffset:function(e){var t,i=0,n=this._dataSource.numberOfCellsInTableView(this)-1;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:t=e.x;break;default:t=e.y}for(var r=this._cellsPositions;n>=i;){var o=0|i+(n-i)/2,s=r[o],a=r[o+1];if(t>=s&&t<=a)return o;t<s?n=o-1:i=o+1}return i<=0?0:-1},_indexFromOffset:function(e){var t={x:e.x,y:e.y},i=this._dataSource.numberOfCellsInTableView(this)-1;this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(t.y=this.getContainer().getContentSize().height-t.y);var n=this.__indexFromOffset(t);return-1!=n&&(n=Math.max(0,n))>i&&(n=cc.INVALID_INDEX),n},__offsetFromIndex:function(e){var t;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:t=cc.p(this._cellsPositions[e],0);break;default:t=cc.p(0,this._cellsPositions[e])}return t},_offsetFromIndex:function(e){var t=this.__offsetFromIndex(e),i=this._dataSource.tableCellSizeForIndex(this,e);return this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(t.y=this.getContainer().getContentSize().height-t.y-i.height),t},_updateCellPositions:function(){var e=this._dataSource.numberOfCellsInTableView(this),t=this._cellsPositions;if(e>0){for(var i,n=0,r=this._dataSource,o=0;o<e;o++)switch(t[o]=n,i=r.tableCellSizeForIndex(this,o),this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:n+=i.width;break;default:n+=i.height}this._cellsPositions[e]=n}},_updateContentSize:function(){var e=cc.size(0,0),t=this._dataSource.numberOfCellsInTableView(this);if(t>0){var i=this._cellsPositions[t];switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:e=cc.size(i,this._viewSize.height);break;default:e=cc.size(this._viewSize.width,i)}}this.setContentSize(e),this._oldDirection!=this._direction&&(this._direction==cc.SCROLLVIEW_DIRECTION_HORIZONTAL?this.setContentOffset(cc.p(0,0)):this.setContentOffset(cc.p(0,this.minContainerOffset().y)),this._oldDirection=this._direction)},_moveCellOutOfSight:function(e){this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,e),this._cellsFreed.addObject(e),this._cellsUsed.removeSortedObject(e),cc.arrayRemoveObject(this._indices,e.getIdx()),e.reset(),e.getParent()==this.getContainer()&&this.getContainer().removeChild(e,!0)},_setIndexForCell:function(e,t){t.setAnchorPoint(0,0),t.setPosition(this._offsetFromIndex(e)),t.setIdx(e)},_addCellIfNecessary:function(e){e.getParent()!=this.getContainer()&&this.getContainer().addChild(e),this._cellsUsed.insertSortedObject(e);var t=this._indices,i=e.getIdx();-1==t.indexOf(i)&&(t.push(i),t.sort(function(e,t){return e-t}))},getDataSource:function(){return this._dataSource},setDataSource:function(e){this._dataSource=e},getDelegate:function(){return this._tableViewDelegate},setDelegate:function(e){this._tableViewDelegate=e},setVerticalFillOrder:function(e){this._vOrdering!=e&&(this._vOrdering=e,this._cellsUsed.count()>0&&this.reloadData())},getVerticalFillOrder:function(){return this._vOrdering},initWithViewSize:function(e,t){return!!cc.ScrollView.prototype.initWithViewSize.call(this,e,t)&&(this._cellsUsed=new cc.ArrayForObjectSorting,this._cellsFreed=new cc.ArrayForObjectSorting,this._indices=[],this._tableViewDelegate=null,this._vOrdering=cc.TABLEVIEW_FILL_BOTTOMUP,this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),cc.ScrollView.prototype.setDelegate.call(this,this),!0)},updateCellAtIndex:function(e){if(!(e==cc.INVALID_INDEX||e>this._dataSource.numberOfCellsInTableView(this)-1)){var t=this.cellAtIndex(e);t&&this._moveCellOutOfSight(t),t=this._dataSource.tableCellAtIndex(this,e),this._setIndexForCell(e,t),this._addCellIfNecessary(t)}},insertCellAtIndex:function(e){if(!(e==cc.INVALID_INDEX||e>this._dataSource.numberOfCellsInTableView(this)-1)){var t,i=this._cellsUsed,n=i.objectWithObjectID(e);if(n)for(var r=t=i.indexOfSortedObject(n);r<i.count();r++)n=i.objectAtIndex(r),this._setIndexForCell(n.getIdx()+1,n);n=this._dataSource.tableCellAtIndex(this,e),this._setIndexForCell(e,n),this._addCellIfNecessary(n),this._updateCellPositions(),this._updateContentSize()}},removeCellAtIndex:function(e){if(!(e==cc.INVALID_INDEX||e>this._dataSource.numberOfCellsInTableView(this)-1)){var t=this.cellAtIndex(e);if(t){var i=this._cellsUsed,n=i.indexOfSortedObject(t);this._moveCellOutOfSight(t),cc.arrayRemoveObject(this._indices,e),this._updateCellPositions();for(var r=i.count()-1;r>n;r--)t=i.objectAtIndex(r),this._setIndexForCell(t.getIdx()-1,t)}}},reloadData:function(){this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE;for(var e=this._cellsUsed,t=this._cellsFreed,i=this.getContainer(),n=0,r=e.count();n<r;n++){var o=e.objectAtIndex(n);this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,o),t.addObject(o),o.reset(),o.getParent()==i&&i.removeChild(o,!0)}this._indices=[],this._cellsUsed=new cc.ArrayForObjectSorting,this._updateCellPositions(),this._updateContentSize(),this._dataSource.numberOfCellsInTableView(this)>0&&this.scrollViewDidScroll(this)},dequeueCell:function(){if(0===this._cellsFreed.count())return null;var e=this._cellsFreed.objectAtIndex(0);return this._cellsFreed.removeObjectAtIndex(0),e},cellAtIndex:function(e){return-1==this._indices.indexOf(e)?null:this._cellsUsed.objectWithObjectID(e)},scrollViewDidScroll:function(e){var t=this._dataSource.numberOfCellsInTableView(this);if(0!==t){null!=this._tableViewDelegate&&this._tableViewDelegate.scrollViewDidScroll&&this._tableViewDelegate.scrollViewDidScroll(this);var i=0,n=this._viewSize,r=this.getContainer(),o=this.getContentOffset();o.x*=-1,o.y*=-1;var s=Math.max(t-1,0);this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(o.y=o.y+n.height/r.getScaleY());var a=this._indexFromOffset(o);a===cc.INVALID_INDEX&&(a=t-1),this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN?o.y-=n.height/r.getScaleY():o.y+=n.height/r.getScaleY(),o.x+=n.width/r.getScaleX();var c=this._indexFromOffset(o);c===cc.INVALID_INDEX&&(c=t-1);var l,u=this._cellsUsed;if(u.count()>0)for(i=(l=u.objectAtIndex(0)).getIdx();i<a&&(this._moveCellOutOfSight(l),u.count()>0);)i=(l=u.objectAtIndex(0)).getIdx();if(u.count()>0)for(i=(l=u.lastObject()).getIdx();i<=s&&i>c&&(this._moveCellOutOfSight(l),u.count()>0);)i=(l=u.lastObject()).getIdx();for(var h=this._indices,d=a;d<=c;d++)-1==h.indexOf(d)&&this.updateCellAtIndex(d)}},scrollViewDidZoom:function(e){},onTouchEnded:function(e,t){if(this.isVisible()){if(this._touchedCell){var i=this.getBoundingBox(),n=cc.p(i.x,i.y);n=this._parent.convertToWorldSpace(n),i.x=n.x,i.y=n.y;var r=this._tableViewDelegate;cc.rectContainsPoint(i,e.getLocation())&&null!=r&&(r.tableCellUnhighlight&&r.tableCellUnhighlight(this,this._touchedCell),r.tableCellTouched&&r.tableCellTouched(this,this._touchedCell)),this._touchedCell=null}cc.ScrollView.prototype.onTouchEnded.call(this,e,t)}},onTouchBegan:function(e,t){if(!this.isVisible())return!1;var i=cc.ScrollView.prototype.onTouchBegan.call(this,e,t);if(1===this._touches.length){var n,r;r=this.getContainer().convertTouchToNodeSpace(e),(n=this._indexFromOffset(r))===cc.INVALID_INDEX?this._touchedCell=null:this._touchedCell=this.cellAtIndex(n),this._touchedCell&&null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellHighlight&&this._tableViewDelegate.tableCellHighlight(this,this._touchedCell)}else this._touchedCell&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null);return i},onTouchMoved:function(e,t){cc.ScrollView.prototype.onTouchMoved.call(this,e,t),this._touchedCell&&this.isTouchMoved()&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)},onTouchCancelled:function(e,t){cc.ScrollView.prototype.onTouchCancelled.call(this,e,t),this._touchedCell&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)}}),(_p=cc.TableView.prototype).dataSource,cc.defineGetterSetter(_p,"dataSource",_p.getDataSource,_p.setDataSource),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.verticalFillOrder,cc.defineGetterSetter(_p,"verticalFillOrder",_p.getVerticalFillOrder,_p.setVerticalFillOrder),_p=null,cc.TableView.create=function(e,t,i){return new cc.TableView(e,t,i)};var PROPERTY_POSITION="position",PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SKEW="skew",PROPERTY_ANCHORPOINT="anchorPoint",PROPERTY_SCALE="scale",PROPERTY_ROTATION="rotation",PROPERTY_TAG="tag",PROPERTY_IGNOREANCHORPOINTFORPOSITION="ignoreAnchorPointForPosition",PROPERTY_VISIBLE="visible",ASSERT_FAIL_UNEXPECTED_PROPERTY=function(e){cc.log("Unexpected property: '"+e+"'!")},ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE=function(e){cc.log("Unexpected property type: '"+e+"'!")};cc.NodeLoader=cc.Class.extend({_customProperties:null,ctor:function(){this._customProperties=new cc._Dictionary},loadCCNode:function(e,t){return this._createCCNode(e,t)},parseProperties:function(e,t,i){for(var n=i.readInt(!1),r=n+i.readInt(!1),o=0;o<r;o++){var s=o>=n,a=i.readInt(!1),c=i.readCachedString(),l=!1,u=i.readByte();if(u!==CCB_PLATFORM_ALL&&u!==CCB_PLATFORM_IOS&&u!==CCB_PLATFORM_MAC||(l=!0),e instanceof cc.BuilderFile)e.getCCBFileNode()&&s&&(l=-1!=(e=e.getCCBFileNode()).userObject.indexOf(c));else if(s&&e==i.getAnimationManager().getRootNode()){var h=e.userObject;h||(h=[],e.userObject=h),h.push(c)}switch(a){case CCB_PROPTYPE_POSITION:var d=this.parsePropTypePosition(e,t,i,c);l&&this.onHandlePropTypePosition(e,t,c,d,i);break;case CCB_PROPTYPE_POINT:var p=this.parsePropTypePoint(e,t,i);l&&this.onHandlePropTypePoint(e,t,c,p,i);break;case CCB_PROPTYPE_POINTLOCK:var _=this.parsePropTypePointLock(e,t,i);l&&this.onHandlePropTypePointLock(e,t,c,_,i);break;case CCB_PROPTYPE_SIZE:var f=this.parsePropTypeSize(e,t,i);l&&this.onHandlePropTypeSize(e,t,c,f,i);break;case CCB_PROPTYPE_SCALELOCK:var m=this.parsePropTypeScaleLock(e,t,i,c);l&&this.onHandlePropTypeScaleLock(e,t,c,m,i);break;case CCB_PROPTYPE_FLOATXY:var g=this.parsePropTypeFloatXY(e,t,i);l&&this.onHandlePropTypeFloatXY(e,t,c,g,i);break;case CCB_PROPTYPE_FLOAT:var y=this.parsePropTypeFloat(e,t,i);l&&this.onHandlePropTypeFloat(e,t,c,y,i);break;case CCB_PROPTYPE_DEGREES:var T=this.parsePropTypeDegrees(e,t,i,c);l&&this.onHandlePropTypeDegrees(e,t,c,T,i);break;case CCB_PROPTYPE_FLOATSCALE:var v=this.parsePropTypeFloatScale(e,t,i);l&&this.onHandlePropTypeFloatScale(e,t,c,v,i);break;case CCB_PROPTYPE_INTEGER:var S=this.parsePropTypeInteger(e,t,i);l&&this.onHandlePropTypeInteger(e,t,c,S,i);break;case CCB_PROPTYPE_INTEGERLABELED:var C=this.parsePropTypeIntegerLabeled(e,t,i);l&&this.onHandlePropTypeIntegerLabeled(e,t,c,C,i);break;case CCB_PROPTYPE_FLOATVAR:var E=this.parsePropTypeFloatVar(e,t,i);l&&this.onHandlePropTypeFloatVar(e,t,c,E,i);break;case CCB_PROPTYPE_CHECK:var b=this.parsePropTypeCheck(e,t,i,c);l&&this.onHandlePropTypeCheck(e,t,c,b,i);break;case CCB_PROPTYPE_SPRITEFRAME:var A=this.parsePropTypeSpriteFrame(e,t,i,c);l&&this.onHandlePropTypeSpriteFrame(e,t,c,A,i);break;case CCB_PROPTYPE_ANIMATION:var x=this.parsePropTypeAnimation(e,t,i);l&&this.onHandlePropTypeAnimation(e,t,c,x,i);break;case CCB_PROPTYPE_TEXTURE:var R=this.parsePropTypeTexture(e,t,i);l&&this.onHandlePropTypeTexture(e,t,c,R,i);break;case CCB_PROPTYPE_BYTE:var P=this.parsePropTypeByte(e,t,i,c);l&&this.onHandlePropTypeByte(e,t,c,P,i);break;case CCB_PROPTYPE_COLOR3:var I=this.parsePropTypeColor3(e,t,i,c);l&&this.onHandlePropTypeColor3(e,t,c,I,i);break;case CCB_PROPTYPE_COLOR4VAR:var w=this.parsePropTypeColor4FVar(e,t,i);l&&this.onHandlePropTypeColor4FVar(e,t,c,w,i);break;case CCB_PROPTYPE_FLIP:var N=this.parsePropTypeFlip(e,t,i);l&&this.onHandlePropTypeFlip(e,t,c,N,i);break;case CCB_PROPTYPE_BLENDMODE:var L=this.parsePropTypeBlendFunc(e,t,i);l&&this.onHandlePropTypeBlendFunc(e,t,c,L,i);break;case CCB_PROPTYPE_FNTFILE:var O=i.getCCBRootPath()+this.parsePropTypeFntFile(e,t,i);l&&this.onHandlePropTypeFntFile(e,t,c,O,i);break;case CCB_PROPTYPE_FONTTTF:var D=this.parsePropTypeFontTTF(e,t,i);l&&this.onHandlePropTypeFontTTF(e,t,c,D,i);break;case CCB_PROPTYPE_STRING:var F=this.parsePropTypeString(e,t,i);l&&this.onHandlePropTypeString(e,t,c,F,i);break;case CCB_PROPTYPE_TEXT:var B=this.parsePropTypeText(e,t,i);l&&this.onHandlePropTypeText(e,t,c,B,i);break;case CCB_PROPTYPE_BLOCK:var M=this.parsePropTypeBlock(e,t,i);l&&this.onHandlePropTypeBlock(e,t,c,M,i);break;case CCB_PROPTYPE_BLOCKCCCONTROL:var k=this.parsePropTypeBlockCCControl(e,t,i);l&&null!=k&&this.onHandlePropTypeBlockCCControl(e,t,c,k,i);break;case CCB_PROPTYPE_CCBFILE:var W=this.parsePropTypeCCBFile(e,t,i);l&&this.onHandlePropTypeCCBFile(e,t,c,W,i);break;default:ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE(a)}}},getCustomProperties:function(){return this._customProperties},_createCCNode:function(e,t){return new cc.Node},parsePropTypePosition:function(e,t,i,n){var r=i.readFloat(),o=i.readFloat(),s=i.readInt(!1),a=i.getAnimationManager().getContainerSize(t),c=cc._getAbsolutePosition(r,o,s,a,n);if(e.setPosition(cc.getAbsolutePosition(c,s,a,n)),i.getAnimatedProperties().indexOf(n)>-1){var l=[r,o,s];i.getAnimationManager().setBaseValue(l,e,n)}return c},parsePropTypePoint:function(e,t,i){var n=i.readFloat(),r=i.readFloat();return cc.p(n,r)},parsePropTypePointLock:function(e,t,i){var n=i.readFloat(),r=i.readFloat();return cc.p(n,r)},parsePropTypeSize:function(e,t,i){var n=i.readFloat(),r=i.readFloat(),o=i.readInt(!1),s=i.getAnimationManager().getContainerSize(t);switch(o){case CCB_SIZETYPE_ABSOLUTE:break;case CCB_SIZETYPE_RELATIVE_CONTAINER:n=s.width-n,r=s.height-r;break;case CCB_SIZETYPE_PERCENT:n=s.width*n/100,r=s.height*r/100;break;case CCB_SIZETYPE_HORIZONTAL_PERCENT:n=s.width*n/100;break;case CCB_SIZETYPE_VERTICAL_PERCENT:r=s.height*r/100;break;case CCB_SIZETYPE_MULTIPLY_RESOLUTION:var a=cc.BuilderReader.getResolutionScale();n*=a,r*=a;break;default:cc.log("Unknown CCB type.")}return cc.size(n,r)},parsePropTypeScaleLock:function(e,t,i,n){var r=i.readFloat(),o=i.readFloat(),s=i.readInt(!1);return cc.setRelativeScale(e,r,o,s,n),i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue([r,o,s],e,n),s==CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(r*=cc.BuilderReader.getResolutionScale(),o*=cc.BuilderReader.getResolutionScale()),[r,o]},parsePropTypeFloat:function(e,t,i){return i.readFloat()},parsePropTypeDegrees:function(e,t,i,n){var r=i.readFloat();return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,e,n),r},parsePropTypeFloatScale:function(e,t,i){var n=i.readFloat();return i.readInt(!1)==CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(n*=cc.BuilderReader.getResolutionScale()),n},parsePropTypeInteger:function(e,t,i){return i.readInt(!0)},parsePropTypeIntegerLabeled:function(e,t,i){return i.readInt(!0)},parsePropTypeFloatVar:function(e,t,i){return[i.readFloat(),i.readFloat()]},parsePropTypeCheck:function(e,t,i,n){var r=i.readBool();return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,e,n),r},parsePropTypeSpriteFrame:function(e,t,i,n){var r,o=i.readCachedString(),s=i.readCachedString();if(null!=s&&0!=s.length){if(0==o.length){s=i.getCCBRootPath()+s;var a=cc.textureCache.addImage(s),c=a.getContentSize(),l=cc.rect(0,0,c.width,c.height);r=new cc.SpriteFrame(a,l)}else{var u=cc.spriteFrameCache;o=i.getCCBRootPath()+o,-1==i.getLoadedSpriteSheet().indexOf(o)&&(u.addSpriteFrames(o),i.getLoadedSpriteSheet().push(o)),r=u.getSpriteFrame(s)}i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,e,n)}return r},parsePropTypeAnimation:function(e,t,i){var n=i.getCCBRootPath()+i.readCachedString(),r=i.readCachedString(),o=null;if(r=cc.BuilderReader.lastPathComponent(r),n=cc.BuilderReader.lastPathComponent(n),null!=r&&""!=r){var s=cc.animationCache;s.addAnimations(n),o=s.getAnimation(r)}return o},parsePropTypeTexture:function(e,t,i){var n=i.getCCBRootPath()+i.readCachedString();return""!=n?cc.textureCache.addImage(n):null},parsePropTypeByte:function(e,t,i,n){var r=i.readByte();return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,e,n),r},parsePropTypeColor3:function(e,t,i,n){var r={r:i.readByte(),g:i.readByte(),b:i.readByte()};return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(cc.Color3BWapper.create(r),e,n),r},parsePropTypeColor4FVar:function(e,t,i){var n=0|255*i.readFloat(),r=0|255*i.readFloat(),o=0|255*i.readFloat(),s=i.readFloat();s=s<=1?0|255*s:s;var a=0|255*i.readFloat(),c=0|255*i.readFloat(),l=0|255*i.readFloat(),u=i.readFloat();u=u<=1?0|255*u:u;var h=[];return h[0]={r:n,g:r,b:o,a:s},h[1]={r:a,g:c,b:l,a:u},h},parsePropTypeFlip:function(e,t,i){return[i.readBool(),i.readBool()]},parsePropTypeBlendFunc:function(e,t,i){var n=i.readInt(!1),r=i.readInt(!1);return new cc.BlendFunc(n,r)},parsePropTypeFntFile:function(e,t,i){return i.readCachedString()},parsePropTypeString:function(e,t,i){return i.readCachedString()},parsePropTypeText:function(e,t,i){return i.readCachedString()},parsePropTypeFontTTF:function(e,t,i){return i.readCachedString()},parsePropTypeBlock:function(e,t,i){var n=i.readCachedString(),r=i.readInt(!1);if(r!==CCB_TARGETTYPE_NONE){var o=null;if(i.isJSControlled())r===CCB_TARGETTYPE_DOCUMENTROOT?(i.addDocumentCallbackNode(e),i.addDocumentCallbackName(n),i.addDocumentCallbackControlEvents(0)):(i.addOwnerCallbackNode(e),i.addOwnerCallbackName(n),i.addOwnerCallbackControlEvents(0));else if(r===CCB_TARGETTYPE_DOCUMENTROOT?o=i.getAnimationManager().getRootNode():r===CCB_TARGETTYPE_OWNER&&(o=i.getOwner()),null!=o)if(n.length>0){var s=0;if(null!=o&&o.onResolveCCBCCMenuItemSelector&&(s=o.onResolveCCBCCMenuItemSelector(o,n)),0==s){var a=i.getCCBSelectorResolver();null!=a&&(s=a.onResolveCCBCCMenuItemSelector(o,n))}if(0!=s)return new BlockData(s,o);cc.log("Skipping selector '"+n+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}return null},parsePropTypeBlockCCControl:function(e,t,i){var n=i.readCachedString(),r=i.readInt(!1),o=i.readInt(!1);if(r!==CCB_TARGETTYPE_NONE)if(i.isJSControlled())r==CCB_TARGETTYPE_DOCUMENTROOT?(i.addDocumentCallbackNode(e),i.addDocumentCallbackName(n),i.addDocumentCallbackControlEvents(o)):(i.addOwnerCallbackNode(e),i.addOwnerCallbackName(n),i.addOwnerCallbackControlEvents(o));else{var s=null;if(r==CCB_TARGETTYPE_DOCUMENTROOT?s=i.getAnimationManager().getRootNode():r==CCB_TARGETTYPE_OWNER&&(s=i.getOwner()),null!=s)if(n.length>0){var a=0;if(null!=s&&s.onResolveCCBCCControlSelector&&(a=s.onResolveCCBCCControlSelector(s,n)),0==a){var c=i.getCCBSelectorResolver();null!=c&&(a=c.onResolveCCBCCControlSelector(s,n))}if(0!=a)return new BlockCCControlData(a,s,o);cc.log("Skipping selector '"+n+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}return null},parsePropTypeCCBFile:function(e,t,i){var n=i.getCCBRootPath()+i.readCachedString();n=cc.BuilderReader.deletePathExtension(n)+".ccbi";var r=new cc.BuilderReader(i),o=cc.loader.getRes(n);if(!o){var s=cc.loader.getUrl(n);o=cc.loader.loadBinarySync(s),cc.loader.cache[n]=o}r.initWithData(o,i.getOwner()),r.getAnimationManager().setRootContainerSize(t.getContentSize()),r.setAnimationManagers(i.getAnimationManagers()),r.getAnimationManager().setOwner(i.getOwner());var a=r.readFileWithCleanUp(!1);return i.setAnimationManagers(r.getAnimationManagers()),a&&-1!=r.getAnimationManager().getAutoPlaySequenceId()&&r.getAnimationManager().runAnimations(r.getAnimationManager().getAutoPlaySequenceId(),0),a},parsePropTypeFloatXY:function(e,t,i){return[i.readFloat(),i.readFloat()]},onHandlePropTypePosition:function(e,t,i,n,r){i===PROPERTY_POSITION?e.setPosition(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypePoint:function(e,t,i,n,r){i===PROPERTY_ANCHORPOINT?e.setAnchorPoint(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypePointLock:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeSize:function(e,t,i,n,r){i===PROPERTY_CONTENTSIZE?e.setContentSize(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeScaleLock:function(e,t,i,n,r){i===PROPERTY_SCALE?(e.setScaleX(n[0]),e.setScaleY(n[1])):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFloatXY:function(e,t,i,n,r){if(i===PROPERTY_SKEW)e.setSkewX(n[0]),e.setSkewY(n[1]);else{var o=i+"X",s=i+"Y";e[o]&&e[s]||ASSERT_FAIL_UNEXPECTED_PROPERTY(i),e[o](n[0]),e[s](n[1])}},onHandlePropTypeFloat:function(e,t,i,n,r){this._customProperties.setObject(n,i)},onHandlePropTypeDegrees:function(e,t,i,n,r){i===PROPERTY_ROTATION?e.setRotation(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFloatScale:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeInteger:function(e,t,i,n,r){i===PROPERTY_TAG?e.setTag(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeIntegerLabeled:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFloatVar:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeCheck:function(e,t,i,n,r){i===PROPERTY_VISIBLE?e.setVisible(n):i===PROPERTY_IGNOREANCHORPOINTFORPOSITION?e.ignoreAnchorPointForPosition(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeSpriteFrame:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeAnimation:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeTexture:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeByte:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeColor3:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeColor4FVar:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFlip:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFntFile:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeString:function(e,t,i,n,r){this._customProperties.setObject(n,i)},onHandlePropTypeText:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFontTTF:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeBlock:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeBlockCCControl:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeCCBFile:function(e,t,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)}}),cc.NodeLoader.loader=function(){return new cc.NodeLoader},cc.NodeLoaderListener=cc.Class.extend({onNodeLoaded:function(e,t){}}),cc.BuilderSelectorResolver=cc.Class.extend({onResolveCCBCCMenuItemSelector:function(e,t){},onResolveCCBCCCallFuncSelector:function(e,t){},onResolveCCBCCControlSelector:function(e,t){}}),cc.BuilderScriptOwnerProtocol=cc.Class.extend({createNew:function(){}}),cc.BuilderMemberVariableAssigner=cc.Class.extend({onAssignCCBMemberVariable:function(e,t,i){return!1},onAssignCCBCustomProperty:function(e,t,i){return!1}});var PROPERTY_CCBFILE="ccbFile";cc.BuilderFileLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.BuilderFile.create()},onHandlePropTypeCCBFile:function(e,t,i,n,r){i==PROPERTY_CCBFILE?e.setCCBFileNode(n):cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(this,e,t,i,n,r)}}),cc.BuilderFileLoader.loader=function(){return new cc.BuilderFileLoader};var PROPERTY_ENABLED="enabled",PROPERTY_SELECTED="selected",PROPERTY_CCCONTROL="ccControl";cc.ControlLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){},onHandlePropTypeBlockCCControl:function(e,t,i,n,r){i==PROPERTY_CCCONTROL?e.addTargetWithActionForControlEvents(n.target,n.selCCControlHandler,n.controlEvents):cc.NodeLoader.prototype.onHandlePropTypeBlockCCControl.call(this,e,t,i,n,r)},onHandlePropTypeCheck:function(e,t,i,n,r){i==PROPERTY_ENABLED?e.setEnabled(n):i==PROPERTY_SELECTED?e.setSelected(n):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,e,t,i,n,r)}});var PROPERTY_ZOOMONTOUCHDOWN="zoomOnTouchDown",PROPERTY_TITLE_NORMAL="title|1",PROPERTY_TITLE_HIGHLIGHTED="title|2",PROPERTY_TITLE_DISABLED="title|3",PROPERTY_TITLECOLOR_NORMAL="titleColor|1",PROPERTY_TITLECOLOR_HIGHLIGHTED="titleColor|2",PROPERTY_TITLECOLOR_DISABLED="titleColor|3",PROPERTY_TITLETTF_NORMAL="titleTTF|1",PROPERTY_TITLETTF_HIGHLIGHTED="titleTTF|2",PROPERTY_TITLETTF_DISABLED="titleTTF|3",PROPERTY_TITLETTFSIZE_NORMAL="titleTTFSize|1",PROPERTY_TITLETTFSIZE_HIGHLIGHTED="titleTTFSize|2",PROPERTY_TITLETTFSIZE_DISABLED="titleTTFSize|4",PROPERTY_LABELANCHORPOINT="labelAnchorPoint",PROPERTY_PREFEREDSIZE="preferedSize",PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL="backgroundSpriteFrame|1",PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED="backgroundSpriteFrame|2",PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED="backgroundSpriteFrame|3";cc.ControlButtonLoader=cc.ControlLoader.extend({_createCCNode:function(e,t){return new cc.ControlButton},onHandlePropTypeCheck:function(e,t,i,n,r){i==PROPERTY_ZOOMONTOUCHDOWN?e.setZoomOnTouchDown(n):cc.ControlLoader.prototype.onHandlePropTypeCheck.call(this,e,t,i,n,r)},onHandlePropTypeString:function(e,t,i,n,r){i==PROPERTY_TITLE_NORMAL?e.setTitleForState(n,cc.CONTROL_STATE_NORMAL):i==PROPERTY_TITLE_HIGHLIGHTED?e.setTitleForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i==PROPERTY_TITLE_DISABLED?e.setTitleForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeString.call(this,e,t,i,n,r)},onHandlePropTypeFontTTF:function(e,t,i,n,r){i==PROPERTY_TITLETTF_NORMAL?e.setTitleTTFForState(n,cc.CONTROL_STATE_NORMAL):i==PROPERTY_TITLETTF_HIGHLIGHTED?e.setTitleTTFForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i==PROPERTY_TITLETTF_DISABLED?e.setTitleTTFForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeFontTTF.call(this,e,t,i,n,r)},onHandlePropTypeFloatScale:function(e,t,i,n,r){i==PROPERTY_TITLETTFSIZE_NORMAL?e.setTitleTTFSizeForState(n,cc.CONTROL_STATE_NORMAL):i==PROPERTY_TITLETTFSIZE_HIGHLIGHTED?e.setTitleTTFSizeForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i==PROPERTY_TITLETTFSIZE_DISABLED?e.setTitleTTFSizeForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeFloatScale.call(this,e,t,i,n,r)},onHandlePropTypePoint:function(e,t,i,n,r){i==PROPERTY_LABELANCHORPOINT?e.setLabelAnchorPoint(n):cc.ControlLoader.prototype.onHandlePropTypePoint.call(this,e,t,i,n,r)},onHandlePropTypeSize:function(e,t,i,n,r){i==PROPERTY_PREFEREDSIZE?e.setPreferredSize(n):cc.ControlLoader.prototype.onHandlePropTypeSize.call(this,e,t,i,n,r)},onHandlePropTypeSpriteFrame:function(e,t,i,n,r){i==PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL?null!=n&&e.setBackgroundSpriteFrameForState(n,cc.CONTROL_STATE_NORMAL):i==PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED?null!=n&&e.setBackgroundSpriteFrameForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i==PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED?null!=n&&e.setBackgroundSpriteFrameForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeSpriteFrame.call(this,e,t,i,n,r)},onHandlePropTypeColor3:function(e,t,i,n,r){i==PROPERTY_TITLECOLOR_NORMAL?e.setTitleColorForState(n,cc.CONTROL_STATE_NORMAL):i==PROPERTY_TITLECOLOR_HIGHLIGHTED?e.setTitleColorForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i==PROPERTY_TITLECOLOR_DISABLED?e.setTitleColorForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeColor3.call(this,e,t,i,n,r)}}),cc.ControlButtonLoader.loader=function(){return new cc.ControlButtonLoader};var PROPERTY_CONTAINER="container",PROPERTY_DIRECTION="direction",PROPERTY_CLIPSTOBOUNDS="clipsToBounds",PROPERTY_BOUNCES="bounces",PROPERTY_SCALE="scale";cc.ScrollViewLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return new cc.ScrollView},onHandlePropTypeSize:function(e,t,i,n,r){i==PROPERTY_CONTENTSIZE?e.setViewSize(n):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,e,t,i,n,r)},onHandlePropTypeCCBFile:function(e,t,i,n,r){i==PROPERTY_CONTAINER?(e.setContainer(n),e.updateInset()):cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(this,e,t,i,n,r)},onHandlePropTypeCheck:function(e,t,i,n,r){i==PROPERTY_CLIPSTOBOUNDS?e.setClippingToBounds(n):i==PROPERTY_BOUNCES?e.setBounceable(n):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,e,t,i,n,r)},onHandlePropTypeFloat:function(e,t,i,n,r){i==PROPERTY_SCALE?e.setScale(n):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,e,t,i,n,r)},onHandlePropTypeIntegerLabeled:function(e,t,i,n,r){i==PROPERTY_DIRECTION?e.setDirection(n):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,e,t,i,n,r)}}),cc.ScrollViewLoader.loader=function(){return new cc.ScrollViewLoader};var PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SPRITEFRAME="spriteFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc",PROPERTY_INSETLEFT="insetLeft",PROPERTY_INSETTOP="insetTop",PROPERTY_INSETRIGHT="insetRight",PROPERTY_INSETBOTTOM="insetBottom";cc.Scale9SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){var i=new cc.Scale9Sprite;return i.setAnchorPoint(0,0),i},onHandlePropTypeColor3:function(e,t,i,n,r){i==PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||e.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,e,t,i,n,r)},onHandlePropTypeByte:function(e,t,i,n,r){i==PROPERTY_OPACITY?e.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,e,t,i,n,r)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){i==PROPERTY_BLENDFUNC||cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,e,t,i,n,r)},onHandlePropTypeSpriteFrame:function(e,t,i,n,r){i==PROPERTY_SPRITEFRAME?e.setSpriteFrame(n):cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(this,e,t,i,n,r)},onHandlePropTypeSize:function(e,t,i,n,r){i==PROPERTY_CONTENTSIZE||(i==PROPERTY_PREFEREDSIZE?e.setPreferredSize(n):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,e,t,i,n,r))},onHandlePropTypeFloat:function(e,t,i,n,r){i==PROPERTY_INSETLEFT?e.setInsetLeft(n):i==PROPERTY_INSETTOP?e.setInsetTop(n):i==PROPERTY_INSETRIGHT?e.setInsetRight(n):i==PROPERTY_INSETBOTTOM?e.setInsetBottom(n):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,e,t,i,n,r)}}),cc.Scale9SpriteLoader.loader=function(){return new cc.Scale9SpriteLoader};var PROPERTY_FLIP="flip",PROPERTY_DISPLAYFRAME="displayFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc";cc.SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return new cc.Sprite},onHandlePropTypeColor3:function(e,t,i,n,r){i===PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||e.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,e,t,i,n,r)},onHandlePropTypeByte:function(e,t,i,n,r){i===PROPERTY_OPACITY?e.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,e,t,i,n,r)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){i===PROPERTY_BLENDFUNC?e.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,e,t,i,n,r)},onHandlePropTypeSpriteFrame:function(e,t,i,n,r){i===PROPERTY_DISPLAYFRAME?n?e.setSpriteFrame(n):cc.log("ERROR: SpriteFrame is null"):cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(this,e,t,i,n,r)},onHandlePropTypeFlip:function(e,t,i,n,r){i===PROPERTY_FLIP?(e.setFlippedX(n[0]),e.setFlippedY(n[1])):cc.NodeLoader.prototype.onHandlePropTypeFlip.call(this,e,t,i,n,r)}}),cc.SpriteLoader.loader=function(){return new cc.SpriteLoader};var PROPERTY_TOUCH_ENABLED="touchEnabled",PROPERTY_IS_TOUCH_ENABLED="isTouchEnabled",PROPERTY_ACCELEROMETER_ENABLED="accelerometerEnabled",PROPERTY_IS_ACCELEROMETER_ENABLED="isAccelerometerEnabled",PROPERTY_IS_MOUSE_ENABLED="isMouseEnabled",PROPERTY_MOUSE_ENABLED="mouseEnabled",PROPERTY_KEYBOARD_ENABLED="keyboardEnabled",PROPERTY_IS_KEYBOARD_ENABLED="isKeyboardEnabled";cc.LayerLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){var i=new cc.Layer;return i.setContentSize(0,0),i},onHandlePropTypeCheck:function(e,t,i,n,r){i===PROPERTY_TOUCH_ENABLED||i===PROPERTY_IS_TOUCH_ENABLED||i===PROPERTY_ACCELEROMETER_ENABLED||i===PROPERTY_IS_ACCELEROMETER_ENABLED||i===PROPERTY_MOUSE_ENABLED||i===PROPERTY_IS_MOUSE_ENABLED||(i===PROPERTY_KEYBOARD_ENABLED||i===PROPERTY_IS_KEYBOARD_ENABLED?e.setKeyboardEnabled&&!cc.sys.isNative?e.setKeyboardEnabled(n):cc.log("The property '"+PROPERTY_IS_KEYBOARD_ENABLED+"' is not supported!"):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,e,t,i,n,r))}}),cc.LayerLoader.loader=function(){return new cc.LayerLoader},cc.LayerColorLoader=cc.LayerLoader.extend({_createCCNode:function(e,t){return new cc.LayerColor},onHandlePropTypeColor3:function(e,t,i,n,r){i===PROPERTY_COLOR?e.setColor(n):cc.LayerLoader.prototype.onHandlePropTypeColor3.call(this,e,t,i,n,r)},onHandlePropTypeByte:function(e,t,i,n,r){i===PROPERTY_OPACITY?e.setOpacity(n):cc.LayerLoader.prototype.onHandlePropTypeByte.call(this,e,t,i,n,r)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){i===PROPERTY_BLENDFUNC?e.setBlendFunc(n):cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(this,e,t,i,n,r)}}),cc.LayerColorLoader.loader=function(){return new cc.LayerColorLoader};var PROPERTY_STARTCOLOR="startColor",PROPERTY_ENDCOLOR="endColor",PROPERTY_STARTOPACITY="startOpacity",PROPERTY_ENDOPACITY="endOpacity",PROPERTY_VECTOR="vector";cc.LayerGradientLoader=cc.LayerLoader.extend({_createCCNode:function(e,t){return new cc.LayerGradient},onHandlePropTypeColor3:function(e,t,i,n,r){i===PROPERTY_STARTCOLOR?e.setStartColor(n):i==PROPERTY_ENDCOLOR?e.setEndColor(n):cc.LayerLoader.prototype.onHandlePropTypeColor3.call(this,e,t,i,n,r)},onHandlePropTypeByte:function(e,t,i,n,r){i===PROPERTY_STARTOPACITY?e.setStartOpacity(n):i===PROPERTY_ENDOPACITY?e.setEndOpacity(n):cc.LayerLoader.prototype.onHandlePropTypeByte.call(this,e,t,i,n,r)},onHandlePropTypePoint:function(e,t,i,n,r){i===PROPERTY_VECTOR?e.setVector(n):cc.LayerLoader.prototype.onHandlePropTypePoint.call(this,e,t,i,n,r)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){i===PROPERTY_BLENDFUNC?e.setBlendFunc(n):cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(this,e,t,i,n,r)}}),cc.LayerGradientLoader.loader=function(){return new cc.LayerGradientLoader},cc.MenuLoader=cc.LayerLoader.extend({_createCCNode:function(e,t){var i=new cc.Menu;return i.setContentSize(0,0),i}}),cc.MenuLoader.loader=function(){return new cc.MenuLoader};var PROPERTY_BLOCK="block",PROPERTY_ISENABLED="isEnabled";cc.MenuItemLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return null},onHandlePropTypeBlock:function(e,t,i,n,r){i===PROPERTY_BLOCK?null!=n&&e.setTarget(n.selMenuHander,n.target):cc.NodeLoader.prototype.onHandlePropTypeBlock.call(this,e,t,i,n,r)},onHandlePropTypeCheck:function(e,t,i,n,r){i===PROPERTY_ISENABLED?e.setEnabled(n):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,e,t,i,n,r)}});var PROPERTY_NORMALDISPLAYFRAME="normalSpriteFrame",PROPERTY_SELECTEDDISPLAYFRAME="selectedSpriteFrame",PROPERTY_DISABLEDDISPLAYFRAME="disabledSpriteFrame";cc.MenuItemImageLoader=cc.MenuItemLoader.extend({_createCCNode:function(e,t){return new cc.MenuItemImage},onHandlePropTypeSpriteFrame:function(e,t,i,n,r){i===PROPERTY_NORMALDISPLAYFRAME?null!=n&&e.setNormalSpriteFrame(n):i===PROPERTY_SELECTEDDISPLAYFRAME?null!=n&&e.setSelectedSpriteFrame(n):i===PROPERTY_DISABLEDDISPLAYFRAME?null!=n&&e.setDisabledSpriteFrame(n):cc.MenuItemLoader.prototype.onHandlePropTypeSpriteFrame.call(this,e,t,i,n,r)}}),cc.MenuItemImageLoader.loader=function(){return new cc.MenuItemImageLoader};var PROPERTY_FONTNAME="fontName",PROPERTY_FONTSIZE="fontSize",PROPERTY_HORIZONTALALIGNMENT="horizontalAlignment",PROPERTY_VERTICALALIGNMENT="verticalAlignment",PROPERTY_STRING="string",PROPERTY_DIMENSIONS="dimensions";cc.LabelTTFLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return new cc.LabelTTF},onHandlePropTypeColor3:function(e,t,i,n,r){i===PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||e.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,e,t,i,n,r)},onHandlePropTypeByte:function(e,t,i,n,r){i===PROPERTY_OPACITY?e.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,e,t,i,n,r)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){i===PROPERTY_BLENDFUNC?e.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,e,t,i,n,r)},onHandlePropTypeFontTTF:function(e,t,i,n,r){i===PROPERTY_FONTNAME?e.setFontName(n):cc.NodeLoader.prototype.onHandlePropTypeFontTTF.call(this,e,t,i,n,r)},onHandlePropTypeText:function(e,t,i,n,r){i===PROPERTY_STRING?e.setString(n):cc.NodeLoader.prototype.onHandlePropTypeText.call(this,e,t,i,n,r)},onHandlePropTypeFloatScale:function(e,t,i,n,r){i===PROPERTY_FONTSIZE?e.setFontSize(n):cc.NodeLoader.prototype.onHandlePropTypeFloatScale.call(this,e,t,i,n,r)},onHandlePropTypeIntegerLabeled:function(e,t,i,n,r){i===PROPERTY_HORIZONTALALIGNMENT?e.setHorizontalAlignment(n):i===PROPERTY_VERTICALALIGNMENT?e.setVerticalAlignment(n):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,e,t,i,n,r)},onHandlePropTypeSize:function(e,t,i,n,r){i===PROPERTY_DIMENSIONS?e.setDimensions(n):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,e,t,i,n,r)}}),cc.LabelTTFLoader.loader=function(){return new cc.LabelTTFLoader};var PROPERTY_FNTFILE="fntFile";cc.LabelBMFontLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return new cc.LabelBMFont},onHandlePropTypeColor3:function(e,t,i,n,r){i===PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||e.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,e,t,i,n,r)},onHandlePropTypeByte:function(e,t,i,n,r){i===PROPERTY_OPACITY?e.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,e,t,i,n,r)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){i===PROPERTY_BLENDFUNC?e.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,e,t,i,n,r)},onHandlePropTypeFntFile:function(e,t,i,n,r){i===PROPERTY_FNTFILE?e.setFntFile(n):cc.NodeLoader.prototype.onHandlePropTypeFntFile.call(this,e,t,i,n,r)},onHandlePropTypeText:function(e,t,i,n,r){i===PROPERTY_STRING?e.setString(n):cc.NodeLoader.prototype.onHandlePropTypeText.call(this,e,t,i,n,r)}}),cc.LabelBMFontLoader.loader=function(){return new cc.LabelBMFontLoader};var PROPERTY_EMITERMODE="emitterMode",PROPERTY_POSVAR="posVar",PROPERTY_EMISSIONRATE="emissionRate",PROPERTY_DURATION="duration",PROPERTY_TOTALPARTICLES="totalParticles",PROPERTY_LIFE="life",PROPERTY_STARTSIZE="startSize",PROPERTY_ENDSIZE="endSize",PROPERTY_STARTSPIN="startSpin",PROPERTY_ENDSPIN="endSpin",PROPERTY_ANGLE="angle",PROPERTY_GRAVITY="gravity",PROPERTY_SPEED="speed",PROPERTY_TANGENTIALACCEL="tangentialAccel",PROPERTY_RADIALACCEL="radialAccel",PROPERTY_TEXTURE="texture",PROPERTY_STARTRADIUS="startRadius",PROPERTY_ENDRADIUS="endRadius",PROPERTY_ROTATEPERSECOND="rotatePerSecond";cc.ParticleSystemLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return new cc.ParticleSystem},onHandlePropTypeIntegerLabeled:function(e,t,i,n,r){i===PROPERTY_EMITERMODE?e.setEmitterMode(n):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,e,t,i,n,r)},onHandlePropTypePoint:function(e,t,i,n,r){i===PROPERTY_POSVAR?e.setPosVar(n):i===PROPERTY_GRAVITY?e.setGravity(n):cc.NodeLoader.prototype.onHandlePropTypePoint.call(this,e,t,i,n,r)},onHandlePropTypeFloat:function(e,t,i,n,r){i===PROPERTY_EMISSIONRATE?e.setEmissionRate(n):i===PROPERTY_DURATION?e.setDuration(n):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,e,t,i,n,r)},onHandlePropTypeInteger:function(e,t,i,n,r){i===PROPERTY_TOTALPARTICLES?e.setTotalParticles(n):cc.NodeLoader.prototype.onHandlePropTypeInteger.call(this,e,t,i,n,r)},onHandlePropTypeFloatVar:function(e,t,i,n,r){i===PROPERTY_LIFE?(e.setLife(n[0]),e.setLifeVar(n[1])):i===PROPERTY_STARTSIZE?(e.setStartSize(n[0]),e.setStartSizeVar(n[1])):i===PROPERTY_ENDSIZE?(e.setEndSize(n[0]),e.setEndSizeVar(n[1])):i===PROPERTY_STARTSPIN?(e.setStartSpin(n[0]),e.setStartSpinVar(n[1])):i===PROPERTY_ENDSPIN?(e.setEndSpin(n[0]),e.setEndSpinVar(n[1])):i===PROPERTY_ANGLE?(e.setAngle(n[0]),e.setAngleVar(n[1])):i===PROPERTY_SPEED?(e.setSpeed(n[0]),e.setSpeedVar(n[1])):i===PROPERTY_TANGENTIALACCEL?(e.setTangentialAccel(n[0]),e.setTangentialAccelVar(n[1])):i===PROPERTY_RADIALACCEL?(e.setRadialAccel(n[0]),e.setRadialAccelVar(n[1])):i===PROPERTY_STARTRADIUS?(e.setStartRadius(n[0]),e.setStartRadiusVar(n[1])):i===PROPERTY_ENDRADIUS?(e.setEndRadius(n[0]),e.setEndRadiusVar(n[1])):i===PROPERTY_ROTATEPERSECOND?(e.setRotatePerSecond(n[0]),e.setRotatePerSecondVar(n[1])):cc.NodeLoader.prototype.onHandlePropTypeFloatVar.call(this,e,t,i,n,r)},onHandlePropTypeColor4FVar:function(e,t,i,n,r){i===PROPERTY_STARTCOLOR?(e.setStartColor(n[0]),e.setStartColorVar(n[1])):i===PROPERTY_ENDCOLOR?(e.setEndColor(n[0]),e.setEndColorVar(n[1])):cc.NodeLoader.prototype.onHandlePropTypeColor4FVar.call(this,e,t,i,n,r)},onHandlePropTypeBlendFunc:function(e,t,i,n,r){i===PROPERTY_BLENDFUNC?e.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,e,t,i,n,r)},onHandlePropTypeTexture:function(e,t,i,n,r){i===PROPERTY_TEXTURE?e.setTexture(n):cc.NodeLoader.prototype.onHandlePropTypeTexture.call(this,e,t,i,n,r)}}),cc.ParticleSystemLoader.loader=function(){return new cc.ParticleSystemLoader},cc.NodeLoaderLibrary=cc.Class.extend({_ccNodeLoaders:null,ctor:function(){this._ccNodeLoaders={}},registerDefaultCCNodeLoaders:function(){this.registerCCNodeLoader("CCNode",cc.NodeLoader.loader()),this.registerCCNodeLoader("CCLayer",cc.LayerLoader.loader()),this.registerCCNodeLoader("CCLayerColor",cc.LayerColorLoader.loader()),this.registerCCNodeLoader("CCLayerGradient",cc.LayerGradientLoader.loader()),this.registerCCNodeLoader("CCSprite",cc.SpriteLoader.loader()),this.registerCCNodeLoader("CCLabelBMFont",cc.LabelBMFontLoader.loader()),this.registerCCNodeLoader("CCLabelTTF",cc.LabelTTFLoader.loader()),this.registerCCNodeLoader("CCScale9Sprite",cc.Scale9SpriteLoader.loader()),this.registerCCNodeLoader("CCScrollView",cc.ScrollViewLoader.loader()),this.registerCCNodeLoader("CCBFile",cc.BuilderFileLoader.loader()),this.registerCCNodeLoader("CCMenu",cc.MenuLoader.loader()),this.registerCCNodeLoader("CCMenuItemImage",cc.MenuItemImageLoader.loader()),this.registerCCNodeLoader("CCControlButton",cc.ControlButtonLoader.loader()),this.registerCCNodeLoader("CCParticleSystemQuad",cc.ParticleSystemLoader.loader())},registerCCNodeLoader:function(e,t){this._ccNodeLoaders[e]=t},unregisterCCNodeLoader:function(e){this._ccNodeLoaders[e]&&delete this._ccNodeLoaders[e]},getCCNodeLoader:function(e){return this._ccNodeLoaders[e]?this._ccNodeLoaders[e]:null},purge:function(e){if(e)for(var t in this._ccNodeLoaders)delete this._ccNodeLoaders[t];this._ccNodeLoaders={}}}),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null,cc.NodeLoaderLibrary.library=function(){return new cc.NodeLoaderLibrary},cc.NodeLoaderLibrary.sharedCCNodeLoaderLibrary=function(){return null==cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary&&(cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=new cc.NodeLoaderLibrary,cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary.registerDefaultCCNodeLoaders()),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary},cc.NodeLoaderLibrary.purgeSharedCCNodeLoaderLibrary=function(){cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null},cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary=function(){var e=cc.NodeLoaderLibrary.library();return e.registerDefaultCCNodeLoaders(),e};var CCB_VERSION=5,CCB_PROPTYPE_POSITION=0,CCB_PROPTYPE_SIZE=1,CCB_PROPTYPE_POINT=2,CCB_PROPTYPE_POINTLOCK=3,CCB_PROPTYPE_SCALELOCK=4,CCB_PROPTYPE_DEGREES=5,CCB_PROPTYPE_INTEGER=6,CCB_PROPTYPE_FLOAT=7,CCB_PROPTYPE_FLOATVAR=8,CCB_PROPTYPE_CHECK=9,CCB_PROPTYPE_SPRITEFRAME=10,CCB_PROPTYPE_TEXTURE=11,CCB_PROPTYPE_BYTE=12,CCB_PROPTYPE_COLOR3=13,CCB_PROPTYPE_COLOR4VAR=14,CCB_PROPTYPE_FLIP=15,CCB_PROPTYPE_BLENDMODE=16,CCB_PROPTYPE_FNTFILE=17,CCB_PROPTYPE_TEXT=18,CCB_PROPTYPE_FONTTTF=19,CCB_PROPTYPE_INTEGERLABELED=20,CCB_PROPTYPE_BLOCK=21,CCB_PROPTYPE_ANIMATION=22,CCB_PROPTYPE_CCBFILE=23,CCB_PROPTYPE_STRING=24,CCB_PROPTYPE_BLOCKCCCONTROL=25,CCB_PROPTYPE_FLOATSCALE=26,CCB_PROPTYPE_FLOATXY=27,CCB_FLOAT0=0,CCB_FLOAT1=1,CCB_FLOAT_MINUS1=2,CCB_FLOAT05=3,CCB_FLOAT_INTEGER=4,CCB_FLOAT_FULL=5,CCB_PLATFORM_ALL=0,CCB_PLATFORM_IOS=1,CCB_PLATFORM_MAC=2,CCB_TARGETTYPE_NONE=0,CCB_TARGETTYPE_DOCUMENTROOT=1,CCB_TARGETTYPE_OWNER=2,CCB_KEYFRAME_EASING_INSTANT=0,CCB_KEYFRAME_EASING_LINEAR=1,CCB_KEYFRAME_EASING_CUBIC_IN=2,CCB_KEYFRAME_EASING_CUBIC_OUT=3,CCB_KEYFRAME_EASING_CUBIC_INOUT=4,CCB_KEYFRAME_EASING_ELASTIC_IN=5,CCB_KEYFRAME_EASING_ELASTIC_OUT=6,CCB_KEYFRAME_EASING_ELASTIC_INOUT=7,CCB_KEYFRAME_EASING_BOUNCE_IN=8,CCB_KEYFRAME_EASING_BOUNCE_OUT=9,CCB_KEYFRAME_EASING_BOUNCE_INOUT=10,CCB_KEYFRAME_EASING_BACK_IN=11,CCB_KEYFRAME_EASING_BACK_OUT=12,CCB_KEYFRAME_EASING_BACK_INOUT=13,CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT=0,CCB_POSITIONTYPE_RELATIVE_TOP_LEFT=1,CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT=2,CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT=3,CCB_POSITIONTYPE_PERCENT=4,CCB_POSITIONTYPE_MULTIPLY_RESOLUTION=5,CCB_SIZETYPE_ABSOLUTE=0,CCB_SIZETYPE_PERCENT=1,CCB_SIZETYPE_RELATIVE_CONTAINER=2,CCB_SIZETYPE_HORIZONTAL_PERCENT=3,CCB_SIZETYPE_VERTICAL_PERCENT=4,CCB_SIZETYPE_MULTIPLY_RESOLUTION=5,CCB_SCALETYPE_ABSOLUTE=0,CCB_SCALETYPE_MULTIPLY_RESOLUTION=1;cc.BuilderFile=cc.Node.extend({_ccbFileNode:null,getCCBFileNode:function(){return this._ccbFileNode},setCCBFileNode:function(e){this._ccbFileNode=e}}),cc.BuilderFile.create=function(){return new cc.BuilderFile},cc.BuilderReader=cc.Class.extend({_jsControlled:!1,_data:null,_ccbRootPath:"",_bytes:0,_currentByte:0,_currentBit:0,_stringCache:null,_loadedSpriteSheets:null,_owner:null,_animationManager:null,_animationManagers:null,_animatedProps:null,_ccNodeLoaderLibrary:null,_ccNodeLoaderListener:null,_ccbMemberVariableAssigner:null,_ccbSelectorResolver:null,_ownerOutletNames:null,_ownerOutletNodes:null,_nodesWithAnimationManagers:null,_animationManagerForNodes:null,_ownerCallbackNames:null,_ownerCallbackNodes:null,_ownerCallbackEvents:null,_readNodeGraphFromData:!1,ctor:function(e,t,i,n){if(this._stringCache=[],this._loadedSpriteSheets=[],this._currentBit=-1,this._currentByte=-1,0!=arguments.length)if(e instanceof cc.BuilderReader){var r=e;this._loadedSpriteSheets=r._loadedSpriteSheets,this._ccNodeLoaderLibrary=r._ccNodeLoaderLibrary,this._ccbMemberVariableAssigner=r._ccbMemberVariableAssigner,this._ccbSelectorResolver=r._ccbSelectorResolver,this._ccNodeLoaderListener=r._ccNodeLoaderListener,this._ownerCallbackNames=r._ownerCallbackNames,this._ownerCallbackNodes=r._ownerCallbackNodes,this._ownerCallbackEvents=r._ownerCallbackEvents,this._ownerOutletNames=r._ownerOutletNames,this._ownerOutletNodes=r._ownerOutletNodes,this._ccbRootPath=r._ccbRootPath}else this._ccNodeLoaderLibrary=e,this._ccbMemberVariableAssigner=t,this._ccbSelectorResolver=i,this._ccNodeLoaderListener=n},getCCBRootPath:function(){return this._ccbRootPath},setCCBRootPath:function(e){this._ccbRootPath=e},initWithData:function(e,t){return this._animationManager=new cc.BuilderAnimationManager,this._data=e,this._bytes=e.length,this._currentBit=0,this._currentByte=0,this._owner=t,this._animationManager.setRootContainerSize(cc.director.getWinSize()),!0},_loadBinarySync:function(e){var t=this.getXMLHttpRequest(),i="load "+e+" failed!";t.open("GET",e,!1);var n=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){if(t.setRequestHeader("Accept-Charset","x-user-defined"),t.send(null),200!=t.status)return cc.log(i),null;var r=cc._convertResponseBodyToText(t.responseBody);r&&(n=this._stringConvertToArray(r),this._fileDataCache[e]=n)}else{if(t.overrideMimeType&&t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(null),200!=t.status)return cc.log(i),null;n=this._stringConvertToArray(t.responseText),this._fileDataCache[e]=n}return n},readNodeGraphFromFile:function(e,t,i,n){null==i?i=cc.director.getWinSize():i instanceof cc.BuilderAnimationManager&&(n=i,i=cc.director.getWinSize());var r=cc.loader.getRes(e);if(!r){var o=cc.loader.getUrl(e);r=cc.loader.loadBinarySync(o),cc.loader.cache[e]=r}return this.readNodeGraphFromData(r,t,i,n)},readNodeGraphFromData:function(e,t,i){this.initWithData(e,t);var n=this._animationManager;n.setRootContainerSize(i),n.setOwner(t),this._ownerOutletNames=[],this._ownerOutletNodes=[],this._ownerCallbackNames=[],this._ownerCallbackNodes=[],this._ownerCallbackEvents=[],this._animationManagers=new cc._Dictionary;var r=this.readFileWithCleanUp(!0);if(r&&-1!=n.getAutoPlaySequenceId()&&n.runAnimations(n.getAutoPlaySequenceId(),0),this._jsControlled){for(var o=[],s=[],a=this._animationManagers,c=a.allKeys(),l=0;l<c.length;l++)o.push(c[l]),s.push(a.objectForKey(c[l]));this._nodesWithAnimationManagers=o,this._animationManagerForNodes=s}return r},createSceneWithNodeGraphFromFile:function(e,t,i,n){var r=this.readNodeGraphFromFile(e,t,i,n),o=new cc.Scene;return o.addChild(r),o},getCCBMemberVariableAssigner:function(){return this._ccbMemberVariableAssigner},getCCBSelectorResolver:function(){return this._ccbSelectorResolver},getAnimationManager:function(){return this._animationManager},setAnimationManager:function(e){this._animationManager=e},getAnimatedProperties:function(){return this._animatedProps},getLoadedSpriteSheet:function(){return this._loadedSpriteSheets},getOwner:function(){return this._owner},readInt:function(e){for(var t=0;!this._getBit();)t++;for(var i=0,n=t-1;n>=0;n--)this._getBit()&&(i|=1<<n);i|=1<<t;var r;return r=e?i%2?0|i/2:0|-i/2:i-1,this._alignBits(),r},readByte:function(){var e=this._data[this._currentByte];return this._currentByte++,e},readBool:function(){return 0!=this.readByte()},readFloat:function(){switch(this.readByte()){case CCB_FLOAT0:return 0;case CCB_FLOAT1:return 1;case CCB_FLOAT_MINUS1:return-1;case CCB_FLOAT05:return.5;case CCB_FLOAT_INTEGER:return this.readInt(!0);default:return this._decodeFloat(23,8)}},_decodeFloat:function(e,t){var i=e+t+1,n=i>>3;this._checkSize(i);var r=Math.pow(2,t-1)-1,o=this._readBitsOnly(e+t,1,n),s=this._readBitsOnly(e,t,n),a=0,c=2,l=0;do{for(var u=this._readByteOnly(++l,n),h=e%8||8,d=1<<h;d>>=1;)u&d&&(a+=1/c),c*=2}while(e-=h);return this._currentByte+=n,s==1+(r<<1)?a?NaN:o?-1/0:1/0:(1+-2*o)*(s||a?s?Math.pow(2,s-r)*(1+a):Math.pow(2,1-r)*a:0)},_readBitsOnly:function(e,t,i){var n=(e+t)%8,r=e%8,o=i-(e>>3)-1,s=i+(-(e+t)>>3),a=o-s,c=this._readByteOnly(o,i)>>r&(1<<(a?8-r:t))-1;for(a&&n&&(c+=(this._readByteOnly(s++,i)&(1<<n)-1)<<(a--<<3)-r);a;)c+=this._shl(this._readByteOnly(s++,i),(a--<<3)-r);return c},_readByteOnly:function(e,t){return this._data[this._currentByte+t-e-1]},_shl:function(e,t){for(++t;--t;e=1073741824==(1073741824&(e%=2147483648))?2*e:2*(e-1073741824)+2147483647+1);return e},_checkSize:function(e){if(!(this._currentByte+Math.ceil(e/8)<this._data.length))throw new Error("Index out of bound")},readCachedString:function(){return this._stringCache[this.readInt(!1)]},isJSControlled:function(){return this._jsControlled},getOwnerCallbackNames:function(){return this._ownerCallbackNames},getOwnerCallbackNodes:function(){return this._ownerCallbackNodes},getOwnerCallbackControlEvents:function(){return this._ownerCallbackEvents},getOwnerOutletNames:function(){return this._ownerOutletNames},getOwnerOutletNodes:function(){return this._ownerOutletNodes},getNodesWithAnimationManagers:function(){return this._nodesWithAnimationManagers},getAnimationManagersForNodes:function(){return this._animationManagerForNodes},getAnimationManagers:function(){return this._animationManagers},setAnimationManagers:function(e){this._animationManagers=e},addOwnerCallbackName:function(e){this._ownerCallbackNames.push(e)},addOwnerCallbackNode:function(e){this._ownerCallbackNodes.push(e)},addOwnerCallbackControlEvents:function(e){this._ownerCallbackEvents.push(e)},addDocumentCallbackName:function(e){this._animationManager.addDocumentCallbackName(e)},addDocumentCallbackNode:function(e){this._animationManager.addDocumentCallbackNode(e)},addDocumentCallbackControlEvents:function(e){this._animationManager.addDocumentCallbackControlEvents(e)},readFileWithCleanUp:function(e){if(!this._readHeader())return null;if(!this._readStringCache())return null;if(!this._readSequences())return null;var t=this._readNodeGraph();return this._animationManagers.setObject(this._animationManager,t),e&&this._cleanUpNodeGraph(t),t},addOwnerOutletName:function(e){this._ownerOutletNames.push(e)},addOwnerOutletNode:function(e){null!=e&&this._ownerOutletNodes.push(e)},_cleanUpNodeGraph:function(e){e.userObject=null;for(var t=e.getChildren(),i=0,n=t.length;i<n;i++)this._cleanUpNodeGraph(t[i])},_readCallbackKeyframesForSeq:function(e){var t=this.readInt(!1);if(!t)return!0;for(var i=new cc.BuilderSequenceProperty,n=this._jsControlled,r=this._animationManager,o=i.getKeyframes(),s=0;s<t;s++){var a=this.readFloat(),c=this.readCachedString(),l=this.readInt(!1),u=[c,l],h=new cc.BuilderKeyframe;h.setTime(a),h.setValue(u),n&&r.getKeyframeCallbacks().push(l+":"+c),o.push(h)}return e.setCallbackChannel(i),!0},_readSoundKeyframesForSeq:function(e){var t=this.readInt(!1);if(!t)return!0;for(var i=new cc.BuilderSequenceProperty,n=i.getKeyframes(),r=0;r<t;r++){var o=this.readFloat(),s=[this.readCachedString(),this.readFloat(),this.readFloat(),this.readFloat()],a=new cc.BuilderKeyframe;a.setTime(o),a.setValue(s),n.push(a)}return e.setSoundChannel(i),!0},_readSequences:function(){for(var e=this._animationManager.getSequences(),t=this.readInt(!1),i=0;i<t;i++){var n=new cc.BuilderSequence;if(n.setDuration(this.readFloat()),n.setName(this.readCachedString()),n.setSequenceId(this.readInt(!1)),n.setChainedSequenceId(this.readInt(!0)),!this._readCallbackKeyframesForSeq(n))return!1;if(!this._readSoundKeyframesForSeq(n))return!1;e.push(n)}return this._animationManager.setAutoPlaySequenceId(this.readInt(!0)),!0},readKeyframe:function(e){var t=new cc.BuilderKeyframe;t.setTime(this.readFloat());var i=this.readInt(!1),n=0,r=null;if(i!==CCB_KEYFRAME_EASING_CUBIC_IN&&i!==CCB_KEYFRAME_EASING_CUBIC_OUT&&i!==CCB_KEYFRAME_EASING_CUBIC_INOUT&&i!==CCB_KEYFRAME_EASING_ELASTIC_IN&&i!==CCB_KEYFRAME_EASING_ELASTIC_OUT&&i!==CCB_KEYFRAME_EASING_ELASTIC_INOUT||(n=this.readFloat()),t.setEasingType(i),t.setEasingOpt(n),e==CCB_PROPTYPE_CHECK)r=this.readBool();else if(e==CCB_PROPTYPE_BYTE)r=this.readByte();else if(e==CCB_PROPTYPE_COLOR3){var o=cc.color(this.readByte(),this.readByte(),this.readByte());r=cc.Color3BWapper.create(o)}else if(e==CCB_PROPTYPE_FLOATXY)r=[this.readFloat(),this.readFloat()];else if(e==CCB_PROPTYPE_DEGREES)r=this.readFloat();else if(e==CCB_PROPTYPE_SCALELOCK||e==CCB_PROPTYPE_POSITION||e==CCB_PROPTYPE_FLOATXY)r=[this.readFloat(),this.readFloat()];else if(e==CCB_PROPTYPE_SPRITEFRAME){var s=this.readCachedString(),a=this.readCachedString();if(""==s){a=this._ccbRootPath+a;var c=cc.textureCache.addImage(a),l=c.getContentSize(),u=cc.rect(0,0,l.width,l.height);r=new cc.SpriteFrame(c,u)}else{s=this._ccbRootPath+s;var h=cc.spriteFrameCache;-1==this._loadedSpriteSheets.indexOf(s)&&(h.addSpriteFrames(s),this._loadedSpriteSheets.push(s)),r=h.getSpriteFrame(a)}}return t.setValue(r),t},_readHeader:function(){if(null==this._data)return!1;var e=this._readStringFromBytes(this._currentByte,4,!0);if(this._currentByte+=4,"ccbi"!=e)return!1;var t=this.readInt(!1);return t!=CCB_VERSION?(cc.log("WARNING! Incompatible ccbi file version (file: "+t+" reader: "+CCB_VERSION+")"),!1):(this._jsControlled=this.readBool(),this._animationManager._jsControlled=this._jsControlled,!0)},_readStringFromBytes:function(e,t,i){i=i||!1;var n,r="",o=this._data,s=this._currentByte;if(i)for(n=t-1;n>=0;n--)r+=String.fromCharCode(o[s+n]);else for(n=0;n<t;n++)r+=String.fromCharCode(o[s+n]);return r},_readStringCache:function(){for(var e=this.readInt(!1),t=0;t<e;t++)this._readStringCacheEntry();return!0},_readStringCacheEntry:function(){for(var e=this.readByte()<<8|this.readByte(),t="",i=this._data,n=this._currentByte,r=0;r<e;r++){var o=i[n+r].toString("16").toUpperCase();t+="%"+(o=o.length>1?o:"0"+o)}t=decodeURIComponent(t),this._currentByte+=e,this._stringCache.push(t)},_readNodeGraph:function(e){var t,i=this.readCachedString(),n=this._jsControlled,r=this._animationManager;n&&(t=this.readCachedString());var o,s=this.readInt(!1);s!=CCB_TARGETTYPE_NONE&&(o=this.readCachedString());var a=this._ccNodeLoaderLibrary.getCCNodeLoader(i);a||(a=this._ccNodeLoaderLibrary.getCCNodeLoader("CCNode"));var c=a.loadCCNode(e,this);r.getRootNode()||r.setRootNode(c),n&&c==r.getRootNode()&&r.setDocumentControllerName(t);var l=new cc._Dictionary;this._animatedProps=[];var u,h=this._animatedProps,d=this.readInt(!1);for(u=0;u<d;++u){for(var p=this.readInt(!1),_=new cc._Dictionary,f=this.readInt(!1),m=0;m<f;++m){var g=new cc.BuilderSequenceProperty;g.setName(this.readCachedString()),g.setType(this.readInt(!1)),h.push(g.getName());for(var y=this.readInt(!1),T=g.getKeyframes(),v=0;v<y;++v){var S=this.readKeyframe(g.getType());T.push(S)}_.setObject(g,g.getName())}l.setObject(_,p)}l.count()>0&&r.addNode(c,l),a.parseProperties(c,e,this);var C=c instanceof cc.BuilderFile;if(C){var E=c.getCCBFileNode();E.setPosition(c.getPosition()),E.setRotation(c.getRotation()),E.setScaleX(c.getScaleX()),E.setScaleY(c.getScaleY()),E.setTag(c.getTag()),E.setVisible(!0),r.moveAnimationsFromNode(c,E),c.setCCBFileNode(null),c=E}var b=null,A=null;if(s!=CCB_TARGETTYPE_NONE)if(n)s==CCB_TARGETTYPE_DOCUMENTROOT?(r.addDocumentOutletName(o),r.addDocumentOutletNode(c)):(this._ownerOutletNames.push(o),this._ownerOutletNodes.push(c));else if(s===CCB_TARGETTYPE_DOCUMENTROOT?b=r.getRootNode():s===CCB_TARGETTYPE_OWNER&&(b=this._owner),null!=b){var x=!1;null!=b&&b.onAssignCCBMemberVariable&&(x=b.onAssignCCBMemberVariable(b,o,c)),A=this._ccbMemberVariableAssigner,!x&&null!=A&&A.onAssignCCBMemberVariable&&A.onAssignCCBMemberVariable(b,o,c)}if(a.getCustomProperties().length>0){var R=!1;if(!n&&null!=(b=c)&&null!=b.onAssignCCBCustomProperty){var P=a.getCustomProperties(),I=P.allKeys();for(u=0;u<I.length;u++){var w=P.objectForKey(I[u]);R=b.onAssignCCBCustomProperty(b,I[u],w),A=this._ccbMemberVariableAssigner,R||null==A||null==A.onAssignCCBCustomProperty||(R=A.onAssignCCBCustomProperty(b,I[u],w))}}}this._animatedProps=null;var N=this.readInt(!1);for(u=0;u<N;u++){var L=this._readNodeGraph(c);c.addChild(L)}return C||(null!=c&&c.onNodeLoaded?c.onNodeLoaded(c,a):null!=this._ccNodeLoaderListener&&this._ccNodeLoaderListener.onNodeLoaded(c,a)),c},_getBit:function(){var e=0!=(this._data[this._currentByte]&1<<this._currentBit);if(++this._currentBit>=8&&(this._currentBit=0,++this._currentByte>this._data.length))throw"out of the data bound";return e},_alignBits:function(){this._currentBit&&(this._currentBit=0,this._currentByte++)},_readUTF8:function(){}}),cc.BuilderReader._ccbResolutionScale=1,cc.BuilderReader.setResolutionScale=function(e){cc.BuilderReader._ccbResolutionScale=e},cc.BuilderReader.getResolutionScale=function(){return cc.BuilderReader._ccbResolutionScale},cc.BuilderReader.loadAsScene=function(e,t,i,n){n=n||cc.BuilderReader.getResourcePath();var r=cc.BuilderReader.load(e,t,i,n),o=new cc.Scene;return o.addChild(r),o},cc.BuilderReader._controllerClassCache={},cc.BuilderReader.registerController=function(e,t){cc.BuilderReader._controllerClassCache[e]=cc.Class.extend(t)},cc.BuilderReader.load=function(e,t,i,n){n=n||cc.BuilderReader.getResourcePath();var r=new cc.BuilderReader(cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary());r.setCCBRootPath(n),(e.length<5||e.toLowerCase().lastIndexOf(".ccbi")!=e.length-5)&&(e+=".ccbi");var o,s,a,c,l,u,h=r.readNodeGraphFromFile(e,t,i);if(t){var d=r.getOwnerCallbackNames(),p=r.getOwnerCallbackNodes(),_=r.getOwnerCallbackControlEvents();for(o=0;o<d.length;o++)s=d[o],a=p[o],c=_[o],a instanceof cc.ControlButton?a.addTargetWithActionForControlEvents(t,t[s],c):a.setCallback(t[s],t);var f=r.getOwnerOutletNames(),m=r.getOwnerOutletNodes();for(o=0;o<f.length;o++)l=f[o],u=m[o],t[l]=u}var g=r.getNodesWithAnimationManagers(),y=r.getAnimationManagersForNodes();if(!g||!y)return h;var T=cc.BuilderReader._controllerClassCache;for(o=0;o<g.length;o++){var v,S=g[o],C=y[o];S.animationManager=C;var E=C.getDocumentControllerName();if(E){var b=T[E];if(!b)throw"Can not find controller : "+E;var A=new b;A.controllerName=E,S.controller=A,A.rootNode=S;var x=C.getDocumentCallbackNames(),R=C.getDocumentCallbackNodes(),P=C.getDocumentCallbackControlEvents();for(v=0;v<x.length;v++)s=x[v],a=R[v],c=P[v],a instanceof cc.ControlButton?a.addTargetWithActionForControlEvents(A,A[s],c):a.setCallback(A[s],A);var I=C.getDocumentOutletNames(),w=C.getDocumentOutletNodes();for(v=0;v<I.length;v++)l=I[v],u=w[v],A[l]=u;A.onDidLoadFromCCB&&cc.isFunction(A.onDidLoadFromCCB)&&A.onDidLoadFromCCB();var N=C.getKeyframeCallbacks();for(v=0;v<N.length;v++){var L=N[v].split(":"),O=L[0],D=L[1];1==O?C.setCallFunc(cc.callFunc(A[D],A),N[v]):2==O&&t&&C.setCallFunc(cc.callFunc(t[D],t),N[v])}}}return C.runAnimations(C.getAutoPlaySequenceId(),0),h},cc.BuilderReader._resourcePath="",cc.BuilderReader.setResourcePath=function(e){cc.BuilderReader._resourcePath=e},cc.BuilderReader.getResourcePath=function(){return cc.BuilderReader._resourcePath},cc.BuilderReader.lastPathComponent=function(e){var t=e.lastIndexOf("/");return-1!=t?e.substring(t+1,e.length-t):e},cc.BuilderReader.deletePathExtension=function(e){var t=e.lastIndexOf(".");return-1!=t?e.substring(0,t):e},cc.BuilderReader.toLowerCase=function(e){return e.toLowerCase()},cc.BuilderReader.endsWith=function(e,t){return e.length>=t.length&&0==e.lastIndexOf(t)},cc.BuilderReader.concat=function(e,t){return e+t},cc.loader.register(["ccbi"],cc._binaryLoader),cc.INT_VALUE=0,cc.FLOAT_VALUE=1,cc.POINTER_VALUE=2,cc.BOOL_VALUE=3,cc.UNSIGNEDCHAR_VALUE=4,cc.Color3BWapper=cc.Class.extend({_color:null,ctor:function(){this._color=cc.color(0,0,0)},getColor:function(){return this._color}}),cc.Color3BWapper.create=function(e){var t=new cc.Color3BWapper;return t&&(t._color.r=e.r,t._color.g=e.g,t._color.b=e.b),t},cc.BuilderValue=cc.Class.extend({_value:null,_type:0,getIntValue:function(){},getFloatValue:function(){},getBoolValue:function(){},getByteValue:function(){},getPointer:function(){},getValue:function(){return this._value}}),cc.BuilderValue.create=function(e){return new cc.BuilderValue},cc.BuilderKeyframe=cc.Class.extend({_value:null,_time:0,_easingType:0,_easingOpt:0,getValue:function(){return this._value},setValue:function(e){this._value=e},getTime:function(){return this._time},setTime:function(e){this._time=e},getEasingType:function(){return this._easingType},setEasingType:function(e){this._easingType=e},getEasingOpt:function(){return this._easingOpt},setEasingOpt:function(e){this._easingOpt=e}}),cc.BuilderSequence=cc.Class.extend({_duration:0,_name:"",_sequenceId:0,_chainedSequenceId:0,_callbackChannel:null,_soundChannel:null,ctor:function(){this._name=""},getDuration:function(){return this._duration},setDuration:function(e){this._duration=e},getName:function(){return this._name},setName:function(e){this._name=e},getSequenceId:function(){return this._sequenceId},setSequenceId:function(e){this._sequenceId=e},getChainedSequenceId:function(){return this._chainedSequenceId},setChainedSequenceId:function(e){this._chainedSequenceId=e},getCallbackChannel:function(){return this._callbackChannel},setCallbackChannel:function(e){this._callbackChannel=e},getSoundChannel:function(){return this._soundChannel},setSoundChannel:function(e){this._soundChannel=e}}),cc.BuilderSequenceProperty=cc.Class.extend({_name:null,_type:0,_keyFrames:null,ctor:function(){this.init()},init:function(){this._keyFrames=[],this._name=""},getName:function(){return this._name},setName:function(e){this._name=e},getType:function(){return this._type},setType:function(e){this._type=e},getKeyframes:function(){return this._keyFrames}}),cc.getAbsolutePosition=function(e,t,i,n){var r=cc.p(0,0);if(t===CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT)r=e;else if(t===CCB_POSITIONTYPE_RELATIVE_TOP_LEFT)r.x=e.x,r.y=i.height-e.y;else if(t===CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT)r.x=i.width-e.x,r.y=i.height-e.y;else if(t===CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT)r.x=i.width-e.x,r.y=e.y;else if(t===CCB_POSITIONTYPE_PERCENT)r.x=i.width*e.x/100,r.y=i.height*e.y/100;else if(t===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var o=cc.BuilderReader.getResolutionScale();r.x=e.x*o,r.y=e.y*o}return r},cc._getAbsolutePosition=function(e,t,i,n,r){var o=cc.p(0,0);if(i===CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT)o.x=e,o.y=t;else if(i===CCB_POSITIONTYPE_RELATIVE_TOP_LEFT)o.x=e,o.y=n.height-t;else if(i===CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT)o.x=n.width-e,o.y=n.height-t;else if(i===CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT)o.x=n.width-e,o.y=t;else if(i===CCB_POSITIONTYPE_PERCENT)o.x=n.width*e/100,o.y=n.height*t/100;else if(i===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var s=cc.BuilderReader.getResolutionScale();o.x=e*s,o.y=t*s}return o},cc.setRelativeScale=function(e,t,i,n,r){if(!e)throw"cc.setRelativeScale(): node should be non-null";if(n===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var o=cc.BuilderReader.getResolutionScale();t*=o,i*=o}e.setScaleX(t),e.setScaleY(i)},cc.BuilderAnimationManagerDelegate=cc.Class.extend({completedAnimationSequenceNamed:function(e){}}),cc.BuilderAnimationManager=cc.Class.extend({_sequences:null,_nodeSequences:null,_baseValues:null,_autoPlaySequenceId:0,_rootNode:null,_owner:null,_rootContainerSize:null,_delegate:null,_runningSequence:null,_documentOutletNames:null,_documentOutletNodes:null,_documentCallbackNames:null,_documentCallbackNodes:null,_documentCallbackControlEvents:null,_documentControllerName:"",_lastCompletedSequenceName:"",_keyframeCallbacks:null,_keyframeCallFuncs:null,_animationCompleteCallbackFunc:null,_target:null,_jsControlled:!1,ctor:function(){this._rootContainerSize=cc.size(0,0),this.init()},init:function(){return this._sequences=[],this._nodeSequences=new cc._Dictionary,this._baseValues=new cc._Dictionary,this._documentOutletNames=[],this._documentOutletNodes=[],this._documentCallbackNames=[],this._documentCallbackNodes=[],this._documentCallbackControlEvents=[],this._keyframeCallbacks=[],this._keyframeCallFuncs={},!0},getSequences:function(){return this._sequences},setSequences:function(e){this._sequences=e},getAutoPlaySequenceId:function(){return this._autoPlaySequenceId},setAutoPlaySequenceId:function(e){this._autoPlaySequenceId=e},getRootNode:function(){return this._rootNode},setRootNode:function(e){this._rootNode=e},getOwner:function(){return this._owner},setOwner:function(e){this._owner=e},addDocumentCallbackNode:function(e){this._documentCallbackNodes.push(e)},addDocumentCallbackName:function(e){this._documentCallbackNames.push(e)},addDocumentCallbackControlEvents:function(e){this._documentCallbackControlEvents.push(e)},addDocumentOutletNode:function(e){this._documentOutletNodes.push(e)},addDocumentOutletName:function(e){this._documentOutletNames.push(e)},setDocumentControllerName:function(e){this._documentControllerName=e},getDocumentControllerName:function(){return this._documentControllerName},getDocumentCallbackNames:function(){return this._documentCallbackNames},getDocumentCallbackNodes:function(){return this._documentCallbackNodes},getDocumentCallbackControlEvents:function(){return this._documentCallbackControlEvents},getDocumentOutletNames:function(){return this._documentOutletNames},getDocumentOutletNodes:function(){return this._documentOutletNodes},getLastCompletedSequenceName:function(){return this._lastCompletedSequenceName},getKeyframeCallbacks:function(){return this._keyframeCallbacks},getRootContainerSize:function(){return this._rootContainerSize},setRootContainerSize:function(e){this._rootContainerSize=cc.size(e.width,e.height)},getDelegate:function(){return this._delegate},setDelegate:function(e){this._delegate=e},getRunningSequenceName:function(){return this._runningSequence?this._runningSequence.getName():null},getContainerSize:function(e){return e?e.getContentSize():this._rootContainerSize},addNode:function(e,t){this._nodeSequences.setObject(t,e)},setBaseValue:function(e,t,i){var n=this._baseValues.objectForKey(t);n||(n=new cc._Dictionary,this._baseValues.setObject(n,t)),n.setObject(e,i)},moveAnimationsFromNode:function(e,t){var i=this._baseValues,n=i.objectForKey(e);null!=n&&(i.setObject(n,t),i.removeObjectForKey(e));var r=this._nodeSequences,o=r.objectForKey(e);null!=o&&(r.setObject(o,t),r.removeObjectForKey(e))},getActionForCallbackChannel:function(e){for(var t=0,i=[],n=e.getKeyframes(),r=n.length,o=0;o<r;++o){var s=n[o],a=s.getTime()-t;t=s.getTime(),a>0&&i.push(cc.delayTime(a));var c=s.getValue(),l=c[0],u=c[1];if(this._jsControlled){var h=u+":"+l,d=this._keyframeCallFuncs[h];null!=d&&i.push(d)}else{var p;if(u==CCB_TARGETTYPE_DOCUMENTROOT?p=this._rootNode:u==CCB_TARGETTYPE_OWNER&&(p=this._owner),null!=p)if(l.length>0){var _=0,f=p;null!=p.onResolveCCBCCCallFuncSelector&&(_=f.onResolveCCBCCCallFuncSelector(p,l)),0==_?cc.log("Skipping selector '"+l+"' since no CCBSelectorResolver is present."):i.push(cc.callFunc(_,p))}else cc.log("Unexpected empty selector.")}}return i.length<1?null:cc.sequence(i)},getActionForSoundChannel:function(e){for(var t=0,i=[],n=e.getKeyframes(),r=n.length,o=0;o<r;++o){var s=n[o],a=s.getTime()-t;t=s.getTime(),a>0&&i.push(cc.delayTime(a));var c=s.getValue(),l=cc.BuilderReader.getResourcePath()+c[0],u=parseFloat(c[1]),h=parseFloat(c[2]),d=parseFloat(c[3]);i.push(cc.BuilderSoundEffect.create(l,u,h,d))}return i.length<1?null:cc.sequence(i)},runAnimationsForSequenceNamed:function(e){this.runAnimationsForSequenceIdTweenDuration(this._getSequenceId(e),0)},runAnimationsForSequenceNamedTweenDuration:function(e,t){this.runAnimationsForSequenceIdTweenDuration(this._getSequenceId(e),t)},runAnimationsForSequenceIdTweenDuration:function(e,t){if(-1===e)throw"cc.BuilderAnimationManager.runAnimationsForSequenceIdTweenDuration(): Sequence id should not be -1";t=t||0,this._rootNode.stopAllActions();for(var i=this._nodeSequences.allKeys(),n=0,r=i.length;n<r;n++){var o=i[n];o.stopAllActions();var s,a=this._nodeSequences.objectForKey(o).objectForKey(e),c=[];if(a){var l=a.allKeys();for(s=0;s<l.length;s++){var u=l[s],h=a.objectForKey(u);c.push(u),this._setFirstFrame(o,h,t),this._runAction(o,h,t)}}var d=this._baseValues.objectForKey(o);if(d){var p=d.allKeys();for(s=0;s<p.length;s++){var _=p[s];if(-1==c.indexOf(_)){var f=d.objectForKey(_);null!=f&&this._setAnimatedProperty(_,o,f,t)}}}}var m=this._getSequence(e),g=cc.sequence(cc.delayTime(m.getDuration()+t),cc.callFunc(this._sequenceCompleted,this));this._rootNode.runAction(g);var y;m.getCallbackChannel()&&(y=this.getActionForCallbackChannel(m.getCallbackChannel()))&&this._rootNode.runAction(y),m.getSoundChannel()&&(y=this.getActionForSoundChannel(m.getSoundChannel()))&&this._rootNode.runAction(y),this._runningSequence=this._getSequence(e)},runAnimations:function(e,t){t=t||0;var i;i=cc.isString(e)?this._getSequenceId(e):e,this.runAnimationsForSequenceIdTweenDuration(i,t)},setAnimationCompletedCallback:function(e,t){this._target=e,this._animationCompleteCallbackFunc=t},setCompletedAnimationCallback:function(e,t){this.setAnimationCompletedCallback(e,t)},setCallFunc:function(e,t){this._keyframeCallFuncs[t]=e},debug:function(){},_getBaseValue:function(e,t){var i=this._baseValues.objectForKey(e);return i?i.objectForKey(t):null},_getSequenceId:function(e){for(var t=null,i=this._sequences,n=0,r=i.length;n<r;n++)if((t=i[n])&&t.getName()===e)return t.getSequenceId();return-1},_getSequence:function(e){for(var t=null,i=this._sequences,n=0,r=i.length;n<r;n++)if((t=i[n])&&t.getSequenceId()===e)return t;return null},_getAction:function(e,t,i,n){var r,o,s,a,c,l=t.getTime()-(e?e.getTime():0);if("rotation"===i)return cc.BuilderRotateTo.create(l,t.getValue());if("rotationX"===i)return cc.BuilderRotateXTo.create(l,t.getValue());if("rotationY"===i)return cc.BuilderRotateYTo.create(l,t.getValue());if("opacity"===i)return cc.fadeTo(l,t.getValue());if("color"===i){var u=t.getValue().getColor();return cc.tintTo(l,u.r,u.g,u.b)}if("visible"===i)return t.getValue()?cc.sequence(cc.delayTime(l),cc.show()):cc.sequence(cc.delayTime(l),cc.hide());if("displayFrame"===i)return cc.sequence(cc.delayTime(l),cc.BuilderSetSpriteFrame.create(t.getValue()));if("position"===i){o=(r=this._getBaseValue(n,i))[2],a=(s=t.getValue())[0],c=s[1];var h=this.getContainerSize(n.getParent()),d=cc._getAbsolutePosition(a,c,o,h,i);return cc.moveTo(l,d)}if("scale"===i){if(r=this._getBaseValue(n,i),o=r[2],s=t.getValue(),a=s[0],c=s[1],o===CCB_SCALETYPE_MULTIPLY_RESOLUTION){var p=cc.BuilderReader.getResolutionScale();a*=p,c*=p}return cc.scaleTo(l,a,c)}return"skew"===i?(s=t.getValue(),a=s[0],c=s[1],cc.skewTo(l,a,c)):(cc.log("BuilderReader: Failed to create animation for property: "+i),null)},_setAnimatedProperty:function(e,t,i,n){if(n>0){var r=new cc.BuilderKeyframe;r.setValue(i),r.setTime(n),r.setEasingType(CCB_KEYFRAME_EASING_LINEAR);var o=this._getAction(null,r,e,t);t.runAction(o)}else{var s,a,c;if("position"===e)s=this._getBaseValue(t,e)[2],a=i[0],c=i[1],t.setPosition(cc._getAbsolutePosition(a,c,s,this.getContainerSize(t.getParent()),e));else if("scale"===e)s=this._getBaseValue(t,e)[2],a=i[0],c=i[1],cc.setRelativeScale(t,a,c,s,e);else if("skew"===e)a=i[0],c=i[1],t.setSkewX(a),t.setSkewY(c);else if("rotation"===e)t.setRotation(i);else if("rotationX"==e)t.setRotationSkewX(i);else if("rotationY"==e)t.setRotationSkewY(i);else if("opacity"===e)t.setOpacity(i);else if("displayFrame"===e)t.setSpriteFrame(i);else if("color"===e){var l=i.getColor();255===l.r&&255===l.g&&255===l.b||t.setColor(l)}else"visible"===e?(i=i||!1,t.setVisible(i)):cc.log("unsupported property name is "+e)}},_setFirstFrame:function(e,t,i){var n=t.getKeyframes();if(0===n.length){var r=this._getBaseValue(e,t.getName());r||cc.log("cc.BuilderAnimationManager._setFirstFrame(): No baseValue found for property"),this._setAnimatedProperty(t.getName(),e,r,i)}else{var o=n[0];this._setAnimatedProperty(t.getName(),e,o.getValue(),i)}},_getEaseAction:function(e,t,i){return t===CCB_KEYFRAME_EASING_LINEAR||t===CCB_KEYFRAME_EASING_INSTANT?e:t===CCB_KEYFRAME_EASING_CUBIC_IN?e.easing(cc.easeIn(i)):t===CCB_KEYFRAME_EASING_CUBIC_OUT?e.easing(cc.easeOut(i)):t===CCB_KEYFRAME_EASING_CUBIC_INOUT?e.easing(cc.easeInOut(i)):t===CCB_KEYFRAME_EASING_BACK_IN?e.easing(cc.easeBackIn()):t===CCB_KEYFRAME_EASING_BACK_OUT?e.easing(cc.easeBackOut()):t===CCB_KEYFRAME_EASING_BACK_INOUT?e.easing(cc.easeBackInOut()):t===CCB_KEYFRAME_EASING_BOUNCE_IN?e.easing(cc.easeBounceIn()):t===CCB_KEYFRAME_EASING_BOUNCE_OUT?e.easing(cc.easeBounceOut()):t===CCB_KEYFRAME_EASING_BOUNCE_INOUT?e.easing(cc.easeBounceInOut()):t===CCB_KEYFRAME_EASING_ELASTIC_IN?e.easing(cc.easeElasticIn(i)):t===CCB_KEYFRAME_EASING_ELASTIC_OUT?e.easing(cc.easeElasticOut(i)):t===CCB_KEYFRAME_EASING_ELASTIC_INOUT?e.easing(cc.easeElasticInOut(i)):(cc.log("BuilderReader: Unkown easing type "+t),e)},_runAction:function(e,t,i){var n=t.getKeyframes(),r=n.length;if(r>1){var o=[],s=n[0].getTime()+i;s>0&&o.push(cc.delayTime(s));for(var a=0;a<r-1;++a){var c=n[a],l=n[a+1],u=this._getAction(c,l,t.getName(),e);u&&(u=this._getEaseAction(u,c.getEasingType(),c.getEasingOpt()),o.push(u))}e.runAction(cc.sequence(o))}},_sequenceCompleted:function(){var e=this._runningSequence,t=e.getName();this._lastCompletedSequenceName!=e.getName()&&(this._lastCompletedSequenceName=e.getName());var i=e.getChainedSequenceId();this._runningSequence=null,-1!=i&&this.runAnimations(i,0),this._delegate&&this._delegate.completedAnimationSequenceNamed(t),this._target&&this._animationCompleteCallbackFunc&&this._animationCompleteCallbackFunc.call(this._target)}}),cc.BuilderSetSpriteFrame=cc.ActionInstant.extend({_spriteFrame:null,initWithSpriteFrame:function(e){return this._spriteFrame=e,!0},update:function(e){this.target.setSpriteFrame(this._spriteFrame)}}),cc.BuilderSetSpriteFrame.create=function(e){var t=new cc.BuilderSetSpriteFrame;return t&&t.initWithSpriteFrame(e)?t:null},cc.BuilderRotateTo=cc.ActionInterval.extend({_startAngle:0,_dstAngle:0,_diffAngle:0,initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._dstAngle=t,!0)},update:function(e){this.target.setRotation(this._startAngle+this._diffAngle*e)},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._startAngle=this.target.getRotation(),this._diffAngle=this._dstAngle-this._startAngle}}),cc.BuilderRotateTo.create=function(e,t){var i=new cc.BuilderRotateTo;return i&&i.initWithDuration(e,t)?i:null},cc.BuilderRotateXTo=cc.ActionInterval.extend({}),cc.BuilderRotateXTo.create=function(e,t){throw"rotationX has not been implemented in cocos2d-html5"},cc.BuilderRotateYTo=cc.ActionInterval.extend({}),cc.BuilderRotateYTo.create=function(e,t){throw"rotationY has not been implemented in cocos2d-html5"},cc.BuilderSoundEffect=cc.ActionInstant.extend({init:function(e){return this._file=e,!0},update:function(e){cc.audioEngine.playEffect(this._file)}}),cc.BuilderSoundEffect.create=function(e,t,i,n){var r=new cc.BuilderSoundEffect;return r&&r.init(e)?r:null},cc.DOM={},cc.DOM._addMethods=function(e){for(var t in cc.DOM.methods)e[t]=cc.DOM.methods[t];cc.defineGetterSetter(e,"x",e.getPositionX,e.setPositionX),cc.defineGetterSetter(e,"y",e.getPositionY,e.setPositionY),cc.defineGetterSetter(e,"width",e._getWidth,e._setWidth),cc.defineGetterSetter(e,"height",e._getHeight,e._setHeight),cc.defineGetterSetter(e,"anchorX",e._getAnchorX,e._setAnchorX),cc.defineGetterSetter(e,"anchorY",e._getAnchorY,e._setAnchorY),cc.defineGetterSetter(e,"scale",e.getScale,e.setScale),cc.defineGetterSetter(e,"scaleX",e.getScaleX,e.setScaleX),cc.defineGetterSetter(e,"scaleY",e.getScaleY,e.getScaleY),cc.defineGetterSetter(e,"rotation",e.getRotation,e.setRotation),cc.defineGetterSetter(e,"skewX",e.getSkewX,e.setSkewX),cc.defineGetterSetter(e,"skewY",e.getSkewY,e.setSkewY),cc.defineGetterSetter(e,"visible",e.isVisible,e.setVisible),cc.defineGetterSetter(e,"parent",e.getParent,e.setParent),cc.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity)},cc.DOM.methods={setPosition:function(e,t){void 0===t?(this._position.x=e.x,this._position.y=e.y):(this._position.x=e,this._position.y=t),this.setNodeDirty(),this.dom.translates(this._position.x,-this._position.y)},setPositionY:function(e){this._position.y=e,this.setNodeDirty(),this.dom.translates(this._position.x,-this._position.y)},setPositionX:function(e){this._position.x=e,this.setNodeDirty(),this.dom.translates(this._position.x,-this._position.y)},setScale:function(e,t){this._scaleX=e,this._scaleY=t||e,this.setNodeDirty(),this.dom.resize(this._scaleX,this._scaleY)},setScaleX:function(e){this._scaleX=e,this.setNodeDirty(),this.dom.resize(this._scaleX,this._scaleY)},setScaleY:function(e){this._scaleY=e,this.setNodeDirty(),this.dom.resize(this._scaleX,this._scaleY)},setAnchorPoint:function(e,t){var i=this._renderCmd,n=this._anchorPoint;void 0===t?(n.x=e.x,n.y=e.y):(n.x=e,n.y=t);var r=i._anchorPointInPoints,o=this._contentSize;r.x=o.width*n.x,r.y=o.height*n.y,this.dom.style[cc.$.pfx+"TransformOrigin"]=r.x+"px "+-r.y+"px",this.ignoreAnchor?(this.dom.style.marginLeft=0,this.dom.style.marginBottom=0):(this.dom.style.marginLeft=this.isToggler?0:-r.x+"px",this.dom.style.marginBottom=-r.y+"px"),this.setNodeDirty()},_setAnchorX:function(e){var t=this._anchorPoint,i=this._renderCmd;if(e!==t.x){t.x=e;var n=i._anchorPointInPoints,r=this._contentSize;n.x=r.width*t.x,this.dom.style[cc.$.pfx+"TransformOrigin"]=n.x+"px "+-n.y+"px",this.ignoreAnchor?(this.dom.style.marginLeft=0,this.dom.style.marginBottom=0):this.dom.style.marginLeft=this.isToggler?0:-n.x+"px",this.setNodeDirty()}},_setAnchorY:function(e){var t=this._anchorPoint,i=this._renderCmd;if(e!==t.y){t.y=e;var n=i._anchorPointInPoints,r=this._contentSize;n.y=r.height*t.y,this.dom.style[cc.$.pfx+"TransformOrigin"]=n.x+"px "+-n.y+"px",this.ignoreAnchor?(this.dom.style.marginLeft=0,this.dom.style.marginBottom=0):this.dom.style.marginBottom=-n.y+"px",this.setNodeDirty()}},setContentSize:function(e,t){var i=this._renderCmd,n=this._contentSize;void 0===t?(n.width=e.width,n.height=e.height):(n.width=e,n.height=t);var r=i._anchorPointInPoints,o=this._anchorPoint;r.x=n.width*o.x,r.y=n.height*o.y,this.dom.width=n.width,this.dom.height=n.height,this.setAnchorPoint(this.getAnchorPoint()),this.canvas&&(this.canvas.width=n.width,this.canvas.height=n.height),this.setNodeDirty(),this.redraw()},_setWidth:function(e){var t=this._contentSize,i=this._renderCmd;if(e!==t.width){t.width=e;var n=i._anchorPointInPoints,r=this._anchorPoint;n.x=t.width*r.x,this.dom.width=t.width,this.anchorX=r.x,this.canvas&&(this.canvas.width=t.width),this.setNodeDirty(),this.redraw()}},_setHeight:function(e){var t=this._contentSize,i=this._renderCmd;if(e!==t.height){t.height=e;var n=i._anchorPointInPoints,r=this._anchorPoint;n.y=t.height*r.y,this.dom.height=t.height,this.anchorY=r.y,this.canvas&&(this.canvas.height=t.height),this.setNodeDirty(),this.redraw()}},setRotation:function(e){this._rotation!=e&&(this._rotationX=this._rotationY=e,this.setNodeDirty(),this.dom.rotate(e))},setSkewX:function(e){this._skewX=e,this.setNodeDirty(),this.dom.setSkew(this._skewX,this._skewY)},setSkewY:function(e){this._skewY=e,this.setNodeDirty(),this.dom.setSkew(this._skewX,this._skewY)},setVisible:function(e){this._visible=e,this.setNodeDirty(),this.dom&&(this.dom.style.display=e?"block":"none")},_setLocalZOrder:function(e){this._localZOrder=e,this.setNodeDirty(),this.dom&&(this.dom.zIndex=e)},setParent:function(e){this._parent=e,null!==e&&(e.setAnchorPoint(e.getAnchorPoint()),this.setNodeDirty(),cc.DOM.parentDOM(this))},resume:function(){this.getScheduler().resumeTarget(this),this.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this),this.dom&&!this.dom.parentNode&&(this.getParent()?cc.DOM.parentDOM(this):""==this.dom.id?cc.DOM._createEGLViewDiv(this):this.dom.appendTo(cc.container)),this.dom&&(this.dom.style.visibility="visible")},pause:function(){this.getScheduler().pauseTarget(this),this.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this),this.dom&&(this.dom.style.visibility="hidden")},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.cleanup),this.dom&&this.dom.remove()},removeFromParentAndCleanup:function(){this.dom.remove()},setOpacity:function(e){this._opacity=e,this.dom.style.opacity=e/255},redraw:function(){if(this.isSprite){var e=this._children;this._children=[],cc.Sprite.prototype.visit.call(this,this.ctx),this._children=e}else cc.Sprite.prototype.visit.call(this,this.ctx)}},cc.DOM._resetEGLViewDiv=function(){var e=cc.$("#EGLViewDiv");if(e){var t=cc.view,i=t.getDesignResolutionSize(),n=t.getViewPortRect(),r=t.getFrameSize(),o=t.getDevicePixelRatio(),s=i.width,a=i.height;0===i.width&&0===i.height&&(s=r.width,a=r.height);n.width;0===n.width&&0===n.height&&r.width,e.style.position="absolute",e.style.width=s+"px",e.style.maxHeight=a+"px",e.style.margin=0,e.resize(t.getScaleX()/o,t.getScaleY()/o),t.getResolutionPolicy()==t._rpNoBorder?(e.style.left=(t.getFrameSize().width-s)/2+"px",e.style.bottom=(t.getFrameSize().height-a*t.getScaleY()/o)/2+"px"):(e.style.left=(s*t.getScaleX()/o-s)/2+"px",e.style.bottom="0px")}},cc.DOM.parentDOM=function(e){var t=e.getParent();if(!t||!e.dom)return!1;if(t.dom||(cc.DOM.placeHolder(t),t.setParent=cc.DOM.methods.setParent),e.dom.appendTo(t.dom),t.setAnchorPoint(t.getAnchorPoint()),t.getParent())cc.DOM.parentDOM(t);else if(t.isRunning()){var i=cc.$("#EGLViewDiv");i?t.dom.appendTo(i):cc.DOM._createEGLViewDiv(t)}return!0},cc.DOM._createEGLViewDiv=function(e){var t=cc.$("#EGLViewDiv");t||((t=cc.$new("div")).id="EGLViewDiv");var i=cc.view,n=i.getDesignResolutionSize(),r=i.getViewPortRect(),o=i.getFrameSize(),s=i.getDevicePixelRatio(),a=n.width,c=n.height;0===n.width&&0===n.height&&(a=o.width,c=o.height);r.width;0===r.width&&0===r.height&&o.width,t.style.position="absolute",t.style.width=a+"px",t.style.maxHeight=c+"px",t.style.margin=0,t.resize(i.getScaleX()/s,i.getScaleY()/s),i.getResolutionPolicy()==i._rpNoBorder?(t.style.left=(o.width-a)/2+"px",t.style.bottom=(o.height-c*i.getScaleY()/s)/2+"px"):(t.style.left=(a*i.getScaleX()/s-a)/2+"px",t.style.bottom="0px"),e.dom.appendTo(t),t.appendTo(cc.container)},cc.DOM.setTransform=function(e){if(e.ctx)if(e.ctx.translate(e.getAnchorPointInPoints().x,e.getAnchorPointInPoints().y),e.isSprite){var t=e._children;e._children=[],cc.Sprite.prototype.visit.call(e),e._children=t}else cc.Sprite.prototype.visit.call(e);e.dom&&(e.dom.position.x=e.getPositionX(),e.dom.position.y=-e.getPositionY(),e.dom.rotation=e.getRotation(),e.dom.scale={x:e.getScaleX(),y:e.getScaleY()},e.dom.skew={x:e.getSkewX(),y:e.getSkewY()},e.setAnchorPoint&&e.setAnchorPoint(e.getAnchorPoint()),e.dom.transforms())},cc.DOM.forSprite=function(e){e.dom=cc.$new("div"),e.canvas=cc.$new("canvas");var t=e.getContentSize();e.canvas.width=t.width,e.canvas.height=t.height,e.dom.style.position="absolute",e.dom.style.bottom=0,e.ctx=e.canvas.getContext("2d"),e.dom.appendChild(e.canvas),e.getParent()&&cc.DOM.parentDOM(e),e.isSprite=!0},cc.DOM.placeHolder=function(e){e.dom=cc.$new("div"),e.placeholder=!0,e.dom.style.position="absolute",e.dom.style.bottom=0,e.dom.style.width=(e.getContentSize().width||cc.director.getWinSize().width)+"px",e.dom.style.maxHeight=(e.getContentSize().height||cc.director.getWinSize().height)+"px",e.dom.style.margin=0,cc.DOM.setTransform(e),e.dom.transforms(),cc.DOM._addMethods(e)},cc.DOM.convert=function(e){if(arguments.length>1)cc.DOM.convert(arguments);else if(1!=arguments.length||arguments[0].length)for(var t=arguments[0],i=0;i<t.length;i++)t[i]instanceof cc.Sprite?t[i].dom||cc.DOM.forSprite(t[i]):cc.log("DOM converter only supports sprite and menuitems yet"),cc.DOM._addMethods(t[i]),t[i].visit=function(){},t[i].transform=function(){},cc.DOM.setTransform(t[i]),t[i].setVisible(t[i].isVisible());else cc.DOM.convert([arguments[0]])},cc.KEYBOARD_RETURNTYPE_DEFAULT=0,cc.KEYBOARD_RETURNTYPE_DONE=1,cc.KEYBOARD_RETURNTYPE_SEND=2,cc.KEYBOARD_RETURNTYPE_SEARCH=3,cc.KEYBOARD_RETURNTYPE_GO=4,cc.EDITBOX_INPUT_MODE_ANY=0,cc.EDITBOX_INPUT_MODE_EMAILADDR=1,cc.EDITBOX_INPUT_MODE_NUMERIC=2,cc.EDITBOX_INPUT_MODE_PHONENUMBER=3,cc.EDITBOX_INPUT_MODE_URL=4,cc.EDITBOX_INPUT_MODE_DECIMAL=5,cc.EDITBOX_INPUT_MODE_SINGLELINE=6,cc.EDITBOX_INPUT_FLAG_PASSWORD=0,cc.EDITBOX_INPUT_FLAG_SENSITIVE=1,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD=2,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE=3,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS=4,cc.EditBoxDelegate=cc.Class.extend({editBoxEditingDidBegin:function(e){},editBoxEditingDidEnd:function(e){},editBoxTextChanged:function(e,t){},editBoxReturn:function(e){}}),cc.EditBox=cc.ControlButton.extend({_domInputSprite:null,_delegate:null,_editBoxInputMode:cc.EDITBOX_INPUT_MODE_ANY,_editBoxInputFlag:cc.EDITBOX_INPUT_FLAG_SENSITIVE,_keyboardReturnType:cc.KEYBOARD_RETURNTYPE_DEFAULT,_text:"",_placeholderText:"",_textColor:null,_placeholderColor:null,_maxLength:50,_adjustHeight:18,_edTxt:null,_edFontSize:14,_edFontName:"Arial",_placeholderFontName:"",_placeholderFontSize:14,_tooltip:!1,_className:"EditBox",ctor:function(e,t,i,n){cc.ControlButton.prototype.ctor.call(this),this._textColor=cc.color.WHITE,this._placeholderColor=cc.color.GRAY,this.setContentSize(e);var r=this._domInputSprite=new cc.Sprite;r.draw=function(){},this.addChild(r);var o=this,s=this._edTxt=cc.newElement("input");s.type="text",s.style.fontSize=this._edFontSize+"px",s.style.color="#000000",s.style.border=0,s.style.background="transparent",s.style.width="100%",s.style.height="100%",s.style.active=0,s.style.outline="medium",s.style.padding="0";var a=function(){s.blur()};cc._addEventListener(s,"input",function(){o._delegate&&o._delegate.editBoxTextChanged&&o._delegate.editBoxTextChanged(o,this.value)}),cc._addEventListener(s,"keypress",function(e){e.keyCode===cc.KEY.enter&&(e.stopPropagation(),e.preventDefault(),cc._canvas.focus())}),cc._addEventListener(s,"focus",function(){this.value==o._placeholderText&&(this.value="",this.style.fontSize=o._edFontSize+"px",this.style.color=cc.colorToHex(o._textColor),o._editBoxInputFlag==cc.EDITBOX_INPUT_FLAG_PASSWORD?o._edTxt.type="password":o._edTxt.type="text"),o._delegate&&o._delegate.editBoxEditingDidBegin&&o._delegate.editBoxEditingDidBegin(o),cc._addEventListener(cc._canvas,"click",a)}),cc._addEventListener(s,"blur",function(){""==this.value&&(this.value=o._placeholderText,this.style.fontSize=o._placeholderFontSize+"px",this.style.color=cc.colorToHex(o._placeholderColor),o._edTxt.type="text"),o._delegate&&o._delegate.editBoxEditingDidEnd&&o._delegate.editBoxEditingDidEnd(o),o._delegate&&o._delegate.editBoxReturn&&o._delegate.editBoxReturn(o),cc._canvas.removeEventListener("click",a)}),cc.DOM.convert(r),r.dom.appendChild(s),r.dom.showTooltipDiv=!1,r.dom.style.width=e.width-6+"px",r.dom.style.height=e.height-6+"px",r.canvas.remove(),this.initWithSizeAndBackgroundSprite(e,t)&&(i&&this.setBackgroundSpriteForState(i,cc.CONTROL_STATE_HIGHLIGHTED),n&&this.setBackgroundSpriteForState(n,cc.CONTROL_STATE_DISABLED))},setFont:function(e,t){this._edFontSize=t,this._edFontName=e,this._setFontToEditBox()},_setFont:function(e){var t=cc.LabelTTF._fontStyleRE.exec(e);t&&(this._edFontSize=parseInt(t[1]),this._edFontName=t[2],this._setFontToEditBox())},setFontName:function(e){this._edFontName=e,this._setFontToEditBox()},setFontSize:function(e){this._edFontSize=e,this._setFontToEditBox()},_setFontToEditBox:function(){this._edTxt.value!=this._placeholderText&&(this._edTxt.style.fontFamily=this._edFontName,this._edTxt.style.fontSize=this._edFontSize+"px",this._editBoxInputFlag==cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text")},setText:function(e){cc.log("Please use the setString"),this.setString(e)},setString:function(e){null!=e&&(""==e?(this._edTxt.value=this._placeholderText,this._edTxt.style.color=cc.colorToHex(this._placeholderColor),this._edTxt.type="text"):(this._edTxt.value=e,this._edTxt.style.color=cc.colorToHex(this._textColor),this._editBoxInputFlag==cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text"))},setFontColor:function(e){this._textColor=e,this._edTxt.value!=this._placeholderText&&(this._edTxt.style.color=cc.colorToHex(e))},setMaxLength:function(e){!isNaN(e)&&e>0&&(this._maxLength=e,this._edTxt.maxLength=e)},getMaxLength:function(){return this._maxLength},setPlaceHolder:function(e){if(null!=e){var t=this._placeholderText;this._placeholderText=e,this._edTxt.value==t&&(this._edTxt.value=e,this._edTxt.style.color=cc.colorToHex(this._placeholderColor),this._setPlaceholderFontToEditText())}},setPlaceholderFont:function(e,t){this._placeholderFontName=e,this._placeholderFontSize=t,this._setPlaceholderFontToEditText()},_setPlaceholderFont:function(e){var t=cc.LabelTTF._fontStyleRE.exec(e);t&&(this._placeholderFontName=t[2],this._placeholderFontSize=parseInt(t[1]),this._setPlaceholderFontToEditText())},setPlaceholderFontName:function(e){this._placeholderFontName=e,this._setPlaceholderFontToEditText()},setPlaceholderFontSize:function(e){this._placeholderFontSize=e,this._setPlaceholderFontToEditText()},_setPlaceholderFontToEditText:function(){this._edTxt.value==this._placeholderText&&(this._edTxt.style.fontFamily=this._placeholderFontName,this._edTxt.style.fontSize=this._placeholderFontSize+"px",this._edTxt.type="text")},setPlaceholderFontColor:function(e){this._placeholderColor=e,this._edTxt.value==this._placeholderText&&(this._edTxt.style.color=cc.colorToHex(e))},setInputFlag:function(e){this._editBoxInputFlag=e,this._edTxt.value!==this._placeholderText&&e==cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text"},getText:function(){return cc.log("Please use the getString"),this._edTxt.value},getString:function(){return this._edTxt.value===this._placeholderText?"":this._edTxt.value},initWithSizeAndBackgroundSprite:function(e,t){return!!this.initWithBackgroundSprite(t)&&(this._domInputSprite.x=3,this._domInputSprite.y=3,this.setZoomOnTouchDown(!1),this.setPreferredSize(e),this.x=0,this.y=0,this._addTargetWithActionForControlEvent(this,this.touchDownAction,cc.CONTROL_EVENT_TOUCH_UP_INSIDE),!0)},setDelegate:function(e){this._delegate=e},getPlaceHolder:function(){return this._placeholderText},setInputMode:function(e){this._editBoxInputMode=e},setReturnType:function(e){this._keyboardReturnType=e},keyboardWillShow:function(e){var t=cc.EditBox.getRect(this);t.y-=4,t.intersectsRect(e.end)?this._adjustHeight=e.end.getMaxY()-t.getMinY():cc.log("needn't to adjust view layout.")},keyboardDidShow:function(e){},keyboardWillHide:function(e){},keyboardDidHide:function(e){},touchDownAction:function(e,t){},initWithBackgroundColor:function(e,t){this._edWidth=e.width,this.dom.style.width=this._edWidth.toString()+"px",this._edHeight=e.height,this.dom.style.height=this._edHeight.toString()+"px",this.dom.style.backgroundColor=cc.colorToHex(t)}}),(_p=cc.EditBox.prototype).font,cc.defineGetterSetter(_p,"font",null,_p._setFont),_p.fontName,cc.defineGetterSetter(_p,"fontName",null,_p.setFontName),_p.fontSize,cc.defineGetterSetter(_p,"fontSize",null,_p.setFontSize),_p.fontColor,cc.defineGetterSetter(_p,"fontColor",null,_p.setFontColor),_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.maxLength,cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength),_p.placeHolder,cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),_p.placeHolderFont,cc.defineGetterSetter(_p,"placeHolderFont",null,_p._setPlaceholderFont),_p.placeHolderFontName,cc.defineGetterSetter(_p,"placeHolderFontName",null,_p.setPlaceholderFontName),_p.placeHolderFontSize,cc.defineGetterSetter(_p,"placeHolderFontSize",null,_p.setPlaceholderFontSize),_p.placeHolderFontColor,cc.defineGetterSetter(_p,"placeHolderFontColor",null,_p.setPlaceholderFontColor),_p.inputFlag,cc.defineGetterSetter(_p,"inputFlag",null,_p.setInputFlag),_p.delegate,cc.defineGetterSetter(_p,"delegate",null,_p.setDelegate),_p.inputMode,cc.defineGetterSetter(_p,"inputMode",null,_p.setInputMode),_p.returnType,cc.defineGetterSetter(_p,"returnType",null,_p.setReturnType),_p=null,cc.EditBox.getRect=function(e){var t=e.getContentSize(),i=cc.rect(0,0,t.width,t.height);return cc.rectApplyAffineTransform(i,e.getNodeToWorldTransform())},cc.EditBox.create=function(e,t,i,n){return new cc.EditBox(e,t,i,n)};var ccui=ccui||{};ccui.Class=ccui.Class||cc.Class,ccui.Class.extend=ccui.Class.extend||cc.Class.extend,ccui.Node=ccui.Node||cc.Node,ccui.Node.extend=ccui.Node.extend||cc.Node.extend,ccui.ProtectedNode=ccui.ProtectedNode||cc.ProtectedNode,ccui.ProtectedNode.extend=ccui.ProtectedNode.extend||cc.ProtectedNode.extend,ccui.cocosGUIVersion="CocosGUI v1.0.0.0",ccui._FocusNavigationController=cc.Class.extend({_keyboardListener:null,_firstFocusedWidget:null,_enableFocusNavigation:!1,_keyboardEventPriority:1,enableFocusNavigation:function(e){this._enableFocusNavigation!=e&&(this._enableFocusNavigation=e,e?this._addKeyboardEventListener():this._removeKeyboardEventListener())},_setFirstFocsuedWidget:function(e){this._firstFocusedWidget=e},_onKeyPressed:function(e,t){this._enableFocusNavigation&&this._firstFocusedWidget&&(e==cc.KEY.dpadDown&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.DOWN,this._firstFocusedWidget)),e==cc.KEY.dpadUp&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.UP,this._firstFocusedWidget)),e==cc.KEY.dpadLeft&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.LEFT,this._firstFocusedWidget)),e==cc.KEY.dpadRight&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.RIGHT,this._firstFocusedWidget)))},_addKeyboardEventListener:function(){this._keyboardListener||(this._keyboardListener=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyReleased:this._onKeyPressed.bind(this)}),cc.eventManager.addListener(this._keyboardListener,this._keyboardEventPriority))},_removeKeyboardEventListener:function(){this._keyboardListener&&(cc.eventManager.removeEventListener(this._keyboardListener),this._keyboardListener=null)}}),ccui.__LAYOUT_COMPONENT_NAME="__ui_layout",ccui.Widget=ccui.ProtectedNode.extend({_enabled:!0,_bright:!0,_touchEnabled:!1,_brightStyle:null,_touchBeganPosition:null,_touchMovePosition:null,_touchEndPosition:null,_touchEventListener:null,_touchEventSelector:null,_name:"default",_widgetType:null,_actionTag:0,_customSize:null,_layoutParameterDictionary:null,_layoutParameterType:0,_focused:!1,_focusEnabled:!0,_ignoreSize:!1,_affectByClipping:!1,_sizeType:null,_sizePercent:null,_positionType:null,_positionPercent:null,_hit:!1,_nodes:null,_touchListener:null,_className:"Widget",_flippedX:!1,_flippedY:!1,_opacity:255,_highlight:!1,_touchEventCallback:null,_clickEventListener:null,_propagateTouchEvents:!0,_unifySize:!1,_callbackName:null,_callbackType:null,_usingLayoutComponent:!1,ctor:function(){cc.ProtectedNode.prototype.ctor.call(this),this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this._touchBeganPosition=cc.p(0,0),this._touchMovePosition=cc.p(0,0),this._touchEndPosition=cc.p(0,0),this._widgetType=ccui.Widget.TYPE_WIDGET,this._customSize=cc.size(0,0),this._layoutParameterDictionary={},this._sizeType=ccui.Widget.SIZE_ABSOLUTE,this._sizePercent=cc.p(0,0),this._positionType=ccui.Widget.POSITION_ABSOLUTE,this._positionPercent=cc.p(0,0),this._nodes=[],this._layoutParameterType=ccui.LayoutParameter.NONE,this.init()},init:function(){return!!cc.ProtectedNode.prototype.init.call(this)&&(this._layoutParameterDictionary={},this._initRenderer(),this.setBright(!0),this.onFocusChanged=this.onFocusChange.bind(this),this.onNextFocusedWidget=null,this.setAnchorPoint(cc.p(.5,.5)),this.ignoreContentAdaptWithSize(!0),!0)},onEnter:function(){var e=this._touchListener;e&&!e._isRegistered()&&this._touchEnabled&&cc.eventManager.addListener(e,this),this._usingLayoutComponent||this.updateSizeAndPosition(),cc.ProtectedNode.prototype.onEnter.call(this)},onExit:function(){this.unscheduleUpdate(),cc.ProtectedNode.prototype.onExit.call(this)},_getOrCreateLayoutComponent:function(){var e=this.getComponent(ccui.__LAYOUT_COMPONENT_NAME);return null==e&&(e=new ccui.LayoutComponent,this.addComponent(e)),e},getWidgetParent:function(){var e=this.getParent();return e instanceof ccui.Widget?e:null},_updateContentSizeWithTextureSize:function(e){this._unifySize?this.setContentSize(e):this.setContentSize(this._ignoreSize?e:this._customSize)},_isAncestorsEnabled:function(){var e=this._getAncensterWidget(this);return null==e||!(e&&!e.isEnabled())&&e._isAncestorsEnabled()},setPropagateTouchEvents:function(e){this._propagateTouchEvents=e},isPropagateTouchEvents:function(){return this._propagateTouchEvents},setSwallowTouches:function(e){this._touchListener&&this._touchListener.setSwallowTouches(e)},isSwallowTouches:function(){return!!this._touchListener&&this._touchListener.isSwallowTouches()},_getAncensterWidget:function(e){if(null==e)return null;var t=e.getParent();return null==t?null:t instanceof ccui.Widget?t:this._getAncensterWidget(t.getParent())},_isAncestorsVisible:function(e){if(null==e)return!0;var t=e.getParent();return!(t&&!t.isVisible())&&this._isAncestorsVisible(t)},_cleanupWidget:function(){this._eventDispatcher.removeEventListener(this._touchListener),this._touchEnabled=!1,this._touchListener=null,ccui.Widget._focusedWidget==this&&(ccui.Widget._focusedWidget=null,ccui.Widget._focusNavigationController=null)},setEnabled:function(e){this._enabled=e},_initRenderer:function(){},setContentSize:function(e,t){var i=void 0===t?e.width:e,n=void 0===t?e.height:t;if(cc.Node.prototype.setContentSize.call(this,i,n),this._customSize.width=i,this._customSize.height=n,this._unifySize||this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running){var r=this.getWidgetParent(),o=r?r.getContentSize():this._parent.getContentSize();this._sizePercent.x=o.width>0?i/o.width:0,this._sizePercent.y=o.height>0?n/o.height:0}this._onSizeChanged()},_setWidth:function(e){if(cc.Node.prototype._setWidth.call(this,e),this._customSize.width=e,this._unifySize||this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running){var t=this.getWidgetParent(),i=t?t.width:this._parent.width;this._sizePercent.x=i>0?this._customSize.width/i:0}this._onSizeChanged()},_setHeight:function(e){if(cc.Node.prototype._setHeight.call(this,e),this._customSize.height=e,this._unifySize||this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running){var t=this.getWidgetParent(),i=t?t.height:this._parent.height;this._sizePercent.y=i>0?this._customSize.height/i:0}this._onSizeChanged()},setSizePercent:function(e){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();return t.setUsingPercentContentSize(!0),t.setPercentContentSize(e),void t.refreshLayout()}this._sizePercent.x=e.x,this._sizePercent.y=e.y;var i=this._customSize.width,n=this._customSize.height;if(this._running){var r=this.getWidgetParent();r?(i=r.width*e.x,n=r.height*e.y):(i=this._parent.width*e.x,n=this._parent.height*e.y)}this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(i,n),this._customSize.width=i,this._customSize.height=n},_setWidthPercent:function(e){this._sizePercent.x=e;var t=this._customSize.width;if(this._running){var i=this.getWidgetParent();t=(i?i.width:this._parent.width)*e}this._ignoreSize?this._setWidth(this.getVirtualRendererSize().width):this._setWidth(t),this._customSize.width=t},_setHeightPercent:function(e){this._sizePercent.y=e;var t=this._customSize.height;if(this._running){var i=this.getWidgetParent();t=(i?i.height:this._parent.height)*e}this._ignoreSize?this._setHeight(this.getVirtualRendererSize().height):this._setHeight(t),this._customSize.height=t},updateSizeAndPosition:function(e){if(!e){var t=this.getWidgetParent();e=t?t.getLayoutSize():this._parent.getContentSize()}switch(this._sizeType){case ccui.Widget.SIZE_ABSOLUTE:this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(this._customSize),this._sizePercent.x=e.width>0?this._customSize.width/e.width:0,this._sizePercent.y=e.height>0?this._customSize.height/e.height:0;break;case ccui.Widget.SIZE_PERCENT:var i=cc.size(e.width*this._sizePercent.x,e.height*this._sizePercent.y);this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(i),this._customSize.width=i.width,this._customSize.height=i.height}this._onSizeChanged();var n=this.getPosition();switch(this._positionType){case ccui.Widget.POSITION_ABSOLUTE:e.width<=0||e.height<=0?this._positionPercent.x=this._positionPercent.y=0:(this._positionPercent.x=n.x/e.width,this._positionPercent.y=n.y/e.height);break;case ccui.Widget.POSITION_PERCENT:n=cc.p(e.width*this._positionPercent.x,e.height*this._positionPercent.y)}if(this._parent instanceof ccui.ImageView){var r=this._parent._imageRenderer;if(r&&!r._textureLoaded)return}this.setPosition(n)},setSizeType:function(e){this._sizeType=e,this._usingLayoutComponent&&this._getOrCreateLayoutComponent().setUsingPercentContentSize(this._sizeType==ccui.SIZE_PERCENT)},getSizeType:function(){return this._sizeType},ignoreContentAdaptWithSize:function(e){this._unifySize?this.setContentSize(this._customSize):this._ignoreSize!=e&&(this._ignoreSize=e,this.setContentSize(e?this.getVirtualRendererSize():this._customSize))},isIgnoreContentAdaptWithSize:function(){return this._ignoreSize},getCustomSize:function(){return cc.size(this._customSize)},getLayoutSize:function(){return cc.size(this._contentSize)},getSizePercent:function(){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();this._sizePercent=e.getPercentContentSize()}return this._sizePercent},_getWidthPercent:function(){return this._sizePercent.x},_getHeightPercent:function(){return this._sizePercent.y},getWorldPosition:function(){return this.convertToWorldSpace(cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},getVirtualRenderer:function(){return this},getVirtualRendererSize:function(){return cc.size(this._contentSize)},_onSizeChanged:function(){if(!this._usingLayoutComponent)for(var e=this.getChildren(),t=0,i=e.length;t<i;t++){var n=e[t];n instanceof ccui.Widget&&n.updateSizeAndPosition()}},setTouchEnabled:function(e){this._touchEnabled!==e&&(this._touchEnabled=e,this._touchEnabled?(this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this)})),cc.eventManager.addListener(this._touchListener,this)):cc.eventManager.removeListener(this._touchListener))},isTouchEnabled:function(){return this._touchEnabled},isHighlighted:function(){return this._highlight},setHighlighted:function(e){e!=this._highlight&&(this._highlight=e,this._bright?this._highlight?this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT):this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL):this._onPressStateChangedToDisabled())},isFocused:function(){return this._focused},setFocused:function(e){this._focused=e,e&&(ccui.Widget._focusedWidget=this,ccui.Widget._focusNavigationController&&ccui.Widget._focusNavigationController._setFirstFocsuedWidget(this))},isFocusEnabled:function(){return this._focusEnabled},setFocusEnabled:function(e){this._focusEnabled=e},findNextFocusedWidget:function(e,t){if(null==this.onNextFocusedWidget||null==this.onNextFocusedWidget(e)){var i=t instanceof ccui.Layout;if(this.isFocused()||i){var n=this.getParent();return null!=n&&n instanceof ccui.Layout?n.findNextFocusedWidget(e,t):i?t.findNextFocusedWidget(e,t):t}return t}var r=this.onNextFocusedWidget(e);return this.dispatchFocusEvent(this,r),r},requestFocus:function(){this!=ccui.Widget._focusedWidget&&this.dispatchFocusEvent(ccui.Widget._focusedWidget,this)},getCurrentFocusedWidget:function(){return ccui.Widget._focusedWidget},onFocusChanged:null,onNextFocusedWidget:null,interceptTouchEvent:function(e,t,i){var n=this.getWidgetParent();n&&n.interceptTouchEvent(e,t,i)},onFocusChange:function(e,t){e&&e.setFocused(!1),t&&t.setFocused(!0)},dispatchFocusEvent:function(e,t){e&&!e.isFocused()&&(e=ccui.Widget._focusedWidget),t!=e&&(t&&t.onFocusChanged&&t.onFocusChanged(e,t),e&&t.onFocusChanged&&e.onFocusChanged(e,t),cc.eventManager.dispatchEvent(new cc.EventFocus(e,t)))},setBright:function(e){this._bright=e,this._bright?(this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL)):this._onPressStateChangedToDisabled()},setBrightStyle:function(e){if(this._brightStyle!=e)switch(e=e||ccui.Widget.BRIGHT_STYLE_NORMAL,this._brightStyle=e,this._brightStyle){case ccui.Widget.BRIGHT_STYLE_NORMAL:this._onPressStateChangedToNormal();break;case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:this._onPressStateChangedToPressed()}},_onPressStateChangedToNormal:function(){},_onPressStateChangedToPressed:function(){},_onPressStateChangedToDisabled:function(){},_updateChildrenDisplayedRGBA:function(){this.setColor(this.getColor()),this.setOpacity(this.getOpacity())},didNotSelectSelf:function(){},onTouchBegan:function(e,t){if(this._hit=!1,this.isVisible()&&this.isEnabled()&&this._isAncestorsEnabled()&&this._isAncestorsVisible(this)){var i=e.getLocation();this._touchBeganPosition.x=i.x,this._touchBeganPosition.y=i.y,this.hitTest(this._touchBeganPosition)&&this.isClippingParentContainsPoint(this._touchBeganPosition)&&(this._hit=!0)}return!!this._hit&&(this.setHighlighted(!0),this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_BEGAN,this,e),this._pushDownEvent(),!0)},propagateTouchEvent:function(e,t,i){var n=this.getWidgetParent();n&&n.interceptTouchEvent(e,t,i)},onTouchMoved:function(e,t){var i=e.getLocation();this._touchMovePosition.x=i.x,this._touchMovePosition.y=i.y,this.setHighlighted(this.hitTest(i)),this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_MOVED,this,e),this._moveEvent()},onTouchEnded:function(e,t){var i=e.getLocation();this._touchEndPosition.x=i.x,this._touchEndPosition.y=i.y,this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_ENDED,this,e);var n=this._highlight;this.setHighlighted(!1),n?this._releaseUpEvent():this._cancelUpEvent()},onTouchCancelled:function(e){this.setHighlighted(!1),this._cancelUpEvent()},onTouchLongClicked:function(e){this.longClickEvent()},_pushDownEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_BEGAN),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_BEGAN)},_moveEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_MOVED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_MOVED)},_releaseUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_ENDED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_ENDED),this._clickEventListener&&this._clickEventListener(this)},_cancelUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_CANCELED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_CANCELED)},longClickEvent:function(){},addTouchEventListener:function(e,t){void 0===t?this._touchEventCallback=e:(this._touchEventSelector=e,this._touchEventListener=t)},addClickEventListener:function(e){this._clickEventListener=e},hitTest:function(e){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc.rectContainsPoint(t,this.convertToNodeSpace(e))},isClippingParentContainsPoint:function(e){this._affectByClipping=!1;for(var t=this.getParent(),i=null;t;){if(t instanceof ccui.Layout&&t.isClippingEnabled()){this._affectByClipping=!0,i=t;break}t=t.getParent()}return!this._affectByClipping||(!i||!!i.hitTest(e)&&i.isClippingParentContainsPoint(e))},checkChildInfo:function(e,t,i){var n=this.getWidgetParent();n&&n.checkChildInfo(e,t,i)},setPosition:function(e,t){if(!this._usingLayoutComponent&&this._running){var i=this.getWidgetParent();if(i){var n=i.getContentSize();n.width<=0||n.height<=0?(this._positionPercent.x=0,this._positionPercent.y=0):void 0==t?(this._positionPercent.x=e.x/n.width,this._positionPercent.y=e.y/n.height):(this._positionPercent.x=e/n.width,this._positionPercent.y=t/n.height)}}cc.Node.prototype.setPosition.call(this,e,t)},setPositionX:function(e){if(this._running){var t=this.getWidgetParent();if(t){var i=t.width;this._positionPercent.x=i<=0?0:e/i}}cc.Node.prototype.setPositionX.call(this,e)},setPositionY:function(e){if(this._running){var t=this.getWidgetParent();if(t){var i=t.height;this._positionPercent.y=i<=0?0:e/i}}cc.Node.prototype.setPositionY.call(this,e)},setPositionPercent:function(e){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();return t.setPositionPercentX(e.x),t.setPositionPercentY(e.y),void t.refreshLayout()}this._setXPercent(e.x),this._setYPercent(e.y),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},_setXPercent:function(e){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();return t.setPositionPercentX(e.x),void t.refreshLayout()}this._positionPercent.x=e},_setYPercent:function(e){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();return t.setPositionPercentY(e.x),void t.refreshLayout()}this._positionPercent.y=e},getPositionPercent:function(){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();this._positionPercent.x=e.getPositionPercentX(),this._positionPercent.y=e.getPositionPercentY()}return cc.p(this._positionPercent)},_getXPercent:function(){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();this._positionPercent.x=e.getPositionPercentX(),this._positionPercent.y=e.getPositionPercentY()}return this._positionPercent.x},_getYPercent:function(){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();this._positionPercent.x=e.getPositionPercentX(),this._positionPercent.y=e.getPositionPercentY()}return this._positionPercent.y},setPositionType:function(e){if(this._positionType=e,this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();e==ccui.POSITION_ABSOLUTE?(t.setPositionPercentXEnabled(!1),t.setPositionPercentYEnabled(!1)):(t.setPositionPercentXEnabled(!0),t.setPositionPercentYEnabled(!0))}this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionType:function(){return this._positionType},setFlippedX:function(e){var t=this.getScaleX();this._flippedX=e,this.setScaleX(t)},isFlippedX:function(){return this._flippedX},setFlippedY:function(e){var t=this.getScaleY();this._flippedY=e,this.setScaleY(t)},isFlippedY:function(){return this._flippedY},_adaptRenderers:function(){},isBright:function(){return this._bright},isEnabled:function(){return this._enabled},getLeftBoundary:function(){return this.getPositionX()-this._getAnchorX()*this._contentSize.width},getBottomBoundary:function(){return this.getPositionY()-this._getAnchorY()*this._contentSize.height},getRightBoundary:function(){return this.getLeftBoundary()+this._contentSize.width},getTopBoundary:function(){return this.getBottomBoundary()+this._contentSize.height},getTouchBeganPosition:function(){return cc.p(this._touchBeganPosition)},getTouchMovePosition:function(){return cc.p(this._touchMovePosition)},getTouchEndPosition:function(){return cc.p(this._touchEndPosition)},getWidgetType:function(){return this._widgetType},setLayoutParameter:function(e){e&&(this._layoutParameterDictionary[e.getLayoutType()]=e,this._layoutParameterType=e.getLayoutType())},getLayoutParameter:function(e){return e=e||this._layoutParameterType,this._layoutParameterDictionary[e]},getDescription:function(){return"Widget"},clone:function(){var e=this._createCloneInstance();return e._copyProperties(this),e._copyClonedWidgetChildren(this),e},_createCloneInstance:function(){return new ccui.Widget},_copyClonedWidgetChildren:function(e){for(var t=e.getChildren(),i=0;i<t.length;i++){var n=t[i];n instanceof ccui.Widget&&this.addChild(n.clone())}},_copySpecialProperties:function(e){},_copyProperties:function(e){this.setEnabled(e.isEnabled()),this.setVisible(e.isVisible()),this.setBright(e.isBright()),this.setTouchEnabled(e.isTouchEnabled()),this.setLocalZOrder(e.getLocalZOrder()),this.setTag(e.getTag()),this.setName(e.getName()),this.setActionTag(e.getActionTag()),this._ignoreSize=e._ignoreSize,this.setContentSize(e._contentSize),this._customSize.width=e._customSize.width,this._customSize.height=e._customSize.height,this._copySpecialProperties(e),this._sizeType=e.getSizeType(),this._sizePercent.x=e._sizePercent.x,this._sizePercent.y=e._sizePercent.y,this._positionType=e._positionType,this._positionPercent.x=e._positionPercent.x,this._positionPercent.y=e._positionPercent.y,this.setPosition(e.getPosition()),this.setAnchorPoint(e.getAnchorPoint()),this.setScaleX(e.getScaleX()),this.setScaleY(e.getScaleY()),this.setRotation(e.getRotation()),this.setRotationX(e.getRotationX()),this.setRotationY(e.getRotationY()),this.setFlippedX(e.isFlippedX()),this.setFlippedY(e.isFlippedY()),this.setColor(e.getColor()),this.setOpacity(e.getOpacity()),this._touchEventCallback=e._touchEventCallback,this._touchEventListener=e._touchEventListener,this._touchEventSelector=e._touchEventSelector,this._clickEventListener=e._clickEventListener,this._focused=e._focused,this._focusEnabled=e._focusEnabled,this._propagateTouchEvents=e._propagateTouchEvents;for(var t in e._layoutParameterDictionary){var i=e._layoutParameterDictionary[t];i&&this.setLayoutParameter(i.clone())}this._onSizeChanged()},setActionTag:function(e){this._actionTag=e},getActionTag:function(){return this._actionTag},getLeftInParent:function(){return cc.log("getLeftInParent is deprecated. Please use getLeftBoundary instead."),this.getLeftBoundary()},getBottomInParent:function(){return cc.log("getBottomInParent is deprecated. Please use getBottomBoundary instead."),this.getBottomBoundary()},getRightInParent:function(){return cc.log("getRightInParent is deprecated. Please use getRightBoundary instead."),this.getRightBoundary()},getTopInParent:function(){return cc.log("getTopInParent is deprecated. Please use getTopBoundary instead."),this.getTopBoundary()},getTouchEndPos:function(){return cc.log("getTouchEndPos is deprecated. Please use getTouchEndPosition instead."),this.getTouchEndPosition()},getTouchMovePos:function(){return cc.log("getTouchMovePos is deprecated. Please use getTouchMovePosition instead."),this.getTouchMovePosition()},clippingParentAreaContainPoint:function(e){cc.log("clippingParentAreaContainPoint is deprecated. Please use isClippingParentContainsPoint instead."),this.isClippingParentContainsPoint(e)},getTouchStartPos:function(){return cc.log("getTouchStartPos is deprecated. Please use getTouchBeganPosition instead."),this.getTouchBeganPosition()},setSize:function(e){this.setContentSize(e)},getSize:function(){return this.getContentSize()},addNode:function(e,t,i){e instanceof ccui.Widget?cc.log("Please use addChild to add a Widget."):(cc.Node.prototype.addChild.call(this,e,t,i),this._nodes.push(e))},getNodeByTag:function(e){for(var t=this._nodes,i=0;i<t.length;i++){var n=t[i];if(n&&n.getTag()==e)return n}return null},getNodes:function(){return this._nodes},removeNode:function(e,t){cc.Node.prototype.removeChild.call(this,e,t),cc.arrayRemoveObject(this._nodes,e)},removeNodeByTag:function(e,t){var i=this.getChildByTag(e);i?this.removeChild(i,t):cc.log("cocos2d: removeNodeByTag(tag = %d): child not found!",e)},removeAllNodes:function(){for(var e=0;e<this._nodes.length;e++){var t=this._nodes[e];cc.Node.prototype.removeChild.call(this,t)}this._nodes.length=0},_findLayout:function(){cc.renderer.childrenOrderDirty=!0;for(var e=this._parent;e;){if(e._doLayout){e._doLayoutDirty=!0;break}e=e._parent}},isUnifySizeEnabled:function(){return this._unifySize},setUnifySizeEnabled:function(e){this._unifySize=e},_ccEventCallback:null,addCCSEventListener:function(e){this._ccEventCallback=e},setScaleX:function(e){this._flippedX&&(e*=-1),cc.Node.prototype.setScaleX.call(this,e)},setScaleY:function(e){this._flippedY&&(e*=-1),cc.Node.prototype.setScaleY.call(this,e)},setScale:function(e,t){void 0===t&&(t=e),this.setScaleX(e),this.setScaleY(t)},getScaleX:function(){var e=cc.Node.prototype.getScaleX.call(this);return this._flippedX&&(e*=-1),e},getScaleY:function(){var e=cc.Node.prototype.getScaleY.call(this);return this._flippedY&&(e*=-1),e},getScale:function(){return this.getScaleX()==this.getScaleY()&&cc.log("Widget#scale. ScaleX != ScaleY. Don't know which one to return"),this.getScaleX()},setCallbackName:function(e){this._callbackName=e},getCallbackName:function(){return this._callbackName},setCallbackType:function(e){this._callbackType=e},getCallbackType:function(){return this._callbackType},setLayoutComponentEnabled:function(e){this._usingLayoutComponent=e},isLayoutComponentEnabled:function(){return this._usingLayoutComponent},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new ccui.Widget.WebGLRenderCmd(this):new ccui.Widget.CanvasRenderCmd(this)}}),(_p=ccui.Widget.prototype).xPercent,cc.defineGetterSetter(_p,"xPercent",_p._getXPercent,_p._setXPercent),_p.yPercent,cc.defineGetterSetter(_p,"yPercent",_p._getYPercent,_p._setYPercent),_p.widthPercent,cc.defineGetterSetter(_p,"widthPercent",_p._getWidthPercent,_p._setWidthPercent),_p.heightPercent,cc.defineGetterSetter(_p,"heightPercent",_p._getHeightPercent,_p._setHeightPercent),_p.widgetParent,cc.defineGetterSetter(_p,"widgetParent",_p.getWidgetParent),_p.enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),_p.focused,cc.defineGetterSetter(_p,"focused",_p.isFocused,_p.setFocused),_p.sizeType,cc.defineGetterSetter(_p,"sizeType",_p.getSizeType,_p.setSizeType),_p.widgetType,cc.defineGetterSetter(_p,"widgetType",_p.getWidgetType),_p.touchEnabled,cc.defineGetterSetter(_p,"touchEnabled",_p.isTouchEnabled,_p.setTouchEnabled),_p.updateEnabled,cc.defineGetterSetter(_p,"updateEnabled",_p.isUpdateEnabled,_p.setUpdateEnabled),_p.bright,cc.defineGetterSetter(_p,"bright",_p.isBright,_p.setBright),_p.name,cc.defineGetterSetter(_p,"name",_p.getName,_p.setName),_p.actionTag,cc.defineGetterSetter(_p,"actionTag",_p.getActionTag,_p.setActionTag),_p.opacity,cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),_p=null,ccui.Widget.create=function(){return new ccui.Widget},ccui.Widget._focusedWidget=null,ccui.Widget._focusNavigationController=null,ccui.Widget.enableDpadNavigation=function(e){e?(null==ccui.Widget._focusNavigationController&&(ccui.Widget._focusNavigationController=new ccui._FocusNavigationController,ccui.Widget._focusedWidget&&ccui.Widget._focusNavigationController._setFirstFocsuedWidget(ccui.Widget._focusedWidget)),ccui.Widget._focusNavigationController.enableFocusNavigation(!0)):ccui.Widget._focusNavigationController&&(ccui.Widget._focusNavigationController.enableFocusNavigation(!1),ccui.Widget._focusNavigationController=null)},ccui.Widget.getCurrentFocusedWidget=function(){return ccui.Widget._focusedWidget},ccui.Widget.BRIGHT_STYLE_NONE=-1,ccui.Widget.BRIGHT_STYLE_NORMAL=0,ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT=1,ccui.Widget.TYPE_WIDGET=0,ccui.Widget.TYPE_CONTAINER=1,ccui.Widget.LEFT=0,ccui.Widget.RIGHT=1,ccui.Widget.UP=2,ccui.Widget.DOWN=3,ccui.Widget.LOCAL_TEXTURE=0,ccui.Widget.PLIST_TEXTURE=1,ccui.Widget.TOUCH_BEGAN=0,ccui.Widget.TOUCH_MOVED=1,ccui.Widget.TOUCH_ENDED=2,ccui.Widget.TOUCH_CANCELED=3,ccui.Widget.SIZE_ABSOLUTE=0,ccui.Widget.SIZE_PERCENT=1,ccui.Widget.POSITION_ABSOLUTE=0,ccui.Widget.POSITION_PERCENT=1,cc._renderType===cc._RENDER_TYPE_CANVAS?function(){ccui.Widget.CanvasRenderCmd=function(e){cc.ProtectedNode.CanvasRenderCmd.call(this,e),this._needDraw=!1};var e=ccui.Widget.CanvasRenderCmd.prototype=Object.create(cc.ProtectedNode.CanvasRenderCmd.prototype);e.constructor=ccui.Widget.CanvasRenderCmd,e.visit=function(e){var t=this._node;t._visible&&(t._adaptRenderers(),cc.ProtectedNode.CanvasRenderCmd.prototype.visit.call(this,e))},e.transform=function(e,t){var i=this._node;if(i._visible){if(i._adaptRenderers(),!this._usingLayoutComponent){var n=i.getWidgetParent();if(n){var r=n.getContentSize();0!==r.width&&0!==r.height&&(i._position.x=r.width*i._positionPercent.x,i._position.y=r.height*i._positionPercent.y)}}cc.ProtectedNode.CanvasRenderCmd.prototype.transform.call(this,e,t)}}}():function(){ccui.Widget.WebGLRenderCmd=function(e){cc.ProtectedNode.WebGLRenderCmd.call(this,e),this._needDraw=!1};var e=ccui.Widget.WebGLRenderCmd.prototype=Object.create(cc.ProtectedNode.WebGLRenderCmd.prototype);e.constructor=ccui.Widget.WebGLRenderCmd,e.visit=function(e){var t=this._node;t._visible&&(t._adaptRenderers(),cc.ProtectedNode.WebGLRenderCmd.prototype.visit.call(this,e))},e.transform=function(e,t){var i=this._node;if(i._visible){if(i._adaptRenderers(),!this._usingLayoutComponent){var n=i.getWidgetParent();if(n){var r=n.getContentSize();0!==r.width&&0!==r.height&&(i._position.x=r.width*i._positionPercent.x,i._position.y=r.height*i._positionPercent.y)}}cc.ProtectedNode.WebGLRenderCmd.prototype.transform.call(this,e,t)}}}(),ccui.Scale9Sprite=cc.Node.extend({_spriteRect:null,_capInsetsInternal:null,_positionsAreDirty:!1,_scale9Image:null,_topLeft:null,_top:null,_topRight:null,_left:null,_centre:null,_right:null,_bottomLeft:null,_bottom:null,_bottomRight:null,_scale9Dirty:!0,_opacityModifyRGB:!1,_originalSize:null,_preferredSize:null,_opacity:0,_color:null,_capInsets:null,_insetLeft:0,_insetTop:0,_insetRight:0,_insetBottom:0,_spritesGenerated:!1,_spriteFrameRotated:!1,_textureLoaded:!1,_className:"Scale9Sprite",_flippedX:!1,_flippedY:!1,textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},_updateCapInset:function(){var e,t=this._insetLeft,i=this._insetTop,n=this._insetRight,r=this._spriteRect,o=this._insetBottom;e=0===t&&0===i&&0===n&&0===o?cc.rect(0,0,0,0):this._spriteFrameRotated?cc.rect(o,t,r.width-n-t,r.height-i-o):cc.rect(t,i,r.width-t-n,r.height-i-o),this.setCapInsets(e)},_updatePositions:function(){if(this._topLeft&&this._topRight&&this._bottomRight&&this._bottomLeft&&this._centre){var e=this._contentSize,t=this._topLeft,i=this._topRight,n=this._bottomRight,r=this._bottomLeft,o=this._centre,s=this._centre.getContentSize(),a=t.getContentSize(),c=r.getContentSize(),l=e.width-a.width-i.getContentSize().width,u=e.height-a.height-n.getContentSize().height,h=l/s.width,d=u/s.height,p=s.width*h,_=s.height*d,f=c.width,m=c.height;if(cc._renderType==cc._RENDER_TYPE_WEBGL){var g=Math.round(p);p!=g&&(h=(p=g)/s.width);var y=Math.round(_);_!=y&&(d=(_=y)/s.height)}o.setScaleX(h),o.setScaleY(d);var T=this._left,v=this._right,S=this._top,C=this._bottom,E=cc.p(0,0);r.setAnchorPoint(E),n.setAnchorPoint(E),t.setAnchorPoint(E),i.setAnchorPoint(E),T.setAnchorPoint(E),v.setAnchorPoint(E),S.setAnchorPoint(E),C.setAnchorPoint(E),o.setAnchorPoint(E),r.setPosition(0,0),n.setPosition(f+p,0),t.setPosition(0,m+_),i.setPosition(f+p,m+_),T.setPosition(0,m),T.setScaleY(d),v.setPosition(f+p,m),v.setScaleY(d),C.setPosition(f,0),C.setScaleX(h),S.setPosition(f,m+_),S.setScaleX(h),o.setPosition(f,m)}},ctor:function(e,t,i){if(cc.Node.prototype.ctor.call(this),this._spriteRect=cc.rect(0,0,0,0),this._capInsetsInternal=cc.rect(0,0,0,0),this._originalSize=cc.size(0,0),this._preferredSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),void 0!=e)if(e instanceof cc.SpriteFrame)this.initWithSpriteFrame(e,t);else{var n=cc.spriteFrameCache.getSpriteFrame(e);null!=n?this.initWithSpriteFrame(n,t):this.initWithFile(e,t,i)}else this.init()},getSprite:function(){return this._scale9Image},getOriginalSize:function(){return cc.size(this._originalSize)},getPreferredSize:function(){return cc.size(this._preferredSize)},_getPreferredWidth:function(){return this._preferredSize.width},_getPreferredHeight:function(){return this._preferredSize.height},setPreferredSize:function(e){this.setContentSize(e),this._preferredSize=e,this._positionsAreDirty&&(this._updatePositions(),this._positionsAreDirty=!1,this._scale9Dirty=!0)},_setPreferredWidth:function(e){this._setWidth(e),this._preferredSize.width=e},_setPreferredHeight:function(e){this._setHeight(e),this._preferredSize.height=e},setOpacity:function(e){if(this._scale9Image){cc.Node.prototype.setOpacity.call(this,e);for(var t=this._scale9Image.getChildren(),i=0;i<t.length;i++){var n=t[i];n&&n.setOpacity(e)}this._scale9Dirty=!0}},setColor:function(e){if(this._scale9Image){cc.Node.prototype.setColor.call(this,e);for(var t=this._scale9Image.getChildren(),i=0;i<t.length;i++){var n=t[i];n&&n.setColor(e)}this._scale9Dirty=!0}},getCapInsets:function(){return cc.rect(this._capInsets)},setCapInsets:function(e){if(this._scale9Image){var t=this._contentSize,i=t.width,n=t.height;this.updateWithBatchNode(this._scale9Image,this._spriteRect,this._spriteFrameRotated,e),this.setContentSize(i,n)}},getInsetLeft:function(){return this._insetLeft},setInsetLeft:function(e){this._insetLeft=e,this._updateCapInset()},getInsetTop:function(){return this._insetTop},setInsetTop:function(e){this._insetTop=e,this._updateCapInset()},getInsetRight:function(){return this._insetRight},setInsetRight:function(e){this._insetRight=e,this._updateCapInset()},getInsetBottom:function(){return this._insetBottom},setInsetBottom:function(e){this._insetBottom=e,this._updateCapInset()},setContentSize:function(e,t){cc.Node.prototype.setContentSize.call(this,e,t),this._positionsAreDirty=!0},_setWidth:function(e){cc.Node.prototype._setWidth.call(this,e),this._positionsAreDirty=!0},_setHeight:function(e){cc.Node.prototype._setHeight.call(this,e),this._positionsAreDirty=!0},init:function(){return this.initWithBatchNode(null,cc.rect(0,0,0,0),!1,cc.rect(0,0,0,0))},initWithBatchNode:function(e,t,i,n){return void 0===n&&(n=i,i=!1),e&&this.updateWithBatchNode(e,t,i,n),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint(.5,.5),this._positionsAreDirty=!0,!0},initWithFile:function(e,t,i){if(e instanceof cc.Rect?(e=arguments[1],i=arguments[0],t=cc.rect(0,0,0,0)):(t=t||cc.rect(0,0,0,0),i=i||cc.rect(0,0,0,0)),!e)throw"ccui.Scale9Sprite.initWithFile(): file should be non-null";var n=cc.textureCache.getTextureForKey(e);n||(n=cc.textureCache.addImage(e));var r=n.isLoaded();return this._textureLoaded=r,r||n.addEventListener("load",function(e){var t=this._preferredSize;t=cc.size(t.width,t.height);var i=e.getContentSize();this.updateWithBatchNode(this._scale9Image,cc.rect(0,0,i.width,i.height),!1,this._capInsets),this.setPreferredSize(t),this._positionsAreDirty=!0,this.dispatchEvent("load")},this),this.initWithBatchNode(new cc.SpriteBatchNode(e,9),t,!1,i)},initWithSpriteFrame:function(e,t){if(!e||!e.getTexture())throw"ccui.Scale9Sprite.initWithSpriteFrame(): spriteFrame should be non-null and its texture should be non-null";t=t||cc.rect(0,0,0,0);var i=e.textureLoaded();this._textureLoaded=i,i||e.addEventListener("load",function(e){var t=this._preferredSize;t=cc.size(t.width,t.height),this.updateWithBatchNode(this._scale9Image,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),this._capInsets),this.setPreferredSize(t),this._positionsAreDirty=!0,this.dispatchEvent("load")},this);var n=new cc.SpriteBatchNode(e.getTexture(),9);return this.initWithBatchNode(n,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),t)},initWithSpriteFrameName:function(e,t){if(!e)throw"ccui.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null";t=t||cc.rect(0,0,0,0);var i=cc.spriteFrameCache.getSpriteFrame(e);return null==i?(cc.log("ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),!1):this.initWithSpriteFrame(i,t)},resizableSpriteWithCapInsets:function(e){var t=new ccui.Scale9Sprite;return t&&t.initWithBatchNode(this._scale9Image,this._spriteRect,!1,e)?t:null},setOpacityModifyRGB:function(e){if(this._scale9Image){this._opacityModifyRGB=e;var t=this._scale9Image.getChildren();if(t)for(var i=0,n=t.length;i<n;i++)t[i].setOpacityModifyRGB(e)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},updateWithBatchNode:function(e,t,i,n){var r=this.getOpacity(),o=this.getColor(),s=cc.rect(t.x,t.y,t.width,t.height);if(this.removeAllChildren(!0),this._scale9Image!=e&&(this._scale9Image=e),!this._scale9Image)return!1;var a=e.getTexture(),c=a.isLoaded();if(this._textureLoaded=c,!c)return a.addEventListener("load",function(e){this._positionsAreDirty=!0,this.dispatchEvent("load")},this),!0;var l=this._scale9Image;l.removeAllChildren(!0);var u=this._capInsets;u.x=n.x,u.y=n.y,u.width=n.width,u.height=n.height,this._spriteFrameRotated=i;var h=l.getTexture();if(cc._rectEqualToZero(s)){var d=h.getContentSize();s=cc.rect(0,0,d.width,d.height)}this._spriteRect=s;var p=this._spriteRect;p.x=s.x,p.y=s.y,p.width=s.width,p.height=s.height,this._originalSize.width=s.width,this._originalSize.height=s.height;var _=this._preferredSize;0===_.width&&0===_.height&&(_.width=s.width,_.height=s.height);var f=this._capInsetsInternal;n&&(f.x=n.x,f.y=n.y,f.width=n.width,f.height=n.height);var m=s.width,g=s.height;cc._rectEqualToZero(f)&&(f.x=m/3,f.y=g/3,f.width=m/3,f.height=g/3);var y=f.x,T=f.width,v=m-(y+T),S=f.y,C=f.height,E=g-(S+C),b=0,A=0,x=cc.rect(b+.5|0,A+.5|0,y+.5|0,S+.5|0);b+=y;var R=cc.rect(b+.5|0,A+.5|0,T+.5|0,S+.5|0);b+=T;var P=cc.rect(b+.5|0,A+.5|0,v+.5|0,S+.5|0);b=0,A=0,A+=S;var I=cc.rect(b+.5|0,A+.5|0,y+.5|0,C+.5|0);b+=y;var w=cc.rect(b+.5|0,A+.5|0,T+.5|0,C+.5|0);b+=T;var N=cc.rect(b+.5|0,A+.5|0,v+.5|0,C+.5|0);b=0,A=0,A+=S,A+=C;var L=cc.rect(b+.5|0,A+.5|0,y+.5|0,E+.5|0);b+=y;var O=cc.rect(b+.5|0,A+.5|0,T+.5|0,E+.5|0);b+=T;var D=cc.rect(b+.5|0,A+.5|0,v+.5|0,E+.5|0),F=cc.affineTransformMakeIdentity();if(i){var B=w,M=D,k=L,W=P,V=x,z=N,G=I,U=O,Y=R;F=cc.affineTransformTranslate(F,s.height+s.x,s.y),F=cc.affineTransformRotate(F,1.57079633),w=cc.rectApplyAffineTransform(w,F),D=cc.rectApplyAffineTransform(D,F),L=cc.rectApplyAffineTransform(L,F),P=cc.rectApplyAffineTransform(P,F),x=cc.rectApplyAffineTransform(x,F),N=cc.rectApplyAffineTransform(N,F),I=cc.rectApplyAffineTransform(I,F),O=cc.rectApplyAffineTransform(O,F),R=cc.rectApplyAffineTransform(R,F),B.x=w.x,B.y=w.y,M.x=D.x,M.y=D.y,k.x=L.x,k.y=L.y,W.x=P.x,W.y=P.y,V.x=x.x,V.y=x.y,z.x=N.x,z.y=N.y,G.x=I.x,G.y=I.y,U.x=O.x,U.y=O.y,Y.x=R.x,Y.y=R.y,this._centre=new cc.Sprite,this._centre.initWithTexture(h,B,!0),l.addChild(this._centre,0,ccui.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(h,Y,!0),l.addChild(this._top,1,ccui.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(h,U,!0),l.addChild(this._bottom,1,ccui.Scale9Sprite.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(h,G,!0),l.addChild(this._left,1,ccui.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(h,z,!0),l.addChild(this._right,1,ccui.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(h,V,!0),l.addChild(this._topLeft,2,ccui.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(h,W,!0),l.addChild(this._topRight,2,ccui.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(h,k,!0),l.addChild(this._bottomLeft,2,ccui.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(h,M,!0),l.addChild(this._bottomRight,2,ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT)}else F=cc.affineTransformTranslate(F,s.x,s.y),cc._rectApplyAffineTransformIn(w,F),cc._rectApplyAffineTransformIn(D,F),cc._rectApplyAffineTransformIn(L,F),cc._rectApplyAffineTransformIn(P,F),cc._rectApplyAffineTransformIn(x,F),cc._rectApplyAffineTransformIn(N,F),cc._rectApplyAffineTransformIn(I,F),cc._rectApplyAffineTransformIn(O,F),cc._rectApplyAffineTransformIn(R,F),this._centre=new cc.Sprite,this._centre.initWithTexture(h,w),l.addChild(this._centre,0,ccui.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(h,R),l.addChild(this._top,1,ccui.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(h,O),l.addChild(this._bottom,1,ccui.Scale9Sprite.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(h,I),l.addChild(this._left,1,ccui.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(h,N),l.addChild(this._right,1,ccui.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(h,x),l.addChild(this._topLeft,2,ccui.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(h,P),l.addChild(this._topRight,2,ccui.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(h,L),l.addChild(this._bottomLeft,2,ccui.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(h,D),l.addChild(this._bottomRight,2,ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT);return this.setContentSize(s.width,s.height),cc._renderType===cc._RENDER_TYPE_WEBGL&&this.addChild(l),this._spritesGenerated&&(this.setOpacity(r),this.setColor(o)),this._spritesGenerated=!0,!0},setSpriteFrame:function(e){var t=new cc.SpriteBatchNode(e.getTexture(),9),i=e.textureLoaded();this._textureLoaded=i,i||e.addEventListener("load",function(e){var t=this._preferredSize;t=cc.size(t.width,t.height),this.updateWithBatchNode(this._scale9Image,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),this._capInsets),this.setPreferredSize(t),this._positionsAreDirty=!0,this.dispatchEvent("load")},this),this.updateWithBatchNode(t,e.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&e.isRotated(),cc.rect(0,0,0,0)),this._insetLeft=0,this._insetTop=0,this._insetRight=0,this._insetBottom=0},setState:function(e){this._renderCmd.setState(e)},setFlippedX:function(e){var t=this.getScaleX();this._flippedX=e,this.setScaleX(t)},isFlippedX:function(){return this._flippedX},setFlippedY:function(e){var t=this.getScaleY();this._flippedY=e,this.setScaleY(t)},isFlippedY:function(){return this._flippedY},setScaleX:function(e){this._flippedX&&(e*=-1),cc.Node.prototype.setScaleX.call(this,e)},setScaleY:function(e){this._flippedY&&(e*=-1),cc.Node.prototype.setScaleY.call(this,e)},setScale:function(e,t){void 0===t&&(t=e),this.setScaleX(e),this.setScaleY(t)},getScaleX:function(){var e=cc.Node.prototype.getScaleX.call(this);return this._flippedX&&(e*=-1),e},getScaleY:function(){var e=cc.Node.prototype.getScaleY.call(this);return this._flippedY&&(e*=-1),e},getScale:function(){return this.getScaleX()!==this.getScaleY()&&cc.log("Scale9Sprite#scale. ScaleX != ScaleY. Don't know which one to return"),this.getScaleX()},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new ccui.Scale9Sprite.CanvasRenderCmd(this):new ccui.Scale9Sprite.WebGLRenderCmd(this)}});var _p=ccui.Scale9Sprite.prototype;cc.EventHelper.prototype.apply(_p),_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.capInsets,cc.defineGetterSetter(_p,"capInsets",_p.getCapInsets,_p.setCapInsets),_p.insetLeft,cc.defineGetterSetter(_p,"insetLeft",_p.getInsetLeft,_p.setInsetLeft),_p.insetTop,cc.defineGetterSetter(_p,"insetTop",_p.getInsetTop,_p.setInsetTop),_p.insetRight,cc.defineGetterSetter(_p,"insetRight",_p.getInsetRight,_p.setInsetRight),_p.insetBottom,cc.defineGetterSetter(_p,"insetBottom",_p.getInsetBottom,_p.setInsetBottom),_p=null,ccui.Scale9Sprite.create=function(e,t,i){return new ccui.Scale9Sprite(e,t,i)},ccui.Scale9Sprite.createWithSpriteFrame=function(e,t){return new ccui.Scale9Sprite(e,t)},ccui.Scale9Sprite.createWithSpriteFrameName=function(e,t){return new ccui.Scale9Sprite(e,t)},ccui.Scale9Sprite.POSITIONS_CENTRE=0,ccui.Scale9Sprite.POSITIONS_TOP=1,ccui.Scale9Sprite.POSITIONS_LEFT=2,ccui.Scale9Sprite.POSITIONS_RIGHT=3,ccui.Scale9Sprite.POSITIONS_BOTTOM=4,ccui.Scale9Sprite.POSITIONS_TOPRIGHT=5,ccui.Scale9Sprite.POSITIONS_TOPLEFT=6,ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT=7,ccui.Scale9Sprite.state={NORMAL:0,GRAY:1},function(){ccui.Scale9Sprite.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._cachedParent=null,this._cacheDirty=!1,this._state=ccui.Scale9Sprite.state.NORMAL;var t=this._node,i=this._cacheCanvas=cc.newElement("canvas");i.width=1,i.height=1,this._cacheContext=new cc.CanvasContextWrapper(i.getContext("2d"));var n=this._cacheTexture=new cc.Texture2D;n.initWithElement(i),n.handleLoadedTexture(),this._cacheSprite=new cc.Sprite(n),this._cacheSprite.setAnchorPoint(0,0),t.addChild(this._cacheSprite)};var e=ccui.Scale9Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=ccui.Scale9Sprite.CanvasRenderCmd,e.visit=function(e){var t=this._node;t._visible&&(t._positionsAreDirty&&(t._updatePositions(),t._positionsAreDirty=!1,t._scale9Dirty=!0),t._scale9Dirty=!1,this._cacheScale9Sprite(),cc.Node.CanvasRenderCmd.prototype.visit.call(this,e))},e.transform=function(e){var t=this._node;cc.Node.CanvasRenderCmd.prototype.transform.call(this,e),t._positionsAreDirty&&(t._updatePositions(),t._positionsAreDirty=!1,t._scale9Dirty=!0),this._cacheScale9Sprite();for(var i=t._children,n=0;n<i.length;n++)i[n].transform(this)},e._updateDisplayColor=function(e){cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(this,e);var t=this._node._scale9Image;if(t){for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n];r&&r._renderCmd._updateDisplayColor(e)}this._cacheScale9Sprite()}},e._cacheScale9Sprite=function(){var e=this._node;if(e._scale9Image){var t=cc.contentScaleFactor(),i=e._contentSize,n=cc.size(i.width*t,i.height*t),r=this._cacheCanvas,o=this._cacheContext,s=o.getContext(),a=!1;r.width==n.width&&r.height==n.height||(r.width=n.width,r.height=n.height,a=!0),cc.renderer._turnToCacheMode(e.__instanceId),e._scale9Image.visit();var c=e._scale9Image.getTexture();c&&this._state===ccui.Scale9Sprite.state.GRAY&&c._switchToGray(!0),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,n.width,n.height),cc.renderer._renderingToCacheCanvas(o,e.__instanceId,t,t),c&&this._state===ccui.Scale9Sprite.state.GRAY&&c._switchToGray(!1),a&&this._cacheSprite.setTextureRect(cc.rect(0,0,i.width,i.height)),this._cacheSprite.getParent()||e.addChild(this._cacheSprite,-1)}},e.setState=function(e){this._node._scale9Image&&(this._state=e,this._cacheScale9Sprite())}}(),function(){ccui.Scale9Sprite.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._cachedParent=null,this._cacheDirty=!1};var e=ccui.Scale9Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=ccui.Scale9Sprite.WebGLRenderCmd,e.visit=function(e){var t=this._node;t._visible&&(t._positionsAreDirty&&(t._updatePositions(),t._positionsAreDirty=!1,t._scale9Dirty=!0),cc.Node.WebGLRenderCmd.prototype.visit.call(this,e))},e.transform=function(e,t){var i=this._node;cc.Node.WebGLRenderCmd.prototype.transform.call(this,e,t),i._positionsAreDirty&&(i._updatePositions(),i._positionsAreDirty=!1,i._scale9Dirty=!0)},e._updateDisplayColor=function(e){cc.Node.WebGLRenderCmd.prototype._updateDisplayColor.call(this,e);var t=this._node._scale9Image;if(t)for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n];r&&(r._renderCmd._updateDisplayColor(e),r._renderCmd._updateColor())}},e._updateDisplayOpacity=function(e){cc.Node.WebGLRenderCmd.prototype._updateDisplayOpacity.call(this,e);var t=this._node._scale9Image;if(t)for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n];r&&(r._renderCmd._updateDisplayOpacity(e),r._renderCmd._updateColor())}},e.setState=function(e){var t=this._node._scale9Image;null!=t&&(e===ccui.Scale9Sprite.state.NORMAL?t.setShaderProgram(cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)):e===ccui.Scale9Sprite.state.GRAY&&t.setShaderProgram(ccui.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram()))},ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram=null,ccui.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram=function(){var e=ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram;return e||((e=new cc.GLProgram).initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,ccui.Scale9Sprite.WebGLRenderCmd._grayShaderFragment),e.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),e.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),e.link(),e.updateUniforms(),ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram=e,e)},ccui.Scale9Sprite.WebGLRenderCmd._grayShaderFragment="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    gl_FragColor.xyz = vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b); \n     gl_FragColor.w = c.w ; \n}"}(),ccui.Layout=ccui.Widget.extend({_clippingEnabled:!1,_backGroundScale9Enabled:null,_backGroundImage:null,_backGroundImageFileName:null,_backGroundImageCapInsets:null,_colorType:null,_bgImageTexType:ccui.Widget.LOCAL_TEXTURE,_colorRender:null,_gradientRender:null,_color:null,_startColor:null,_endColor:null,_alongVector:null,_opacity:255,_backGroundImageTextureSize:null,_layoutType:null,_doLayoutDirty:!0,_clippingRectDirty:!0,_clippingType:null,_clippingStencil:null,_scissorRectDirty:!1,_clippingRect:null,_clippingParent:null,_className:"Layout",_backGroundImageColor:null,_finalPositionX:0,_finalPositionY:0,_backGroundImageOpacity:0,_loopFocus:!1,__passFocusToChild:!0,_isFocusPassing:!1,_isInterceptTouch:!1,ctor:function(){this._layoutType=ccui.Layout.ABSOLUTE,this._widgetType=ccui.Widget.TYPE_CONTAINER,this._clippingType=ccui.Layout.CLIPPING_STENCIL,this._colorType=ccui.Layout.BG_COLOR_NONE,ccui.Widget.prototype.ctor.call(this),this._backGroundImageCapInsets=cc.rect(0,0,0,0),this._color=cc.color(255,255,255,255),this._startColor=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._alongVector=cc.p(0,-1),this._backGroundImageTextureSize=cc.size(0,0),this._clippingRect=cc.rect(0,0,0,0),this._backGroundImageColor=cc.color(255,255,255,255)},onEnter:function(){ccui.Widget.prototype.onEnter.call(this),this._clippingStencil&&this._clippingStencil.onEnter(),this._doLayoutDirty=!0,this._clippingRectDirty=!0},onExit:function(){ccui.Widget.prototype.onExit.call(this),this._clippingStencil&&this._clippingStencil.onExit()},setLoopFocus:function(e){this._loopFocus=e},isLoopFocus:function(){return this._loopFocus},setPassFocusToChild:function(e){this.__passFocusToChild=e},isPassFocusToChild:function(){return this.__passFocusToChild},findNextFocusedWidget:function(e,t){if(this._isFocusPassing||this.isFocused()){var i=this.getParent();if(this._isFocusPassing=!1,this.__passFocusToChild){var n=this._passFocusToChild(e,t);return n instanceof ccui.Layout&&i?(i._isFocusPassing=!0,i.findNextFocusedWidget(e,this)):n}return null!=i&&i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(e,this)):this}if(!(t.isFocused()||t instanceof ccui.Layout))return t;if(this._layoutType==ccui.Layout.LINEAR_HORIZONTAL)switch(e){case ccui.Widget.LEFT:return this._getPreviousFocusedWidget(e,t);case ccui.Widget.RIGHT:return this._getNextFocusedWidget(e,t);case ccui.Widget.DOWN:case ccui.Widget.UP:return this._isLastWidgetInContainer(this,e)?this._isWidgetAncestorSupportLoopFocus(t,e)?ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this):t:ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this);default:return cc.assert(0,"Invalid Focus Direction"),t}else{if(this._layoutType!=ccui.Layout.LINEAR_VERTICAL)return cc.assert(0,"Un Supported Layout type, please use VBox and HBox instead!!!"),t;switch(e){case ccui.Widget.LEFT:case ccui.Widget.RIGHT:return this._isLastWidgetInContainer(this,e)?this._isWidgetAncestorSupportLoopFocus(t,e)?ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this):t:ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this);case ccui.Widget.DOWN:return this._getNextFocusedWidget(e,t);case ccui.Widget.UP:return this._getPreviousFocusedWidget(e,t);default:return cc.assert(0,"Invalid Focus Direction"),t}}},onPassFocusToChild:null,init:function(){return!!ccui.Widget.prototype.init.call(this)&&(this.ignoreContentAdaptWithSize(!1),this.setContentSize(cc.size(0,0)),this.setAnchorPoint(0,0),this.onPassFocusToChild=this._findNearestChildWidgetIndex.bind(this),!0)},addChild:function(e,t,i){e instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(e),ccui.Widget.prototype.addChild.call(this,e,t,i),this._doLayoutDirty=!0},removeChild:function(e,t){ccui.Widget.prototype.removeChild.call(this,e,t),this._doLayoutDirty=!0},removeAllChildren:function(e){ccui.Widget.prototype.removeAllChildren.call(this,e),this._doLayoutDirty=!0},removeAllChildrenWithCleanup:function(e){ccui.Widget.prototype.removeAllChildrenWithCleanup.call(this,e),this._doLayoutDirty=!0},isClippingEnabled:function(){return this._clippingEnabled},visit:function(e){if(this._visible)if(this._adaptRenderers(),this._doLayout(),this._clippingEnabled)switch(this._clippingType){case ccui.Layout.CLIPPING_STENCIL:this._renderCmd.stencilClippingVisit(e);break;case ccui.Layout.CLIPPING_SCISSOR:this._renderCmd.scissorClippingVisit(e)}else ccui.Widget.prototype.visit.call(this,e)},setClippingEnabled:function(e){if(e!=this._clippingEnabled)switch(this._clippingEnabled=e,this._clippingType){case ccui.Layout.CLIPPING_STENCIL:e?(this._clippingStencil=new cc.DrawNode,this._renderCmd.rebindStencilRendering(this._clippingStencil),this._running&&this._clippingStencil.onEnter(),this._setStencilClippingSize(this._contentSize)):(this._running&&this._clippingStencil&&this._clippingStencil.onExit(),this._clippingStencil=null)}},setClippingType:function(e){if(e!=this._clippingType)if(cc._renderType!==cc._RENDER_TYPE_CANVAS||e!=ccui.Layout.CLIPPING_SCISSOR){var t=this.isClippingEnabled();this.setClippingEnabled(!1),this._clippingType=e,this.setClippingEnabled(t)}else cc.log("Only supports STENCIL on canvas mode.")},getClippingType:function(){return this._clippingType},_setStencilClippingSize:function(e){if(this._clippingEnabled&&this._clippingType==ccui.Layout.CLIPPING_STENCIL){var t=[];t[0]=cc.p(0,0),t[1]=cc.p(e.width,0),t[2]=cc.p(e.width,e.height),t[3]=cc.p(0,e.height);var i=cc.color.GREEN;this._clippingStencil.clear(),this._clippingStencil.drawPoly(t,4,i,0,i)}},_getClippingRect:function(){if(this._clippingRectDirty){for(var e,t=this.convertToWorldSpace(cc.p(0,0)),i=this.getNodeToWorldTransform(),n=this._contentSize.width*i.a,r=this._contentSize.height*i.d,o=this;o;)if((o=o.getParent())&&o instanceof ccui.Layout&&o.isClippingEnabled()){this._clippingParent=o;break}if(this._clippingParent){e=this._clippingParent._getClippingRect();var s=t.x-n*this._anchorPoint.x,a=t.y-r*this._anchorPoint.y,c=n,l=r,u=t.x-e.x;u<0&&(s=e.x,c+=u);var h=t.x+n-(e.x+e.width);h>0&&(c-=h);var d=t.y+r-(e.y+e.height);d>0&&(l-=d);var p=t.y-e.y;p<0&&(a=e.x,l+=p),c<0&&(c=0),l<0&&(l=0),this._clippingRect.x=s,this._clippingRect.y=a,this._clippingRect.width=c,this._clippingRect.height=l}else this._clippingRect.x=t.x-n*this._anchorPoint.x,this._clippingRect.y=t.y-r*this._anchorPoint.y,this._clippingRect.width=n,this._clippingRect.height=r;this._clippingRectDirty=!1}return this._clippingRect},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);var e=this._contentSize;this._setStencilClippingSize(e),this._doLayoutDirty=!0,this._clippingRectDirty=!0,this._backGroundImage&&(this._backGroundImage.setPosition(.5*e.width,.5*e.height),this._backGroundScale9Enabled&&this._backGroundImage instanceof ccui.Scale9Sprite&&this._backGroundImage.setPreferredSize(e)),this._colorRender&&this._colorRender.setContentSize(e),this._gradientRender&&this._gradientRender.setContentSize(e)},setBackGroundImageScale9Enabled:function(e){this._backGroundScale9Enabled!=e&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundScale9Enabled=e,this._addBackGroundImage(),this.setBackGroundImage(this._backGroundImageFileName,this._bgImageTexType),this.setBackGroundImageCapInsets(this._backGroundImageCapInsets))},isBackGroundImageScale9Enabled:function(){return this._backGroundScale9Enabled},setBackGroundImage:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,null==this._backGroundImage&&(this._addBackGroundImage(),this.setBackGroundImageScale9Enabled(this._backGroundScale9Enabled)),this._backGroundImageFileName=e,this._bgImageTexType=t;var i=this._backGroundImage;switch(this._bgImageTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._backGroundScale9Enabled&&i.setPreferredSize(this._contentSize),this._backGroundImageTextureSize=i.getContentSize(),i.setPosition(.5*this._contentSize.width,.5*this._contentSize.height),this._updateBackGroundImageColor()}},setBackGroundImageCapInsets:function(e){if(e){var t=this._backGroundImageCapInsets;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,this._backGroundScale9Enabled&&this._backGroundImage.setCapInsets(e)}},getBackGroundImageCapInsets:function(){return cc.rect(this._backGroundImageCapInsets)},_supplyTheLayoutParameterLackToChild:function(e){if(e)switch(this._layoutType){case ccui.Layout.ABSOLUTE:break;case ccui.Layout.LINEAR_HORIZONTAL:case ccui.Layout.LINEAR_VERTICAL:(t=e.getLayoutParameter(ccui.LayoutParameter.LINEAR))||e.setLayoutParameter(new ccui.LinearLayoutParameter);break;case ccui.Layout.RELATIVE:var t=e.getLayoutParameter(ccui.LayoutParameter.RELATIVE);t||e.setLayoutParameter(new ccui.RelativeLayoutParameter)}},_addBackGroundImage:function(){var e=this._contentSize;this._backGroundScale9Enabled?(this._backGroundImage=new ccui.Scale9Sprite,this._backGroundImage.setPreferredSize(e)):this._backGroundImage=new cc.Sprite,this.addProtectedChild(this._backGroundImage,ccui.Layout.BACKGROUND_IMAGE_ZORDER,-1),this._backGroundImage.setPosition(.5*e.width,.5*e.height)},removeBackGroundImage:function(){this._backGroundImage&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundImageFileName="",this._backGroundImageTextureSize.width=0,this._backGroundImageTextureSize.height=0)},setBackGroundColorType:function(e){if(this._colorType!=e){switch(this._colorType){case ccui.Layout.BG_COLOR_NONE:this._colorRender&&(this.removeProtectedChild(this._colorRender),this._colorRender=null),this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null);break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender&&(this.removeProtectedChild(this._colorRender),this._colorRender=null);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null)}switch(this._colorType=e,this._colorType){case ccui.Layout.BG_COLOR_NONE:break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender=new cc.LayerColor,this._colorRender.setContentSize(this._contentSize),this._colorRender.setOpacity(this._opacity),this._colorRender.setColor(this._color),this.addProtectedChild(this._colorRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender=new cc.LayerGradient(cc.color(255,0,0,255),cc.color(0,255,0,255)),this._gradientRender.setContentSize(this._contentSize),this._gradientRender.setOpacity(this._opacity),this._gradientRender.setStartColor(this._startColor),this._gradientRender.setEndColor(this._endColor),this._gradientRender.setVector(this._alongVector),this.addProtectedChild(this._gradientRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1)}}},getBackGroundColorType:function(){return this._colorType},setBackGroundColor:function(e,t){t?(this._startColor.r=e.r,this._startColor.g=e.g,this._startColor.b=e.b,this._gradientRender&&this._gradientRender.setStartColor(e),this._endColor.r=t.r,this._endColor.g=t.g,this._endColor.b=t.b,this._gradientRender&&this._gradientRender.setEndColor(t)):(this._color.r=e.r,this._color.g=e.g,this._color.b=e.b,this._colorRender&&this._colorRender.setColor(e))},getBackGroundColor:function(){var e=this._color;return cc.color(e.r,e.g,e.b,e.a)},getBackGroundStartColor:function(){var e=this._startColor;return cc.color(e.r,e.g,e.b,e.a)},getBackGroundEndColor:function(){var e=this._endColor;return cc.color(e.r,e.g,e.b,e.a)},setBackGroundColorOpacity:function(e){switch(this._opacity=e,this._colorType){case ccui.Layout.BG_COLOR_NONE:break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender.setOpacity(e);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender.setOpacity(e)}},getBackGroundColorOpacity:function(){return this._opacity},setBackGroundColorVector:function(e){this._alongVector.x=e.x,this._alongVector.y=e.y,this._gradientRender&&this._gradientRender.setVector(e)},getBackGroundColorVector:function(){return this._alongVector},setBackGroundImageColor:function(e){this._backGroundImageColor.r=e.r,this._backGroundImageColor.g=e.g,this._backGroundImageColor.b=e.b,this._updateBackGroundImageColor()},setBackGroundImageOpacity:function(e){this._backGroundImageColor.a=e,this.getBackGroundImageColor()},getBackGroundImageColor:function(){var e=this._backGroundImageColor;return cc.color(e.r,e.g,e.b,e.a)},getBackGroundImageOpacity:function(){return this._backGroundImageColor.a},_updateBackGroundImageColor:function(){this._backGroundImage&&this._backGroundImage.setColor(this._backGroundImageColor)},getBackGroundImageTextureSize:function(){return this._backGroundImageTextureSize},setLayoutType:function(e){this._layoutType=e;for(var t=this._children,i=null,n=0;n<t.length;n++)(i=t[n])instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(i);this._doLayoutDirty=!0},getLayoutType:function(){return this._layoutType},requestDoLayout:function(){this._doLayoutDirty=!0},_doLayout:function(){if(this._doLayoutDirty){this.sortAllChildren();var e=ccui.getLayoutManager(this._layoutType);e&&e._doLayout(this),this._doLayoutDirty=!1}},_getLayoutContentSize:function(){return this.getContentSize()},_getLayoutElements:function(){return this.getChildren()},_updateBackGroundImageOpacity:function(){this._backGroundImage&&this._backGroundImage.setOpacity(this._backGroundImageOpacity)},_updateBackGroundImageRGBA:function(){this._backGroundImage&&(this._backGroundImage.setColor(this._backGroundImageColor),this._backGroundImage.setOpacity(this._backGroundImageOpacity))},_getLayoutAccumulatedSize:function(){for(var e,t=this.getChildren(),i=cc.size(0,0),n=0,r=0,o=t.length;r<o;r++){var s=t[r];if(null!=s&&s instanceof ccui.Layout)e=s._getLayoutAccumulatedSize(),i.width+=e.width,i.height+=e.height;else if(s instanceof ccui.Widget){n++;var a=s.getLayoutParameter().getMargin();e=s.getContentSize(),i.width+=e.width+.5*(a.right+a.left),i.height+=e.height+.5*(a.top+a.bottom)}}var c=this.getLayoutType();return c==ccui.Layout.LINEAR_HORIZONTAL&&(i.height=i.height-i.height/n*(n-1)),c==ccui.Layout.LINEAR_VERTICAL&&(i.width=i.width-i.width/n*(n-1)),i},_findNearestChildWidgetIndex:function(e,t){if(null==t||t==this)return this._findFirstFocusEnabledWidgetIndex();var i,n=0,r=this.getChildren(),o=r.length,s=cc.FLT_MAX,a=0;if(e==ccui.Widget.LEFT||e==ccui.Widget.RIGHT||e==ccui.Widget.DOWN||e==ccui.Widget.UP){for(i=this._getWorldCenterPoint(t);n<o;){var c=r[n];if(c&&c instanceof ccui.Widget&&c.isFocusEnabled()){var l=c instanceof ccui.Layout?c._calculateNearestDistance(t):cc.pLength(cc.pSub(this._getWorldCenterPoint(c),i));l<s&&(a=n,s=l)}n++}return a}return cc.log("invalid focus direction!"),0},_findFarthestChildWidgetIndex:function(e,t){if(null==t||t==this)return this._findFirstFocusEnabledWidgetIndex();var i=0,n=this.getChildren(),r=n.length,o=-cc.FLT_MAX,s=0;if(e==ccui.Widget.LEFT||e==ccui.Widget.RIGHT||e==ccui.Widget.DOWN||e==ccui.Widget.UP){for(var a=this._getWorldCenterPoint(t);i<r;){var c=n[i];if(c&&c instanceof ccui.Widget&&c.isFocusEnabled()){var l=c instanceof ccui.Layout?c._calculateFarthestDistance(t):cc.pLength(cc.pSub(this._getWorldCenterPoint(c),a));l>o&&(s=i,o=l)}i++}return s}return cc.log("invalid focus direction!!!"),0},_calculateNearestDistance:function(e){for(var t=cc.FLT_MAX,i=this._getWorldCenterPoint(e),n=this._children,r=0,o=n.length;r<o;r++){var s,a=n[r];if(a instanceof ccui.Layout)s=a._calculateNearestDistance(e);else{if(!(a instanceof ccui.Widget&&a.isFocusEnabled()))continue;s=cc.pLength(cc.pSub(this._getWorldCenterPoint(a),i))}s<t&&(t=s)}return t},_calculateFarthestDistance:function(e){for(var t=-cc.FLT_MAX,i=this._getWorldCenterPoint(e),n=this._children,r=0,o=n.length;r<o;r++){var s,a=n[r];if(a instanceof ccui.Layout)s=a._calculateFarthestDistance(e);else{if(!(a instanceof ccui.Widget&&a.isFocusEnabled()))continue;var c=this._getWorldCenterPoint(a);s=cc.pLength(cc.pSub(c,i))}s>t&&(t=s)}return t},_findProperSearchingFunctor:function(e,t){if(null!=t){var i=this._getWorldCenterPoint(t),n=this._getWorldCenterPoint(this._findFirstNonLayoutWidget());e==ccui.Widget.LEFT?this.onPassFocusToChild=i.x>n.x?this._findNearestChildWidgetIndex.bind(this):this._findFarthestChildWidgetIndex.bind(this):e==ccui.Widget.RIGHT?this.onPassFocusToChild=i.x>n.x?this._findFarthestChildWidgetIndex.bind(this):this._findNearestChildWidgetIndex.bind(this):e==ccui.Widget.DOWN?this.onPassFocusToChild=i.y>n.y?this._findNearestChildWidgetIndex.bind(this):this._findFarthestChildWidgetIndex.bind(this):e==ccui.Widget.UP?this.onPassFocusToChild=i.y<n.y?this._findNearestChildWidgetIndex.bind(this):this._findFarthestChildWidgetIndex.bind(this):cc.log("invalid direction!")}},_findFirstNonLayoutWidget:function(){for(var e=this._children,t=0,i=e.length;t<i;t++){var n=e[t];if(n instanceof ccui.Layout){var r=n._findFirstNonLayoutWidget();if(r)return r}else if(n instanceof ccui.Widget)return n}return null},_findFirstFocusEnabledWidgetIndex:function(){for(var e=0,t=this.getChildren(),i=t.length;e<i;){var n=t[e];if(n&&n instanceof ccui.Widget&&n.isFocusEnabled())return e;e++}return 0},_findFocusEnabledChildWidgetByIndex:function(e){var t=this._getChildWidgetByIndex(e);return t?t.isFocusEnabled()?t:(e+=1,this._findFocusEnabledChildWidgetByIndex(e)):null},_getWorldCenterPoint:function(e){var t=e instanceof ccui.Layout?e._getLayoutAccumulatedSize():e.getContentSize();return e.convertToWorldSpace(cc.p(t.width/2,t.height/2))},_getNextFocusedWidget:function(e,t){var i=null,n=this._children,r=n.indexOf(t);return(r+=1)<n.length?(i=this._getChildWidgetByIndex(r))?i.isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(e,i)):(this.dispatchFocusEvent(t,i),i):this._getNextFocusedWidget(e,i):t:this._loopFocus?this._checkFocusEnabledChild()?(r=0,(i=this._getChildWidgetByIndex(r)).isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(e,i)):(this.dispatchFocusEvent(t,i),i):this._getNextFocusedWidget(e,i)):t instanceof ccui.Layout?t:ccui.Widget._focusedWidget:this._isLastWidgetInContainer(t,e)?this._isWidgetAncestorSupportLoopFocus(this,e)?ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this):t instanceof ccui.Layout?t:ccui.Widget._focusedWidget:ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this)},_getPreviousFocusedWidget:function(e,t){var i=null,n=this._children,r=n.indexOf(t);return(r-=1)>=0?(i=this._getChildWidgetByIndex(r)).isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(e,i)):(this.dispatchFocusEvent(t,i),i):this._getPreviousFocusedWidget(e,i):this._loopFocus?this._checkFocusEnabledChild()?(r=n.length-1,(i=this._getChildWidgetByIndex(r)).isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(e,i)):(this.dispatchFocusEvent(t,i),i):this._getPreviousFocusedWidget(e,i)):t instanceof ccui.Layout?t:ccui.Widget._focusedWidget:this._isLastWidgetInContainer(t,e)?this._isWidgetAncestorSupportLoopFocus(this,e)?ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this):t instanceof ccui.Layout?t:ccui.Widget._focusedWidget:ccui.Widget.prototype.findNextFocusedWidget.call(this,e,this)},_getChildWidgetByIndex:function(e){for(var t=this._children,i=t.length,n=e;e<i;){var r=t[e];if(r&&r instanceof ccui.Widget)return r;0,e++}for(var o=0;o<n;){var s=t[o];if(s&&s instanceof ccui.Widget)return s;0,o++}return null},_isLastWidgetInContainer:function(e,t){var i=e.getParent();if(null==i||!(i instanceof ccui.Layout))return!0;var n=i.getChildren(),r=n.indexOf(e);if(i.getLayoutType()==ccui.Layout.LINEAR_HORIZONTAL){if(t==ccui.Widget.LEFT)return 0==r&&this._isLastWidgetInContainer(i,t);if(t==ccui.Widget.RIGHT)return r==n.length-1&&this._isLastWidgetInContainer(i,t);if(t==ccui.Widget.DOWN)return this._isLastWidgetInContainer(i,t);if(t==ccui.Widget.UP)return this._isLastWidgetInContainer(i,t)}else{if(i.getLayoutType()!=ccui.Layout.LINEAR_VERTICAL)return cc.log("invalid layout Type"),!1;if(t==ccui.Widget.UP)return 0==r&&this._isLastWidgetInContainer(i,t);if(t==ccui.Widget.DOWN)return r==n.length-1&&this._isLastWidgetInContainer(i,t);if(t==ccui.Widget.LEFT)return this._isLastWidgetInContainer(i,t);if(t==ccui.Widget.RIGHT)return this._isLastWidgetInContainer(i,t)}},_isWidgetAncestorSupportLoopFocus:function(e,t){var i=e.getParent();if(null==i||!(i instanceof ccui.Layout))return!1;if(i.isLoopFocus()){var n=i.getLayoutType();return n==ccui.Layout.LINEAR_HORIZONTAL?t==ccui.Widget.LEFT||t==ccui.Widget.RIGHT||this._isWidgetAncestorSupportLoopFocus(i,t):n==ccui.Layout.LINEAR_VERTICAL?t==ccui.Widget.DOWN||t==ccui.Widget.UP||this._isWidgetAncestorSupportLoopFocus(i,t):(cc.assert(0,"invalid layout type"),!1)}return this._isWidgetAncestorSupportLoopFocus(i,t)},_passFocusToChild:function(e,t){if(this._checkFocusEnabledChild()){var i=ccui.Widget.getCurrentFocusedWidget();this._findProperSearchingFunctor(e,i);var n=this.onPassFocusToChild(e,i),r=this._getChildWidgetByIndex(n);return r instanceof ccui.Layout?(r._isFocusPassing=!0,r.findNextFocusedWidget(e,r)):(this.dispatchFocusEvent(t,r),r)}return this},_checkFocusEnabledChild:function(){for(var e=this._children,t=0,i=e.length;t<i;t++){var n=e[t];if(n&&n instanceof ccui.Widget&&n.isFocusEnabled())return!0}return!1},getDescription:function(){return"Layout"},_createCloneInstance:function(){return new ccui.Layout},_copyClonedWidgetChildren:function(e){ccui.Widget.prototype._copyClonedWidgetChildren.call(this,e)},_copySpecialProperties:function(e){e instanceof ccui.Layout&&(this.setBackGroundImageScale9Enabled(e._backGroundScale9Enabled),this.setBackGroundImage(e._backGroundImageFileName,e._bgImageTexType),this.setBackGroundImageCapInsets(e._backGroundImageCapInsets),this.setBackGroundColorType(e._colorType),this.setBackGroundColor(e._color),this.setBackGroundColor(e._startColor,e._endColor),this.setBackGroundColorOpacity(e._opacity),this.setBackGroundColorVector(e._alongVector),this.setLayoutType(e._layoutType),this.setClippingEnabled(e._clippingEnabled),this.setClippingType(e._clippingType),this._loopFocus=e._loopFocus,this.__passFocusToChild=e.__passFocusToChild,this._isInterceptTouch=e._isInterceptTouch)},forceDoLayout:function(){this.requestDoLayout(),this._doLayout()},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new ccui.Layout.WebGLRenderCmd(this):new ccui.Layout.CanvasRenderCmd(this)}}),(_p=ccui.Layout.prototype).clippingEnabled,cc.defineGetterSetter(_p,"clippingEnabled",_p.isClippingEnabled,_p.setClippingEnabled),_p.clippingType,cc.defineGetterSetter(_p,"clippingType",null,_p.setClippingType),_p.layoutType,cc.defineGetterSetter(_p,"layoutType",_p.getLayoutType,_p.setLayoutType),_p=null,ccui.Layout.create=function(){return new ccui.Layout},ccui.Layout.BG_COLOR_NONE=0,ccui.Layout.BG_COLOR_SOLID=1,ccui.Layout.BG_COLOR_GRADIENT=2,ccui.Layout.ABSOLUTE=0,ccui.Layout.LINEAR_VERTICAL=1,ccui.Layout.LINEAR_HORIZONTAL=2,ccui.Layout.RELATIVE=3,ccui.Layout.CLIPPING_STENCIL=0,ccui.Layout.CLIPPING_SCISSOR=1,ccui.Layout.BACKGROUND_IMAGE_ZORDER=-2,ccui.Layout.BACKGROUND_RENDERER_ZORDER=-2,function(){ccui.Layout.CanvasRenderCmd=function(e){ccui.ProtectedNode.CanvasRenderCmd.call(this,e),this._needDraw=!1,this._clipElemType=!1,this._locCache=null,this._rendererSaveCmd=new cc.CustomRenderCmd(this,this._onRenderSaveCmd),this._rendererSaveCmdSprite=new cc.CustomRenderCmd(this,this._onRenderSaveSpriteCmd),this._rendererClipCmd=new cc.CustomRenderCmd(this,this._onRenderClipCmd),this._rendererRestoreCmd=new cc.CustomRenderCmd(this,this._onRenderRestoreCmd)};var e=ccui.Layout.CanvasRenderCmd.prototype=Object.create(ccui.ProtectedNode.CanvasRenderCmd.prototype);e.constructor=ccui.Layout.CanvasRenderCmd,e.visit=function(e){var t=this._node;if(t._visible)if(t._adaptRenderers(),t._doLayout(),t._clippingEnabled)switch(t._clippingType){case ccui.Layout.CLIPPING_STENCIL:this.stencilClippingVisit(e);break;case ccui.Layout.CLIPPING_SCISSOR:this.scissorClippingVisit(e)}else ccui.Widget.CanvasRenderCmd.prototype.visit.call(this,e)},e._onRenderSaveCmd=function(e,t,i){var n=e||cc._renderContext,r=n.getContext();if(this._clipElemType){var o=r.canvas;this._locCache=ccui.Layout.CanvasRenderCmd._getSharedCache(),this._locCache.width=o.width,this._locCache.height=o.height,this._locCache.getContext("2d").drawImage(o,0,0)}else n.save(),n.save(),n.setTransform(this._worldTransform,t,i)},e._onRenderSaveSpriteCmd=function(e){var t=e||cc._renderContext;this._clipElemType&&t.setCompositeOperation("destination-in")},e._onRenderClipCmd=function(e){var t=e||cc._renderContext,i=t.getContext();this._clipElemType||(t.restore(),i.clip())},e._onRenderRestoreCmd=function(e){var t=e||cc._renderContext,i=t.getContext();this._clipElemType?(i.save(),i.setTransform(1,0,0,1,0,0),i.globalCompositeOperation="destination-over",i.drawImage(this._locCache,0,0),i.restore()):t.restore()},e.rebindStencilRendering=function(e){e._renderCmd.rendering=this.__stencilDraw},e.__stencilDraw=function(e,t,i){for(var n=(e||cc._renderContext).getContext(),r=this._buffer,o=0,s=r.length;o<s;o++){var a=r[o].verts,c=a[0];n.beginPath(),n.moveTo(c.x*t,-c.y*i);for(var l=1,u=a.length;l<u;l++)n.lineTo(a[l].x*t,-a[l].y*i);n.closePath()}},e.stencilClippingVisit=e.scissorClippingVisit=function(e){var t=this._node;if(t._clippingStencil&&t._clippingStencil.isVisible()&&(this._clipElemType=t._stencil instanceof cc.Sprite,this._syncStatus(e),this._dirtyFlag=0,cc.renderer.pushRenderCommand(this._rendererSaveCmd),this._clipElemType&&(cc.ProtectedNode.prototype.visit.call(t,e),cc.renderer.pushRenderCommand(this._rendererSaveCmdSprite)),t._clippingStencil.visit(this),cc.renderer.pushRenderCommand(this._rendererClipCmd),!this._clipElemType)){t.sortAllChildren(),t.sortAllProtectedChildren();for(var i,n=t._children,r=0,o=t._protectedChildren,s=0,a=n.length,c=o.length;s<a&&((i=n[s])&&i.getLocalZOrder()<0);s++)i.visit(this);for(;r<c&&((i=o[r])&&i.getLocalZOrder()<0);r++)i.visit(this);for(;s<a;s++)n[s].visit(this);for(;r<c;r++)o[r].visit(this);cc.renderer.pushRenderCommand(this._rendererRestoreCmd)}},ccui.Layout.CanvasRenderCmd._getSharedCache=function(){return cc.ClippingNode._sharedCache||(cc.ClippingNode._sharedCache=cc.newElement("canvas"))}}(),function(){ccui.Layout.WebGLRenderCmd=function(e){ccui.ProtectedNode.WebGLRenderCmd.call(this,e),this._needDraw=!1,this._currentStencilEnabled=0,this._currentStencilWriteMask=0,this._currentStencilFunc=0,this._currentStencilRef=0,this._currentStencilValueMask=0,this._currentStencilFail=0,this._currentStencilPassDepthFail=0,this._currentStencilPassDepthPass=0,this._currentDepthWriteMask=!1,this._mask_layer_le=0,this._beforeVisitCmdStencil=new cc.CustomRenderCmd(this,this._onBeforeVisitStencil),this._afterDrawStencilCmd=new cc.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmdStencil=new cc.CustomRenderCmd(this,this._onAfterVisitStencil),this._beforeVisitCmdScissor=new cc.CustomRenderCmd(this,this._onBeforeVisitScissor),this._afterVisitCmdScissor=new cc.CustomRenderCmd(this,this._onAfterVisitScissor)};var e=ccui.Layout.WebGLRenderCmd.prototype=Object.create(ccui.ProtectedNode.WebGLRenderCmd.prototype);e.constructor=ccui.Layout.WebGLRenderCmd,e.visit=function(e){var t=this._node;if(t._visible)if(t._adaptRenderers(),t._doLayout(),t._clippingEnabled)switch(t._clippingType){case ccui.Layout.CLIPPING_STENCIL:this.stencilClippingVisit(e);break;case ccui.Layout.CLIPPING_SCISSOR:this.scissorClippingVisit(e)}else ccui.Widget.WebGLRenderCmd.prototype.visit.call(this,e)},e._onBeforeVisitStencil=function(e){var t=e||cc._renderContext;ccui.Layout.WebGLRenderCmd._layer++;var i=1<<ccui.Layout.WebGLRenderCmd._layer,n=i-1;this._mask_layer_le=i|n,this._currentStencilEnabled=t.isEnabled(t.STENCIL_TEST),this._currentStencilWriteMask=t.getParameter(t.STENCIL_WRITEMASK),this._currentStencilFunc=t.getParameter(t.STENCIL_FUNC),this._currentStencilRef=t.getParameter(t.STENCIL_REF),this._currentStencilValueMask=t.getParameter(t.STENCIL_VALUE_MASK),this._currentStencilFail=t.getParameter(t.STENCIL_FAIL),this._currentStencilPassDepthFail=t.getParameter(t.STENCIL_PASS_DEPTH_FAIL),this._currentStencilPassDepthPass=t.getParameter(t.STENCIL_PASS_DEPTH_PASS),t.enable(t.STENCIL_TEST),t.stencilMask(i),this._currentDepthWriteMask=t.getParameter(t.DEPTH_WRITEMASK),t.depthMask(!1),t.stencilFunc(t.NEVER,i,i),t.stencilOp(t.ZERO,t.KEEP,t.KEEP),this._drawFullScreenQuadClearStencil(),t.stencilFunc(t.NEVER,i,i),t.stencilOp(t.REPLACE,t.KEEP,t.KEEP)},e._onAfterDrawStencil=function(e){var t=e||cc._renderContext;t.depthMask(this._currentDepthWriteMask),t.stencilFunc(t.EQUAL,this._mask_layer_le,this._mask_layer_le),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e._onAfterVisitStencil=function(e){var t=e||cc._renderContext;t.stencilFunc(this._currentStencilFunc,this._currentStencilRef,this._currentStencilValueMask),t.stencilOp(this._currentStencilFail,this._currentStencilPassDepthFail,this._currentStencilPassDepthPass),t.stencilMask(this._currentStencilWriteMask),this._currentStencilEnabled||t.disable(t.STENCIL_TEST),ccui.Layout.WebGLRenderCmd._layer--},e._onBeforeVisitScissor=function(e){var t=this._getClippingRect(),i=e||cc._renderContext;i.enable(i.SCISSOR_TEST),cc.view.setScissorInPoints(t.x,t.y,t.width,t.height)},e._onAfterVisitScissor=function(e){var t=e||cc._renderContext;t.disable(t.SCISSOR_TEST)},e._drawFullScreenQuadClearStencil=function(){cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPushMatrix(),cc.kmGLLoadIdentity(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPushMatrix(),cc.kmGLLoadIdentity(),cc._drawingUtil.drawSolidRect(cc.p(-1,-1),cc.p(1,1),cc.color(255,255,255,255)),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPopMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPopMatrix()},e.rebindStencilRendering=function(e){},e.transform=function(e,t){var i=this._node;ccui.ProtectedNode.WebGLRenderCmd.prototype.transform.call(this,e,t),i._clippingStencil&&i._clippingStencil._renderCmd.transform(this,t)},e.stencilClippingVisit=function(e){var t=this._node;if(t._clippingStencil&&t._clippingStencil.isVisible()){if(ccui.Layout.WebGLRenderCmd._layer+1==cc.stencilBits)return ccui.Layout.WebGLRenderCmd._visit_once=!0,ccui.Layout.WebGLRenderCmd._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its childs."),ccui.Layout.WebGLRenderCmd._visit_once=!1),void cc.Node.prototype.visit.call(t,e);cc.renderer.pushRenderCommand(this._beforeVisitCmdStencil);var i=cc.current_stack;i.stack.push(i.top),this._syncStatus(e),this._dirtyFlag=0,i.top=this._stackMatrix,t._clippingStencil.visit(this),cc.renderer.pushRenderCommand(this._afterDrawStencilCmd);var n=0,r=0;t.sortAllChildren(),t.sortAllProtectedChildren();for(var o,s=t._children,a=t._protectedChildren,c=s.length,l=a.length;n<c&&((o=s[n])&&o.getLocalZOrder()<0);n++)o.visit(this);for(;r<l&&((o=a[r])&&o.getLocalZOrder()<0);r++)o.visit(this);for(;n<c;n++)s[n].visit(this);for(;r<l;r++)a[r].visit(this);cc.renderer.pushRenderCommand(this._afterVisitCmdStencil),i.top=i.stack.pop()}},e.scissorClippingVisit=function(e){cc.renderer.pushRenderCommand(this._beforeVisitCmdScissor),cc.ProtectedNode.prototype.visit.call(this._node,e),cc.renderer.pushRenderCommand(this._afterVisitCmdScissor)},ccui.Layout.WebGLRenderCmd._layer=-1,ccui.Layout.WebGLRenderCmd._visit_once=null}(),ccui.Margin=ccui.Class.extend({left:0,top:0,right:0,bottom:0,ctor:function(e,t,i,n){void 0!==e&&void 0===t&&(this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom),void 0!==n&&(this.left=e,this.top=t,this.right=i,this.bottom=n)},setMargin:function(e,t,i,n){this.left=e,this.top=t,this.right=i,this.bottom=n},equals:function(e){return this.left==e.left&&this.top==e.top&&this.right==e.right&&this.bottom==e.bottom}}),ccui.MarginZero=function(){return new ccui.Margin(0,0,0,0)},ccui.LayoutParameter=ccui.Class.extend({_margin:null,_layoutParameterType:null,ctor:function(){this._margin=new ccui.Margin,this._layoutParameterType=ccui.LayoutParameter.NONE},setMargin:function(e){cc.isObject(e)?(this._margin.left=e.left,this._margin.top=e.top,this._margin.right=e.right,this._margin.bottom=e.bottom):(this._margin.left=arguments[0],this._margin.top=arguments[1],this._margin.right=arguments[2],this._margin.bottom=arguments[3])},getMargin:function(){return this._margin},getLayoutType:function(){return this._layoutParameterType},clone:function(){var e=this._createCloneInstance();return e._copyProperties(this),e},_createCloneInstance:function(){return new ccui.LayoutParameter},_copyProperties:function(e){this._margin.bottom=e._margin.bottom,this._margin.left=e._margin.left,this._margin.right=e._margin.right,this._margin.top=e._margin.top}}),ccui.LayoutParameter.create=function(){return new ccui.LayoutParameter},ccui.LayoutParameter.NONE=0,ccui.LayoutParameter.LINEAR=1,ccui.LayoutParameter.RELATIVE=2,ccui.LinearLayoutParameter=ccui.LayoutParameter.extend({_linearGravity:null,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this),this._linearGravity=ccui.LinearLayoutParameter.NONE,this._layoutParameterType=ccui.LayoutParameter.LINEAR},setGravity:function(e){this._linearGravity=e},getGravity:function(){return this._linearGravity},_createCloneInstance:function(){return new ccui.LinearLayoutParameter},_copyProperties:function(e){ccui.LayoutParameter.prototype._copyProperties.call(this,e),e instanceof ccui.LinearLayoutParameter&&this.setGravity(e._linearGravity)}}),ccui.LinearLayoutParameter.create=function(){return new ccui.LinearLayoutParameter},ccui.LinearLayoutParameter.NONE=0,ccui.LinearLayoutParameter.LEFT=1,ccui.LinearLayoutParameter.TOP=2,ccui.LinearLayoutParameter.RIGHT=3,ccui.LinearLayoutParameter.BOTTOM=4,ccui.LinearLayoutParameter.CENTER_VERTICAL=5,ccui.LinearLayoutParameter.CENTER_HORIZONTAL=6,ccui.RelativeLayoutParameter=ccui.LayoutParameter.extend({_relativeAlign:null,_relativeWidgetName:"",_relativeLayoutName:"",_put:!1,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this),this._relativeAlign=ccui.RelativeLayoutParameter.NONE,this._relativeWidgetName="",this._relativeLayoutName="",this._put=!1,this._layoutParameterType=ccui.LayoutParameter.RELATIVE},setAlign:function(e){this._relativeAlign=e},getAlign:function(){return this._relativeAlign},setRelativeToWidgetName:function(e){this._relativeWidgetName=e},getRelativeToWidgetName:function(){return this._relativeWidgetName},setRelativeName:function(e){this._relativeLayoutName=e},getRelativeName:function(){return this._relativeLayoutName},_createCloneInstance:function(){return new ccui.RelativeLayoutParameter},_copyProperties:function(e){ccui.LayoutParameter.prototype._copyProperties.call(this,e),e instanceof ccui.RelativeLayoutParameter&&(this.setAlign(e._relativeAlign),this.setRelativeToWidgetName(e._relativeWidgetName),this.setRelativeName(e._relativeLayoutName))}}),ccui.RelativeLayoutParameter.create=function(){return new ccui.RelativeLayoutParameter},ccui.RelativeLayoutParameter.NONE=0,ccui.RelativeLayoutParameter.PARENT_TOP_LEFT=1,ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL=2,ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT=3,ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL=4,ccui.RelativeLayoutParameter.CENTER_IN_PARENT=5,ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL=6,ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM=7,ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL=8,ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM=9,ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN=10,ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER=11,ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN=12,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN=13,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER=14,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN=15,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN=16,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER=17,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN=18,ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN=19,ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER=20,ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN=21,ccui.LINEAR_GRAVITY_NONE=0,ccui.LINEAR_GRAVITY_LEFT=1,ccui.LINEAR_GRAVITY_TOP=2,ccui.LINEAR_GRAVITY_RIGHT=3,ccui.LINEAR_GRAVITY_BOTTOM=4,ccui.LINEAR_GRAVITY_CENTER_VERTICAL=5,ccui.LINEAR_GRAVITY_CENTER_HORIZONTAL=6,ccui.RELATIVE_ALIGN_NONE=0,ccui.RELATIVE_ALIGN_PARENT_TOP_LEFT=1,ccui.RELATIVE_ALIGN_PARENT_TOP_CENTER_HORIZONTAL=2,ccui.RELATIVE_ALIGN_PARENT_TOP_RIGHT=3,ccui.RELATIVE_ALIGN_PARENT_LEFT_CENTER_VERTICAL=4,ccui.RELATIVE_ALIGN_PARENT_CENTER=5,ccui.RELATIVE_ALIGN_PARENT_RIGHT_CENTER_VERTICAL=6,ccui.RELATIVE_ALIGN_PARENT_LEFT_BOTTOM=7,ccui.RELATIVE_ALIGN_PARENT_BOTTOM_CENTER_HORIZONTAL=8,ccui.RELATIVE_ALIGN_PARENT_RIGHT_BOTTOM=9,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_LEFT=10,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_CENTER=11,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_RIGHT=12,ccui.RELATIVE_ALIGN_LOCATION_LEFT_TOP=13,ccui.RELATIVE_ALIGN_LOCATION_LEFT_CENTER=14,ccui.RELATIVE_ALIGN_LOCATION_LEFT_BOTTOM=15,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_TOP=16,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_CENTER=17,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_BOTTOM=18,ccui.RELATIVE_ALIGN_LOCATION_BELOW_TOP=19,ccui.RELATIVE_ALIGN_LOCATION_BELOW_CENTER=20,ccui.RELATIVE_ALIGN_LOCATION_BELOW_BOTTOM=21,ccui.getLayoutManager=function(e){switch(e){case ccui.Layout.LINEAR_VERTICAL:return ccui.linearVerticalLayoutManager;case ccui.Layout.LINEAR_HORIZONTAL:return ccui.linearHorizontalLayoutManager;case ccui.Layout.RELATIVE:return ccui.relativeLayoutManager}return null},ccui.linearVerticalLayoutManager={_doLayout:function(e){for(var t=e._getLayoutContentSize(),i=e._getLayoutElements(),n=t.height,r=0,o=i.length;r<o;r++){var s=i[r];if(s){var a=s.getLayoutParameter();if(a){var c=a.getGravity(),l=s.getAnchorPoint(),u=s.getContentSize(),h=l.x*u.width,d=n-(1-l.y)*u.height;switch(c){case ccui.LinearLayoutParameter.NONE:case ccui.LinearLayoutParameter.LEFT:break;case ccui.LinearLayoutParameter.RIGHT:h=t.width-(1-l.x)*u.width;break;case ccui.LinearLayoutParameter.CENTER_HORIZONTAL:h=t.width/2-u.width*(.5-l.x)}var p=a.getMargin();h+=p.left,d-=p.top,s.setPosition(h,d),n=s.getPositionY()-l.y*u.height-p.bottom}}}}},ccui.linearHorizontalLayoutManager={_doLayout:function(e){for(var t=e._getLayoutContentSize(),i=e._getLayoutElements(),n=0,r=0,o=i.length;r<o;r++){var s=i[r];if(s){var a=s.getLayoutParameter();if(a){var c=a.getGravity(),l=s.getAnchorPoint(),u=s.getContentSize(),h=n+l.x*u.width,d=t.height-(1-l.y)*u.height;switch(c){case ccui.LinearLayoutParameter.NONE:case ccui.LinearLayoutParameter.TOP:break;case ccui.LinearLayoutParameter.BOTTOM:d=l.y*u.height;break;case ccui.LinearLayoutParameter.CENTER_VERTICAL:d=t.height/2-u.height*(.5-l.y)}var p=a.getMargin();h+=p.left,d-=p.top,s.setPosition(h,d),n=s.getRightBoundary()+p.right}}}}},ccui.relativeLayoutManager={_unlayoutChildCount:0,_widgetChildren:[],_widget:null,_finalPositionX:0,_finalPositionY:0,_relativeWidgetLP:null,_doLayout:function(e){this._widgetChildren=this._getAllWidgets(e);for(var t=this._widgetChildren;this._unlayoutChildCount>0;){for(var i=0,n=t.length;i<n;i++){this._widget=t[i];var r=this._widget.getLayoutParameter();if(r){if(r._put)continue;if(!this._calculateFinalPositionWithRelativeWidget(e))continue;this._calculateFinalPositionWithRelativeAlign(),this._widget.setPosition(this._finalPositionX,this._finalPositionY),r._put=!0}}this._unlayoutChildCount--}this._widgetChildren.length=0},_getAllWidgets:function(e){var t=e._getLayoutElements(),i=this._widgetChildren;i.length=0;for(var n=0,r=t.length;n<r;n++){var o=t[n];o&&(o.getLayoutParameter()._put=!1,this._unlayoutChildCount++,i.push(o))}return i},_getRelativeWidget:function(e){var t=null,i=e.getLayoutParameter().getRelativeToWidgetName();if(i&&0!=i.length)for(var n=this._widgetChildren,r=0,o=n.length;r<o;r++){var s=n[r];if(s){var a=s.getLayoutParameter();if(a&&a.getRelativeName()==i){t=s,this._relativeWidgetLP=a;break}}}return t},_calculateFinalPositionWithRelativeWidget:function(e){var t=this._widget,i=t.getAnchorPoint(),n=t.getContentSize();this._finalPositionX=0,this._finalPositionY=0;var r=this._getRelativeWidget(t),o=t.getLayoutParameter().getAlign(),s=e._getLayoutContentSize();switch(o){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX=i.x*n.width,this._finalPositionY=s.height-(1-i.y)*n.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionX=.5*s.width-n.width*(.5-i.x),this._finalPositionY=s.height-(1-i.y)*n.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX=s.width-(1-i.x)*n.width,this._finalPositionY=s.height-(1-i.y)*n.height;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX=i.x*n.width,this._finalPositionY=.5*s.height-n.height*(.5-i.y);break;case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:this._finalPositionX=.5*s.width-n.width*(.5-i.x),this._finalPositionY=.5*s.height-n.height*(.5-i.y);break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX=s.width-(1-i.x)*n.width,this._finalPositionY=.5*s.height-n.height*(.5-i.y);break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX=i.x*n.width,this._finalPositionY=i.y*n.height;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionX=.5*s.width-n.width*(.5-i.x),this._finalPositionY=i.y*n.height;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX=s.width-(1-i.x)*n.width,this._finalPositionY=i.y*n.height;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()+i.y*n.height,this._finalPositionX=r.getLeftBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;a=r.getContentSize();this._finalPositionY=r.getTopBoundary()+i.y*n.height,this._finalPositionX=r.getLeftBoundary()+.5*a.width+i.x*n.width-.5*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()+i.y*n.height,this._finalPositionX=r.getRightBoundary()-(1-i.x)*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getLeftBoundary()-(1-i.x)*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;a=r.getContentSize();this._finalPositionX=r.getLeftBoundary()-(1-i.x)*n.width,this._finalPositionY=r.getBottomBoundary()+.5*a.height+i.y*n.height-.5*n.height}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()+i.y*n.height,this._finalPositionX=r.getLeftBoundary()-(1-i.x)*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getRightBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;var a=r.getContentSize(),c=r.getRightBoundary();this._finalPositionX=c+i.x*n.width,this._finalPositionY=r.getBottomBoundary()+.5*a.height+i.y*n.height-.5*n.height}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()+i.y*n.height,this._finalPositionX=r.getRightBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getLeftBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;a=r.getContentSize();this._finalPositionY=r.getBottomBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getLeftBoundary()+.5*a.width+i.x*n.width-.5*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getRightBoundary()-(1-i.x)*n.width}}return!0},_calculateFinalPositionWithRelativeAlign:function(){var e=this._widget.getLayoutParameter(),t=e.getMargin();switch(e.getAlign()){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX+=t.left,this._finalPositionY-=t.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionY-=t.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX-=t.right,this._finalPositionY-=t.top;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX+=t.left;break;case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX-=t.right;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX+=t.left,this._finalPositionY+=t.bottom;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionY+=t.bottom;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX-=t.right,this._finalPositionY+=t.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:this._finalPositionY+=t.bottom,this._finalPositionX+=t.left;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:this._finalPositionY+=t.bottom,this._finalPositionX-=t.right;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:this._finalPositionY+=t.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:this._finalPositionX-=t.right,this._finalPositionY-=t.top;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:this._finalPositionX-=t.right,this._finalPositionY+=t.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:this._finalPositionX-=t.right;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:this._finalPositionX+=t.left,this._finalPositionY-=t.top;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:this._finalPositionX+=t.left,this._finalPositionY+=t.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:this._finalPositionX+=t.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:this._finalPositionY-=t.top,this._finalPositionX+=t.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:this._finalPositionY-=t.top,this._finalPositionX-=t.right;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:this._finalPositionY-=t.top}}},ccui.HBox=ccui.Layout.extend({ctor:function(e){ccui.Layout.prototype.ctor.call(this,e),void 0!==e?this.initWithSize(e):this.init()},init:function(){return!!ccui.Layout.prototype.init.call(this)&&(this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL),!0)},initWithSize:function(e){return!!this.init()&&(this.setContentSize(e),!0)}}),ccui.HBox.create=function(e){return new ccui.HBox(e)},ccui.VBox=ccui.Layout.extend({ctor:function(e){ccui.Layout.prototype.ctor.call(this,e),void 0!==e?this.initWithSize(e):this.init()},init:function(){return!!ccui.Layout.prototype.init.call(this)&&(this.setLayoutType(ccui.Layout.LINEAR_VERTICAL),!0)},initWithSize:function(e){return!!this.init()&&(this.setContentSize(e),!0)}}),ccui.VBox.create=function(e){return new ccui.VBox(e)},ccui.RelativeBox=ccui.Layout.extend({ctor:function(e){e?this.initWithSize(e):this.init()},init:function(){return!!ccui.Layout.prototype.init.call(this)&&(this.setLayoutType(ccui.Layout.RELATIVE),!0)},initWithSize:function(e){return!!this.init()&&(this.setContentSize(e),!0)}}),ccui.RelativeBox.create=function(e){return new ccui.RelativeBox(e)},ccui.helper={seekWidgetByTag:function(e,t){if(!e)return null;if(e.getTag()==t)return e;for(var i=e.getChildren(),n=i.length,r=0;r<n;r++){var o=i[r],s=ccui.helper.seekWidgetByTag(o,t);if(null!=s)return s}return null},seekWidgetByName:function(e,t){if(!e)return null;if(e.getName()==t)return e;for(var i=e.getChildren(),n=i.length,r=0;r<n;r++){var o=i[r],s=ccui.helper.seekWidgetByName(o,t);if(null!=s)return s}return null},seekWidgetByRelativeName:function(e,t){if(!e)return null;for(var i=e.getChildren(),n=i.length,r=0;r<n;r++){var o=i[r],s=o.getLayoutParameter(ccui.LayoutParameter.RELATIVE);if(s&&s.getRelativeName()==t)return o}return null},seekActionWidgetByActionTag:function(e,t){if(!e)return null;if(e.getActionTag()==t)return e;for(var i=e.getChildren(),n=0;n<i.length;n++){var r=i[n],o=ccui.helper.seekActionWidgetByActionTag(r,t);if(null!=o)return o}return null},_activeLayout:!0,doLayout:function(e){if(this._activeLayout)for(var t,i=e.getChildren(),n=0,r=i.length;n<r;n++){var o=(t=i[n]).getComponent(ccui.LayoutComponent.NAME),s=t.getParent();null!=o&&null!=s&&o.refreshLayout&&o.refreshLayout()}},changeLayoutSystemActiveState:function(e){this._activeLayout=e},restrictCapInsetRect:function(e,t){var i=e.x,n=e.y,r=e.width,o=e.height;return t.width<r&&(i=0,r=0),t.height<o&&(n=0,o=0),cc.rect(i,n,r,o)}},ccui.Button=ccui.Widget.extend({_buttonNormalRenderer:null,_buttonClickedRenderer:null,_buttonDisableRenderer:null,_titleRenderer:null,_normalFileName:"",_clickedFileName:"",_disabledFileName:"",_prevIgnoreSize:!0,_scale9Enabled:!1,_capInsetsNormal:null,_capInsetsPressed:null,_capInsetsDisabled:null,_normalTexType:ccui.Widget.LOCAL_TEXTURE,_pressedTexType:ccui.Widget.LOCAL_TEXTURE,_disabledTexType:ccui.Widget.LOCAL_TEXTURE,_normalTextureSize:null,_pressedTextureSize:null,_disabledTextureSize:null,pressedActionEnabled:!1,_titleColor:null,_normalTextureScaleXInSize:1,_normalTextureScaleYInSize:1,_pressedTextureScaleXInSize:1,_pressedTextureScaleYInSize:1,_zoomScale:.1,_normalTextureLoaded:!1,_pressedTextureLoaded:!1,_disabledTextureLoaded:!1,_className:"Button",_normalTextureAdaptDirty:!0,_pressedTextureAdaptDirty:!0,_disabledTextureAdaptDirty:!0,_fontName:"Thonburi",_fontSize:12,_type:0,ctor:function(e,t,i,n){this._capInsetsNormal=cc.rect(0,0,0,0),this._capInsetsPressed=cc.rect(0,0,0,0),this._capInsetsDisabled=cc.rect(0,0,0,0),this._normalTextureSize=cc.size(0,0),this._pressedTextureSize=cc.size(0,0),this._disabledTextureSize=cc.size(0,0),this._titleColor=cc.color.WHITE,ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0),this.init(e,t,i,n)},init:function(e,t,i,n){if(ccui.Widget.prototype.init.call(this)){if(void 0===e)return!0;this.loadTextures(e,t,i,n)}return!1},_initRenderer:function(){this._buttonNormalRenderer=new cc.Sprite,this._buttonClickedRenderer=new cc.Sprite,this._buttonDisableRenderer=new cc.Sprite,this._titleRenderer=new cc.LabelTTF(""),this._titleRenderer.setAnchorPoint(.5,.5),this.addProtectedChild(this._buttonNormalRenderer,ccui.Button.NORMAL_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonClickedRenderer,ccui.Button.PRESSED_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonDisableRenderer,ccui.Button.DISABLED_RENDERER_ZORDER,-1),this.addProtectedChild(this._titleRenderer,ccui.Button.TITLE_RENDERER_ZORDER,-1)},setScale9Enabled:function(e){if(this._scale9Enabled!=e){if(this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this._scale9Enabled=e,this.removeProtectedChild(this._buttonNormalRenderer),this.removeProtectedChild(this._buttonClickedRenderer),this.removeProtectedChild(this._buttonDisableRenderer),this._scale9Enabled?(this._buttonNormalRenderer=new ccui.Scale9Sprite,this._buttonClickedRenderer=new ccui.Scale9Sprite,this._buttonDisableRenderer=new ccui.Scale9Sprite):(this._buttonNormalRenderer=new cc.Sprite,this._buttonClickedRenderer=new cc.Sprite,this._buttonDisableRenderer=new cc.Sprite),this._buttonClickedRenderer.setVisible(!1),this._buttonDisableRenderer.setVisible(!1),this.loadTextureNormal(this._normalFileName,this._normalTexType),this.loadTexturePressed(this._clickedFileName,this._pressedTexType),this.loadTextureDisabled(this._disabledFileName,this._disabledTexType),this.addProtectedChild(this._buttonNormalRenderer,ccui.Button.NORMAL_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonClickedRenderer,ccui.Button.PRESSED_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonDisableRenderer,ccui.Button.DISABLED_RENDERER_ZORDER,-1),this._scale9Enabled){var t=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsetsNormalRenderer(this._capInsetsNormal),this.setCapInsetsPressedRenderer(this._capInsetsPressed),this.setCapInsetsDisabledRenderer(this._capInsetsDisabled),this.setBright(this._bright),this._normalTextureAdaptDirty=!0,this._pressedTextureAdaptDirty=!0,this._disabledTextureAdaptDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(e){this._unifySize?this._updateContentSize():(!this._scale9Enabled||this._scale9Enabled&&!e)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,e),this._prevIgnoreSize=e)},getVirtualRendererSize:function(){return this._unifySize?this._getNormalSize():!this._normalTextureLoaded&&this._titleRenderer.getString().length>0?this._titleRenderer.getContentSize():cc.size(this._normalTextureSize)},loadTextures:function(e,t,i,n){this.loadTextureNormal(e,n),this.loadTexturePressed(t,n),this.loadTextureDisabled(i,n)},loadTextureNormal:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._normalFileName=e,this._normalTexType=t;var i=this,n=this._buttonNormalRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTextureNormal(e,t)}),this._normalTexType){case ccui.Widget.LOCAL_TEXTURE:n.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:n.initWithSpriteFrameName(e)}this._normalTextureSize=this._buttonNormalRenderer.getContentSize(),this._updateChildrenDisplayedRGBA(),this._unifySize?this._scale9Enabled&&(n.setCapInsets(this._capInsetsNormal),this._updateContentSizeWithTextureSize(this._getNormalSize())):this._updateContentSizeWithTextureSize(this._normalTextureSize),this._normalTextureLoaded=!0,this._normalTextureAdaptDirty=!0,this._findLayout()}},loadTexturePressed:function(e,t){if(e&&(this._clickedFileName!=e||this._pressedTexType!=t)){t=t||ccui.Widget.LOCAL_TEXTURE,this._clickedFileName=e,this._pressedTexType=t;var i=this,n=this._buttonClickedRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTexturePressed(e,t)}),this._pressedTexType){case ccui.Widget.LOCAL_TEXTURE:n.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:n.initWithSpriteFrameName(e)}this._scale9Enabled&&n.setCapInsets(this._capInsetsPressed),this._pressedTextureSize=this._buttonClickedRenderer.getContentSize(),this._updateChildrenDisplayedRGBA(),this._pressedTextureLoaded=!0,this._pressedTextureAdaptDirty=!0,this._findLayout()}},loadTextureDisabled:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._disabledFileName=e,this._disabledTexType=t;var i=this,n=this._buttonDisableRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTextureDisabled(e,t)}),this._disabledTexType){case ccui.Widget.LOCAL_TEXTURE:n.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:n.initWithSpriteFrameName(e)}this._scale9Enabled&&n.setCapInsets(this._capInsetsDisabled),this._disabledTextureSize=this._buttonDisableRenderer.getContentSize(),this._updateChildrenDisplayedRGBA(),this._disabledTextureLoaded=!0,this._disabledTextureAdaptDirty=!0,this._findLayout()}},setCapInsets:function(e){this.setCapInsetsNormalRenderer(e),this.setCapInsetsPressedRenderer(e),this.setCapInsetsDisabledRenderer(e)},setCapInsetsNormalRenderer:function(e){if(e){var t=e.x,i=e.y,n=e.width,r=e.height;this._normalTextureSize.width<n&&(t=0,n=0),this._normalTextureSize.height<r&&(i=0,r=0);var o=this._capInsetsNormal;o.x=t,o.y=i,o.width=n,o.height=r,this._scale9Enabled&&this._buttonNormalRenderer.setCapInsets(o)}},getCapInsetsNormalRenderer:function(){return cc.rect(this._capInsetsNormal)},setCapInsetsPressedRenderer:function(e){if(e&&this._scale9Enabled){var t=e.x,i=e.y,n=e.width,r=e.height;this._normalTextureSize.width<n&&(t=0,n=0),this._normalTextureSize.height<r&&(i=0,r=0);var o=this._capInsetsPressed;o.x=t,o.y=i,o.width=n,o.height=r,this._buttonClickedRenderer.setCapInsets(o)}},getCapInsetsPressedRenderer:function(){return cc.rect(this._capInsetsPressed)},setCapInsetsDisabledRenderer:function(e){if(e&&this._scale9Enabled){var t=e.x,i=e.y,n=e.width,r=e.height;this._normalTextureSize.width<n&&(t=0,n=0),this._normalTextureSize.height<r&&(i=0,r=0);var o=this._capInsetsDisabled;o.x=t,o.y=i,o.width=n,o.height=r,this._buttonDisableRenderer.setCapInsets(o)}},getCapInsetsDisabledRenderer:function(){return cc.rect(this._capInsetsDisabled)},_onPressStateChangedToNormal:function(){if(this._buttonNormalRenderer.setVisible(!0),this._buttonClickedRenderer.setVisible(!1),this._buttonDisableRenderer.setVisible(!1),this._scale9Enabled&&this._buttonNormalRenderer.setState(ccui.Scale9Sprite.state.NORMAL),this._pressedTextureLoaded){if(this.pressedActionEnabled)if(this._buttonNormalRenderer.stopAllActions(),this._buttonClickedRenderer.stopAllActions(),this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize),this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize),this._titleRenderer.stopAllActions(),this._unifySize){var e=cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,1,1);this._titleRenderer.runAction(e)}else this._titleRenderer.setScaleX(1),this._titleRenderer.setScaleY(1)}else this._buttonNormalRenderer.stopAllActions(),this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize),this._titleRenderer.stopAllActions(),this._scale9Enabled&&this._buttonNormalRenderer.setColor(cc.color.WHITE),this._titleRenderer.setScaleX(1),this._titleRenderer.setScaleY(1)},_onPressStateChangedToPressed:function(){var e=this._buttonNormalRenderer;if(this._scale9Enabled&&e.setState(ccui.Scale9Sprite.state.NORMAL),this._pressedTextureLoaded){if(e.setVisible(!1),this._buttonClickedRenderer.setVisible(!0),this._buttonDisableRenderer.setVisible(!1),this.pressedActionEnabled){e.stopAllActions(),this._buttonClickedRenderer.stopAllActions();var t=cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,this._pressedTextureScaleXInSize+this._zoomScale,this._pressedTextureScaleYInSize+this._zoomScale);this._buttonClickedRenderer.runAction(t),e.setScale(this._pressedTextureScaleXInSize+this._zoomScale,this._pressedTextureScaleYInSize+this._zoomScale),this._titleRenderer.stopAllActions(),this._titleRenderer.runAction(cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,1+this._zoomScale,1+this._zoomScale))}}else e.setVisible(!0),this._buttonClickedRenderer.setVisible(!0),this._buttonDisableRenderer.setVisible(!1),e.stopAllActions(),e.setScale(this._normalTextureScaleXInSize+this._zoomScale,this._normalTextureScaleYInSize+this._zoomScale),this._titleRenderer.stopAllActions(),this._titleRenderer.setScaleX(1+this._zoomScale),this._titleRenderer.setScaleY(1+this._zoomScale)},_onPressStateChangedToDisabled:function(){this._disabledTextureLoaded?(this._buttonNormalRenderer.setVisible(!1),this._buttonDisableRenderer.setVisible(!0)):this._normalTextureLoaded&&this._scale9Enabled&&this._buttonNormalRenderer.setState(ccui.Scale9Sprite.state.GRAY),this._buttonClickedRenderer.setVisible(!1),this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize),this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize)},_updateContentSize:function(){if(this._unifySize){if(this._scale9Enabled)ccui.ProtectedNode.setContentSize(this._customSize);else{var e=this._getNormalSize();ccui.ProtectedNode.setContentSize(e)}this._onSizeChanged()}else this._ignoreSize&&this.setContentSize(this.getVirtualRendererSize())},_updateTexturesRGBA:function(){this._buttonNormalRenderer.setColor(this.getColor()),this._buttonClickedRenderer.setColor(this.getColor()),this._buttonDisableRenderer.setColor(this.getColor()),this._buttonNormalRenderer.setOpacity(this.getOpacity()),this._buttonClickedRenderer.setOpacity(this.getOpacity()),this._buttonDisableRenderer.setOpacity(this.getOpacity())},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._updateTitleLocation(),this._normalTextureAdaptDirty=!0,this._pressedTextureAdaptDirty=!0,this._disabledTextureAdaptDirty=!0},getVirtualRenderer:function(){if(!this._bright)return this._buttonDisableRenderer;switch(this._brightStyle){case ccui.Widget.BRIGHT_STYLE_NORMAL:return this._buttonNormalRenderer;case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:return this._buttonClickedRenderer;default:return null}},_normalTextureScaleChangedWithSize:function(){if(this._ignoreSize&&!this._unifySize)this._scale9Enabled||(this._buttonNormalRenderer.setScale(1),this._normalTextureScaleXInSize=this._normalTextureScaleYInSize=1);else if(this._scale9Enabled)this._buttonNormalRenderer.setPreferredSize(this._contentSize),this._normalTextureScaleXInSize=this._normalTextureScaleYInSize=1,this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize);else{var e=this._normalTextureSize;if(e.width<=0||e.height<=0)return void this._buttonNormalRenderer.setScale(1);var t=this._contentSize.width/e.width,i=this._contentSize.height/e.height;this._buttonNormalRenderer.setScaleX(t),this._buttonNormalRenderer.setScaleY(i),this._normalTextureScaleXInSize=t,this._normalTextureScaleYInSize=i}this._buttonNormalRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_pressedTextureScaleChangedWithSize:function(){if(this._ignoreSize&&!this._unifySize)this._scale9Enabled||(this._buttonClickedRenderer.setScale(1),this._pressedTextureScaleXInSize=this._pressedTextureScaleYInSize=1);else if(this._scale9Enabled)this._buttonClickedRenderer.setPreferredSize(this._contentSize),this._pressedTextureScaleXInSize=this._pressedTextureScaleYInSize=1,this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize);else{var e=this._pressedTextureSize;if(e.width<=0||e.height<=0)return void this._buttonClickedRenderer.setScale(1);var t=this._contentSize.width/e.width,i=this._contentSize.height/e.height;this._buttonClickedRenderer.setScaleX(t),this._buttonClickedRenderer.setScaleY(i),this._pressedTextureScaleXInSize=t,this._pressedTextureScaleYInSize=i}this._buttonClickedRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_disabledTextureScaleChangedWithSize:function(){if(this._ignoreSize&&!this._unifySize)this._scale9Enabled&&this._buttonDisableRenderer.setScale(1);else if(this._scale9Enabled)this._buttonDisableRenderer.setScale(1),this._buttonDisableRenderer.setPreferredSize(this._contentSize);else{var e=this._disabledTextureSize;if(e.width<=0||e.height<=0)return void this._buttonDisableRenderer.setScale(1);var t=this._contentSize.width/e.width,i=this._contentSize.height/e.height;this._buttonDisableRenderer.setScaleX(t),this._buttonDisableRenderer.setScaleY(i)}this._buttonDisableRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_adaptRenderers:function(){this._normalTextureAdaptDirty&&(this._normalTextureScaleChangedWithSize(),this._normalTextureAdaptDirty=!1),this._pressedTextureAdaptDirty&&(this._pressedTextureScaleChangedWithSize(),this._pressedTextureAdaptDirty=!1),this._disabledTextureAdaptDirty&&(this._disabledTextureScaleChangedWithSize(),this._disabledTextureAdaptDirty=!1)},_updateTitleLocation:function(){this._titleRenderer.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},setPressedActionEnabled:function(e){this.pressedActionEnabled=e},setTitleText:function(e){if(e!=this.getTitleText())if(this._titleRenderer.setString(e),this._ignoreSize){var t=this.getVirtualRendererSize();this.setContentSize(t)}else this._titleRenderer._renderCmd._updateTTF()},getTitleText:function(){return this._titleRenderer.getString()},setTitleColor:function(e){this._titleRenderer.setFontFillColor(e)},getTitleColor:function(){return this._titleRenderer._getFillStyle()},setTitleFontSize:function(e){this._titleRenderer.setFontSize(e),this._fontSize=e},getTitleFontSize:function(){return this._titleRenderer.getFontSize()},setZoomScale:function(e){this._zoomScale=e},getZoomScale:function(){return this._zoomScale},getNormalTextureSize:function(){return this._normalTextureSize},setTitleFontName:function(e){this._titleRenderer.setFontName(e),this._fontName=e},getTitleRenderer:function(){return this._titleRenderer},getTitleFontName:function(){return this._titleRenderer.getFontName()},_setTitleFont:function(e){this._titleRenderer.font=e},_getTitleFont:function(){return this._titleRenderer.font},getDescription:function(){return"Button"},_createCloneInstance:function(){return new ccui.Button},_copySpecialProperties:function(e){this._prevIgnoreSize=e._prevIgnoreSize,this.setScale9Enabled(e._scale9Enabled),this.loadTextureNormal(e._normalFileName,e._normalTexType),this.loadTexturePressed(e._clickedFileName,e._pressedTexType),this.loadTextureDisabled(e._disabledFileName,e._disabledTexType),this.setCapInsetsNormalRenderer(e._capInsetsNormal),this.setCapInsetsPressedRenderer(e._capInsetsPressed),this.setCapInsetsDisabledRenderer(e._capInsetsDisabled),this.setTitleText(e.getTitleText()),this.setTitleFontName(e.getTitleFontName()),this.setTitleFontSize(e.getTitleFontSize()),this.setTitleColor(e.getTitleColor()),this.setPressedActionEnabled(e.pressedActionEnabled),this.setZoomScale(e._zoomScale)},setColor:function(e){cc.ProtectedNode.prototype.setColor.call(this,e),this._updateTexturesRGBA()},_getNormalSize:function(){var e;null!=this._titleRenderer&&(e=this._titleRenderer.getContentSize());var t;null!=this._buttonNormalRenderer&&(t=this._buttonNormalRenderer.getContentSize());var i=e.width>t.width?e.width:t.width,n=e.height>t.height?e.height:t.height;return cc.size(i,n)}}),(_p=ccui.Button.prototype).titleText,cc.defineGetterSetter(_p,"titleText",_p.getTitleText,_p.setTitleText),_p.titleFont,cc.defineGetterSetter(_p,"titleFont",_p._getTitleFont,_p._setTitleFont),_p.titleFontSize,cc.defineGetterSetter(_p,"titleFontSize",_p.getTitleFontSize,_p.setTitleFontSize),_p.titleFontName,cc.defineGetterSetter(_p,"titleFontName",_p.getTitleFontName,_p.setTitleFontName),_p.titleColor,cc.defineGetterSetter(_p,"titleColor",_p.getTitleColor,_p.setTitleColor),_p=null,ccui.Button.create=function(e,t,i,n){return new ccui.Button(e,t,i,n)},ccui.Button.NORMAL_RENDERER_ZORDER=-2,ccui.Button.PRESSED_RENDERER_ZORDER=-2,ccui.Button.DISABLED_RENDERER_ZORDER=-2,ccui.Button.TITLE_RENDERER_ZORDER=-1,ccui.Button.ZOOM_ACTION_TIME_STEP=.05,ccui.Button.SYSTEM=0,ccui.Button.TTF=1,ccui.CheckBox=ccui.Widget.extend({_backGroundBoxRenderer:null,_backGroundSelectedBoxRenderer:null,_frontCrossRenderer:null,_backGroundBoxDisabledRenderer:null,_frontCrossDisabledRenderer:null,_isSelected:!0,_checkBoxEventListener:null,_checkBoxEventSelector:null,_backGroundTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundSelectedTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundDisabledTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossDisabledTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundFileName:"",_backGroundSelectedFileName:"",_frontCrossFileName:"",_backGroundDisabledFileName:"",_frontCrossDisabledFileName:"",_className:"CheckBox",_zoomScale:.1,_backgroundTextureScaleX:.1,_backgroundTextureScaleY:.1,_backGroundBoxRendererAdaptDirty:!0,_backGroundSelectedBoxRendererAdaptDirty:!0,_frontCrossRendererAdaptDirty:!0,_backGroundBoxDisabledRendererAdaptDirty:!0,_frontCrossDisabledRendererAdaptDirty:!0,ctor:function(e,t,i,n,r,o){ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0);for(var s=0,a=0;a<arguments.length;a++){var c=typeof arguments[a];"string"==c?isNaN(arguments[a]-0)?s++:(o=arguments[a],arguments[a]=void 0):"number"==c&&s++}switch(s){case 2:o=i,i=t,t=void 0}o=void 0===o?0:o,this.init(e,t,i,n,r,o)},init:function(e,t,i,n,r,o){return!!ccui.Widget.prototype.init.call(this)&&(this._isSelected=!0,this.setSelected(!1),this.loadTextures(e,t,i,n,r,o),!0)},_initRenderer:function(){this._backGroundBoxRenderer=new cc.Sprite,this._backGroundSelectedBoxRenderer=new cc.Sprite,this._frontCrossRenderer=new cc.Sprite,this._backGroundBoxDisabledRenderer=new cc.Sprite,this._frontCrossDisabledRenderer=new cc.Sprite,this.addProtectedChild(this._backGroundBoxRenderer,ccui.CheckBox.BOX_RENDERER_ZORDER,-1),this.addProtectedChild(this._backGroundSelectedBoxRenderer,ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER,-1),this.addProtectedChild(this._frontCrossRenderer,ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER,-1),this.addProtectedChild(this._backGroundBoxDisabledRenderer,ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER,-1),this.addProtectedChild(this._frontCrossDisabledRenderer,ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER,-1)},loadTextures:function(e,t,i,n,r,o){e&&this.loadTextureBackGround(e,o),t&&this.loadTextureBackGroundSelected(t,o),i&&this.loadTextureFrontCross(i,o),n&&this.loadTextureBackGroundDisabled(n,o),r&&this.loadTextureFrontCrossDisabled(r,o)},loadTextureBackGround:function(e,t){if(e&&(this._backGroundFileName!=e||this._backGroundTexType!=t)){t=t||ccui.Widget.LOCAL_TEXTURE,this._backGroundFileName=e,this._backGroundTexType=t;var i=this._backGroundBoxRenderer;switch(i._textureLoaded?this._backGroundBoxRenderer.setContentSize(this._customSize):i.addEventListener("load",function(){this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize()),this.loadTextureBackGround(e,t)},this),this._backGroundTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize()),this._backGroundBoxRendererAdaptDirty=!0,this._findLayout()}},loadTextureBackGroundSelected:function(e,t){if(e&&(this._backGroundSelectedFileName!=e||this._backGroundSelectedTexType!=t)){t=t||ccui.Widget.LOCAL_TEXTURE,this._backGroundSelectedFileName=e,this._backGroundSelectedTexType=t;var i=this._backGroundSelectedBoxRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureBackGroundSelected(e,t)},this),this._backGroundSelectedTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._backGroundSelectedBoxRendererAdaptDirty=!0,this._findLayout()}},loadTextureFrontCross:function(e,t){if(e&&(this._frontCrossFileName!=e||this._frontCrossTexType!=t)){t=t||ccui.Widget.LOCAL_TEXTURE,this._frontCrossFileName=e,this._frontCrossTexType=t;var i=this._frontCrossRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureFrontCross(e,t)},this),this._frontCrossTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._frontCrossRendererAdaptDirty=!0,this._findLayout()}},loadTextureBackGroundDisabled:function(e,t){if(e&&(this._backGroundDisabledFileName!=e||this._backGroundDisabledTexType!=t)){t=t||ccui.Widget.LOCAL_TEXTURE,this._backGroundDisabledFileName=e,this._backGroundDisabledTexType=t;var i=this._backGroundBoxDisabledRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureBackGroundDisabled(e,t)},this),this._backGroundDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._backGroundBoxDisabledRendererAdaptDirty=!0,this._findLayout()}},loadTextureFrontCrossDisabled:function(e,t){if(e&&(this._frontCrossDisabledFileName!=e||this._frontCrossDisabledTexType!=t)){t=t||ccui.Widget.LOCAL_TEXTURE,this._frontCrossDisabledFileName=e,this._frontCrossDisabledTexType=t;var i=this._frontCrossDisabledRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureFrontCrossDisabled(e,t)},this),this._frontCrossDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._frontCrossDisabledRendererAdaptDirty=!0,this._findLayout()}},_onPressStateChangedToNormal:function(){this._backGroundBoxRenderer.setVisible(!0),this._backGroundSelectedBoxRenderer.setVisible(!1),this._backGroundBoxDisabledRenderer.setVisible(!1),this._frontCrossDisabledRenderer.setVisible(!1),this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._isSelected&&this._frontCrossRenderer.setVisible(!0)},_onPressStateChangedToPressed:function(){this._backGroundSelectedFileName?(this._backGroundBoxRenderer.setVisible(!1),this._backGroundSelectedBoxRenderer.setVisible(!0),this._backGroundBoxDisabledRenderer.setVisible(!1),this._frontCrossDisabledRenderer.setVisible(!1)):(this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX+this._zoomScale,this._backgroundTextureScaleY+this._zoomScale),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX+this._zoomScale,this._backgroundTextureScaleY+this._zoomScale))},_onPressStateChangedToDisabled:function(){this._backGroundDisabledFileName&&this._frontCrossDisabledFileName&&(this._backGroundBoxRenderer.setVisible(!1),this._backGroundBoxDisabledRenderer.setVisible(!0)),this._backGroundSelectedBoxRenderer.setVisible(!1),this._frontCrossRenderer.setVisible(!1),this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._isSelected&&this._frontCrossDisabledRenderer.setVisible(!0)},setZoomScale:function(e){this._zoomScale=e},getZoomScale:function(){return this._zoomScale},setSelectedState:function(e){this.setSelected(e)},setSelected:function(e){e!=this._isSelected&&(this._isSelected=e,this._frontCrossRenderer.setVisible(this._isSelected))},getSelectedState:function(){return this.isSelected()},isSelected:function(){return this._isSelected},_selectedEvent:function(){this._checkBoxEventSelector&&(this._checkBoxEventListener?this._checkBoxEventSelector.call(this._checkBoxEventListener,this,ccui.CheckBox.EVENT_SELECTED):this._checkBoxEventSelector(this,ccui.CheckBox.EVENT_SELECTED))},_unSelectedEvent:function(){this._checkBoxEventSelector&&(this._checkBoxEventListener?this._checkBoxEventSelector.call(this._checkBoxEventListener,this,ccui.CheckBox.EVENT_UNSELECTED):this._checkBoxEventSelector(this,ccui.CheckBox.EVENT_UNSELECTED))},_releaseUpEvent:function(){ccui.Widget.prototype._releaseUpEvent.call(this),this._isSelected?(this.setSelected(!1),this._unSelectedEvent()):(this.setSelected(!0),this._selectedEvent())},addEventListenerCheckBox:function(e,t){this.addEventListener(e,t)},addEventListener:function(e,t){this._checkBoxEventSelector=e,this._checkBoxEventListener=t},getVirtualRendererSize:function(){return this._backGroundBoxRenderer.getContentSize()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._backGroundBoxRendererAdaptDirty=!0,this._backGroundSelectedBoxRendererAdaptDirty=!0,this._frontCrossRendererAdaptDirty=!0,this._backGroundBoxDisabledRendererAdaptDirty=!0,this._frontCrossDisabledRendererAdaptDirty=!0},getVirtualRenderer:function(){return this._backGroundBoxRenderer},_backGroundTextureScaleChangedWithSize:function(){var e=this._backGroundBoxRenderer,t=this._contentSize;if(this._ignoreSize)e.setScale(1),this._backgroundTextureScaleX=this._backgroundTextureScaleY=1;else{var i=e.getContentSize();if(i.width<=0||i.height<=0)return e.setScale(1),void(this._backgroundTextureScaleX=this._backgroundTextureScaleY=1);var n=t.width/i.width,r=t.height/i.height;this._backgroundTextureScaleX=n,this._backgroundTextureScaleY=r,e.setScaleX(n),e.setScaleY(r)}e.setPosition(.5*t.width,.5*t.height)},_backGroundSelectedTextureScaleChangedWithSize:function(){var e=this._backGroundSelectedBoxRenderer,t=this._contentSize;if(this._ignoreSize)e.setScale(1);else{var i=e.getContentSize();if(i.width<=0||i.height<=0)return void e.setScale(1);var n=t.width/i.width,r=t.height/i.height;e.setScaleX(n),e.setScaleY(r)}e.setPosition(.5*t.width,.5*t.height)},_frontCrossTextureScaleChangedWithSize:function(){var e=this._frontCrossRenderer,t=this._contentSize;if(this._ignoreSize)e.setScale(1);else{var i=e.getContentSize();if(i.width<=0||i.height<=0)return void e.setScale(1);var n=t.width/i.width,r=t.height/i.height;e.setScaleX(n),e.setScaleY(r)}e.setPosition(.5*t.width,.5*t.height)},_backGroundDisabledTextureScaleChangedWithSize:function(){var e=this._backGroundBoxDisabledRenderer,t=this._contentSize;if(this._ignoreSize)e.setScale(1);else{var i=e.getContentSize();if(i.width<=0||i.height<=0)return void e.setScale(1);var n=t.width/i.width,r=t.height/i.height;e.setScaleX(n),e.setScaleY(r)}e.setPosition(.5*t.width,.5*t.height)},_frontCrossDisabledTextureScaleChangedWithSize:function(){var e=this._frontCrossDisabledRenderer,t=this._contentSize;if(this._ignoreSize)e.setScale(1);else{var i=e.getContentSize();if(i.width<=0||i.height<=0)return void e.setScale(1);var n=t.width/i.width,r=t.height/i.height;e.setScaleX(n),e.setScaleY(r)}e.setPosition(.5*t.width,.5*t.height)},getDescription:function(){return"CheckBox"},_createCloneInstance:function(){return new ccui.CheckBox},_copySpecialProperties:function(e){e instanceof ccui.CheckBox&&(this.loadTextureBackGround(e._backGroundFileName,e._backGroundTexType),this.loadTextureBackGroundSelected(e._backGroundSelectedFileName,e._backGroundSelectedTexType),this.loadTextureFrontCross(e._frontCrossFileName,e._frontCrossTexType),this.loadTextureBackGroundDisabled(e._backGroundDisabledFileName,e._backGroundDisabledTexType),this.loadTextureFrontCrossDisabled(e._frontCrossDisabledFileName,e._frontCrossDisabledTexType),this.setSelected(e._isSelected),this._checkBoxEventListener=e._checkBoxEventListener,this._checkBoxEventSelector=e._checkBoxEventSelector,this._ccEventCallback=e._ccEventCallback,this._zoomScale=e._zoomScale,this._backgroundTextureScaleX=e._backgroundTextureScaleX,this._backgroundTextureScaleY=e._backgroundTextureScaleY)},_adaptRenderers:function(){this._backGroundBoxRendererAdaptDirty&&(this._backGroundTextureScaleChangedWithSize(),this._backGroundBoxRendererAdaptDirty=!1),this._backGroundSelectedBoxRendererAdaptDirty&&(this._backGroundSelectedTextureScaleChangedWithSize(),this._backGroundSelectedBoxRendererAdaptDirty=!1),this._frontCrossRendererAdaptDirty&&(this._frontCrossTextureScaleChangedWithSize(),this._frontCrossRendererAdaptDirty=!1),this._backGroundBoxDisabledRendererAdaptDirty&&(this._backGroundDisabledTextureScaleChangedWithSize(),this._backGroundBoxDisabledRendererAdaptDirty=!1),this._frontCrossDisabledRendererAdaptDirty&&(this._frontCrossDisabledTextureScaleChangedWithSize(),this._frontCrossDisabledRendererAdaptDirty=!1)}}),(_p=ccui.CheckBox.prototype).selected,cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),_p=null,ccui.CheckBox.create=function(e,t,i,n,r,o){return new ccui.CheckBox(e,t,i,n,r,o)},ccui.CheckBox.EVENT_SELECTED=0,ccui.CheckBox.EVENT_UNSELECTED=1,ccui.CheckBox.BOX_RENDERER_ZORDER=-1,ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER=-1,ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER=-1,ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER=-1,ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER=-1,ccui.ImageView=ccui.Widget.extend({_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_imageRenderer:null,_textureFile:"",_imageTexType:ccui.Widget.LOCAL_TEXTURE,_imageTextureSize:null,_className:"ImageView",_imageRendererAdaptDirty:!0,ctor:function(e,t){this._capInsets=cc.rect(0,0,0,0),this._imageTextureSize=cc.size(this._capInsets.width,this._capInsets.height),ccui.Widget.prototype.ctor.call(this),t=void 0===t?0:t,this.init(e,t)},init:function(e,t){return!!ccui.Widget.prototype.init.call(this)&&(void 0===e?this._imageTexType=ccui.Widget.LOCAL_TEXTURE:this.loadTexture(e,t),!0)},_initRenderer:function(){this._imageRenderer=new cc.Sprite,this.addProtectedChild(this._imageRenderer,ccui.ImageView.RENDERER_ZORDER,-1)},setRotation:function(e){this._imageRenderer.setRotation(e)},loadTexture:function(e,t){if(e){var i=this;t=t||ccui.Widget.LOCAL_TEXTURE,this._textureFile=e,this._imageTexType=t;var n=i._imageRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTexture(e,t)}),i._imageTexType){case ccui.Widget.LOCAL_TEXTURE:i._scale9Enabled?(n.initWithFile(e),n.setCapInsets(i._capInsets)):n.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i._scale9Enabled?(n.initWithSpriteFrameName(e),n.setCapInsets(i._capInsets)):n.initWithSpriteFrameName(e)}i._imageTextureSize=n.getContentSize(),this._updateChildrenDisplayedRGBA(),i._updateContentSizeWithTextureSize(i._imageTextureSize),i._imageRendererAdaptDirty=!0,i._findLayout()}},setTextureRect:function(e){this._scale9Enabled||this._imageRenderer.setTextureRect(e)},setScale9Enabled:function(e){if(this._scale9Enabled!=e){if(this._scale9Enabled=e,this.removeProtectedChild(this._imageRenderer),this._imageRenderer=null,this._scale9Enabled?this._imageRenderer=new ccui.Scale9Sprite:this._imageRenderer=new cc.Sprite,this.loadTexture(this._textureFile,this._imageTexType),this.addProtectedChild(this._imageRenderer,ccui.ImageView.RENDERER_ZORDER,-1),this._scale9Enabled){var t=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsets(this._capInsets),this._imageRendererAdaptDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(e){(!this._scale9Enabled||this._scale9Enabled&&!e)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,e),this._prevIgnoreSize=e)},setCapInsets:function(e){if(e){var t=this._capInsets;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,this._scale9Enabled&&this._imageRenderer.setCapInsets(e)}},getCapInsets:function(){return cc.rect(this._capInsets)},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._imageRendererAdaptDirty=!0},_adaptRenderers:function(){this._imageRendererAdaptDirty&&(this._imageTextureScaleChangedWithSize(),this._imageRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return cc.size(this._imageTextureSize)},getVirtualRenderer:function(){return this._imageRenderer},_imageTextureScaleChangedWithSize:function(){if(this._ignoreSize)this._scale9Enabled||this._imageRenderer.setScale(1);else if(this._scale9Enabled)this._imageRenderer.setPreferredSize(this._contentSize),this._imageRenderer.setScale(1);else{var e=this._imageTextureSize;if(e.width<=0||e.height<=0)return void this._imageRenderer.setScale(1);this._imageRenderer.setScaleX(this._contentSize.width/e.width),this._imageRenderer.setScaleY(this._contentSize.height/e.height)}this._imageRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"ImageView"},_createCloneInstance:function(){return new ccui.ImageView},_copySpecialProperties:function(e){e instanceof ccui.ImageView&&(this._prevIgnoreSize=e._prevIgnoreSize,this.setScale9Enabled(e._scale9Enabled),this.loadTexture(e._textureFile,e._imageTexType),this.setCapInsets(e._capInsets))},setContentSize:function(e,t){if(null!=t&&(e=cc.size(e,t)),ccui.Widget.prototype.setContentSize.call(this,e),this._scale9Enabled)this._imageRenderer.setContentSize(e);else{var i=this._imageRenderer.getContentSize();this._imageRenderer.setScaleX(e.width/i.width),this._imageRenderer.setScaleY(e.height/i.height)}}}),ccui.ImageView.create=function(e,t){return new ccui.ImageView(e,t)},ccui.ImageView.RENDERER_ZORDER=-1,ccui.LoadingBar=ccui.Widget.extend({_direction:null,_percent:100,_totalLength:0,_barRenderer:null,_renderBarTexType:ccui.Widget.LOCAL_TEXTURE,_barRendererTextureSize:null,_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_textureFile:"",_isTextureLoaded:!1,_className:"LoadingBar",_barRendererAdaptDirty:!0,ctor:function(e,t){this._direction=ccui.LoadingBar.TYPE_LEFT,this._barRendererTextureSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),ccui.Widget.prototype.ctor.call(this),void 0!==e&&this.loadTexture(e),void 0!==t&&this.setPercent(t)},_initRenderer:function(){this._barRenderer=new cc.Sprite,this.addProtectedChild(this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1),this._barRenderer.setAnchorPoint(0,.5)},setDirection:function(e){if(this._direction!=e)switch(this._direction=e,this._direction){case ccui.LoadingBar.TYPE_LEFT:this._barRenderer.setAnchorPoint(0,.5),this._barRenderer.setPosition(0,.5*this._contentSize.height),this._scale9Enabled||this._barRenderer.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:this._barRenderer.setAnchorPoint(1,.5),this._barRenderer.setPosition(this._totalLength,.5*this._contentSize.height),this._scale9Enabled||this._barRenderer.setFlippedX(!0)}},getDirection:function(){return this._direction},loadTexture:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._renderBarTexType=t,this._textureFile=e;var i=this._barRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadTexture(e,t)}),this._renderBarTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}var r=i.getContentSize();switch(this._barRendererTextureSize.width=r.width,this._barRendererTextureSize.height=r.height,this._direction){case ccui.LoadingBar.TYPE_LEFT:i.setAnchorPoint(0,.5),this._scale9Enabled||i.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:i.setAnchorPoint(1,.5),this._scale9Enabled||i.setFlippedX(!0)}this._scale9Enabled&&i.setCapInsets(this._capInsets),this._updateChildrenDisplayedRGBA(),this._barRendererScaleChangedWithSize(),this._updateContentSizeWithTextureSize(this._barRendererTextureSize),this._barRendererAdaptDirty=!0,this._findLayout()}},setScale9Enabled:function(e){if(this._scale9Enabled!=e){if(this._scale9Enabled=e,this.removeProtectedChild(this._barRenderer),this._barRenderer=this._scale9Enabled?new ccui.Scale9Sprite:new cc.Sprite,this.loadTexture(this._textureFile,this._renderBarTexType),this.addProtectedChild(this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1),this._scale9Enabled){var t=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsets(this._capInsets),this.setPercent(this._percent),this._barRendererAdaptDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},setCapInsets:function(e){if(e){var t=this._capInsets;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,this._scale9Enabled&&this._barRenderer.setCapInsets(e)}},getCapInsets:function(){return cc.rect(this._capInsets)},setPercent:function(e){if(e>100&&(e=100),e<0&&(e=0),e!=this._percent&&(this._percent=e,!(this._totalLength<=0))){var t=this._percent/100;if(this._scale9Enabled)this._setScale9Scale();else{var i=this._barRenderer.getTextureRect();i.width=this._barRendererTextureSize.width*t,this._barRenderer.setTextureRect(cc.rect(i.x,i.y,this._barRendererTextureSize.width*t,this._barRendererTextureSize.height))}}},setContentSize:function(e,t){ccui.Widget.prototype.setContentSize.call(this,e,t),this._totalLength=void 0===t?e.width:e},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._barRendererAdaptDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1)},ignoreContentAdaptWithSize:function(e){(!this._scale9Enabled||this._scale9Enabled&&!e)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,e),this._prevIgnoreSize=e)},getVirtualRendererSize:function(){return cc.size(this._barRendererTextureSize)},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){var e=this._barRenderer,t=this._contentSize;if(this._unifySize)this._totalLength=this._contentSize.width,this.setPercent(this._percent);else if(this._ignoreSize)this._scale9Enabled||(this._totalLength=this._barRendererTextureSize.width,e.setScale(1));else if(this._totalLength=t.width,this._scale9Enabled)this._setScale9Scale(),e.setScale(1);else{var i=this._barRendererTextureSize;if(i.width<=0||i.height<=0)return void e.setScale(1);var n=t.width/i.width,r=t.height/i.height;e.setScaleX(n),e.setScaleY(r)}switch(this._direction){case ccui.LoadingBar.TYPE_LEFT:e.setPosition(0,.5*t.height);break;case ccui.LoadingBar.TYPE_RIGHT:e.setPosition(this._totalLength,.5*t.height)}},_setScale9Scale:function(){var e=this._percent/100*this._totalLength;this._barRenderer.setPreferredSize(cc.size(e,this._contentSize.height))},getDescription:function(){return"LoadingBar"},_createCloneInstance:function(){return new ccui.LoadingBar},_copySpecialProperties:function(e){e instanceof ccui.LoadingBar&&(this._prevIgnoreSize=e._prevIgnoreSize,this.setScale9Enabled(e._scale9Enabled),this.loadTexture(e._textureFile,e._renderBarTexType),this.setCapInsets(e._capInsets),this.setPercent(e._percent),this.setDirection(e._direction))}}),(_p=ccui.LoadingBar.prototype).direction,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),_p.percent,cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent),_p=null,ccui.LoadingBar.create=function(e,t){return new ccui.LoadingBar(e,t)},ccui.LoadingBar.TYPE_LEFT=0,ccui.LoadingBar.TYPE_RIGHT=1,ccui.LoadingBar.RENDERER_ZORDER=-1,ccui.Slider=ccui.Widget.extend({_barRenderer:null,_progressBarRenderer:null,_barTextureSize:null,_progressBarTextureSize:null,_slidBallNormalRenderer:null,_slidBallPressedRenderer:null,_slidBallDisabledRenderer:null,_slidBallRenderer:null,_barLength:0,_percent:0,_scale9Enabled:!1,_prevIgnoreSize:!0,_textureFile:"",_progressBarTextureFile:"",_slidBallNormalTextureFile:"",_slidBallPressedTextureFile:"",_slidBallDisabledTextureFile:"",_capInsetsBarRenderer:null,_capInsetsProgressBarRenderer:null,_sliderEventListener:null,_sliderEventSelector:null,_barTexType:ccui.Widget.LOCAL_TEXTURE,_progressBarTexType:ccui.Widget.LOCAL_TEXTURE,_ballNTexType:ccui.Widget.LOCAL_TEXTURE,_ballPTexType:ccui.Widget.LOCAL_TEXTURE,_ballDTexType:ccui.Widget.LOCAL_TEXTURE,_isTextureLoaded:!1,_className:"Slider",_barRendererAdaptDirty:!0,_progressBarRendererDirty:!0,_unifySize:!1,_zoomScale:.1,_sliderBallNormalTextureScaleX:1,_sliderBallNormalTextureScaleY:1,ctor:function(e,t,i){this._barTextureSize=cc.size(0,0),this._progressBarTextureSize=cc.size(0,0),this._capInsetsBarRenderer=cc.rect(0,0,0,0),this._capInsetsProgressBarRenderer=cc.rect(0,0,0,0),ccui.Widget.prototype.ctor.call(this),i=null==i?0:i,this.setTouchEnabled(!0),e&&this.loadBarTexture(e,i),t&&this.loadSlidBallTextures(t,i)},init:function(){return ccui.Widget.prototype.init.call(this)},_initRenderer:function(){this._barRenderer=new cc.Sprite,this._progressBarRenderer=new cc.Sprite,this._progressBarRenderer.setAnchorPoint(0,.5),this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,-1),this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1),this._slidBallNormalRenderer=new cc.Sprite,this._slidBallPressedRenderer=new cc.Sprite,this._slidBallPressedRenderer.setVisible(!1),this._slidBallDisabledRenderer=new cc.Sprite,this._slidBallDisabledRenderer.setVisible(!1),this._slidBallRenderer=new cc.Node,this._slidBallRenderer.addChild(this._slidBallNormalRenderer),this._slidBallRenderer.addChild(this._slidBallPressedRenderer),this._slidBallRenderer.addChild(this._slidBallDisabledRenderer),this._slidBallRenderer.setCascadeColorEnabled(!0),this._slidBallRenderer.setCascadeOpacityEnabled(!0),this.addProtectedChild(this._slidBallRenderer,ccui.Slider.BALL_RENDERER_ZORDER,-1)},loadBarTexture:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._textureFile=e,this._barTexType=t;var i=this._barRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadBarTexture(e,t)}),this._barTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._barRendererAdaptDirty=!0,this._progressBarRendererDirty=!0,this._updateContentSizeWithTextureSize(this._barRenderer.getContentSize()),this._findLayout(),this._barTextureSize=this._barRenderer.getContentSize()}},loadProgressBarTexture:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._progressBarTextureFile=e,this._progressBarTexType=t;var i=this._progressBarRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadProgressBarTexture(e,t)}),this._progressBarTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._progressBarRenderer.setAnchorPoint(cc.p(0,.5));var r=this._progressBarRenderer.getContentSize();this._progressBarTextureSize={width:r.width,height:r.height},this._progressBarRendererDirty=!0,this._findLayout()}},setScale9Enabled:function(e){if(this._scale9Enabled!=e){if(this._scale9Enabled=e,this.removeProtectedChild(this._barRenderer,!0),this.removeProtectedChild(this._progressBarRenderer,!0),this._barRenderer=null,this._progressBarRenderer=null,this._scale9Enabled?(this._barRenderer=new ccui.Scale9Sprite,this._progressBarRenderer=new ccui.Scale9Sprite):(this._barRenderer=new cc.Sprite,this._progressBarRenderer=new cc.Sprite),this.loadBarTexture(this._textureFile,this._barTexType),this.loadProgressBarTexture(this._progressBarTextureFile,this._progressBarTexType),this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,-1),this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1),this._scale9Enabled){var t=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsetsBarRenderer(this._capInsetsBarRenderer),this.setCapInsetProgressBarRenderer(this._capInsetsProgressBarRenderer),this._barRendererAdaptDirty=!0,this._progressBarRendererDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(e){(!this._scale9Enabled||this._scale9Enabled&&!e)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,e),this._prevIgnoreSize=e)},setCapInsets:function(e){this.setCapInsetsBarRenderer(e),this.setCapInsetProgressBarRenderer(e)},setCapInsetsBarRenderer:function(e){if(e){var t=this._capInsetsBarRenderer;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,this._scale9Enabled&&this._barRenderer.setCapInsets(e)}},getCapInsetsBarRenderer:function(){return cc.rect(this._capInsetsBarRenderer)},setCapInsetProgressBarRenderer:function(e){if(e){var t=this._capInsetsProgressBarRenderer;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,this._scale9Enabled&&this._progressBarRenderer.setCapInsets(e)}},getCapInsetsProgressBarRenderer:function(){return cc.rect(this._capInsetsProgressBarRenderer)},loadSlidBallTextures:function(e,t,i,n){this.loadSlidBallTextureNormal(e,n),this.loadSlidBallTexturePressed(t,n),this.loadSlidBallTextureDisabled(i,n)},loadSlidBallTextureNormal:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._slidBallNormalTextureFile=e,this._ballNTexType=t;var i=this;switch(this._slidBallNormalRenderer._textureLoaded||this._slidBallNormalRenderer.addEventListener("load",function(){i.loadSlidBallTextureNormal(e,t)}),this._ballNTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallNormalRenderer.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallNormalRenderer.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},loadSlidBallTexturePressed:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._slidBallPressedTextureFile=e,this._ballPTexType=t;var i=this;switch(this._slidBallPressedRenderer._textureLoaded||this._slidBallPressedRenderer.addEventListener("load",function(){i.loadSlidBallTexturePressed(e,t)}),this._ballPTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallPressedRenderer.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallPressedRenderer.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},loadSlidBallTextureDisabled:function(e,t){if(e){t=t||ccui.Widget.LOCAL_TEXTURE,this._slidBallDisabledTextureFile=e,this._ballDTexType=t;var i=this;switch(this._slidBallDisabledRenderer._textureLoaded||this._slidBallDisabledRenderer.addEventListener("load",function(){i.loadSlidBallTextureDisabled(e,t)}),this._ballDTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallDisabledRenderer.initWithFile(e);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallDisabledRenderer.initWithSpriteFrameName(e)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},setPercent:function(e){e>100&&(e=100),e<0&&(e=0),this._percent=e;var t=e/100,i=this._barLength*t;if(this._slidBallRenderer.setPosition(i,this._contentSize.height/2),this._scale9Enabled)this._progressBarRenderer.setPreferredSize(cc.size(i,this._contentSize.height));else{var n=this._progressBarRenderer,r=n.getTextureRect();n.setTextureRect(cc.rect(r.x,r.y,i,r.height),n.isTextureRectRotated())}},hitTest:function(e){var t=this._slidBallNormalRenderer.convertToNodeSpace(e),i=this._slidBallNormalRenderer.getContentSize(),n=cc.rect(0,0,i.width,i.height);return t.x>=n.x&&t.x<=n.x+n.width&&t.y>=n.y&&t.y<=n.y+n.height},onTouchBegan:function(e,t){var i=ccui.Widget.prototype.onTouchBegan.call(this,e,t);if(this._hit){var n=this.convertToNodeSpace(this._touchBeganPosition);this.setPercent(this._getPercentWithBallPos(n.x)),this._percentChangedEvent()}return i},onTouchMoved:function(e,t){var i=e.getLocation(),n=this.convertToNodeSpace(i);this.setPercent(this._getPercentWithBallPos(n.x)),this._percentChangedEvent()},onTouchEnded:function(e,t){ccui.Widget.prototype.onTouchEnded.call(this,e,t)},onTouchCancelled:function(e,t){ccui.Widget.prototype.onTouchCancelled.call(this,e,t)},_getPercentWithBallPos:function(e){return e/this._barLength*100},addEventListenerSlider:function(e,t){this.addEventListener(e,t)},addEventListener:function(e,t){this._sliderEventSelector=e,this._sliderEventListener=t},_percentChangedEvent:function(){this._sliderEventSelector&&(this._sliderEventListener?this._sliderEventSelector.call(this._sliderEventListener,this,ccui.Slider.EVENT_PERCENT_CHANGED):this._sliderEventSelector(this,ccui.Slider.EVENT_PERCENT_CHANGED)),this._ccEventCallback&&this._ccEventCallback(this,ccui.Slider.EVENT_PERCENT_CHANGED)},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._barRendererAdaptDirty=!0,this._progressBarRendererDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1),this._progressBarRendererDirty&&(this._progressBarRendererScaleChangedWithSize(),this._progressBarRendererDirty=!1)},getVirtualRendererSize:function(){return this._barRenderer.getContentSize()},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){if(this._unifySize)this._barLength=this._contentSize.width,this._barRenderer.setPreferredSize(this._contentSize);else if(this._ignoreSize)this._barRenderer.setScale(1),this._barLength=this._contentSize.width;else if(this._barLength=this._contentSize.width,this._scale9Enabled)this._barRenderer.setPreferredSize(this._contentSize),this._barRenderer.setScale(1);else{var e=this._barTextureSize;if(e.width<=0||e.height<=0)return void this._barRenderer.setScale(1);var t=this._contentSize.width/e.width,i=this._contentSize.height/e.height;this._barRenderer.setScaleX(t),this._barRenderer.setScaleY(i)}this._barRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2),this.setPercent(this._percent)},_progressBarRendererScaleChangedWithSize:function(){if(this._unifySize)this._progressBarRenderer.setPreferredSize(this._contentSize);else if(this._ignoreSize){if(!this._scale9Enabled){var e=this._progressBarTextureSize,t=this._contentSize.width/e.width,i=this._contentSize.height/e.height;this._progressBarRenderer.setScaleX(t),this._progressBarRenderer.setScaleY(i)}}else if(this._scale9Enabled)this._progressBarRenderer.setPreferredSize(this._contentSize),this._progressBarRenderer.setScale(1);else{if((e=this._progressBarTextureSize).width<=0||e.height<=0)return void this._progressBarRenderer.setScale(1);var t=this._contentSize.width/e.width,i=this._contentSize.height/e.height;this._progressBarRenderer.setScaleX(t),this._progressBarRenderer.setScaleY(i)}this._progressBarRenderer.setPosition(0,this._contentSize.height/2),this.setPercent(this._percent)},_onPressStateChangedToNormal:function(){this._slidBallNormalRenderer.setVisible(!0),this._slidBallPressedRenderer.setVisible(!1),this._slidBallDisabledRenderer.setVisible(!1),this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX,this._sliderBallNormalTextureScaleY)},_onPressStateChangedToPressed:function(){this._slidBallPressedTextureFile?(this._slidBallNormalRenderer.setVisible(!1),this._slidBallPressedRenderer.setVisible(!0),this._slidBallDisabledRenderer.setVisible(!1)):this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX+this._zoomScale,this._sliderBallNormalTextureScaleY+this._zoomScale)},_onPressStateChangedToDisabled:function(){this._slidBallDisabledTextureFile&&(this._slidBallNormalRenderer.setVisible(!1),this._slidBallDisabledRenderer.setVisible(!0)),this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX,this._sliderBallNormalTextureScaleY),this._slidBallPressedRenderer.setVisible(!1)},setZoomScale:function(e){this._zoomScale=e},getZoomScale:function(){return this._zoomScale},getDescription:function(){return"Slider"},_createCloneInstance:function(){return new ccui.Slider},_copySpecialProperties:function(e){this._prevIgnoreSize=e._prevIgnoreSize,this.setScale9Enabled(e._scale9Enabled),this.loadBarTexture(e._textureFile,e._barTexType),this.loadProgressBarTexture(e._progressBarTextureFile,e._progressBarTexType),this.loadSlidBallTextureNormal(e._slidBallNormalTextureFile,e._ballNTexType),this.loadSlidBallTexturePressed(e._slidBallPressedTextureFile,e._ballPTexType),this.loadSlidBallTextureDisabled(e._slidBallDisabledTextureFile,e._ballDTexType),this.setPercent(e.getPercent()),this._sliderEventListener=e._sliderEventListener,this._sliderEventSelector=e._sliderEventSelector,this._zoomScale=e._zoomScale,this._ccEventCallback=e._ccEventCallback}}),(_p=ccui.Slider.prototype).percent,cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent),_p=null,ccui.Slider.create=function(e,t,i){return new ccui.Slider(e,t,i)},ccui.Slider.EVENT_PERCENT_CHANGED=0,ccui.Slider.BASEBAR_RENDERER_ZORDER=-3,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER=-2,ccui.Slider.BALL_RENDERER_ZORDER=-1,ccui.Text=ccui.Widget.extend({_touchScaleChangeEnabled:!1,_normalScaleValueX:1,_normalScaleValueY:1,_fontName:"Thonburi",_fontSize:10,_onSelectedScaleOffset:.5,_labelRenderer:"",_textAreaSize:null,_textVerticalAlignment:0,_textHorizontalAlignment:0,_className:"Text",_type:null,_labelRendererAdaptDirty:!0,ctor:function(e,t,i){this._type=ccui.Text.Type.SYSTEM,this._textAreaSize=cc.size(0,0),ccui.Widget.prototype.ctor.call(this),void 0!==i&&this.init(e,t,i)},init:function(e,t,i){return!!ccui.Widget.prototype.init.call(this)&&(arguments.length>0&&(this.setFontName(t),this.setFontSize(i),this.setString(e)),!0)},_initRenderer:function(){this._labelRenderer=new cc.LabelTTF,this.addProtectedChild(this._labelRenderer,ccui.Text.RENDERER_ZORDER,-1)},setText:function(e){cc.log("Please use the setString"),this.setString(e)},setString:function(e){e!=this._labelRenderer.getString()&&(this._labelRenderer.setString(e),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0)},getStringValue:function(){return cc.log("Please use the getString"),this._labelRenderer.getString()},getString:function(){return this._labelRenderer.getString()},getStringLength:function(){return this._labelRenderer.getStringLength()},setFontSize:function(e){this._labelRenderer.setFontSize(e),this._fontSize=e,this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getFontSize:function(){return this._fontSize},setFontName:function(e){this._fontName=e,this._labelRenderer.setFontName(e),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getFontName:function(){return this._fontName},_setFont:function(e){var t=cc.LabelTTF._fontStyleRE.exec(e);t&&(this._fontSize=parseInt(t[1]),this._fontName=t[2],this._labelRenderer._setFont(e),this._labelScaleChangedWithSize())},_getFont:function(){return this._labelRenderer._getFont()},getType:function(){return this._type},setTextAreaSize:function(e){this._labelRenderer.setDimensions(e),this._ignoreSize||(this._customSize=e),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getTextAreaSize:function(){return this._labelRenderer.getDimensions()},setTextHorizontalAlignment:function(e){this._labelRenderer.setHorizontalAlignment(e),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getTextHorizontalAlignment:function(){return this._labelRenderer.getHorizontalAlignment()},setTextVerticalAlignment:function(e){this._labelRenderer.setVerticalAlignment(e),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getTextVerticalAlignment:function(){return this._labelRenderer.getVerticalAlignment()},setTouchScaleChangeEnabled:function(e){this._touchScaleChangeEnabled=e},isTouchScaleChangeEnabled:function(){return this._touchScaleChangeEnabled},_onPressStateChangedToNormal:function(){this._touchScaleChangeEnabled&&(this._labelRenderer.setScaleX(this._normalScaleValueX),this._labelRenderer.setScaleY(this._normalScaleValueY))},_onPressStateChangedToPressed:function(){this._touchScaleChangeEnabled&&(this._labelRenderer.setScaleX(this._normalScaleValueX+this._onSelectedScaleOffset),this._labelRenderer.setScaleY(this._normalScaleValueY+this._onSelectedScaleOffset))},_onPressStateChangedToDisabled:function(){},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelRendererAdaptDirty&&(this._labelScaleChangedWithSize(),this._labelRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelRenderer},getAutoRenderSize:function(){var e=this._labelRenderer.getContentSize();return this._ignoreSize||(this._labelRenderer.setDimensions(0,0),e=this._labelRenderer.getContentSize(),this._labelRenderer.setDimensions(this._contentSize.width,this._contentSize.height)),e},_labelScaleChangedWithSize:function(){var e=this._contentSize;if(this._ignoreSize)this._labelRenderer.setDimensions(0,0),this._labelRenderer.setScale(1),this._normalScaleValueX=this._normalScaleValueY=1;else{this._labelRenderer.setDimensions(cc.size(e.width,e.height));var t=this._labelRenderer.getContentSize();if(t.width<=0||t.height<=0)return void this._labelRenderer.setScale(1);var i=e.width/t.width,n=e.height/t.height;this._labelRenderer.setScaleX(i),this._labelRenderer.setScaleY(n),this._normalScaleValueX=i,this._normalScaleValueY=n}this._labelRenderer.setPosition(e.width/2,e.height/2)},getDescription:function(){return"Label"},enableShadow:function(e,t,i){this._labelRenderer.enableShadow(e,t,i)},enableOutline:function(e,t){this._labelRenderer.enableStroke(e,t)},enableGlow:function(e){this._type==ccui.Text.Type.TTF&&this._labelRenderer.enableGlow(e)},disableEffect:function(){this._labelRenderer.disableEffect&&this._labelRenderer.disableEffect()},_createCloneInstance:function(){return new ccui.Text},_copySpecialProperties:function(e){e instanceof ccui.Text&&(this.setFontName(e._fontName),this.setFontSize(e.getFontSize()),this.setString(e.getString()),this.setTouchScaleChangeEnabled(e.touchScaleEnabled),this.setTextAreaSize(e._textAreaSize),this.setTextHorizontalAlignment(e._labelRenderer.getHorizontalAlignment()),this.setTextVerticalAlignment(e._labelRenderer.getVerticalAlignment()),this.setContentSize(e.getContentSize()))},_setBoundingWidth:function(e){this._textAreaSize.width=e,this._labelRenderer._setBoundingWidth(e),this._labelScaleChangedWithSize()},_setBoundingHeight:function(e){this._textAreaSize.height=e,this._labelRenderer._setBoundingHeight(e),this._labelScaleChangedWithSize()},_getBoundingWidth:function(){return this._textAreaSize.width},_getBoundingHeight:function(){return this._textAreaSize.height},_changePosition:function(){this._adaptRenderers()},setColor:function(e){cc.ProtectedNode.prototype.setColor.call(this,e),this._labelRenderer.setColor(e)},setTextColor:function(e){this._labelRenderer.setFontFillColor(e)},getTextColor:function(){return this._labelRenderer._getFillStyle()}}),(_p=ccui.Text.prototype).boundingWidth,cc.defineGetterSetter(_p,"boundingWidth",_p._getBoundingWidth,_p._setBoundingWidth),_p.boundingHeight,cc.defineGetterSetter(_p,"boundingHeight",_p._getBoundingHeight,_p._setBoundingHeight),_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.stringLength,cc.defineGetterSetter(_p,"stringLength",_p.getStringLength),_p.font,cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont),_p.fontSize,cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),_p.fontName,cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),_p.textAlign,cc.defineGetterSetter(_p,"textAlign",_p.getTextHorizontalAlignment,_p.setTextHorizontalAlignment),_p.verticalAlign,cc.defineGetterSetter(_p,"verticalAlign",_p.getTextVerticalAlignment,_p.setTextVerticalAlignment),_p=null,ccui.Label=ccui.Text.create=function(e,t,i){return new ccui.Text(e,t,i)},ccui.Text.RENDERER_ZORDER=-1,ccui.Text.Type={SYSTEM:0,TTF:1},ccui.TextAtlas=ccui.Widget.extend({_labelAtlasRenderer:null,_stringValue:"",_charMapFileName:"",_itemWidth:0,_itemHeight:0,_startCharMap:"",_className:"TextAtlas",_labelAtlasRendererAdaptDirty:null,ctor:function(e,t,i,n,r){ccui.Widget.prototype.ctor.call(this),void 0!==r&&this.setProperty(e,t,i,n,r)},_initRenderer:function(){this._labelAtlasRenderer=new cc.LabelAtlas,this._labelAtlasRenderer.setAnchorPoint(cc.p(.5,.5)),this.addProtectedChild(this._labelAtlasRenderer,ccui.TextAtlas.RENDERER_ZORDER,-1)},setProperty:function(e,t,i,n,r){this._stringValue=e,this._charMapFileName=t,this._itemWidth=i,this._itemHeight=n,this._startCharMap=r,this._labelAtlasRenderer.initWithString(e,this._charMapFileName,this._itemWidth,this._itemHeight,this._startCharMap[0]),this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()),this._labelAtlasRendererAdaptDirty=!0},setString:function(e){e!=this._labelAtlasRenderer.getString()&&(this._stringValue=e,this._labelAtlasRenderer.setString(e),this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()),this._labelAtlasRendererAdaptDirty=!0)},setStringValue:function(e){cc.log("Please use the setString"),this.setString(e)},getStringValue:function(){return cc.log("Please use the getString"),this.getString()},getString:function(){return this._labelAtlasRenderer.getString()},getStringLength:function(){return this._labelAtlasRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelAtlasRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelAtlasRendererAdaptDirty&&(this._labelAtlasScaleChangedWithSize(),this._labelAtlasRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelAtlasRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelAtlasRenderer},_labelAtlasScaleChangedWithSize:function(){var e=this._labelAtlasRenderer;if(this._ignoreSize)e.setScale(1);else{var t=e.getContentSize();if(t.width<=0||t.height<=0)return void e.setScale(1);e.setScaleX(this._contentSize.width/t.width),e.setScaleY(this._contentSize.height/t.height)}e.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"LabelAtlas"},_copySpecialProperties:function(e){e&&this.setProperty(e._stringValue,e._charMapFileName,e._itemWidth,e._itemHeight,e._startCharMap)},_createCloneInstance:function(){return new ccui.TextAtlas}}),(_p=ccui.TextAtlas.prototype).string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p=null,ccui.TextAtlas.create=function(e,t,i,n,r){return new ccui.TextAtlas(e,t,i,n,r)},ccui.TextAtlas.RENDERER_ZORDER=-1,ccui.LabelBMFont=ccui.TextBMFont=ccui.Widget.extend({_labelBMFontRenderer:null,_fntFileHasInit:!1,_fntFileName:"",_stringValue:"",_className:"TextBMFont",_labelBMFontRendererAdaptDirty:!0,ctor:function(e,t){ccui.Widget.prototype.ctor.call(this),void 0!=t&&(this.setFntFile(t),this.setString(e))},_initRenderer:function(){this._labelBMFontRenderer=new cc.LabelBMFont,this.addProtectedChild(this._labelBMFontRenderer,ccui.TextBMFont.RENDERER_ZORDER,-1)},setFntFile:function(e){if(e){this._fntFileName=e,this._fntFileHasInit=!0,this._labelBMFontRenderer.initWithString(this._stringValue,e),this._updateContentSizeWithTextureSize(this._labelBMFontRenderer.getContentSize()),this._labelBMFontRendererAdaptDirty=!0;var t=this,i=t._labelBMFontRenderer;i._textureLoaded||i.addEventListener("load",function(){t.setFntFile(e)})}},setText:function(e){cc.log("Please use the setString"),this.setString(e)},setString:function(e){e!=this._labelBMFontRenderer.getString()&&(this._stringValue=e,this._labelBMFontRenderer.setString(e),this._fntFileHasInit&&(this._updateContentSizeWithTextureSize(this._labelBMFontRenderer.getContentSize()),this._labelBMFontRendererAdaptDirty=!0))},getString:function(){return this._stringValue},getStringLength:function(){return this._labelBMFontRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelBMFontRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelBMFontRendererAdaptDirty&&(this._labelBMFontScaleChangedWithSize(),this._labelBMFontRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelBMFontRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelBMFontRenderer},_labelBMFontScaleChangedWithSize:function(){var e=this._labelBMFontRenderer;if(this._ignoreSize)e.setScale(1);else{var t=e.getContentSize();if(t.width<=0||t.height<=0)return void e.setScale(1);e.setScaleX(this._contentSize.width/t.width),e.setScaleY(this._contentSize.height/t.height)}e.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"TextBMFont"},_createCloneInstance:function(){return new ccui.TextBMFont},_copySpecialProperties:function(e){this.setFntFile(e._fntFileName),this.setString(e._stringValue)}}),(_p=ccui.TextBMFont.prototype).string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p=null,ccui.TextBMFont.create=function(e,t){return new ccui.TextBMFont(e,t)},ccui.TextBMFont.RENDERER_ZORDER=-1,ccui._TextFieldRenderer=cc.TextFieldTTF.extend({_maxLengthEnabled:!1,_maxLength:0,_passwordEnabled:!1,_passwordStyleText:"",_attachWithIME:!1,_detachWithIME:!1,_insertText:!1,_deleteBackward:!1,_className:"_TextFieldRenderer",ctor:function(){cc.TextFieldTTF.prototype.ctor.call(this),this._maxLengthEnabled=!1,this._maxLength=0,this._passwordEnabled=!1,this._passwordStyleText="*",this._attachWithIME=!1,this._detachWithIME=!1,this._insertText=!1,this._deleteBackward=!1},onEnter:function(){cc.TextFieldTTF.prototype.onEnter.call(this),cc.TextFieldTTF.prototype.setDelegate.call(this,this)},onTextFieldAttachWithIME:function(e){return this.setAttachWithIME(!0),!1},onTextFieldInsertText:function(e,t,i){return(1!=i||"\n"!=t)&&(this.setInsertText(!0),this._maxLengthEnabled&&cc.TextFieldTTF.prototype.getCharCount.call(this)>=this._maxLength)},onTextFieldDeleteBackward:function(e,t,i){return this.setDeleteBackward(!0),!1},onTextFieldDetachWithIME:function(e){return this.setDetachWithIME(!0),!1},insertText:function(e,t){var i=e;"\n"!=e&&this._maxLengthEnabled&&this.getString().length>=this._maxLength?this._passwordEnabled&&this.setPasswordText(this.getString()):(cc.TextFieldTTF.prototype.insertText.call(this,i,t),this._passwordEnabled&&cc.TextFieldTTF.prototype.getCharCount.call(this)>0&&this.setPasswordText(this.getString()))},deleteBackward:function(){cc.TextFieldTTF.prototype.deleteBackward.call(this),cc.TextFieldTTF.prototype.getCharCount.call(this)>0&&this._passwordEnabled&&this.setPasswordText(this._inputText)},openIME:function(){cc.TextFieldTTF.prototype.attachWithIME.call(this)},closeIME:function(){cc.TextFieldTTF.prototype.detachWithIME.call(this)},setMaxLengthEnabled:function(e){this._maxLengthEnabled=e},isMaxLengthEnabled:function(){return this._maxLengthEnabled},setMaxLength:function(e){this._maxLength=e},getMaxLength:function(){return this._maxLength},getCharCount:function(){return cc.TextFieldTTF.prototype.getCharCount.call(this)},setPasswordEnabled:function(e){this._passwordEnabled=e},isPasswordEnabled:function(){return this._passwordEnabled},setPasswordStyleText:function(e){if(!(e.length>1)){var t=e.charCodeAt(0);t<33||t>126||(this._passwordStyleText=e)}},setPasswordText:function(e){var t="",i=e.length,n=i;this._maxLengthEnabled&&i>this._maxLength&&(n=this._maxLength);for(var r=0;r<n;++r)t+=this._passwordStyleText;cc.LabelTTF.prototype.setString.call(this,t)},setAttachWithIME:function(e){this._attachWithIME=e},getAttachWithIME:function(){return this._attachWithIME},setDetachWithIME:function(e){this._detachWithIME=e},getDetachWithIME:function(){return this._detachWithIME},setInsertText:function(e){this._insertText=e},getInsertText:function(){return this._insertText},setDeleteBackward:function(e){this._deleteBackward=e},getDeleteBackward:function(){return this._deleteBackward},onDraw:function(e){return!1}}),ccui._TextFieldRenderer.create=function(e,t,i){var n=new ccui._TextFieldRenderer;return n&&n.initWithString("",t,i)?(e&&n.setPlaceHolder(e),n):null},ccui.TextField=ccui.Widget.extend({_textFieldRenderer:null,_touchWidth:0,_touchHeight:0,_useTouchArea:!1,_textFieldEventListener:null,_textFieldEventSelector:null,_passwordStyleText:"",_textFieldRendererAdaptDirty:!0,_fontName:"",_fontSize:12,_ccEventCallback:null,ctor:function(e,t,i){ccui.Widget.prototype.ctor.call(this),t&&this.setFontName(t),i&&this.setFontSize(i),e&&this.setPlaceHolder(e)},init:function(){return!!ccui.Widget.prototype.init.call(this)&&(this.setTouchEnabled(!0),!0)},onEnter:function(){ccui.Widget.prototype.onEnter.call(this),this.scheduleUpdate()},_initRenderer:function(){this._textFieldRenderer=ccui._TextFieldRenderer.create("input words here","Thonburi",20),this.addProtectedChild(this._textFieldRenderer,ccui.TextField.RENDERER_ZORDER,-1)},setTouchSize:function(e){this._touchWidth=e.width,this._touchHeight=e.height},setTouchAreaEnabled:function(e){this._useTouchArea=e},hitTest:function(e){if(this._useTouchArea){var t=this.convertToNodeSpace(e),i=cc.rect(-this._touchWidth*this._anchorPoint.x,-this._touchHeight*this._anchorPoint.y,this._touchWidth,this._touchHeight);return t.x>=i.x&&t.x<=i.x+i.width&&t.y>=i.y&&t.y<=i.y+i.height}return ccui.Widget.prototype.hitTest.call(this,e)},getTouchSize:function(){return cc.size(this._touchWidth,this._touchHeight)},setText:function(e){cc.log("Please use the setString"),this.setString(e)},setString:function(e){null!=e&&(e=String(e),this.isMaxLengthEnabled()&&(e=e.substr(0,this.getMaxLength())),this.isPasswordEnabled()?(this._textFieldRenderer.setPasswordText(e),this._textFieldRenderer.setString(""),this._textFieldRenderer.insertText(e,e.length)):this._textFieldRenderer.setString(e),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()))},setPlaceHolder:function(e){this._textFieldRenderer.setPlaceHolder(e),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getPlaceHolder:function(){return this._textFieldRenderer.getPlaceHolder()},getPlaceHolderColor:function(){return this._textFieldRenderer.getPlaceHolderColor()},setPlaceHolderColor:function(e){this._textFieldRenderer.setColorSpaceHolder(e)},setTextColor:function(e){this._textFieldRenderer.setTextColor(e)},setFontSize:function(e){this._textFieldRenderer.setFontSize(e),this._fontSize=e,this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontSize:function(){return this._fontSize},setFontName:function(e){this._textFieldRenderer.setFontName(e),this._fontName=e,this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontName:function(){return this._fontName},didNotSelectSelf:function(){this._textFieldRenderer.detachWithIME()},getStringValue:function(){return cc.log("Please use the getString"),this.getString()},getString:function(){return this._textFieldRenderer.getString()},getStringLength:function(){return this._textFieldRenderer.getStringLength()},onTouchBegan:function(e,t){var i=this,n=ccui.Widget.prototype.onTouchBegan.call(i,e,t);return i._hit?setTimeout(function(){i._textFieldRenderer.attachWithIME()},0):setTimeout(function(){i._textFieldRenderer.detachWithIME()},0),n},setMaxLengthEnabled:function(e){this._textFieldRenderer.setMaxLengthEnabled(e)},isMaxLengthEnabled:function(){return this._textFieldRenderer.isMaxLengthEnabled()},setMaxLength:function(e){this._textFieldRenderer.setMaxLength(e),this.setString(this.getString())},getMaxLength:function(){return this._textFieldRenderer.getMaxLength()},setPasswordEnabled:function(e){this._textFieldRenderer.setPasswordEnabled(e)},isPasswordEnabled:function(){return this._textFieldRenderer.isPasswordEnabled()},setPasswordStyleText:function(e){this._textFieldRenderer.setPasswordStyleText(e),this._passwordStyleText=e,this.setString(this.getString())},getPasswordStyleText:function(){return this._passwordStyleText},update:function(e){this.getDetachWithIME()&&(this._detachWithIMEEvent(),this.setDetachWithIME(!1)),this.getAttachWithIME()&&(this._attachWithIMEEvent(),this.setAttachWithIME(!1)),this.getInsertText()&&(this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()),this._insertTextEvent(),this.setInsertText(!1)),this.getDeleteBackward()&&(this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()),this._deleteBackwardEvent(),this.setDeleteBackward(!1))},getAttachWithIME:function(){return this._textFieldRenderer.getAttachWithIME()},setAttachWithIME:function(e){this._textFieldRenderer.setAttachWithIME(e)},getDetachWithIME:function(){return this._textFieldRenderer.getDetachWithIME()},setDetachWithIME:function(e){this._textFieldRenderer.setDetachWithIME(e)},getInsertText:function(){return this._textFieldRenderer.getInsertText()},setInsertText:function(e){this._textFieldRenderer.setInsertText(e)},getDeleteBackward:function(){return this._textFieldRenderer.getDeleteBackward()},setDeleteBackward:function(e){this._textFieldRenderer.setDeleteBackward(e)},_attachWithIMEEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_ATTACH_WITH_IME):this._textFieldEventSelector(this,ccui.TextField.EVENT_ATTACH_WITH_IME)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_ATTACH_WITH_IME)},_detachWithIMEEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_DETACH_WITH_IME):this._textFieldEventSelector(this,ccui.TextField.EVENT_DETACH_WITH_IME)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_DETACH_WITH_IME)},_insertTextEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_INSERT_TEXT):this._textFieldEventSelector(this,ccui.TextField.EVENT_INSERT_TEXT)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_INSERT_TEXT)},_deleteBackwardEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_DELETE_BACKWARD):this._textFieldEventSelector(this,ccui.TextField.EVENT_DELETE_BACKWARD)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_DELETE_BACKWARD)},addEventListenerTextField:function(e,t){this.addEventListener(e,t)},addEventListener:function(e,t){this._textFieldEventSelector=e,this._textFieldEventListener=t},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._textFieldRendererAdaptDirty=!0},_adaptRenderers:function(){this._textFieldRendererAdaptDirty&&(this._textfieldRendererScaleChangedWithSize(),this._textFieldRendererAdaptDirty=!1)},_textfieldRendererScaleChangedWithSize:function(){this._ignoreSize||this._textFieldRenderer.setDimensions(this._contentSize),this._textFieldRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getAutoRenderSize:function(){var e=this._textFieldRenderer.getContentSize();return this._ignoreSize||(this._textFieldRenderer.setDimensions(0,0),e=this._textFieldRenderer.getContentSize(),this._textFieldRenderer.setDimensions(this._contentSize.width,this._contentSize.height)),e},getVirtualRendererSize:function(){return this._textFieldRenderer.getContentSize()},getVirtualRenderer:function(){return this._textFieldRenderer},getDescription:function(){return"TextField"},attachWithIME:function(){this._textFieldRenderer.attachWithIME()},_createCloneInstance:function(){return new ccui.TextField},_copySpecialProperties:function(e){this.setString(e._textFieldRenderer.getString()),this.setPlaceHolder(e.getString()),this.setFontSize(e._textFieldRenderer.getFontSize()),this.setFontName(e._textFieldRenderer.getFontName()),this.setMaxLengthEnabled(e.isMaxLengthEnabled()),this.setMaxLength(e.getMaxLength()),this.setPasswordEnabled(e.isPasswordEnabled()),this.setPasswordStyleText(e._passwordStyleText),this.setAttachWithIME(e.getAttachWithIME()),this.setDetachWithIME(e.getDetachWithIME()),this.setInsertText(e.getInsertText()),this.setDeleteBackward(e.getDeleteBackward()),this._ccEventCallback=e._ccEventCallback,this._textFieldEventListener=e._textFieldEventListener,this._textFieldEventSelector=e._textFieldEventSelector},setTextAreaSize:function(e){this.setContentSize(e)},setTextHorizontalAlignment:function(e){this._textFieldRenderer.setHorizontalAlignment(e)},setTextVerticalAlignment:function(e){this._textFieldRenderer.setVerticalAlignment(e)},_setFont:function(e){this._textFieldRenderer._setFont(e),this._textFieldRendererAdaptDirty=!0},_getFont:function(){return this._textFieldRenderer._getFont()},_changePosition:function(){this._adaptRenderers()}}),ccui.TextField.create=function(e,t,i){return new ccui.TextField(e,t,i)},(_p=ccui.TextField.prototype).string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.placeHolder,cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),_p.font,cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont),_p.fontSize,cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),_p.fontName,cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),_p.maxLengthEnabled,cc.defineGetterSetter(_p,"maxLengthEnabled",_p.isMaxLengthEnabled,_p.setMaxLengthEnabled),_p.maxLength,cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength),_p.passwordEnabled,cc.defineGetterSetter(_p,"passwordEnabled",_p.isPasswordEnabled,_p.setPasswordEnabled),_p=null,ccui.TextField.EVENT_ATTACH_WITH_IME=0,ccui.TextField.EVENT_DETACH_WITH_IME=1,ccui.TextField.EVENT_INSERT_TEXT=2,ccui.TextField.EVENT_DELETE_BACKWARD=3,ccui.TextField.RENDERER_ZORDER=-1,ccui.RichElement=ccui.Class.extend({_type:0,_tag:0,_color:null,_opacity:0,ctor:function(){this._type=0,this._tag=0,this._color=cc.color(255,255,255,255)},init:function(e,t,i){this._tag=e,this._color.r=t.r,this._color.g=t.g,this._color.b=t.b,this._opacity=i,this._color.a=void 0===i?t.a:i}}),ccui.RichElementText=ccui.RichElement.extend({_text:"",_fontName:"",_fontSize:0,ctor:function(e,t,i,n,r,o){ccui.RichElement.prototype.ctor.call(this),this._type=ccui.RichElement.TEXT,this._text="",this._fontName="",this._fontSize=0,o&&this.init(e,t,i,n,r,o)},init:function(e,t,i,n,r,o){ccui.RichElement.prototype.init.call(this,e,t,i),this._text=n,this._fontName=r,this._fontSize=o}}),ccui.RichElementText.create=function(e,t,i,n,r,o){return new ccui.RichElementText(e,t,i,n,r,o)},ccui.RichElementImage=ccui.RichElement.extend({_filePath:"",_textureRect:null,_textureType:0,ctor:function(e,t,i,n){ccui.RichElement.prototype.ctor.call(this),this._type=ccui.RichElement.IMAGE,this._filePath="",this._textureRect=cc.rect(0,0,0,0),this._textureType=0,void 0!==n&&this.init(e,t,i,n)},init:function(e,t,i,n){ccui.RichElement.prototype.init.call(this,e,t,i),this._filePath=n}}),ccui.RichElementImage.create=function(e,t,i,n){return new ccui.RichElementImage(e,t,i,n)},ccui.RichElementCustomNode=ccui.RichElement.extend({_customNode:null,ctor:function(e,t,i,n){ccui.RichElement.prototype.ctor.call(this),this._type=ccui.RichElement.CUSTOM,this._customNode=null,void 0!==n&&this.init(e,t,i,n)},init:function(e,t,i,n){ccui.RichElement.prototype.init.call(this,e,t,i),this._customNode=n}}),ccui.RichElementCustomNode.create=function(e,t,i,n){return new ccui.RichElementCustomNode(e,t,i,n)},ccui.RichText=ccui.Widget.extend({_formatTextDirty:!1,_richElements:null,_elementRenders:null,_leftSpaceWidth:0,_verticalSpace:0,_elementRenderersContainer:null,ctor:function(){ccui.Widget.prototype.ctor.call(this),this._formatTextDirty=!1,this._richElements=[],this._elementRenders=[],this._leftSpaceWidth=0,this._verticalSpace=0},_initRenderer:function(){this._elementRenderersContainer=new cc.Node,this._elementRenderersContainer.setAnchorPoint(.5,.5),this.addProtectedChild(this._elementRenderersContainer,0,-1)},insertElement:function(e,t){this._richElements.splice(t,0,e),this._formatTextDirty=!0},pushBackElement:function(e){this._richElements.push(e),this._formatTextDirty=!0},removeElement:function(e){cc.isNumber(e)?this._richElements.splice(e,1):cc.arrayRemoveObject(this._richElements,e),this._formatTextDirty=!0},formatText:function(){if(this._formatTextDirty){this._elementRenderersContainer.removeAllChildren(),this._elementRenders.length=0;var e,t,i=this._richElements;if(this._ignoreSize)for(this._addNewLine(),e=0;e<i.length;e++){var n=null;switch((t=i[e])._type){case ccui.RichElement.TEXT:n=new cc.LabelTTF(t._text,t._fontName,t._fontSize);break;case ccui.RichElement.IMAGE:n=new cc.Sprite(t._filePath);break;case ccui.RichElement.CUSTOM:n=t._customNode}n.setColor(t._color),n.setOpacity(t._color.a),this._pushToContainer(n)}else for(this._addNewLine(),e=0;e<i.length;e++)switch((t=i[e])._type){case ccui.RichElement.TEXT:this._handleTextRenderer(t._text,t._fontName,t._fontSize,t._color);break;case ccui.RichElement.IMAGE:this._handleImageRenderer(t._filePath,t._color,t._color.a);break;case ccui.RichElement.CUSTOM:this._handleCustomRenderer(t._customNode)}this.formatRenderers(),this._formatTextDirty=!1}},_handleTextRenderer:function(e,t,i,n){var r=new cc.LabelTTF(e,t,i),o=r.getContentSize().width;if(this._leftSpaceWidth-=o,this._leftSpaceWidth<0){var s=-this._leftSpaceWidth/o,a=e,c=a.length*(1-s),l=a.substr(0,c),u=a.substr(c,a.length-1);if(c>0){var h=new cc.LabelTTF(l.substr(0,c),t,i);h.setColor(n),h.setOpacity(n.a),this._pushToContainer(h)}this._addNewLine(),this._handleTextRenderer(u,t,i,n)}else r.setColor(n),r.setOpacity(n.a),this._pushToContainer(r)},_handleImageRenderer:function(e,t,i){var n=new cc.Sprite(e);this._handleCustomRenderer(n)},_handleCustomRenderer:function(e){var t=e.getContentSize();this._leftSpaceWidth-=t.width,this._leftSpaceWidth<0?(this._addNewLine(),this._pushToContainer(e),this._leftSpaceWidth-=t.width):this._pushToContainer(e)},_addNewLine:function(){this._leftSpaceWidth=this._customSize.width,this._elementRenders.push([])},formatRenderers:function(){var e,t,i,n,r,o=0,s=this._elementRenderersContainer,a=this._elementRenders;if(this._ignoreSize){var c=0;for(i=a[0],n=0,t=0;t<i.length;t++){(r=i[t]).setAnchorPoint(cc.p(0,0)),r.setPosition(n,0),s.addChild(r,1,t);var l=r.getContentSize();c+=l.width,o=Math.max(o,l.height),n+=l.width}s.setContentSize(c,o)}else{var u=[];for(e=0;e<a.length;e++){i=a[e];var h=0;for(t=0;t<i.length;t++)r=i[t],h=Math.max(r.getContentSize().height,h);u[e]=h,o+=u[e]}var d=this._customSize.height;for(e=0;e<a.length;e++)for(i=a[e],n=0,d-=u[e]+this._verticalSpace,t=0;t<i.length;t++)(r=i[t]).setAnchorPoint(cc.p(0,0)),r.setPosition(cc.p(n,d)),s.addChild(r,1),n+=r.getContentSize().width;s.setContentSize(this._contentSize)}var p=a.length;for(e=0;e<p;e++)a[e].length=0;this._elementRenders.length=0,this.setContentSize(this._ignoreSize?this.getVirtualRendererSize():this._customSize),this._updateContentSizeWithTextureSize(this._contentSize),s.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},_pushToContainer:function(e){this._elementRenders.length<=0||this._elementRenders[this._elementRenders.length-1].push(e)},_adaptRenderers:function(){this.formatText()},setVerticalSpace:function(e){this._verticalSpace=e},setAnchorPoint:function(e){ccui.Widget.prototype.setAnchorPoint.call(this,e),this._elementRenderersContainer.setAnchorPoint(e)},_setAnchorX:function(e){ccui.Widget.prototype._setAnchorX.call(this,e),this._elementRenderersContainer._setAnchorX(e)},_setAnchorY:function(e){ccui.Widget.prototype._setAnchorY.call(this,e),this._elementRenderersContainer._setAnchorY(e)},getVirtualRendererSize:function(){return this._elementRenderersContainer.getContentSize()},ignoreContentAdaptWithSize:function(e){this._ignoreSize!=e&&(this._formatTextDirty=!0,ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,e))},getContentSize:function(){return this.formatText(),cc.Node.prototype.getContentSize.call(this)},_getWidth:function(){return this.formatText(),cc.Node.prototype._getWidth.call(this)},_getHeight:function(){return this.formatText(),cc.Node.prototype._getHeight.call(this)},setContentSize:function(e,t){var i=void 0===t?e.width:e,n=void 0===t?e.height:t;ccui.Widget.prototype.setContentSize.call(this,i,n),this._formatTextDirty=!0},getDescription:function(){return"RichText"}}),ccui.RichText.create=function(){return new ccui.RichText},ccui.RichElement.TEXT=0,ccui.RichElement.IMAGE=1,ccui.RichElement.CUSTOM=2,ccui.ScrollView=ccui.Layout.extend({_innerContainer:null,direction:null,_autoScrollDir:null,_topBoundary:0,_bottomBoundary:0,_leftBoundary:0,_rightBoundary:0,_bounceTopBoundary:0,_bounceBottomBoundary:0,_bounceLeftBoundary:0,_bounceRightBoundary:0,_autoScroll:!1,_autoScrollAddUpTime:0,_autoScrollOriginalSpeed:0,_autoScrollAcceleration:0,_isAutoScrollSpeedAttenuated:!1,_needCheckAutoScrollDestination:!1,_autoScrollDestination:null,_bePressed:!1,_slidTime:0,_moveChildPoint:null,_childFocusCancelOffset:0,_leftBounceNeeded:!1,_topBounceNeeded:!1,_rightBounceNeeded:!1,_bottomBounceNeeded:!1,bounceEnabled:!1,_bouncing:!1,_bounceDir:null,_bounceOriginalSpeed:0,inertiaScrollEnabled:!1,_scrollViewEventListener:null,_scrollViewEventSelector:null,_className:"ScrollView",ctor:function(){ccui.Layout.prototype.ctor.call(this),this.direction=ccui.ScrollView.DIR_NONE,this._autoScrollDir=cc.p(0,0),this._autoScrollAcceleration=-1e3,this._autoScrollDestination=cc.p(0,0),this._slidTime=0,this._moveChildPoint=cc.p(0,0),this._childFocusCancelOffset=5,this._bounceDir=cc.p(0,0),this._bounceOriginalSpeed=0,this.inertiaScrollEnabled=!0,this.setTouchEnabled(!0)},init:function(){return!!ccui.Layout.prototype.init.call(this)&&(this.setClippingEnabled(!0),this._innerContainer.setTouchEnabled(!1),!0)},onEnter:function(){ccui.Layout.prototype.onEnter.call(this),this.scheduleUpdate(!0)},findNextFocusedWidget:function(e,t){return this.getLayoutType()==ccui.Layout.LINEAR_VERTICAL||this.getLayoutType()==ccui.Layout.LINEAR_HORIZONTAL?this._innerContainer.findNextFocusedWidget(e,t):ccui.Widget.prototype.findNextFocusedWidget.call(this,e,t)},_initRenderer:function(){ccui.Layout.prototype._initRenderer.call(this),this._innerContainer=new ccui.Layout,this._innerContainer.setColor(cc.color(255,255,255)),this._innerContainer.setOpacity(255),this._innerContainer.setCascadeColorEnabled(!0),this._innerContainer.setCascadeOpacityEnabled(!0),this.addProtectedChild(this._innerContainer,1,1)},_onSizeChanged:function(){ccui.Layout.prototype._onSizeChanged.call(this);var e=this._contentSize;this._topBoundary=e.height,this._rightBoundary=e.width;var t=e.width/3,i=e.height/3;this._bounceTopBoundary=e.height-i,this._bounceBottomBoundary=i,this._bounceLeftBoundary=t,this._bounceRightBoundary=e.width-t;var n=this._innerContainer.getContentSize();this._innerContainer.setContentSize(cc.size(Math.max(n.width,e.width),Math.max(n.height,e.height))),this._innerContainer.setPosition(0,e.height-this._innerContainer.getContentSize().height)},setInnerContainerSize:function(e){var t=this._innerContainer,i=this._contentSize,n=i.width,r=i.height,o=t.getContentSize();e.width<i.width?cc.log("Inner width <= ScrollView width, it will be force sized!"):n=e.width,e.height<i.height?cc.log("Inner height <= ScrollView height, it will be force sized!"):r=e.height,t.setContentSize(cc.size(n,r));var s,a;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:s=t.getContentSize(),a=o.height-s.height,this._scrollChildren(0,a);break;case ccui.ScrollView.DIR_HORIZONTAL:t.getRightBoundary()<=i.width&&(s=t.getContentSize(),a=o.width-s.width,this._scrollChildren(a,0));break;case ccui.ScrollView.DIR_BOTH:s=t.getContentSize();var c=o.height-s.height,l=t.getRightBoundary()<=i.width?o.width-s.width:0;this._scrollChildren(l,c)}var u=t.getContentSize(),h=t.getPosition(),d=t.getAnchorPoint();t.getLeftBoundary()>0&&t.setPosition(d.x*u.width,h.y),t.getRightBoundary()<i.width&&t.setPosition(i.width-(1-d.x)*u.width,h.y),h.y>0&&t.setPosition(h.x,d.y*u.height),t.getTopBoundary()<i.height&&t.setPosition(h.x,i.height-(1-d.y)*u.height)},_setInnerWidth:function(e){var t=this._contentSize.width,i=t,n=this._innerContainer,r=n.width;switch(e<t?cc.log("Inner width <= scrollview width, it will be force sized!"):i=e,n.width=i,this.direction){case ccui.ScrollView.DIR_HORIZONTAL:case ccui.ScrollView.DIR_BOTH:if(n.getRightBoundary()<=t){var o=r-n.width;this._scrollChildren(o,0)}}var s=n.anchorX;n.getLeftBoundary()>0&&(n.x=s*i),n.getRightBoundary()<t&&(n.x=t-(1-s)*i)},_setInnerHeight:function(e){var t=this._contentSize.height,i=t,n=this._innerContainer,r=n.height;switch(e<t?cc.log("Inner height <= scrollview height, it will be force sized!"):i=e,n.height=i,this.direction){case ccui.ScrollView.DIR_VERTICAL:case ccui.ScrollView.DIR_BOTH:var o=r-i;this._scrollChildren(0,o)}var s=n.anchorY;n.getLeftBoundary()>0&&(n.y=s*i),n.getRightBoundary()<t&&(n.y=t-(1-s)*i)},getInnerContainerSize:function(){return this._innerContainer.getContentSize()},_getInnerWidth:function(){return this._innerContainer.width},_getInnerHeight:function(){return this._innerContainer.height},addChild:function(e,t,i){return!!e&&(t=t||e.getLocalZOrder(),i=i||e.getTag(),this._innerContainer.addChild(e,t,i))},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(e){this._innerContainer.removeAllChildrenWithCleanup(e)},removeChild:function(e,t){return this._innerContainer.removeChild(e,t)},getChildren:function(){return this._innerContainer.getChildren()},getChildrenCount:function(){return this._innerContainer.getChildrenCount()},getChildByTag:function(e){return this._innerContainer.getChildByTag(e)},getChildByName:function(e){return this._innerContainer.getChildByName(e)},_moveChildren:function(e,t){var i=this._innerContainer;this._moveChildPoint.x=i.x+e,this._moveChildPoint.y=i.y+t,this._innerContainer.setPosition(this._moveChildPoint)},_autoScrollChildren:function(e){var t=this._autoScrollAddUpTime;if(this._autoScrollAddUpTime+=e,this._isAutoScrollSpeedAttenuated)if(this._autoScrollOriginalSpeed+this._autoScrollAcceleration*this._autoScrollAddUpTime<=0)this._stopAutoScrollChildren(),this._checkNeedBounce();else{var i=2*t+e,n=(this._autoScrollOriginalSpeed+this._autoScrollAcceleration*i*.5)*e,r=n*this._autoScrollDir.x,o=n*this._autoScrollDir.y;this._scrollChildren(r,o)||(this._stopAutoScrollChildren(),this._checkNeedBounce())}else if(this._needCheckAutoScrollDestination){var s=this._autoScrollDir.x*e*this._autoScrollOriginalSpeed,a=this._autoScrollDir.y*e*this._autoScrollOriginalSpeed,c=this._checkCustomScrollDestination(s,a),l=this._scrollChildren(s,a);c&&l||(this._stopAutoScrollChildren(),this._checkNeedBounce())}else this._scrollChildren(this._autoScrollDir.x*e*this._autoScrollOriginalSpeed,this._autoScrollDir.y*e*this._autoScrollOriginalSpeed)||(this._stopAutoScrollChildren(),this._checkNeedBounce())},_bounceChildren:function(e){var t=this._bounceOriginalSpeed,i=this._bounceDir;t<=0&&this._stopBounceChildren(),this._bounceScrollChildren(i.x*e*t,i.y*e*t)||this._stopBounceChildren()},_checkNeedBounce:function(){if(!this.bounceEnabled)return!1;this._checkBounceBoundary();var e=this._topBounceNeeded,t=this._bottomBounceNeeded,i=this._leftBounceNeeded,n=this._rightBounceNeeded;if(e||t||i||n){var r,o,s=this._contentSize,a=this._innerContainer;return e&&i?(r=cc.pSub(cc.p(0,s.height),cc.p(a.getLeftBoundary(),a.getTopBoundary())),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)):e&&n?(r=cc.pSub(cc.p(s.width,s.height),cc.p(a.getRightBoundary(),a.getTopBoundary())),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)):t&&i?(r=cc.pSub(cc.p(0,0),cc.p(a.getLeftBoundary(),a.getBottomBoundary())),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)):t&&n?(r=cc.pSub(cc.p(s.width,0),cc.p(a.getRightBoundary(),a.getBottomBoundary())),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)):e?(r=cc.pSub(cc.p(0,s.height),cc.p(0,a.getTopBoundary())),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)):t?(r=cc.pSub(cc.p(0,0),cc.p(0,a.getBottomBoundary())),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)):i?(r=cc.pSub(cc.p(0,0),cc.p(a.getLeftBoundary(),0)),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)):n&&(r=cc.pSub(cc.p(s.width,0),cc.p(a.getRightBoundary(),0)),o=cc.pLength(r)/.2,this._bounceDir=cc.pNormalize(r),this._startBounceChildren(o)),!0}return!1},_checkBounceBoundary:function(){var e=this._innerContainer;e.getBottomBoundary()>this._bottomBoundary?(this._scrollToBottomEvent(),this._bottomBounceNeeded=!0):this._bottomBounceNeeded=!1,e.getTopBoundary()<this._topBoundary?(this._scrollToTopEvent(),this._topBounceNeeded=!0):this._topBounceNeeded=!1,e.getRightBoundary()<this._rightBoundary?(this._scrollToRightEvent(),this._rightBounceNeeded=!0):this._rightBounceNeeded=!1,e.getLeftBoundary()>this._leftBoundary?(this._scrollToLeftEvent(),this._leftBounceNeeded=!0):this._leftBounceNeeded=!1},_startBounceChildren:function(e){this._bounceOriginalSpeed=e,this._bouncing=!0},_stopBounceChildren:function(){this._bouncing=!1,this._bounceOriginalSpeed=0,this._leftBounceNeeded=!1,this._rightBounceNeeded=!1,this._topBounceNeeded=!1,this._bottomBounceNeeded=!1},_startAutoScrollChildrenWithOriginalSpeed:function(e,t,i,n){this._stopAutoScrollChildren(),this._autoScrollDir.x=e.x,this._autoScrollDir.y=e.y,this._isAutoScrollSpeedAttenuated=i,this._autoScrollOriginalSpeed=t,this._autoScroll=!0,this._autoScrollAcceleration=n},_startAutoScrollChildrenWithDestination:function(e,t,i){this._needCheckAutoScrollDestination=!1,this._autoScrollDestination=e;var n=cc.pSub(e,this._innerContainer.getPosition()),r=cc.pNormalize(n),o=0,s=-1e3,a=cc.pLength(n);i?(s=-2*a/(t*t),o=2*a/t):(this._needCheckAutoScrollDestination=!0,o=a/t),this._startAutoScrollChildrenWithOriginalSpeed(r,o,i,s)},_jumpToDestination:function(e,t){void 0!==e.x&&(t=e.y,e=e.x);var i=e,n=t;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:t<=0&&(n=Math.max(t,this._contentSize.height-this._innerContainer.getContentSize().height));break;case ccui.ScrollView.DIR_HORIZONTAL:e<=0&&(i=Math.max(e,this._contentSize.width-this._innerContainer.getContentSize().width));break;case ccui.ScrollView.DIR_BOTH:t<=0&&(n=Math.max(t,this._contentSize.height-this._innerContainer.getContentSize().height)),e<=0&&(i=Math.max(e,this._contentSize.width-this._innerContainer.getContentSize().width))}this._innerContainer.setPosition(i,n)},_stopAutoScrollChildren:function(){this._autoScroll=!1,this._autoScrollOriginalSpeed=0,this._autoScrollAddUpTime=0},_bounceScrollChildren:function(e,t){var i,n,r,o,s,a=!0,c=this._innerContainer;if(e>0&&t>0)i=e,n=t,(r=c.getRightBoundary())+i>=this._rightBoundary&&(i=this._rightBoundary-r,this._bounceRightEvent(),a=!1),(o=c.getTopBoundary())+t>=this._topBoundary&&(n=this._topBoundary-o,this._bounceTopEvent(),a=!1),this._moveChildren(i,n);else if(e<0&&t>0)i=e,n=t,(l=c.getLeftBoundary())+i<=this._leftBoundary&&(i=this._leftBoundary-l,this._bounceLeftEvent(),a=!1),(o=c.getTopBoundary())+t>=this._topBoundary&&(n=this._topBoundary-o,this._bounceTopEvent(),a=!1),this._moveChildren(i,n);else if(e<0&&t<0){i=e,n=t;var l=c.getLeftBoundary();l+i<=this._leftBoundary&&(i=this._leftBoundary-l,this._bounceLeftEvent(),a=!1),(s=c.getBottomBoundary())+t<=this._bottomBoundary&&(n=this._bottomBoundary-s,this._bounceBottomEvent(),a=!1),this._moveChildren(i,n)}else if(e>0&&t<0)i=e,n=t,(r=c.getRightBoundary())+i>=this._rightBoundary&&(i=this._rightBoundary-r,this._bounceRightEvent(),a=!1),(s=c.getBottomBoundary())+t<=this._bottomBoundary&&(n=this._bottomBoundary-s,this._bounceBottomEvent(),a=!1),this._moveChildren(i,n);else if(0==e&&t>0)n=t,(o=c.getTopBoundary())+t>=this._topBoundary&&(n=this._topBoundary-o,this._bounceTopEvent(),a=!1),this._moveChildren(0,n);else if(0==e&&t<0)n=t,(s=c.getBottomBoundary())+t<=this._bottomBoundary&&(n=this._bottomBoundary-s,this._bounceBottomEvent(),a=!1),this._moveChildren(0,n);else if(e>0&&0==t)i=e,(r=c.getRightBoundary())+i>=this._rightBoundary&&(i=this._rightBoundary-r,this._bounceRightEvent(),a=!1),this._moveChildren(i,0);else if(e<0&&0==t){i=e;var u=c.getLeftBoundary();u+i<=this._leftBoundary&&(i=this._leftBoundary-u,this._bounceLeftEvent(),a=!1),this._moveChildren(i,0)}return a},_checkCustomScrollDestination:function(e,t){var i,n,r,o,s=!0,a=this._innerContainer,c=this._autoScrollDestination;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:this._autoScrollDir.y>0?(i=a.getBottomBoundary())+t>=c.y&&(t=c.y-i,s=!1):(i=a.getBottomBoundary())+t<=c.y&&(t=c.y-i,s=!1);break;case ccui.ScrollView.DIR_HORIZONTAL:this._autoScrollDir.x>0?(n=a.getLeftBoundary())+e>=c.x&&(e=c.x-n,s=!1):(n=a.getLeftBoundary())+e<=c.x&&(e=c.x-n,s=!1);break;case ccui.ScrollView.DIR_BOTH:e>0&&t>0?((n=a.getLeftBoundary())+e>=c.x&&(e=c.x-n,s=!1),(i=a.getBottomBoundary())+t>=c.y&&(t=c.y-i,s=!1)):e<0&&t>0?((r=a.getRightBoundary())+e<=c.x&&(e=c.x-r,s=!1),(i=a.getBottomBoundary())+t>=c.y&&(t=c.y-i,s=!1)):e<0&&t<0?((r=a.getRightBoundary())+e<=c.x&&(e=c.x-r,s=!1),(o=a.getTopBoundary())+t<=c.y&&(t=c.y-o,s=!1)):e>0&&t<0?((n=a.getLeftBoundary())+e>=c.x&&(e=c.x-n,s=!1),(o=a.getTopBoundary())+t<=c.y&&(t=c.y-o,s=!1)):0==e&&t>0?(i=a.getBottomBoundary())+t>=c.y&&(t=c.y-i,s=!1):e<0&&0==t?(r=a.getRightBoundary())+e<=c.x&&(e=c.x-r,s=!1):0==e&&t<0?(o=a.getTopBoundary())+t<=c.y&&(t=c.y-o,s=!1):e>0&&0==t&&(n=a.getLeftBoundary())+e>=c.x&&(e=c.x-n,s=!1)}return s},_scrollChildren:function(e,t){var i=!0;switch(this._scrollingEvent(),this.direction){case ccui.ScrollView.DIR_VERTICAL:i=this._scrollChildrenVertical(e,t);break;case ccui.ScrollView.DIR_HORIZONTAL:i=this._scrollChildrenHorizontal(e,t);break;case ccui.ScrollView.DIR_BOTH:i=this._scrollChildrenBoth(e,t)}return i},_scrollChildrenVertical:function(e,t){var i,n,r=t,o=!0,s=this._innerContainer;return this.bounceEnabled?((i=s.getBottomBoundary())+t>=this._bounceBottomBoundary&&(r=this._bounceBottomBoundary-i,this._scrollToBottomEvent(),o=!1),(n=s.getTopBoundary())+t<=this._bounceTopBoundary&&(r=this._bounceTopBoundary-n,this._scrollToTopEvent(),o=!1)):((i=s.getBottomBoundary())+t>=this._bottomBoundary&&(r=this._bottomBoundary-i,this._scrollToBottomEvent(),o=!1),(n=s.getTopBoundary())+t<=this._topBoundary&&(r=this._topBoundary-n,this._scrollToTopEvent(),o=!1)),this._moveChildren(0,r),o},_scrollChildrenHorizontal:function(e,t){var i,n,r=!0,o=e,s=this._innerContainer;return this.bounceEnabled?((i=s.getRightBoundary())+e<=this._bounceRightBoundary&&(o=this._bounceRightBoundary-i,this._scrollToRightEvent(),r=!1),(n=s.getLeftBoundary())+e>=this._bounceLeftBoundary&&(o=this._bounceLeftBoundary-n,this._scrollToLeftEvent(),r=!1)):((i=s.getRightBoundary())+e<=this._rightBoundary&&(o=this._rightBoundary-i,this._scrollToRightEvent(),r=!1),(n=s.getLeftBoundary())+e>=this._leftBoundary&&(o=this._leftBoundary-n,this._scrollToLeftEvent(),r=!1)),this._moveChildren(o,0),r},_scrollChildrenBoth:function(e,t){var i,n,r,o,s=!0,a=e,c=t,l=this._innerContainer;return this.bounceEnabled?e>0&&t>0?((i=l.getLeftBoundary())+e>=this._bounceLeftBoundary&&(a=this._bounceLeftBoundary-i,this._scrollToLeftEvent(),s=!1),(n=l.getBottomBoundary())+t>=this._bounceBottomBoundary&&(c=this._bounceBottomBoundary-n,this._scrollToBottomEvent(),s=!1)):e<0&&t>0?((r=l.getRightBoundary())+e<=this._bounceRightBoundary&&(a=this._bounceRightBoundary-r,this._scrollToRightEvent(),s=!1),(n=l.getBottomBoundary())+t>=this._bounceBottomBoundary&&(c=this._bounceBottomBoundary-n,this._scrollToBottomEvent(),s=!1)):e<0&&t<0?((r=l.getRightBoundary())+e<=this._bounceRightBoundary&&(a=this._bounceRightBoundary-r,this._scrollToRightEvent(),s=!1),(o=l.getTopBoundary())+t<=this._bounceTopBoundary&&(c=this._bounceTopBoundary-o,this._scrollToTopEvent(),s=!1)):e>0&&t<0?((i=l.getLeftBoundary())+e>=this._bounceLeftBoundary&&(a=this._bounceLeftBoundary-i,this._scrollToLeftEvent(),s=!1),(o=l.getTopBoundary())+t<=this._bounceTopBoundary&&(c=this._bounceTopBoundary-o,this._scrollToTopEvent(),s=!1)):0==e&&t>0?(n=l.getBottomBoundary())+t>=this._bounceBottomBoundary&&(c=this._bounceBottomBoundary-n,this._scrollToBottomEvent(),s=!1):e<0&&0==t?(r=l.getRightBoundary())+e<=this._bounceRightBoundary&&(a=this._bounceRightBoundary-r,this._scrollToRightEvent(),s=!1):0==e&&t<0?(o=l.getTopBoundary())+t<=this._bounceTopBoundary&&(c=this._bounceTopBoundary-o,this._scrollToTopEvent(),s=!1):e>0&&0==t&&(i=l.getLeftBoundary())+e>=this._bounceLeftBoundary&&(a=this._bounceLeftBoundary-i,this._scrollToLeftEvent(),s=!1):e>0&&t>0?((i=l.getLeftBoundary())+e>=this._leftBoundary&&(a=this._leftBoundary-i,this._scrollToLeftEvent(),s=!1),(n=l.getBottomBoundary())+t>=this._bottomBoundary&&(c=this._bottomBoundary-n,this._scrollToBottomEvent(),s=!1)):e<0&&t>0?((r=l.getRightBoundary())+e<=this._rightBoundary&&(a=this._rightBoundary-r,this._scrollToRightEvent(),s=!1),(n=l.getBottomBoundary())+t>=this._bottomBoundary&&(c=this._bottomBoundary-n,this._scrollToBottomEvent(),s=!1)):e<0&&t<0?((r=l.getRightBoundary())+e<=this._rightBoundary&&(a=this._rightBoundary-r,this._scrollToRightEvent(),s=!1),(o=l.getTopBoundary())+t<=this._topBoundary&&(c=this._topBoundary-o,this._scrollToTopEvent(),s=!1)):e>0&&t<0?((i=l.getLeftBoundary())+e>=this._leftBoundary&&(a=this._leftBoundary-i,this._scrollToLeftEvent(),s=!1),(o=this._innerContainer.getTopBoundary())+t<=this._topBoundary&&(c=this._topBoundary-o,this._scrollToTopEvent(),s=!1)):0==e&&t>0?(n=this._innerContainer.getBottomBoundary())+t>=this._bottomBoundary&&(c=this._bottomBoundary-n,this._scrollToBottomEvent(),s=!1):e<0&&0==t?(r=this._innerContainer.getRightBoundary())+e<=this._rightBoundary&&(a=this._rightBoundary-r,this._scrollToRightEvent(),s=!1):0==e&&t<0?(o=this._innerContainer.getTopBoundary())+t<=this._topBoundary&&(c=this._topBoundary-o,this._scrollToTopEvent(),s=!1):e>0&&0==t&&(i=this._innerContainer.getLeftBoundary())+e>=this._leftBoundary&&(a=this._leftBoundary-i,this._scrollToLeftEvent(),s=!1),this._moveChildren(a,c),s},scrollToBottom:function(e,t){this._startAutoScrollChildrenWithDestination(cc.p(this._innerContainer.getPositionX(),0),e,t)},scrollToTop:function(e,t){this._startAutoScrollChildrenWithDestination(cc.p(this._innerContainer.getPositionX(),this._contentSize.height-this._innerContainer.getContentSize().height),e,t)},scrollToLeft:function(e,t){this._startAutoScrollChildrenWithDestination(cc.p(0,this._innerContainer.getPositionY()),e,t)},scrollToRight:function(e,t){this._startAutoScrollChildrenWithDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY()),e,t)},scrollToTopLeft:function(e,t){this.direction==ccui.ScrollView.DIR_BOTH?this._startAutoScrollChildrenWithDestination(cc.p(0,this._contentSize.height-this._innerContainer.getContentSize().height),e,t):cc.log("Scroll direction is not both!")},scrollToTopRight:function(e,t){if(this.direction==ccui.ScrollView.DIR_BOTH){var i=this._innerContainer.getContentSize();this._startAutoScrollChildrenWithDestination(cc.p(this._contentSize.width-i.width,this._contentSize.height-i.height),e,t)}else cc.log("Scroll direction is not both!")},scrollToBottomLeft:function(e,t){this.direction==ccui.ScrollView.DIR_BOTH?this._startAutoScrollChildrenWithDestination(cc.p(0,0),e,t):cc.log("Scroll direction is not both!")},scrollToBottomRight:function(e,t){this.direction==ccui.ScrollView.DIR_BOTH?this._startAutoScrollChildrenWithDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,0),e,t):cc.log("Scroll direction is not both!")},scrollToPercentVertical:function(e,t,i){var n=this._contentSize.height-this._innerContainer.getContentSize().height,r=-n;this._startAutoScrollChildrenWithDestination(cc.p(this._innerContainer.getPositionX(),n+e*r/100),t,i)},scrollToPercentHorizontal:function(e,t,i){var n=this._innerContainer.getContentSize().width-this._contentSize.width;this._startAutoScrollChildrenWithDestination(cc.p(-e*n/100,this._innerContainer.getPositionY()),t,i)},scrollToPercentBothDirection:function(e,t,i){if(this.direction==ccui.ScrollView.DIR_BOTH){var n=this._contentSize.height-this._innerContainer.getContentSize().height,r=-n,o=this._innerContainer.getContentSize().width-this._contentSize.width;this._startAutoScrollChildrenWithDestination(cc.p(-e.x*o/100,n+e.y*r/100),t,i)}},jumpToBottom:function(){this._jumpToDestination(this._innerContainer.getPositionX(),0)},jumpToTop:function(){this._jumpToDestination(this._innerContainer.getPositionX(),this._contentSize.height-this._innerContainer.getContentSize().height)},jumpToLeft:function(){this._jumpToDestination(0,this._innerContainer.getPositionY())},jumpToRight:function(){this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY())},jumpToTopLeft:function(){this.direction==ccui.ScrollView.DIR_BOTH?this._jumpToDestination(0,this._contentSize.height-this._innerContainer.getContentSize().height):cc.log("Scroll direction is not both!")},jumpToTopRight:function(){if(this.direction==ccui.ScrollView.DIR_BOTH){var e=this._innerContainer.getContentSize();this._jumpToDestination(this._contentSize.width-e.width,this._contentSize.height-e.height)}else cc.log("Scroll direction is not both!")},jumpToBottomLeft:function(){this.direction==ccui.ScrollView.DIR_BOTH?this._jumpToDestination(0,0):cc.log("Scroll direction is not both!")},jumpToBottomRight:function(){this.direction==ccui.ScrollView.DIR_BOTH?this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,0):cc.log("Scroll direction is not both!")},jumpToPercentVertical:function(e){var t=this._contentSize.height-this._innerContainer.getContentSize().height,i=-t;this._jumpToDestination(this._innerContainer.getPositionX(),t+e*i/100)},jumpToPercentHorizontal:function(e){var t=this._innerContainer.getContentSize().width-this._contentSize.width;this._jumpToDestination(-e*t/100,this._innerContainer.getPositionY())},jumpToPercentBothDirection:function(e){if(this.direction==ccui.ScrollView.DIR_BOTH){var t=this._innerContainer.getContentSize(),i=this._contentSize.height-t.height,n=-i,r=t.width-this._contentSize.width;this._jumpToDestination(-e.x*r/100,i+e.y*n/100)}},_startRecordSlidAction:function(){this._autoScroll&&this._stopAutoScrollChildren(),this._bouncing&&this._stopBounceChildren(),this._slidTime=0},_endRecordSlidAction:function(){if(!this._checkNeedBounce()&&this.inertiaScrollEnabled){if(this._slidTime<=.016)return;var e,t=0,i=this.convertToNodeSpace(this._touchEndPosition),n=this.convertToNodeSpace(this._touchBeganPosition);switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:e=(t=i.y-n.y)<0?ccui.ScrollView.SCROLLDIR_DOWN:ccui.ScrollView.SCROLLDIR_UP;break;case ccui.ScrollView.DIR_HORIZONTAL:e=(t=i.x-n.x)<0?ccui.ScrollView.SCROLLDIR_LEFT:ccui.ScrollView.SCROLLDIR_RIGHT;break;case ccui.ScrollView.DIR_BOTH:var r=cc.pSub(i,n);t=cc.pLength(r),e=cc.pNormalize(r)}var o=Math.min(Math.abs(t)/this._slidTime,ccui.ScrollView.AUTO_SCROLL_MAX_SPEED);this._startAutoScrollChildrenWithOriginalSpeed(e,o,!0,-1e3),this._slidTime=0}},_handlePressLogic:function(e){this._startRecordSlidAction(),this._bePressed=!0},_handleMoveLogic:function(e){var t=this.convertToNodeSpace(e.getLocation()),i=this.convertToNodeSpace(e.getPreviousLocation()),n=cc.pSub(t,i);switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:this._scrollChildren(0,n.y);break;case ccui.ScrollView.DIR_HORIZONTAL:this._scrollChildren(n.x,0);break;case ccui.ScrollView.DIR_BOTH:this._scrollChildren(n.x,n.y)}},_handleReleaseLogic:function(e){this._endRecordSlidAction(),this._bePressed=!1},onTouchBegan:function(e,t){var i=ccui.Layout.prototype.onTouchBegan.call(this,e,t);return this._isInterceptTouch||this._hit&&this._handlePressLogic(e),i},onTouchMoved:function(e,t){ccui.Layout.prototype.onTouchMoved.call(this,e,t),this._isInterceptTouch||this._handleMoveLogic(e)},onTouchEnded:function(e,t){ccui.Layout.prototype.onTouchEnded.call(this,e,t),this._isInterceptTouch||this._handleReleaseLogic(e),this._isInterceptTouch=!1},onTouchCancelled:function(e,t){ccui.Layout.prototype.onTouchCancelled.call(this,e,t),this._isInterceptTouch||this.handleReleaseLogic(e),this._isInterceptTouch=!1},update:function(e){this._autoScroll&&this._autoScrollChildren(e),this._bouncing&&this._bounceChildren(e),this._recordSlidTime(e)},_recordSlidTime:function(e){this._bePressed&&(this._slidTime+=e)},interceptTouchEvent:function(e,t,i){var n=i.getLocation();switch(e){case ccui.Widget.TOUCH_BEGAN:this._isInterceptTouch=!0,this._touchBeganPosition.x=n.x,this._touchBeganPosition.y=n.y,this._handlePressLogic(i);break;case ccui.Widget.TOUCH_MOVED:var r=cc.pLength(cc.pSub(t.getTouchBeganPosition(),n));this._touchMovePosition.x=n.x,this._touchMovePosition.y=n.y,r>this._childFocusCancelOffset&&(t.setHighlighted(!1),this._handleMoveLogic(i));break;case ccui.Widget.TOUCH_CANCELED:case ccui.Widget.TOUCH_ENDED:this._touchEndPosition.x=n.x,this._touchEndPosition.y=n.y,this._handleReleaseLogic(i),t.isSwallowTouches()&&(this._isInterceptTouch=!1)}},_scrollToTopEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLL_TO_TOP):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_SCROLL_TO_TOP)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_TOP)},_scrollToBottomEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM)},_scrollToLeftEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLL_TO_LEFT):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_SCROLL_TO_LEFT)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_LEFT)},_scrollToRightEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT)},_scrollingEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLLING):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_SCROLLING)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_SCROLLING)},_bounceTopEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_TOP):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_BOUNCE_TOP)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_BOUNCE_TOP)},_bounceBottomEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_BOTTOM):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_BOUNCE_BOTTOM)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_BOUNCE_BOTTOM)},_bounceLeftEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_LEFT):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_BOUNCE_LEFT)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_BOUNCE_LEFT)},_bounceRightEvent:function(){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_RIGHT):this._scrollViewEventSelector(this,ccui.ScrollView.EVENT_BOUNCE_RIGHT)),this._ccEventCallback&&this._ccEventCallback(this,ccui.ScrollView.EVENT_BOUNCE_RIGHT)},addEventListenerScrollView:function(e,t){this.addEventListener(e,t)},addEventListener:function(e,t){this._scrollViewEventSelector=e,this._scrollViewEventListener=t},setDirection:function(e){this.direction=e},getDirection:function(){return this.direction},setBounceEnabled:function(e){this.bounceEnabled=e},isBounceEnabled:function(){return this.bounceEnabled},setInertiaScrollEnabled:function(e){this.inertiaScrollEnabled=e},isInertiaScrollEnabled:function(){return this.inertiaScrollEnabled},getInnerContainer:function(){return this._innerContainer},setLayoutType:function(e){this._innerContainer.setLayoutType(e)},getLayoutType:function(){return this._innerContainer.getLayoutType()},_doLayout:function(){this._doLayoutDirty&&(this._doLayoutDirty=!1)},getDescription:function(){return"ScrollView"},_createCloneInstance:function(){return new ccui.ScrollView},_copyClonedWidgetChildren:function(e){ccui.Layout.prototype._copyClonedWidgetChildren.call(this,e)},_copySpecialProperties:function(e){e instanceof ccui.ScrollView&&(ccui.Layout.prototype._copySpecialProperties.call(this,e),this.setInnerContainerSize(e.getInnerContainerSize()),this.setDirection(e.direction),this.setBounceEnabled(e.bounceEnabled),this.setInertiaScrollEnabled(e.inertiaScrollEnabled),this._scrollViewEventListener=e._scrollViewEventListener,this._scrollViewEventSelector=e._scrollViewEventSelector,this._ccEventCallback=e._ccEventCallback)},getNodeByTag:function(e){return this._innerContainer.getNodeByTag(e)},getNodes:function(){return this._innerContainer.getNodes()},removeNode:function(e){this._innerContainer.removeNode(e)},removeNodeByTag:function(e){this._innerContainer.removeNodeByTag(e)},removeAllNodes:function(){this._innerContainer.removeAllNodes()},addNode:function(e,t,i){this._innerContainer.addNode(e,t,i)}}),(_p=ccui.ScrollView.prototype).innerWidth,cc.defineGetterSetter(_p,"innerWidth",_p._getInnerWidth,_p._setInnerWidth),_p.innerHeight,cc.defineGetterSetter(_p,"innerHeight",_p._getInnerHeight,_p._setInnerHeight),_p=null,ccui.ScrollView.create=function(){return new ccui.ScrollView},ccui.ScrollView.DIR_NONE=0,ccui.ScrollView.DIR_VERTICAL=1,ccui.ScrollView.DIR_HORIZONTAL=2,ccui.ScrollView.DIR_BOTH=3,ccui.ScrollView.EVENT_SCROLL_TO_TOP=0,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM=1,ccui.ScrollView.EVENT_SCROLL_TO_LEFT=2,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT=3,ccui.ScrollView.EVENT_SCROLLING=4,ccui.ScrollView.EVENT_BOUNCE_TOP=5,ccui.ScrollView.EVENT_BOUNCE_BOTTOM=6,ccui.ScrollView.EVENT_BOUNCE_LEFT=7,ccui.ScrollView.EVENT_BOUNCE_RIGHT=8,ccui.ScrollView.AUTO_SCROLL_MAX_SPEED=1e3,ccui.ScrollView.SCROLLDIR_UP=cc.p(0,1),ccui.ScrollView.SCROLLDIR_DOWN=cc.p(0,-1),ccui.ScrollView.SCROLLDIR_LEFT=cc.p(-1,0),ccui.ScrollView.SCROLLDIR_RIGHT=cc.p(1,0),ccui.ListView=ccui.ScrollView.extend({_model:null,_items:null,_gravity:null,_itemsMargin:0,_curSelectedIndex:0,_refreshViewDirty:!0,_listViewEventListener:null,_listViewEventSelector:null,ctor:function(){ccui.ScrollView.prototype.ctor.call(this),this._items=[],this._gravity=ccui.ListView.GRAVITY_CENTER_VERTICAL,this.setTouchEnabled(!0),this.init()},init:function(){return!!ccui.ScrollView.prototype.init.call(this)&&(this.setLayoutType(ccui.Layout.LINEAR_VERTICAL),!0)},setItemModel:function(e){e?this._model=e:cc.log("Can't set a null to item model!")},_updateInnerContainerSize:function(){var e,t,i=this._items;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:var n=((e=i.length)-1)*this._itemsMargin;for(t=0;t<e;t++)n+=i[t].getContentSize().height;this.setInnerContainerSize(cc.size(this._contentSize.width,n));break;case ccui.ScrollView.DIR_HORIZONTAL:var r=((e=i.length)-1)*this._itemsMargin;for(t=0;t<e;t++)r+=i[t].getContentSize().width;this.setInnerContainerSize(cc.size(r,this._contentSize.height))}},_remedyLayoutParameter:function(e){cc.assert(null!=e,"ListView Item can't be nil!");var t=e.getLayoutParameter(),i=!0;t||(t=new ccui.LinearLayoutParameter,i=!1);var n=this.getIndex(e);switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:this._remedyVerticalLayoutParameter(t,n);break;case ccui.ScrollView.DIR_HORIZONTAL:this._remedyHorizontalLayoutParameter(t,n)}i||e.setLayoutParameter(t)},_remedyVerticalLayoutParameter:function(e,t){switch(cc.assert(null!=e,"Layout parameter can't be nil!"),this._gravity){case ccui.ListView.GRAVITY_LEFT:e.setGravity(ccui.LinearLayoutParameter.LEFT);break;case ccui.ListView.GRAVITY_RIGHT:e.setGravity(ccui.LinearLayoutParameter.RIGHT);break;case ccui.ListView.GRAVITY_CENTER_HORIZONTAL:e.setGravity(ccui.LinearLayoutParameter.CENTER_HORIZONTAL)}0==t?e.setMargin(ccui.MarginZero()):e.setMargin(new ccui.Margin(0,this._itemsMargin,0,0))},_remedyHorizontalLayoutParameter:function(e,t){switch(cc.assert(null!=e,"Layout parameter can't be nil!"),this._gravity){case ccui.ListView.GRAVITY_TOP:e.setGravity(ccui.LinearLayoutParameter.TOP);break;case ccui.ListView.GRAVITY_BOTTOM:e.setGravity(ccui.LinearLayoutParameter.BOTTOM);break;case ccui.ListView.GRAVITY_CENTER_VERTICAL:e.setGravity(ccui.LinearLayoutParameter.CENTER_VERTICAL)}0==t?e.setMargin(ccui.MarginZero()):e.setMargin(new ccui.Margin(this._itemsMargin,0,0,0))},pushBackDefaultItem:function(){if(null!=this._model){var e=this._model.clone();this._remedyLayoutParameter(e),this.addChild(e),this._refreshViewDirty=!0}},insertDefaultItem:function(e){if(null!=this._model){var t=this._model.clone();this._items.splice(e,0,t),ccui.ScrollView.prototype.addChild.call(this,t),this._remedyLayoutParameter(t),this._refreshViewDirty=!0}},pushBackCustomItem:function(e){this._remedyLayoutParameter(e),this.addChild(e),this._refreshViewDirty=!0},addChild:function(e,t,i){e&&(t=t||e.getLocalZOrder(),i=i||e.getName(),ccui.ScrollView.prototype.addChild.call(this,e,t,i),e instanceof ccui.Widget&&this._items.push(e))},removeChild:function(e,t){if(e){var i=this._items.indexOf(e);i>-1&&this._items.splice(i,1),ccui.ScrollView.prototype.removeChild.call(this,e,t)}},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(e){ccui.ScrollView.prototype.removeAllChildrenWithCleanup.call(this,e),this._items=[]},insertCustomItem:function(e,t){this._items.splice(t,0,e),ccui.ScrollView.prototype.addChild.call(this,e),this._remedyLayoutParameter(e),this._refreshViewDirty=!0},removeItem:function(e){var t=this.getItem(e);null!=t&&(this.removeChild(t,!0),this._refreshViewDirty=!0)},removeLastItem:function(){this.removeItem(this._items.length-1)},removeAllItems:function(){this.removeAllChildren()},getItem:function(e){return e<0||e>=this._items.length?null:this._items[e]},getItems:function(){return this._items},getIndex:function(e){return null==e?-1:this._items.indexOf(e)},setGravity:function(e){this._gravity!=e&&(this._gravity=e,this._refreshViewDirty=!0)},setItemsMargin:function(e){this._itemsMargin!=e&&(this._itemsMargin=e,this._refreshViewDirty=!0)},getItemsMargin:function(){return this._itemsMargin},setDirection:function(e){switch(e){case ccui.ScrollView.DIR_VERTICAL:this.setLayoutType(ccui.Layout.LINEAR_VERTICAL);break;case ccui.ScrollView.DIR_HORIZONTAL:this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL);break;case ccui.ScrollView.DIR_BOTH:default:return}ccui.ScrollView.prototype.setDirection.call(this,e)},requestRefreshView:function(){this._refreshViewDirty=!0},refreshView:function(){for(var e=this._items,t=0;t<e.length;t++){var i=e[t];i.setLocalZOrder(t),this._remedyLayoutParameter(i)}this._updateInnerContainerSize()},doLayout:function(){this._doLayout()},_doLayout:function(){ccui.Layout.prototype._doLayout.call(this),this._refreshViewDirty&&(this.refreshView(),this._refreshViewDirty=!1)},addEventListenerListView:function(e,t){this.addEventListener(e,t)},addEventListener:function(e,t){this._listViewEventListener=t,this._listViewEventSelector=e},_selectedItemEvent:function(e){var t=e==ccui.Widget.TOUCH_BEGAN?ccui.ListView.ON_SELECTED_ITEM_START:ccui.ListView.ON_SELECTED_ITEM_END;this._listViewEventSelector&&(this._listViewEventListener?this._listViewEventSelector.call(this._listViewEventListener,this,t):this._listViewEventSelector(this,t)),this._ccEventCallback&&this._ccEventCallback(this,t)},interceptTouchEvent:function(e,t,i){if(ccui.ScrollView.prototype.interceptTouchEvent.call(this,e,t,i),e!=ccui.Widget.TOUCH_MOVED){for(var n=t;n;){if(n&&n.getParent()==this._innerContainer){this._curSelectedIndex=this.getIndex(n);break}n=n.getParent()}t.isHighlighted()&&this._selectedItemEvent(e)}},getCurSelectedIndex:function(){return this._curSelectedIndex},_onSizeChanged:function(){ccui.ScrollView.prototype._onSizeChanged.call(this),this._refreshViewDirty=!0},getDescription:function(){return"ListView"},_createCloneInstance:function(){return new ccui.ListView},_copyClonedWidgetChildren:function(e){for(var t=e.getItems(),i=0;i<t.length;i++){var n=t[i];this.pushBackCustomItem(n.clone())}},_copySpecialProperties:function(e){e instanceof ccui.ListView&&(ccui.ScrollView.prototype._copySpecialProperties.call(this,e),this.setItemModel(e._model),this.setItemsMargin(e._itemsMargin),this.setGravity(e._gravity),this._listViewEventListener=e._listViewEventListener,this._listViewEventSelector=e._listViewEventSelector)},forceDoLayout:function(){this._refreshViewDirty&&(this.refreshView(),this._refreshViewDirty=!1),this._innerContainer.forceDoLayout()}}),ccui.ListView.create=function(){return new ccui.ListView},ccui.ListView.EVENT_SELECTED_ITEM=0,ccui.ListView.ON_SELECTED_ITEM_START=0,ccui.ListView.ON_SELECTED_ITEM_END=1,ccui.ListView.GRAVITY_LEFT=0,ccui.ListView.GRAVITY_RIGHT=1,ccui.ListView.GRAVITY_CENTER_HORIZONTAL=2,ccui.ListView.GRAVITY_TOP=3,ccui.ListView.GRAVITY_BOTTOM=4,ccui.ListView.GRAVITY_CENTER_VERTICAL=5,ccui.PageView=ccui.Layout.extend({_curPageIdx:0,_pages:null,_touchMoveDirection:null,_touchStartLocation:0,_touchMoveStartLocation:0,_movePagePoint:null,_leftBoundaryChild:null,_rightBoundaryChild:null,_leftBoundary:0,_rightBoundary:0,_isAutoScrolling:!1,_autoScrollDistance:0,_autoScrollSpeed:0,_autoScrollDirection:0,_childFocusCancelOffset:0,_pageViewEventListener:null,_pageViewEventSelector:null,_className:"PageView",_customScrollThreshold:0,_usingCustomScrollThreshold:!1,ctor:function(){ccui.Layout.prototype.ctor.call(this),this._pages=[],this._touchMoveDirection=ccui.PageView.TOUCH_DIR_LEFT,this._movePagePoint=null,this._leftBoundaryChild=null,this._rightBoundaryChild=null,this._childFocusCancelOffset=5,this._pageViewEventListener=null,this._pageViewEventSelector=null,this.setTouchEnabled(!0)},init:function(){return!!ccui.Layout.prototype.init.call(this)&&(this.setClippingEnabled(!0),!0)},onEnter:function(){ccui.Layout.prototype.onEnter.call(this),this.scheduleUpdate(!0)},addWidgetToPage:function(e,t,i){if(e&&!(t<0)){var n=this._getPageCount();if(t<0||t>=n){if(i){t>n&&cc.log("pageIdx is %d, it will be added as page id [%d]",t,n);var r=this._createPage();r.addChild(e),this.addPage(r)}}else{var o=this._pages[t];o&&o.addChild(e)}}},_createPage:function(){var e=new ccui.Layout;return e.setContentSize(this.getContentSize()),e},addPage:function(e){e&&-1==this._pages.indexOf(e)&&(this.addChild(e),this._pages.push(e),this._doLayoutDirty=!0)},insertPage:function(e,t){t<0||!e||-1!=this._pages.indexOf(e)||(t>=this._getPageCount()?this.addPage(e):(this._pages[t]=e,this.addChild(e)),this._doLayoutDirty=!0)},removePage:function(e){if(e){this.removeChild(e);var t=this._pages.indexOf(e);t>-1&&this._pages.splice(t,1),this._doLayoutDirty=!0}},removePageAtIndex:function(e){if(!(e<0||e>=this._pages.length)){var t=this._pages[e];t&&this.removePage(t)}},removeAllPages:function(){for(var e=this._pages,t=0,i=e.length;t<i;t++)this.removeChild(e[t]);this._pages.length=0},_updateBoundaryPages:function(){var e=this._pages;if(e.length<=0)return this._leftBoundaryChild=null,void(this._rightBoundaryChild=null);this._leftBoundaryChild=e[0],this._rightBoundaryChild=e[e.length-1]},_getPageCount:function(){return this._pages.length},_getPositionXByIndex:function(e){return this.getContentSize().width*(e-this._curPageIdx)},_onSizeChanged:function(){ccui.Layout.prototype._onSizeChanged.call(this),this._rightBoundary=this.getContentSize().width,this._doLayoutDirty=!0},_updateAllPagesSize:function(){for(var e=this.getContentSize(),t=this._pages,i=0,n=t.length;i<n;i++)t[i].setContentSize(e)},_updateAllPagesPosition:function(){var e=this._getPageCount();if(e<=0)this._curPageIdx=0;else{this._curPageIdx>=e&&(this._curPageIdx=e-1);for(var t=this.getContentSize().width,i=this._pages,n=0;n<e;n++)i[n].setPosition(cc.p((n-this._curPageIdx)*t,0))}},scrollToPage:function(e){if(!(e<0||e>=this._pages.length)){this._curPageIdx=e;var t=this._pages[e];this._autoScrollDistance=-t.getPosition().x,this._autoScrollSpeed=Math.abs(this._autoScrollDistance)/.2,this._autoScrollDirection=this._autoScrollDistance>0?ccui.PageView.DIRECTION_RIGHT:ccui.PageView.DIRECTION_LEFT,this._isAutoScrolling=!0}},update:function(e){this._isAutoScrolling&&this._autoScroll(e)},setLayoutType:function(e){},getLayoutType:function(){return ccui.Layout.ABSOLUTE},_autoScroll:function(e){var t;switch(this._autoScrollDirection){case ccui.PageView.DIRECTION_LEFT:t=this._autoScrollSpeed*e,this._autoScrollDistance+t>=0?(t=-this._autoScrollDistance,this._autoScrollDistance=0,this._isAutoScrolling=!1):this._autoScrollDistance+=t,this._scrollPages(-t),this._isAutoScrolling||this._pageTurningEvent();break;case ccui.PageView.DIRECTION_RIGHT:t=this._autoScrollSpeed*e,this._autoScrollDistance-t<=0?(t=this._autoScrollDistance,this._autoScrollDistance=0,this._isAutoScrolling=!1):this._autoScrollDistance-=t,this._scrollPages(t),this._isAutoScrolling||this._pageTurningEvent()}},onTouchMoved:function(e,t){ccui.Layout.prototype.onTouchMoved.call(this,e,t),this._isInterceptTouch||this._handleMoveLogic(e)},onTouchEnded:function(e,t){ccui.Layout.prototype.onTouchEnded.call(this,e,t),this._isInterceptTouch||this._handleReleaseLogic(e),this._isInterceptTouch=!1},onTouchCancelled:function(e,t){ccui.Layout.prototype.onTouchCancelled.call(this,e,t),this._isInterceptTouch||this._handleReleaseLogic(e),this._isInterceptTouch=!1},_doLayout:function(){this._doLayoutDirty&&(this._updateAllPagesPosition(),this._updateAllPagesSize(),this._updateBoundaryPages(),this._doLayoutDirty=!1)},_movePages:function(e){for(var t=this._pages,i=t.length,n=0;n<i;n++){var r=t[n];r.setPositionX(r.getPositionX()+e)}},_scrollPages:function(e){if(this._pages.length<=0)return!1;if(!this._leftBoundaryChild||!this._rightBoundaryChild)return!1;var t=e;switch(this._touchMoveDirection){case ccui.PageView.TOUCH_DIR_LEFT:var i=this._rightBoundaryChild.getRightBoundary();if(i+e<=this._rightBoundary)return t=this._rightBoundary-i,this._movePages(t),!1;break;case ccui.PageView.TOUCH_DIR_RIGHT:var n=this._leftBoundaryChild.getLeftBoundary();if(n+e>=this._leftBoundary)return t=this._leftBoundary-n,this._movePages(t),!1}return this._movePages(t),!0},_handleMoveLogic:function(e){var t=e.getLocation().x-e.getPreviousLocation().x;t<0?this._touchMoveDirection=ccui.PageView.TOUCH_DIR_LEFT:t>0&&(this._touchMoveDirection=ccui.PageView.TOUCH_DIR_RIGHT),this._scrollPages(t)},setCustomScrollThreshold:function(e){cc.assert(e>0,"Invalid threshold!"),this._customScrollThreshold=e,this.setUsingCustomScrollThreshold(!0)},getCustomScrollThreshold:function(){return this._customScrollThreshold},setUsingCustomScrollThreshold:function(e){this._usingCustomScrollThreshold=e},isUsingCustomScrollThreshold:function(){return this._usingCustomScrollThreshold},_handleReleaseLogic:function(e){if(!(this._pages.length<=0)){var t=this._pages[this._curPageIdx];if(t){var i=t.getPosition(),n=this._pages.length,r=i.x,o=this.getSize().width;this._usingCustomScrollThreshold||(this._customScrollThreshold=o/2);var s=this._customScrollThreshold;r<=-s?this._curPageIdx>=n-1?this._scrollPages(-r):this.scrollToPage(this._curPageIdx+1):r>=s?this._curPageIdx<=0?this._scrollPages(-r):this.scrollToPage(this._curPageIdx-1):this.scrollToPage(this._curPageIdx)}}},interceptTouchEvent:function(e,t,i){var n=i.getLocation();switch(e){case ccui.Widget.TOUCH_BEGAN:this._touchBeganPosition.x=n.x,this._touchBeganPosition.y=n.y,this._isInterceptTouch=!0;break;case ccui.Widget.TOUCH_MOVED:this._touchMovePosition.x=n.x,this._touchMovePosition.y=n.y;Math.abs(t.getTouchBeganPosition().x-n.x)>this._childFocusCancelOffset&&(t.setFocused(!1),this._handleMoveLogic(i));break;case ccui.Widget.TOUCH_ENDED:case ccui.Widget.TOUCH_CANCELED:this._touchEndPosition.x=n.x,this._touchEndPosition.y=n.y,this._handleReleaseLogic(i),t.isSwallowTouches()&&(this._isInterceptTouch=!1)}},_pageTurningEvent:function(){this._pageViewEventSelector&&(this._pageViewEventListener?this._pageViewEventSelector.call(this._pageViewEventListener,this,ccui.PageView.EVENT_TURNING):this._pageViewEventSelector(this,ccui.PageView.EVENT_TURNING)),this._ccEventCallback&&this._ccEventCallback(this,ccui.PageView.EVENT_TURNING)},addEventListenerPageView:function(e,t){this.addEventListener(e,t)},addEventListener:function(e,t){this._pageViewEventSelector=e,this._pageViewEventListener=t},getCurPageIndex:function(){return this._curPageIdx},getPages:function(){return this._pages},getPage:function(e){return e<0||e>=this.getPages().size()?null:this._pages[e]},getDescription:function(){return"PageView"},_createCloneInstance:function(){return new ccui.PageView},_copyClonedWidgetChildren:function(e){for(var t=e.getPages(),i=0;i<t.length;i++){var n=t[i];this.addPage(n.clone())}},_copySpecialProperties:function(e){ccui.Layout.prototype._copySpecialProperties.call(this,e),this._ccEventCallback=e._ccEventCallback,this._pageViewEventListener=e._pageViewEventListener,this._pageViewEventSelector=e._pageViewEventSelector,this._usingCustomScrollThreshold=e._usingCustomScrollThreshold,this._customScrollThreshold=e._customScrollThreshold}}),ccui.PageView.create=function(){return new ccui.PageView},ccui.PageView.EVENT_TURNING=0,ccui.PageView.TOUCH_DIR_LEFT=0,ccui.PageView.TOUCH_DIR_RIGHT=1,ccui.PageView.DIRECTION_LEFT=0,ccui.PageView.DIRECTION_RIGHT=1,cc.Component=cc.Class.extend({_owner:null,_name:"",_enabled:!0,ctor:function(){this._owner=null,this._name="",this._enabled=!0},init:function(){return!0},onEnter:function(){},onExit:function(){},update:function(e){},serialize:function(e){},isEnabled:function(){return this._enabled},setEnabled:function(e){this._enabled=e},getName:function(){return this._name},setName:function(e){this._name=e},setOwner:function(e){this._owner=e},getOwner:function(){return this._owner}}),cc.Component.create=function(){return new cc.Component},ccui.LayoutComponent_ReferencePoint={BOTTOM_LEFT:0,TOP_LEFT:1,BOTTOM_RIGHT:2,TOP_RIGHT:3},ccui.LayoutComponent_PositionType={Position:0,RelativePosition:1,PreRelativePosition:2,PreRelativePositionEnable:3},ccui.LayoutComponent_SizeType={Size:0,PreSize:1,PreSizeEnable:2},ccui.LayoutComponent=cc.Component.extend({_horizontalEdge:0,_verticalEdge:0,_leftMargin:0,_rightMargin:0,_bottomMargin:0,_topMargin:0,_usingPositionPercentX:!1,_positionPercentX:0,_usingPositionPercentY:!1,_positionPercentY:0,_usingStretchWidth:!1,_usingStretchHeight:!1,_percentWidth:0,_usingPercentWidth:!1,_percentHeight:0,_usingPercentHeight:!1,_actived:!0,_isPercentOnly:!1,ctor:function(){this._name=ccui.LayoutComponent.NAME},init:function(){return!!cc.Component.prototype.init.call(this)},getPercentContentSize:function(){return cc.p(this._percentWidth,this._percentHeight)},setPercentContentSize:function(e){this.setPercentWidth(e.x),this.setPercentHeight(e.y)},setUsingPercentContentSize:function(e){this._usingPercentWidth=this._usingPercentHeight=e},SetActiveEnable:function(e){this._actived=e},getUsingPercentContentSize:function(){return this._usingPercentWidth&&this._usingPercentHeight},getAnchorPosition:function(){return this._owner.getAnchorPoint()},setAnchorPosition:function(e,t){var i=this._owner.getBoundingBox();this._owner.setAnchorPoint(e,t);var n=this._owner.getBoundingBox(),r=i.x-n.x,o=i.y-n.y,s=this._owner.getPosition();s.x+=r,s.y+=o,this.setPosition(s)},getPosition:function(){return this._owner.getPosition()},setPosition:function(e,t){var i,n=this._getOwnerParent();if(null!=n){void 0===t?(i=e.x,t=e.y):i=e;var r=n.getContentSize();0!=r.width?this._positionPercentX=i/r.width:(this._positionPercentX=0,this._usingPositionPercentX&&(i=0)),0!=r.height?this._positionPercentY=t/r.height:(this._positionPercentY=0,this._usingPositionPercentY&&(t=0)),this._owner.setPosition(i,t),this._refreshHorizontalMargin(),this._refreshVerticalMargin()}else this._owner.setPosition(e,t)},isPositionPercentXEnabled:function(){return this._usingPositionPercentX},setPositionPercentXEnabled:function(e){this._usingPositionPercentX=e,this._usingPositionPercentX&&(this._horizontalEdge=ccui.LayoutComponent.horizontalEdge.NONE)},getPositionPercentX:function(){return this._positionPercentX},setPositionPercentX:function(e){this._positionPercentX=e;var t=this._getOwnerParent();null!=t&&(this._owner.setPositionX(t.width*this._positionPercentX),this._refreshHorizontalMargin())},isPositionPercentYEnabled:function(){return this._usingPositionPercentY},setPositionPercentYEnabled:function(e){this._usingPositionPercentY=e,this._usingPositionPercentY&&(this._verticalEdge=ccui.LayoutComponent.verticalEdge.NONE)},getPositionPercentY:function(){return this._positionPercentY},setPositionPercentY:function(e){this._positionPercentY=e;var t=this._getOwnerParent();null!=t&&(this._owner.setPositionY(t.height*this._positionPercentY),this._refreshVerticalMargin())},getHorizontalEdge:function(){return this._horizontalEdge},setHorizontalEdge:function(e){this._horizontalEdge=e,this._horizontalEdge!=ccui.LayoutComponent.horizontalEdge.NONE&&(this._usingPositionPercentX=!1);var t=this._getOwnerParent();if(null!=t){var i=this._owner.getPosition(),n=t.getContentSize();0!=n.width?this._positionPercentX=i.x/n.width:(this._positionPercentX=0,i.x=0,this._usingPositionPercentX&&this._owner.setPosition(i)),this._refreshHorizontalMargin()}},getVerticalEdge:function(){return this._verticalEdge},setVerticalEdge:function(e){this._verticalEdge=e,this._verticalEdge!=ccui.LayoutComponent.verticalEdge.NONE&&(this._usingPositionPercentY=!1);var t=this._getOwnerParent();if(null!=t){var i=this._owner.getPosition(),n=t.getContentSize();0!=n.height?this._positionPercentY=i.y/n.height:(this._positionPercentY=0,i.y=0,this._usingPositionPercentY&&this._owner.setPosition(i)),this._refreshVerticalMargin()}},getLeftMargin:function(){return this._leftMargin},setLeftMargin:function(e){this._leftMargin=e},getRightMargin:function(){return this._rightMargin},setRightMargin:function(e){this._rightMargin=e},getTopMargin:function(){return this._topMargin},setTopMargin:function(e){this._topMargin=e},getBottomMargin:function(){return this._bottomMargin},setBottomMargin:function(e){this._bottomMargin=e},getSize:function(){return this.getOwner().getContentSize()},setSize:function(e){var t=this._getOwnerParent();if(null!=t){var i=e,n=t.getContentSize();0!=n.width?this._percentWidth=i.width/n.width:(this._percentWidth=0,this._usingPercentWidth&&(i.width=0)),0!=n.height?this._percentHeight=i.height/n.height:(this._percentHeight=0,this._usingPercentHeight&&(i.height=0)),this._owner.setContentSize(i),this._refreshHorizontalMargin(),this._refreshVerticalMargin()}else this._owner.setContentSize(e)},isPercentWidthEnabled:function(){return this._usingPercentWidth},setPercentWidthEnabled:function(e){this._usingPercentWidth=e,this._usingPercentWidth&&(this._usingStretchWidth=!1)},getSizeWidth:function(){return this._owner.width},setSizeWidth:function(e){var t=this._owner.getContentSize();t.width=e;var i=this._getOwnerParent();if(null!=i){var n=i.getContentSize();0!=n.width?this._percentWidth=t.width/n.width:(this._percentWidth=0,this._usingPercentWidth&&(t.width=0)),this._owner.setContentSize(t),this._refreshHorizontalMargin()}else this._owner.setContentSize(t)},getPercentWidth:function(){return this._percentWidth},setPercentWidth:function(e){this._percentWidth=e;var t=this._getOwnerParent();if(null!=t){var i=this._owner.getContentSize();i.width=t.width*this._percentWidth,this._owner.setContentSize(i),this._refreshHorizontalMargin()}},isPercentHeightEnabled:function(){return this._usingPercentHeight},setPercentHeightEnabled:function(e){this._usingPercentHeight=e,this._usingPercentHeight&&(this._usingStretchHeight=!1)},getSizeHeight:function(){return this._owner.height},setSizeHeight:function(e){var t=this._owner.getContentSize();t.height=e;var i=this._getOwnerParent();if(null!=i){var n=i.getContentSize();0!=n.height?this._percentHeight=t.height/n.height:(this._percentHeight=0,this._usingPercentHeight&&(t.height=0)),this._owner.setContentSize(t),this._refreshVerticalMargin()}else this._owner.setContentSize(t)},getPercentHeight:function(){return this._percentHeight},setPercentHeight:function(e){this._percentHeight=e;var t=this._getOwnerParent();if(null!=t){var i=this._owner.getContentSize();i.height=t.height*this._percentHeight,this._owner.setContentSize(i),this._refreshVerticalMargin()}},isStretchWidthEnabled:function(){return this._usingStretchWidth},setStretchWidthEnabled:function(e){this._usingStretchWidth=e,this._usingStretchWidth&&(this._usingPercentWidth=!1)},isStretchHeightEnabled:function(){return this._usingStretchHeight},setStretchHeightEnabled:function(e){this._usingStretchHeight=e,this._usingStretchHeight&&(this._usingPercentHeight=!1)},setPercentOnlyEnabled:function(e){this._isPercentOnly=e},setActiveEnabled:function(e){this._actived=e},refreshLayout:function(){if(this._actived){var e=this._getOwnerParent();if(null!=e){var t=e.getContentSize(),i=this._owner,n=i.getAnchorPoint(),r=i.getContentSize(),o=i.getPosition();switch(this._horizontalEdge){case ccui.LayoutComponent.horizontalEdge.NONE:this._usingStretchWidth&&!this._isPercentOnly?(r.width=t.width*this._percentWidth,o.x=this._leftMargin+n.x*r.width):(this._usingPositionPercentX&&(o.x=t.width*this._positionPercentX),this._usingPercentWidth&&(r.width=t.width*this._percentWidth));break;case ccui.LayoutComponent.horizontalEdge.LEFT:if(this._isPercentOnly)break;(this._usingPercentWidth||this._usingStretchWidth)&&(r.width=t.width*this._percentWidth),o.x=this._leftMargin+n.x*r.width;break;case ccui.LayoutComponent.horizontalEdge.RIGHT:if(this._isPercentOnly)break;(this._usingPercentWidth||this._usingStretchWidth)&&(r.width=t.width*this._percentWidth),o.x=t.width-(this._rightMargin+(1-n.x)*r.width);break;case ccui.LayoutComponent.horizontalEdge.CENTER:if(this._isPercentOnly)break;this._usingStretchWidth?(r.width=t.width-this._leftMargin-this._rightMargin,r.width<0&&(r.width=0),o.x=this._leftMargin+n.x*r.width):(this._usingPercentWidth&&(r.width=t.width*this._percentWidth),o.x=t.width*this._positionPercentX)}switch(this._verticalEdge){case ccui.LayoutComponent.verticalEdge.NONE:this._usingStretchHeight&&!this._isPercentOnly?(r.height=t.height*this._percentHeight,o.y=this._bottomMargin+n.y*r.height):(this._usingPositionPercentY&&(o.y=t.height*this._positionPercentY),this._usingPercentHeight&&(r.height=t.height*this._percentHeight));break;case ccui.LayoutComponent.verticalEdge.BOTTOM:if(this._isPercentOnly)break;(this._usingPercentHeight||this._usingStretchHeight)&&(r.height=t.height*this._percentHeight),o.y=this._bottomMargin+n.y*r.height;break;case ccui.LayoutComponent.verticalEdge.TOP:if(this._isPercentOnly)break;(this._usingPercentHeight||this._usingStretchHeight)&&(r.height=t.height*this._percentHeight),o.y=t.height-(this._topMargin+(1-n.y)*r.height);break;case ccui.LayoutComponent.verticalEdge.CENTER:if(this._isPercentOnly)break;this._usingStretchHeight?(r.height=t.height-this._topMargin-this._bottomMargin,r.height<0&&(r.height=0),o.y=this._bottomMargin+n.y*r.height):(this._usingPercentHeight&&(r.height=t.height*this._percentHeight),o.y=t.height*this._positionPercentY)}i.setPosition(o),i.setContentSize(r),ccui.helper.doLayout(i)}}},_getOwnerParent:function(){return this._owner?this._owner.getParent():null},_refreshHorizontalMargin:function(){var e=this._getOwnerParent();if(null!=e){var t=this._owner.getPosition(),i=this._owner.getAnchorPoint(),n=this._owner.getContentSize(),r=e.getContentSize();this._leftMargin=t.x-i.x*n.width,this._rightMargin=r.width-(t.x+(1-i.x)*n.width)}},_refreshVerticalMargin:function(){var e=this._getOwnerParent();if(null!=e){var t=this._owner.getPosition(),i=this._owner.getAnchorPoint(),n=this._owner.getContentSize(),r=e.getContentSize();this._bottomMargin=t.y-i.y*n.height,this._topMargin=r.height-(t.y+(1-i.y)*n.height)}}}),ccui.LayoutComponent.horizontalEdge={NONE:0,LEFT:1,RIGHT:2,CENTER:3},ccui.LayoutComponent.verticalEdge={NONE:0,BOTTOM:1,TOP:2,CENTER:3},ccui.LayoutComponent.NAME="__ui_layout",ccui.LayoutComponent.bindLayoutComponent=function(e){var t=e.getComponent(ccui.LayoutComponent.NAME);return null!=t?t:(t=new ccui.LayoutComponent)&&t.init()?(e.addComponent(t),t):null},cc.ComponentContainer=cc.Class.extend({_components:null,_owner:null,ctor:function(e){this._components=null,this._owner=e},getComponent:function(e){if(!e)throw"cc.ComponentContainer.getComponent(): name should be non-null";return e=e.trim(),this._components||(this._components={}),this._components[e]},add:function(e){if(!e)throw"cc.ComponentContainer.add(): component should be non-null";return e.getOwner()?(cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1):(null==this._components&&(this._components={},this._owner.scheduleUpdate()),this._components[e.getName()]?(cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1):(e.setOwner(this._owner),this._components[e.getName()]=e,e.onEnter(),!0))},remove:function(e){if(!e)throw"cc.ComponentContainer.remove(): name should be non-null";return!!this._components&&(e instanceof cc.Component?this._removeByComponent(e):(e=e.trim(),this._removeByComponent(this._components[e])))},_removeByComponent:function(e){return!!e&&(e.onExit(),e.setOwner(null),delete this._components[e.getName()],!0)},removeAll:function(){if(this._components){var e=this._components;for(var t in e){var i=e[t];i.onExit(),i.setOwner(null),delete e[t]}this._owner.unscheduleUpdate(),this._components=null}},_alloc:function(){this._components={}},visit:function(e){if(this._components){var t=this._components;for(var i in t)t[i].update(e)}},isEmpty:function(){return!this._components||0==this._components.length}});var ccs=ccs||{};ccs.Class=ccs.Class||cc.Class,ccs.Class.extend=ccs.Class.extend||cc.Class.extend,ccs.Node=ccs.Node||cc.Node,ccs.Node.extend=ccs.Node.extend||cc.Node.extend,ccs.Sprite=ccs.Sprite||cc.Sprite,ccs.Sprite.extend=ccs.Sprite.extend||cc.Sprite.extend,ccs.Component=ccs.Component||cc.Component,ccs.Component.extend=ccs.Component.extend||cc.Component.extend,ccs.cocostudioVersion="v1.3.0.0",ccs.VERSION_COMBINED=.3,ccs.VERSION_CHANGE_ROTATION_RANGE=1,ccs.VERSION_COLOR_READING=1.1,ccs.MAX_VERTEXZ_VALUE=5e6,ccs.ARMATURE_MAX_CHILD=50,ccs.ARMATURE_MAX_ZORDER=100,ccs.ARMATURE_MAX_COUNT=ccs.MAX_VERTEXZ_VALUE/ccs.ARMATURE_MAX_CHILD/ccs.ARMATURE_MAX_ZORDER,ccs.AUTO_ADD_SPRITE_FRAME_NAME_PREFIX=!1,ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT=!1,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX=!1,ccs.armatureVersion=function(){return"v1.1.0.0"},ccs.CONST_VERSION="version",ccs.CONST_VERSION_2_0=2,ccs.CONST_VERSION_COMBINED=.3,ccs.CONST_ARMATURES="armatures",ccs.CONST_ARMATURE="armature",ccs.CONST_BONE="b",ccs.CONST_DISPLAY="d",ccs.CONST_ANIMATIONS="animations",ccs.CONST_ANIMATION="animation",ccs.CONST_MOVEMENT="mov",ccs.CONST_FRAME="f",ccs.CONST_TEXTURE_ATLAS="TextureAtlas",ccs.CONST_SUB_TEXTURE="SubTexture",ccs.CONST_SKELETON="skeleton",ccs.CONST_A_NAME="name",ccs.CONST_A_DURATION="dr",ccs.CONST_A_FRAME_INDEX="fi",ccs.CONST_A_DURATION_TO="to",ccs.CONST_A_DURATION_TWEEN="drTW",ccs.CONST_A_LOOP="lp",ccs.CONST_A_MOVEMENT_SCALE="sc",ccs.CONST_A_MOVEMENT_DELAY="dl",ccs.CONST_A_DISPLAY_INDEX="dI",ccs.CONST_A_PLIST="plist",ccs.CONST_A_PARENT="parent",ccs.CONST_A_SKEW_X="kX",ccs.CONST_A_SKEW_Y="kY",ccs.CONST_A_SCALE_X="cX",ccs.CONST_A_SCALE_Y="cY",ccs.CONST_A_Z="z",ccs.CONST_A_EVENT="evt",ccs.CONST_A_SOUND="sd",ccs.CONST_A_SOUND_EFFECT="sdE",ccs.CONST_A_TWEEN_EASING="twE",ccs.CONST_A_EASING_PARAM="twEP",ccs.CONST_A_TWEEN_ROTATE="twR",ccs.CONST_A_IS_ARMATURE="isArmature",ccs.CONST_A_DISPLAY_TYPE="displayType",ccs.CONST_A_MOVEMENT="mov",ccs.CONST_A_X="x",ccs.CONST_A_Y="y",ccs.CONST_A_COCOS2DX_X="cocos2d_x",ccs.CONST_A_COCOS2DX_Y="cocos2d_y",ccs.CONST_A_WIDTH="width",ccs.CONST_A_HEIGHT="height",ccs.CONST_A_PIVOT_X="pX",ccs.CONST_A_PIVOT_Y="pY",ccs.CONST_A_COCOS2D_PIVOT_X="cocos2d_pX",ccs.CONST_A_COCOS2D_PIVOT_Y="cocos2d_pY",ccs.CONST_A_BLEND_TYPE="bd",ccs.CONST_A_BLEND_SRC="bd_src",ccs.CONST_A_BLEND_DST="bd_dst",ccs.CONST_A_ALPHA="a",ccs.CONST_A_RED="r",ccs.CONST_A_GREEN="g",ccs.CONST_A_BLUE="b",ccs.CONST_A_ALPHA_OFFSET="aM",ccs.CONST_A_RED_OFFSET="rM",ccs.CONST_A_GREEN_OFFSET="gM",ccs.CONST_A_BLUE_OFFSET="bM",ccs.CONST_A_COLOR_TRANSFORM="colorTransform",ccs.CONST_A_TWEEN_FRAME="tweenFrame",ccs.CONST_CONTOUR="con",ccs.CONST_CONTOUR_VERTEX="con_vt",ccs.CONST_FL_NAN="NaN",ccs.CONST_FRAME_DATA="frame_data",ccs.CONST_MOVEMENT_BONE_DATA="mov_bone_data",ccs.CONST_MOVEMENT_DATA="mov_data",ccs.CONST_ANIMATION_DATA="animation_data",ccs.CONST_DISPLAY_DATA="display_data",ccs.CONST_SKIN_DATA="skin_data",ccs.CONST_BONE_DATA="bone_data",ccs.CONST_ARMATURE_DATA="armature_data",ccs.CONST_CONTOUR_DATA="contour_data",ccs.CONST_TEXTURE_DATA="texture_data",ccs.CONST_VERTEX_POINT="vertex",ccs.CONST_COLOR_INFO="color",ccs.CONST_CONFIG_FILE_PATH="config_file_path",ccs.CONST_CONTENT_SCALE="content_scale",ccs.DataInfo=function(){this.asyncStruct=null,this.configFileQueue=[],this.contentScale=1,this.filename="",this.baseFilePath="",this.flashToolVersion=0,this.cocoStudioVersion=0},ccs.dataReaderHelper={ConfigType:{DragonBone_XML:0,CocoStudio_JSON:1,CocoStudio_Binary:2},_configFileList:[],_flashToolVersion:ccs.CONST_VERSION_2_0,_positionReadScale:1,_asyncRefCount:0,_asyncRefTotalCount:0,_dataQueue:null,setPositionReadScale:function(e){this._positionReadScale=e},getPositionReadScale:function(){return this._positionReadScale},addDataFromFile:function(e){if(-1==this._configFileList.indexOf(e)){this._configFileList.push(e);var t=this._initBaseFilePath(e),i=cc.path.extname(e).toLowerCase(),n=new ccs.DataInfo;n.filename=e,n.basefilePath=t,".xml"==i?ccs.dataReaderHelper.addDataFromXML(e,n):".json"==i||".exportjson"==i?ccs.dataReaderHelper.addDataFromJson(e,n):".csb"==i&&ccs.dataReaderHelper.addDataFromBinaryCache(e,n)}},addDataFromFileAsync:function(e,t,i,n,r){if(-1==this._configFileList.indexOf(i)){this._asyncRefTotalCount++,this._asyncRefCount++;var o=this;cc.director.getScheduler().scheduleCallbackForTarget(this,function(){o.addDataFromFile(i),o._asyncRefCount--,o._asyncCallBack(n,r,(o._asyncRefTotalCount-o._asyncRefCount)/o._asyncRefTotalCount)},.1,!1)}else r&&n&&(0==this._asyncRefTotalCount&&0==this._asyncRefCount?this._asyncCallBack(n,r,1):this._asyncCallBack(n,r,(this._asyncRefTotalCount-this._asyncRefCount)/this._asyncRefTotalCount))},removeConfigFile:function(e){for(var t=this._configFileList,i=t.length,n=t[i],r=0;r<i;r++)t[r]==e&&(n=r);n!=t[i]&&cc.arrayRemoveObject(t,e)},addDataFromCache:function(e,t){if(e){t.flashToolVersion=parseFloat(e.getAttribute(ccs.CONST_VERSION));var i,n=e.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ARMATURES+" >  "+ccs.CONST_ARMATURE),r=ccs.armatureDataManager;for(i=0;i<n.length;i++){var o=this.decodeArmature(n[i],t);r.addArmatureData(o.name,o,t.filename)}var s=e.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ANIMATIONS+" >  "+ccs.CONST_ANIMATION);for(i=0;i<s.length;i++){var a=this.decodeAnimation(s[i],t);r.addAnimationData(a.name,a,t.filename)}var c=e.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_TEXTURE_ATLAS+" >  "+ccs.CONST_SUB_TEXTURE);for(i=0;i<c.length;i++){var l=this.decodeTexture(c[i],t);r.addTextureData(l.name,l,t.filename)}}else cc.log("XML error  or  XML is empty.")},decodeArmature:function(e,t){var i=new ccs.ArmatureData;i.init(),i.name=e.getAttribute(ccs.CONST_A_NAME);for(var n=e.querySelectorAll(ccs.CONST_ARMATURE+" > "+ccs.CONST_BONE),r=0;r<n.length;r++){var o=n[r],s=o.getAttribute(ccs.CONST_A_PARENT),a=null;if(s)for(var c=0;c<n.length&&(a=n[c],s!=n[c].getAttribute(ccs.CONST_A_NAME));c++);var l=this.decodeBone(o,a,t);i.addBoneData(l)}return i},decodeArmatureFromJSON:function(e,t){var i=new ccs.ArmatureData;i.init();var n=e[ccs.CONST_A_NAME];n&&(i.name=n),t.cocoStudioVersion=i.dataVersion=e[ccs.CONST_VERSION]||.1;for(var r=e[ccs.CONST_BONE_DATA],o=0;o<r.length;o++){var s=this.decodeBoneFromJson(r[o],t);i.addBoneData(s)}return i},decodeBone:function(e,t,i){var n=new ccs.BoneData;n.init(),n.name=e.getAttribute(ccs.CONST_A_NAME),n.parentName=e.getAttribute(ccs.CONST_A_PARENT)||"",n.zOrder=parseInt(e.getAttribute(ccs.CONST_A_Z))||0;for(var r=e.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_DISPLAY),o=0;o<r.length;o++){var s=r[o],a=this.decodeBoneDisplay(s,i);n.addDisplayData(a)}return n},decodeBoneFromJson:function(e,t){var i=new ccs.BoneData;i.init(),this.decodeNodeFromJson(i,e,t),i.name=e[ccs.CONST_A_NAME]||"",i.parentName=e[ccs.CONST_A_PARENT]||"";for(var n=e[ccs.CONST_DISPLAY_DATA]||[],r=0;r<n.length;r++){var o=this.decodeBoneDisplayFromJson(n[r],t);i.addDisplayData(o)}return i},decodeBoneDisplay:function(e,t){var i=null;1==(parseFloat(e.getAttribute(ccs.CONST_A_IS_ARMATURE))||0)?(i=new ccs.ArmatureDisplayData).displayType=ccs.DISPLAY_TYPE_ARMATURE:(i=new ccs.SpriteDisplayData).displayType=ccs.DISPLAY_TYPE_SPRITE;var n=e.getAttribute(ccs.CONST_A_NAME)||"";return n&&(i.displayName=n),i},decodeBoneDisplayFromJson:function(e,t){var i=e[ccs.CONST_A_DISPLAY_TYPE]||ccs.DISPLAY_TYPE_SPRITE,n=null;switch(i){case ccs.DISPLAY_TYPE_SPRITE:n=new ccs.SpriteDisplayData,null!=(s=e[ccs.CONST_A_NAME])&&(n.displayName=s);var r=(e[ccs.CONST_SKIN_DATA]||[])[0];if(r){var o=n.skinData;o.x=r[ccs.CONST_A_X]*this._positionReadScale,o.y=r[ccs.CONST_A_Y]*this._positionReadScale,o.scaleX=null==r[ccs.CONST_A_SCALE_X]?1:r[ccs.CONST_A_SCALE_X],o.scaleY=null==r[ccs.CONST_A_SCALE_Y]?1:r[ccs.CONST_A_SCALE_Y],o.skewX=null==r[ccs.CONST_A_SKEW_X]?1:r[ccs.CONST_A_SKEW_X],o.skewY=null==r[ccs.CONST_A_SKEW_Y]?1:r[ccs.CONST_A_SKEW_Y],o.x*=t.contentScale,o.y*=t.contentScale}break;case ccs.DISPLAY_TYPE_ARMATURE:n=new ccs.ArmatureDisplayData;var s=e[ccs.CONST_A_NAME];null!=s&&(n.displayName=e[ccs.CONST_A_NAME]);break;case ccs.DISPLAY_TYPE_PARTICLE:n=new ccs.ParticleDisplayData;var a=e[ccs.CONST_A_PLIST];null!=a&&(t.asyncStruct?n.displayName=t.asyncStruct.basefilePath+a:n.displayName=t.basefilePath+a);break;default:n=new ccs.SpriteDisplayData}return n.displayType=i,n},decodeAnimation:function(e,t){var i=new ccs.AnimationData,n=e.getAttribute(ccs.CONST_A_NAME),r=ccs.armatureDataManager.getArmatureData(n);i.name=n;for(var o=e.querySelectorAll(ccs.CONST_ANIMATION+" > "+ccs.CONST_MOVEMENT),s=null,a=0;a<o.length;a++){s=o[a];var c=this.decodeMovement(s,r,t);i.addMovement(c)}return i},decodeAnimationFromJson:function(e,t){var i=new ccs.AnimationData;e[ccs.CONST_A_NAME]&&(i.name=e[ccs.CONST_A_NAME]);for(var n=e[ccs.CONST_MOVEMENT_DATA]||[],r=0;r<n.length;r++){var o=this.decodeMovementFromJson(n[r],t);i.addMovement(o)}return i},decodeMovement:function(e,t,i){var n=new ccs.MovementData;n.name=e.getAttribute(ccs.CONST_A_NAME);var r,o,s,a,c=0;r=e.getAttribute(ccs.CONST_A_DURATION),n.duration=null==r?0:parseFloat(r),o=e.getAttribute(ccs.CONST_A_DURATION_TO),n.durationTo=null==o?0:parseFloat(o),s=e.getAttribute(ccs.CONST_A_DURATION_TWEEN),n.durationTween=null==s?0:parseFloat(s),a=e.getAttribute(ccs.CONST_A_LOOP),n.loop=!a||Boolean(parseFloat(a));var l=e.getAttribute(ccs.CONST_A_TWEEN_EASING);l&&(l!=ccs.CONST_FL_NAN?(c=null==l?0:parseFloat(l),n.tweenEasing=2==c?ccs.TweenType.sineEaseInOut:c):n.tweenEasing=ccs.TweenType.linear);for(var u=e.querySelectorAll(ccs.CONST_MOVEMENT+" > "+ccs.CONST_BONE),h=null,d=0;d<u.length;d++){var p=(h=u[d]).getAttribute(ccs.CONST_A_NAME);if(!n.getMovementBoneData(p)){var _=t.getBoneData(p),f=_.parentName,m=null;if(""!=f)for(var g=0;g<u.length&&(m=u[g],f!=m.getAttribute(ccs.CONST_A_NAME));g++);var y=this.decodeMovementBone(h,m,_,i);n.addMovementBoneData(y)}}return n},decodeMovementFromJson:function(e,t){var i=new ccs.MovementData;i.loop=null!=e[ccs.CONST_A_LOOP]&&e[ccs.CONST_A_LOOP],i.durationTween=e[ccs.CONST_A_DURATION_TWEEN]||0,i.durationTo=e[ccs.CONST_A_DURATION_TO]||0,i.duration=e[ccs.CONST_A_DURATION]||0,null==e[ccs.CONST_A_DURATION]?i.scale=1:i.scale=null==e[ccs.CONST_A_MOVEMENT_SCALE]?1:e[ccs.CONST_A_MOVEMENT_SCALE],i.tweenEasing=null==e[ccs.CONST_A_TWEEN_EASING]?ccs.TweenType.linear:e[ccs.CONST_A_TWEEN_EASING];var n=e[ccs.CONST_A_NAME];n&&(i.name=n);for(var r=e[ccs.CONST_MOVEMENT_BONE_DATA]||[],o=0;o<r.length;o++){var s=this.decodeMovementBoneFromJson(r[o],t);i.addMovementBoneData(s)}return i},decodeMovementBone:function(e,t,i,n){var r=new ccs.MovementBoneData;r.init();var o,s;e&&(o=parseFloat(e.getAttribute(ccs.CONST_A_MOVEMENT_SCALE))||0,r.scale=o,(s=parseFloat(e.getAttribute(ccs.CONST_A_MOVEMENT_DELAY))||0)>0&&(s-=1),r.delay=s);var a=0,c=0,l=0,u=null,h=[];if(null!=t){for(var d=t.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),p=0;p<d.length;p++)h.push(d[p]);a=h.length}r.name=e.getAttribute(ccs.CONST_A_NAME);for(var _=e.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),f=0,m=0,g=0;g<_.length;g++){var y=_[g];if(t)for(;f<a&&(!u||(m<c||m>=c+l));)u=h[f],c+=l,l=parseFloat(u.getAttribute(ccs.CONST_A_DURATION)),f++;var T=this.decodeFrame(y,u,i,n);r.addFrameData(T),T.frameID=m,m+=T.duration,r.duration=m}for(var v=r.frameList,S=Math.PI,p=v.length-1;p>=0;p--)if(p>0){var C=v[p].skewX-v[p-1].skewX,E=v[p].skewY-v[p-1].skewY;(C<-S||C>S)&&(v[p-1].skewX=C<0?v[p-1].skewX-2*S:v[p-1].skewX+2*S),(E<-S||E>S)&&(v[p-1].skewY=E<0?v[p-1].skewY-2*S:v[p-1].skewY+2*S)}var b=new ccs.FrameData;return b.copy(r.frameList[r.frameList.length-1]),b.frameID=r.duration,r.addFrameData(b),r},decodeMovementBoneFromJson:function(e,t){var i=new ccs.MovementBoneData;i.init(),i.delay=e[ccs.CONST_A_MOVEMENT_DELAY]||0;var n=e[ccs.CONST_A_NAME];n&&(i.name=n);for(var r=(e[ccs.CONST_FRAME_DATA]||[]).length,o=0;o<r;o++){var s=e[ccs.CONST_FRAME_DATA][o],a=this.decodeFrameFromJson(s,t);i.addFrameData(a),t.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&(a.frameID=i.duration,i.duration+=a.duration)}if(t.cocoStudioVersion<ccs.VERSION_CHANGE_ROTATION_RANGE)for(var c=i.frameList,l=Math.PI,o=c.length-1;o>=0;o--)if(o>0){var u=c[o].skewX-c[o-1].skewX,h=c[o].skewY-c[o-1].skewY;(u<-l||u>l)&&(c[o-1].skewX=u<0?c[o-1].skewX-2*l:c[o-1].skewX+2*l),(h<-l||h>l)&&(c[o-1].skewY=h<0?c[o-1].skewY-2*l:c[o-1].skewY+2*l)}return t.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&i.frameList.length>0&&((a=new ccs.FrameData).copy(i.frameList[i.frameList.length-1]),i.addFrameData(a),a.frameID=i.duration),i},decodeFrame:function(e,t,i,n){var r=0,o=0,s=0,a=0,c=0,l=0,u=0,h=0,d=0,p=0,_=0,f=0,m=new ccs.FrameData;m.strMovement=e.getAttribute(ccs.CONST_A_MOVEMENT)||"",m.movement=m.strMovement,m.strEvent=e.getAttribute(ccs.CONST_A_EVENT)||"",m.event=m.strEvent,m.strSound=e.getAttribute(ccs.CONST_A_SOUND)||"",m.sound=m.strSound,m.strSoundEffect=e.getAttribute(ccs.CONST_A_SOUND_EFFECT)||"",m.soundEffect=m.strSoundEffect;var g=e.getAttribute(ccs.CONST_A_TWEEN_FRAME);if(m.isTween=!(void 0!=g&&"false"==g),n.flashToolVersion>=ccs.CONST_VERSION_2_0?((r=e.getAttribute(ccs.CONST_A_COCOS2DX_X))&&(m.x=parseFloat(r),m.x*=this._positionReadScale),(o=e.getAttribute(ccs.CONST_A_COCOS2DX_Y))&&(m.y=-parseFloat(o),m.y*=this._positionReadScale)):((r=e.getAttribute(ccs.CONST_A_X))&&(m.x=parseFloat(r),m.x*=this._positionReadScale),(o=e.getAttribute(ccs.CONST_A_Y))&&(m.y=-parseFloat(o),m.y*=this._positionReadScale)),null!=(s=e.getAttribute(ccs.CONST_A_SCALE_X))&&(m.scaleX=parseFloat(s)),null!=(a=e.getAttribute(ccs.CONST_A_SCALE_Y))&&(m.scaleY=parseFloat(a)),null!=(c=e.getAttribute(ccs.CONST_A_SKEW_X))&&(m.skewX=cc.degreesToRadians(parseFloat(c))),null!=(l=e.getAttribute(ccs.CONST_A_SKEW_Y))&&(m.skewY=cc.degreesToRadians(-parseFloat(l))),null!=(h=e.getAttribute(ccs.CONST_A_DURATION))&&(m.duration=parseFloat(h)),null!=(d=e.getAttribute(ccs.CONST_A_DISPLAY_INDEX))&&(m.displayIndex=parseFloat(d)),null!=(p=e.getAttribute(ccs.CONST_A_Z))&&(m.zOrder=parseInt(p)),null!=(u=e.getAttribute(ccs.CONST_A_TWEEN_ROTATE))&&(m.tweenRotate=parseFloat(u)),null!=(f=e.getAttribute(ccs.CONST_A_BLEND_TYPE))){var y=m.blendFunc;switch(f){case ccs.BLEND_TYPE_NORMAL:y.src=cc.BLEND_SRC,y.dst=cc.BLEND_DST;break;case ccs.BLEND_TYPE_ADD:y.src=cc.SRC_ALPHA,y.dst=cc.ONE;break;case ccs.BLEND_TYPE_MULTIPLY:y.src=cc.DST_COLOR,y.dst=cc.ONE_MINUS_SRC_ALPHA;break;case ccs.BLEND_TYPE_SCREEN:y.src=cc.ONE,y.dst=cc.ONE_MINUS_DST_COLOR;break;default:m.blendFunc.src=cc.BLEND_SRC,m.blendFunc.dst=cc.BLEND_DST}}var T=e.querySelectorAll(ccs.CONST_FRAME+" > "+ccs.CONST_A_COLOR_TRANSFORM);if(T&&T.length>0){T=T[0];var v,S,C,E,b,A,x,R;v=parseFloat(T.getAttribute(ccs.CONST_A_ALPHA))||0,S=parseFloat(T.getAttribute(ccs.CONST_A_RED))||0,C=parseFloat(T.getAttribute(ccs.CONST_A_GREEN))||0,E=parseFloat(T.getAttribute(ccs.CONST_A_BLUE))||0,b=parseFloat(T.getAttribute(ccs.CONST_A_ALPHA_OFFSET))||0,A=parseFloat(T.getAttribute(ccs.CONST_A_RED_OFFSET))||0,x=parseFloat(T.getAttribute(ccs.CONST_A_GREEN_OFFSET))||0,R=parseFloat(T.getAttribute(ccs.CONST_A_BLUE_OFFSET))||0,m.a=2.55*b+v,m.r=2.55*A+S,m.g=2.55*x+C,m.b=2.55*R+E,m.isUseColorInfo=!0}var P=e.getAttribute(ccs.CONST_A_TWEEN_EASING);if(null!=P&&(P!=ccs.CONST_FL_NAN?(_=e.getAttribute(ccs.CONST_A_TWEEN_EASING))&&(m.tweenEasing=2==_?ccs.TweenType.sineEaseInOut:_):m.tweenEasing=ccs.TweenType.linear),t){var I=new ccs.BaseData;n.flashToolVersion>=ccs.CONST_VERSION_2_0?(I.x=parseFloat(t.getAttribute(ccs.CONST_A_COCOS2DX_X)),I.y=parseFloat(t.getAttribute(ccs.CONST_A_COCOS2DX_Y))):(I.x=parseFloat(t.getAttribute(ccs.CONST_A_X)),I.y=parseFloat(t.getAttribute(ccs.CONST_A_Y))),I.skewX=parseFloat(t.getAttribute(ccs.CONST_A_SKEW_X)),I.skewY=parseFloat(t.getAttribute(ccs.CONST_A_SKEW_Y)),I.y=-I.y,I.skewX=cc.degreesToRadians(I.skewX),I.skewY=cc.degreesToRadians(-I.skewY),ccs.TransformHelp.transformFromParent(m,I)}return m},decodeFrameFromJson:function(e,t){var i=new ccs.FrameData;this.decodeNodeFromJson(i,e,t),i.tweenEasing=e[ccs.CONST_A_TWEEN_EASING]||ccs.TweenType.linear,i.displayIndex=e[ccs.CONST_A_DISPLAY_INDEX];var n=null==e[ccs.CONST_A_BLEND_SRC]?cc.BLEND_SRC:e[ccs.CONST_A_BLEND_SRC],r=null==e[ccs.CONST_A_BLEND_DST]?cc.BLEND_DST:e[ccs.CONST_A_BLEND_DST];i.blendFunc.src=n,i.blendFunc.dst=r,i.isTween=null==e[ccs.CONST_A_TWEEN_FRAME]||e[ccs.CONST_A_TWEEN_FRAME];var o=e[ccs.CONST_A_EVENT];null!=o&&(i.strEvent=o,i.event=o),t.cocoStudioVersion<ccs.CONST_VERSION_COMBINED?i.duration=null==e[ccs.CONST_A_DURATION]?1:e[ccs.CONST_A_DURATION]:i.frameID=e[ccs.CONST_A_FRAME_INDEX];for(var s=e[ccs.CONST_A_EASING_PARAM]||[],a=0;a<s.length;a++)i.easingParams[a]=s[a];return i},decodeTexture:function(e,t){var i=new ccs.TextureData;i.init(),e.getAttribute(ccs.CONST_A_NAME)&&(i.name=e.getAttribute(ccs.CONST_A_NAME));var n,r;t.flashToolVersion>=ccs.CONST_VERSION_2_0?(n=parseFloat(e.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_X))||0,r=parseFloat(e.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_Y))||0):(n=parseFloat(e.getAttribute(ccs.CONST_A_PIVOT_X))||0,r=parseFloat(e.getAttribute(ccs.CONST_A_PIVOT_Y))||0);var o=parseFloat(e.getAttribute(ccs.CONST_A_WIDTH))||0,s=parseFloat(e.getAttribute(ccs.CONST_A_HEIGHT))||0,a=n/o,c=(s-r)/s;i.pivotX=a,i.pivotY=c;for(var l=e.querySelectorAll(ccs.CONST_SUB_TEXTURE+" > "+ccs.CONST_CONTOUR),u=0;u<l.length;u++)i.addContourData(this.decodeContour(l[u],t));return i},decodeTextureFromJson:function(e){var t=new ccs.TextureData;t.init();var i=e[ccs.CONST_A_NAME];null!=i&&(t.name=i),t.width=e[ccs.CONST_A_WIDTH]||0,t.height=e[ccs.CONST_A_HEIGHT]||0,t.pivotX=e[ccs.CONST_A_PIVOT_X]||0,t.pivotY=e[ccs.CONST_A_PIVOT_Y]||0;for(var n=e[ccs.CONST_CONTOUR_DATA]||[],r=0;r<n.length;r++)t.contourDataList.push(this.decodeContourFromJson(n[r]));return t},decodeContour:function(e,t){var i=new ccs.ContourData;i.init();for(var n,r=e.querySelectorAll(ccs.CONST_CONTOUR+" > "+ccs.CONST_CONTOUR_VERTEX),o=0;o<r.length;o++){n=r[o];var s=cc.p(0,0);s.x=parseFloat(n.getAttribute(ccs.CONST_A_X))||0,s.y=parseFloat(n.getAttribute(ccs.CONST_A_Y))||0,s.y=-s.y,i.vertexList.push(s)}return i},decodeContourFromJson:function(e){var t=new ccs.ContourData;t.init();for(var i=e[ccs.CONST_VERTEX_POINT]||[],n=i.length,r=0;r<n;r++){var o=i[r],s=cc.p(0,0);s.x=o[ccs.CONST_A_X]||0,s.y=o[ccs.CONST_A_Y]||0,t.vertexList.push(s)}return t},addDataFromJsonCache:function(e,t){t.contentScale=null==e[ccs.CONST_CONTENT_SCALE]?1:e[ccs.CONST_CONTENT_SCALE];var i,n,r=e[ccs.CONST_ARMATURE_DATA]||[];for(i=0;i<r.length;i++)n=this.decodeArmatureFromJSON(r[i],t),ccs.armatureDataManager.addArmatureData(n.name,n,t.filename);var o,s=e[ccs.CONST_ANIMATION_DATA]||[];for(i=0;i<s.length;i++)o=this.decodeAnimationFromJson(s[i],t),ccs.armatureDataManager.addAnimationData(o.name,o,t.filename);var a,c=e[ccs.CONST_TEXTURE_DATA]||[];for(i=0;i<c.length;i++)a=this.decodeTextureFromJson(c[i],t),ccs.armatureDataManager.addTextureData(a.name,a,t.filename);if(null==t.asyncStruct?ccs.armatureDataManager.isAutoLoadSpriteFile():t.asyncStruct.autoLoadSpriteFile){var l,u,h,d,p=e[ccs.CONST_CONFIG_FILE_PATH]||[];for(i=0;i<p.length;i++)u=(l=p[i]).lastIndexOf("."),l=l.substring(0,u),h=t.basefilePath+l+".plist",d=t.basefilePath+l+".png",ccs.armatureDataManager.addSpriteFrameFromFile(h,d,t.filename)}n=null,o=null},decodeNodeFromJson:function(e,t,i){e.x=t[ccs.CONST_A_X]*this._positionReadScale,e.y=t[ccs.CONST_A_Y]*this._positionReadScale,e.x*=i.contentScale,e.y*=i.contentScale,e.zOrder=t[ccs.CONST_A_Z],e.skewX=t[ccs.CONST_A_SKEW_X]||0,e.skewY=t[ccs.CONST_A_SKEW_Y]||0,e.scaleX=null==t[ccs.CONST_A_SCALE_X]?1:t[ccs.CONST_A_SCALE_X],e.scaleY=null==t[ccs.CONST_A_SCALE_Y]?1:t[ccs.CONST_A_SCALE_Y];var n;i.cocoStudioVersion<ccs.VERSION_COLOR_READING?(n=t[0])&&(e.a=null==n[ccs.CONST_A_ALPHA]?255:n[ccs.CONST_A_ALPHA],e.r=null==n[ccs.CONST_A_RED]?255:n[ccs.CONST_A_RED],e.g=null==n[ccs.CONST_A_GREEN]?255:n[ccs.CONST_A_GREEN],e.b=null==n[ccs.CONST_A_BLUE]?255:n[ccs.CONST_A_BLUE],e.isUseColorInfo=!0):(n=t[ccs.CONST_COLOR_INFO]||null)&&(e.a=null==n[ccs.CONST_A_ALPHA]?255:n[ccs.CONST_A_ALPHA],e.r=null==n[ccs.CONST_A_RED]?255:n[ccs.CONST_A_RED],e.g=null==n[ccs.CONST_A_GREEN]?255:n[ccs.CONST_A_GREEN],e.b=null==n[ccs.CONST_A_BLUE]?255:n[ccs.CONST_A_BLUE],e.isUseColorInfo=!0)},clear:function(){this._configFileList=[],this._asyncRefCount=0,this._asyncRefTotalCount=0},_asyncCallBack:function(e,t,i){e&&cc.isFunction(e)&&e.call(t,i),t&&e&&"string"==typeof e&&t[e](i)},_initBaseFilePath:function(e){var t=e,i=t.lastIndexOf("/");return t=i>-1?t.substr(0,i+1):""},addDataFromXML:function(e,t){var i=cc.loader.getRes(e);if(!i)throw"Please load the resource first : "+e;var n=cc.saxParser.parse(i).documentElement;n&&this.addDataFromCache(n,t)},addDataFromJson:function(e,t){var i=cc.loader.getRes(e);this.addDataFromJsonCache(i,t)}},ccs.spriteFrameCacheHelper={_textureAtlasDic:{},_imagePaths:[],addSpriteFrameFromFile:function(e,t){cc.spriteFrameCache.addSpriteFrames(e,t)},getTextureAtlasWithTexture:function(e){return null},clear:function(){this._textureAtlasDic={},this._imagePaths=[]}},ccs.TransformHelp=ccs.TransformHelp||ccs.Class.extend({}),ccs.TransformHelp.helpMatrix1=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpMatrix2=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpPoint1=cc.p(0,0),ccs.TransformHelp.helpPoint2=cc.p(0,0),ccs.TransformHelp.helpParentNode={},ccs.TransformHelp.transformFromParent=function(e,t){this.nodeToMatrix(e,this.helpMatrix1),this.nodeToMatrix(t,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,e)},ccs.TransformHelp.transformToParent=function(e,t){this.nodeToMatrix(e,this.helpMatrix1),this.nodeToMatrix(t,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,e)},ccs.TransformHelp.transformFromParentWithoutScale=function(e,t){for(var i in t)this.helpParentNode[i]=t[i];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(e,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,e)},ccs.TransformHelp.transformToParentWithoutScale=function(e,t){for(var i in t)this.helpParentNode[i]=t[i];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(e,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,e)},ccs.TransformHelp.nodeToMatrix=function(e,t){if(e.skewX==-e.skewY){var i=Math.sin(e.skewX),n=Math.cos(e.skewX);t.a=e.scaleX*n,t.b=e.scaleX*-i,t.c=e.scaleY*i,t.d=e.scaleY*n}else t.a=e.scaleX*Math.cos(e.skewY),t.b=e.scaleX*Math.sin(e.skewY),t.c=e.scaleY*Math.sin(e.skewX),t.d=e.scaleY*Math.cos(e.skewX);t.tx=e.x,t.ty=e.y},ccs.TransformHelp.matrixToNode=function(e,t){this.helpPoint1.x=0,this.helpPoint1.y=1,this.helpPoint1=cc.pointApplyAffineTransform(this.helpPoint1,e),this.helpPoint1.x-=e.tx,this.helpPoint1.y-=e.ty,this.helpPoint2.x=1,this.helpPoint2.y=0,this.helpPoint2=cc.pointApplyAffineTransform(this.helpPoint2,e),this.helpPoint2.x-=e.tx,this.helpPoint2.y-=e.ty,t.skewX=-(Math.atan2(this.helpPoint1.y,this.helpPoint1.x)-1.5707964),t.skewY=Math.atan2(this.helpPoint2.y,this.helpPoint2.x),t.scaleX=Math.sqrt(e.a*e.a+e.b*e.b),t.scaleY=Math.sqrt(e.c*e.c+e.d*e.d),t.x=e.tx,t.y=e.ty},ccs.TransformHelp.nodeConcat=function(e,t){e.x+=t.x,e.y+=t.y,e.skewX+=t.skewX,e.skewY+=t.skewY,e.scaleX+=t.scaleX,e.scaleY+=t.scaleY},ccs.TransformHelp.nodeSub=function(e,t){e.x-=t.x,e.y-=t.y,e.skewX-=t.skewX,e.skewY-=t.skewY,e.scaleX-=t.scaleX,e.scaleY-=t.scaleY},ccs.TweenType={customEasing:-1,linear:0,sineEaseIn:1,sineEaseOut:2,sineEaseInOut:3,quadEaseIn:4,quadEaseOut:5,quadEaseInOut:6,cubicEaseIn:7,cubicEaseOut:8,cubicEaseInOut:9,quartEaseIn:10,quartEaseOut:11,quartEaseInOut:12,quintEaseIn:13,quintEaseOut:14,quintEaseInOut:15,expoEaseIn:16,expoEaseOut:17,expoEaseInOut:18,circEaseIn:19,eircEaseOut:20,circEaseInOut:21,elasticEaseIn:22,elasticEaseOut:23,elasticEaseInOut:24,backEaseIn:25,backEaseOut:26,backEaseInOut:27,bounceEaseIn:28,bounceEaseOut:29,bounceEaseInOut:30,tweenEasingMax:1e4},ccs.TweenFunction=ccs.TweenFunction||ccs.Class.extend({}),ccs.DOUBLE_PI=ccs.M_PI_X_2=2*Math.PI,ccs.HALF_PI=ccs.M_PI_2=Math.PI/2,ccs.M_PI=Math.PI,ccs.TweenFunction.tweenTo=function(e,t,i){var n=0;switch(t){case ccs.TweenType.customEasing:n=this.customEase(e,i);break;case ccs.TweenType.linear:n=this.linear(e);break;case ccs.TweenType.sineEaseIn:n=this.sineEaseIn(e);break;case ccs.TweenType.sineEaseOut:n=this.sineEaseOut(e);break;case ccs.TweenType.sineEaseInOut:n=this.sineEaseInOut(e);break;case ccs.TweenType.quadEaseIn:n=this.quadEaseIn(e);break;case ccs.TweenType.quadEaseOut:n=this.quadEaseOut(e);break;case ccs.TweenType.quadEaseInOut:n=this.quadEaseInOut(e);break;case ccs.TweenType.cubicEaseIn:n=this.cubicEaseIn(e);break;case ccs.TweenType.cubicEaseOut:n=this.cubicEaseOut(e);break;case ccs.TweenType.cubicEaseInOut:n=this.cubicEaseInOut(e);break;case ccs.TweenType.quartEaseIn:n=this.quartEaseIn(e);break;case ccs.TweenType.quartEaseOut:n=this.quartEaseOut(e);break;case ccs.TweenType.quartEaseInOut:n=this.quartEaseInOut(e);break;case ccs.TweenType.quintEaseIn:n=this.quintEaseIn(e);break;case ccs.TweenType.quintEaseOut:n=this.quintEaseOut(e);break;case ccs.TweenType.quintEaseInOut:n=this.quintEaseInOut(e);break;case ccs.TweenType.expoEaseIn:n=this.expoEaseIn(e);break;case ccs.TweenType.expoEaseOut:n=this.expoEaseOut(e);break;case ccs.TweenType.expoEaseInOut:n=this.expoEaseInOut(e);break;case ccs.TweenType.circEaseIn:n=this.circEaseIn(e);break;case ccs.TweenType.eircEaseOut:n=this.circEaseOut(e);break;case ccs.TweenType.circEaseInOut:n=this.circEaseInOut(e);break;case ccs.TweenType.elasticEaseIn:r=.3;null!=i&&i.length>0&&(r=i[0]),n=this.elasticEaseIn(e,r);break;case ccs.TweenType.elasticEaseOut:r=.3;null!=i&&i.length>0&&(r=i[0]),n=this.elasticEaseOut(e,r);break;case ccs.TweenType.elasticEaseInOut:var r=.3;null!=i&&i.length>0&&(r=i[0]),n=this.elasticEaseInOut(e,r);break;case ccs.TweenType.backEaseIn:n=this.backEaseIn(e);break;case ccs.TweenType.backEaseOut:n=this.backEaseOut(e);break;case ccs.TweenType.backEaseInOut:n=this.backEaseInOut(e);break;case ccs.TweenType.bounceEaseIn:n=this.bounceEaseIn(e);break;case ccs.TweenType.bounceEaseOut:n=this.bounceEaseOut(e);break;case ccs.TweenType.bounceEaseInOut:n=this.bounceEaseInOut(e);break;default:n=this.sineEaseInOut(e)}return n},ccs.TweenFunction.linear=function(e){return e},ccs.TweenFunction.sineEaseIn=function(e){return-1*Math.cos(e*ccs.HALF_PI)+1},ccs.TweenFunction.sineEaseOut=function(e){return Math.sin(e*ccs.HALF_PI)},ccs.TweenFunction.sineEaseInOut=function(e){return-.5*(Math.cos(ccs.M_PI*e)-1)},ccs.TweenFunction.quadEaseIn=function(e){return e*e},ccs.TweenFunction.quadEaseOut=function(e){return-1*e*(e-2)},ccs.TweenFunction.quadEaseInOut=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},ccs.TweenFunction.cubicEaseIn=function(e){return e*e*e},ccs.TweenFunction.cubicEaseOut=function(e){return(e-=1)*e*e+1},ccs.TweenFunction.cubicEaseInOut=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},ccs.TweenFunction.quartEaseIn=function(e){return e*e*e*e},ccs.TweenFunction.quartEaseOut=function(e){return-((e-=1)*e*e*e-1)},ccs.TweenFunction.quartEaseInOut=function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},ccs.TweenFunction.quintEaseIn=function(e){return e*e*e*e*e},ccs.TweenFunction.quintEaseOut=function(e){return(e-=1)*e*e*e*e+1},ccs.TweenFunction.quintEaseInOut=function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},ccs.TweenFunction.expoEaseIn=function(e){return 0==e?0:Math.pow(2,10*(e-1))-.001},ccs.TweenFunction.expoEaseOut=function(e){return 1==e?1:1-Math.pow(2,-10*e)},ccs.TweenFunction.expoEaseInOut=function(e){return e/=.5,e=e<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))},ccs.TweenFunction.circEaseIn=function(e){return-1*(Math.sqrt(1-e*e)-1)},ccs.TweenFunction.circEaseOut=function(e){return e-=1,Math.sqrt(1-e*e)},ccs.TweenFunction.circEaseInOut=function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):(e-=2,.5*(Math.sqrt(1-e*e)+1))},ccs.TweenFunction.elasticEaseIn=function(e,t){var i=.3;t.length>0&&(i=t[0]);var n=0;if(0==e||1==e)n=e;else{var r=i/4;e-=1,n=-Math.pow(2,10*e)*Math.sin((e-r)*ccs.DOUBLE_PI/i)}return n},ccs.TweenFunction.elasticEaseOut=function(e,t){var i=.3;t.length>0&&(i=t[0]);var n=0;if(0==e||1==e)n=e;else{var r=i/4;n=Math.pow(2,-10*e)*Math.sin((e-r)*ccs.DOUBLE_PI/i)+1}return n},ccs.TweenFunction.elasticEaseInOut=function(e,t){var i=.3;t.length>0&&(i=t[0]);var n=0;if(0==e||1==e)n=e;else{e*=2,i||(i=.3*1.5);var r=i/4;n=(e-=1)<0?-.5*Math.pow(2,10*e)*Math.sin((e-r)*ccs.DOUBLE_PI/i):Math.pow(2,-10*e)*Math.sin((e-r)*ccs.DOUBLE_PI/i)*.5+1}return n},ccs.TweenFunction.backEaseIn=function(e){return e*e*(2.70158*e-1.70158)},ccs.TweenFunction.backEaseOut=function(e){return(e-=1)*e*(2.70158*e+1.70158)+1},ccs.TweenFunction.backEaseInOut=function(e){return(e*=2)<1?e*e*(3.5949095*e-2.5949095)/2:(e-=2)*e*(3.5949095*e+2.5949095)/2+1},ccs.bounceTime=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},ccs.TweenFunction.bounceEaseIn=function(e){return 1-ccs.bounceTime(1-e)},ccs.TweenFunction.bounceEaseOut=function(e){return ccs.bounceTime(e)},ccs.TweenFunction.bounceEaseInOut=function(e){var t=0;return e<.5?(e*=2,t=.5*(1-ccs.bounceTime(1-e))):t=.5*ccs.bounceTime(2*e-1)+.5,t},ccs.TweenFunction.customEase=function(e,t){if(t.length>0){var i=1-e;return t[1]*i*i*i+3*t[3]*e*i*i+3*t[5]*e*e*i+t[7]*e*e*e}return e},ccs.TweenFunction.easeIn=function(e,t){return Math.pow(e,t)},ccs.TweenFunction.easeOut=function(e,t){return Math.pow(e,1/t)},ccs.TweenFunction.easeInOut=function(e,t){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.pow(2-e,t)},ccs.TweenFunction.quadraticIn=function(e){return Math.pow(e,2)},ccs.TweenFunction.quadraticOut=function(e){return-e*(e-2)},ccs.TweenFunction.bezieratFunction=function(e,t,i,n,r){return Math.pow(1-r,3)*e+3*r*Math.pow(1-r,2)*t+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n};var ENABLE_PHYSICS_DETECT=!1;ccs.fmodf=function(e,t){for(;e>t;)e-=t;return e};var CC_SAFE_RELEASE=function(e){e&&e.release&&e.release()};ccs.isSpriteContainPoint=function(e,t,i){var n=e.convertToNodeSpace(t);i&&(i.x=n.x,i.y=n.y);var r=e.getContentSize();return cc.rectContainsPoint(cc.rect(0,0,r.width,r.height),n)},ccs.SPRITE_CONTAIN_POINT=ccs.isSpriteContainPoint,ccs.SPRITE_CONTAIN_POINT_WITH_RETURN=ccs.isSpriteContainPoint,ccs.extBezierTo=function(e,t,i,n,r){var o=cc.p(0,0);return n&&!r&&(o.x=Math.pow(1-e,2)*t.x+2*e*(1-e)*i.x+Math.pow(e,2)*n.x,o.y=Math.pow(1-e,2)*t.y+2*e*(1-e)*i.y+Math.pow(e,2)*n.y),r&&(o.x=t.x*Math.pow(1-e,3)+3*e*i.x*Math.pow(1-e,2)+3*n.x*Math.pow(e,2)*(1-e)+r.x*Math.pow(e,3),o.y=t.y*Math.pow(1-e,3)+3*e*i.y*Math.pow(1-e,2)+3*n.y*Math.pow(e,2)*(1-e)+r.y*Math.pow(e,3)),o},ccs.extCircleTo=function(e,t,i,n,r){var o=cc.p(0,0);return o.x=t.x+i*Math.cos(n+r*e),o.y=t.y+i*Math.sin(n+r*e),o},ccs.RelativeData=function(){this.plistFiles=[],this.armatures=[],this.animations=[],this.textures=[]},ccs.armatureDataManager={_animationDatas:{},_armatureDatas:{},_textureDatas:{},_autoLoadSpriteFile:!1,_relativeDatas:{},s_sharedArmatureDataManager:null,removeArmatureFileInfo:function(e){var t=this.getRelativeData(e);if(t){var i,n;for(i=0;i<t.armatures.length;i++)n=t.armatures[i],this.removeArmatureData(n);for(i=0;i<t.animations.length;i++)n=t.animations[i],this.removeAnimationData(n);for(i=0;i<t.textures.length;i++)n=t.textures[i],this.removeTextureData(n);for(i=0;i<t.plistFiles.length;i++)n=t.plistFiles[i],cc.spriteFrameCache.removeSpriteFramesFromFile(n);delete this._relativeDatas[e],ccs.dataReaderHelper.removeConfigFile(e)}},addArmatureData:function(e,t,i){var n=this.getRelativeData(i);n&&n.armatures.push(e),this._armatureDatas[e]=t},getArmatureData:function(e){var t=null;return this._armatureDatas&&(t=this._armatureDatas[e]),t},removeArmatureData:function(e){this._armatureDatas[e]&&delete this._armatureDatas[e]},addAnimationData:function(e,t,i){var n=this.getRelativeData(i);n&&n.animations.push(e),this._animationDatas[e]=t},getAnimationData:function(e){var t=null;return this._animationDatas[e]&&(t=this._animationDatas[e]),t},removeAnimationData:function(e){this._animationDatas[e]&&delete this._animationDatas[e]},addTextureData:function(e,t,i){var n=this.getRelativeData(i);n&&n.textures.push(e),this._textureDatas[e]=t},getTextureData:function(e){var t=null;return this._textureDatas&&(t=this._textureDatas[e]),t},removeTextureData:function(e){this._textureDatas[e]&&delete this._textureDatas[e]},addArmatureFileInfo:function(){var e,t,i;switch(arguments.length){case 1:i=arguments[0],this.addRelativeData(i),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFile(i);break;case 3:e=arguments[0],t=arguments[1],i=arguments[2],this.addRelativeData(i),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFile(i),this.addSpriteFrameFromFile(t,e)}},addArmatureFileInfoAsync:function(){var e,t,i,n,r;switch(arguments.length){case 3:i=arguments[0],n=arguments[2],r=arguments[1],this.addRelativeData(i),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFileAsync("","",i,r,n);break;case 5:e=arguments[0],t=arguments[1],i=arguments[2],n=arguments[4],r=arguments[3],this.addRelativeData(i),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFileAsync(e,t,i,r,n),this.addSpriteFrameFromFile(t,e)}},addSpriteFrameFromFile:function(e,t,i){var n=this.getRelativeData(i);n&&n.plistFiles.push(e),ccs.spriteFrameCacheHelper.addSpriteFrameFromFile(e,t)},isAutoLoadSpriteFile:function(){return this._autoLoadSpriteFile},getArmatureDatas:function(){return this._armatureDatas},getAnimationDatas:function(){return this._animationDatas},getTextureDatas:function(){return this._textureDatas},addRelativeData:function(e){this._relativeDatas[e]||(this._relativeDatas[e]=new ccs.RelativeData)},getRelativeData:function(e){return this._relativeDatas[e]},clear:function(){this._animationDatas={},this._armatureDatas={},this._textureDatas={},ccs.spriteFrameCacheHelper.clear(),ccs.dataReaderHelper.clear()}},ccs.BLEND_TYPE_NORMAL=0,ccs.BLEND_TYPE_LAYER=1,ccs.BLEND_TYPE_DARKEN=2,ccs.BLEND_TYPE_MULTIPLY=3,ccs.BLEND_TYPE_LIGHTEN=4,ccs.BLEND_TYPE_SCREEN=5,ccs.BLEND_TYPE_OVERLAY=6,ccs.BLEND_TYPE_HIGHLIGHT=7,ccs.BLEND_TYPE_ADD=8,ccs.BLEND_TYPE_SUBTRACT=9,ccs.BLEND_TYPE_DIFFERENCE=10,ccs.BLEND_TYPE_INVERT=11,ccs.BLEND_TYPE_ALPHA=12,ccs.BLEND_TYPE_ERASE=13,ccs.DISPLAY_TYPE_SPRITE=0,ccs.DISPLAY_TYPE_ARMATURE=1,ccs.DISPLAY_TYPE_PARTICLE=2,ccs.DISPLAY_TYPE_MAX=3,ccs.BaseData=ccs.Class.extend({x:0,y:0,zOrder:0,skewX:0,skewY:0,scaleX:1,scaleY:1,tweenRotate:0,isUseColorInfo:!1,r:255,g:255,b:255,a:255,ctor:function(){this.x=0,this.y=0,this.zOrder=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1,this.tweenRotate=0,this.isUseColorInfo=!1,this.r=255,this.g=255,this.b=255,this.a=255},copy:function(e){this.x=e.x,this.y=e.y,this.zOrder=e.zOrder,this.scaleX=e.scaleX,this.scaleY=e.scaleY,this.skewX=e.skewX,this.skewY=e.skewY,this.tweenRotate=e.tweenRotate,this.isUseColorInfo=e.isUseColorInfo,this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a},setColor:function(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a},getColor:function(){return cc.color(this.r,this.g,this.b,this.a)},subtract:function(e,t,i){this.x=t.x-e.x,this.y=t.y-e.y,this.scaleX=t.scaleX-e.scaleX,this.scaleY=t.scaleY-e.scaleY,this.skewX=t.skewX-e.skewX,this.skewY=t.skewY-e.skewY,this.isUseColorInfo||e.isUseColorInfo||t.isUseColorInfo?(this.a=t.a-e.a,this.r=t.r-e.r,this.g=t.g-e.g,this.b=t.b-e.b,this.isUseColorInfo=!0):(this.a=this.r=this.g=this.b=0,this.isUseColorInfo=!1),i&&(this.skewX>ccs.M_PI&&(this.skewX-=ccs.DOUBLE_PI),this.skewX<-ccs.M_PI&&(this.skewX+=ccs.DOUBLE_PI),this.skewY>ccs.M_PI&&(this.skewY-=ccs.DOUBLE_PI),this.skewY<-ccs.M_PI&&(this.skewY+=ccs.DOUBLE_PI)),t.tweenRotate&&(this.skewX+=t.tweenRotate*ccs.PI*2,this.skewY-=t.tweenRotate*ccs.PI*2)}}),ccs.DisplayData=ccs.Class.extend({displayType:ccs.DISPLAY_TYPE_MAX,displayName:"",ctor:function(){this.displayType=ccs.DISPLAY_TYPE_MAX},changeDisplayToTexture:function(e){var t=e,i=t.lastIndexOf(".");return-1!=i&&(t=t.substring(0,i)),t},copy:function(e){this.displayName=e.displayName,this.displayType=e.displayType}}),ccs.SpriteDisplayData=ccs.DisplayData.extend({skinData:null,ctor:function(){this.skinData=new ccs.BaseData,this.displayType=ccs.DISPLAY_TYPE_SPRITE},copy:function(e){ccs.DisplayData.prototype.copy.call(this,e),this.skinData=e.skinData}}),ccs.ArmatureDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayName="",this.displayType=ccs.DISPLAY_TYPE_ARMATURE}}),ccs.ParticleDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayType=ccs.DISPLAY_TYPE_PARTICLE}}),ccs.BoneData=ccs.BaseData.extend({displayDataList:null,name:"",parentName:"",boneDataTransform:null,ctor:function(){this.displayDataList=[],this.name="",this.parentName="",this.boneDataTransform=null},init:function(){return this.displayDataList.length=0,!0},addDisplayData:function(e){this.displayDataList.push(e)},getDisplayData:function(e){return this.displayDataList[e]}}),ccs.ArmatureData=ccs.Class.extend({boneDataDic:null,name:"",dataVersion:.1,ctor:function(){this.boneDataDic={},this.name="",this.dataVersion=.1},init:function(){return!0},addBoneData:function(e){this.boneDataDic[e.name]=e},getBoneDataDic:function(){return this.boneDataDic},getBoneData:function(e){return this.boneDataDic[e]}}),ccs.FrameData=ccs.BaseData.extend({duration:0,tweenEasing:0,easingParamNumber:0,easingParams:null,displayIndex:-1,movement:"",event:"",sound:"",soundEffect:"",blendFunc:null,frameID:0,isTween:!0,ctor:function(){ccs.BaseData.prototype.ctor.call(this),this.duration=1,this.tweenEasing=ccs.TweenType.linear,this.easingParamNumber=0,this.easingParams=[],this.displayIndex=0,this.movement="",this.event="",this.sound="",this.soundEffect="",this.blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.frameID=0,this.isTween=!0},copy:function(e){if(ccs.BaseData.prototype.copy.call(this,e),this.duration=e.duration,this.displayIndex=e.displayIndex,this.tweenEasing=e.tweenEasing,this.easingParamNumber=e.easingParamNumber,0!=this.easingParamNumber){this.easingParams.length=0;for(var t=0;t<this.easingParamNumber;t++)this.easingParams[t]=e.easingParams[t]}this.blendFunc=e.blendFunc,this.isTween=e.isTween}}),ccs.MovementBoneData=ccs.Class.extend({delay:0,scale:1,duration:0,frameList:null,name:"",ctor:function(){this.delay=0,this.scale=1,this.duration=0,this.frameList=[],this.name=""},init:function(){return!0},addFrameData:function(e){this.frameList.push(e)},getFrameData:function(e){return this.frameList[e]}}),ccs.MovementData=function(){this.name="",this.duration=0,this.scale=1,this.durationTo=0,this.durationTween=0,this.loop=!0,this.tweenEasing=ccs.TweenType.linear,this.movBoneDataDic={}},ccs.MovementData.prototype.addMovementBoneData=function(e){this.movBoneDataDic[e.name]=e},ccs.MovementData.prototype.getMovementBoneData=function(e){return this.movBoneDataDic[e]},ccs.AnimationData=function(){this.movementDataDic={},this.movementNames=[],this.name=""},ccs.AnimationData.prototype.addMovement=function(e){this.movementDataDic[e.name]=e,this.movementNames.push(e.name)},ccs.AnimationData.prototype.getMovement=function(e){return this.movementDataDic[e]},ccs.AnimationData.prototype.getMovementCount=function(){return Object.keys(this.movementDataDic).length},ccs.ContourVertex2=function(e,t){this.x=e||0,this.y=t||0},ccs.ContourData=function(){this.vertexList=[]},ccs.ContourData.prototype.init=function(){return this.vertexList.length=0,!0},ccs.ContourData.prototype.addVertex=function(e){this.vertexList.push(e)},ccs.TextureData=function(){this.height=0,this.width=0,this.pivotX=.5,this.pivotY=.5,this.name="",this.contourDataList=[]},ccs.TextureData.prototype.init=function(){this.contourDataList.length=0},ccs.TextureData.prototype.addContourData=function(e){this.contourDataList.push(e)},ccs.TextureData.prototype.getContourData=function(e){return this.contourDataList[e]},ccs.DecorativeDisplay=ccs.Class.extend({_display:null,_colliderDetector:null,_displayData:null,ctor:function(){this._display=null,this._colliderDetector=null,this._displayData=null},init:function(){return!0},setDisplay:function(e){e._parent&&(e._parent.removeChild(e),delete e._parent),this._display=e},getDisplay:function(){return this._display},setColliderDetector:function(e){this._colliderDetector=e},getColliderDetector:function(){return this._colliderDetector},setDisplayData:function(e){this._displayData=e},getDisplayData:function(){return this._displayData},release:function(){this._display=null,this._displayData=null,this._colliderDetector=null}}),ccs.DecorativeDisplay.create=function(){return new ccs.DecorativeDisplay},ccs.displayFactory={addDisplay:function(e,t,i){switch(i.displayType){case ccs.DISPLAY_TYPE_SPRITE:this.addSpriteDisplay(e,t,i);break;case ccs.DISPLAY_TYPE_PARTICLE:this.addParticleDisplay(e,t,i);break;case ccs.DISPLAY_TYPE_ARMATURE:this.addArmatureDisplay(e,t,i)}},createDisplay:function(e,t){switch(t.getDisplayData().displayType){case ccs.DISPLAY_TYPE_SPRITE:this.createSpriteDisplay(e,t);break;case ccs.DISPLAY_TYPE_PARTICLE:this.createParticleDisplay(e,t);break;case ccs.DISPLAY_TYPE_ARMATURE:this.createArmatureDisplay(e,t)}},_helpTransform:{a:1,b:0,c:0,d:1,tx:0,ty:0},updateDisplay:function(e,t,i){var n=e.getDisplayRenderNode();if(n){switch(e.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:i&&n.updateArmatureTransform();break;case ccs.DISPLAY_TYPE_PARTICLE:this.updateParticleDisplay(e,n,t);break;case ccs.DISPLAY_TYPE_ARMATURE:this.updateArmatureDisplay(e,n,t);break;default:var r=e.getNodeToArmatureTransform();n.setAdditionalTransform(r)}if((ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&i){var o=e.getDisplayManager().getCurrentDecorativeDisplay(),s=o.getColliderDetector();if(s){var a=o.getDisplay(),c=a.getNodeToParentTransform(),l=this._helpTransform;l.a=c.a,l.b=c.b,l.c=c.c,l.d=c.d,l.tx=c.tx,l.ty=c.ty;var u=cc.pointApplyAffineTransform(a.getAnchorPointInPoints(),l);l.tx=u.x,l.ty=u.y;var h=cc.affineTransformConcat(l,e.getArmature().getNodeToParentTransform());s.updateTransform(h)}}}},addSpriteDisplay:function(e,t,i){var n=new ccs.SpriteDisplayData;n.copy(i),t.setDisplayData(n),this.createSpriteDisplay(e,t)},createSpriteDisplay:function(e,t){var i=null,n=t.getDisplayData(),r=n.displayName,o=r.lastIndexOf(".");if(-1!=o&&(r=r.substring(0,o)),i=""==r?new ccs.Skin:new ccs.Skin("#"+r+".png"),t.setDisplay(i),null!=i){i.setBone(e),this.initSpriteDisplay(e,t,n.displayName,i);var s=e.getArmature();s&&(s.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?i.setSkinData(n.skinData):i.setSkinData(e.boneData))}},initSpriteDisplay:function(e,t,i,n){var r=i,o=r.lastIndexOf(".");-1!=o&&(r=r.substring(0,o));var s=ccs.armatureDataManager.getTextureData(r);if(s&&n.setAnchorPoint(cc.p(s.pivotX,s.pivotY)),(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&s&&s.contourDataList.length>0){var a=new ccs.ColliderDetector(e);a.addContourDataList(s.contourDataList),t.setColliderDetector(a)}},addArmatureDisplay:function(e,t,i){var n=new ccs.ArmatureDisplayData;n.copy(i),t.setDisplayData(n),this.createArmatureDisplay(e,t)},createArmatureDisplay:function(e,t){var i=t.getDisplayData(),n=new ccs.Armature(i.displayName,e);t.setDisplay(n)},updateArmatureDisplay:function(e,t,i){t&&(t.sortAllChildren(),t.update(i))},addParticleDisplay:function(e,t,i){var n=new ccs.ParticleDisplayData;n.copy(i),t.setDisplayData(n),this.createParticleDisplay(e,t)},createParticleDisplay:function(e,t){var i=t.getDisplayData(),n=new cc.ParticleSystem(i.displayName);n.removeFromParent(),n.cleanup(),e.getArmature()&&n.setParent(e.getArmature()),t.setDisplay(n)},updateParticleDisplay:function(e,t,i){var n=new ccs.BaseData;ccs.TransformHelp.matrixToNode(e.nodeToArmatureTransform(),n),t.setPosition(n.x,n.y),t.setScaleX(n.scaleX),t.setScaleY(n.scaleY),t.update(i)}},ccs.DisplayManager=ccs.Class.extend({_decoDisplayList:null,_currentDecoDisplay:null,_displayRenderNode:null,_displayIndex:null,_forceChangeDisplay:!1,_bone:null,_visible:!0,_displayType:null,ctor:function(e){this._decoDisplayList=[],this._currentDecoDisplay=null,this._displayRenderNode=null,this._displayIndex=null,this._forceChangeDisplay=!1,this._bone=null,this._visible=!0,this._displayType=ccs.DISPLAY_TYPE_MAX,e&&ccs.DisplayManager.prototype.init.call(this,e)},init:function(e){return this._bone=e,this.initDisplayList(e.getBoneData()),!0},addDisplay:function(e,t){var i,n=this._decoDisplayList;if(t>=0&&t<n.length?i=n[t]:(i=new ccs.DecorativeDisplay,n.push(i)),e instanceof ccs.DisplayData)return cc.displayFactory.addDisplay(this._bone,i,e),void(t==this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(t,!1)));var r=null;if(e instanceof ccs.Skin){e.setBone(this._bone),r=new ccs.SpriteDisplayData,ccs.displayFactory.initSpriteDisplay(this._bone,i,e.getDisplayName(),e);var o=i.getDisplayData();if(o instanceof ccs.SpriteDisplayData)e.setSkinData(o.skinData),r.skinData=o.skinData;else{for(var s=!1,a=n.length-2;a>=0;a--){var c=n[a].getDisplayData();if(c instanceof ccs.SpriteDisplayData){s=!0,e.setSkinData(c.skinData),r.skinData=c.skinData;break}}s||e.setSkinData(new ccs.BaseData)}}else if(e instanceof cc.ParticleSystem){r=new ccs.ParticleDisplayData,e.removeFromParent(),e.cleanup();var l=this._bone.getArmature();l&&e.setParent(l)}else e instanceof ccs.Armature?((r=new ccs.ArmatureDisplayData).displayName=e.getName(),e.setParentBone(this._bone)):r=new ccs.DisplayData;i.setDisplay(e),i.setDisplayData(r),t==this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(t,!1))},_addDisplayOther:function(e,t){var i=null;if(t instanceof ccs.Skin){var n=t;n.setBone(this._bone),(i=new ccs.SpriteDisplayData).displayName=n.getDisplayName(),ccs.displayFactory.initSpriteDisplay(this._bone,e,n.getDisplayName(),n);var r=e.getDisplayData();if(r instanceof ccs.SpriteDisplayData)n.setSkinData(r.skinData);else{for(var o=!1,s=this._decoDisplayList.length-2;s>=0;s--){var a=this._decoDisplayList[s].getDisplayData();if(a){o=!0,n.setSkinData(a.skinData),i.skinData=a.skinData;break}}o||n.setSkinData(new ccs.BaseData),n.setSkinData(new ccs.BaseData)}}else t instanceof cc.ParticleSystem?(i=new ccs.ParticleDisplayData).displayName=t._plistFile:t instanceof ccs.Armature?((i=new ccs.ArmatureDisplayData).displayName=t.getName(),t.setParentBone(this._bone)):i=new ccs.DisplayData;e.setDisplay(t),e.setDisplayData(i)},removeDisplay:function(e){this._decoDisplayList.splice(e,1),e===this._displayIndex&&(this.setCurrentDecorativeDisplay(null),this._displayIndex=-1)},getDecorativeDisplayList:function(){return this._decoDisplayList},changeDisplayWithIndex:function(e,t){e>=this._decoDisplayList.length?cc.log("the index value is out of range"):(this._forceChangeDisplay=t,this._displayIndex!=e&&(this._displayIndex=e,e<0?this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this.setCurrentDecorativeDisplay(null)):this.setCurrentDecorativeDisplay(this._decoDisplayList[e])))},changeDisplayWithName:function(e,t){for(var i=this._decoDisplayList,n=0;n<i.length;n++)if(i[n].getDisplayData().displayName==e){this.changeDisplayWithIndex(n,t);break}},setCurrentDecorativeDisplay:function(e){var t=this._currentDecoDisplay;(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&t&&t.getColliderDetector()&&t.getColliderDetector().setActive(!1),this._currentDecoDisplay=e,t=this._currentDecoDisplay,(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&t&&t.getColliderDetector()&&t.getColliderDetector().setActive(!0);var i=t?t.getDisplay():null,n=this._displayRenderNode,r=this._bone;n&&(n instanceof ccs.Armature&&r.setChildArmature(null),n.removeFromParent(!0)),this._displayRenderNode=i,i?(i instanceof ccs.Armature?(this._bone.setChildArmature(i),i.setParentBone(this._bone)):i instanceof cc.ParticleSystem&&(i instanceof ccs.Armature?(r.setChildArmature(i),i.setParentBone(r)):i instanceof cc.ParticleSystem&&i.resetSystem()),i.setColor(r.getDisplayedColor()),i.setOpacity(r.getDisplayedOpacity()),this._displayRenderNode.setVisible(this._visible),this._displayType=this._currentDecoDisplay.getDisplayData().displayType):this._displayType=ccs.DISPLAY_TYPE_MAX,cc.renderer.childrenOrderDirty=!0},getDisplayRenderNode:function(){return this._displayRenderNode},getDisplayRenderNodeType:function(){return this._displayType},getCurrentDisplayIndex:function(){return this._displayIndex},getCurrentDecorativeDisplay:function(){return this._currentDecoDisplay},getDecorativeDisplayByIndex:function(e){return this._decoDisplayList[e]},initDisplayList:function(e){if(this._decoDisplayList.length=0,e)for(var t=e.displayDataList,i=this._decoDisplayList,n=this._bone,r=0;r<t.length;r++){var o=t[r],s=new ccs.DecorativeDisplay;s.setDisplayData(o),ccs.displayFactory.createDisplay(n,s),i.push(s)}},containPoint:function(e,t){if(!this._visible||this._displayIndex<0)return!1;if(void 0!==t&&(e=cc.p(e,t)),this._currentDecoDisplay.getDisplayData().displayType==ccs.DISPLAY_TYPE_SPRITE){var i=this._currentDecoDisplay.getDisplay();return i=i.getChildByTag(0),ccs.SPRITE_CONTAIN_POINT_WITH_RETURN(i,e)}return!1},setVisible:function(e){this._displayRenderNode&&(this._visible=e,this._displayRenderNode.setVisible(e))},isVisible:function(){return this._visible},getContentSize:function(){return this._displayRenderNode?this._displayRenderNode.getContentSize():cc.size(0,0)},getBoundingBox:function(){return this._displayRenderNode?this._displayRenderNode.getBoundingBox():cc.rect(0,0,0,0)},getAnchorPoint:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPoint():cc.p(0,0)},getAnchorPointInPoints:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPointInPoints():cc.p(0,0)},getForceChangeDisplay:function(){return this._forceChangeDisplay},release:function(){this._decoDisplayList=null,this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this._displayRenderNode=null)}}),ccs.DisplayManager.create=function(e){return new ccs.DisplayManager(e)},ccs.Skin=ccs.Sprite.extend({_skinData:null,bone:null,_skinTransform:null,_displayName:"",_armature:null,_className:"Skin",ctor:function(e,t){cc.Sprite.prototype.ctor.call(this),this._skinData=null,this.bone=null,this._displayName="",this._skinTransform=cc.affineTransformIdentity(),this._armature=null,null==e||""==e?ccs.Skin.prototype.init.call(this):"#"==e[0]?ccs.Skin.prototype.initWithSpriteFrameName.call(this,e.substr(1)):ccs.Skin.prototype.initWithFile.call(this,e,t)},initWithSpriteFrameName:function(e){if(""==e)return!1;var t=cc.spriteFrameCache.getSpriteFrame(e),i=!0;return t?this.initWithSpriteFrame(t):(cc.log("Can't find CCSpriteFrame with %s. Please check your .plist file",e),i=!1),this._displayName=e,i},initWithFile:function(e,t){var i=t?cc.Sprite.prototype.initWithFile.call(this,e,t):cc.Sprite.prototype.initWithFile.call(this,e);return this._displayName=e,i},setSkinData:function(e){this._skinData=e,this.setScaleX(e.scaleX),this.setScaleY(e.scaleY),this.setRotationX(cc.radiansToDegrees(e.skewX)),this.setRotationY(cc.radiansToDegrees(-e.skewY)),this.setPosition(e.x,e.y);var t=this.getNodeToParentTransform?this.getNodeToParentTransform():this.nodeToParentTransform(),i=this._skinTransform;i.a=t.a,i.b=t.b,i.c=t.c,i.d=t.d,i.tx=t.tx,i.ty=t.ty,this.updateArmatureTransform()},getSkinData:function(){return this._skinData},updateArmatureTransform:function(){this._renderCmd.updateArmatureTransform()},getNodeToWorldTransform:function(){return this._renderCmd.getNodeToWorldTransform()},getNodeToWorldTransformAR:function(){return this._renderCmd.getNodeToWorldTransformAR()},setBone:function(e){this.bone=e;var t=this.bone.getArmature();t&&(this._armature=t)},getBone:function(){return this.bone},getDisplayName:function(){return this._displayName},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new ccs.Skin.CanvasRenderCmd(this):new ccs.Skin.WebGLRenderCmd(this)}}),(_p=ccs.Skin.prototype).skinData,cc.defineGetterSetter(_p,"skinData",_p.getSkinData,_p.setSkinData),_p.displayName,cc.defineGetterSetter(_p,"displayName",_p.getDisplayName),_p=null,ccs.Skin.create=function(e,t){return new ccs.Skin(e,t)},ccs.Skin.createWithSpriteFrameName=function(e){return new ccs.Skin("#"+e)},function(){ccs.Skin.RenderCmd={updateArmatureTransform:function(){var e=this._node;this._transform=cc.affineTransformConcat(e._skinTransform,e.bone.getNodeToArmatureTransform()),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._transform,this._node.bone.getArmature().getNodeToWorldTransform())},getNodeToWorldTransformAR:function(){var e=this._transform,t=this._node;return this._anchorPointInPoints=cc.pointApplyAffineTransform(this._anchorPointInPoints,e),e.tx=this._anchorPointInPoints.x,e.ty=this._anchorPointInPoints.y,cc.affineTransformConcat(e,t.bone.getArmature().getNodeToWorldTransform())}},ccs.Skin.CanvasRenderCmd=function(e){cc.Sprite.CanvasRenderCmd.call(this,e),this._needDraw=!0};var e=ccs.Skin.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(ccs.Skin.RenderCmd,e),e.constructor=ccs.Skin.CanvasRenderCmd}(),function(){ccs.Skin.WebGLRenderCmd=function(e){cc.Sprite.WebGLRenderCmd.call(this,e)};var e=ccs.Skin.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);cc.inject(ccs.Skin.RenderCmd,e),e.constructor=ccs.Skin.WebGLRenderCmd,e.updateTransform=function(){var e=this._node,t=this._quad;if(e._visible){var i=this.getNodeToParentTransform(),n=e._rect,r=e._offsetPosition.x,o=e._offsetPosition.y,s=r+n.width,a=o+n.height,c=i.tx,l=i.ty,u=i.a,h=i.b,d=i.d,p=-i.c,_=r*u-o*p+c,f=r*h+o*d+l,m=s*u-o*p+c,g=s*h+o*d+l,y=s*u-a*p+c,T=s*h+a*d+l,v=r*u-a*p+c,S=r*h+a*d+l,C=e._vertexZ;cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(_|=0,f|=0,m|=0,g|=0,y|=0,T|=0,v|=0,S|=0),this.SET_VERTEX3F(t.bl.vertices,_,f,C),this.SET_VERTEX3F(t.br.vertices,m,g,C),this.SET_VERTEX3F(t.tl.vertices,v,S,C),this.SET_VERTEX3F(t.tr.vertices,y,T,C)}else t.br.vertices=t.tl.vertices=t.tr.vertices=t.bl.vertices={x:0,y:0,z:0};e.textureAtlas&&e.textureAtlas.updateQuad(t,e.textureAtlas.getTotalQuads()),this._quadDirty=!0},e.SET_VERTEX3F=function(e,t,i,n){e.x=t,e.y=i,e.z=n},e.rendering=function(e){var t=this._node;if(t._textureLoaded){var i=e||cc._renderContext,n=t._texture;if(n&&n._textureLoaded&&(this._shaderProgram.use(),this._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4(),cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),cc.glBindTexture2DN(0,n),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),i.bindBuffer(i.ARRAY_BUFFER,this._quadWebBuffer),this._quadDirty&&(i.bufferData(i.ARRAY_BUFFER,this._quad.arrayBuffer,i.DYNAMIC_DRAW),this._quadDirty=!1),i.vertexAttribPointer(0,3,i.FLOAT,!1,24,0),i.vertexAttribPointer(1,4,i.UNSIGNED_BYTE,!0,24,12),i.vertexAttribPointer(2,2,i.FLOAT,!1,24,16),i.drawArrays(i.TRIANGLE_STRIP,0,4)),cc.g_NumberOfDraws++,0!==cc.SPRITE_DEBUG_DRAW||t._showNode)if(1===cc.SPRITE_DEBUG_DRAW||t._showNode){var r=this._quad,o=[cc.p(r.tl.vertices.x,r.tl.vertices.y),cc.p(r.bl.vertices.x,r.bl.vertices.y),cc.p(r.br.vertices.x,r.br.vertices.y),cc.p(r.tr.vertices.x,r.tr.vertices.y)];cc._drawingUtil.drawPoly(o,4,!0)}else if(2===cc.SPRITE_DEBUG_DRAW){var s=t.getTextureRect(),a=t.getOffsetPosition(),c=[cc.p(a.x,a.y),cc.p(a.x+s.width,a.y),cc.p(a.x+s.width,a.y+s.height),cc.p(a.x,a.y+s.height)];cc._drawingUtil.drawPoly(c,4,!0)}}}}(),ccs.ANIMATION_TYPE_SINGLE_FRAME=-4,ccs.ANIMATION_TYPE_NO_LOOP=-3,ccs.ANIMATION_TYPE_TO_LOOP_FRONT=-2,ccs.ANIMATION_TYPE_TO_LOOP_BACK=-1,ccs.ANIMATION_TYPE_LOOP_FRONT=0,ccs.ANIMATION_TYPE_LOOP_BACK=1,ccs.ANIMATION_TYPE_MAX=2,ccs.ProcessBase=ccs.Class.extend({_processScale:1,_isComplete:!0,_isPause:!0,_isPlaying:!1,_currentPercent:0,_rawDuration:0,_loopType:0,_tweenEasing:0,animationInternal:null,_currentFrame:0,_durationTween:0,_nextFrameIndex:0,_curFrameIndex:null,_isLoopBack:!1,ctor:function(){this._processScale=1,this._isComplete=!0,this._isPause=!0,this._isPlaying=!1,this._currentFrame=0,this._currentPercent=0,this._durationTween=0,this._rawDuration=0,this._loopType=ccs.ANIMATION_TYPE_LOOP_BACK,this._tweenEasing=ccs.TweenType.linear,this.animationInternal=1/60,this._curFrameIndex=0,this._durationTween=0,this._isLoopBack=!1},pause:function(){this._isPause=!0,this._isPlaying=!1},resume:function(){this._isPause=!1,this._isPlaying=!0},stop:function(){this._isComplete=!0,this._isPlaying=!1},play:function(e,t,i,n){this._isComplete=!1,this._isPause=!1,this._isPlaying=!0,this._currentFrame=0,this._nextFrameIndex=e,this._tweenEasing=n},update:function(e){if(!this._isComplete&&!this._isPause&&!(this._rawDuration<=0||e>1)){var t=void 0===this._nextFrameIndex?0:this._nextFrameIndex,i=this._currentFrame;t<=0?(this._currentPercent=1,i=0):(i+=this._processScale*(e/this.animationInternal),this._currentPercent=i/t,i=ccs.fmodf(i,t)),this._currentFrame=i,this.updateHandler()}},gotoFrame:function(e){var t=this._loopType;t==ccs.ANIMATION_TYPE_NO_LOOP?t=ccs.ANIMATION_TYPE_MAX:t==ccs.ANIMATION_TYPE_TO_LOOP_FRONT&&(t=ccs.ANIMATION_TYPE_LOOP_FRONT),this._loopType=t,this._curFrameIndex=e,this._nextFrameIndex=this._durationTween},getCurrentFrameIndex:function(){return this._curFrameIndex=(this._rawDuration-1)*this._currentPercent,this._curFrameIndex},updateHandler:function(){},isPause:function(){return this._isPause},isComplete:function(){return this._isComplete},getCurrentPercent:function(){return this._currentPercent},getRawDuration:function(){return this._rawDuration},getLoop:function(){return this._loopType},getTweenEasing:function(){return this._tweenEasing},getAnimationInternal:function(){return this.animationInternal},setAnimationInternal:function(e){this.animationInternal=e},getProcessScale:function(){return this._processScale},setProcessScale:function(e){this._processScale=e},isPlaying:function(){return this._isPlaying}}),(_p=ccs.ProcessBase.prototype).currentFrameIndex,cc.defineGetterSetter(_p,"currentFrameIndex",_p.getCurrentFrameIndex),_p.paused,cc.defineGetterSetter(_p,"paused",_p.isPause),_p.completed,cc.defineGetterSetter(_p,"completed",_p.isComplete),_p.currentPercent,cc.defineGetterSetter(_p,"currentPercent",_p.getCurrentPercent),_p.rawDuration,cc.defineGetterSetter(_p,"rawDuration",_p.getRawDuration),_p.loop,cc.defineGetterSetter(_p,"loop",_p.getLoop),_p.tweenEasing,cc.defineGetterSetter(_p,"tweenEasing",_p.getTweenEasing),_p.playing,cc.defineGetterSetter(_p,"playing",_p.isPlaying),_p=null,ccs.MovementEventType={start:0,complete:1,loopComplete:2},ccs.AnimationEvent=ccs.Class.extend({_arguments:null,_callFunc:null,_selectorTarget:null,ctor:function(e,t,i){this._data=i,this._callFunc=e,this._selectorTarget=t},call:function(){this._callFunc&&this._callFunc.apply(this._selectorTarget,this._arguments)},setArguments:function(e){this._arguments=e}}),ccs.MovementEvent=function(){this.armature=null,this.movementType=ccs.MovementEventType.start,this.movementID=""},ccs.FrameEvent=function(){this.bone=null,this.frameEventName="",this.originFrameIndex=0,this.currentFrameIndex=0},ccs.ArmatureAnimation=ccs.ProcessBase.extend({_animationData:null,_movementData:null,_armature:null,_movementID:"",_toIndex:0,_tweenList:null,_speedScale:1,_ignoreFrameEvent:!1,_frameEventQueue:null,_movementEventQueue:null,_movementList:null,_onMovementList:!1,_movementListLoop:!1,_movementIndex:0,_movementListDurationTo:-1,_movementEventCallFunc:null,_frameEventCallFunc:null,_movementEventTarget:null,_frameEventTarget:null,_movementEventListener:null,_frameEventListener:null,ctor:function(e){ccs.ProcessBase.prototype.ctor.call(this),this._tweenList=[],this._movementList=[],this._frameEventQueue=[],this._movementEventQueue=[],this._armature=null,e&&ccs.ArmatureAnimation.prototype.init.call(this,e)},init:function(e){return this._armature=e,this._tweenList.length=0,!0},pause:function(){for(var e=this._tweenList,t=0;t<e.length;t++)e[t].pause();ccs.ProcessBase.prototype.pause.call(this)},resume:function(){for(var e=this._tweenList,t=0;t<e.length;t++)e[t].resume();ccs.ProcessBase.prototype.resume.call(this)},stop:function(){for(var e=this._tweenList,t=0;t<e.length;t++)e[t].stop();e.length=0,ccs.ProcessBase.prototype.stop.call(this)},setAnimationScale:function(e){this.setSpeedScale(e)},getAnimationScale:function(){return this.getSpeedScale()},setSpeedScale:function(e){if(e!=this._speedScale){this._speedScale=e,this._processScale=this._movementData?this._speedScale*this._movementData.scale:this._speedScale;var t=this._armature.getBoneDic();for(var i in t){var n=t[i];n.getTween().setProcessScale(this._processScale),n.getChildArmature()&&n.getChildArmature().getAnimation().setSpeedScale(this._processScale)}}},getSpeedScale:function(){return this._speedScale},play:function(e,t,i){cc.assert(this._animationData,"this.animationData can not be null"),this._movementData=this._animationData.getMovement(e),cc.assert(this._movementData,"this._movementData can not be null"),t=void 0===t?-1:t,i=void 0===i?-1:i,this._rawDuration=this._movementData.duration,this._movementID=e,this._processScale=this._speedScale*this._movementData.scale,t=-1==t?this._movementData.durationTo:t;var n=0==this._movementData.durationTween?this._rawDuration:this._movementData.durationTween,r=this._movementData.tweenEasing;i=i<0?this._movementData.loop:i,this._onMovementList=!1,ccs.ProcessBase.prototype.play.call(this,t,n,i,r),0==this._rawDuration?this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME:(this._loopType=i?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._durationTween=n),this._tweenList.length=0;var o,s=this._armature.getBoneDic();for(var a in s){var c=s[a];o=this._movementData.movBoneDataDic[c.getName()];var l=c.getTween();o&&o.frameList.length>0?(this._tweenList.push(l),o.duration=this._movementData.duration,l.play(o,t,n,i,r),l.setProcessScale(this._processScale),c.getChildArmature()&&c.getChildArmature().getAnimation().setSpeedScale(this._processScale)):c.isIgnoreMovementBoneData()||(c.getDisplayManager().changeDisplayWithIndex(-1,!1),l.stop())}this._armature.update(0)},playByIndex:function(e,t,i,n,r){cc.log("playByIndex is deprecated. Use playWithIndex instead."),this.playWithIndex(e,t,n)},playWithIndex:function(e,t,i){var n=this._animationData.movementNames;cc.assert(e>-1&&e<n.length);var r=n[e];this.play(r,t,i)},playWithNames:function(e,t,i){t=void 0===t?-1:t,i=void 0===i||i,this._movementListLoop=i,this._movementListDurationTo=t,this._onMovementList=!0,this._movementIndex=0,e instanceof Array?this._movementList=e:this._movementList.length=0,this.updateMovementList()},playWithIndexes:function(e,t,i){t=void 0===t?-1:t,i=void 0===i||i,this._movementList.length=0,this._movementListLoop=i,this._movementListDurationTo=t,this._onMovementList=!0,this._movementIndex=0;for(var n=this._animationData.movementNames,r=0;r<e.length;r++){var o=n[e[r]];this._movementList.push(o)}this.updateMovementList()},gotoAndPlay:function(e){if(!this._movementData||e<0||e>=this._movementData.duration)cc.log("Please ensure you have played a movement, and the frameIndex is in the range.");else{var t=this._ignoreFrameEvent;this._ignoreFrameEvent=!0,this._isPlaying=!0,this._isComplete=this._isPause=!1,ccs.ProcessBase.prototype.gotoFrame.call(this,e),this._currentPercent=this._curFrameIndex/(this._movementData.duration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent;for(var i=this._tweenList,n=0;n<i.length;n++)i[n].gotoAndPlay(e);this._armature.update(0),this._ignoreFrameEvent=t}},gotoAndPause:function(e){this.gotoAndPlay(e),this.pause()},getMovementCount:function(){return this._animationData.getMovementCount()},update:function(e){ccs.ProcessBase.prototype.update.call(this,e);for(var t=this._tweenList,i=0;i<t.length;i++)t[i].update(e);for(var n,r=this._frameEventQueue;r.length>0;)n=r.shift(),this._ignoreFrameEvent=!0,this._frameEventCallFunc&&this._frameEventCallFunc.call(this._frameEventTarget,n.bone,n.frameEventName,n.originFrameIndex,n.currentFrameIndex),this._frameEventListener&&this._frameEventListener(n.bone,n.frameEventName,n.originFrameIndex,n.currentFrameIndex),this._ignoreFrameEvent=!1;for(var o=this._movementEventQueue;o.length>0;)n=o.shift(),this._movementEventCallFunc&&this._movementEventCallFunc.call(this._movementEventTarget,n.armature,n.movementType,n.movementID),this._movementEventListener&&this._movementEventListener(n.armature,n.movementType,n.movementID)},updateHandler:function(){var e=this._currentPercent;if(e>=1){switch(this._loopType){case ccs.ANIMATION_TYPE_NO_LOOP:if(this._loopType=ccs.ANIMATION_TYPE_MAX,this._currentFrame=(e-1)*this._nextFrameIndex,(e=this._currentFrame/this._durationTween)<1){this._nextFrameIndex=this._durationTween,this.movementEvent(this._armature,ccs.MovementEventType.start,this._movementID);break}break;case ccs.ANIMATION_TYPE_MAX:case ccs.ANIMATION_TYPE_SINGLE_FRAME:e=1,this._isComplete=!0,this._isPlaying=!1,this.movementEvent(this._armature,ccs.MovementEventType.complete,this._movementID),this.updateMovementList();break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:this._loopType=ccs.ANIMATION_TYPE_LOOP_FRONT,e=ccs.fmodf(e,1),this._currentFrame=0==this._nextFrameIndex?0:ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._nextFrameIndex=this._durationTween>0?this._durationTween:1,this.movementEvent(this,ccs.MovementEventType.start,this._movementID);break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._toIndex=0,this.movementEvent(this._armature,ccs.MovementEventType.loopComplete,this._movementID)}this._currentPercent=e}},getCurrentMovementID:function(){return this._isComplete?"":this._movementID},setMovementEventCallFunc:function(e,t){1==arguments.length?this._movementEventListener=e:2==arguments.length&&(this._movementEventTarget=t,this._movementEventCallFunc=e)},setFrameEventCallFunc:function(e,t){1==arguments.length?this._frameEventListener=e:2==arguments.length&&(this._frameEventTarget=t,this._frameEventCallFunc=e)},setUserObject:function(e){this._userObject=e},frameEvent:function(e,t,i,n){if(this._frameEventTarget&&this._frameEventCallFunc||this._frameEventListener){var r=new ccs.FrameEvent;r.bone=e,r.frameEventName=t,r.originFrameIndex=i,r.currentFrameIndex=n,this._frameEventQueue.push(r)}},movementEvent:function(e,t,i){if(this._movementEventTarget&&this._movementEventCallFunc||this._movementEventListener){var n=new ccs.MovementEvent;n.armature=e,n.movementType=t,n.movementID=i,this._movementEventQueue.push(n)}},updateMovementList:function(){if(this._onMovementList){var e,t=this._movementList;this._movementListLoop?(e=t[this._movementIndex],this.play(e,e.durationTo,0),++this._movementIndex>=t.length&&(this._movementIndex=0)):this._movementIndex<t.length?(e=t[this._movementIndex],this.play(e,e.durationTo,0),this._movementIndex++):this._onMovementList=!1,this._onMovementList=!0}},setAnimationData:function(e){this._animationData!=e&&(this._animationData=e)},getAnimationData:function(){return this._animationData},getUserObject:function(){return this._userObject},isIgnoreFrameEvent:function(){return this._ignoreFrameEvent}}),(_p=ccs.ArmatureAnimation.prototype).speedScale,cc.defineGetterSetter(_p,"speedScale",_p.getSpeedScale,_p.setSpeedScale),_p.animationScale,cc.defineGetterSetter(_p,"animationScale",_p.getAnimationScale,_p.setAnimationScale),_p=null,ccs.ArmatureAnimation.create=function(e){return new ccs.ArmatureAnimation(e)},ccs.Tween=ccs.ProcessBase.extend({_tweenData:null,_to:null,_from:null,_between:null,_movementBoneData:null,_bone:null,_frameTweenEasing:0,_betweenDuration:0,_totalDuration:0,_toIndex:0,_fromIndex:0,_animation:null,_passLastFrame:!1,ctor:function(e){ccs.ProcessBase.prototype.ctor.call(this),this._frameTweenEasing=ccs.TweenType.linear,ccs.Tween.prototype.init.call(this,e)},init:function(e){return this._from=new ccs.FrameData,this._between=new ccs.FrameData,this._bone=e,this._tweenData=this._bone.getTweenData(),this._tweenData.displayIndex=-1,this._animation=null!=this._bone&&null!=this._bone.getArmature()?this._bone.getArmature().getAnimation():null,!0},play:function(e,t,i,n,r){ccs.ProcessBase.prototype.play.call(this,t,i,n,r),this._loopType=n?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;var o=e!=this._movementBoneData;this.setMovementBoneData(e),this._rawDuration=this._movementBoneData.duration;var s=this._movementBoneData.getFrameData(0);this._tweenData.displayIndex=s.displayIndex,this._bone.getArmature().getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeSub(this._tweenData,this._bone.getBoneData()),this._tweenData.scaleX+=1,this._tweenData.scaleY+=1),0==this._rawDuration?(this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME,0==t?this.setBetween(s,s):this.setBetween(this._tweenData,s),this._frameTweenEasing=ccs.TweenType.linear):this._movementBoneData.frameList.length>1&&(this._durationTween=i*this._movementBoneData.scale,n&&0!=this._movementBoneData.delay?this.setBetween(this._tweenData,this.tweenNodeTo(this.updateFrameData(1-this._movementBoneData.delay),this._between)):o&&0!=t?this.setBetween(this._tweenData,s):this.setBetween(s,s)),this.tweenNodeTo(0)},gotoAndPlay:function(e){ccs.ProcessBase.prototype.gotoFrame.call(this,e),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0,this._isPlaying=!0,this._isComplete=this._isPause=!1,this._currentPercent=this._curFrameIndex/(this._rawDuration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent},gotoAndPause:function(e){this.gotoAndPlay(e),this.pause()},updateHandler:function(){var e=null==this._currentPercent?1:this._currentPercent,t=this._loopType;if(e>=1)switch(t){case ccs.ANIMATION_TYPE_SINGLE_FRAME:e=1,this._isComplete=!0,this._isPlaying=!1;break;case ccs.ANIMATION_TYPE_NO_LOOP:if(t=ccs.ANIMATION_TYPE_MAX,(e=this._durationTween<=0?1:(e-1)*this._nextFrameIndex/this._durationTween)>=1){e=1,this._isComplete=!0,this._isPlaying=!1;break}this._nextFrameIndex=this._durationTween,this._currentFrame=e*this._nextFrameIndex,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:t=ccs.ANIMATION_TYPE_LOOP_FRONT,this._nextFrameIndex=this._durationTween>0?this._durationTween:1,0!=this._movementBoneData.delay?(this._currentFrame=(1-this._movementBoneData.delay)*this._nextFrameIndex,e=this._currentFrame/this._nextFrameIndex):(e=0,this._currentFrame=0),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_MAX:e=1,this._isComplete=!0,this._isPlaying=!1;break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex)}e<1&&t<ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(e=Math.sin(e*cc.PI/2)),this._currentPercent=e,this._loopType=t,t>ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(e=this.updateFrameData(e)),this._frameTweenEasing!=ccs.TweenType.tweenEasingMax&&this.tweenNodeTo(e)},setBetween:function(e,t,i){void 0===i&&(i=!0);do{if(e.displayIndex<0&&t.displayIndex>=0){this._from.copy(t),this._between.subtract(t,t,i);break}if(t.displayIndex<0&&e.displayIndex>=0){this._from.copy(e),this._between.subtract(t,t,i);break}this._from.copy(e),this._between.subtract(e,t,i)}while(0);e.isTween||(this._tweenData.copy(e),this._tweenData.isTween=!0),this.arriveKeyFrame(e)},arriveKeyFrame:function(e){if(e){var t=this._bone,i=t.getDisplayManager(),n=e.displayIndex;i.getForceChangeDisplay()||i.changeDisplayWithIndex(n,!1),this._tweenData.zOrder=e.zOrder,t.updateZOrder(),this._bone.setBlendFunc(e.blendFunc);var r=t.getChildArmature();r&&""!=e.movement&&r.getAnimation().play(e.movement)}},tweenNodeTo:function(e,t){t||(t=this._tweenData);var i=this._from,n=this._between;return i.isTween||(e=0),t.x=i.x+e*n.x,t.y=i.y+e*n.y,t.scaleX=i.scaleX+e*n.scaleX,t.scaleY=i.scaleY+e*n.scaleY,t.skewX=i.skewX+e*n.skewX,t.skewY=i.skewY+e*n.skewY,this._bone.setTransformDirty(!0),t&&n.isUseColorInfo&&this.tweenColorTo(e,t),t},tweenColorTo:function(e,t){var i=this._from,n=this._between;t.a=i.a+e*n.a,t.r=i.r+e*n.r,t.g=i.g+e*n.g,t.b=i.b+e*n.b,this._bone.updateColor()},updateFrameData:function(e){e>1&&0!=this._movementBoneData.delay&&(e=ccs.fmodf(e,1));var t,i,n=(this._rawDuration-1)*e,r=this._totalDuration,o=this._betweenDuration,s=this._toIndex;if(n<r||n>=r+o){var a=this._movementBoneData.frameList,c=a.length;if(n<a[0].frameID)return t=i=a[0],this.setBetween(t,i),this._currentPercent;if(n>=a[c-1].frameID){if(this._passLastFrame)return t=i=a[c-1],this.setBetween(t,i),this._currentPercent;this._passLastFrame=!0}else this._passLastFrame=!1;do{if(this._fromIndex=s,t=a[this._fromIndex],r=t.frameID,(s=this._fromIndex+1)>=c&&(s=0),i=a[s],t.strEvent&&!this._animation.isIgnoreFrameEvent()&&this._animation.frameEvent(this._bone,t.strEvent,t.frameID,n),n==t.frameID||this._passLastFrame&&this._fromIndex==c-1)break}while(n<t.frameID||n>=i.frameID);o=i.frameID-t.frameID,this._frameTweenEasing=t.tweenEasing,this.setBetween(t,i,!1),this._totalDuration=r,this._betweenDuration=o,this._toIndex=s}e=0==o?0:(n-this._totalDuration)/this._betweenDuration;var l=this._frameTweenEasing!=ccs.TweenType.linear?this._frameTweenEasing:this._tweenEasing;return l==ccs.TweenType.tweenEasingMax||l==ccs.TweenType.linear||this._passLastFrame||(e=ccs.TweenFunction.tweenTo(e,l,this._from.easingParams)),e},setAnimation:function(e){this._animation=e},getAnimation:function(){return this._animation},setMovementBoneData:function(e){this._movementBoneData=e}}),(_p=ccs.Tween.prototype).animation,cc.defineGetterSetter(_p,"animation",_p.getAnimation,_p.setAnimation),_p=null,ccs.Tween.create=function(e){return new ccs.Tween(e)},ccs.PT_RATIO=32,ccs.ColliderFilter=ccs.Class.extend({_collisionType:0,_group:0,_categoryBits:0,_groupIndex:0,_maskBits:0,ctor:function(e,t){this._collisionType=e||0,this._group=t||0},updateShape:function(e){if(e instanceof cp.Shape)e.collision_type=this._collisionType,e.group=this._group;else if(e instanceof Box2D.b2FilterData){var t=new Box2D.b2FilterData;t.categoryBits=this._categoryBits,t.groupIndex=this._groupIndex,t.maskBits=this._maskBits,e.SetFilterData(t)}}}),ccs.ColliderBody=ccs.Class.extend({shape:null,coutourData:null,colliderFilter:null,_calculatedVertexList:null,ctor:function(e){this.shape=null,this.coutourData=e,this.colliderFilter=new ccs.ColliderFilter,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX&&(this._calculatedVertexList=[])},getContourData:function(){return this.coutourData},setColliderFilter:function(e){this.colliderFilter=e},getCalculatedVertexList:function(){return this._calculatedVertexList},setB2Fixture:function(e){this._fixture=e},getB2Fixture:function(){return this._fixture},setShape:function(e){this.shape=e},getShape:function(){return this.shape},setContourData:function(e){this.coutourData=e},getColliderFilter:function(){return this.colliderFilter}}),ccs.ColliderDetector=ccs.Class.extend({_colliderBodyList:null,_bone:null,_body:null,_active:!1,_filter:null,helpPoint:cc.p(0,0),ctor:function(e){this._colliderBodyList=[],this._bone=null,this._body=null,this._active=!1,this._filter=null,ccs.ColliderDetector.prototype.init.call(this,e)},init:function(e){return this._colliderBodyList.length=0,e&&(this._bone=e),this._filter=new ccs.ColliderFilter,!0},addContourData:function(e){var t=new ccs.ColliderBody(e);if(this._colliderBodyList.push(t),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)for(var i=t.getCalculatedVertexList(),n=e.vertexList,r=0;r<n.length;r++){var o=new ccs.ContourVertex2(0,0);i.push(o)}},addContourDataList:function(e){for(var t=0;t<e.length;t++)this.addContourData(e[t])},removeContourData:function(e){var t,i=[],n=this._colliderBodyList;for(t=0;t<n.length;t++){var r=n[t];r&&r.getContourData()==e&&i.push(r)}for(t=0;t<i.length;t++)cc.arrayRemoveObject(n,i[t])},removeAll:function(){this._colliderBodyList.length=0},setActive:function(e){if(this._active!=e){this._active=e;var t,i=this._body;if(i){if(this._active)for(n=0;n<this._colliderBodyList.length;n++)t=this._colliderBodyList[n].getShape(),i.space.addShape(t);else for(var n=0;n<this._colliderBodyList.length;n++)t=this._colliderBodyList[n].getShape(),i.space.removeShape(t)}}},getActive:function(){return this._active},getColliderBodyList:function(){return this._colliderBodyList},setColliderFilter:function(e){this._filter=e;for(var t=this._colliderBodyList,i=0;i<t.length;i++){var n=t[i];n.setColliderFilter(e),n.getShape()&&n.getColliderFilter().updateShape(n.getShape())}},getColliderFilter:function(){return this._filter},updateTransform:function(e){if(this._active)for(var t=null,i=this._body,n=this.helpPoint,r=0;r<this._colliderBodyList.length;r++){var o=(t=this._colliderBodyList[r]).getContourData(),s=null;i&&(s=t.getShape());for(var a=o.vertexList,c=t.getCalculatedVertexList(),l=0;l<a.length;l++){if(n.x=a[l].x,n.y=a[l].y,n=cc.pointApplyAffineTransform(n,e),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX){var u=cc.p(0,0);u.x=n.x,u.y=n.y,c[l]=u}s&&(s.verts[2*l]=n.x,s.verts[2*l+1]=n.y)}if(s)for(l=0;l<a.length;l++){var h=s.verts[(l+1)%s.verts.length],d=cp.v.normalize(cp.v.perp(cp.v.sub(h,s.verts[l])));s.planes&&(s.planes[l].n=d,s.planes[l].d=cp.v.dot(d,s.verts[l]))}}},setBody:function(e){this._body=e;for(var t,i=this._colliderBodyList,n=0;n<i.length;n++){for(var r=[],o=(t=i[n]).getContourData().vertexList,s=0;s<o.length;s++){var a=o[s];r.push(a.x),r.push(a.y)}var c=new cp.PolyShape(this._body,r,cp.vzero);c.sensor=!0,c.data=this._bone,this._active&&this._body.space.addShape(c),t.setShape(c),t.getColliderFilter().updateShape(c)}},getBody:function(){return this._body}}),(_p=ccs.ColliderDetector.prototype).colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p.active,cc.defineGetterSetter(_p,"active",_p.getActive,_p.setActive),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p=null,ccs.ColliderDetector.create=function(e){return new ccs.ColliderDetector(e)},ccs.Armature=ccs.Node.extend({animation:null,armatureData:null,batchNode:null,_textureAtlas:null,_parentBone:null,_boneDic:null,_topBoneList:null,_armatureIndexDic:null,_offsetPoint:null,version:0,_armatureTransformDirty:!0,_body:null,_blendFunc:null,_className:"Armature",ctor:function(e,t){cc.Node.prototype.ctor.call(this),this._name="",this._topBoneList=[],this._armatureIndexDic={},this._offsetPoint=cc.p(0,0),this._armatureTransformDirty=!0,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},e&&ccs.Armature.prototype.init.call(this,e,t)},init:function(e,t){cc.Node.prototype.init.call(this),t&&(this._parentBone=t),this.removeAllChildren(),this.animation=new ccs.ArmatureAnimation,this.animation.init(this),this._boneDic={},this._topBoneList.length=0,this._name=e||"";var i,n=ccs.armatureDataManager;if(""!=e){i=n.getAnimationData(e),cc.assert(i,"AnimationData not exist!"),this.animation.setAnimationData(i);var r=n.getArmatureData(e);cc.assert(r,"ArmatureData not exist!"),this.armatureData=r;var o=r.getBoneDataDic();for(var s in o){var a=this.createBone(String(s));do{var c=i.getMovement(i.movementNames[0]);if(!c)break;var l=c.getMovementBoneData(a.getName());if(!l||l.frameList.length<=0)break;var u=l.getFrameData(0);if(!u)break;a.getTweenData().copy(u),a.changeDisplayWithIndex(u.displayIndex,!1)}while(0)}this.update(0),this.updateOffsetPoint()}else this._name="new_armature",this.armatureData=new ccs.ArmatureData,this.armatureData.name=this._name,(i=new ccs.AnimationData).name=this._name,n.addArmatureData(this._name,this.armatureData),n.addAnimationData(this._name,i),this.animation.setAnimationData(i);return this._renderCmd.initShaderCache(),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),!0},addChild:function(e,t,i){e instanceof ccui.Widget?cc.log("Armature doesn't support to add Widget as its child, it will be fix soon."):cc.Node.prototype.addChild.call(this,e,t,i)},createBone:function(e){var t=this.getBone(e);if(t)return t;var i=this.armatureData.getBoneData(e),n=i.parentName,r=null;return n?(this.createBone(n),r=new ccs.Bone(e),this.addBone(r,n)):(r=new ccs.Bone(e),this.addBone(r,"")),r.setBoneData(i),r.getDisplayManager().changeDisplayWithIndex(-1,!1),r},addBone:function(e,t){cc.assert(e,"Argument must be non-nil");var i=this._boneDic;if(e.getName()&&cc.assert(!i[e.getName()],"bone already added. It can't be added again"),t){var n=i[t];n?n.addChildBone(e):this._topBoneList.push(e)}else this._topBoneList.push(e);e.setArmature(this),i[e.getName()]=e,this.addChild(e)},removeBone:function(e,t){cc.assert(e,"bone must be added to the bone dictionary!"),e.setArmature(null),e.removeFromParent(t),cc.arrayRemoveObject(this._topBoneList,e),delete this._boneDic[e.getName()],this.removeChild(e,!0)},getBone:function(e){return this._boneDic[e]},changeBoneParent:function(e,t){cc.assert(e,"bone must be added to the bone dictionary!");var i=e.getParentBone();if(i&&(cc.arrayRemoveObject(i.getChildren(),e),e.setParentBone(null)),t){var n=this._boneDic[t];n?(n.addChildBone(e),cc.arrayRemoveObject(this._topBoneList,e)):this._topBoneList.push(e)}},getBoneDic:function(){return this._boneDic},updateOffsetPoint:function(){var e=this.getBoundingBox();this.setContentSize(e);var t=this._offsetPoint;t.x=-e.x,t.y=-e.y,0!=e.width&&0!=e.height&&this.setAnchorPoint(t.x/e.width,t.y/e.height)},getOffsetPoints:function(){return{x:this._offsetPoint.x,y:this._offsetPoint.y}},setAnimation:function(e){this.animation=e},getAnimation:function(){return this.animation},getArmatureTransformDirty:function(){return this._armatureTransformDirty},update:function(e){this.animation.update(e);for(var t=this._topBoneList,i=0;i<t.length;i++)t[i].update(e);this._armatureTransformDirty=!1},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){cc.Node.prototype.onExit.call(this),this.unscheduleUpdate()},getBoundingBox:function(){for(var e,t,i,n=0,r=!0,o=cc.rect(0,0,0,0),s=this._children,a=s.length,c=0;c<a;c++){var l=s[c];if(l){var u=l.getDisplayManager().getBoundingBox();if(0==u.x&&0==u.y&&0==u.width&&0==u.height)continue;r?(e=u.x,t=u.y,i=u.x+u.width,n=u.y+u.height,r=!1):(e=u.x<o.x?u.x:o.x,t=u.y<o.y?u.y:o.y,i=u.x+u.width>o.x+o.width?u.x+u.width:o.x+o.width,n=u.y+u.height>o.y+o.height?u.y+u.height:o.y+o.height),o.x=e,o.y=t,o.width=i-e,o.height=n-t}}return cc.rectApplyAffineTransform(o,this.getNodeToParentTransform())},getBoneAtPoint:function(e,t){for(var i=this._children,n=i.length-1;n>=0;n--){var r=i[n];if(r instanceof ccs.Bone&&r.getDisplayManager().containPoint(e,t))return r}return null},setParentBone:function(e){this._parentBone=e;var t=this._boneDic;for(var i in t)t[i].setArmature(this)},getParentBone:function(){return this._parentBone},drawContour:function(){cc._drawingUtil.setDrawColor(255,255,255,255),cc._drawingUtil.setLineWidth(1);var e=this._boneDic;for(var t in e){var i=e[t].getColliderDetector();if(i)for(var n=i.getColliderBodyList(),r=0;r<n.length;r++){var o=n[r].getCalculatedVertexList();cc._drawingUtil.drawPoly(o,o.length,!0)}}},setBody:function(e){if(this._body!=e){this._body=e,this._body.data=this;for(var t,i,n=this._children,r=0;r<n.length;r++)if((t=n[r])instanceof ccs.Bone)for(var o=t.getDisplayManager().getDecorativeDisplayList(),s=0;s<o.length;s++){var a=(i=o[s]).getColliderDetector();a&&a.setBody(this._body)}}},getShapeList:function(){return this._body?this._body.shapeList:null},getBody:function(){return this._body},setBlendFunc:function(e,t){void 0===t?(this._blendFunc.src=e.src,this._blendFunc.dst=e.dst):(this._blendFunc.src=e,this._blendFunc.dst=t)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setColliderFilter:function(e){var t=this._boneDic;for(var i in t)t[i].setColliderFilter(e)},getArmatureData:function(){return this.armatureData},setArmatureData:function(e){this.armatureData=e},getBatchNode:function(){return this.batchNode},setBatchNode:function(e){this.batchNode=e},getVersion:function(){return this.version},setVersion:function(e){this.version=e},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new ccs.Armature.CanvasRenderCmd(this):new ccs.Armature.WebGLRenderCmd(this)}}),(_p=ccs.Armature.prototype).parentBone,cc.defineGetterSetter(_p,"parentBone",_p.getParentBone,_p.setParentBone),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",null,_p.setColliderFilter),_p=null,ccs.Armature.create=function(e,t){return new ccs.Armature(e,t)},ccs.Armature.RenderCmd={_updateAnchorPointInPoint:function(){var e=this._node,t=e._contentSize,i=e._anchorPoint,n=e._offsetPoint;this._anchorPointInPoints.x=t.width*i.x-n.x,this._anchorPointInPoints.y=t.height*i.y-n.y,this._realAnchorPointInPoints.x=t.width*i.x,this._realAnchorPointInPoints.y=t.height*i.y,this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getAnchorPointInPoints:function(){return cc.p(this._realAnchorPointInPoints)}},function(){ccs.Armature.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._realAnchorPointInPoints=new cc.Point(0,0),this._startRenderCmd=new cc.CustomRenderCmd(this,this._startCmdCallback),this._RestoreRenderCmd=new cc.CustomRenderCmd(this,this._RestoreCmdCallback)};var e=ccs.Armature.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Armature.RenderCmd,e),e.constructor=ccs.Armature.CanvasRenderCmd,e._startCmdCallback=function(e,t,i){var n=this._node._parent;this.transform(n?n._renderCmd:null);var r=e||cc._renderContext;r.save(),r._switchToArmatureMode(!0,this._worldTransform,t,i)},e.transform=function(e,t){ccs.Node.CanvasRenderCmd.prototype.transform.call(this,e,t);for(var i=this._node._children,n=0,r=i.length;n<r;n++){var o=i[n];if(o&&o.getDisplayRenderNode){var s=o.getDisplayRenderNode();if(s&&s._renderCmd){var a=s._renderCmd;a.transform(null);var c=o._renderCmd._displayedColor,l=o._renderCmd._displayedOpacity,u=cc.Node._dirtyFlags,h=a._dirtyFlag,d=h&u.colorDirty,p=h&u.opacityDirty;d&&a._updateDisplayColor(c),p&&a._updateDisplayOpacity(l)}}}},e._RestoreCmdCallback=function(e){this._cacheDirty=!1,e._switchToArmatureMode(!1),e.restore()},e.initShaderCache=function(){},e.setShaderProgram=function(){},e.updateChildPosition=function(e,t){cc.renderer.pushRenderCommand(t._renderCmd)},e.rendering=function(e,t,i){for(var n=this._node._children,r=cc.BlendFunc.ALPHA_PREMULTIPLIED,o=cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,s=0,a=n.length;s<a;s++){var c=n[s];if(c&&c.getDisplayRenderNode){var l=c.getDisplayRenderNode();if(null==l)continue;switch(c.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:l instanceof ccs.Skin&&this.updateChildPosition(e,l,c,r,o);break;case ccs.DISPLAY_TYPE_ARMATURE:l._renderCmd.rendering(e,t,i);break;default:l.visit(this)}}else c instanceof cc.Node&&this._visitNormalChild(c)}},e._visitNormalChild=function(e){if(null!=e){var t=e._renderCmd;if(e._visible){t._curLevel=this._curLevel+1;var i,n,r=e._children;t._syncStatus(this),t.transform(null);var o=r.length;if(o>0){for(e.sortAllChildren(),i=0;i<o&&(n=r[i])._localZOrder<0;i++)n._renderCmd.visit(t);for(cc.renderer.pushRenderCommand(t);i<o;i++)r[i]._renderCmd.visit(t)}else cc.renderer.pushRenderCommand(t);this._dirtyFlag=0}}},e.visit=function(e){var t=this._node;t._visible&&(this.updateStatus(e),t.sortAllChildren(),cc.renderer.pushRenderCommand(this._startRenderCmd),this.rendering(),cc.renderer.pushRenderCommand(this._RestoreRenderCmd),this._cacheDirty=!1)}}(),function(){ccs.Armature.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._realAnchorPointInPoints=new cc.Point(0,0)};var e=ccs.Armature.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(ccs.Armature.RenderCmd,e),e.constructor=ccs.Armature.WebGLRenderCmd,e.rendering=function(e,t){var i=this._node;t||(cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPushMatrix(),cc.kmGLLoadMatrix(this._stackMatrix));for(var n=i._children,r=cc.BlendFunc.ALPHA_PREMULTIPLIED,o=cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,s=0,a=n.length;s<a;s++){var c=n[s];if(c&&c.getDisplayRenderNode){var l=c.getDisplayRenderNode();if(null==l)continue;switch(l.setShaderProgram(this._shaderProgram),c.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:if(l instanceof ccs.Skin){this._updateColorAndOpacity(l._renderCmd,c),l.updateTransform();var u=c.getBlendFunc();u.src!=r.src||u.dst!=r.dst?l.setBlendFunc(c.getBlendFunc()):i._blendFunc.src!=r.src||i._blendFunc.dst!=r.dst||l.getTexture().hasPremultipliedAlpha()?l.setBlendFunc(i._blendFunc):l.setBlendFunc(o),l._renderCmd.rendering(e)}break;case ccs.DISPLAY_TYPE_ARMATURE:l._renderCmd.rendering(e,!0);break;default:l._renderCmd.transform(),l._renderCmd.rendering(e)}}else c instanceof cc.Node&&(c.setShaderProgram(this._shaderProgram),c._renderCmd.transform(),c._renderCmd.rendering&&c._renderCmd.rendering(e))}t||cc.kmGLPopMatrix()},e.initShaderCache=function(){this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},e.setShaderProgram=function(e){this._shaderProgram=e},e._updateColorAndOpacity=function(e,t){var i=t._renderCmd._displayedColor,n=t._renderCmd._displayedOpacity,r=cc.Node._dirtyFlags,o=e._dirtyFlag,s=o&r.colorDirty,a=o&r.opacityDirty;s&&e._updateDisplayColor(i),a&&e._updateDisplayOpacity(n),(s||a)&&e._updateColor()},e.updateChildPosition=function(e,t,i,n,r){var o=this._node;t.updateTransform();var s=i.getBlendFunc();s.src!=n.src||s.dst!=n.dst?t.setBlendFunc(i.getBlendFunc()):o._blendFunc.src!=n.src||node_blendFunc.dst!=n.dst||t.getTexture().hasPremultipliedAlpha()?t.setBlendFunc(o._blendFunc):t.setBlendFunc(r),t.rendering(e)},e.updateStatus=function(){var e=cc.Node._dirtyFlags,t=this._dirtyFlag,i=t&e.colorDirty,n=t&e.opacityDirty;i&&this._updateDisplayColor(),n&&this._updateDisplayOpacity(),(i||n)&&this._updateColor(),this.transform(this.getParentRenderCmd(),!0)},e.visit=function(e){var t=this._node;if(t._visible){var i=cc.current_stack;i.stack.push(i.top),this.updateStatus(e),i.top=this._stackMatrix,t.sortAllChildren(),cc.renderer.pushRenderCommand(this),this._dirtyFlag=0,i.top=i.stack.pop()}}}(),ccs.Bone=ccs.Node.extend({_boneData:null,_armature:null,_childArmature:null,_displayManager:null,ignoreMovementBoneData:!1,_tween:null,_tweenData:null,_parentBone:null,_boneTransformDirty:!1,_worldTransform:null,_blendFunc:null,blendDirty:!1,_worldInfo:null,_armatureParentBone:null,_dataVersion:0,_className:"Bone",ctor:function(e){cc.Node.prototype.ctor.call(this),this._tweenData=null,this._parentBone=null,this._armature=null,this._childArmature=null,this._boneData=null,this._tween=null,this._displayManager=null,this.ignoreMovementBoneData=!1,this._worldTransform=cc.affineTransformMake(1,0,0,1,0,0),this._boneTransformDirty=!0,this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.blendDirty=!1,this._worldInfo=null,this._armatureParentBone=null,this._dataVersion=0,ccs.Bone.prototype.init.call(this,e)},init:function(e){return e&&(this._name=e),this._tweenData=new ccs.FrameData,this._tween=new ccs.Tween(this),this._displayManager=new ccs.DisplayManager(this),this._worldInfo=new ccs.BaseData,this._boneData=new ccs.BaseData,!0},setBoneData:function(e){cc.assert(e,"_boneData must not be null"),this._boneData!=e&&(this._boneData=e),this.setName(this._boneData.name),this._localZOrder=this._boneData.zOrder,this._displayManager.initDisplayList(e)},getBoneData:function(){return this._boneData},setArmature:function(e){this._armature=e,e?(this._tween.setAnimation(this._armature.getAnimation()),this._dataVersion=this._armature.getArmatureData().dataVersion,this._armatureParentBone=this._armature.getParentBone()):this._armatureParentBone=null},getArmature:function(){return this._armature},update:function(e){if(this._parentBone&&(this._boneTransformDirty=this._boneTransformDirty||this._parentBone.isTransformDirty()),this._armatureParentBone&&!this._boneTransformDirty&&(this._boneTransformDirty=this._armatureParentBone.isTransformDirty()),this._boneTransformDirty){var t=this._tweenData;this._dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeConcat(t,this._boneData),t.scaleX-=1,t.scaleY-=1);var i=this._worldInfo;i.copy(t),i.x=t.x+this._position.x,i.y=t.y+this._position.y,i.scaleX=t.scaleX*this._scaleX,i.scaleY=t.scaleY*this._scaleY,i.skewX=t.skewX+this._skewX+cc.degreesToRadians(this._rotationX),i.skewY=t.skewY+this._skewY-cc.degreesToRadians(this._rotationY),this._parentBone?this._applyParentTransform(this._parentBone):this._armatureParentBone&&this._applyParentTransform(this._armatureParentBone),ccs.TransformHelp.nodeToMatrix(i,this._worldTransform),this._armatureParentBone&&(this._worldTransform=cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToParentTransform()))}ccs.displayFactory.updateDisplay(this,e,this._boneTransformDirty||this._armature.getArmatureTransformDirty());for(var n=0;n<this._children.length;n++)this._children[n].update(e);this._boneTransformDirty=!1},_applyParentTransform:function(e){var t=this._worldInfo,i=e._worldTransform,n=e._worldInfo,r=t.x,o=t.y;t.x=r*i.a+o*i.c+n.x,t.y=r*i.b+o*i.d+n.y,t.scaleX=t.scaleX*n.scaleX,t.scaleY=t.scaleY*n.scaleY,t.skewX=t.skewX+n.skewX,t.skewY=t.skewY+n.skewY},setBlendFunc:function(e,t){var i,n,r=this._blendFunc;void 0===t?(i=e.src,n=e.dst):(i=e,n=t),r.src==i&&r.dst==n||(r.src=i,r.dst=n,this.blendDirty=!0)},updateColor:function(){var e=this._displayManager.getDisplayRenderNode();if(null!=e){var t=this._renderCmd;e.setColor(cc.color(t._displayedColor.r*this._tweenData.r/255,t._displayedColor.g*this._tweenData.g/255,t._displayedColor.b*this._tweenData.b/255)),e.setOpacity(t._displayedOpacity*this._tweenData.a/255)}},updateZOrder:function(){this._armature.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?this.setLocalZOrder(this._tweenData.zOrder+this._boneData.zOrder):this.setLocalZOrder(this._tweenData.zOrder)},addChildBone:function(e){cc.assert(e,"Argument must be non-nil"),cc.assert(!e.parentBone,"child already added. It can't be added again"),this._children.indexOf(e)<0&&(this._children.push(e),e.setParentBone(this))},removeChildBone:function(e,t){if(this._children.length>0&&-1!=this._children.getIndex(e)){if(t)for(var i=e._children,n=0;n<i.length;n++){var r=i[n];e.removeChildBone(r,t)}e.setParentBone(null),e.getDisplayManager().setCurrentDecorativeDisplay(null),cc.arrayRemoveObject(this._children,e)}},removeFromParent:function(e){this._parentBone&&this._parentBone.removeChildBone(this,e)},setParentBone:function(e){this._parentBone=e},getParentBone:function(){return this._parentBone},setChildArmature:function(e){this._childArmature!=e&&(null==e&&this._childArmature&&this._childArmature.setParentBone(null),this._childArmature=e)},getChildArmature:function(){return this._childArmature},getTween:function(){return this._tween},setLocalZOrder:function(e){this._localZOrder!=e&&cc.Node.prototype.setLocalZOrder.call(this,e)},getNodeToArmatureTransform:function(){return this._worldTransform},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToWorldTransform())},getDisplayRenderNode:function(){return this._displayManager.getDisplayRenderNode()},getDisplayRenderNodeType:function(){return this._displayManager.getDisplayRenderNodeType()},addDisplay:function(e,t){return t=t||0,this._displayManager.addDisplay(e,t)},removeDisplay:function(e){this._displayManager.removeDisplay(e)},changeDisplayByIndex:function(e,t){cc.log("changeDisplayByIndex is deprecated. Use changeDisplayWithIndex instead."),this.changeDisplayWithIndex(e,t)},changeDisplayByName:function(e,t){cc.log("changeDisplayByName is deprecated. Use changeDisplayWithName instead."),this.changeDisplayWithName(e,t)},changeDisplayWithIndex:function(e,t){this._displayManager.changeDisplayWithIndex(e,t)},changeDisplayWithName:function(e,t){this._displayManager.changeDisplayWithName(e,t)},getColliderDetector:function(){var e=this._displayManager.getCurrentDecorativeDisplay();if(e){var t=e.getColliderDetector();if(t)return t}return null},setColliderFilter:function(e){for(var t=this._displayManager.getDecorativeDisplayList(),i=0;i<t.length;i++){var n=t[i].getColliderDetector();n&&n.setColliderFilter(e)}},getColliderFilter:function(){var e=this.displayManager.getCurrentDecorativeDisplay();if(e){var t=e.getColliderDetector();if(t)return t.getColliderFilter()}return null},setTransformDirty:function(e){this._boneTransformDirty=e},isTransformDirty:function(){return this._boneTransformDirty},getDisplayManager:function(){return this._displayManager},setIgnoreMovementBoneData:function(e){this._ignoreMovementBoneData=e},isIgnoreMovementBoneData:function(){return this._ignoreMovementBoneData},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setBlendDirty:function(e){this._blendDirty=e},isBlendDirty:function(){return this._blendDirty},getTweenData:function(){return this._tweenData},getWorldInfo:function(){return this._worldInfo},getChildrenBone:function(){return this._children},nodeToArmatureTransform:function(){return this.getNodeToArmatureTransform()},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getColliderBodyList:function(){var e=this.getColliderDetector();return e?e.getColliderBodyList():null},getIgnoreMovementBoneData:function(){return this.isIgnoreMovementBoneData()},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new ccs.Bone.CanvasRenderCmd(this):new ccs.Bone.WebGLRenderCmd(this)}}),(_p=ccs.Bone.prototype).boneData,cc.defineGetterSetter(_p,"boneData",_p.getBoneData,_p.setBoneData),_p.armature,cc.defineGetterSetter(_p,"armature",_p.getArmature,_p.setArmature),_p.childArmature,cc.defineGetterSetter(_p,"childArmature",_p.getChildArmature,_p.setChildArmature),_p.childrenBone,cc.defineGetterSetter(_p,"childrenBone",_p.getChildrenBone),_p.tween,cc.defineGetterSetter(_p,"tween",_p.getTween),_p.tweenData,cc.defineGetterSetter(_p,"tweenData",_p.getTweenData),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p=null,ccs.Bone.create=function(e){return new ccs.Bone(e)},ccs.Bone.RenderCmd={_updateColor:function(){var e=this._node,t=e._displayManager.getDisplayRenderNode();if(null!=t){var i=t._renderCmd;t.setColor(cc.color(e._tweenData.r,e._tweenData.g,e._tweenData.g)),t.setOpacity(e._tweenData.a),i._syncDisplayColor(this._displayedColor),i._syncDisplayOpacity(this._displayedOpacity),i._updateColor()}}},function(){ccs.Bone.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!1};var e=ccs.Bone.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Bone.RenderCmd,e),e.constructor=ccs.Bone.CanvasRenderCmd}(),function(){ccs.Bone.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!1};var e=ccs.Bone.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(ccs.Bone.RenderCmd,e),e.constructor=ccs.Bone.WebGLRenderCmd}(),ccs.FRAME_TYPE_MOVE=0,ccs.FRAME_TYPE_SCALE=1,ccs.FRAME_TYPE_ROTATE=2,ccs.FRAME_TYPE_TINT=3,ccs.FRAME_TYPE_FADE=4,ccs.FRAME_TYPE_MAX=5,ccs.FrameEaseType={Custom:-1,Linear:0,Sine_EaseIn:1,Sine_EaseOut:2,Sine_EaseInOut:3,Quad_EaseIn:4,Quad_EaseOut:5,Quad_EaseInOut:6,Cubic_EaseIn:7,Cubic_EaseOut:8,Cubic_EaseInOut:9,Quart_EaseIn:10,Quart_EaseOut:11,Quart_EaseInOut:12,Quint_EaseIn:13,Quint_EaseOut:14,Quint_EaseInOut:15,Expo_EaseIn:16,Expo_EaseOut:17,Expo_EaseInOut:18,Circ_EaseIn:19,Circ_EaseOut:20,Circ_EaseInOut:21,Elastic_EaesIn:22,Elastic_EaesOut:23,Elastic_EaesInOut:24,Back_EaseIn:25,Back_EaseOut:26,Back_EaseInOut:27,Bounce_EaseIn:28,Bounce_EaseOut:29,Bounce_EaseInOut:30},ccs.ActionFrame=ccs.Class.extend({frameType:0,easingType:0,frameIndex:0,_Parameter:null,time:0,ctor:function(){this.frameType=0,this.easingType=ccs.FrameEaseType.Linear,this.frameIndex=0,this.time=0},getAction:function(e,t){return cc.log("Need a definition of <getAction> for ActionFrame"),null},_getEasingAction:function(e){if(null===e)return console.error("Action cannot be null!"),null;var t;switch(this.easingType){case ccs.FrameEaseType.Custom:break;case ccs.FrameEaseType.Linear:t=e;break;case ccs.FrameEaseType.Sine_EaseIn:t=e.easing(cc.easeSineIn());break;case ccs.FrameEaseType.Sine_EaseOut:t=e.easing(cc.easeSineOut());break;case ccs.FrameEaseType.Sine_EaseInOut:t=e.easing(cc.easeSineInOut());break;case ccs.FrameEaseType.Quad_EaseIn:t=e.easing(cc.easeQuadraticActionIn());break;case ccs.FrameEaseType.Quad_EaseOut:t=e.easing(cc.easeQuadraticActionOut());break;case ccs.FrameEaseType.Quad_EaseInOut:t=e.easing(cc.easeQuadraticActionInOut());break;case ccs.FrameEaseType.Cubic_EaseIn:t=e.easing(cc.easeCubicActionIn());break;case ccs.FrameEaseType.Cubic_EaseOut:t=e.easing(cc.easeCubicActionOut());break;case ccs.FrameEaseType.Cubic_EaseInOut:t=e.easing(cc.easeCubicActionInOut());break;case ccs.FrameEaseType.Quart_EaseIn:t=e.easing(cc.easeQuarticActionIn());break;case ccs.FrameEaseType.Quart_EaseOut:t=e.easing(cc.easeQuarticActionOut());break;case ccs.FrameEaseType.Quart_EaseInOut:t=e.easing(cc.easeQuarticActionInOut());break;case ccs.FrameEaseType.Quint_EaseIn:t=e.easing(cc.easeQuinticActionIn());break;case ccs.FrameEaseType.Quint_EaseOut:t=e.easing(cc.easeQuinticActionOut());break;case ccs.FrameEaseType.Quint_EaseInOut:t=e.easing(cc.easeQuinticActionInOut());break;case ccs.FrameEaseType.Expo_EaseIn:t=e.easing(cc.easeExponentialIn());break;case ccs.FrameEaseType.Expo_EaseOut:t=e.easing(cc.easeExponentialOut());break;case ccs.FrameEaseType.Expo_EaseInOut:t=e.easing(cc.easeExponentialInOut());break;case ccs.FrameEaseType.Circ_EaseIn:t=e.easing(cc.easeCircleActionIn());break;case ccs.FrameEaseType.Circ_EaseOut:t=e.easing(cc.easeCircleActionOut());break;case ccs.FrameEaseType.Circ_EaseInOut:t=e.easing(cc.easeCircleActionInOut());break;case ccs.FrameEaseType.Elastic_EaesIn:t=e.easing(cc.easeElasticIn());break;case ccs.FrameEaseType.Elastic_EaesOut:t=e.easing(cc.easeElasticOut());break;case ccs.FrameEaseType.Elastic_EaesInOut:t=e.easing(cc.easeElasticInOut());break;case ccs.FrameEaseType.Back_EaseIn:t=e.easing(cc.easeBackIn());break;case ccs.FrameEaseType.Back_EaseOut:t=e.easing(cc.easeBackOut());break;case ccs.FrameEaseType.Back_EaseInOut:t=e.easing(cc.easeBackInOut());break;case ccs.FrameEaseType.Bounce_EaseIn:t=e.easing(cc.easeBounceIn());break;case ccs.FrameEaseType.Bounce_EaseOut:t=e.easing(cc.easeBounceOut());break;case ccs.FrameEaseType.Bounce_EaseInOut:t=e.easing(cc.easeBounceInOut())}return t},setEasingParameter:function(e){this._Parameter=[];for(var t=0;t<e.length;t++)this._Parameter.push(e[t])},setEasingType:function(e){this.easingType=e}}),ccs.ActionMoveFrame=ccs.ActionFrame.extend({_position:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._position=cc.p(0,0),this.frameType=ccs.FRAME_TYPE_MOVE},setPosition:function(e,t){void 0===t?(this._position.x=e.x,this._position.y=e.y):(this._position.x=e,this._position.y=t)},getPosition:function(){return this._position},getAction:function(e){return this._getEasingAction(cc.moveTo(e,this._position))}}),ccs.ActionScaleFrame=ccs.ActionFrame.extend({_scaleX:1,_scaleY:1,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1,this.frameType=ccs.FRAME_TYPE_SCALE},setScaleX:function(e){this._scaleX=e},getScaleX:function(){return this._scaleX},setScaleY:function(e){this._scaleY=e},getScaleY:function(){return this._scaleY},getAction:function(e){return this._getEasingAction(cc.scaleTo(e,this._scaleX,this._scaleY))}}),ccs.ActionRotationFrame=ccs.ActionFrame.extend({_rotation:0,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._rotation=0,this.frameType=ccs.FRAME_TYPE_ROTATE},setRotation:function(e){this._rotation=e},getRotation:function(){return this._rotation},getAction:function(e,t){if(void 0===t)return this._getEasingAction(cc.rotateTo(e,this._rotation));if(t instanceof cc.ActionRotationFrame){var i=this._rotation-t._rotation;return this._getEasingAction(cc.rotateBy(e,i))}return this.getAction(e)}}),ccs.ActionFadeFrame=ccs.ActionFrame.extend({_opacity:255,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._opacity=255,this.frameType=ccs.FRAME_TYPE_FADE},setOpacity:function(e){this._opacity=e},getOpacity:function(){return this._opacity},getAction:function(e){return this._getEasingAction(cc.fadeTo(e,this._opacity))}}),ccs.ActionTintFrame=ccs.ActionFrame.extend({_color:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._color=cc.color(255,255,255,255),this.frameType=ccs.FRAME_TYPE_TINT},setColor:function(e){var t=this._color;t.r=e.r,t.g=e.g,t.b=e.b},getColor:function(){var e=this._color;return cc.color(e.r,e.g,e.b,e.a)},getAction:function(e){return this._getEasingAction(cc.tintTo(e,this._color.r,this._color.g,this._color.b))}}),ccs.actionManager={_actionDic:{},initWithDictionary:function(e,t,i){for(var n=e,r=n.lastIndexOf("/"),o=n.substr(r+1,n.length),s=t.actionlist,a=[],c=0;c<s.length;c++){var l=new ccs.ActionObject,u=s[c];l.initWithDictionary(u,i),a.push(l)}this._actionDic[o]=a},getActionByName:function(e,t){var i=e,n=i.lastIndexOf("/"),r=i.substr(n+1,i.length),o=this._actionDic[r];if(!o)return null;for(var s=0;s<o.length;s++){var a=o[s];if(t==a.getName())return a}return null},playActionByName:function(e,t,i){var n=this.getActionByName(e,t);n&&n.play(i)},stopActionByName:function(e,t){var i=this.getActionByName(e,t);i&&i.stop()},releaseActions:function(){this._actionDic={}},clear:function(){this._actionDic={}}},ccs.ActionNode=ccs.Class.extend({_currentFrameIndex:0,_destFrameIndex:0,_unitTime:0,_actionTag:0,_object:null,_actionSpawn:null,_action:null,_frameArray:null,_frameArrayNum:0,ctor:function(){this._currentFrameIndex=0,this._destFrameIndex=0,this._unitTime=.1,this._actionTag=0,this._object=null,this._actionSpawn=null,this._action=null,this._frameArray=[],this._frameArrayNum=ccs.FRAME_TYPE_MAX;for(var e=0;e<this._frameArrayNum;e++)this._frameArray.push([])},initWithDictionary:function(e,t){this.setActionTag(e.ActionTag);for(var i=e.actionframelist,n=0;n<i.length;n++){var r=i[n],o=r.frameid,s=r.tweenType;null==s&&(s=0);for(var a=r.tweenParameter,c=[],l=0;l<a;l++){var u=r.tweenParameter[l];c.push(u)}var h;if(void 0!==r.positionx){var d=r.positionx,p=r.positiony;(h=new ccs.ActionMoveFrame).frameIndex=o,h.setEasingType(s),h.setEasingParameter(c),h.setPosition(d,p),this._frameArray[ccs.FRAME_TYPE_MOVE].push(h)}if(void 0!==r.scalex){var _=r.scalex,f=r.scaley;(h=new ccs.ActionScaleFrame).frameIndex=o,h.setEasingType(s),h.setEasingParameter(c),h.setScaleX(_),h.setScaleY(f),this._frameArray[ccs.FRAME_TYPE_SCALE].push(h)}if(void 0!==r.rotation){var m=r.rotation;(h=new ccs.ActionRotationFrame).frameIndex=o,h.setEasingType(s),h.setEasingParameter(c),h.setRotation(m),this._frameArray[ccs.FRAME_TYPE_ROTATE].push(h)}if(void 0!==r.opacity){var g=r.opacity;(h=new ccs.ActionFadeFrame).frameIndex=o,h.setEasingType(s),h.setEasingParameter(c),h.setOpacity(g),this._frameArray[ccs.FRAME_TYPE_FADE].push(h)}if(void 0!==r.colorr){var y=r.colorr,T=r.colorg,v=r.colorb;(h=new ccs.ActionTintFrame).frameIndex=o,h.setEasingType(s),h.setEasingParameter(c),h.setColor(cc.color(y,T,v)),this._frameArray[ccs.FRAME_TYPE_TINT].push(h)}r=null}this._initActionNodeFromRoot(t)},_initActionNodeFromRoot:function(e){if(e instanceof ccui.Widget){var t=ccui.helper.seekActionWidgetByActionTag(e,this.getActionTag());t&&this.setObject(t)}},setUnitTime:function(e){this._unitTime=e,this._refreshActionProperty()},getUnitTime:function(){return this._unitTime},setActionTag:function(e){this._actionTag=e},getActionTag:function(){return this._actionTag},setObject:function(e){this._object=e},getObject:function(){return this._object},getActionNode:function(){return this._object instanceof cc.Node?this._object:null},insertFrame:function(e,t){if(null!=t){var i=t.frameType;this._frameArray[i].splice(e,0,t)}},addFrame:function(e){if(e){var t=e.frameType;this._frameArray[t].push(e)}},deleteFrame:function(e){if(null!=e){var t=e.frameType,i=this._frameArray[t];cc.arrayRemoveObject(i,e)}},clearAllFrame:function(){for(var e=0;e<this._frameArrayNum;e++)this._frameArray[e].length=0},_refreshActionProperty:function(){if(null==this._object)return null;for(var e=[],t=0;t<this._frameArrayNum;t++){var i=this._frameArray[t];if(!(i.length<=0)){for(var n=[],r=0;r<i.length;r++){var o=i[r];if(0!=r){var s=i[r-1],a=(o.frameIndex-s.frameIndex)*this.getUnitTime(),c=o.getAction(a);c&&n.push(c)}}if(n){var l=cc.sequence(n);null!=l&&e.push(l)}}}return this._action=null,this._actionSpawn=cc.spawn(e),this._actionSpawn},playAction:function(e){null!=this._object&&null!=this._actionSpawn&&(this._action=e?cc.sequence(this._actionSpawn,e):cc.sequence(this._actionSpawn),this._runAction())},_runAction:function(){var e=this.getActionNode();null!=e&&null!=this._action&&e.runAction(this._action)},stopAction:function(){var e=this.getActionNode();null!=e&&null!=this._action&&(this._action.isDone()||e.stopAction(this._action))},getFirstFrameIndex:function(){for(var e=99999,t=!1,i=this._frameArray,n=0,r=this._frameArrayNum;n<r;n++){var o=i[n];if(!(o.length<=0)){t=!0;var s=o[0].frameIndex;e=e>s?s:e}}return t||(e=0),e},getLastFrameIndex:function(){for(var e=-1,t=!1,i=this._frameArray,n=0,r=this._frameArrayNum;n<r;n++){var o=i[n];if(!(o.length<=0)){t=!0;var s=o[o.length-1].frameIndex;e=e<s?s:e}}return t||(e=0),e},updateActionToTimeLine:function(e){for(var t=!1,i=this.getUnitTime(),n=0;n<this._frameArrayNum;n++){var r=this._frameArray[n];if(null!=r)for(var o=0;o<r.length;o++){var s=r[o];if(s.frameIndex*i==e){this._easingToFrame(1,1,s),t=!0;break}if(s.frameIndex*i>e){if(0==o)this._easingToFrame(1,1,s),t=!1;else{var a=r[o-1],c=(s.frameIndex-a.frameIndex)*i,l=e-a.frameIndex*i;this._easingToFrame(c,1,a),this._easingToFrame(c,l/c,s),t=!0}break}}}return t},_easingToFrame:function(e,t,i){var n=i.getAction(e),r=this.getActionNode();null!=n&&null!=r&&(n.startWithTarget(r),n.update(t))},isActionDoneOnce:function(){return null==this._action||this._action.isDone()}}),ccs.ActionObject=ccs.Class.extend({_actionNodeList:null,_name:"",_loop:!1,_pause:!1,_playing:!1,_unitTime:0,_currentTime:0,_scheduler:null,_callback:null,_fTotalTime:0,ctor:function(){this._actionNodeList=[],this._name="",this._loop=!1,this._pause=!1,this._playing=!1,this._unitTime=.1,this._currentTime=0,this._fTotalTime=0,this._scheduler=cc.director.getScheduler()},setName:function(e){this._name=e},getName:function(){return this._name},setLoop:function(e){this._loop=e},getLoop:function(){return this._loop},setUnitTime:function(e){this._unitTime=e;for(var t=this._actionNodeList.length,i=0;i<t;i++)this._actionNodeList[i].setUnitTime(this._unitTime)},getUnitTime:function(){return this._unitTime},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(e){this._currentTime=e},getTotalTime:function(){return this._fTotalTime},isPlaying:function(){return this._playing},initWithDictionary:function(e,t){this.setName(e.name),this.setLoop(e.loop),this.setUnitTime(e.unittime);for(var i=e.actionnodelist,n=0,r=0;r<i.length;r++){var o=new ccs.ActionNode,s=i[r];o.initWithDictionary(s,t),o.setUnitTime(this.getUnitTime()),this._actionNodeList.push(o);var a=o.getLastFrameIndex()-o.getFirstFrameIndex();a>n&&(n=a)}this._fTotalTime=n*this._unitTime},addActionNode:function(e){e&&(this._actionNodeList.push(e),e.setUnitTime(this._unitTime))},removeActionNode:function(e){null!=e&&cc.arrayRemoveObject(this._actionNodeList,e)},play:function(e){this.stop(),this.updateToFrameByTime(0);for(var t=this._actionNodeList,i=t.length,n=0;n<i;n++)t[n].playAction(e);this._loop&&this._scheduler.scheduleCallbackForTarget(this,this.simulationActionUpdate,0,cc.REPEAT_FOREVER,0,!1),void 0!==e&&(this._callback=e)},pause:function(){this._pause=!0,this._playing=!1},stop:function(){for(var e=this._actionNodeList,t=0;t<e.length;t++)e[t].stopAction();this._scheduler.unscheduleCallbackForTarget(this,this.simulationActionUpdate),this._pause=!1,this._playing=!1},updateToFrameByTime:function(e){this._currentTime=e;for(var t=0;t<this._actionNodeList.length;t++)this._actionNodeList[t].updateActionToTimeLine(e)},simulationActionUpdate:function(e){for(var t=!0,i=this._actionNodeList,n=0,r=i.length;n<r;n++)if(!i[n].isActionDoneOnce()){t=!1;break}t&&(null!=this._callback&&this._callback.execute(),this._loop?this.play():(this._playing=!1,this._scheduler.unschedule(this.simulationActionUpdate,this)))}}),ccs.ComAttribute=ccs.Component.extend({_jsonDict:null,_filePath:"",ctor:function(){cc.Component.prototype.ctor.call(this),this._jsonDict={},this._filePath="",this._name="CCComAttribute",ccs.ComAttribute.prototype.init.call(this)},init:function(){return this._jsonDict={},!0},setInt:function(e,t){e?this._jsonDict[e]=t:cc.log("Argument must be non-nil")},setDouble:function(e,t){e?this._jsonDict[e]=t:cc.log("Argument must be non-nil")},setFloat:function(e,t){e?this._jsonDict[e]=t:cc.log("Argument must be non-nil")},setBool:function(e,t){e?this._jsonDict[e]=t:cc.log("Argument must be non-nil")},setString:function(e,t){e?this._jsonDict[e]=t:cc.log("Argument must be non-nil")},setObject:function(e,t){e?this._jsonDict[e]=t:cc.log("Argument must be non-nil")},getInt:function(e){var t=this._jsonDict[e];return parseInt(t||0)},getDouble:function(e){var t=this._jsonDict[e];return parseFloat(t||0)},getFloat:function(e){var t=this._jsonDict[e];return parseFloat(t||0)},getBool:function(e){var t=this._jsonDict[e];return Boolean(t||!1)},getString:function(e){return this._jsonDict[e]||""},getObject:function(e){return this._jsonDict[e]},parse:function(e){this._jsonDict=cc.loader.getRes(e)}}),ccs.ComAttribute.create=function(){return new ccs.ComAttribute},ccs.ComAudio=ccs.Component.extend({_filePath:"",_loop:!1,ctor:function(){cc.Component.prototype.ctor.call(this),this._name="Audio",ccs.ComAudio.prototype.init.call(this)},init:function(){return!0},onExit:function(){this.stopBackgroundMusic(!0),this.stopAllEffects()},end:function(){cc.audioEngine.end()},preloadBackgroundMusic:function(e){cc.loader.load(e)},playBackgroundMusic:function(e,t){e?cc.audioEngine.playMusic(e,t):cc.audioEngine.playMusic(this._filePath,this._loop)},stopBackgroundMusic:function(e){cc.audioEngine.stopMusic(e)},pauseBackgroundMusic:function(){cc.audioEngine.pauseMusic()},resumeBackgroundMusic:function(){cc.audioEngine.resumeMusic()},rewindBackgroundMusic:function(){cc.audioEngine.rewindMusic()},willPlayBackgroundMusic:function(){return cc.audioEngine.willPlayMusic()},isBackgroundMusicPlaying:function(){return cc.audioEngine.isMusicPlaying()},getBackgroundMusicVolume:function(){return cc.audioEngine.getMusicVolume()},setBackgroundMusicVolume:function(e){cc.audioEngine.setMusicVolume(e)},getEffectsVolume:function(){return cc.audioEngine.getEffectsVolume()},setEffectsVolume:function(e){cc.audioEngine.setEffectsVolume(e)},playEffect:function(e,t){return e?cc.audioEngine.playEffect(e,t):cc.audioEngine.playEffect(this._filePath,this._loop)},pauseEffect:function(e){cc.audioEngine.pauseEffect(e)},pauseAllEffects:function(){cc.audioEngine.pauseAllEffects()},resumeEffect:function(e){cc.audioEngine.resumeEffect(e)},resumeAllEffects:function(){cc.audioEngine.resumeAllEffects()},stopEffect:function(e){cc.audioEngine.stopEffect(e)},stopAllEffects:function(){cc.audioEngine.stopAllEffects()},preloadEffect:function(e){cc.loader.getRes(e),this.setFile(e),this.setLoop(!1)},unloadEffect:function(e){cc.audioEngine.unloadEffect(e)},setFile:function(e){this._filePath=e},setLoop:function(e){this._loop=e},getFile:function(){return this._filePath},isLoop:function(){return this._loop}}),ccs.ComAudio.create=function(){return new ccs.ComAudio},ccs.ComController=ccs.Component.extend({ctor:function(){cc.Component.prototype.ctor.call(this),this._name="ComController",ccs.ComController.prototype.init.call(this)},onEnter:function(){null!=this._owner&&this._owner.scheduleUpdate()},isEnabled:function(){return this._enabled},setEnabled:function(e){this._enabled=e}}),ccs.ComController.create=function(){return new ccs.ComController},ccs.ComRender=ccs.Component.extend({_render:null,ctor:function(e,t){cc.Component.prototype.ctor.call(this),this._render=e,this._name=t,this.isRenderer=!0,ccs.ComRender.prototype.init.call(this)},onEnter:function(){this._owner&&this._owner.addChild(this._render)},onExit:function(){this._owner&&(this._owner.removeChild(this._render,!0),this._render=null)},getNode:function(){return this._render},setNode:function(e){this._render=e}}),ccs.ComRender.create=function(e,t){return new ccs.ComRender(e,t)},ccs.objectFactory={_typeMap:{},createObject:function(e){var t=null,i=this._typeMap[e];return i&&(t=cc.isFunction(i._fun)?new i._fun:i._fun),t},registerType:function(e){this._typeMap[e._className]=e},createGUI:function(e){var t=null;"Panel"===e?e="Layout":"TextArea"===e?e="Label":"TextButton"===e&&(e="Button");var i=this._typeMap[e];return i&&i._fun&&(t=i._fun),t},removeAll:function(){this._typeMap={}}},ccs.TInfo=ccs.Class.extend({_className:"",_fun:null,ctor:function(e,t){t?(this._className=e,this._fun=t):(this._className=e._className,this._fun=e._fun),ccs.objectFactory.registerType(this)}}),ccs.sendEvent=function(e){var t=ccs.triggerManager.get(e);if(null!=t)for(var i=0;i<t.length;i++){var n=t[i];null!=n&&n.detect()&&n.done()}},ccs.registerTriggerClass=function(e,t){new ccs.TInfo(e,t)},ccs.triggerManager={_eventTriggers:{},_triggerObjs:{},_movementDispatches:[],parse:function(e){for(var t=0;t<e.length;++t){var i=e[t],n=new ccs.TriggerObj;n.serialize(i);for(var r=n.getEvents(),o=0;o<r.length;o++){var s=r[o];this.add(s,n)}this._triggerObjs[n.getId()]=n}},get:function(e){return this._eventTriggers[e]},getTriggerObj:function(e){return this._triggerObjs[e]},add:function(e,t){var i=this._eventTriggers[e];i||(i=[]),-1==i.indexOf(t)&&(i.push(t),this._eventTriggers[e]=i)},removeAll:function(){for(var e in this._eventTriggers)for(var t=this._eventTriggers[e],i=0;i<t.length;i++)t[i].removeAll();this._eventTriggers={}},remove:function(e,t){if(t)return this._removeObj(e,t);var i=!1;do{var n=this._eventTriggers[e];if(!n)break;for(var r=0;r<n.length;r++){var o=n[r];o&&o.removeAll()}delete this._eventTriggers[e],i=!0}while(0);return i},_removeObj:function(e,t){var i=!1;do{var n=this._eventTriggers[e];if(!n)break;for(var r=0;r<n.length;r++){var o=n[r];if(o&&o==t){o.removeAll(),n.splice(r,1);break}}i=!0}while(0);return i},removeTriggerObj:function(e){var t=this.getTriggerObj(e);if(!t)return!1;for(var i=t.getEvents(),n=0;n<i.length;n++){var r=i[n];this.remove(r,t)}return!0},isEmpty:function(){return!this._eventTriggers||this._eventTriggers.length<=0},addArmatureMovementCallBack:function(e,t,i){if(null!=e&&null!=i&&null!=t){for(var n,r=!1,o=0;o<this._movementDispatches.length;o++)(n=this._movementDispatches[o])&&n[0]==e&&(n.addAnimationEventCallBack(t,i),r=!0);if(!r){var s=new ccs.ArmatureMovementDispatcher;e.getAnimation().setMovementEventCallFunc(s.animationEvent,s),s.addAnimationEventCallBack(t,i),this._movementDispatches.push([e,s])}}},removeArmatureMovementCallBack:function(e,t,i){if(null!=e&&null!=t&&null!=i)for(var n,r=0;r<this._movementDispatches.length;r++)(n=this._movementDispatches[r])&&n[0]==e&&n.removeAnimationEventCallBack(i,t)},removeArmatureAllMovementCallBack:function(e){if(null!=e)for(var t,i=0;i<this._movementDispatches.length;i++)if((t=this._movementDispatches[i])&&t[0]==e){this._movementDispatches.splice(i,1);break}},removeAllArmatureMovementCallBack:function(){this._movementDispatches.length=0},version:function(){return"1.2.0.0"}},ccs.ArmatureMovementDispatcher=ccs.Class.extend({_mapEventAnimation:null,ctor:function(){this._mapEventAnimation=[]},animationEvent:function(e,t,i){for(var n,r,o,s=0;s<this._mapEventAnimation.length;s++)r=(n=this._mapEventAnimation[s])[0],(o=n[1])&&o.call(r,e,t,i)},addAnimationEventCallBack:function(e,t){this._mapEventAnimation.push([t,e])},removeAnimationEventCallBack:function(e,t){for(var i=0;i<this._mapEventAnimation.length;i++)this._mapEventAnimation[i][0]==t&&this._mapEventAnimation.splice(i,1)}}),ccs.BaseTriggerCondition=ccs.Class.extend({ctor:function(){},init:function(){return!0},detect:function(){return!0},serialize:function(e){},removeAll:function(){}}),ccs.BaseTriggerAction=ccs.Class.extend({ctor:function(){},init:function(){return!0},done:function(){},serialize:function(e){},removeAll:function(){}}),ccs.TriggerObj=ccs.Class.extend({_cons:null,_acts:null,_id:0,_enable:!0,_vInt:null,ctor:function(){this._id=0,this._enable=!0,ccs.TriggerObj.prototype.init.call(this)},init:function(){return this._cons=[],this._acts=[],this._vInt=[],!0},detect:function(){if(!this._enable||0==this._cons.length)return!0;for(var e=!0,t=null,i=0;i<this._cons.length;i++)(t=this._cons[i])&&t.detect&&(e=e&&t.detect());return e},done:function(){if(this._enable&&0!=this._acts.length)for(var e,t=0;t<this._acts.length;t++)(e=this._acts[t])&&e.done&&e.done()},removeAll:function(){for(var e=null,t=0;t<this._cons.length;t++)(e=this._cons[t])&&e.removeAll();this._cons=[];for(t=0;t<this._acts.length;t++)(e=this._acts[t])&&e.removeAll();this._acts=[]},serialize:function(e){this._id=e.id||0;for(var t=e.conditions||[],i=0;i<t.length;i++){var n=(c=t[i]).classname,r=ccs.objectFactory.createObject(n);r?(r.serialize(c),r.init(),this._cons.push(r)):cc.log("class named classname("+n+") can not implement!")}for(var o=e.actions||[],i=0;i<o.length;i++){var n=(c=o[i]).classname,s=ccs.objectFactory.createObject(n);s?(s.serialize(c),s.init(),this._acts.push(s)):cc.log("class named classname("+n+") can not implement!")}for(var a=e.events||[],i=0;i<a.length;i++){var c=a[i],l=c.id;l<0||this._vInt.push(l)}},getId:function(){return this._id},setEnable:function(e){this._enable=e},getEvents:function(){return this._vInt}}),ccs.TriggerObj.create=function(){return new ccs.TriggerObj},ccs.ActionTimelineData=ccs.Class.extend({_actionTag:0,ctor:function(e){this._init(e)},_init:function(e){return this._actionTag=e,!0},setActionTag:function(e){this._actionTag=e},getActionTag:function(){return this._actionTag}}),ccs.ActionTimelineData.create=function(e){return new ccs.ActionTimelineData(e)},ccs.ActionTimeline=cc.Action.extend({_timelineMap:null,_timelineList:null,_duration:0,_time:null,_timeSpeed:1,_frameInternal:1/60,_playing:!1,_currentFrame:0,_startFrame:0,_endFrame:0,_loop:null,_frameEventListener:null,ctor:function(){cc.Action.prototype.ctor.call(this),this._timelineMap={},this._timelineList=[],this.init()},_gotoFrame:function(e){for(var t=this._timelineList.length,i=0;i<t;i++)this._timelineList[i]._gotoFrame(e)},_stepToFrame:function(e){for(var t=this._timelineList.length,i=0;i<t;i++)this._timelineList[i]._stepToFrame(e)},_emitFrameEvent:function(e){this._frameEventListener&&this._frameEventListener(e)},init:function(){return!0},gotoFrameAndPlay:function(e,t,i,n){var r,o=0,s=arguments.length,a=[];for(o;o<s;o++)"boolean"==typeof arguments[o]?r=arguments[o]:a.push(arguments[o]);e=a[0],t=a[1]||this._duration,i=a[2]||e,n=null==r||r,this._startFrame=e,this._endFrame=t,this._currentFrame=i,this._loop=n,this._time=this._currentFrame*this._frameInternal,this.resume(),this._gotoFrame(this._currentFrame)},gotoFrameAndPause:function(e){this._startFrame=this._currentFrame=e,this._time=this._currentFrame*this._frameInternal,this.pause(),this._gotoFrame(this._currentFrame)},pause:function(){this._playing=!1},resume:function(){this._playing=!0},isPlaying:function(){return this._playing},setTimeSpeed:function(e){this._timeSpeed=e},getTimeSpeed:function(){return this._timeSpeed},setDuration:function(e){this._duration=e},getDuration:function(){return this._duration},getStartFrame:function(){return this._startFrame},getEndFrame:function(){return this._endFrame},setCurrentFrame:function(e){e>=this._startFrame&&e>=this._endFrame?(this._currentFrame=e,this._time=this._currentFrame*this._frameInternal):cc.log("frame index is not between start frame and end frame")},getCurrentFrame:function(){return this._currentFrame},addTimeline:function(e){var t=e.getActionTag();this._timelineMap[t]||(this._timelineMap[t]=[]),this._timelineMap[t].some(function(t){if(t===e)return!0})||(this._timelineList.push(e),this._timelineMap[t].push(e),e.setActionTimeline(this))},removeTimeline:function(e){var t=e.getActionTag();this._timelineMap[t]&&this._timelineMap[t].some(function(t){if(t===e)return!0})&&(cc.arrayRemoveObject(this._timelineMap[t],e),cc.arrayRemoveObject(this._timelineList,e),e.setActionTimeline(null))},getTimelines:function(){return this._timelineList},setFrameEventCallFunc:function(e){this._frameEventListener=e},clearFrameEventCallFunc:function(){this._frameEventListener=null},clone:function(){var e=new ccs.ActionTimeline;e.setDuration(this._duration),e.setTimeSpeed(this._timeSpeed);for(var t in this._timelineMap){var i=this._timelineMap[t];for(var n in i){var r=i[n].clone();e.addTimeline(r)}}return e},reverse:function(){return null},step:function(e){this._playing&&0!=this._timelineMap.length&&0!=this._duration&&(this._time+=e*this._timeSpeed,this._currentFrame=this._time/this._frameInternal|0,this._stepToFrame(this._currentFrame),this._time>this._endFrame*this._frameInternal&&(this._playing=this._loop,this._playing?this.gotoFrameAndPlay(this._startFrame,this._endFrame,this._loop):this._time=this._endFrame*this._frameInternal))},_foreachNodeDescendant:function(e,t){t(e);for(var i=e.getChildren(),n=0;n<i.length;n++){var r=i[n];this._foreachNodeDescendant(r,t)}},startWithTarget:function(e){cc.Action.prototype.startWithTarget.call(this,e);var t=this;this._foreachNodeDescendant(e,function(e){var i=e.getUserObject();if(i){var n=i.getActionTag();if(t._timelineMap[n])for(var r=t._timelineMap[n],o=0;o<r.length;o++)r[o].setNode(e)}})},isDone:function(){return!1}}),ccs.ActionTimeline.create=function(){return new ccs.ActionTimeline},ccs.Frame=ccs.Class.extend({_frameIndex:null,_tween:null,_timeline:null,_node:null,ctor:function(){this._frameIndex=0,this._tween=!0,this._timeline=null,this._node=null},_emitEvent:function(){this._timeline&&this._timeline.getActionTimeline()._emitFrameEvent(this)},_cloneProperty:function(e){this._frameIndex=e.getFrameIndex(),this._tween=e.isTween()},setFrameIndex:function(e){this._frameIndex=e},getFrameIndex:function(){return this._frameIndex},setTimeline:function(e){this._timeline=e},getTimeline:function(e){return this._timeline},setNode:function(e){this._node=e},getNode:function(){return this._node},setTween:function(e){this._tween=e},isTween:function(){return this._tween},onEnter:function(e){},apply:function(e){},clone:function(){}}),ccs.VisibleFrame=ccs.Frame.extend({_visible:!0,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._visible=!0},onEnter:function(e){this._node.setVisible(this._visible)},clone:function(){var e=new ccs.VisibleFrame;return e.setVisible(this._visible),e._cloneProperty(this),e},setVisible:function(e){this._visible=e},isVisible:function(){return this._visible}}),ccs.VisibleFrame.create=function(){return new ccs.VisibleFrame},ccs.TextureFrame=ccs.Frame.extend({_sprite:null,_textureName:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._textureName=""},setNode:function(e){ccs.Frame.prototype.setNode.call(this,e),this._sprite=e},onEnter:function(e){if(this._sprite){var t=cc.spriteFrameCache._spriteFrames[this._textureName];null!=t?this._sprite.setSpriteFrame(t):this._sprite.setTexture(this._textureName)}},clone:function(){var e=new ccs.TextureFrame;return e.setTextureName(this._textureName),e._cloneProperty(this),e},setTextureName:function(e){this._textureName=e},getTextureName:function(){return this._textureName}}),ccs.TextureFrame.create=function(){return new ccs.TextureFrame},ccs.RotationFrame=ccs.Frame.extend({_rotation:null,_betwennRotation:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._rotation=0},onEnter:function(e){this._node.setRotation(this._rotation),this._tween&&(this._betwennRotation=e._rotation-this._rotation)},apply:function(e){if(this._tween&&0!=this._betwennRotation){var t=this._rotation+e*this._betwennRotation;this._node.setRotation(t)}},clone:function(){var e=new ccs.RotationFrame;return e.setRotation(this._rotation),e._cloneProperty(this),e},setRotation:function(e){this._rotation=e},getRotation:function(){return this._rotation}}),ccs.RotationFrame.create=function(){return new ccs.RotationFrame},ccs.SkewFrame=ccs.Frame.extend({_skewX:null,_skewY:null,_betweenSkewX:null,_betweenSkewY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._skewX=0,this._skewY=0},onEnter:function(e){this._node.setSkewX(this._skewX),this._node.setSkewY(this._skewY),this._tween&&(this._betweenSkewX=e._skewX-this._skewX,this._betweenSkewY=e._skewY-this._skewY)},apply:function(e){if(this._tween&&(0!=this._betweenSkewX||0!=this._betweenSkewY)){var t=this._skewX+e*this._betweenSkewX,i=this._skewY+e*this._betweenSkewY;this._node.setSkewX(t),this._node.setSkewY(i)}},clone:function(){var e=new ccs.SkewFrame;return e.setSkewX(this._skewX),e.setSkewY(this._skewY),e._cloneProperty(this),e},setSkewX:function(e){this._skewX=e},getSkewX:function(){return this._skewX},setSkewY:function(e){this._skewY=e},getSkewY:function(){return this._skewY}}),ccs.SkewFrame.create=function(){return new ccs.SkewFrame},ccs.RotationSkewFrame=ccs.SkewFrame.extend({onEnter:function(e){this._node.setRotationX(this._skewX),this._node.setRotationY(this._skewY),this._tween&&(this._betweenSkewX=e._skewX-this._skewX,this._betweenSkewY=e._skewY-this._skewY)},apply:function(e){if(this._tween&&(0!=this._betweenSkewX||0!=this._betweenSkewY)){var t=this._skewX+e*this._betweenSkewX,i=this._skewY+e*this._betweenSkewY;this._node.setRotationX(t),this._node.setRotationY(i)}},clone:function(){var e=new ccs.RotationSkewFrame;return e.setSkewX(this._skewX),e.setSkewY(this._skewY),e._cloneProperty(this),e}}),ccs.RotationSkewFrame.create=function(){return new ccs.RotationSkewFrame},ccs.PositionFrame=ccs.Frame.extend({_position:null,_betweenX:null,_betweenY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._position=cc.p(0,0)},onEnter:function(e){this._node.setPosition(this._position),this._tween&&(this._betweenX=e._position.x-this._position.x,this._betweenY=e._position.y-this._position.y)},apply:function(e){if(this._tween&&(0!=this._betweenX||0!=this._betweenY)){var t=cc.p(0,0);t.x=this._position.x+this._betweenX*e,t.y=this._position.y+this._betweenY*e,this._node.setPosition(t)}},clone:function(){var e=new ccs.PositionFrame;return e.setPosition(this._position),e._cloneProperty(this),e},setPosition:function(e){this._position=e},getPosition:function(){return this._position},setX:function(e){this._position.x=e},getX:function(){return this._position.x},setY:function(e){this._position.y=e},getY:function(){return this._position.y}}),ccs.PositionFrame.create=function(){return new ccs.PositionFrame},ccs.ScaleFrame=ccs.Frame.extend({_scaleX:null,_scaleY:null,_betweenScaleX:null,_betweenScaleY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1},onEnter:function(e){this._node.setScaleX(this._scaleX),this._node.setScaleY(this._scaleY),this._tween&&(this._betweenScaleX=e._scaleX-this._scaleX,this._betweenScaleY=e._scaleY-this._scaleY)},apply:function(e){if(this._tween&&(0!=this._betweenScaleX||0!=this._betweenScaleY)){var t=this._scaleX+this._betweenScaleX*e,i=this._scaleY+this._betweenScaleY*e;this._node.setScaleX(t),this._node.setScaleY(i)}},clone:function(){var e=new ccs.ScaleFrame;return e.setScaleX(this._scaleX),e.setScaleY(this._scaleY),e._cloneProperty(this),e},setScale:function(e){this._scaleX=e,this._scaleY=e},setScaleX:function(e){this._scaleX=e},getScaleX:function(){return this._scaleX},setScaleY:function(e){this._scaleY=e},getScaleY:function(){return this._scaleY}}),ccs.ScaleFrame.create=function(){return new ccs.ScaleFrame},ccs.AnchorPointFrame=ccs.Frame.extend({_anchorPoint:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._anchorPoint=cc.p(0,0)},onEnter:function(e){this._node.setAnchorPoint(this._anchorPoint)},clone:function(){var e=new ccs.AnchorPointFrame;return e.setAnchorPoint(this._anchorPoint),e._cloneProperty(this),e},setAnchorPoint:function(e){this._anchorPoint=e},getAnchorPoint:function(){return this._anchorPoint}}),ccs.AnchorPointFrame.create=function(){return new ccs.AnchorPointFrame},ccs.InnerActionType={LoopAction:0,NoLoopAction:1,SingleFrame:2},ccs.InnerActionFrame=ccs.Frame.extend({_innerActionType:null,_startFrameIndex:null,_endFrameIndex:0,_singleFrameIndex:0,_enterWithName:!1,_animationName:"",ctor:function(){ccs.Frame.prototype.ctor.call(this),this._innerActionType=ccs.InnerActionType.LoopAction,this._startFrameIndex=0},onEnter:function(e){var t=this._node.getActionByTag(this._node.getTag());if("SingleFrame"!=this._innerActionType){var i=this._startFrameIndex,n=this._endFrameIndex;if(this._enterWithName)if("-- ALL --"==this._animationName)i=0,n=t.getDuration();else if(t.IsAnimationInfoExists(this._animationName)){var r=t.getAnimationInfo(this._animationName);i=r.startIndex,n=r.endIndex}else cc.log("Animation %s not exists!",this._animationName);var o=this._timeline.getActionTimeline().getDuration()-this._frameIndex-n+i;o<0&&(n+=o),ccs.InnerActionType.NoLoopAction==this._innerActionType?t.gotoFrameAndPlay(i,n,!1):ccs.InnerActionType.LoopAction==this._innerActionType&&t.gotoFrameAndPlay(i,n,!0)}else t.gotoFrameAndPause(this._singleFrameIndex)},setAnimationName:function(e){this._enterWithName?this._animationName=e:cc.log(" cannot set aniamtioname when enter frame with index. setEnterWithName true firstly!")},setSingleFrameIndex:function(e){this._singleFrameIndex=e},getSingleFrameIndex:function(){return this._startFrameIndex},setEnterWithName:function(e){this._enterWithName=e},getEnterWithName:function(){return this._enterWithName},clone:function(){var e=new ccs.InnerActionFrame;return e.setInnerActionType(this._innerActionType),e.setStartFrameIndex(this._startFrameIndex),e._cloneProperty(this),e},setInnerActionType:function(e){this._innerActionType=e},getInnerActionType:function(){return this._innerActionType},setStartFrameIndex:function(e){this._startFrameIndex=e},getStartFrameIndex:function(){return this._startFrameIndex}}),ccs.InnerActionFrame.create=function(){return new ccs.InnerActionFrame},ccs.ColorFrame=ccs.Frame.extend({_alpha:null,_color:null,_betweenAlpha:null,_betweenRed:null,_betweenGreen:null,_betweenBlue:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._color=cc.color(255,255,255)},onEnter:function(e){if(this._node.setColor(this._color),this._tween){var t=e._color;this._betweenRed=t.r-this._color.r,this._betweenGreen=t.g-this._color.g,this._betweenBlue=t.b-this._color.b}},apply:function(e){if(this._tween&&(0!=this._betweenAlpha||0!=this._betweenRed||0!=this._betweenGreen||0!=this._betweenBlue)){var t=cc.color(255,255,255);if(t.r=this._color.r+this._betweenRed*e,t.g=this._color.g+this._betweenGreen*e,t.b=this._color.b+this._betweenBlue*e,this._node.setColor(t),null!=this._alpha){var i=this._alpha+this._betweenAlpha*e;this._node.setOpacity(i)}}},clone:function(){var e=new ccs.ColorFrame;return e.setColor(this._color),e._cloneProperty(this),e},setColor:function(e){this._color=e},getColor:function(){return this._color}}),ccs.ColorFrame.create=function(){return new ccs.ColorFrame},ccs.AlphaFrame=ccs.Frame.extend({_alpha:null,_betweenAlpha:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._alpha=255},onEnter:function(e){this._node.setOpacity(this._alpha),this._tween&&(this._betweenAlpha=e._alpha-this._alpha)},apply:function(e){if(this._tween){var t=this._alpha+this._betweenAlpha*e;this._node.setOpacity(t)}},setAlpha:function(e){this._alpha=e},getAlpha:function(){return this._alpha},clone:function(){var e=new ccs.AlphaFrame;return e.setAlpha(this._alpha),e._cloneProperty(this),e}}),ccs.EventFrame=ccs.Frame.extend({_event:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._event=""},onEnter:function(e){this._emitEvent()},clone:function(){var e=new ccs.EventFrame;return e.setEvent(this._event),e._cloneProperty(this),e},setEvent:function(e){this._event=e},getEvent:function(){return this._event}}),ccs.EventFrame.create=function(){return new ccs.EventFrame},ccs.ZOrderFrame=ccs.Frame.extend({_zorder:null,onEnter:function(e){this._node&&this._node.setLocalZOrder(this._zorder)},clone:function(){var e=new ccs.ZOrderFrame;return e.setZOrder(this._zorder),e._cloneProperty(this),e},setZOrder:function(e){this._zorder=e},getZOrder:function(){return this._zorder}}),ccs.ZOrderFrame.create=function(){return new ccs.ZOrderFrame},ccs.Timeline=ccs.Class.extend({_frames:null,_currentKeyFrame:null,_currentKeyFrameIndex:null,_fromIndex:null,_toIndex:null,_betweenDuration:null,_actionTag:null,_ActionTimeline:null,_node:null,ctor:function(){this._frames=[],this._currentKeyFrame=null,this._currentKeyFrameIndex=0,this._fromIndex=0,this._toIndex=0,this._betweenDuration=0,this._actionTag=0,this._ActionTimeline=null,this._node=null},_gotoFrame:function(e){0!=this._frames.length&&(this._binarySearchKeyFrame(e),this._apply(e))},_stepToFrame:function(e){0!=this._frames.length&&(this._updateCurrentKeyFrame(e),this._apply(e))},getFrames:function(){return this._frames},addFrame:function(e){this._frames.push(e),e.setTimeline(this)},insertFrame:function(e,t){this._frames.splice(t,0,e),e.setTimeline(this)},removeFrame:function(e){cc.arrayRemoveObject(this._frames,e),e.setTimeline(null)},setActionTag:function(e){this._actionTag=e},getActionTag:function(){return this._actionTag},setNode:function(e){for(var t=0;t<this._frames.length;t++)this._frames[t].setNode(e)},getNode:function(){return this._node},setActionTimeline:function(e){this._ActionTimeline=e},getActionTimeline:function(){return this._ActionTimeline},clone:function(){var e=new ccs.Timeline;e._actionTag=this._actionTag;for(var t=0;t<this._frames.length;t++){var i=this._frames[t].clone();e.addFrame(i)}return e},_apply:function(e){if(this._currentKeyFrame){var t=0==this._betweenDuration?0:(e-this._currentKeyFrameIndex)/this._betweenDuration;this._currentKeyFrame.apply(t)}},_binarySearchKeyFrame:function(e){var t=null,i=null,n=this._frames.length,r=!1;do{if(e<=this._frames[0].getFrameIndex()){this._currentKeyFrameIndex>=this._frames[0].getFrameIndex()&&(r=!0),t=i=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(e>=this._frames[n-1].getFrameIndex()){t=i=this._frames[n-1],this._currentKeyFrameIndex=this._frames[n-1].getFrameIndex(),this._betweenDuration=0;break}for(var o=-1,s=0,a=n-1,c=0;s<=a;){if(c=Math.ceil((s+a)/2),e>=this._frames[c].getFrameIndex()&&e<this._frames[c+1].getFrameIndex()){o=c;break}this._frames[c].getFrameIndex()>e?a=c-1:s=c+1}t=this._frames[o],i=this._frames[o+1],0==o&&this._currentKeyFrameIndex<t.getFrameIndex()&&(r=!0),this._currentKeyFrameIndex=t.getFrameIndex(),this._betweenDuration=i.getFrameIndex()-t.getFrameIndex()}while(0);(r||this._currentKeyFrame!=t)&&(this._currentKeyFrame=t,this._currentKeyFrame.onEnter(i))},_updateCurrentKeyFrame:function(e){if(e<this._currentKeyFrameIndex||e>=this._currentKeyFrameIndex+this._betweenDuration){var t=null,i=null;do{var n=this._frames.length;if(e<this._frames[0].getFrameIndex()){t=i=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(e>=this._frames[n-1].getFrameIndex()){t=i=this._frames[n-1],this._currentKeyFrameIndex=this._frames[n-1].getFrameIndex(),this._betweenDuration=0;break}do{if(this._fromIndex=this._toIndex,t=this._frames[this._fromIndex],this._currentKeyFrameIndex=t.getFrameIndex(),this._toIndex=this._fromIndex+1,this._toIndex>=n&&(this._toIndex=0),i=this._frames[this._toIndex],e==t.getFrameIndex())break}while(e<t.getFrameIndex()||e>=i.getFrameIndex());this._betweenDuration=i.getFrameIndex()-t.getFrameIndex()}while(0);this._currentKeyFrame=t,this._currentKeyFrame.onEnter(i)}}}),ccs.Timeline.create=function(){return new ccs.Timeline},ccs._load=function(){var e=function(e,n){var r=cc.loader.getRes(e);if(!r)return cc.log("%s is not exists",e);var s=i(e).toLocaleLowerCase();if("json"!==s&&"exportjson"!==s)return cc.log("%s load error, must be json file",e);var a;if(n?a=t[n]:r.widgetTree?a=t.ccui:r.nodeTree?a=t.timeline:r.Content&&r.Content.Content?a=t.timeline:r.gameobjects&&(a=t.scene),!a)return cc.log("Can't find the parser : %s",e),new cc.Node;var c=r.version||r.Version;if(!c&&r.armature_data)return cc.warn("%s is armature. please use:",e),cc.warn("    ccs.armatureDataManager.addArmatureFileInfoAsync(%s);",e),cc.warn("    var armature = new ccs.Armature('name');"),new cc.Node;var l=o(a,c);return l?l.parse(e,r)||null:(cc.log("Can't find the parser : %s",e),new cc.Node)},t={ccui:{},timeline:{},action:{},scene:{}};e.registerParser=function(e,i,n){if(!e||!i||!n)return cc.log("register parser error");t[e]||(t[e]={}),t[e][i]=n},e.getParser=function(e,i){return e&&i?t[e]?t[e][i]:void 0:e?t[e]:t};var i=function(e){var t=e.match(n);return t&&t[1]?t[1]:null},n=/\.([^\.]+)$/,r=/([^\.](\.\*)?)*$/,o=function(e,t){return e[t]?e[t]:"*"===t?null:o(e,t.replace(r,"*"))};return e}(),ccs._parser=cc.Class.extend({ctor:function(){this.parsers={}},_dirnameReg:/\S*\//,_dirname:function(e){var t=e.match(this._dirnameReg);return t&&t[0]?t[0]:""},getClass:function(e){return e.classname},getNodeJson:function(e){return e.widgetTree},parse:function(e,t){var i=this._dirname(e);this.pretreatment(t,i);var n=this.parseNode(this.getNodeJson(t),i,e);return n&&this.deferred(t,i,n,e),n},pretreatment:function(e,t,i){},deferred:function(e,t,i,n){},parseNode:function(e,t){var i=this.parsers[this.getClass(e)],n=null;return i?n=i.call(this,e,t):cc.log("Can't find the parser : %s",this.getClass(e)),n},registerParser:function(e,t){this.parsers[e]=t}}),ccs.load=function(e){var t={node:null,action:null};return t.node=ccs._load(e),t.action=ccs._load(e,"action"),t.action&&-1===t.action.tag&&t.node&&(t.action.tag=t.node.tag),t},ccs.actionTimelineCache={createAction:function(e){return ccs._load(e,"action")}},ccs.csLoader={createNode:function(e){return ccs._load(e)}},function(e,t){var i={},n=new(ccs._parser.extend({getNodeJson:function(e){return e.action},parseNode:function(e,t,n){if(!e)return null;if(i[n])return i[n].clone();var r=this,o=new ccs.ActionTimeline;return o.setDuration(e.duration),o.setTimeSpeed(e.speed||1),e.timelines.forEach(function(e){var i,n=r.parsers[e.frameType];n?i=n.call(r,e,t):cc.log("parser is not exists : %s",e.frameType),i&&o.addTimeline(i),"ColorFrame"==e.frameType&&o.addTimeline(r.parsers.AlphaFrame.call(r,e,t))}),i[n]=o,i[n].retain(),o.clone()}}));[{name:"PositionFrame",handle:function(e){var t=new ccs.PositionFrame,i=e.x,n=e.y;return t.setPosition(cc.p(i,n)),t}},{name:"VisibleFrame",handle:function(e){var t=new ccs.VisibleFrame,i=e.value;return t.setVisible(i),t}},{name:"ScaleFrame",handle:function(e){var t=new ccs.ScaleFrame,i=e.x,n=e.y;return t.setScaleX(i),t.setScaleY(n),t}},{name:"RotationFrame",handle:function(e){var t=new ccs.RotationFrame,i=e.rotation;return t.setRotation(i),t}},{name:"SkewFrame",handle:function(e){var t=new ccs.SkewFrame,i=e.x,n=e.y;return t.setSkewX(i),t.setSkewY(n),t}},{name:"RotationSkewFrame",handle:function(e){var t=new ccs.RotationSkewFrame,i=e.x,n=e.y;return t.setSkewX(i),t.setSkewY(n),t}},{name:"AnchorFrame",handle:function(e){var t=new ccs.AnchorPointFrame,i=e.x,n=e.y;return t.setAnchorPoint(cc.p(i,n)),t}},{name:"InnerActionFrame",handle:function(e){var t=new ccs.InnerActionFrame,i=e.innerActionType,n=e.startFrame;return t.setInnerActionType(i),t.setStartFrameIndex(n),t}},{name:"ColorFrame",handle:function(e){var t=new ccs.ColorFrame,i=e.red,n=e.green,r=e.blue;t.setColor(cc.color(i,n,r));var o=new ccs.AlphaFrame,s=e.alpha;return o.setAlpha(s),t}},{name:"AlphaFrame",handle:function(e){var t=new ccs.AlphaFrame,i=e.alpha;return t.setAlpha(i),t}},{name:"TextureFrame",handle:function(e){var t=new ccs.TextureFrame,i=e.value;if(null!=i){var n=i;null==cc.spriteFrameCache.getSpriteFrame(n)&&(n=ccs.csLoader.getJsonPath()+i),t.setTextureName(n)}return t}},{name:"EventFrame",handle:function(e){var t=new ccs.EventFrame,i=e.value;return null!=i&&t.setEvent(i),t}},{name:"ZOrderFrame",handle:function(e){var t=new ccs.ZOrderFrame,i=e.value;return t.setZOrder(i),t}}].forEach(function(e){n.registerParser(e.name,function(t,i){var n=new ccs.Timeline;n.setActionTag(t.actionTag);var r=t.frames;return r&&r.length&&r.forEach(function(t){var i=e.handle(t);i.setFrameIndex(t.frameIndex),i.setTween(t.tween),n.addFrame(i)}),n})}),e.registerParser("action","*",n)}(ccs._load),function(e,t){var i={},n=new(ccs._parser.extend({getNodeJson:function(e){return e.Content.Content.Animation},parseNode:function(e,t,n){if(!e)return null;if(i[n])return i[n].clone();var r=this,o=new ccs.ActionTimeline;return o.setDuration(e.Duration),o.setTimeSpeed(e.Speed||1),e.Timelines.forEach(function(e){var i,n=r.parsers[e.Property];n?i=n.call(r,e,t):cc.log("parser is not exists : %s",e.Property),i&&o.addTimeline(i)}),i[n]=o,i[n].retain(),o.clone()},deferred:function(e,t,i,n){if(cc.sys.isNative)for(var r=e.Content.Content.AnimationList,o=r?r.length:0,s=0;s<o;s++){var a=r[s],c={name:null,startIndex:null,endIndex:null};c.name=a.Name,c.startIndex=a.StartIndex,c.endIndex=a.EndIndex,i.addAnimationInfo(c)}}}));[{name:"Position",handle:function(e){var t=new ccs.PositionFrame,i=e.X,n=e.Y;return t.setPosition(cc.p(i,n)),t}},{name:"VisibleForFrame",handle:function(e){var t=new ccs.VisibleFrame,i=e.Value;return t.setVisible(i),t}},{name:"Scale",handle:function(e){var t=new ccs.ScaleFrame,i=e.X,n=e.Y;return t.setScaleX(i),t.setScaleY(n),t}},{name:"Rotation",handle:function(e){var t=new ccs.RotationFrame,i=e.Rotation;return t.setRotation(i),t}},{name:"Skew",handle:function(e){var t=new ccs.SkewFrame,i=e.X,n=e.Y;return t.setSkewX(i),t.setSkewY(n),t}},{name:"RotationSkew",handle:function(e){var t=new ccs.RotationSkewFrame,i=e.X,n=e.Y;return t.setSkewX(i),t.setSkewY(n),t}},{name:"Anchor",handle:function(e){var t=new ccs.AnchorPointFrame,i=e.X,n=e.Y;return t.setAnchorPoint(cc.p(i,n)),t}},{name:"InnerAction",handle:function(e){var t=new ccs.InnerActionFrame,i=e.InnerActionType,n=e.StartFrame;return t.setInnerActionType(i),t.setStartFrameIndex(n),t}},{name:"CColor",handle:function(e){var t=new ccs.ColorFrame,i=e.Color;return i||(i={}),i.R=i.R||255,i.G=i.G||255,i.B=i.B||255,t.setColor(cc.color(i.R,i.G,i.B)),t}},{name:"Alpha",handle:function(e){var t=new ccs.AlphaFrame,i=e.Value;return t.setAlpha(i),t}},{name:"FileData",handle:function(e,t){var i=new ccs.TextureFrame,n=e.TextureFile;if(null!=n){var r=n.Path;null==cc.spriteFrameCache.getSpriteFrame(r)&&(r=t+r),i.setTextureName(r)}return i}},{name:"FrameEvent",handle:function(e){var t=new ccs.EventFrame,i=e.Value;return null!=i&&t.setEvent(i),t}},{name:"ZOrder",handle:function(e){var t=new ccs.ZOrderFrame,i=e.Value;return t.setZOrder(i),t}},{name:"ActionValue",handle:function(e){var t=new ccs.InnerActionFrame,i=e.InnerActionType,n=e.CurrentAniamtionName,r=e.SingleFrameIndex;return t.setInnerActionType(ccs.InnerActionType[i]),t.setSingleFrameIndex(r),t.setEnterWithName(!0),t.setAnimationName(n),t}}].forEach(function(e){n.registerParser(e.name,function(t,i){var n=new ccs.Timeline;n.setActionTag(t.ActionTag);var r=t.Frames;return r&&r.length&&r.forEach(function(t){var r=e.handle(t,i);r.setFrameIndex(t.FrameIndex);var o=null==t.Tween||t.Tween;r.setTween(o),n.addFrame(r)}),n})}),e.registerParser("action","2.*",n)}(ccs._load),function(e,t){var i=new(ccs._parser.extend({getNodeJson:function(e){return e},parseNode:function(e,t){var i=this.parsers[this.getClass(e)],n=null;return i?n=i.call(this,e,t):cc.log("Can't find the parser : %s",this.getClass(e)),n},deferred:function(e,t,i,n){ccs.triggerManager.parse(e.Triggers||[]),ccs.sceneReader&&(ccs.sceneReader._node=i)},setPropertyFromJsonDict:function(e,t){var i=cc.isUndefined(t.x)?0:t.x,n=cc.isUndefined(t.y)?0:t.y;e.setPosition(i,n);var r=Boolean(cc.isUndefined(t.visible)?1:t.visible);e.setVisible(r);var o=cc.isUndefined(t.objecttag)?-1:t.objecttag;e.setTag(o);var s=cc.isUndefined(t.zorder)?0:t.zorder;e.setLocalZOrder(s);var a=cc.isUndefined(t.scalex)?1:t.scalex,c=cc.isUndefined(t.scaley)?1:t.scaley;e.setScaleX(a),e.setScaleY(c);var l=cc.isUndefined(t.rotation)?0:t.rotation;e.setRotation(l);var u=t.name||"";e.setName(u)}}));i.parseChild=function(e,t,i){for(var n=0;n<t.length;n++){var r,o=t[n];o&&(r=this.parseNode(o,i)),r&&e.addChild(r)}};var n={CCSprite:function(e,t,i){var n=new cc.Sprite;o(t.fileData,i,function(e,t){if(0==t)n.setTexture(e);else if(1==t){var i=cc.spriteFrameCache.getSpriteFrame(e);n.setSpriteFrame(i)}});var r=new ccs.ComRender(n,"CCSprite");return e.addComponent(r),r},CCTMXTiledMap:function(e,t,i){var n=null;o(t.fileData,i,function(e,t){0==t&&(n=new cc.TMXTiledMap(e))});var r=new ccs.ComRender(n,"CCTMXTiledMap");return e.addComponent(r),r},CCParticleSystemQuad:function(e,t,i){var n=null;o(t.fileData,i,function(e,t){0==t?n=new cc.ParticleSystem(e):cc.log("unknown resourcetype on CCParticleSystemQuad!"),n.setPosition(0,0)});var r=new ccs.ComRender(n,"CCParticleSystemQuad");return e.addComponent(r),r},CCArmature:function(e,t,i){var n=null;if(o(t.fileData,i,function(e,t){if(0==t){var i=cc.loader.getRes(e);i||cc.log("Please load the resource [%s] first!",e);var r=i.armature_data[0].name;ccs.armatureDataManager.addArmatureFileInfo(e),n=new ccs.Armature(r)}}),n){var r=new ccs.ComRender(n,"CCArmature");e.addComponent(r);var s=t.selectedactionname;return s&&n.getAnimation()&&n.getAnimation().play(s),r}},CCComAudio:function(e,t,i){var n=null;o(t.fileData,i,function(i,r){if(0==r){(n=new ccs.ComAudio).preloadEffect(i);var o=t.name;o&&n.setName(o),e.addComponent(n)}})},CCComAttribute:function(e,t,i){var n=null;return o(t.fileData,i,function(t,i){0==i?(n=new ccs.ComAttribute,""!=t&&n.parse(t),e.addComponent(n)):cc.log("unknown resourcetype on CCComAttribute!")}),n},CCBackgroundAudio:function(e,t,i){var n=null;o(t.fileData,i,function(i,r){if(0==r){(n=new ccs.ComAudio).preloadBackgroundMusic(i),n.setFile(i);var o=Boolean(t.loop||0);n.setLoop(o);var s=t.name;s&&n.setName(s),e.addComponent(n),n.playBackgroundMusic(i,o)}})},GUIComponent:function(e,t,i){var n=null;o(t.fileData,i,function(e,t){n=ccs._load(e,"ccui")});var r=new ccs.ComRender(n,"GUIComponent");return e.addComponent(r),r},CCScene:function(){}},r={},o=function(e,t,i){if(null!=e){var n=e.path,o=e.resourceType,s=e.plist;if(!n)return;s&&(cc.loader.getRes(t+s)?(r[t+s]=!0,cc.spriteFrameCache.addSpriteFrames(t+s)):r[t+s]||cc.log("%s need to be preloaded",t+s)),0!==o?i(n,o):i(t+n,o)}};i.parseComponents=function(e,t,i){e&&t&&t.forEach(function(t){var r=n[t.classname],o=null;r?o=r(e,t,i):cc.log("Can't find the component parser : %s",t.classname);var s=t.name;o&&s&&o.setName(s)})},i.registerParser("CCNode",function(e,t){var i=new cc.Node;this.setPropertyFromJsonDict(i,e),this.parseChild.call(this,i,e.gameobjects,t),this.parseComponents(i,e.components,t);var n=e.CanvasSize;return n&&i.setContentSize(cc.size(n._width,n._height)),i}),e.registerParser("scene","*",i)}(ccs._load),function(e,t){var i={},n=new(ccs._parser.extend({getNodeJson:function(e){return e.nodeTree},addSpriteFrame:function(e,t,n){if(e&&t&&e.length==t.length)for(var r=0;r<e.length;r++){var o=n+e[r];cc.loader.getRes(o)||i[o]?i[o]=!0:cc.log("%s need to be preloaded",o),cc.spriteFrameCache.addSpriteFrames(o,n+t[r])}},pretreatment:function(e,t,i){this.addSpriteFrame(e.textures,e.texturesPng,t)}}));n.generalAttributes=function(e,t){var i=null!=t.width?t.width:0,n=null!=t.height?t.height:0,r=null!=t.x?t.x:0,o=null!=t.y?t.y:0,s=null!=t.scaleX?t.scaleX:1,a=null!=t.scaleY?t.scaleY:1,c=null!=t.rotation?t.rotation:0,l=null!=t.rotationSkewX?t.rotationSkewX:0,u=null!=t.rotationSkewY?t.rotationSkewY:0,h=null!=t.skewX?t.skewX:0,d=null!=t.skewY?t.skewY:0,p=null!=t.anchorPointX?t.anchorPointX:.5,_=null!=t.anchorPointY?t.anchorPointY:.5,f=null!=t.opacity?t.opacity:255,m=null!=t.colorR?t.colorR:255,g=null!=t.colorG?t.colorG:255,y=null!=t.colorB?t.colorB:255,T=null!=t.colorR?t.colorR:0,v=null!=t.tag?t.tag:0,S=null!=t.actionTag?t.actionTag:0,C=null==t.visible||t.visible;0==r&&0==o||e.setPosition(cc.p(r,o)),1!=s&&e.setScaleX(s),1!=a&&e.setScaleY(a),0!=c&&e.setRotation(c),0!=l&&e.setRotationX(l),0!=u&&e.setRotationY(u),0!=h&&e.setSkewX(h),0!=d&&e.setSkewY(d),.5==p&&.5==_||e.setAnchorPoint(cc.p(p,_)),0==i&&0==n||e.setContentSize(cc.size(i,n)),0!=T&&e.setLocalZOrder(T),1!=C&&e.setVisible(C),255!=f&&e.setOpacity(f),255==m&&255==g&&255==y||e.setColor(cc.color(m,g,y)),e.setTag(v),e.setUserObject(new ccs.ActionTimelineData(S))},n.parseComponent=function(e,t){if(t)for(var i=0;i<t.length;++i){var n=t[i],r=this.loadComponent(n);r&&e.addComponent(r)}},n.parseChild=function(e,t,i,n){for(var r=i.children,o=0;o<r.length;o++){var s=this.parseNode(r[o],n);if(s)if(t instanceof ccui.PageView)s instanceof ccui.Layout&&t.addPage(s);else if(t instanceof ccui.ListView)s instanceof ccui.Widget&&t.pushBackCustomItem(s);else{if(!(t instanceof ccui.Layout)&&s instanceof ccui.Widget){if(s.getPositionType()==ccui.Widget.POSITION_PERCENT){var a=s.getPositionPercent(),c=t.getAnchorPoint();s.setPositionPercent(cc.p(a.x+c.x,a.y+c.y))}var l=t.getAnchorPointInPoints();s.setPosition(cc.p(s.getPositionX()+l.x,s.getPositionY()+l.y))}t.addChild(s)}}},n.initNode=function(e){var t=new cc.Node;return this.generalAttributes(t,e),t},n.initSubGraph=function(e){var t,i=e.fileName;return t=i&&""!=i?this.createNode(i):new ccs.Node,this.generalAttributes(t,e),t},n.initSprite=function(e,t){var i,n=e.fileName;if(null!=n){var r=cc.spriteFrameCache.getSpriteFrame(n);r?i=ccs.Sprite.createWithSpriteFrame(r):(n=t+n,i=new ccs.Sprite(n)),i||(i=new cc.Sprite,cc.log("filePath is empty. Create a sprite with no texture"))}else i=new ccs.Sprite;this.generalAttributes(i,e);var o=e.flipX,s=e.flipY;return 0!=o&&i.setFlippedX(o),0!=s&&i.setFlippedY(s),i},n.initParticle=function(e,t){var i=e.plistFile,n=e.tmxFile,r=new cc.ParticleSystemQuad(i);return r.setTotalParticles(n),this.generalAttributes(r,e),r},n.initTMXTiledMap=function(e,t){var i=e.tmxFile,n=e.tmxString,r=e.resourcePath,o=null;return i&&""!=i?o=new cc.TMXTiledMap(i):n&&""!=n&&r&&""!=r&&(o=new cc.TMXTiledMap(n,r)),o};var r=e.getParser("ccui")["*"];n.initWidget=function(e,t){var i=e.classname,n=r.parsers[i];if(!n)return cc.log("%s parser is not found",i);var o=n.call(r,e,t);if(o){var s=e.rotationSkewX,a=e.rotationSkewY,c=e.skewX,l=e.skewY;0!=s&&o.setRotationX(s),0!=a&&o.setRotationY(a),0!=c&&o.setSkewX(c),0!=l&&o.setSkewY(l);var u=e.actionTag;o.setUserObject(new ccs.ActionTimelineData(u))}return o},[{name:"Node",handle:n.initNode},{name:"SubGraph",handle:n.initSubGraph},{name:"Sprite",handle:n.initSprite},{name:"Particle",handle:n.initParticle},{name:"TMXTiledMap",handle:n.initTMXTiledMap},{name:"Widget",handle:n.initWidget},{name:"Panel",handle:n.initWidget},{name:"Button",handle:n.initWidget},{name:"CheckBox",handle:n.initWidget},{name:"ImageView",handle:n.initWidget},{name:"LabelAtlas",handle:n.initWidget},{name:"LabelBMFont",handle:n.initWidget},{name:"Label",handle:n.initWidget},{name:"ListView",handle:n.initWidget},{name:"LoadingBar",handle:n.initWidget},{name:"PageView",handle:n.initWidget},{name:"ScrollView",handle:n.initWidget},{name:"Slider",handle:n.initWidget},{name:"TextField",handle:n.initWidget}].forEach(function(e){n.registerParser(e.name,function(t,i,n){var r=e.handle.call(this,t.options);return this.parseComponent(r,t.components),this.parseChild(i,r,t,n),r})}),e.registerParser("timeline","*",n)}(ccs._load),function(e,t){var i=new(ccs._parser.extend({parse:function(e,t){var i=this._dirname(e);this.pretreatment(t,i,e);var n=this.parseNode(this.getNodeJson(t),i);return this.deferred(t,i,n,e),n},getNodeJson:function(e){return e.Content.Content.ObjectData},getClass:function(e){return e.ctype}})),n=function(e,t){return void 0===e?t:e};i.generalAttributes=function(e,t){null!=t.Name&&e.setName(t.Name);var i=t.Position;null==i||null==i.X&&null==i.Y||e.setPosition(cc.p(i.X||0,i.Y||0));var r=t.Scale;null!=r&&(null!=r.ScaleX&&e.setScaleX(r.ScaleX),null!=r.ScaleY&&e.setScaleY(r.ScaleY));var o=t.RotationSkewX;null!=o&&e.setRotationX(o);var s=t.RotationSkewY;null!=t.RotationSkewY&&e.setRotationY(s);var a=t.AnchorPoint;null!=a&&(null==a.ScaleX&&(a.ScaleX=0),null==a.ScaleY&&(a.ScaleY=0),.5==a.ScaleX&&.5==a.ScaleY||e.setAnchorPoint(cc.p(a.ScaleX,a.ScaleY))),null!=t.ZOrder&&e.setLocalZOrder(t.ZOrder);var l=n(t.VisibleForFrame,!0);e.setVisible(l),c(e,t.Size),null!=t.Alpha&&e.setOpacity(t.Alpha),e.setTag(t.Tag||0),e.setUserObject(new ccs.ActionTimelineData(t.ActionTag||0)),e.setCascadeColorEnabled(!0),e.setCascadeOpacityEnabled(!0)},i.parseChild=function(e,t,i){if(e&&t)for(var n=0;n<t.length;n++){var r=this.parseNode(t[n],i);if(r)if(e instanceof ccui.PageView)r instanceof ccui.Layout&&e.addPage(r);else if(e instanceof ccui.ListView)r instanceof ccui.Widget&&e.pushBackCustomItem(r);else{if(!(e instanceof ccui.Layout)&&r instanceof ccui.Widget){if(r.getPositionType()==ccui.Widget.POSITION_PERCENT){var o=r.getPositionPercent(),s=e.getAnchorPoint();r.setPositionPercent(cc.p(o.x+s.x,o.y+s.y))}var a=e.getAnchorPointInPoints();r.setPosition(cc.p(r.getPositionX()+a.x,r.getPositionY()+a.y))}e.addChild(r)}}},i.initSingleNode=function(e){var t=new cc.Node;return this.generalAttributes(t,e),t},i.initSprite=function(e,t){var i=new cc.Sprite;s(e.FileData,t,function(e,t){if(0==t)i.setTexture(e);else if(1==t){var n=cc.spriteFrameCache.getSpriteFrame(e);i.setSpriteFrame(n)}}),e.FlipX&&i.setFlippedX(!0),e.FlipY&&i.setFlippedY(!0),this.generalAttributes(i,e);var n=e.CColor;return null!=n&&i.setColor(a(n)),i},i.initParticle=function(e,t){var i,n=this;return s(e.FileData,t,function(t,r){cc.loader.getRes(t)||cc.log("%s need to be preloaded",t),i=new cc.ParticleSystem(t),n.generalAttributes(i,e),!cc.sys.isNative&&i.setDrawMode(cc.ParticleSystem.TEXTURE_MODE)}),i},i.widgetAttributes=function(e,t){e.setCascadeColorEnabled(!0),e.setCascadeOpacityEnabled(!0),e.setUnifySizeEnabled(!1),e.ignoreContentAdaptWithSize(!1),c(e,t.Size);var i=t.Name;i&&e.setName(i);var r=t.ActionTag||0;e.setActionTag(r),e.setUserObject(new ccs.ActionTimelineData(r));var o=t.RotationSkewX;o&&e.setRotationX(o);var s=t.RotationSkewY;s&&e.setRotationY(s),t.FlipX&&e.setFlippedX(!0),t.FlipY&&e.setFlippedY(!0);var l=t.zOrder;null!=l&&e.setLocalZOrder(l);var u=n(t.VisibleForFrame,!0);e.setVisible(u);var h=t.Alpha;null!=h&&e.setOpacity(h),e.setTag(t.Tag||0);var d=t.TouchEnable||!1;e.setTouchEnabled(d);var p=t.CallBackType;null!=p&&e.setCallbackType(p);var _=t.CallBackName;_&&e.setCallbackName(_);var f=t.Position;null!=f&&e.setPosition(f.X||0,f.Y||0);var m=t.Scale;if(null!=m){var g=n(m.ScaleX,1),y=n(m.ScaleY,1);e.setScaleX(g),e.setScaleY(y)}var T=t.AnchorPoint;null!=T&&e.setAnchorPoint(T.ScaleX||0,T.ScaleY||0);var v=t.CColor;if(null!=v&&e.setColor(a(v)),e instanceof ccui.Layout){var S=ccui.LayoutComponent.bindLayoutComponent(e),C=t.PositionPercentXEnable||!1,E=t.PositionPercentYEnable||!1,b=0,A=0,x=t.PrePosition;null!=x&&(b=x.X||0,A=x.Y||0);var R=t.PercentWidthEnable||!1,P=t.PercentHeightEnable||!1,I=0,w=0,N=t.PreSize;null!=x&&(I=N.X||0,w=N.Y||0);var L=t.StretchWidthEnable||!1,O=t.StretchHeightEnable||!1,D=t.HorizontalEdge,F=t.VerticalEdge,B=t.LeftMargin||0,M=t.RightMargin||0,k=t.TopMargin||0,W=t.BottomMargin||0;S.setPositionPercentXEnabled(C),S.setPositionPercentYEnabled(E),S.setPositionPercentX(b),S.setPositionPercentY(A),S.setPercentWidthEnabled(R),S.setPercentHeightEnabled(P),S.setPercentWidth(I),S.setPercentHeight(w),S.setStretchWidthEnabled(L),S.setStretchHeightEnabled(O);var V=ccui.LayoutComponent.horizontalEdge.NONE;"LeftEdge"==D?V=ccui.LayoutComponent.horizontalEdge.LEFT:"RightEdge"==D?V=ccui.LayoutComponent.horizontalEdge.RIGHT:"BothEdge"==D&&(V=ccui.LayoutComponent.horizontalEdge.CENTER),S.setHorizontalEdge(V);var z=ccui.LayoutComponent.verticalEdge.NONE;"TopEdge"==F?z=ccui.LayoutComponent.verticalEdge.TOP:"BottomEdge"==F?z=ccui.LayoutComponent.verticalEdge.BOTTOM:"BothEdge"==F&&(z=ccui.LayoutComponent.verticalEdge.CENTER),S.setVerticalEdge(z),S.setTopMargin(k),S.setBottomMargin(W),S.setLeftMargin(B),S.setRightMargin(M)}},i.initPanel=function(e,t){var i=new ccui.Layout;this.widgetAttributes(i,e);var r=e.ClipAble;null!=r&&i.setClippingEnabled(r);var o=n(e.ComboBoxIndex,0);i.setBackGroundColorType(o);var l=n(e.BackColorAlpha,255);null!=l&&i.setBackGroundColorOpacity(l);var u=e.Scale9Enable;null!=u&&i.setBackGroundImageScale9Enabled(u);var h=n(e.Alpha,255);if(i.setOpacity(h),s(e.FileData,t,function(e,t){i.setBackGroundImage(e,t)}),u){var d=e.Scale9OriginX||0,p=e.Scale9OriginY||0,_=e.Scale9Width||0,f=e.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(d,p,_,f)),c(i,e.Size)}else i.isIgnoreContentAdaptWithSize()||c(i,e.Size);var m=e.FirstColor,g=e.EndColor;if(null!=m&&null!=g){var y=a(m);null==g.R&&null==g.G&&null==g.B?i.setBackGroundColor(y):i.setBackGroundColor(y,a(g))}var T=e.ColorVector;return null!=T&&i.setBackGroundColorVector(cc.p(T.ScaleX,T.ScaleY)),i},i.initText=function(e,t){var i=new ccui.Text;this.widgetAttributes(i,e);var n=e.TouchScaleChangeAble;null!=n&&i.setTouchScaleChangeEnabled(n);var r=e.LabelText;null!=r&&i.setString(r);var o=e.FontSize;null!=o&&i.setFontSize(o);var s=e.FontName;null!=s&&i.setFontName(s);var a=e.AreaWidth,l=e.areaHeight;a&&l&&i.setTextAreaSize(cc.size(a,l));var u=e.HorizontalAlignmentType||"HT_Left";switch(u){case"HT_Right":u=2;break;case"HT_Center":u=1;break;case"HT_Left":default:u=0}i.setTextHorizontalAlignment(u);var h=e.VerticalAlignmentType||"VT_Top";switch(h){case"VT_Bottom":h=2;break;case"VT_Center":h=1;break;case"VT_Top":default:h=0}i.setTextVerticalAlignment(h);var d=e.IsCustomSize;null!=d&&i.ignoreContentAdaptWithSize(!d);var p=e.FontResource;if(null!=p){var _=p.Path;null!=_&&(s=cc.sys.isNative?cc.path.join(cc.loader.resPath,t,_):(s=_.match(/([^\/]+)\.ttf/))?s[1]:"",i.setFontName(s))}return i.setUnifySizeEnabled(!1),i.isIgnoreContentAdaptWithSize()&&c(i,e.Size),i},i.initButton=function(e,t){var i=new ccui.Button;s(e.NormalFileData,t,function(e,t){i.loadTextureNormal(e,t)}),s(e.PressedFileData,t,function(e,t){i.loadTexturePressed(e,t)}),s(e.DisabledFileData,t,function(e,t){i.loadTextureDisabled(e,t)});var r=n(e.Scale9Enable,!1);r&&i.setScale9Enabled(r);var o=e.ButtonText;null!=o&&i.setTitleText(o);var l=e.FontSize;null!=l&&i.setTitleFontSize(l);var u=e.FontName;null!=u&&i.setTitleFontName(u);var h=e.TextColor;null!=h&&i.setTitleColor(a(h));var d=n(e.DisplayState,!0);i.setBright(d),i.setEnabled(d);var p=e.FontResource;if(null!=p){var _=p.Path;null!=_&&(u=cc.sys.isNative?cc.path.join(cc.loader.resPath,t,_):(u=_.match(/([^\/]+)\.ttf/))?u[1]:"",i.setTitleFontName(u))}if(this.widgetAttributes(i,e),r){i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1);var f=cc.rect(e.Scale9OriginX||0,e.Scale9OriginY||0,e.Scale9Width||0,e.Scale9Height||0);i.setCapInsets(f)}return c(i,e.Size),i},i.initCheckBox=function(e,t){var i=new ccui.CheckBox;this.widgetAttributes(i,e),[{name:"NormalBackFileData",handle:i.loadTextureBackGround},{name:"PressedBackFileData",handle:i.loadTextureBackGroundSelected},{name:"NodeNormalFileData",handle:i.loadTextureFrontCross},{name:"DisableBackFileData",handle:i.loadTextureBackGroundDisabled},{name:"NodeDisableFileData",handle:i.loadTextureFrontCrossDisabled}].forEach(function(n){s(e[n.name],t,function(e,t){n.handle.call(i,e,t)})});var r=n(e.CheckedState,!1);i.setSelected(r);var o=n(e.DisplayState,!0);return i.setBright(o),i.setEnabled(o),i},i.initScrollView=function(e,t){var i=new ccui.ScrollView;this.widgetAttributes(i,e);var r=e.ClipAble;i.setClippingEnabled(r);var o=n(e.ComboBoxIndex,0);i.setBackGroundColorType(o);var l=e.BackColorAlpha;if(null!=l&&i.setBackGroundColorOpacity(l),e.Scale9Enable){i.setBackGroundImageScale9Enabled(!0);var u=e.Scale9OriginX||0,h=e.Scale9OriginY||0,d=e.Scale9Width||0,p=e.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(u,h,d,p)),c(i,e.Size)}else i.isIgnoreContentAdaptWithSize()||c(i,e.Size);var _=e.FirstColor,f=e.EndColor;_&&f?null!=f.R&&null!=f.G&&null!=f.B?i.setBackGroundColor(a(_),a(f)):i.setBackGroundColor(a(_)):i.setBackGroundColor(a(e.SingleColor));var m=e.ColorVector;if(m){var g=n(m.ScaleX,1),y=n(m.ScaleY,1);i.setBackGroundColorVector(cc.p(g,y))}s(e.FileData,t,function(e,t){i.setBackGroundImage(e,t)});var T=e.InnerNodeSize,v=cc.size(T.Width||0,T.Height||0);i.setInnerContainerSize(v);var S=0;"Vertical"==e.ScrollDirectionType&&(S=1),"Horizontal"==e.ScrollDirectionType&&(S=2),"Vertical_Horizontal"==e.ScrollDirectionType&&(S=3),i.setDirection(S);var C=n(e.IsBounceEnabled,!1);return i.setBounceEnabled(C),i},i.initImageView=function(e,t){var i=new ccui.ImageView;if(s(e.FileData,t,function(e,t){i.loadTexture(e,t)}),s(e.ImageFileData,t,function(e,t){i.loadTexture(e,t)}),e.Scale9Enable){i.setScale9Enabled(!0),i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1);var n=e.Scale9OriginX||0,r=e.Scale9OriginY||0,o=e.Scale9Width||0,a=e.Scale9Height||0;i.setCapInsets(cc.rect(n,r,o,a))}else c(i,e.Size);return this.widgetAttributes(i,e),i},i.initLoadingBar=function(e,t){var i=new ccui.LoadingBar;this.widgetAttributes(i,e),s(e.ImageFileData,t,function(e,t){i.loadTexture(e,t)});var r="Right_To_Left"===e.ProgressType?1:0;i.setDirection(r);var o=n(e.ProgressInfo,80);return null!=o&&i.setPercent(o),i},i.initSlider=function(e,t){var i=new ccui.Slider,r=cc.loader;this.widgetAttributes(i,e),[{name:"BackGroundData",handle:i.loadBarTexture},{name:"BallNormalData",handle:i.loadSlidBallTextureNormal},{name:"BallPressedData",handle:i.loadSlidBallTexturePressed},{name:"BallDisabledData",handle:i.loadSlidBallTextureDisabled},{name:"ProgressBarData",handle:i.loadProgressBarTexture}].forEach(function(n){s(e[n.name],t,function(e,t){0!=t||r.getRes(e)||cc.log("%s need to be preloaded",e),n.handle.call(i,e,t)})});var o=e.PercentInfo||0;i.setPercent(o);var a=n(e.DisplayState,!0);return i.setBright(a),i.setEnabled(a),i},i.initPageView=function(e,t){var i=new ccui.PageView;this.widgetAttributes(i,e);var r=e.ClipAble||!1;if(i.setClippingEnabled(r),e.Scale9Enable){i.setBackGroundImageScale9Enabled(!0);var o=e.Scale9OriginX||0,l=e.Scale9OriginY||0,u=e.Scale9Width||0,h=e.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(o,l,u,h))}var d=n(e.ComboBoxIndex,0);i.setBackGroundColorType(d);var p=e.BackColorAlpha,_=e.FirstColor,f=e.EndColor;_&&f?null!=f.R&&null!=f.G&&null!=f.B?i.setBackGroundColor(a(_),a(f)):i.setBackGroundColor(a(_)):i.setBackGroundColor(a(e.SingleColor));var m=e.ColorVector;return null!=m&&null!=m.ScaleX&&null!=m.ScaleY&&i.setBackGroundColorVector(cc.p(m.ScaleX,m.ScaleY)),null!=p&&i.setBackGroundColorOpacity(p),s(e.FileData,t,function(e,t){i.setBackGroundImage(e,t)}),c(i,e.Size),i},i.initListView=function(e,t){var i=new ccui.ListView;this.widgetAttributes(i,e);var r=e.ClipAble||!1;i.setClippingEnabled(r);var o=n(e.ComboBoxIndex,0);i.setBackGroundColorType(o);var l=n(e.BackColorAlpha,255);if(e.Scale9Enable){i.setBackGroundImageScale9Enabled(!0);var u=e.Scale9OriginX||0,h=e.Scale9OriginY||0,d=e.Scale9Width||0,p=e.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(u,h,d,p))}var _=n(e.DirectionType,ccui.ListView.DIR_HORIZONTAL),f=n(e.VerticalType,"Align_Left"),m=n(e.HorizontalType,"Align_Top");_?"Vertical"==_&&(i.setDirection(ccui.ScrollView.DIR_VERTICAL),""==m?i.setGravity(ccui.ListView.GRAVITY_LEFT):"Align_Right"==m?i.setGravity(ccui.ListView.GRAVITY_RIGHT):"Align_HorizontalCenter"==m&&i.setGravity(ccui.ListView.GRAVITY_CENTER_HORIZONTAL)):(i.setDirection(ccui.ScrollView.DIR_HORIZONTAL),"Align_Bottom"==f?i.setGravity(ccui.ListView.GRAVITY_BOTTOM):"Align_VerticalCenter"==f?i.setGravity(ccui.ListView.GRAVITY_CENTER_VERTICAL):i.setGravity(ccui.ListView.GRAVITY_TOP));var g=n(e.IsBounceEnabled,!1);i.setBounceEnabled(g);var y=e.ItemMargin||0;i.setItemsMargin(y);var T=e.InnerNodeSize;null!=T&&i.setInnerContainerSize(cc.size(T.Widget||0,T.Height||0));var v=e.FirstColor,S=e.EndColor;v&&S?null!=S.R&&null!=S.G&&null!=S.B?i.setBackGroundColor(a(v),a(S)):i.setBackGroundColor(a(v)):i.setBackGroundColor(a(e.SingleColor));var C=e.ColorVector;return null!=C&&null!=C.ScaleX&&null!=C.ScaleY&&i.setBackGroundColorVector(cc.p(C.ScaleX,C.ScaleY)),null!=l&&i.setBackGroundColorOpacity(l),s(e.FileData,t,function(e,t){i.setBackGroundImage(e,t)}),c(i,e.Size),i},i.initTextAtlas=function(e,t){var i=new ccui.TextAtlas,n=e.LabelText,r=e.CharWidth,o=e.CharHeight,a=e.StartChar;return s(e.LabelAtlasFileImage_CNB,t,function(e,t){cc.loader.getRes(e)||cc.log("%s need to be preloaded",e),0==t&&i.setProperty(n,e,r,o,a)}),this.widgetAttributes(i,e),i},i.initTextBMFont=function(e,t){var i=new ccui.TextBMFont;this.widgetAttributes(i,e);var n=e.LabelText;return i.setString(n),s(e.LabelBMFontFile_CNB,t,function(e,t){cc.loader.getRes(e)||cc.log("%s need to be pre loaded",e),i.setFntFile(e)}),i},i.initTextField=function(e,t){var i=new ccui.TextField;if(e.PasswordEnable){i.setPasswordEnabled(!0);var n=e.PasswordStyleText||"*";i.setPasswordStyleText(n)}var r=e.PlaceHolderText;null!=r&&i.setPlaceHolder(r);var o=e.FontSize;null!=o&&i.setFontSize(o);var s=e.FontName;if(null!=s&&i.setFontName(s),e.MaxLengthEnable){i.setMaxLengthEnabled(!0);var l=e.MaxLengthText||0;i.setMaxLength(l)}this.widgetAttributes(i,e);var u=e.LabelText;null!=u&&i.setString(u);var h=e.FontResource;if(null!=h){var d=h.Path;null!=d&&(s=cc.sys.isNative?cc.path.join(cc.loader.resPath,t,d):(s=d.match(/([^\/]+)\.ttf/))?s[1]:"",i.setFontName(s))}i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1);var p=e.CColor;return null!=p&&i.setTextColor(a(p)),i.isIgnoreContentAdaptWithSize()||(c(i,e.Size),cc.sys.isNative&&i.getVirtualRenderer().setLineBreakWithoutSpace(!0)),i},i.initSimpleAudio=function(e,t){var i=e.Loop||!1,n=e.Volume||0;cc.audioEngine.setMusicVolume(n);var r="";cc.loader.resPath&&(r=(cc.loader.resPath+"/").replace(/\/\/$/,"/")),s(e.FileData,t,function(e,t){cc.loader.load(e,function(){cc.audioEngine.playMusic(r+e,i)})})},i.initGameMap=function(e,t){var n=null;return s(e.FileData,t,function(t,r){0==r&&(n=new cc.TMXTiledMap(t)),i.generalAttributes(n,e)}),n},i.initProjectNode=function(e,t){var n=e.FileData;if(null!=n&&n.Path){var r=t+n.Path;if(cc.loader.getRes(r)){var o=ccs.load(r);return i.generalAttributes(o.node,e),o.action&&o.node&&(o.action.tag=o.node.tag,o.node.runAction(o.action),o.action.gotoFrameAndPause(0)),o.node}cc.log("%s need to be preloaded",r)}};var r=function(e){if(!e)return"";var t=e.match(/([^\/]+)\.[^\/]+$/);return t&&t[1]?t[1]:""};i.initArmature=function(e,t){var n=new ccs.Armature,o=e.IsLoop,a=e.IsAutoPlay,c=e.CurrentAnimationName;return i.generalAttributes(n,e),s(e.FileData,t,function(e,t){var i,s,l=cc.loader.getRes(e);l?(i=l.config_file_path,s=l.config_png_path,i.forEach(function(e,t){s[t]&&cc.spriteFrameCache.addSpriteFrames(e,s[t])})):cc.log("%s need to be preloaded",e),ccs.armatureDataManager.addArmatureFileInfo(e),n.init(r(e)),a&&n.getAnimation().play(c,-1,o)}),n};var o={},s=function(e,t,i){if(null!=e){var n,r=e.Path;n="Default"==e.Type||"Normal"==e.Type?0:1;var s=e.Plist;s&&(cc.loader.getRes(t+s)?(o[t+s]=!0,cc.spriteFrameCache.addSpriteFrames(t+s)):o[t+s]||cc.log("%s need to be preloaded",t+s)),0!==n?i(r,n):i(t+r,n)}},a=function(e){if(e){var t=null!=e.R?e.R:255,i=null!=e.G?e.G:255,n=null!=e.B?e.B:255;return cc.color(t,i,n)}},c=function(e,t){var i=t.X||0,n=t.Y||0;t&&e.setContentSize(cc.size(i,n))};[{name:"SingleNodeObjectData",handle:i.initSingleNode},{name:"LayerObjectData",handle:i.initSingleNode},{name:"SpriteObjectData",handle:i.initSprite},{name:"ParticleObjectData",handle:i.initParticle},{name:"PanelObjectData",handle:i.initPanel},{name:"TextObjectData",handle:i.initText},{name:"ButtonObjectData",handle:i.initButton},{name:"CheckBoxObjectData",handle:i.initCheckBox},{name:"ScrollViewObjectData",handle:i.initScrollView},{name:"ImageViewObjectData",handle:i.initImageView},{name:"LoadingBarObjectData",handle:i.initLoadingBar},{name:"SliderObjectData",handle:i.initSlider},{name:"PageViewObjectData",handle:i.initPageView},{name:"ListViewObjectData",handle:i.initListView},{name:"TextAtlasObjectData",handle:i.initTextAtlas},{name:"TextBMFontObjectData",handle:i.initTextBMFont},{name:"TextFieldObjectData",handle:i.initTextField},{name:"SimpleAudioObjectData",handle:i.initSimpleAudio},{name:"GameMapObjectData",handle:i.initGameMap},{name:"ProjectNodeObjectData",handle:i.initProjectNode},{name:"ArmatureNodeObjectData",handle:i.initArmature}].forEach(function(e){i.registerParser(e.name,function(t,i){var n=e.handle.call(this,t,i);return this.parseChild(n,t.Children,i),n})}),e.registerParser("timeline","2.*",i)}(ccs._load),function(e,t){var i=new(ccs._parser.extend({addSpriteFrame:function(e,t){if(e)for(var i=0;i<e.length;i++)cc.spriteFrameCache.addSpriteFrames(t+e[i])},pretreatment:function(e,t){this.addSpriteFrame(e.textures,t)},deferred:function(e,t,i,n){i&&(ccs.actionManager.initWithDictionary(n,e.animation,i),i.setContentSize(cc.size(e.designWidth,e.designHeight)))}}));i.generalAttributes=function(e,t){var i=t.ignoreSize;null!=i&&e.ignoreContentAdaptWithSize(i),t.sizeType&&e.setSizeType(t.sizeType),t.positionType&&e.setPositionType(t.positionType),e.setSizePercent(cc.p(t.sizePercentX,t.sizePercentY)),e.setPositionPercent(cc.p(t.positionPercentX,t.positionPercentY));var n=0,r=0;if(t.adaptScreen){var o=cc.director.getWinSize();n=o.width,r=o.height}else n=t.width,r=t.height;e.setContentSize(n,r),e.setTag(t.tag),e.setActionTag(t.actiontag),e.setTouchEnabled(t.touchAble);var s=t.name,a=s||"default";e.setName(a);var c=t.x,l=t.y;e.setPosition(c,l);var u=null!=t.scaleX?t.scaleX:1;e.setScaleX(u);var h=null!=t.scaleY?t.scaleY:1;e.setScaleY(h);var d=t.rotation||0;e.setRotation(d);var p=t.visible||!1;if(null!=p&&e.setVisible(p),e.setLocalZOrder(t.ZOrder),null!=t.layoutParameter){var _=t.layoutParameter,f=null;switch(_.type){case 0:break;case 1:f=new ccui.LinearLayoutParameter;var m=_.gravity;f.setGravity(m);break;case 2:var g=f=new ccui.RelativeLayoutParameter,y=_.relativeName;g.setRelativeName(y);var T=_.relativeToName;g.setRelativeToWidgetName(T);var v=_.align;g.setAlign(v)}if(null!=f){var S=_.marginLeft||0,C=_.marginTop||0,E=_.marginRight||0,b=_.marginDown||0;f.setMargin(S,C,E,b),e.setLayoutParameter(f)}}},i.colorAttributes=function(e,t){var i=t.opacity;null!=i&&e.setOpacity(i);var n=t.colorR,r=t.colorG,o=t.colorB;e.setColor(cc.color(null==n?255:n,null==r?255:r,null==o?255:o)),e.setFlippedX(t.flipX),e.setFlippedY(t.flipY)},i.anchorPointAttributes=function(e,t){var i,n=t.anchorPointX;i=null!=n?t.anchorPointX:e.getAnchorPoint().x;var r,o=t.anchorPointY;r=null!=o?t.anchorPointY:e.getAnchorPoint().y,null==n&&null==o||e.setAnchorPoint(cc.p(i,r))},i.parseChild=function(e,t,i){for(var n=t.children,r=0;r<n.length;r++){var o=this.parseNode(n[r],i);if(o)if(e instanceof ccui.PageView)e.addPage(o);else if(e instanceof ccui.ListView)e.pushBackCustomItem(o);else{if(!(e instanceof ccui.Layout)){if(o.getPositionType()==ccui.Widget.POSITION_PERCENT){var s=o.getPositionPercent(),a=e.getAnchorPoint();o.setPositionPercent(cc.p(s.x+a.x,s.y+a.y))}var c=e.getAnchorPointInPoints();o.setPosition(cc.p(o.getPositionX()+c.x,o.getPositionY()+c.y))}e.addChild(o)}}};var n=function(e,t,i,n){i&&(0==t?n(e+i,t):n(i,t))};i.LayoutAttributes=function(e,t,i){var r=0,o=0;if(t.adaptScreen){var s=cc.director.getWinSize();r=s.width,o=s.height}else r=t.width,o=t.height;e.setSize(cc.size(r,o)),e.setClippingEnabled(t.clipAble);var a=t.backGroundScale9Enable;e.setBackGroundImageScale9Enabled(a);var c=t.bgColorR,l=t.bgColorG,u=t.bgColorB,h=t.bgStartColorR,d=t.bgStartColorG,p=t.bgStartColorB,_=t.bgEndColorR,f=t.bgEndColorG,m=t.bgEndColorB,g=t.vectorX,y=t.vectorY;e.setBackGroundColorVector(cc.p(g,y));var T=t.bgColorOpacity,v=t.colorType;e.setBackGroundColorType(v),e.setBackGroundColor(cc.color(h,d,p),cc.color(_,f,m)),e.setBackGroundColor(cc.color(c,l,u)),e.setBackGroundColorOpacity(T);var S=t.backGroundImageData;if(S&&n(i,S.resourceType,S.path,function(t,i){e.setBackGroundImage(t,i)}),a){var C=t.capInsetsX,E=t.capInsetsY,b=t.capInsetsWidth,A=t.capInsetsHeight;e.setBackGroundImageCapInsets(cc.rect(C,E,b,A))}t.layoutType&&e.setLayoutType(t.layoutType)},i.ButtonAttributes=function(e,t,i){var r=e,o=t.scale9Enable;r.setScale9Enabled(o);var s=t.normalData;n(i,s.resourceType,s.path,function(e,t){r.loadTextureNormal(e,t)});var a=t.pressedData;n(i,a.resourceType,a.path,function(e,t){r.loadTexturePressed(e,t)});var c=t.disabledData;if(n(i,c.resourceType,c.path,function(e,t){r.loadTextureDisabled(e,t)}),o){var l=t.capInsetsX,u=t.capInsetsY,h=t.capInsetsWidth,d=t.capInsetsHeight;r.setCapInsets(cc.rect(l,u,h,d));var p=t.scale9Width,_=t.scale9Height;null!=p&&null!=_&&r.setSize(cc.size(p,_))}var f=t.text;null!=f&&r.setTitleText(f);var m=t.textColorR,g=t.textColorG,y=t.textColorB,T=null!==m?t.textColorR:255,v=null!==g?t.textColorG:255,S=null!==y?t.textColorB:255;r.setTitleColor(cc.color(T,v,S)),null!=t.fontSize&&r.setTitleFontSize(t.fontSize),t.fontName&&r.setTitleFontName(t.fontName)},i.CheckBoxAttributes=function(e,t,i){var r=t.backGroundBoxData;n(i,r.resourceType,r.path,function(t,i){e.loadTextureBackGround(t,i)});var o=t.backGroundBoxSelectedData;n(i,o.resourceType||r.resourceType,o.path||r.path,function(t,i){e.loadTextureBackGroundSelected(t,i)});var s=t.frontCrossData;n(i,s.resourceType,s.path,function(t,i){e.loadTextureFrontCross(t,i)});var a=t.backGroundBoxDisabledData;n(i,a.resourceType||s.resourceType,a.path||s.path,function(t,i){e.loadTextureBackGroundDisabled(t,i)});var c=t.frontCrossDisabledData;n(i,c.resourceType,c.path,function(t,i){e.loadTextureFrontCrossDisabled(t,i)}),t.selectedState&&e.setSelected(t.selectedState)},i.ImageViewAttributes=function(e,t,i){var r=t.fileNameData;n(i,r.resourceType,r.path,function(t,i){e.loadTexture(t,i)});var o=!1;if(t.scale9Enable&&(o=t.scale9Enable),e.setScale9Enabled(o),o){var s=t.scale9Width,a=t.scale9Height;if(s&&a){var c=t.scale9Width,l=t.scale9Height;e.setSize(cc.size(c,l))}var u=t.capInsetsX,h=t.capInsetsY,d=t.capInsetsWidth,p=t.capInsetsHeight;e.setCapInsets(cc.rect(u,h,d,p))}},i.TextAtlasAttributes=function(e,t,i){var n=t.stringValue,r=t.charMapFileData,o=t.itemWidth,s=t.itemHeight,a=t.startCharMap;if(null!=n&&r&&null!=o&&null!=s&&null!=a){var c=t.charMapFileData;switch(c.resourceType){case 0:var l=i+c.path;e.setProperty(n,l,o,s,a);break;case 1:cc.log("Wrong res type of LabelAtlas!")}}},i.TextBMFontAttributes=function(e,t,i){var n=t.fileNameData;switch(n.resourceType){case 0:var r=i+n.path;e.setFntFile(r);break;case 1:cc.log("Wrong res type of LabelAtlas!")}var o=t.text;e.setString(o)},i.TextAttributes=function(e,t,i){var n=t.touchScaleEnable;e.setTouchScaleChangeEnabled(n);var r=t.text;e.setString(r),null!=t.fontSize&&e.setFontSize(t.fontSize),null!=t.fontName&&e.setFontName(t.fontName);var o=t.areaWidth,s=t.areaHeight;if(null!=o&&null!=s){var a=cc.size(t.areaWidth,t.areaHeight);e.setTextAreaSize(a)}null!=t.hAlignment&&e.setTextHorizontalAlignment(t.hAlignment),null!=t.vAlignment&&e.setTextVerticalAlignment(t.vAlignment)},i.ListViewAttributes=function(e,t,n){i.ScrollViewAttributes(e,t,n);var r=t.direction;e.setDirection(r);var o=t.gravity;e.setGravity(o);var s=t.itemMargin;e.setItemsMargin(s)},i.LoadingBarAttributes=function(e,t,i){var r=t.textureData;n(i,r.resourceType,r.path,function(t,i){e.loadTexture(t,i)});var o=t.scale9Enable;if(e.setScale9Enabled(o),o){var s=t.capInsetsX,a=t.capInsetsY,c=t.capInsetsWidth,l=t.capInsetsHeight;e.setCapInsets(cc.rect(s,a,c,l));var u=t.width,h=t.height;e.setSize(cc.size(u,h))}e.setDirection(t.direction),e.setPercent(t.percent)},i.PageViewAttributes=i.LayoutAttributes,i.ScrollViewAttributes=function(e,t,n){i.LayoutAttributes(e,t,n);var r=null!=t.innerWidth?t.innerWidth:200,o=null!=t.innerHeight?t.innerHeight:200;e.setInnerContainerSize(cc.size(r,o));var s=null!=t.direction?t.direction:1;e.setDirection(s),e.setBounceEnabled(t.bounceEnable)},i.SliderAttributes=function(e,t,i){var r=e,o=t.scale9Enable;r.setScale9Enabled(o);var s=t.barFileName,a=t.length,c=t.barFileNameData,l=c.resourceType,u=c.path;null!=s?o&&(n(i,l,u,function(e,t){r.loadBarTexture(e,t)}),r.setSize(cc.size(a,r.getContentSize().height))):n(i,l,u,function(e,t){r.loadBarTexture(e,t)});var h=t.ballNormalData;n(i,h.resourceType,h.path,function(e,t){r.loadSlidBallTextureNormal(e,t)});var d=t.ballPressedData;n(i,d.resourceType||h.resourceType,d.path||h.path,function(e,t){r.loadSlidBallTexturePressed(e,t)});var p=t.ballDisabledData;n(i,p.resourceType,p.path,function(e,t){r.loadSlidBallTextureDisabled(e,t)});var _=t.progressBarData;n(i,_.resourceType,_.path,function(e,t){r.loadProgressBarTexture(e,t)})},i.TextFieldAttributes=function(e,t,i){var n=t.placeHolder;n&&e.setPlaceHolder(n),e.setString(t.text||"");var r=t.fontSize1;r&&e.setFontSize(r);var o=t.fontName;o&&e.setFontName(o);var s=t.touchSizeWidth,a=t.touchSizeHeight;null!=s&&null!=a&&e.setTouchSize(s,a);t.width,t.height;var c=t.maxLengthEnable;if(e.setMaxLengthEnabled(c),c){var l=t.maxLength;e.setMaxLength(l)}var u=t.passwordEnable;e.setPasswordEnabled(u),u&&e.setPasswordStyleText(t.passwordStyleText);var h=t.areaWidth,d=t.areaHeight;if(h&&d){var p=cc.size(h,d);e.setTextAreaSize(p)}var _=t.hAlignment;_&&e.setTextHorizontalAlignment(_);var f=t.vAlignment;f&&e.setTextVerticalAlignment(f)},[{name:"Panel",object:ccui.Layout,handle:i.LayoutAttributes},{name:"Button",object:ccui.Button,handle:i.ButtonAttributes},{name:"CheckBox",object:ccui.CheckBox,handle:i.CheckBoxAttributes},{name:"ImageView",object:ccui.ImageView,handle:i.ImageViewAttributes},{name:"LabelAtlas",object:ccui.TextAtlas,handle:i.TextAtlasAttributes},{name:"LabelBMFont",object:ccui.TextBMFont,handle:i.TextBMFontAttributes},{name:"Label",object:ccui.Text,handle:i.TextAttributes},{name:"ListView",object:ccui.ListView,handle:i.ListViewAttributes},{name:"LoadingBar",object:ccui.LoadingBar,handle:i.LoadingBarAttributes},{name:"PageView",object:ccui.PageView,handle:i.PageViewAttributes},{name:"ScrollView",object:ccui.ScrollView,handle:i.ScrollViewAttributes},{name:"Slider",object:ccui.Slider,handle:i.SliderAttributes},{name:"TextField",object:ccui.TextField,handle:i.TextFieldAttributes}].forEach(function(e){i.registerParser(e.name,function(t,n){var r=new e.object,o=t.options;return i.generalAttributes(r,o),e.handle(r,o,n),i.colorAttributes(r,o),i.anchorPointAttributes(r,o),i.parseChild.call(this,r,t,n),r})}),e.registerParser("ccui","*",i)}(ccs._load),function(){ccs.uiReader={_fileDesignSizes:{},widgetFromJsonFile:function(e){var t=cc.loader.getRes(e);t&&(this._fileDesignSizes[e]=cc.size(t.designWidth||0,t.designHeight||0));var i=t.Version||t.version,n=ccs.uiReader.getVersionInteger(i);return!i||n>=1700?(cc.warn("Not supported file types, Please try use the ccs.load"),null):ccs._load(e,"ccui")},registerTypeAndCallBack:function(e,t,i,n){var r=ccs._load.getParser("ccui")["*"],o=n.bind(i);r.registerParser(e,function(n,r){var s=new t,a=n.options;i.setPropsFromJsonDictionary&&i.setPropsFromJsonDictionary(s,a),this.generalAttributes(s,a);var c=a.customProperty;return c=c?JSON.parse(c):{},o(e,s,c),this.colorAttributes(s,a),this.anchorPointAttributes(s,a),this.parseChild.call(this,s,n,r),s})},getVersionInteger:function(e){if(!e||"string"!=typeof e)return 0;var t=e.split(".");if(4!=t.length)return 0;var i=0;return t.forEach(function(e,t){i+=e*Math.pow(10,3-t)}),i},storeFileDesignSize:function(e,t){this._fileDesignSizes[e]=t},getFileDesignSize:function(e){return this._fileDesignSizes[e]},getFilePath:function(){return this._filePath},setFilePath:function(e){this._filePath=e},getParseObjectMap:function(){return ccs._load.getParser("ccui")["*"].parsers},getParseCallBackMap:function(){return ccs._load.getParser("ccui")["*"].parsers},clear:function(){}};var e=ccs._load.getParser("ccui")["*"];ccs.imageViewReader={setPropsFromJsonDictionary:e.ImageViewAttributes},ccs.buttonReader={setPropsFromJsonDictionary:e.ButtonAttributes},ccs.checkBoxReader={setPropsFromJsonDictionary:e.CheckBoxAttributes},ccs.labelAtlasReader={setPropsFromJsonDictionary:e.TextAtlasAttributes},ccs.labelBMFontReader={setPropsFromJsonDictionary:e.TextBMFontAttributes},ccs.labelReader={setPropsFromJsonDictionary:e.TextAttributes},ccs.layoutReader={setPropsFromJsonDictionary:e.LayoutAttributes},ccs.listViewReader={setPropsFromJsonDictionary:e.ListViewAttributes},ccs.loadingBarReader={setPropsFromJsonDictionary:e.LoadingBarAttributes},ccs.pageViewReader={setPropsFromJsonDictionary:e.PageViewAttributes},ccs.scrollViewReader={setPropsFromJsonDictionary:e.ScrollViewAttributes},ccs.sliderReader={setPropsFromJsonDictionary:e.SliderAttributes},ccs.textFieldReader={setPropsFromJsonDictionary:e.TextFieldAttributes}}(),ccs.sceneReader={_node:null,createNodeWithSceneFile:function(e){var t=ccs._load(e,"scene");return this._node=t,t},getNodeByTag:function(e){return null==this._node?null:this._node.getTag()==e?this._node:this._nodeByTag(this._node,e)},_nodeByTag:function(e,t){if(null==e)return null;for(var i=null,n=e.getChildren(),r=0;r<n.length;r++){var o=n[r];if(o&&o.getTag()==t){i=o;break}if(i=this._nodeByTag(o,t))break}return i},version:function(){return"*"},setTarget:function(){},clear:function(){ccs.triggerManager.removeAll(),cc.audioEngine.end()}},function(){var e={_ignoreBodyRotation:!1,_body:null,_rotation:1,ctor:function(e,t){if(cc.Sprite.prototype.ctor.call(this),void 0===e)cc.PhysicsSprite.prototype.init.call(this);else if(cc.isString(e))if("#"===e[0]){var i=e.substr(1,e.length-1),n=cc.spriteFrameCache.getSpriteFrame(i);this.initWithSpriteFrame(n)}else this.init(e,t);else cc.isObject(e)&&(e instanceof cc.Texture2D?this.initWithTexture(e,t):e instanceof cc.SpriteFrame&&this.initWithSpriteFrame(e));cc.renderer.pushRenderCommand(this._renderCmd)},visit:function(){cc.renderer.pushRenderCommand(this._renderCmd),cc.Sprite.prototype.visit.call(this)},setBody:function(e){this._body=e},getBody:function(){return this._body},getPosition:function(){var e=this._body;return{x:e.p.x,y:e.p.y}},getPositionX:function(){return this._body.p.x},getPositionY:function(){return this._body.p.y},setPosition:function(e,t){void 0===t?(this._body.p.x=e.x,this._body.p.y=e.y):(this._body.p.x=e,this._body.p.y=t)},setPositionX:function(e){this._body.p.x=e},setPositionY:function(e){this._body.p.y=e},_syncPosition:function(){var e=this._position,t=this._body;e.x==t.p.x&&e.y==t.p.y||cc.Sprite.prototype.setPosition.call(this,t.p.x,t.p.y)},getRotation:function(){return this._ignoreBodyRotation?this._rotationX:-cc.radiansToDegrees(this._body.a)},setRotation:function(e){this._ignoreBodyRotation?cc.Sprite.prototype.setRotation.call(this,e):this._body.a=-cc.degreesToRadians(e)},_syncRotation:function(){this._rotationX!=-cc.radiansToDegrees(this._body.a)&&cc.Sprite.prototype.setRotation.call(this,-cc.radiansToDegrees(this._body.a))},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform()},isDirty:function(){return!this._body.isSleeping()},setDirty:function(){},setIgnoreBodyRotation:function(e){this._ignoreBodyRotation=e},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.PhysicsSprite.CanvasRenderCmd(this):new cc.PhysicsSprite.WebGLRenderCmd(this)}};cc.PhysicsSprite=cc.Sprite.extend(e),cc.PhysicsSprite._className="PhysicsSprite";var t=cc.PhysicsSprite.prototype;t.body,cc.defineGetterSetter(t,"body",t.getBody,t.setBody),t.dirty,cc.defineGetterSetter(t,"dirty",t.isDirty,t.setDirty),cc.PhysicsSprite.create=function(e,t){return new cc.PhysicsSprite(e,t)},cc.PhysicsSprite.createWithSpriteFrameName=cc.PhysicsSprite.create,cc.PhysicsSprite.createWithSpriteFrame=cc.PhysicsSprite.create}(),function(){cc.PhysicsSprite.CanvasRenderCmd=function(e){cc.Sprite.CanvasRenderCmd.call(this,e),this._needDraw=!0};var e=cc.PhysicsSprite.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);e.constructor=cc.PhysicsSprite.CanvasRenderCmd,e.rendering=function(e,t,i){var n=this._node;n._syncPosition(),n._ignoreBodyRotation||n._syncRotation(),this.transform(this.getParentRenderCmd()),cc.Sprite.CanvasRenderCmd.prototype.rendering.call(this,e,t,i)},e.getNodeToParentTransform=function(){var e=this._node,t=this._transform,i=e._body,n=e._scaleX,r=e._scaleY,o=this._anchorPointInPoints;t.tx=i.p.x,t.ty=i.p.y;var s=-i.a,a=1,c=0;return s&&(a=Math.cos(s),c=Math.sin(s)),t.a=t.d=a,t.b=-c,t.c=c,1===n&&1===r||(t.a*=n,t.c*=n,t.b*=r,t.d*=r),t.tx+=a*-o.x*n+-c*o.y*r,t.ty-=c*-o.x*n+a*o.y*r,this._ignoreAnchorPointForPosition&&(t.tx+=o.x,t.ty+=o.y),this._transform}}(),function(){cc.PhysicsSprite.WebGLRenderCmd=function(e){cc.Sprite.WebGLRenderCmd.call(this,e),this._needDraw=!0};var e=cc.PhysicsSprite.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);e.constructor=cc.PhysicsSprite.WebGLRenderCmd,e.rendering=function(e){var t=this._node;t._syncPosition(),t._ignoreBodyRotation||t._syncRotation(),this.transform(this.getParentRenderCmd()),cc.Sprite.WebGLRenderCmd.prototype.rendering.call(this,e)},e.getNodeToParentTransform=function(){var e=this._node,t=e._body,i=this._anchorPointInPoints,n=e._scaleX,r=e._scaleY,o=t.p.x,s=t.p.y;this._ignoreAnchorPointForPosition&&(o+=i.x,s+=i.y);var a=t.a,c=Math.cos(a),l=Math.sin(a);return cc._rectEqualToZero(i)||(o+=c*-i.x*n+-l*-i.y*r,s+=l*-i.x*n+c*-i.y*r),this._transform=cc.affineTransformMake(c*n,l*n,-l*r,c*r,o,s),this._transform},e.updateTransform=function(){this._dirty=this._node.isDirty(),cc.Sprite.WebGLRenderCmd.prototype.updateTransform.call(this)}}(),cc.__convertVerts=function(e){for(var t=[],i=0;i<e.length/2;i++)t[i]={x:e[2*i],y:e[2*i+1]};return t},cc.ColorForBody=function(e){return e.isRogue()||e.isSleeping()?cc.color(128,128,128,128):e.nodeIdleTime>e.space.sleepTimeThreshold?cc.color(84,84,84,128):cc.color(255,0,0,128)},cc.DrawShape=function(e,t){var i=e.body,n=cc.ColorForBody(i);switch(e.collisionCode){case cp.CircleShape.prototype.collisionCode:this.drawDot(e.tc,Math.max(e.r,1),n),this.drawSegment(e.tc,cp.v.add(e.tc,cp.v.mult(i.rot,e.r)),1,n);break;case cp.SegmentShape.prototype.collisionCode:this.drawSegment(e.ta,e.tb,Math.max(e.r,2),n);break;case cp.PolyShape.prototype.collisionCode:var r=cc.color(n.r,n.g,n.b,cc.lerp(n.a,255,.5));this.drawPoly(cc.__convertVerts(e.tVerts),n,1,r);break;default:cc.log("cc.DrawShape(): Bad assertion in DrawShape()")}},cc.DrawConstraint=function(e,t){var i,n,r=e.a,o=e.b;if(e instanceof cp.PinJoint)i=r.local2World(e.anchr1),n=o.local2World(e.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR);else if(e instanceof cp.SlideJoint)i=r.local2World(e.anchr1),n=o.local2World(e.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR);else if(e instanceof cp.PivotJoint)i=r.local2World(e.anchr1),n=o.local2World(e.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR);else if(e instanceof cp.GrooveJoint){i=r.local2World(e.grv_a),n=r.local2World(e.grv_b);var s=o.local2World(e.anchr2);this.drawDot(s,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR)}else cp.DampedSpring},cc.CONSTRAINT_COLOR=cc.color(0,255,0,128),cc.PhysicsDebugNode=cc.DrawNode.extend({_space:null,_className:"PhysicsDebugNode",ctor:function(e){cc.DrawNode.prototype.ctor.call(this),this._space=e},getSpace:function(){return this._space},setSpace:function(e){this._space=e},draw:function(e){this._space&&(this._space.eachShape(cc.DrawShape.bind(this)),this._space.eachConstraint(cc.DrawConstraint.bind(this)),cc.DrawNode.prototype.draw.call(this),this.clear())},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.PhysicsDebugNode.CanvasRenderCmd(this):new cc.PhysicsDebugNode.WebGLRenderCmd(this)}}),cc.PhysicsDebugNode.create=function(e){return new cc.PhysicsDebugNode(e)},function(){cc.PhysicsDebugNode.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._buffer=e._buffer,this._needDraw=!0};var e=cc.PhysicsDebugNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.PhysicsDebugNode.CanvasRenderCmd,e.rendering=function(e,t,i){var n=this._node;n._space&&(n._space.eachShape(cc.DrawShape.bind(n)),n._space.eachConstraint(cc.DrawConstraint.bind(n)),cc.DrawNode.CanvasRenderCmd.prototype.rendering.call(this,e,t,i),n.clear())},e._drawDot=cc.DrawNode.CanvasRenderCmd.prototype._drawDot,e._drawSegment=cc.DrawNode.CanvasRenderCmd.prototype._drawSegment,e._drawPoly=cc.DrawNode.CanvasRenderCmd.prototype._drawPoly}(),cc.PhysicsDebugNode.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0},cc.PhysicsDebugNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.PhysicsDebugNode.WebGLRenderCmd.prototype.constructor=cc.PhysicsDebugNode.WebGLRenderCmd,cc.PhysicsDebugNode.WebGLRenderCmd.prototype.rendering=function(e){var t=this._node;t._space&&(t._space.eachShape(cc.DrawShape.bind(t)),t._space.eachConstraint(cc.DrawConstraint.bind(t)),cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),t._render(),t.clear())};var spine=spine||{radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:void 0===Float32Array?Array:Float32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};spine.BoneData=function(e,t){this.name=e,this.parent=t},spine.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0},spine.SlotData=function(e,t){this.name=e,this.boneData=t,this.r=this.g=this.b=this.a=1},spine.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,additiveBlending:!1},spine.Bone=function(e,t){this.data=e,this.parent=t,this.setToSetupPose()},spine.Bone.yDown=!1,spine.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(e,t){var i=this.parent;null!=i?(this.worldX=this.x*i.m00+this.y*i.m01+i.worldX,this.worldY=this.x*i.m10+this.y*i.m11+i.worldY,this.data.inheritScale?(this.worldScaleX=i.worldScaleX*this.scaleX,this.worldScaleY=i.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY),this.worldRotation=this.data.inheritRotation?i.worldRotation+this.rotation:this.rotation):(this.worldX=e?-this.x:this.x,this.worldY=t!=spine.Bone.yDown?-this.y:this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var n=this.worldRotation*Math.PI/180,r=Math.cos(n),o=Math.sin(n);this.m00=r*this.worldScaleX,this.m10=o*this.worldScaleX,this.m01=-o*this.worldScaleY,this.m11=r*this.worldScaleY,e&&(this.m00=-this.m00,this.m01=-this.m01),t!=spine.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY}},spine.Slot=function(e,t,i){this.data=e,this.skeleton=t,this.bone=i,this.setToSetupPose()},spine.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(e){this.attachment=e,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(e){this._attachmentTime=this.skeleton.time-e},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var e=this.data;this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a;for(var t=this.skeleton.data.slots,i=0,n=t.length;i<n;i++)if(t[i]==e){this.setAttachment(e.attachmentName?this.skeleton.getAttachmentBySlotIndex(i,e.attachmentName):null);break}}},spine.Skin=function(e){this.name=e,this.attachments={}},spine.Skin.prototype={addAttachment:function(e,t,i){this.attachments[e+":"+t]=i},getAttachment:function(e,t){return this.attachments[e+":"+t]},_attachAll:function(e,t){for(var i in t.attachments){var n=i.indexOf(":"),r=parseInt(i.substring(0,n)),o=i.substring(n+1),s=e.slots[r];if(s.attachment&&s.attachment.name==o){var a=this.getAttachment(r,o);a&&s.setAttachment(a)}}}},spine.Animation=function(e,t,i){this.name=e,this.timelines=t,this.duration=i},spine.Animation.prototype={apply:function(e,t,i,n,r){n&&0!=this.duration&&(i%=this.duration,t%=this.duration);for(var o=this.timelines,s=0,a=o.length;s<a;s++)o[s].apply(e,t,i,r,1)},mix:function(e,t,i,n,r,o){n&&0!=this.duration&&(i%=this.duration,t%=this.duration);for(var s=this.timelines,a=0,c=s.length;a<c;a++)s[a].apply(e,t,i,r,o)}},spine.binarySearch=function(e,t,i){var n=0,r=Math.floor(e.length/i)-2;if(0==r)return i;for(var o=r>>>1;;){if(e[(o+1)*i]<=t?n=o+1:r=o,n==r)return(n+1)*i;o=n+r>>>1}},spine.linearSearch=function(e,t,i){for(var n=0,r=e.length-i;n<=r;n+=i)if(e[n]>t)return n;return-1},spine.Curves=function(e){this.curves=[],this.curves.length=6*(e-1)},spine.Curves.prototype={setLinear:function(e){this.curves[6*e]=0},setStepped:function(e){this.curves[6*e]=-1},setCurve:function(e,t,i,n,r){var o=.1*.1*.1*6,s=2*-t+n,a=2*-i+r,c=3*(t-n)+1,l=3*(i-r)+1,u=6*e,h=this.curves;h[u]=t*(3*.1)+s*(.1*.1*3)+c*(.1*.1*.1),h[u+1]=i*(3*.1)+a*(.1*.1*3)+l*(.1*.1*.1),h[u+2]=s*(.1*.1*6)+c*o,h[u+3]=a*(.1*.1*6)+l*o,h[u+4]=c*o,h[u+5]=l*o},getCurvePercent:function(e,t){t=t<0?0:t>1?1:t;var i=6*e,n=this.curves,r=n[i];if(!r)return t;if(-1==r)return 0;for(var o=n[i+1],s=n[i+2],a=n[i+3],c=n[i+4],l=n[i+5],u=r,h=o,d=8;;){if(u>=t){var p=u-r,_=h-o;return _+(h-_)*(t-p)/(u-p)}if(0==d)break;d--,r+=s,o+=a,s+=c,a+=l,u+=r,h+=o}return h+(1-h)*(t-u)/(1-u)}},spine.RotateTimeline=function(e){this.curves=new spine.Curves(e),this.frames=[],this.frames.length=2*e},spine.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(e,t,i){e*=2,this.frames[e]=t,this.frames[e+1]=i},apply:function(e,t,i,n,r){var o=this.frames;if(!(i<o[0])){var s=e.bones[this.boneIndex];if(i>=o[o.length-2]){for(h=s.data.rotation+o[o.length-1]-s.rotation;h>180;)h-=360;for(;h<-180;)h+=360;s.rotation+=h*r}else{var a=spine.binarySearch(o,i,2),c=o[a-1],l=o[a],u=1-(i-l)/(o[a-2]-l);u=this.curves.getCurvePercent(a/2-1,u);for(var h=o[a+1]-c;h>180;)h-=360;for(;h<-180;)h+=360;for(h=s.data.rotation+(c+h*u)-s.rotation;h>180;)h-=360;for(;h<-180;)h+=360;s.rotation+=h*r}}}},spine.TranslateTimeline=function(e){this.curves=new spine.Curves(e),this.frames=[],this.frames.length=3*e},spine.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,i,n){e*=3,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=n},apply:function(e,t,i,n,r){var o=this.frames;if(!(i<o[0])){var s=e.bones[this.boneIndex];if(i>=o[o.length-3])return s.x+=(s.data.x+o[o.length-2]-s.x)*r,void(s.y+=(s.data.y+o[o.length-1]-s.y)*r);var a=spine.binarySearch(o,i,3),c=o[a-2],l=o[a-1],u=o[a],h=1-(i-u)/(o[a+-3]-u);h=this.curves.getCurvePercent(a/3-1,h),s.x+=(s.data.x+c+(o[a+1]-c)*h-s.x)*r,s.y+=(s.data.y+l+(o[a+2]-l)*h-s.y)*r}}},spine.ScaleTimeline=function(e){this.curves=new spine.Curves(e),this.frames=[],this.frames.length=3*e},spine.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,i,n){e*=3,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=n},apply:function(e,t,i,n,r){var o=this.frames;if(!(i<o[0])){var s=e.bones[this.boneIndex];if(i>=o[o.length-3])return s.scaleX+=(s.data.scaleX-1+o[o.length-2]-s.scaleX)*r,void(s.scaleY+=(s.data.scaleY-1+o[o.length-1]-s.scaleY)*r);var a=spine.binarySearch(o,i,3),c=o[a-2],l=o[a-1],u=o[a],h=1-(i-u)/(o[a+-3]-u);h=this.curves.getCurvePercent(a/3-1,h),s.scaleX+=(s.data.scaleX-1+c+(o[a+1]-c)*h-s.scaleX)*r,s.scaleY+=(s.data.scaleY-1+l+(o[a+2]-l)*h-s.scaleY)*r}}},spine.ColorTimeline=function(e){this.curves=new spine.Curves(e),this.frames=[],this.frames.length=5*e},spine.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(e,t,i,n,r,o){e*=5,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=n,this.frames[e+3]=r,this.frames[e+4]=o},apply:function(e,t,i,n,r){var o=this.frames;if(!(i<o[0])){var s=e.slots[this.slotIndex];if(i>=o[o.length-5]){var a=o.length-1;return s.r=o[a-3],s.g=o[a-2],s.b=o[a-1],void(s.a=o[a])}var c=spine.binarySearch(o,i,5),l=o[c-4],u=o[c-3],h=o[c-2],d=o[c-1],p=o[c],_=1-(i-p)/(o[c-5]-p);_=this.curves.getCurvePercent(c/5-1,_);var f=l+(o[c+1]-l)*_,m=u+(o[c+2]-u)*_,g=h+(o[c+3]-h)*_,y=d+(o[c+4]-d)*_;r<1?(s.r+=(f-s.r)*r,s.g+=(m-s.g)*r,s.b+=(g-s.b)*r,s.a+=(y-s.a)*r):(s.r=f,s.g=m,s.b=g,s.a=y)}}},spine.AttachmentTimeline=function(e){this.curves=new spine.Curves(e),this.frames=[],this.frames.length=e,this.attachmentNames=[],this.attachmentNames.length=e},spine.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(e,t,i){this.frames[e]=t,this.attachmentNames[e]=i},apply:function(e,t,i,n,r){var o=this.frames;if(!(i<o[0])){var s;s=i>=o[o.length-1]?o.length-1:spine.binarySearch(o,i,1)-1;var a=this.attachmentNames[s];e.slots[this.slotIndex].setAttachment(a?e.getAttachmentBySlotIndex(this.slotIndex,a):null)}}},spine.EventTimeline=function(e){this.frames=[],this.frames.length=e,this.events=[],this.events.length=e},spine.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(e,t,i){this.frames[e]=t,this.events[e]=i},apply:function(e,t,i,n,r){if(n){var o=this.frames,s=o.length;if(t>i)this.apply(e,t,Number.MAX_VALUE,n,r),t=-1;else if(t>=o[s-1])return;if(!(i<o[0])){var a;if(t<o[0])a=0;else for(var c=o[a=spine.binarySearch(o,t,1)];a>0&&o[a-1]==c;)a--;for(var l=this.events;a<s&&i>=o[a];a++)n.push(l[a])}}}},spine.DrawOrderTimeline=function(e){this.frames=[],this.frames.length=e,this.drawOrders=[],this.drawOrders.length=e},spine.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(e,t,i){this.frames[e]=t,this.drawOrders[e]=i},apply:function(e,t,i,n,r){var o=this.frames;if(!(i<o[0])){var s;s=i>=o[o.length-1]?o.length-1:spine.binarySearch(o,i,1)-1;var a=e.drawOrder,c=e.slots,l=this.drawOrders[s];if(l)for(var u=0,h=l.length;u<h;u++)a[u]=e.slots[l[u]];else for(var u=0,h=c.length;u<h;u++)a[u]=c[u]}}},spine.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[]},spine.SkeletonData.prototype={defaultSkin:null,findBone:function(e){for(var t=this.bones,i=0,n=t.length;i<n;i++)if(t[i].name==e)return t[i];return null},findBoneIndex:function(e){for(var t=this.bones,i=0,n=t.length;i<n;i++)if(t[i].name==e)return i;return-1},findSlot:function(e){for(var t=this.slots,i=0,n=t.length;i<n;i++)if(t[i].name==e)return t[i];return null},findSlotIndex:function(e){for(var t=this.slots,i=0,n=t.length;i<n;i++)if(t[i].name==e)return i;return-1},findSkin:function(e){for(var t=this.skins,i=0,n=t.length;i<n;i++)if(t[i].name==e)return t[i];return null},findEvent:function(e){for(var t=this.events,i=0,n=t.length;i<n;i++)if(t[i].name==e)return t[i];return null},findAnimation:function(e){for(var t=this.animations,i=0,n=t.length;i<n;i++)if(t[i].name==e)return t[i];return null}},spine.Skeleton=function(e){this.data=e,this.bones=[];for(var t=0,i=e.bones.length;t<i;t++){var n=e.bones[t],r=n.parent?this.bones[e.bones.indexOf(n.parent)]:null;this.bones.push(new spine.Bone(n,r))}this.slots=[],this.drawOrder=[];for(var t=0,i=e.slots.length;t<i;t++){var o=e.slots[t],s=this.bones[e.bones.indexOf(o.boneData)],a=new spine.Slot(o,this,s);this.slots.push(a),this.drawOrder.push(a)}},spine.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var e=this.flipX,t=this.flipY,i=this.bones,n=0,r=i.length;n<r;n++)i[n].updateWorldTransform(e,t)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var e=this.bones,t=0,i=e.length;t<i;t++)e[t].setToSetupPose()},setSlotsToSetupPose:function(){for(var e=this.slots,t=0,i=e.length;t<i;t++)e[t].setToSetupPose(t)},getRootBone:function(){return 0==this.bones.length?null:this.bones[0]},findBone:function(e){for(var t=this.bones,i=0,n=t.length;i<n;i++)if(t[i].data.name==e)return t[i];return null},findBoneIndex:function(e){for(var t=this.bones,i=0,n=t.length;i<n;i++)if(t[i].data.name==e)return i;return-1},findSlot:function(e){for(var t=this.slots,i=0,n=t.length;i<n;i++)if(t[i].data.name==e)return t[i];return null},findSlotIndex:function(e){for(var t=this.slots,i=0,n=t.length;i<n;i++)if(t[i].data.name==e)return i;return-1},setSkinByName:function(e){var t=this.data.findSkin(e);if(!t)throw"Skin not found: "+e;this.setSkin(t)},setSkin:function(e){this.skin&&e&&e._attachAll(this,this.skin),this.skin=e},getAttachmentBySlotName:function(e,t){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(e),t)},getAttachmentBySlotIndex:function(e,t){if(this.skin){var i=this.skin.getAttachment(e,t);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(e,t):null},setAttachment:function(e,t){for(var i=this.slots,n=0,r=i.length;n<r;n++){var o=i[n];if(o.data.name==e){var s=null;if(t&&!(s=this.getAttachment(n,t)))throw"Attachment not found: "+t+", for slot: "+e;return void o.setAttachment(s)}}throw"Slot not found: "+e},update:function(e){this.time+=e}},spine.EventData=function(e){this.name=e},spine.EventData.prototype={intValue:0,floatValue:0,stringValue:null},spine.Event=function(e){this.data=e},spine.Event.prototype={intValue:0,floatValue:0,stringValue:null},spine.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3},spine.RegionAttachment=function(e){this.name=e,this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8,this.type=spine.AttachmentType.region},spine.RegionAttachment.prototype={type:spine.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(e,t,i,n,r){var o=this.uvs;r?(o[2]=e,o[3]=n,o[4]=e,o[5]=t,o[6]=i,o[7]=t,o[0]=i,o[1]=n):(o[0]=e,o[1]=n,o[2]=e,o[3]=t,o[4]=i,o[5]=t,o[6]=i,o[7]=n)},updateOffset:function(){var e=this.width/this.regionOriginalWidth*this.scaleX,t=this.height/this.regionOriginalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.regionOffsetX*e,n=-this.height/2*this.scaleY+this.regionOffsetY*t,r=i+this.regionWidth*e,o=n+this.regionHeight*t,s=this.rotation*Math.PI/180,a=Math.cos(s),c=Math.sin(s),l=i*a+this.x,u=i*c,h=n*a+this.y,d=n*c,p=r*a+this.x,_=r*c,f=o*a+this.y,m=o*c,g=this.offset;g[0]=l-d,g[1]=h+u,g[2]=l-m,g[3]=f+u,g[4]=p-m,g[5]=f+_,g[6]=p-d,g[7]=h+_},computeVertices:function(e,t,i,n){var r=i.bone;e+=r.worldX,t+=r.worldY;var o=r.m00,s=r.m01,a=r.m10,c=r.m11,l=this.offset;n[0]=l[0]*o+l[1]*s+e,n[1]=l[0]*a+l[1]*c+t,n[2]=l[2]*o+l[3]*s+e,n[3]=l[2]*a+l[3]*c+t,n[4]=l[4]*o+l[5]*s+e,n[5]=l[4]*a+l[5]*c+t,n[6]=l[6]*o+l[7]*s+e,n[7]=l[6]*a+l[7]*c+t}},spine.MeshAttachment=function(e){this.name=e},spine.MeshAttachment.prototype={type:spine.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var e=this.regionU2-this.regionU,t=this.regionV2-this.regionV,i=this.regionUVs.length;if(this.uvs&&this.uvs.length==i||(this.uvs=new spine.Float32Array(i)),this.regionRotate)for(n=0;n<i;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n+1]*e,this.uvs[n+1]=this.regionV+t-this.regionUVs[n]*t;else for(var n=0;n<i;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n]*e,this.uvs[n+1]=this.regionV+this.regionUVs[n+1]*t},computeVertices:function(e,t,i,n){var r=i.bone;e+=r.worldX,t+=r.worldY;var o=r.m00,s=r.m01,a=r.m10,c=r.m11,l=this.vertices.length;i.attachment.length==l&&(this.vertices=i.attachment);for(var u=0;u<l;u+=2){var h=this.vertices[u],d=this.vertices[u+1];n[u]=h*o+d*s+e,n[u+1]=h*a+d*c+t}}},spine.SkinnedMeshAttachment=function(e){this.name=e},spine.SkinnedMeshAttachment.prototype={type:spine.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(e,t,i,n,r){var o=this.regionU2-this.regionU,s=this.regionV2-this.regionV,a=this.regionUVs.length;if(this.uvs&&this.uvs.length==a||(this.uvs=new spine.Float32Array(a)),this.regionRotate)for(c=0;c<a;c+=2)this.uvs[c]=this.regionU+this.regionUVs[c+1]*o,this.uvs[c+1]=this.regionV+s-this.regionUVs[c]*s;else for(var c=0;c<a;c+=2)this.uvs[c]=this.regionU+this.regionUVs[c]*o,this.uvs[c+1]=this.regionV+this.regionUVs[c+1]*s},computeWorldVertices:function(e,t,i,n){var r,o,s,a,c,l,u,h=i.bone.skeleton.bones,d=this.weights,p=this.bones,_=0,f=0,m=0,g=0,y=p.length;if(i.attachmentVertices.length)for(var T=i.attachmentVertices;f<y;_+=2){for(o=0,s=0,r=p[f++]+f;f<r;f++,m+=3,g+=2)a=h[p[f]],c=d[m]+T[g],l=d[m+1]+T[g+1],u=d[m+2],o+=(c*a.m00+l*a.m01+a.worldX)*u,s+=(c*a.m10+l*a.m11+a.worldY)*u;n[_]=o+e,n[_+1]=s+t}else for(;f<y;_+=2){for(o=0,s=0,r=p[f++]+f;f<r;f++,m+=3)a=h[p[f]],c=d[m],l=d[m+1],u=d[m+2],o+=(c*a.m00+l*a.m01+a.worldX)*u,s+=(c*a.m10+l*a.m11+a.worldY)*u;n[_]=o+e,n[_+1]=s+t}}},spine.BoundingBoxAttachment=function(e){this.name=e,this.vertices=[],this.type=spine.AttachmentType.boundingBox},spine.BoundingBoxAttachment.prototype={type:spine.AttachmentType.boundingBox,computeWorldVertices:function(e,t,i,n){e+=i.worldX,t+=i.worldY;for(var r=i.m00,o=i.m01,s=i.m10,a=i.m11,c=this.vertices,l=0,u=c.length;l<u;l+=2){var h=c[l],d=c[l+1];n[l]=h*r+d*o+e,n[l+1]=h*s+d*a+t}}},spine.AnimationStateData=function(e){this.skeletonData=e,this.animationToMixTime={}},spine.AnimationStateData.prototype={defaultMix:0,setMixByName:function(e,t,i){var n=this.skeletonData.findAnimation(e);if(!n)throw"Animation not found: "+e;var r=this.skeletonData.findAnimation(t);if(!r)throw"Animation not found: "+t;this.setMix(n,r,i)},setMix:function(e,t,i){this.animationToMixTime[e.name+":"+t.name]=i},getMix:function(e,t){var i=this.animationToMixTime[e.name+":"+t.name];return i||this.defaultMix}},spine.TrackEntry=function(){},spine.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,onStart:null,onEnd:null,onComplete:null,onEvent:null},spine.AnimationState=function(e){this.data=e,this.tracks=[],this.events=[]},spine.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(e){e*=this.timeScale;for(var t=0;t<this.tracks.length;t++){var i=this.tracks[t];if(i){var n=e*i.timeScale;i.time+=n,i.previous&&(i.previous.time+=n,i.mixTime+=n);var r=i.next;r?i.lastTime>=r.delay&&this.setCurrent(t,r):!i.loop&&i.lastTime>=i.endTime&&this.clearTrack(t)}}},apply:function(e){for(var t=0;t<this.tracks.length;t++){var i=this.tracks[t];if(i){this.events.length=0;var n=i.time,r=i.lastTime,o=i.endTime,s=i.loop;!s&&n>o&&(n=o);var a=i.previous;if(a){var c=a.time;!a.loop&&c>a.endTime&&(c=a.endTime),a.animation.apply(e,c,c,a.loop,null);var l=i.mixTime/i.mixDuration;l>=1&&(l=1,i.previous=null),i.animation.mix(e,i.lastTime,n,s,this.events,l)}else i.animation.apply(e,i.lastTime,n,s,this.events);for(var u=0,h=this.events.length;u<h;u++){var d=this.events[u];null!=i.onEvent&&i.onEvent(t,d),null!=this.onEvent&&this.onEvent(t,d)}if(s?r%o>n%o:r<o&&n>=o){var p=Math.floor(n/o);i.onComplete&&i.onComplete(t,p),this.onComplete&&this.onComplete(t,p)}i.lastTime=i.time}}},clearTracks:function(){for(var e=0,t=this.tracks.length;e<t;e++)this.clearTrack(e);this.tracks.length=0},clearTrack:function(e){if(!(e>=this.tracks.length)){var t=this.tracks[e];t&&(null!=t.onEnd&&t.onEnd(e),null!=this.onEnd&&this.onEnd(e),this.tracks[e]=null)}},_expandToIndex:function(e){if(e<this.tracks.length)return this.tracks[e];for(;e>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(e,t){var i=this._expandToIndex(e);if(i){var n=i.previous;i.previous=null,null!=i.onEnd&&i.onEnd(e),null!=this.onEnd&&this.onEnd(e),t.mixDuration=this.data.getMix(i.animation,t.animation),t.mixDuration>0&&(t.mixTime=0,n&&i.mixTime/i.mixDuration<.5?t.previous=n:t.previous=i)}this.tracks[e]=t,null!=t.onStart&&t.onStart(e),null!=this.onStart&&this.onStart(e)},setAnimationByName:function(e,t,i){var n=this.data.skeletonData.findAnimation(t);if(!n)throw"Animation not found: "+t;return this.setAnimation(e,n,i)},setAnimation:function(e,t,i){var n=new spine.TrackEntry;return n.animation=t,n.loop=i,n.endTime=t.duration,this.setCurrent(e,n),n},addAnimationByName:function(e,t,i,n){var r=this.data.skeletonData.findAnimation(t);if(!r)throw"Animation not found: "+t;return this.addAnimation(e,r,i,n)},addAnimation:function(e,t,i,n){var r=new spine.TrackEntry;r.animation=t,r.loop=i,r.endTime=t.duration;var o=this._expandToIndex(e);if(o){for(;o.next;)o=o.next;o.next=r}else this.tracks[e]=r;return n<=0&&(o?n+=o.endTime-this.data.getMix(o.animation,t):n=0),r.delay=n,r},getCurrent:function(e){return e>=this.tracks.length?null:this.tracks[e]}},spine.SkeletonJson=function(e){this.attachmentLoader=e},spine.SkeletonJson.prototype={scale:1,readSkeletonData:function(e,t){var i=new spine.SkeletonData;i.name=t;var n=e.skeleton;n&&(i.hash=n.hash,i.version=n.spine,i.width=n.width||0,i.height=n.height||0);for(var r=e.bones,o=0,s=r.length;o<s;o++){var a=r[o],c=null;if(a.parent&&!(c=i.findBone(a.parent)))throw"Parent bone not found: "+a.parent;(g=new spine.BoneData(a.name,c)).length=(a.length||0)*this.scale,g.x=(a.x||0)*this.scale,g.y=(a.y||0)*this.scale,g.rotation=a.rotation||0,g.scaleX=a.hasOwnProperty("scaleX")?a.scaleX:1,g.scaleY=a.hasOwnProperty("scaleY")?a.scaleY:1,g.inheritScale=!a.hasOwnProperty("inheritScale")||a.inheritScale,g.inheritRotation=!a.hasOwnProperty("inheritRotation")||a.inheritRotation,i.bones.push(g)}var l=e.ik;if(l)for(var o=0,s=l.length;o<s;o++){for(var u=l[o],h=new spine.IkConstraintData(u.name),d=0,p=(r=u.bones).length;d<p;d++){var _=i.findBone(r[d]);if(!_)throw"IK bone not found: "+r[d];h.bones.push(_)}if(h.target=i.findBone(u.target),!h.target)throw"Target bone not found: "+u.target;h.bendDirection=!u.hasOwnProperty("bendPositive")||u.bendPositive?1:-1,h.mix=u.hasOwnProperty("mix")?u.mix:1,i.ikConstraints.push(h)}for(var f=e.slots,o=0,s=f.length;o<s;o++){var m=f[o],g=i.findBone(m.bone);if(!g)throw"Slot bone not found: "+m.bone;var y=new spine.SlotData(m.name,g),T=m.color;T&&(y.r=this.toColor(T,0),y.g=this.toColor(T,1),y.b=this.toColor(T,2),y.a=this.toColor(T,3)),y.attachmentName=m.attachment,y.additiveBlending=m.additive&&"true"==m.additive,i.slots.push(y)}var v=e.skins;for(var S in v)if(v.hasOwnProperty(S)){var C=v[S],E=new spine.Skin(S);for(var b in C)if(C.hasOwnProperty(b)){var A=i.findSlotIndex(b),x=C[b];for(var R in x)if(x.hasOwnProperty(R)){var P=this.readAttachment(E,R,x[R]);P&&E.addAttachment(A,R,P)}}i.skins.push(E),"default"==E.name&&(i.defaultSkin=E)}var I=e.events;for(var w in I)if(I.hasOwnProperty(w)){var N=I[w],L=new spine.EventData(w);L.intValue=N.int||0,L.floatValue=N.float||0,L.stringValue=N.string||null,i.events.push(L)}var O=e.animations;for(var D in O)O.hasOwnProperty(D)&&this.readAnimation(D,O[D],i);return i},readAttachment:function(e,t,i){t=i.name||t;var n=spine.AttachmentType[i.type||"region"],r=i.path||t,o=this.scale;if(n==spine.AttachmentType.region){var s=this.attachmentLoader.newRegionAttachment(e,t,r);if(!s)return null;s.path=r,s.x=(i.x||0)*o,s.y=(i.y||0)*o,s.scaleX=i.hasOwnProperty("scaleX")?i.scaleX:1,s.scaleY=i.hasOwnProperty("scaleY")?i.scaleY:1,s.rotation=i.rotation||0,s.width=(i.width||0)*o,s.height=(i.height||0)*o;var a=i.color;return a&&(s.r=this.toColor(a,0),s.g=this.toColor(a,1),s.b=this.toColor(a,2),s.a=this.toColor(a,3)),s.updateOffset(),s}if(n==spine.AttachmentType.mesh)return(c=this.attachmentLoader.newMeshAttachment(e,t,r))?(c.path=r,c.vertices=this.getFloatArray(i,"vertices",o),c.triangles=this.getIntArray(i,"triangles"),c.regionUVs=this.getFloatArray(i,"uvs",1),c.updateUVs(),(a=i.color)&&(c.r=this.toColor(a,0),c.g=this.toColor(a,1),c.b=this.toColor(a,2),c.a=this.toColor(a,3)),c.hullLength=2*(i.hull||0),i.edges&&(c.edges=this.getIntArray(i,"edges")),c.width=(i.width||0)*o,c.height=(i.height||0)*o,c):null;if(n==spine.AttachmentType.skinnedmesh){var c=this.attachmentLoader.newSkinnedMeshAttachment(e,t,r);if(!c)return null;c.path=r;for(var l=this.getFloatArray(i,"uvs",1),u=[],h=[],d=0,p=(g=this.getFloatArray(i,"vertices",1)).length;d<p;){var _=0|g[d++];h[h.length]=_;for(var f=d+4*_;d<f;)h[h.length]=g[d],u[u.length]=g[d+1]*o,u[u.length]=g[d+2]*o,u[u.length]=g[d+3],d+=4}return c.bones=h,c.weights=u,c.triangles=this.getIntArray(i,"triangles"),c.regionUVs=l,c.updateUVs(),(a=i.color)&&(c.r=this.toColor(a,0),c.g=this.toColor(a,1),c.b=this.toColor(a,2),c.a=this.toColor(a,3)),c.hullLength=2*(i.hull||0),i.edges&&(c.edges=this.getIntArray(i,"edges")),c.width=(i.width||0)*o,c.height=(i.height||0)*o,c}if(n==spine.AttachmentType.boundingbox){for(var m=this.attachmentLoader.newBoundingBoxAttachment(e,t),g=i.vertices,d=0,p=g.length;d<p;d++)m.vertices.push(g[d]*o);return m}throw"Unknown attachment type: "+n},readAnimation:function(e,t,i){var n=[],r=0,o=t.slots;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s],c=i.findSlotIndex(s);for(var l in a)if(a.hasOwnProperty(l)){w=a[l];if("color"==l){(k=new spine.ColorTimeline(w.length)).slotIndex=c;for(var u=0,h=0,d=w.length;h<d;h++){var p=(x=w[h]).color,_=this.toColor(p,0),f=this.toColor(p,1),m=this.toColor(p,2),g=this.toColor(p,3);k.setFrame(u,x.time,_,f,m,g),this.readCurve(k,u,x),u++}n.push(k),r=Math.max(r,k.frames[5*k.getFrameCount()-5])}else{if("attachment"!=l)throw"Invalid timeline type for a slot: "+l+" ("+s+")";(k=new spine.AttachmentTimeline(w.length)).slotIndex=c;for(var u=0,h=0,d=w.length;h<d;h++){x=w[h];k.setFrame(u++,x.time,x.name)}n.push(k),r=Math.max(r,k.frames[k.getFrameCount()-1])}}}var y=t.bones;for(var T in y)if(y.hasOwnProperty(T)){var v=i.findBoneIndex(T);if(-1==v)throw"Bone not found: "+T;var S=y[T];for(var l in S)if(S.hasOwnProperty(l)){w=S[l];if("rotate"==l){(k=new spine.RotateTimeline(w.length)).boneIndex=v;for(var u=0,h=0,d=w.length;h<d;h++){x=w[h];k.setFrame(u,x.time,x.angle),this.readCurve(k,u,x),u++}n.push(k),r=Math.max(r,k.frames[2*k.getFrameCount()-2])}else if("translate"==l||"scale"==l){var C=1;"scale"==l?k=new spine.ScaleTimeline(w.length):(k=new spine.TranslateTimeline(w.length),C=this.scale),k.boneIndex=v;for(var u=0,h=0,d=w.length;h<d;h++){var E=((x=w[h]).x||0)*C,b=(x.y||0)*C;k.setFrame(u,x.time,E,b),this.readCurve(k,u,x),u++}n.push(k),r=Math.max(r,k.frames[3*k.getFrameCount()-3])}else{if("flipX"!=l&&"flipY"!=l)throw"Invalid timeline type for a bone: "+l+" ("+T+")";(k=(E="flipX"==l)?new spine.FlipXTimeline(w.length):new spine.FlipYTimeline(w.length)).boneIndex=v;for(var A=E?"x":"y",u=0,h=0,d=w.length;h<d;h++){var x=w[h];k.setFrame(u,x.time,x[A]||!1),u++}n.push(k),r=Math.max(r,k.frames[2*k.getFrameCount()-2])}}}var R=t.ik;for(var P in R)if(R.hasOwnProperty(P)){var I=i.findIkConstraint(P),w=R[P];(k=new spine.IkConstraintTimeline(w.length)).ikConstraintIndex=i.ikConstraints.indexOf(I);for(var u=0,h=0,d=w.length;h<d;h++){var N=(x=w[h]).hasOwnProperty("mix")?x.mix:1,L=!x.hasOwnProperty("bendPositive")||x.bendPositive?1:-1;k.setFrame(u,x.time,N,L),this.readCurve(k,u,x),u++}n.push(k),r=Math.max(r,k.frames[3*k.frameCount-3])}var O=t.ffd;for(var D in O){var F=i.findSkin(D),a=O[D];for(s in a){var c=i.findSlotIndex(s),B=a[s];for(var M in B){var w=B[M],k=new spine.FfdTimeline(w.length),W=F.getAttachment(c,M);if(!W)throw"FFD attachment not found: "+M;k.slotIndex=c,k.attachment=W;var V,z=W.type==spine.AttachmentType.mesh;V=z?W.vertices.length:W.weights.length/3*2;for(var u=0,h=0,d=w.length;h<d;h++){var G;if((x=w[h]).vertices){var U=x.vertices;(G=[]).length=V;var Y=x.offset||0,H=U.length;if(1==this.scale)for(q=0;q<H;q++)G[q+Y]=U[q];else for(q=0;q<H;q++)G[q+Y]=U[q]*this.scale;if(z)for(var X=W.vertices,q=0,H=G.length;q<H;q++)G[q]+=X[q]}else z?G=W.vertices:(G=[]).length=V;k.setFrame(u,x.time,G),this.readCurve(k,u,x),u++}n[n.length]=k,r=Math.max(r,k.frames[k.frameCount-1])}}}var j=t.drawOrder;if(j||(j=t.draworder),j){for(var k=new spine.DrawOrderTimeline(j.length),K=i.slots.length,u=0,h=0,d=j.length;h<d;h++){var Q=j[h],Z=null;if(Q.offsets){(Z=[]).length=K;for(q=K-1;q>=0;q--)Z[q]=-1;var J=Q.offsets,$=[];$.length=K-J.length;for(var ee=0,te=0,q=0,H=J.length;q<H;q++){var ie=J[q];if(-1==(c=i.findSlotIndex(ie.slot)))throw"Slot not found: "+ie.slot;for(;ee!=c;)$[te++]=ee++;Z[ee+ie.offset]=ee++}for(;ee<K;)$[te++]=ee++;for(q=K-1;q>=0;q--)-1==Z[q]&&(Z[q]=$[--te])}k.setFrame(u++,Q.time,Z)}n.push(k),r=Math.max(r,k.frames[k.getFrameCount()-1])}var ne=t.events;if(ne){for(var k=new spine.EventTimeline(ne.length),u=0,h=0,d=ne.length;h<d;h++){var re=ne[h],oe=i.findEvent(re.name);if(!oe)throw"Event not found: "+re.name;var se=new spine.Event(oe);se.intValue=re.hasOwnProperty("int")?re.int:oe.intValue,se.floatValue=re.hasOwnProperty("float")?re.float:oe.floatValue,se.stringValue=re.hasOwnProperty("string")?re.string:oe.stringValue,k.setFrame(u++,re.time,se)}n.push(k),r=Math.max(r,k.frames[k.getFrameCount()-1])}i.animations.push(new spine.Animation(e,n,r))},readCurve:function(e,t,i){var n=i.curve;n?"stepped"==n?e.curves.setStepped(t):n instanceof Array&&e.curves.setCurve(t,n[0],n[1],n[2],n[3]):e.curves.setLinear(t)},toColor:function(e,t){if(8!=e.length)throw"Color hexidecimal length must be 8, recieved: "+e;return parseInt(e.substring(2*t,2*t+2),16)/255},getFloatArray:function(e,t,i){var n=e[t],r=new spine.Float32Array(n.length),o=0,s=n.length;if(1==i)for(;o<s;o++)r[o]=n[o];else for(;o<s;o++)r[o]=n[o]*i;return r},getIntArray:function(e,t){for(var i=e[t],n=new spine.Uint16Array(i.length),r=0,o=i.length;r<o;r++)n[r]=0|i[r];return n}},spine.SkeletonJson.readCurve=function(e,t,i){var n=i.curve;n&&("stepped"==n?e.curves.setStepped(t):n instanceof Array&&e.curves.setCurve(t,n[0],n[1],n[2],n[3]))},spine.SkeletonJson.toColor=function(e,t){if(8!=e.length)throw"Color hexidecimal length must be 8, recieved: "+e;return parseInt(e.substring(2*t,2*t+2),16)/255},spine.Atlas=function(e,t){this.textureLoader=t,this.pages=[],this.regions=[];var i=new spine.AtlasReader(e),n=[];n.length=4;for(var r=null;;){var o=i.readLine();if(null===o)break;if((o=i.trim(o)).length)if(r){var s=new spine.AtlasRegion;s.name=o,s.page=r,s.rotate="true"==i.readValue(),i.readTuple(n);var a=parseInt(n[0]),c=parseInt(n[1]);i.readTuple(n);var l=parseInt(n[0]),u=parseInt(n[1]);s.u=a/r.width,s.v=c/r.height,s.rotate?(s.u2=(a+u)/r.width,s.v2=(c+l)/r.height):(s.u2=(a+l)/r.width,s.v2=(c+u)/r.height),s.x=a,s.y=c,s.width=Math.abs(l),s.height=Math.abs(u),4==i.readTuple(n)&&(s.splits=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],4==i.readTuple(n)&&(s.pads=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i.readTuple(n))),s.originalWidth=parseInt(n[0]),s.originalHeight=parseInt(n[1]),i.readTuple(n),s.offsetX=parseInt(n[0]),s.offsetY=parseInt(n[1]),s.index=parseInt(i.readValue()),this.regions.push(s)}else{(r=new spine.AtlasPage).name=o,2==i.readTuple(n)&&(r.width=parseInt(n[0]),r.height=parseInt(n[1]),i.readTuple(n)),r.format=spine.Atlas.Format[n[0]],i.readTuple(n),r.minFilter=spine.Atlas.TextureFilter[n[0]],r.magFilter=spine.Atlas.TextureFilter[n[1]];var h=i.readValue();r.uWrap=spine.Atlas.TextureWrap.clampToEdge,r.vWrap=spine.Atlas.TextureWrap.clampToEdge,"x"==h?r.uWrap=spine.Atlas.TextureWrap.repeat:"y"==h?r.vWrap=spine.Atlas.TextureWrap.repeat:"xy"==h&&(r.uWrap=r.vWrap=spine.Atlas.TextureWrap.repeat),t.load(r,o,this),this.pages.push(r)}else r=null}},spine.Atlas.prototype={findRegion:function(e){for(var t=this.regions,i=0,n=t.length;i<n;i++)if(t[i].name==e)return t[i];return null},dispose:function(){for(var e=this.pages,t=0,i=e.length;t<i;t++)this.textureLoader.unload(e[t].rendererObject)},updateUVs:function(e){for(var t=this.regions,i=0,n=t.length;i<n;i++){var r=t[i];r.page==e&&(r.u=r.x/e.width,r.v=r.y/e.height,r.rotate?(r.u2=(r.x+r.height)/e.width,r.v2=(r.y+r.width)/e.height):(r.u2=(r.x+r.width)/e.width,r.v2=(r.y+r.height)/e.height))}}},spine.Atlas.Format={Alpha:0,Intensity:1,LuminanceAlpha:2,RGB565:3,RGBA4444:4,RGB888:5,RGBA8888:6},spine.Atlas.TextureFilter={Nearest:0,Linear:1,MipMap:2,MipMapNearestNearest:3,MipMapLinearNearest:4,MipMapNearestLinear:5,MipMapLinearLinear:6},spine.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},spine.AtlasPage=function(){},spine.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},spine.AtlasRegion=function(){},spine.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},spine.AtlasReader=function(e){this.lines=e.split(/\r\n|\r|\n/)},spine.AtlasReader.prototype={index:0,trim:function(e){return e.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var e=this.readLine(),t=e.indexOf(":");if(-1==t)throw"Invalid line: "+e;return this.trim(e.substring(t+1))},readTuple:function(e){var t=this.readLine(),i=t.indexOf(":");if(-1==i)throw"Invalid line: "+t;for(var n=0,r=i+1;n<3;n++){var o=t.indexOf(",",r);if(-1==o)break;e[n]=this.trim(t.substr(r,o-r)),r=o+1}return e[n]=this.trim(t.substring(r)),n+1}},spine.AtlasAttachmentLoader=function(e){this.atlas=e},spine.AtlasAttachmentLoader.prototype={newRegionAttachment:function(e,t,i){var n=this.atlas.findRegion(t);if(!n)throw"Region not found in atlas: "+i+" (region attachment: "+t+")";var r=new spine.RegionAttachment(t);return r.rendererObject=n,r.setUVs(n.u,n.v,n.u2,n.v2,n.rotate),r.regionOffsetX=n.offsetX,r.regionOffsetY=n.offsetY,r.regionWidth=n.width,r.regionHeight=n.height,r.regionOriginalWidth=n.originalWidth,r.regionOriginalHeight=n.originalHeight,r},newMeshAttachment:function(e,t,i){var n=this.atlas.findRegion(t);if(!n)throw"Region not found in atlas: "+i+" (mesh attachment: "+t+")";var r=new spine.MeshAttachment(t);return r.rendererObject=n,r.regionU=n.u,r.regionV=n.v,r.regionU2=n.u2,r.regionV2=n.v2,r.regionRotate=n.rotate,r.regionOffsetX=n.offsetX,r.regionOffsetY=n.offsetY,r.regionWidth=n.width,r.regionHeight=n.height,r.regionOriginalWidth=n.originalWidth,r.regionOriginalHeight=n.originalHeight,r},newSkinnedMeshAttachment:function(e,t,i){var n=this.atlas.findRegion(t);if(!n)throw"Region not found in atlas: "+i+" (skinned mesh attachment: "+t+")";var r=new spine.SkinnedMeshAttachment(t);return r.rendererObject=n,r.regionU=n.u,r.regionV=n.v,r.regionU2=n.u2,r.regionV2=n.v2,r.regionRotate=n.rotate,r.regionOffsetX=n.offsetX,r.regionOffsetY=n.offsetY,r.regionWidth=n.width,r.regionHeight=n.height,r.regionOriginalWidth=n.originalWidth,r.regionOriginalHeight=n.originalHeight,r},newBoundingBoxAttachment:function(e,t){return new spine.BoundingBoxAttachment(t)}},spine.SkeletonBounds=function(){this.polygonPool=[],this.polygons=[],this.boundingBoxes=[]},spine.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(e,t){var i=e.slots,n=i.length,r=e.x,o=e.y,s=this.boundingBoxes,a=this.polygonPool,c=this.polygons;s.length=0;for(var l=0,u=c.length;l<u;l++)a.push(c[l]);c.length=0;for(l=0;l<n;l++){var h=i[l],d=h.attachment;if(d.type==spine.AttachmentType.boundingBox){s.push(d);var p,_=a.length;_>0?(p=a[_-1],a.splice(_-1,1)):p=[],c.push(p),p.length=d.vertices.length,d.computeWorldVertices(r,o,h.bone,p)}}t&&this.aabbCompute()},aabbCompute:function(){for(var e=this.polygons,t=Number.MAX_VALUE,i=Number.MAX_VALUE,n=Number.MIN_VALUE,r=Number.MIN_VALUE,o=0,s=e.length;o<s;o++)for(var a=e[o],c=0,l=a.length;c<l;c+=2){var u=a[c],h=a[c+1];t=Math.min(t,u),i=Math.min(i,h),n=Math.max(n,u),r=Math.max(r,h)}this.minX=t,this.minY=i,this.maxX=n,this.maxY=r},aabbContainsPoint:function(e,t){return e>=this.minX&&e<=this.maxX&&t>=this.minY&&t<=this.maxY},aabbIntersectsSegment:function(e,t,i,n){var r=this.minX,o=this.minY,s=this.maxX,a=this.maxY;if(e<=r&&i<=r||t<=o&&n<=o||e>=s&&i>=s||t>=a&&n>=a)return!1;var c=(n-t)/(i-e),l=c*(r-e)+t;if(l>o&&l<a)return!0;if((l=c*(s-e)+t)>o&&l<a)return!0;var u=(o-t)/c+e;return u>r&&u<s||(u=(a-t)/c+e)>r&&u<s},aabbIntersectsSkeleton:function(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY},containsPoint:function(e,t){for(var i=this.polygons,n=0,r=i.length;n<r;n++)if(this.polygonContainsPoint(i[n],e,t))return this.boundingBoxes[n];return null},intersectsSegment:function(e,t,i,n){for(var r=this.polygons,o=0,s=r.length;o<s;o++)if(r[o].intersectsSegment(e,t,i,n))return this.boundingBoxes[o];return null},polygonContainsPoint:function(e,t,i){for(var n=e.length,r=n-2,o=!1,s=0;s<n;s+=2){var a=e[s+1],c=e[r+1];if(a<i&&c>=i||c<i&&a>=i){var l=e[s];l+(i-a)/(c-a)*(e[r]-l)<t&&(o=!o)}r=s}return o},intersectsSegment:function(e,t,i,n,r){for(var o=e.length,s=t-n,a=i-r,c=t*r-i*n,l=e[o-2],u=e[o-1],h=0;h<o;h+=2){var d=e[h],p=e[h+1],_=l*p-u*d,f=l-d,m=u-p,g=s*m-a*f,y=(c*f-s*_)/g;if((y>=l&&y<=d||y>=d&&y<=l)&&(y>=t&&y<=n||y>=n&&y<=t)){var T=(c*m-a*_)/g;if((T>=u&&T<=p||T>=p&&T<=u)&&(T>=i&&T<=r||T>=r&&T<=i))return!0}l=d,u=p}return!1},getPolygon:function(e){var t=this.boundingBoxes.indexOf(e);return-1==t?null:this.polygons[t]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}};var sp=sp||{};sp.VERTEX_INDEX={X1:0,Y1:1,X2:2,Y2:3,X3:4,Y3:5,X4:6,Y4:7},sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,REGION_SEQUENCE:2,MESH:2},sp.Skeleton=cc.Node.extend({_skeleton:null,_rootBone:null,_timeScale:1,_debugSlots:!1,_debugBones:!1,_premultipliedAlpha:!1,_ownsSkeletonData:null,_atlas:null,_blendFunc:null,ctor:function(e,t,i){cc.Node.prototype.ctor.call(this),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},0===arguments.length?this.init():this.initWithArgs(e,t,i)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new sp.Skeleton.CanvasRenderCmd(this):new sp.Skeleton.WebGLRenderCmd(this)},init:function(){cc.Node.prototype.init.call(this),this.setOpacityModifyRGB(!0),this._blendFunc.src=cc.ONE,this._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA,this.scheduleUpdate()},setDebugSolots:function(e){this._debugSlots=e},setDebugBones:function(e){this._debugBones=e},setTimeScale:function(e){this._timeScale=e},initWithArgs:function(e,t,i){var n,r,o,s=e,a=t;if(cc.isString(s)){if(cc.isString(a)){var c=cc.loader.getRes(a);sp._atlasLoader.setAtlasFile(a),r=new spine.Atlas(c,sp._atlasLoader)}else r=t;i=i||1/cc.director.getContentScaleFactor();var l=new spine.AtlasAttachmentLoader(r),u=new spine.SkeletonJson(l);u.scale=i;var h=cc.loader.getRes(s);n=u.readSkeletonData(h),r.dispose(u),o=!0}else n=e,o=t;this.setSkeletonData(n,o),this.init()},getBoundingBox:function(){for(var e=cc.FLT_MAX,t=cc.FLT_MAX,i=cc.FLT_MIN,n=cc.FLT_MIN,r=this.getScaleX(),o=this.getScaleY(),s=[],a=this._skeleton.slots,c=sp.VERTEX_INDEX,l=0,u=a.length;l<u;++l){var h=a[l];if(h.attachment&&h.attachment.type==sp.ATTACHMENT_TYPE.REGION){var d=h.attachment;sp._regionAttachment_computeWorldVertices(d,h.skeleton.x,h.skeleton.y,h.bone,s),e=Math.min(e,s[c.X1]*r,s[c.X4]*r,s[c.X2]*r,s[c.X3]*r),t=Math.min(t,s[c.Y1]*o,s[c.Y4]*o,s[c.Y2]*o,s[c.Y3]*o),i=Math.max(i,s[c.X1]*r,s[c.X4]*r,s[c.X2]*r,s[c.X3]*r),n=Math.max(n,s[c.Y1]*o,s[c.Y4]*o,s[c.Y2]*o,s[c.Y3]*o)}}var p=this.getPosition();return cc.rect(p.x+e,p.y+t,i-e,n-t)},updateWorldTransform:function(){this._skeleton.updateWorldTransform()},setToSetupPose:function(){this._skeleton.setToSetupPose()},setBonesToSetupPose:function(){this._skeleton.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._skeleton.setSlotsToSetupPose()},findBone:function(e){return this._skeleton.findBone(e)},findSlot:function(e){return this._skeleton.findSlot(e)},setSkin:function(e){return this._skeleton.setSkinByName(e)},getAttachment:function(e,t){return this._skeleton.getAttachmentBySlotName(e,t)},setAttachment:function(e,t){this._skeleton.setAttachment(e,t)},setOpacityModifyRGB:function(e){this._premultipliedAlpha=e},isOpacityModifyRGB:function(){return this._premultipliedAlpha},setSkeletonData:function(e,t){null!=e.width&&null!=e.height&&this.setContentSize(e.width/cc.director.getContentScaleFactor(),e.height/cc.director.getContentScaleFactor()),this._skeleton=new spine.Skeleton(e),this._rootBone=this._skeleton.getRootBone(),this._ownsSkeletonData=t,this._renderCmd._createChildFormSkeletonData()},getTextureAtlas:function(e){return e.rendererObject.page.rendererObject},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){var i=this._blendFunc;void 0===t?(i.src=e.src,i.dst=e.dst):(i.src=e,i.dst=t)},update:function(e){this._skeleton.update(e),this._renderCmd._updateChild()}}),sp.Skeleton.create=function(e,t,i){return new sp.Skeleton(e,t,i)},function(){sp.Skeleton.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._skeletonSprites=[]};var e=sp.Skeleton.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=sp.Skeleton.CanvasRenderCmd,e.rendering=function(e,t,i){var n,r,o,s=this._node,a=this._skeletonSprites;for((e=e||cc._renderContext).save(),e._switchToArmatureMode(!0,this._worldTransform,t,i),n=0,r=a.length;n<r;n++)o=a[n]._renderCmd,a[n]._visible&&o&&o.rendering&&(o.rendering(e,t,i),o._dirtyFlag=0);if(e._switchToArmatureMode(!1),e.restore(),s._debugSlots||s._debugBones){e.setTransform(this._worldTransform,t,i);var c,l,u=s._skeleton,h=cc._drawingUtil;if(s._debugSlots){h.setDrawColor(0,0,255,255),h.setLineWidth(1);var d=[];for(n=0,r=u.slots.length;n<r;n++)(l=u.drawOrder[n]).attachment&&l.attachment.type==sp.ATTACHMENT_TYPE.REGION&&(c=l.attachment,sp._regionAttachment_updateSlotForCanvas(c,l,d),h.drawPoly(d,4,!0))}if(s._debugBones){var p;for(h.setLineWidth(2),h.setDrawColor(255,0,0,255),n=0,r=u.bones.length;n<r;n++){var _=(p=u.bones[n]).data.length*p.m00+p.worldX,f=p.data.length*p.m10+p.worldY;h.drawLine({x:p.worldX,y:p.worldY},{x:_,y:f})}for(h.setPointSize(4),h.setDrawColor(0,0,255,255),n=0,r=u.bones.length;n<r;n++)p=u.bones[n],h.drawPoint({x:p.worldX,y:p.worldY}),0===n&&h.setDrawColor(0,255,0,255)}}},e._createChildFormSkeletonData=function(){for(var e,t,i=this._node._skeleton,n=0,r=i.drawOrder.length;n<r;n++){var o=i.drawOrder[n],s=o.attachment;if(s instanceof spine.RegionAttachment){e=s.rendererObject,t=cc.rect(e.x,e.y,e.width,e.height);var a=new cc.Sprite;a.initWithTexture(e.page._texture,t,e.rotate,!1),a._rect.width=s.width,a._rect.height=s.height,a.setContentSize(s.width,s.height),a.setRotation(-(o.bone.worldRotation+s.rotation)),this._skeletonSprites.push(a),o.currentSprite=a}}},e._updateChild=function(){var e=this._node;e._skeleton.updateWorldTransform();for(var t=e._skeleton.drawOrder,i=0,n=t.length;i<n;i++){var r=t[i],o=r.attachment,s=r.currentSprite;if(o instanceof spine.RegionAttachment){if(!s){var a=o.rendererObject,c=cc.rect(a.x,a.y,a.width,a.height),l=new cc.Sprite;l.initWithTexture(a.page._texture,c,a.rotate,!1),l._rect.width=o.width,l._rect.height=o.height,l.setContentSize(o.width,o.height),this._skeletonSprites.push(l),s=r.currentSprite=l}s.setVisible(!0),s.setBlendFunc(cc.BLEND_SRC,r.data.additiveBlending?cc.ONE:cc.BLEND_DST);var u=r.bone;s.setPosition(u.worldX+o.x*u.m00+o.y*u.m01,u.worldY+o.x*u.m10+o.y*u.m11),s.setScale(u.worldScaleX,u.worldScaleY),s.setRotation(-(r.bone.worldRotation+o.rotation)),s.setOpacity(0|r.skeleton.a*r.a*255);var h=0|r.skeleton.r*r.r*255,d=0|r.skeleton.g*r.g*255,p=0|r.skeleton.b*r.b*255;s.setColor(cc.color(h,d,p))}else s&&s.setVisible(!1)}}}(),function(){sp.Skeleton.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this.setShaderProgram(cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR))};var e=sp.Skeleton.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=sp.Skeleton.WebGLRenderCmd,e.rendering=function(e){var t=this._node;this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix);var i=t.getColor(),n=t._skeleton;n.r=i.r/255,n.g=i.g/255,n.b=i.b/255,n.a=t.getOpacity()/255,t._premultipliedAlpha&&(n.r*=n.a,n.g*=n.a,n.b*=n.a);var r,o,s,a,c,l,u=new cc.V3F_C4B_T2F_Quad,h=t._blendFunc;for(c=0,l=n.slots.length;c<l;c++)if((a=n.drawOrder[c]).attachment){s=a.attachment;var d=t.getTextureAtlas(s);a.data.additiveBlending!=r?(o&&(o.drawQuads(),o.removeAllQuads()),r=!r,cc.glBlendFunc(h.src,r?cc.ONE:h.dst)):d!=o&&o&&(o.drawQuads(),o.removeAllQuads());var p=(o=d).getTotalQuads();if(o.getCapacity()==p&&(o.drawQuads(),o.removeAllQuads(),!o.resizeCapacity(2*o.getCapacity())))return;switch(a.attachment.type){case sp.ATTACHMENT_TYPE.REGION:sp._regionAttachment_updateQuad(s,a,u,t._premultipliedAlpha);break;case sp.ATTACHMENT_TYPE.MESH:sp._meshAttachment_updateQuad(s,a,u,t._premultipliedAlpha)}o.updateQuad(u,p)}if(o&&(o.drawQuads(),o.removeAllQuads()),t._debugBones||t._debugSlots){cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.current_stack.stack.push(cc.current_stack.top),cc.current_stack.top=this._stackMatrix;var _=cc._drawingUtil;if(t._debugSlots)for(_.setDrawColor(0,0,255,255),_.setLineWidth(1),c=0,l=n.slots.length;c<l;c++)if((a=n.drawOrder[c]).attachment&&a.attachment.type==sp.ATTACHMENT_TYPE.REGION){s=a.attachment,u=new cc.V3F_C4B_T2F_Quad,sp._regionAttachment_updateQuad(s,a,u);var f=[];f.push(cc.p(u.bl.vertices.x,u.bl.vertices.y)),f.push(cc.p(u.br.vertices.x,u.br.vertices.y)),f.push(cc.p(u.tr.vertices.x,u.tr.vertices.y)),f.push(cc.p(u.tl.vertices.x,u.tl.vertices.y)),_.drawPoly(f,4,!0)}if(t._debugBones){var m;for(_.setLineWidth(2),_.setDrawColor(255,0,0,255),c=0,l=n.bones.length;c<l;c++){var g=(m=n.bones[c]).data.length*m.m00+m.worldX,y=m.data.length*m.m10+m.worldY;_.drawLine(cc.p(m.worldX,m.worldY),cc.p(g,y))}for(_.setPointSize(4),_.setDrawColor(0,0,255,255),c=0,l=n.bones.length;c<l;c++)m=n.bones[c],_.drawPoint(cc.p(m.worldX,m.worldY)),0==c&&_.setDrawColor(0,255,0,255)}cc.kmGLPopMatrix()}},e._createChildFormSkeletonData=function(){},e._updateChild=function(){}}(),sp._atlasPage_createTexture_webGL=function(e,t){var i=cc.textureCache.addImage(t);e.rendererObject=new cc.TextureAtlas(i,128),e.width=i.getPixelsWide(),e.height=i.getPixelsHigh()},sp._atlasPage_createTexture_canvas=function(e,t){e._texture=cc.textureCache.addImage(t)},sp._atlasPage_disposeTexture=function(e){e.rendererObject.release()},sp._atlasLoader={spAtlasFile:null,setAtlasFile:function(e){this.spAtlasFile=e},load:function(e,t,i){var n=cc.path.join(cc.path.dirname(this.spAtlasFile),t);cc._renderType===cc._RENDER_TYPE_WEBGL?sp._atlasPage_createTexture_webGL(e,n):sp._atlasPage_createTexture_canvas(e,n)},unload:function(e){}},sp._regionAttachment_computeWorldVertices=function(e,t,i,n,r){var o=e.offset;t+=n.worldX,i+=n.worldY;var s=sp.VERTEX_INDEX;r[s.X1]=o[s.X1]*n.m00+o[s.Y1]*n.m01+t,r[s.Y1]=o[s.X1]*n.m10+o[s.Y1]*n.m11+i,r[s.X2]=o[s.X2]*n.m00+o[s.Y2]*n.m01+t,r[s.Y2]=o[s.X2]*n.m10+o[s.Y2]*n.m11+i,r[s.X3]=o[s.X3]*n.m00+o[s.Y3]*n.m01+t,r[s.Y3]=o[s.X3]*n.m10+o[s.Y3]*n.m11+i,r[s.X4]=o[s.X4]*n.m00+o[s.Y4]*n.m01+t,r[s.Y4]=o[s.X4]*n.m10+o[s.Y4]*n.m11+i},sp._regionAttachment_updateQuad=function(e,t,i,n){var r={};e.computeVertices(t.skeleton.x,t.skeleton.y,t,r);var o=t.skeleton.r*t.r*255,s=t.skeleton.g*t.g*255,a=t.skeleton.b*t.b*255,c=t.skeleton.a*t.a;n&&(o*=c,s*=c,a*=c);var l=255*c;i.bl.colors.r=i.tl.colors.r=i.tr.colors.r=i.br.colors.r=o,i.bl.colors.g=i.tl.colors.g=i.tr.colors.g=i.br.colors.g=s,i.bl.colors.b=i.tl.colors.b=i.tr.colors.b=i.br.colors.b=a,i.bl.colors.a=i.tl.colors.a=i.tr.colors.a=i.br.colors.a=l;var u=sp.VERTEX_INDEX;i.bl.vertices.x=r[u.X1],i.bl.vertices.y=r[u.Y1],i.tl.vertices.x=r[u.X2],i.tl.vertices.y=r[u.Y2],i.tr.vertices.x=r[u.X3],i.tr.vertices.y=r[u.Y3],i.br.vertices.x=r[u.X4],i.br.vertices.y=r[u.Y4],i.bl.texCoords.u=e.uvs[u.X1],i.bl.texCoords.v=e.uvs[u.Y1],i.tl.texCoords.u=e.uvs[u.X2],i.tl.texCoords.v=e.uvs[u.Y2],i.tr.texCoords.u=e.uvs[u.X3],i.tr.texCoords.v=e.uvs[u.Y3],i.br.texCoords.u=e.uvs[u.X4],i.br.texCoords.v=e.uvs[u.Y4]},sp._meshAttachment_updateQuad=function(e,t,i,n){var r={};e.computeVertices(t.skeleton.x,t.skeleton.y,t,r);var o=t.skeleton.r*t.r*255,s=t.skeleton.g*t.g*255,a=t.skeleton.b*t.b*255,c=t.skeleton.a*t.a;n&&(o*=c,s*=c,a*=c);var l=255*c;i.bl.colors.r=i.tl.colors.r=i.tr.colors.r=i.br.colors.r=o,i.bl.colors.g=i.tl.colors.g=i.tr.colors.g=i.br.colors.g=s,i.bl.colors.b=i.tl.colors.b=i.tr.colors.b=i.br.colors.b=a,i.bl.colors.a=i.tl.colors.a=i.tr.colors.a=i.br.colors.a=l;var u=sp.VERTEX_INDEX;i.bl.vertices.x=r[u.X1],i.bl.vertices.y=r[u.Y1],i.tl.vertices.x=r[u.X2],i.tl.vertices.y=r[u.Y2],i.tr.vertices.x=r[u.X3],i.tr.vertices.y=r[u.Y3],i.br.vertices.x=r[u.X4],i.br.vertices.y=r[u.Y4],i.bl.texCoords.u=e.uvs[u.X1],i.bl.texCoords.v=e.uvs[u.Y1],i.tl.texCoords.u=e.uvs[u.X2],i.tl.texCoords.v=e.uvs[u.Y2],i.tr.texCoords.u=e.uvs[u.X3],i.tr.texCoords.v=e.uvs[u.Y3],i.br.texCoords.u=e.uvs[u.X4],i.br.texCoords.v=e.uvs[u.Y4]},sp._regionAttachment_updateSlotForCanvas=function(e,t,i){if(i){var n={};e.computeVertices(t.skeleton.x,t.skeleton.y,t,n);var r=sp.VERTEX_INDEX;i.length=0,i.push(cc.p(n[r.X1],n[r.Y1])),i.push(cc.p(n[r.X4],n[r.Y4])),i.push(cc.p(n[r.X3],n[r.Y3])),i.push(cc.p(n[r.X2],n[r.Y2]))}},sp.ANIMATION_EVENT_TYPE={START:0,END:1,COMPLETE:2,EVENT:3},sp.SkeletonAnimation=sp.Skeleton.extend({_state:null,_target:null,_callback:null,init:function(){sp.Skeleton.prototype.init.call(this),this.setAnimationStateData(new spine.AnimationStateData(this._skeleton.data))},setAnimationStateData:function(e){var t=new spine.AnimationState(e);t.onStart=this._onAnimationStateStart.bind(this),t.onComplete=this._onAnimationStateComplete.bind(this),t.onEnd=this._onAnimationStateEnd.bind(this),t.onEvent=this._onAnimationStateEvent.bind(this),this._state=t},setMix:function(e,t,i){this._state.data.setMixByName(e,t,i)},setAnimationListener:function(e,t){this._target=e,this._callback=t},setAnimation:function(e,t,i){var n=this._skeleton.data.findAnimation(t);return n?this._state.setAnimation(e,n,i):(cc.log("Spine: Animation not found: "+t),null)},addAnimation:function(e,t,i,n){var r=this._skeleton.data.findAnimation(t);return r?this._state.addAnimation(e,r,i,n):(cc.log("Spine: Animation not found:"+t),null)},getCurrent:function(e){return this._state.getCurrent(e)},clearTracks:function(){this._state.clearTracks()},clearTrack:function(e){this._state.clearTrack(e)},update:function(e){this._super(e),e*=this._timeScale,this._state.update(e),this._state.apply(this._skeleton),this._skeleton.updateWorldTransform()},_onAnimationStateStart:function(e){this._animationStateCallback(e,sp.ANIMATION_EVENT_TYPE.START,null,0)},_onAnimationStateEnd:function(e){this._animationStateCallback(e,sp.ANIMATION_EVENT_TYPE.END,null,0)},_onAnimationStateComplete:function(e,t){this._animationStateCallback(e,sp.ANIMATION_EVENT_TYPE.COMPLETE,null,t)},_onAnimationStateEvent:function(e,t){this._animationStateCallback(e,sp.ANIMATION_EVENT_TYPE.EVENT,t,0)},_animationStateCallback:function(e,t,i,n){this._target&&this._callback&&this._callback.call(this._target,this,e,t,i,n)}}),sp.SkeletonAnimation.create=function(e,t,i){return new sp.SkeletonAnimation(e,t,i)},cc.pool={_pool:{},_releaseCB:function(){this.release()},_autoRelease:function(e){var t=void 0!==e._running&&!e._running;cc.director.getScheduler().scheduleCallbackForTarget(e,this._releaseCB,0,0,0,t)},putInPool:function(e){var t=e.constructor.prototype.__pid;if(!t){var i={writable:!0,enumerable:!1,configurable:!0};i.value=ClassManager.getNewID(),Object.defineProperty(e.constructor.prototype,"__pid",i)}this._pool[t]||(this._pool[t]=[]),e.retain&&e.retain(),e.unuse&&e.unuse(),this._pool[t].push(e)},hasObject:function(e){var t=e.prototype.__pid,i=this._pool[t];return!(!i||0==i.length)},removeObject:function(e){var t=e.constructor.prototype.__pid;if(t){var i=this._pool[t];if(i)for(var n=0;n<i.length;n++)e===i[n]&&(e.release&&e.release(),i.splice(n,1))}},getFromPool:function(e){if(this.hasObject(e)){var t=e.prototype.__pid,i=this._pool[t],n=Array.prototype.slice.call(arguments);n.shift();var r=i.pop();return r.reuse&&r.reuse.apply(r,n),cc.sys.isNative&&r.release&&this._autoRelease(r),r}},drainAllPools:function(){for(var e in this._pool)for(var t=0;t<this._pool[e].length;t++){var i=this._pool[e][t];i.release&&i.release()}this._pool={}}},function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){var i=t[s][1][e];return r(i||e)},l,l.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t){var i=e("./core");i.apiLoader=function(e,t){return i.apiLoader.services[e][t]},i.apiLoader.services={},i.XML.Parser=e("./xml/browser_parser"),e("./http/xhr"),"undefined"!=typeof window&&(window.AWS=i),void 0!==t&&(t.exports=i),i.apiLoader.services.cloudwatch={},i.CloudWatch=i.Service.defineService("cloudwatch",["2010-08-01"]),i.apiLoader.services.cloudwatch["2010-08-01"]={metadata:{apiVersion:"2010-08-01",endpointPrefix:"monitoring",serviceAbbreviation:"CloudWatch",serviceFullName:"Amazon CloudWatch",signatureVersion:"v4",xmlNamespace:"http://monitoring.amazonaws.com/doc/2010-08-01/",protocol:"query"},operations:{DeleteAlarms:{input:{type:"structure",required:["AlarmNames"],members:{AlarmNames:{shape:"S2"}}},http:{}},DescribeAlarmHistory:{input:{type:"structure",members:{AlarmName:{},HistoryItemType:{},StartDate:{type:"timestamp"},EndDate:{type:"timestamp"},MaxRecords:{type:"integer"},NextToken:{}}},output:{resultWrapper:"DescribeAlarmHistoryResult",type:"structure",members:{AlarmHistoryItems:{type:"list",member:{type:"structure",members:{AlarmName:{},Timestamp:{type:"timestamp"},HistoryItemType:{},HistorySummary:{},HistoryData:{}}}},NextToken:{}}},http:{}},DescribeAlarms:{input:{type:"structure",members:{AlarmNames:{shape:"S2"},AlarmNamePrefix:{},StateValue:{},ActionPrefix:{},MaxRecords:{type:"integer"},NextToken:{}}},output:{resultWrapper:"DescribeAlarmsResult",type:"structure",members:{MetricAlarms:{shape:"Sj"},NextToken:{}}},http:{}},DescribeAlarmsForMetric:{input:{type:"structure",required:["MetricName","Namespace"],members:{MetricName:{},Namespace:{},Statistic:{},Dimensions:{shape:"Sv"},Period:{type:"integer"},Unit:{}}},output:{resultWrapper:"DescribeAlarmsForMetricResult",type:"structure",members:{MetricAlarms:{shape:"Sj"}}},http:{}},DisableAlarmActions:{input:{type:"structure",required:["AlarmNames"],members:{AlarmNames:{shape:"S2"}}},http:{}},EnableAlarmActions:{input:{type:"structure",required:["AlarmNames"],members:{AlarmNames:{shape:"S2"}}},http:{}},GetMetricStatistics:{input:{type:"structure",required:["Namespace","MetricName","StartTime","EndTime","Period","Statistics"],members:{Namespace:{},MetricName:{},Dimensions:{shape:"Sv"},StartTime:{type:"timestamp"},EndTime:{type:"timestamp"},Period:{type:"integer"},Statistics:{type:"list",member:{}},Unit:{}}},output:{resultWrapper:"GetMetricStatisticsResult",type:"structure",members:{Label:{},Datapoints:{type:"list",member:{type:"structure",members:{Timestamp:{type:"timestamp"},SampleCount:{type:"double"},Average:{type:"double"},Sum:{type:"double"},Minimum:{type:"double"},Maximum:{type:"double"},Unit:{}},xmlOrder:["Timestamp","SampleCount","Average","Sum","Minimum","Maximum","Unit"]}}}},http:{}},ListMetrics:{input:{type:"structure",members:{Namespace:{},MetricName:{},Dimensions:{type:"list",member:{type:"structure",required:["Name"],members:{Name:{},Value:{}}}},NextToken:{}}},output:{xmlOrder:["Metrics","NextToken"],resultWrapper:"ListMetricsResult",type:"structure",members:{Metrics:{type:"list",member:{type:"structure",members:{Namespace:{},MetricName:{},Dimensions:{shape:"Sv"}},xmlOrder:["Namespace","MetricName","Dimensions"]}},NextToken:{}}},http:{}},PutMetricAlarm:{input:{type:"structure",required:["AlarmName","MetricName","Namespace","Statistic","Period","EvaluationPeriods","Threshold","ComparisonOperator"],members:{AlarmName:{},AlarmDescription:{},ActionsEnabled:{type:"boolean"},OKActions:{shape:"So"},AlarmActions:{shape:"So"},InsufficientDataActions:{shape:"So"},MetricName:{},Namespace:{},Statistic:{},Dimensions:{shape:"Sv"},Period:{type:"integer"},Unit:{},EvaluationPeriods:{type:"integer"},Threshold:{type:"double"},ComparisonOperator:{}}},http:{}},PutMetricData:{input:{type:"structure",required:["Namespace","MetricData"],members:{Namespace:{},MetricData:{type:"list",member:{type:"structure",required:["MetricName"],members:{MetricName:{},Dimensions:{shape:"Sv"},Timestamp:{type:"timestamp"},Value:{type:"double"},StatisticValues:{type:"structure",required:["SampleCount","Sum","Minimum","Maximum"],members:{SampleCount:{type:"double"},Sum:{type:"double"},Minimum:{type:"double"},Maximum:{type:"double"}}},Unit:{}}}}}},http:{}},SetAlarmState:{input:{type:"structure",required:["AlarmName","StateValue","StateReason"],members:{AlarmName:{},StateValue:{},StateReason:{},StateReasonData:{}}},http:{}}},shapes:{S2:{type:"list",member:{}},Sj:{type:"list",member:{type:"structure",members:{AlarmName:{},AlarmArn:{},AlarmDescription:{},AlarmConfigurationUpdatedTimestamp:{type:"timestamp"},ActionsEnabled:{type:"boolean"},OKActions:{shape:"So"},AlarmActions:{shape:"So"},InsufficientDataActions:{shape:"So"},StateValue:{},StateReason:{},StateReasonData:{},StateUpdatedTimestamp:{type:"timestamp"},MetricName:{},Namespace:{},Statistic:{},Dimensions:{shape:"Sv"},Period:{type:"integer"},Unit:{},EvaluationPeriods:{type:"integer"},Threshold:{type:"double"},ComparisonOperator:{}},xmlOrder:["AlarmName","AlarmArn","AlarmDescription","AlarmConfigurationUpdatedTimestamp","ActionsEnabled","OKActions","AlarmActions","InsufficientDataActions","StateValue","StateReason","StateReasonData","StateUpdatedTimestamp","MetricName","Namespace","Statistic","Dimensions","Period","Unit","EvaluationPeriods","Threshold","ComparisonOperator"]}},So:{type:"list",member:{}},Sv:{type:"list",member:{type:"structure",required:["Name","Value"],members:{Name:{},Value:{}},xmlOrder:["Name","Value"]}}},paginators:{DescribeAlarmHistory:{input_token:"NextToken",output_token:"NextToken",limit_key:"MaxRecords",result_key:"AlarmHistoryItems"},DescribeAlarms:{input_token:"NextToken",output_token:"NextToken",limit_key:"MaxRecords",result_key:"MetricAlarms"},DescribeAlarmsForMetric:{result_key:"MetricAlarms"},ListMetrics:{input_token:"NextToken",output_token:"NextToken",result_key:"Metrics"}}},i.apiLoader.services.cloudwatchlogs={},i.CloudWatchLogs=i.Service.defineService("cloudwatchlogs",["2014-03-28"]),i.apiLoader.services.cloudwatchlogs["2014-03-28"]={version:"2.0",metadata:{apiVersion:"2014-03-28",endpointPrefix:"logs",jsonVersion:"1.1",serviceFullName:"Amazon CloudWatch Logs",signatureVersion:"v4",targetPrefix:"Logs_20140328",protocol:"json"},operations:{CreateLogGroup:{input:{type:"structure",required:["logGroupName"],members:{logGroupName:{}}},http:{}},CreateLogStream:{input:{type:"structure",required:["logGroupName","logStreamName"],members:{logGroupName:{},logStreamName:{}}},http:{}},DeleteLogGroup:{input:{type:"structure",required:["logGroupName"],members:{logGroupName:{}}},http:{}},DeleteLogStream:{input:{type:"structure",required:["logGroupName","logStreamName"],members:{logGroupName:{},logStreamName:{}}},http:{}},DeleteMetricFilter:{input:{type:"structure",required:["logGroupName","filterName"],members:{logGroupName:{},filterName:{}}},http:{}},DeleteRetentionPolicy:{input:{type:"structure",required:["logGroupName"],members:{logGroupName:{}}},http:{}},DescribeLogGroups:{input:{type:"structure",members:{logGroupNamePrefix:{},nextToken:{},limit:{type:"integer"}}},output:{type:"structure",members:{logGroups:{type:"list",member:{type:"structure",members:{logGroupName:{},creationTime:{type:"long"},retentionInDays:{type:"integer"},metricFilterCount:{type:"integer"},arn:{},storedBytes:{type:"long"}}}},nextToken:{}}},http:{}},DescribeLogStreams:{input:{type:"structure",required:["logGroupName"],members:{logGroupName:{},logStreamNamePrefix:{},orderBy:{},descending:{type:"boolean"},nextToken:{},limit:{type:"integer"}}},output:{type:"structure",members:{logStreams:{type:"list",member:{type:"structure",members:{logStreamName:{},creationTime:{type:"long"},firstEventTimestamp:{type:"long"},lastEventTimestamp:{type:"long"},lastIngestionTime:{type:"long"},uploadSequenceToken:{},arn:{},storedBytes:{type:"long"}}}},nextToken:{}}},http:{}},DescribeMetricFilters:{input:{type:"structure",required:["logGroupName"],members:{logGroupName:{},filterNamePrefix:{},nextToken:{},limit:{type:"integer"}}},output:{type:"structure",members:{metricFilters:{type:"list",member:{type:"structure",members:{filterName:{},filterPattern:{},metricTransformations:{shape:"Sx"},creationTime:{type:"long"}}}},nextToken:{}}},http:{}},FilterLogEvents:{input:{type:"structure",required:["logGroupName"],members:{logGroupName:{},logStreamNames:{type:"list",member:{}},startTime:{type:"long"},endTime:{type:"long"},filterPattern:{},nextToken:{},limit:{type:"integer"},interleaved:{type:"boolean"}}},output:{type:"structure",members:{events:{type:"list",member:{type:"structure",members:{logStreamName:{},timestamp:{type:"long"},message:{},ingestionTime:{type:"long"},eventId:{}}}},searchedLogStreams:{type:"list",member:{type:"structure",members:{logStreamName:{},searchedCompletely:{type:"boolean"}}}},nextToken:{}}},http:{}},GetLogEvents:{input:{type:"structure",required:["logGroupName","logStreamName"],members:{logGroupName:{},logStreamName:{},startTime:{type:"long"},endTime:{type:"long"},nextToken:{},limit:{type:"integer"},startFromHead:{type:"boolean"}}},output:{type:"structure",members:{events:{type:"list",member:{type:"structure",members:{timestamp:{type:"long"},message:{},ingestionTime:{type:"long"}}}},nextForwardToken:{},nextBackwardToken:{}}},http:{}},PutLogEvents:{input:{type:"structure",required:["logGroupName","logStreamName","logEvents"],members:{logGroupName:{},logStreamName:{},logEvents:{type:"list",member:{type:"structure",required:["timestamp","message"],members:{timestamp:{type:"long"},message:{}}}},sequenceToken:{}}},output:{type:"structure",members:{nextSequenceToken:{},rejectedLogEventsInfo:{type:"structure",members:{tooNewLogEventStartIndex:{type:"integer"},tooOldLogEventEndIndex:{type:"integer"},expiredLogEventEndIndex:{type:"integer"}}}}},http:{}},PutMetricFilter:{input:{type:"structure",required:["logGroupName","filterName","filterPattern","metricTransformations"],members:{logGroupName:{},filterName:{},filterPattern:{},metricTransformations:{shape:"Sx"}}},http:{}},PutRetentionPolicy:{input:{type:"structure",required:["logGroupName","retentionInDays"],members:{logGroupName:{},retentionInDays:{type:"integer"}}},http:{}},TestMetricFilter:{input:{type:"structure",required:["filterPattern","logEventMessages"],members:{filterPattern:{},logEventMessages:{type:"list",member:{}}}},output:{type:"structure",members:{matches:{type:"list",member:{type:"structure",members:{eventNumber:{type:"long"},eventMessage:{},extractedValues:{type:"map",key:{},value:{}}}}}}},http:{}}},shapes:{Sx:{type:"list",member:{type:"structure",required:["metricName","metricNamespace","metricValue"],members:{metricName:{},metricNamespace:{},metricValue:{}}}}},paginators:{DescribeLogGroups:{input_token:"nextToken",output_token:"nextToken",limit_key:"limit",result_key:"logGroups"},DescribeLogStreams:{input_token:"nextToken",output_token:"nextToken",limit_key:"limit",result_key:"logStreams"},DescribeMetricFilters:{input_token:"nextToken",output_token:"nextToken",limit_key:"limit",result_key:"metricFilters"},GetLogEvents:{input_token:"nextToken",output_token:"nextForwardToken",limit_key:"limit",result_key:"events"}}},i.apiLoader.services.cognitoidentity={},i.CognitoIdentity=i.Service.defineService("cognitoidentity",["2014-06-30"]),e("./services/cognitoidentity"),i.apiLoader.services.cognitoidentity["2014-06-30"]={metadata:{apiVersion:"2014-06-30",endpointPrefix:"cognito-identity",jsonVersion:"1.1",serviceFullName:"Amazon Cognito Identity",signatureVersion:"v4",targetPrefix:"AWSCognitoIdentityService",protocol:"json"},operations:{CreateIdentityPool:{input:{type:"structure",required:["IdentityPoolName","AllowUnauthenticatedIdentities"],members:{IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:"boolean"},SupportedLoginProviders:{shape:"S4"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:"S8"}}},output:{shape:"Sa"},http:{}},DeleteIdentityPool:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}},http:{}},DescribeIdentity:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{}}},output:{shape:"Sf"},http:{}},DescribeIdentityPool:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}},output:{shape:"Sa"},http:{}},GetCredentialsForIdentity:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{},Logins:{shape:"Sk"}}},output:{type:"structure",members:{IdentityId:{},Credentials:{type:"structure",members:{AccessKeyId:{},SecretKey:{},SessionToken:{},Expiration:{type:"timestamp"}}}}},http:{}},GetId:{input:{type:"structure",required:["IdentityPoolId"],members:{AccountId:{},IdentityPoolId:{},Logins:{shape:"Sk"}}},output:{type:"structure",members:{IdentityId:{}}},http:{}},GetIdentityPoolRoles:{input:{type:"structure",members:{IdentityPoolId:{}}},output:{type:"structure",members:{IdentityPoolId:{},Roles:{shape:"Sw"}}},http:{}},GetOpenIdToken:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{},Logins:{shape:"Sk"}}},output:{type:"structure",members:{IdentityId:{},Token:{}}},http:{}},GetOpenIdTokenForDeveloperIdentity:{input:{type:"structure",required:["IdentityPoolId","Logins"],members:{IdentityPoolId:{},IdentityId:{},Logins:{shape:"Sk"},TokenDuration:{type:"long"}}},output:{type:"structure",members:{IdentityId:{},Token:{}}},http:{}},ListIdentities:{input:{type:"structure",required:["IdentityPoolId","MaxResults"],members:{IdentityPoolId:{},MaxResults:{type:"integer"},NextToken:{}}},output:{type:"structure",members:{IdentityPoolId:{},Identities:{type:"list",member:{shape:"Sf"}},NextToken:{}}},http:{}},ListIdentityPools:{input:{type:"structure",required:["MaxResults"],members:{MaxResults:{type:"integer"},NextToken:{}}},output:{type:"structure",members:{IdentityPools:{type:"list",member:{type:"structure",members:{IdentityPoolId:{},IdentityPoolName:{}}}},NextToken:{}}},http:{}},LookupDeveloperIdentity:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{},IdentityId:{},DeveloperUserIdentifier:{},MaxResults:{type:"integer"},NextToken:{}}},output:{type:"structure",members:{IdentityId:{},DeveloperUserIdentifierList:{type:"list",member:{}},NextToken:{}}},http:{}},MergeDeveloperIdentities:{input:{type:"structure",required:["SourceUserIdentifier","DestinationUserIdentifier","DeveloperProviderName","IdentityPoolId"],members:{SourceUserIdentifier:{},DestinationUserIdentifier:{},DeveloperProviderName:{},IdentityPoolId:{}}},output:{type:"structure",members:{IdentityId:{}}},http:{}},SetIdentityPoolRoles:{input:{type:"structure",required:["IdentityPoolId","Roles"],members:{IdentityPoolId:{},Roles:{shape:"Sw"}}},http:{}},UnlinkDeveloperIdentity:{input:{type:"structure",required:["IdentityId","IdentityPoolId","DeveloperProviderName","DeveloperUserIdentifier"],members:{IdentityId:{},IdentityPoolId:{},DeveloperProviderName:{},DeveloperUserIdentifier:{}}},http:{}},UnlinkIdentity:{input:{type:"structure",required:["IdentityId","Logins","LoginsToRemove"],members:{IdentityId:{},Logins:{shape:"Sk"},LoginsToRemove:{shape:"Sg"}}},http:{}},UpdateIdentityPool:{input:{shape:"Sa"},output:{shape:"Sa"},http:{}}},shapes:{S4:{type:"map",key:{},value:{}},S8:{type:"list",member:{}},Sa:{type:"structure",required:["IdentityPoolId","IdentityPoolName","AllowUnauthenticatedIdentities"],members:{IdentityPoolId:{},IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:"boolean"},SupportedLoginProviders:{shape:"S4"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:"S8"}}},Sf:{type:"structure",members:{IdentityId:{},Logins:{shape:"Sg"},CreationDate:{type:"timestamp"},LastModifiedDate:{type:"timestamp"}}},Sg:{type:"list",member:{}},Sk:{type:"map",key:{},value:{}},Sw:{type:"map",key:{},value:{}}}},i.apiLoader.services.cognitosync={},i.CognitoSync=i.Service.defineService("cognitosync",["2014-06-30"]),i.apiLoader.services.cognitosync["2014-06-30"]={version:"2.0",metadata:{apiVersion:"2014-06-30",endpointPrefix:"cognito-sync",jsonVersion:"1.1",serviceFullName:"Amazon Cognito Sync",signatureVersion:"v4",protocol:"rest-json"},operations:{BulkPublish:{http:{requestUri:"/identitypools/{IdentityPoolId}/bulkpublish",responseCode:200},input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"}}},output:{type:"structure",members:{IdentityPoolId:{}}}},DeleteDataset:{http:{method:"DELETE",requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}/datasets/{DatasetName}",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId","DatasetName"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},DatasetName:{location:"uri",locationName:"DatasetName"}}},output:{type:"structure",members:{Dataset:{shape:"S8"}}}},DescribeDataset:{http:{method:"GET",requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}/datasets/{DatasetName}",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId","DatasetName"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},DatasetName:{location:"uri",locationName:"DatasetName"}}},output:{type:"structure",members:{Dataset:{shape:"S8"}}}},DescribeIdentityPoolUsage:{http:{method:"GET",requestUri:"/identitypools/{IdentityPoolId}",responseCode:200},input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"}}},output:{type:"structure",members:{IdentityPoolUsage:{shape:"Sg"}}}},DescribeIdentityUsage:{http:{method:"GET",requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"}}},output:{type:"structure",members:{IdentityUsage:{type:"structure",members:{IdentityId:{},IdentityPoolId:{},LastModifiedDate:{type:"timestamp"},DatasetCount:{type:"integer"},DataStorage:{type:"long"}}}}}},GetBulkPublishDetails:{http:{requestUri:"/identitypools/{IdentityPoolId}/getBulkPublishDetails",responseCode:200},input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"}}},output:{type:"structure",members:{IdentityPoolId:{},BulkPublishStartTime:{type:"timestamp"},BulkPublishCompleteTime:{type:"timestamp"},BulkPublishStatus:{},FailureMessage:{}}}},GetCognitoEvents:{http:{method:"GET",requestUri:"/identitypools/{IdentityPoolId}/events",responseCode:200},input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"}}},output:{type:"structure",members:{Events:{shape:"Sq"}}}},GetIdentityPoolConfiguration:{http:{method:"GET",requestUri:"/identitypools/{IdentityPoolId}/configuration",responseCode:200},input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"}}},output:{type:"structure",members:{IdentityPoolId:{},PushSync:{shape:"Sv"},CognitoStreams:{shape:"Sz"}}}},ListDatasets:{http:{method:"GET",requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}/datasets",responseCode:200},input:{type:"structure",required:["IdentityId","IdentityPoolId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},NextToken:{location:"querystring",locationName:"nextToken"},MaxResults:{location:"querystring",locationName:"maxResults",type:"integer"}}},output:{type:"structure",members:{Datasets:{type:"list",member:{shape:"S8"}},Count:{type:"integer"},NextToken:{}}}},ListIdentityPoolUsage:{http:{method:"GET",requestUri:"/identitypools",responseCode:200},input:{type:"structure",members:{NextToken:{location:"querystring",locationName:"nextToken"},MaxResults:{location:"querystring",locationName:"maxResults",type:"integer"}}},output:{type:"structure",members:{IdentityPoolUsages:{type:"list",member:{shape:"Sg"}},MaxResults:{type:"integer"},Count:{type:"integer"},NextToken:{}}}},ListRecords:{http:{method:"GET",requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}/datasets/{DatasetName}/records",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId","DatasetName"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},DatasetName:{location:"uri",locationName:"DatasetName"},LastSyncCount:{location:"querystring",locationName:"lastSyncCount",type:"long"},NextToken:{location:"querystring",locationName:"nextToken"},MaxResults:{location:"querystring",locationName:"maxResults",type:"integer"},SyncSessionToken:{location:"querystring",locationName:"syncSessionToken"}}},output:{type:"structure",members:{Records:{shape:"S1c"},NextToken:{},Count:{type:"integer"},DatasetSyncCount:{type:"long"},LastModifiedBy:{},MergedDatasetNames:{type:"list",member:{}},DatasetExists:{type:"boolean"},DatasetDeletedAfterRequestedSyncCount:{type:"boolean"},SyncSessionToken:{}}}},RegisterDevice:{http:{requestUri:"/identitypools/{IdentityPoolId}/identity/{IdentityId}/device",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId","Platform","Token"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},Platform:{},Token:{}}},output:{type:"structure",members:{DeviceId:{}}}},SetCognitoEvents:{http:{requestUri:"/identitypools/{IdentityPoolId}/events",responseCode:200},input:{type:"structure",required:["IdentityPoolId","Events"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},Events:{shape:"Sq"}}}},SetIdentityPoolConfiguration:{http:{requestUri:"/identitypools/{IdentityPoolId}/configuration",responseCode:200},input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},PushSync:{shape:"Sv"},CognitoStreams:{shape:"Sz"}}},output:{type:"structure",members:{IdentityPoolId:{},PushSync:{shape:"Sv"},CognitoStreams:{shape:"Sz"}}}},SubscribeToDataset:{http:{requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}/datasets/{DatasetName}/subscriptions/{DeviceId}",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId","DatasetName","DeviceId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},DatasetName:{location:"uri",locationName:"DatasetName"},DeviceId:{location:"uri",locationName:"DeviceId"}}},output:{type:"structure",members:{}}},UnsubscribeFromDataset:{http:{method:"DELETE",requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}/datasets/{DatasetName}/subscriptions/{DeviceId}",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId","DatasetName","DeviceId"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},DatasetName:{location:"uri",locationName:"DatasetName"},DeviceId:{location:"uri",locationName:"DeviceId"}}},output:{type:"structure",members:{}}},UpdateRecords:{http:{requestUri:"/identitypools/{IdentityPoolId}/identities/{IdentityId}/datasets/{DatasetName}",responseCode:200},input:{type:"structure",required:["IdentityPoolId","IdentityId","DatasetName","SyncSessionToken"],members:{IdentityPoolId:{location:"uri",locationName:"IdentityPoolId"},IdentityId:{location:"uri",locationName:"IdentityId"},DatasetName:{location:"uri",locationName:"DatasetName"},DeviceId:{},RecordPatches:{type:"list",member:{type:"structure",required:["Op","Key","SyncCount"],members:{Op:{},Key:{},Value:{},SyncCount:{type:"long"},DeviceLastModifiedDate:{type:"timestamp"}}}},SyncSessionToken:{},ClientContext:{location:"header",locationName:"x-amz-Client-Context"}}},output:{type:"structure",members:{Records:{shape:"S1c"}}}}},shapes:{S8:{type:"structure",members:{IdentityId:{},DatasetName:{},CreationDate:{type:"timestamp"},LastModifiedDate:{type:"timestamp"},LastModifiedBy:{},DataStorage:{type:"long"},NumRecords:{type:"long"}}},Sg:{type:"structure",members:{IdentityPoolId:{},SyncSessionsCount:{type:"long"},DataStorage:{type:"long"},LastModifiedDate:{type:"timestamp"}}},Sq:{type:"map",key:{},value:{}},Sv:{type:"structure",members:{ApplicationArns:{type:"list",member:{}},RoleArn:{}}},Sz:{type:"structure",members:{StreamName:{},RoleArn:{},StreamingStatus:{}}},S1c:{type:"list",member:{type:"structure",members:{Key:{},Value:{},SyncCount:{type:"long"},LastModifiedDate:{type:"timestamp"},LastModifiedBy:{},DeviceLastModifiedDate:{type:"timestamp"}}}}}},i.apiLoader.services.dynamodb={},i.DynamoDB=i.Service.defineService("dynamodb",["2011-12-05","2012-08-10"]),e("./services/dynamodb"),i.apiLoader.services.dynamodb["2012-08-10"]={version:"2.0",metadata:{apiVersion:"2012-08-10",endpointPrefix:"dynamodb",jsonVersion:"1.0",serviceAbbreviation:"DynamoDB",serviceFullName:"Amazon DynamoDB",signatureVersion:"v4",targetPrefix:"DynamoDB_20120810",protocol:"json"},operations:{BatchGetItem:{input:{type:"structure",required:["RequestItems"],members:{RequestItems:{shape:"S2"},ReturnConsumedCapacity:{}}},output:{type:"structure",members:{Responses:{type:"map",key:{},value:{shape:"Sr"}},UnprocessedKeys:{shape:"S2"},ConsumedCapacity:{shape:"St"}}},http:{}},BatchWriteItem:{input:{type:"structure",required:["RequestItems"],members:{RequestItems:{shape:"S10"},ReturnConsumedCapacity:{},ReturnItemCollectionMetrics:{}}},output:{type:"structure",members:{UnprocessedItems:{shape:"S10"},ItemCollectionMetrics:{type:"map",key:{},value:{type:"list",member:{shape:"S1a"}}},ConsumedCapacity:{shape:"St"}}},http:{}},CreateTable:{input:{type:"structure",required:["AttributeDefinitions","TableName","KeySchema","ProvisionedThroughput"],members:{AttributeDefinitions:{shape:"S1f"},TableName:{},KeySchema:{shape:"S1j"},LocalSecondaryIndexes:{type:"list",member:{type:"structure",required:["IndexName","KeySchema","Projection"],members:{IndexName:{},KeySchema:{shape:"S1j"},Projection:{shape:"S1o"}}}},GlobalSecondaryIndexes:{type:"list",member:{type:"structure",required:["IndexName","KeySchema","Projection","ProvisionedThroughput"],members:{IndexName:{},KeySchema:{shape:"S1j"},Projection:{shape:"S1o"},ProvisionedThroughput:{shape:"S1u"}}}},ProvisionedThroughput:{shape:"S1u"}}},output:{type:"structure",members:{TableDescription:{shape:"S1x"}}},http:{}},DeleteItem:{input:{type:"structure",required:["TableName","Key"],members:{TableName:{},Key:{shape:"S6"},Expected:{shape:"S29"},ConditionalOperator:{},ReturnValues:{},ReturnConsumedCapacity:{},ReturnItemCollectionMetrics:{},ConditionExpression:{},ExpressionAttributeNames:{shape:"Sm"},ExpressionAttributeValues:{shape:"S2h"}}},output:{type:"structure",members:{Attributes:{shape:"Ss"},ConsumedCapacity:{shape:"Su"},ItemCollectionMetrics:{shape:"S1a"}}},http:{}},DeleteTable:{input:{type:"structure",required:["TableName"],members:{TableName:{}}},output:{type:"structure",members:{TableDescription:{shape:"S1x"}}},http:{}},DescribeTable:{input:{type:"structure",required:["TableName"],members:{TableName:{}}},output:{type:"structure",members:{Table:{shape:"S1x"}}},http:{}},GetItem:{input:{type:"structure",required:["TableName","Key"],members:{TableName:{},Key:{shape:"S6"},AttributesToGet:{shape:"Sj"},ConsistentRead:{type:"boolean"},ReturnConsumedCapacity:{},ProjectionExpression:{},ExpressionAttributeNames:{shape:"Sm"}}},output:{type:"structure",members:{Item:{shape:"Ss"},ConsumedCapacity:{shape:"Su"}}},http:{}},ListTables:{input:{type:"structure",members:{ExclusiveStartTableName:{},Limit:{type:"integer"}}},output:{type:"structure",members:{TableNames:{type:"list",member:{}},LastEvaluatedTableName:{}}},http:{}},PutItem:{input:{type:"structure",required:["TableName","Item"],members:{TableName:{},Item:{shape:"S14"},Expected:{shape:"S29"},ReturnValues:{},ReturnConsumedCapacity:{},ReturnItemCollectionMetrics:{},ConditionalOperator:{},ConditionExpression:{},ExpressionAttributeNames:{shape:"Sm"},ExpressionAttributeValues:{shape:"S2h"}}},output:{type:"structure",members:{Attributes:{shape:"Ss"},ConsumedCapacity:{shape:"Su"},ItemCollectionMetrics:{shape:"S1a"}}},http:{}},Query:{input:{type:"structure",required:["TableName"],members:{TableName:{},IndexName:{},Select:{},AttributesToGet:{shape:"Sj"},Limit:{type:"integer"},ConsistentRead:{type:"boolean"},KeyConditions:{type:"map",key:{},value:{shape:"S30"}},QueryFilter:{shape:"S31"},ConditionalOperator:{},ScanIndexForward:{type:"boolean"},ExclusiveStartKey:{shape:"S6"},ReturnConsumedCapacity:{},ProjectionExpression:{},FilterExpression:{},KeyConditionExpression:{},ExpressionAttributeNames:{shape:"Sm"},ExpressionAttributeValues:{shape:"S2h"}}},output:{type:"structure",members:{Items:{shape:"Sr"},Count:{type:"integer"},ScannedCount:{type:"integer"},LastEvaluatedKey:{shape:"S6"},ConsumedCapacity:{shape:"Su"}}},http:{}},Scan:{input:{type:"structure",required:["TableName"],members:{TableName:{},IndexName:{},AttributesToGet:{shape:"Sj"},Limit:{type:"integer"},Select:{},ScanFilter:{shape:"S31"},ConditionalOperator:{},ExclusiveStartKey:{shape:"S6"},ReturnConsumedCapacity:{},TotalSegments:{type:"integer"},Segment:{type:"integer"},ProjectionExpression:{},FilterExpression:{},ExpressionAttributeNames:{shape:"Sm"},ExpressionAttributeValues:{shape:"S2h"}}},output:{type:"structure",members:{Items:{shape:"Sr"},Count:{type:"integer"},ScannedCount:{type:"integer"},LastEvaluatedKey:{shape:"S6"},ConsumedCapacity:{shape:"Su"}}},http:{}},UpdateItem:{input:{type:"structure",required:["TableName","Key"],members:{TableName:{},Key:{shape:"S6"},AttributeUpdates:{type:"map",key:{},value:{type:"structure",members:{Value:{shape:"S8"},Action:{}}}},Expected:{shape:"S29"},ConditionalOperator:{},ReturnValues:{},ReturnConsumedCapacity:{},ReturnItemCollectionMetrics:{},UpdateExpression:{},ConditionExpression:{},ExpressionAttributeNames:{shape:"Sm"},ExpressionAttributeValues:{shape:"S2h"}}},output:{type:"structure",members:{Attributes:{shape:"Ss"},ConsumedCapacity:{shape:"Su"},ItemCollectionMetrics:{shape:"S1a"}}},http:{}},UpdateTable:{input:{type:"structure",required:["TableName"],members:{AttributeDefinitions:{shape:"S1f"},TableName:{},ProvisionedThroughput:{shape:"S1u"},GlobalSecondaryIndexUpdates:{type:"list",member:{type:"structure",members:{Update:{type:"structure",required:["IndexName","ProvisionedThroughput"],members:{IndexName:{},ProvisionedThroughput:{shape:"S1u"}}},Create:{type:"structure",required:["IndexName","KeySchema","Projection","ProvisionedThroughput"],members:{IndexName:{},KeySchema:{shape:"S1j"},Projection:{shape:"S1o"},ProvisionedThroughput:{shape:"S1u"}}},Delete:{type:"structure",required:["IndexName"],members:{IndexName:{}}}}}}}},output:{type:"structure",members:{TableDescription:{shape:"S1x"}}},http:{}}},shapes:{S2:{type:"map",key:{},value:{type:"structure",required:["Keys"],members:{Keys:{type:"list",member:{shape:"S6"}},AttributesToGet:{shape:"Sj"},ConsistentRead:{type:"boolean"},ProjectionExpression:{},ExpressionAttributeNames:{shape:"Sm"}}}},S6:{type:"map",key:{},value:{shape:"S8"}},S8:{type:"structure",members:{S:{},N:{},B:{type:"blob"},SS:{type:"list",member:{}},NS:{type:"list",member:{}},BS:{type:"list",member:{type:"blob"}},M:{type:"map",key:{},value:{shape:"S8"}},L:{type:"list",member:{shape:"S8"}},NULL:{type:"boolean"},BOOL:{type:"boolean"}}},Sj:{type:"list",member:{}},Sm:{type:"map",key:{},value:{}},Sr:{type:"list",member:{shape:"Ss"}},Ss:{type:"map",key:{},value:{shape:"S8"}},St:{type:"list",member:{shape:"Su"}},Su:{type:"structure",members:{TableName:{},CapacityUnits:{type:"double"},Table:{shape:"Sw"},LocalSecondaryIndexes:{shape:"Sx"},GlobalSecondaryIndexes:{shape:"Sx"}}},Sw:{type:"structure",members:{CapacityUnits:{type:"double"}}},Sx:{type:"map",key:{},value:{shape:"Sw"}},S10:{type:"map",key:{},value:{type:"list",member:{type:"structure",members:{PutRequest:{type:"structure",required:["Item"],members:{Item:{shape:"S14"}}},DeleteRequest:{type:"structure",required:["Key"],members:{Key:{shape:"S6"}}}}}}},S14:{type:"map",key:{},value:{shape:"S8"}},S1a:{type:"structure",members:{ItemCollectionKey:{type:"map",key:{},value:{shape:"S8"}},SizeEstimateRangeGB:{type:"list",member:{type:"double"}}}},S1f:{type:"list",member:{type:"structure",required:["AttributeName","AttributeType"],members:{AttributeName:{},AttributeType:{}}}},S1j:{type:"list",member:{type:"structure",required:["AttributeName","KeyType"],members:{AttributeName:{},KeyType:{}}}},S1o:{type:"structure",members:{ProjectionType:{},NonKeyAttributes:{type:"list",member:{}}}},S1u:{type:"structure",required:["ReadCapacityUnits","WriteCapacityUnits"],members:{ReadCapacityUnits:{type:"long"},WriteCapacityUnits:{type:"long"}}},S1x:{type:"structure",members:{AttributeDefinitions:{shape:"S1f"},TableName:{},KeySchema:{shape:"S1j"},TableStatus:{},CreationDateTime:{type:"timestamp"},ProvisionedThroughput:{shape:"S20"},TableSizeBytes:{type:"long"},ItemCount:{type:"long"},LocalSecondaryIndexes:{type:"list",member:{type:"structure",members:{IndexName:{},KeySchema:{shape:"S1j"},Projection:{shape:"S1o"},IndexSizeBytes:{type:"long"},ItemCount:{type:"long"}}}},GlobalSecondaryIndexes:{type:"list",member:{type:"structure",members:{IndexName:{},KeySchema:{shape:"S1j"},Projection:{shape:"S1o"},IndexStatus:{},Backfilling:{type:"boolean"},ProvisionedThroughput:{shape:"S20"},IndexSizeBytes:{type:"long"},ItemCount:{type:"long"}}}}}},S20:{type:"structure",members:{LastIncreaseDateTime:{type:"timestamp"},LastDecreaseDateTime:{type:"timestamp"},NumberOfDecreasesToday:{type:"long"},ReadCapacityUnits:{type:"long"},WriteCapacityUnits:{type:"long"}}},S29:{type:"map",key:{},value:{type:"structure",members:{Value:{shape:"S8"},Exists:{type:"boolean"},ComparisonOperator:{},AttributeValueList:{shape:"S2d"}}}},S2d:{type:"list",member:{shape:"S8"}},S2h:{type:"map",key:{},value:{shape:"S8"}},S30:{type:"structure",required:["ComparisonOperator"],members:{AttributeValueList:{shape:"S2d"},ComparisonOperator:{}}},S31:{type:"map",key:{},value:{shape:"S30"}}},paginators:{BatchGetItem:{input_token:"RequestItems",output_token:"UnprocessedKeys"},ListTables:{input_token:"ExclusiveStartTableName",output_token:"LastEvaluatedTableName",limit_key:"Limit",result_key:"TableNames"},Query:{input_token:"ExclusiveStartKey",output_token:"LastEvaluatedKey",limit_key:"Limit",result_key:"Items"},Scan:{input_token:"ExclusiveStartKey",output_token:"LastEvaluatedKey",limit_key:"Limit",result_key:"Items"}},waiters:{__default__:{interval:20,max_attempts:25},__TableState:{operation:"DescribeTable"},TableExists:{extends:"__TableState",ignore_errors:["ResourceNotFoundException"],success_type:"output",success_path:"Table.TableStatus",success_value:"ACTIVE"},TableNotExists:{extends:"__TableState",success_type:"error",success_value:"ResourceNotFoundException"}}},i.apiLoader.services.elastictranscoder={},i.ElasticTranscoder=i.Service.defineService("elastictranscoder",["2012-09-25"]),i.apiLoader.services.elastictranscoder["2012-09-25"]={version:"2.0",metadata:{apiVersion:"2012-09-25",endpointPrefix:"elastictranscoder",serviceFullName:"Amazon Elastic Transcoder",signatureVersion:"v4",protocol:"rest-json"},operations:{CancelJob:{http:{method:"DELETE",requestUri:"/2012-09-25/jobs/{Id}",responseCode:202},input:{type:"structure",required:["Id"],members:{Id:{location:"uri",locationName:"Id"}}},output:{type:"structure",members:{}}},CreateJob:{http:{requestUri:"/2012-09-25/jobs",responseCode:201},input:{type:"structure",required:["PipelineId","Input"],members:{PipelineId:{},Input:{shape:"S5"},Output:{shape:"Sk"},Outputs:{type:"list",member:{shape:"Sk"}},OutputKeyPrefix:{},Playlists:{type:"list",member:{type:"structure",members:{Name:{},Format:{},OutputKeys:{shape:"S1i"},HlsContentProtection:{shape:"S1j"},PlayReadyDrm:{shape:"S1n"}}}},UserMetadata:{shape:"S1s"}}},output:{type:"structure",members:{Job:{shape:"S1v"}}}},CreatePipeline:{http:{requestUri:"/2012-09-25/pipelines",responseCode:201},input:{type:"structure",required:["Name","InputBucket","Role"],members:{Name:{},InputBucket:{},OutputBucket:{},Role:{},AwsKmsKeyArn:{},Notifications:{shape:"S27"},ContentConfig:{shape:"S29"},ThumbnailConfig:{shape:"S29"}}},output:{type:"structure",members:{Pipeline:{shape:"S2i"},Warnings:{shape:"S2k"}}}},CreatePreset:{http:{requestUri:"/2012-09-25/presets",responseCode:201},input:{type:"structure",required:["Name","Container"],members:{Name:{},Description:{},Container:{},Video:{shape:"S2o"},Audio:{shape:"S34"},Thumbnails:{shape:"S3f"}}},output:{type:"structure",members:{Preset:{shape:"S3j"},Warning:{}}}},DeletePipeline:{http:{method:"DELETE",requestUri:"/2012-09-25/pipelines/{Id}",responseCode:202},input:{type:"structure",required:["Id"],members:{Id:{location:"uri",locationName:"Id"}}},output:{type:"structure",members:{}}},DeletePreset:{http:{method:"DELETE",requestUri:"/2012-09-25/presets/{Id}",responseCode:202},input:{type:"structure",required:["Id"],members:{Id:{location:"uri",locationName:"Id"}}},output:{type:"structure",members:{}}},ListJobsByPipeline:{http:{method:"GET",requestUri:"/2012-09-25/jobsByPipeline/{PipelineId}"},input:{type:"structure",required:["PipelineId"],members:{PipelineId:{location:"uri",locationName:"PipelineId"},Ascending:{location:"querystring",locationName:"Ascending"},PageToken:{location:"querystring",locationName:"PageToken"}}},output:{type:"structure",members:{Jobs:{shape:"S3s"},NextPageToken:{}}}},ListJobsByStatus:{http:{method:"GET",requestUri:"/2012-09-25/jobsByStatus/{Status}"},input:{type:"structure",required:["Status"],members:{Status:{location:"uri",locationName:"Status"},Ascending:{location:"querystring",locationName:"Ascending"},PageToken:{location:"querystring",locationName:"PageToken"}}},output:{type:"structure",members:{Jobs:{shape:"S3s"},NextPageToken:{}}}},ListPipelines:{http:{method:"GET",requestUri:"/2012-09-25/pipelines"},input:{type:"structure",members:{Ascending:{location:"querystring",locationName:"Ascending"},PageToken:{location:"querystring",locationName:"PageToken"}}},output:{type:"structure",members:{Pipelines:{type:"list",member:{shape:"S2i"}},NextPageToken:{}}}},ListPresets:{http:{method:"GET",requestUri:"/2012-09-25/presets"},input:{type:"structure",members:{Ascending:{location:"querystring",locationName:"Ascending"},PageToken:{location:"querystring",locationName:"PageToken"}}},output:{type:"structure",members:{Presets:{type:"list",member:{shape:"S3j"}},NextPageToken:{}}}},ReadJob:{http:{method:"GET",requestUri:"/2012-09-25/jobs/{Id}"},input:{type:"structure",required:["Id"],members:{Id:{location:"uri",locationName:"Id"}}},output:{type:"structure",members:{Job:{shape:"S1v"}}}},ReadPipeline:{http:{method:"GET",requestUri:"/2012-09-25/pipelines/{Id}"},input:{type:"structure",required:["Id"],members:{Id:{location:"uri",locationName:"Id"}}},output:{type:"structure",members:{Pipeline:{shape:"S2i"},Warnings:{shape:"S2k"}}}},ReadPreset:{http:{method:"GET",requestUri:"/2012-09-25/presets/{Id}"},input:{type:"structure",required:["Id"],members:{Id:{location:"uri",locationName:"Id"}}},output:{type:"structure",members:{Preset:{shape:"S3j"}}}},TestRole:{http:{requestUri:"/2012-09-25/roleTests",responseCode:200},input:{type:"structure",required:["Role","InputBucket","OutputBucket","Topics"],members:{Role:{},InputBucket:{},OutputBucket:{},Topics:{type:"list",member:{}}}},output:{type:"structure",members:{Success:{},Messages:{type:"list",member:{}}}}},UpdatePipeline:{http:{method:"PUT",requestUri:"/2012-09-25/pipelines/{Id}",responseCode:200},input:{type:"structure",required:["Id"],members:{Id:{location:"uri",locationName:"Id"},Name:{},InputBucket:{},Role:{},AwsKmsKeyArn:{},Notifications:{shape:"S27"},ContentConfig:{shape:"S29"},ThumbnailConfig:{shape:"S29"}}},output:{type:"structure",members:{Pipeline:{shape:"S2i"},Warnings:{shape:"S2k"}}}},UpdatePipelineNotifications:{http:{requestUri:"/2012-09-25/pipelines/{Id}/notifications"},input:{type:"structure",required:["Id","Notifications"],members:{Id:{location:"uri",locationName:"Id"},Notifications:{shape:"S27"}}},output:{type:"structure",members:{Pipeline:{shape:"S2i"}}}},UpdatePipelineStatus:{http:{requestUri:"/2012-09-25/pipelines/{Id}/status"},input:{type:"structure",required:["Id","Status"],members:{Id:{location:"uri",locationName:"Id"},Status:{}}},output:{type:"structure",members:{Pipeline:{shape:"S2i"}}}}},shapes:{S5:{type:"structure",members:{Key:{},FrameRate:{},Resolution:{},AspectRatio:{},Interlaced:{},Container:{},Encryption:{shape:"Sc"},DetectedProperties:{type:"structure",members:{Width:{type:"integer"},Height:{type:"integer"},FrameRate:{},FileSize:{type:"long"},DurationMillis:{type:"long"}}}}},Sc:{type:"structure",members:{Mode:{},Key:{},KeyMd5:{},InitializationVector:{}}},Sk:{type:"structure",members:{Key:{},ThumbnailPattern:{},ThumbnailEncryption:{shape:"Sc"},Rotate:{},PresetId:{},SegmentDuration:{},Watermarks:{shape:"Sn"},AlbumArt:{shape:"Sr"},Composition:{shape:"Sz"},Captions:{shape:"S13"},Encryption:{shape:"Sc"}}},Sn:{type:"list",member:{type:"structure",members:{PresetWatermarkId:{},InputKey:{},Encryption:{shape:"Sc"}}}},Sr:{type:"structure",members:{MergePolicy:{},Artwork:{type:"list",member:{type:"structure",members:{InputKey:{},MaxWidth:{},MaxHeight:{},SizingPolicy:{},PaddingPolicy:{},AlbumArtFormat:{},Encryption:{shape:"Sc"}}}}}},Sz:{type:"list",member:{type:"structure",members:{TimeSpan:{type:"structure",members:{StartTime:{},Duration:{}}}}}},S13:{type:"structure",members:{MergePolicy:{},CaptionSources:{type:"list",member:{type:"structure",members:{Key:{},Language:{},TimeOffset:{},Label:{},Encryption:{shape:"Sc"}}}},CaptionFormats:{type:"list",member:{type:"structure",members:{Format:{},Pattern:{},Encryption:{shape:"Sc"}}}}}},S1i:{type:"list",member:{}},S1j:{type:"structure",members:{Method:{},Key:{},KeyMd5:{},InitializationVector:{},LicenseAcquisitionUrl:{},KeyStoragePolicy:{}}},S1n:{type:"structure",members:{Format:{},Key:{},KeyMd5:{},KeyId:{},InitializationVector:{},LicenseAcquisitionUrl:{}}},S1s:{type:"map",key:{},value:{}},S1v:{type:"structure",members:{Id:{},Arn:{},PipelineId:{},Input:{shape:"S5"},Output:{shape:"S1w"},Outputs:{type:"list",member:{shape:"S1w"}},OutputKeyPrefix:{},Playlists:{type:"list",member:{type:"structure",members:{Name:{},Format:{},OutputKeys:{shape:"S1i"},HlsContentProtection:{shape:"S1j"},PlayReadyDrm:{shape:"S1n"},Status:{},StatusDetail:{}}}},Status:{},UserMetadata:{shape:"S1s"},Timing:{type:"structure",members:{SubmitTimeMillis:{type:"long"},StartTimeMillis:{type:"long"},FinishTimeMillis:{type:"long"}}}}},S1w:{type:"structure",members:{Id:{},Key:{},ThumbnailPattern:{},ThumbnailEncryption:{shape:"Sc"},Rotate:{},PresetId:{},SegmentDuration:{},Status:{},StatusDetail:{},Duration:{type:"long"},Width:{type:"integer"},Height:{type:"integer"},FrameRate:{},FileSize:{type:"long"},DurationMillis:{type:"long"},Watermarks:{shape:"Sn"},AlbumArt:{shape:"Sr"},Composition:{shape:"Sz"},Captions:{shape:"S13"},Encryption:{shape:"Sc"},AppliedColorSpaceConversion:{}}},S27:{type:"structure",members:{Progressing:{},Completed:{},Warning:{},Error:{}}},S29:{type:"structure",members:{Bucket:{},StorageClass:{},Permissions:{type:"list",member:{type:"structure",members:{GranteeType:{},Grantee:{},Access:{type:"list",member:{}}}}}}},S2i:{type:"structure",members:{Id:{},Arn:{},Name:{},Status:{},InputBucket:{},OutputBucket:{},Role:{},AwsKmsKeyArn:{},Notifications:{shape:"S27"},ContentConfig:{shape:"S29"},ThumbnailConfig:{shape:"S29"}}},S2k:{type:"list",member:{type:"structure",members:{Code:{},Message:{}}}},S2o:{type:"structure",members:{Codec:{},CodecOptions:{type:"map",key:{},value:{}},KeyframesMaxDist:{},FixedGOP:{},BitRate:{},FrameRate:{},MaxFrameRate:{},Resolution:{},AspectRatio:{},MaxWidth:{},MaxHeight:{},DisplayAspectRatio:{},SizingPolicy:{},PaddingPolicy:{},Watermarks:{type:"list",member:{type:"structure",members:{Id:{},MaxWidth:{},MaxHeight:{},SizingPolicy:{},HorizontalAlign:{},HorizontalOffset:{},VerticalAlign:{},VerticalOffset:{},Opacity:{},Target:{}}}}}},S34:{type:"structure",members:{Codec:{},SampleRate:{},BitRate:{},Channels:{},AudioPackingMode:{},CodecOptions:{type:"structure",members:{Profile:{},BitDepth:{},BitOrder:{},Signed:{}}}}},S3f:{type:"structure",members:{Format:{},Interval:{},Resolution:{},AspectRatio:{},MaxWidth:{},MaxHeight:{},SizingPolicy:{},PaddingPolicy:{}}},S3j:{type:"structure",members:{Id:{},Arn:{},Name:{},Description:{},Container:{},Audio:{shape:"S34"},Video:{shape:"S2o"},Thumbnails:{shape:"S3f"},Type:{}}},S3s:{type:"list",member:{shape:"S1v"}}},paginators:{ListJobsByPipeline:{input_token:"PageToken",output_token:"NextPageToken",result_key:"Jobs"},ListJobsByStatus:{input_token:"PageToken",output_token:"NextPageToken",result_key:"Jobs"},ListPipelines:{input_token:"PageToken",output_token:"NextPageToken",result_key:"Pipelines"},ListPresets:{input_token:"PageToken",output_token:"NextPageToken",result_key:"Presets"}},waiters:{JobComplete:{operation:"ReadJob",success_type:"output",success_path:"Job.Status",interval:30,max_attempts:120,success_value:"Complete",failure_value:["Canceled","Error"]}}},i.apiLoader.services.kinesis={},i.Kinesis=i.Service.defineService("kinesis",["2013-12-02"]),i.apiLoader.services.kinesis["2013-12-02"]={version:"2.0",metadata:{apiVersion:"2013-12-02",endpointPrefix:"kinesis",jsonVersion:"1.1",serviceAbbreviation:"Kinesis",serviceFullName:"Amazon Kinesis",signatureVersion:"v4",targetPrefix:"Kinesis_20131202",protocol:"json"},operations:{AddTagsToStream:{input:{type:"structure",required:["StreamName","Tags"],members:{StreamName:{},Tags:{type:"map",key:{},value:{}}}},http:{}},CreateStream:{input:{type:"structure",required:["StreamName","ShardCount"],members:{StreamName:{},ShardCount:{type:"integer"}}},http:{}},DeleteStream:{input:{type:"structure",required:["StreamName"],members:{StreamName:{}}},http:{}},DescribeStream:{input:{type:"structure",required:["StreamName"],members:{StreamName:{},Limit:{type:"integer"},ExclusiveStartShardId:{}}},output:{type:"structure",required:["StreamDescription"],members:{StreamDescription:{type:"structure",required:["StreamName","StreamARN","StreamStatus","Shards","HasMoreShards"],members:{StreamName:{},StreamARN:{},StreamStatus:{},Shards:{type:"list",member:{type:"structure",required:["ShardId","HashKeyRange","SequenceNumberRange"],members:{ShardId:{},ParentShardId:{},AdjacentParentShardId:{},HashKeyRange:{type:"structure",required:["StartingHashKey","EndingHashKey"],members:{StartingHashKey:{},EndingHashKey:{}}},SequenceNumberRange:{type:"structure",required:["StartingSequenceNumber"],members:{StartingSequenceNumber:{},EndingSequenceNumber:{}}}}}},HasMoreShards:{type:"boolean"}}}}},http:{}},GetRecords:{input:{type:"structure",required:["ShardIterator"],members:{ShardIterator:{},Limit:{type:"integer"}}},output:{type:"structure",required:["Records"],members:{Records:{type:"list",member:{type:"structure",required:["SequenceNumber","Data","PartitionKey"],members:{SequenceNumber:{},Data:{type:"blob"},PartitionKey:{}}}},NextShardIterator:{},MillisBehindLatest:{type:"long"}}},http:{}},GetShardIterator:{input:{type:"structure",required:["StreamName","ShardId","ShardIteratorType"],members:{StreamName:{},ShardId:{},ShardIteratorType:{},StartingSequenceNumber:{}}},output:{type:"structure",members:{ShardIterator:{}}},http:{}},ListStreams:{input:{type:"structure",members:{Limit:{type:"integer"},ExclusiveStartStreamName:{}}},output:{type:"structure",required:["StreamNames","HasMoreStreams"],members:{StreamNames:{type:"list",member:{}},HasMoreStreams:{type:"boolean"}}},http:{}},ListTagsForStream:{input:{type:"structure",required:["StreamName"],members:{StreamName:{},ExclusiveStartTagKey:{},Limit:{type:"integer"}}},output:{type:"structure",required:["Tags","HasMoreTags"],members:{Tags:{type:"list",member:{type:"structure",required:["Key"],members:{Key:{},Value:{}}}},HasMoreTags:{type:"boolean"}}},http:{}},MergeShards:{input:{type:"structure",required:["StreamName","ShardToMerge","AdjacentShardToMerge"],members:{StreamName:{},ShardToMerge:{},AdjacentShardToMerge:{}}},http:{}},PutRecord:{input:{type:"structure",required:["StreamName","Data","PartitionKey"],members:{StreamName:{},Data:{type:"blob"},PartitionKey:{},ExplicitHashKey:{},SequenceNumberForOrdering:{}}},output:{type:"structure",required:["ShardId","SequenceNumber"],members:{ShardId:{},SequenceNumber:{}}},http:{}},PutRecords:{input:{type:"structure",required:["Records","StreamName"],members:{Records:{type:"list",member:{type:"structure",required:["Data","PartitionKey"],members:{Data:{type:"blob"},ExplicitHashKey:{},PartitionKey:{}}}},StreamName:{}}},output:{type:"structure",required:["Records"],members:{FailedRecordCount:{type:"integer"},Records:{type:"list",member:{type:"structure",members:{SequenceNumber:{},ShardId:{},ErrorCode:{},ErrorMessage:{}}}}}},http:{}},RemoveTagsFromStream:{input:{type:"structure",required:["StreamName","TagKeys"],members:{StreamName:{},TagKeys:{type:"list",member:{}}}},http:{}},SplitShard:{input:{type:"structure",required:["StreamName","ShardToSplit","NewStartingHashKey"],members:{StreamName:{},ShardToSplit:{},NewStartingHashKey:{}}},http:{}}},shapes:{},paginators:{DescribeStream:{input_token:"ExclusiveStartShardId",limit_key:"Limit",more_results:"StreamDescription.HasMoreShards",output_token:"StreamDescription.Shards[-1].ShardId",result_key:"StreamDescription.Shards"},ListStreams:{input_token:"ExclusiveStartStreamName",limit_key:"Limit",more_results:"HasMoreStreams",output_token:"StreamNames[-1]",result_key:"StreamNames"}}},i.apiLoader.services.lambda={},i.Lambda=i.Service.defineService("lambda",["2014-11-11","2015-03-31"]),i.apiLoader.services.lambda["2015-03-31"]={version:"2.0",metadata:{apiVersion:"2015-03-31",endpointPrefix:"lambda",serviceFullName:"AWS Lambda",signatureVersion:"v4",protocol:"rest-json"},operations:{AddPermission:{http:{requestUri:"/2015-03-31/functions/{FunctionName}/versions/HEAD/policy",responseCode:201},input:{type:"structure",required:["FunctionName","StatementId","Action","Principal"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},StatementId:{},Action:{},Principal:{},SourceArn:{},SourceAccount:{}}},output:{type:"structure",members:{Statement:{}}}},CreateEventSourceMapping:{http:{requestUri:"/2015-03-31/event-source-mappings/",responseCode:202},input:{type:"structure",required:["EventSourceArn","FunctionName","StartingPosition"],members:{EventSourceArn:{},FunctionName:{},Enabled:{type:"boolean"},BatchSize:{type:"integer"},StartingPosition:{}}},output:{shape:"Se"}},CreateFunction:{http:{requestUri:"/2015-03-31/functions",responseCode:201},input:{type:"structure",required:["FunctionName","Runtime","Role","Handler","Code"],members:{FunctionName:{},Runtime:{},Role:{},Handler:{},Description:{},Timeout:{type:"integer"},MemorySize:{type:"integer"},Code:{type:"structure",members:{ZipFile:{type:"blob"},S3Bucket:{},S3Key:{},S3ObjectVersion:{}}}}},output:{shape:"St"}},DeleteEventSourceMapping:{http:{method:"DELETE",requestUri:"/2015-03-31/event-source-mappings/{UUID}",responseCode:202},input:{type:"structure",required:["UUID"],members:{UUID:{location:"uri",locationName:"UUID"}}},output:{shape:"Se"}},DeleteFunction:{http:{method:"DELETE",requestUri:"/2015-03-31/functions/{FunctionName}",responseCode:204},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"}}}},GetEventSourceMapping:{http:{method:"GET",requestUri:"/2015-03-31/event-source-mappings/{UUID}",responseCode:200},input:{type:"structure",required:["UUID"],members:{UUID:{location:"uri",locationName:"UUID"}}},output:{shape:"Se"}},GetFunction:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/versions/HEAD",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"}}},output:{type:"structure",members:{Configuration:{shape:"St"},Code:{type:"structure",members:{RepositoryType:{},Location:{}}}}}},GetFunctionConfiguration:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/versions/HEAD/configuration",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"}}},output:{shape:"St"}},GetPolicy:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/versions/HEAD/policy",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"}}},output:{type:"structure",members:{Policy:{}}}},Invoke:{http:{requestUri:"/2015-03-31/functions/{FunctionName}/invocations"},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},InvocationType:{location:"header",locationName:"X-Amz-Invocation-Type"},LogType:{location:"header",locationName:"X-Amz-Log-Type"},ClientContext:{location:"header",locationName:"X-Amz-Client-Context"},Payload:{type:"blob"}},payload:"Payload"},output:{type:"structure",members:{StatusCode:{location:"statusCode",type:"integer"},FunctionError:{location:"header",locationName:"X-Amz-Function-Error"},LogResult:{location:"header",locationName:"X-Amz-Log-Result"},Payload:{type:"blob"}},payload:"Payload"}},InvokeAsync:{http:{requestUri:"/2014-11-13/functions/{FunctionName}/invoke-async/",responseCode:202},input:{deprecated:!0,type:"structure",required:["FunctionName","InvokeArgs"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},InvokeArgs:{type:"blob",streaming:!0}},payload:"InvokeArgs"},output:{deprecated:!0,type:"structure",members:{Status:{location:"statusCode",type:"integer"}}},deprecated:!0},ListEventSourceMappings:{http:{method:"GET",requestUri:"/2015-03-31/event-source-mappings/",responseCode:200},input:{type:"structure",members:{EventSourceArn:{location:"querystring",locationName:"EventSourceArn"},FunctionName:{location:"querystring",locationName:"FunctionName"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},EventSourceMappings:{type:"list",member:{shape:"Se"}}}}},ListFunctions:{http:{method:"GET",requestUri:"/2015-03-31/functions/",responseCode:200},input:{type:"structure",members:{Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},Functions:{type:"list",member:{shape:"St"}}}}},RemovePermission:{http:{method:"DELETE",requestUri:"/2015-03-31/functions/{FunctionName}/versions/HEAD/policy/{StatementId}",responseCode:204},input:{type:"structure",required:["FunctionName","StatementId"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},StatementId:{location:"uri",locationName:"StatementId"}}}},UpdateEventSourceMapping:{http:{method:"PUT",requestUri:"/2015-03-31/event-source-mappings/{UUID}",responseCode:202},input:{type:"structure",required:["UUID"],members:{UUID:{location:"uri",locationName:"UUID"},FunctionName:{},Enabled:{type:"boolean"},BatchSize:{type:"integer"}}},output:{shape:"Se"}},UpdateFunctionCode:{http:{method:"PUT",requestUri:"/2015-03-31/functions/{FunctionName}/versions/HEAD/code",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},ZipFile:{type:"blob"},S3Bucket:{},S3Key:{},S3ObjectVersion:{}}},output:{shape:"St"}},UpdateFunctionConfiguration:{http:{method:"PUT",requestUri:"/2015-03-31/functions/{FunctionName}/versions/HEAD/configuration",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Role:{},Handler:{},Description:{},Timeout:{type:"integer"},MemorySize:{type:"integer"}}},output:{shape:"St"}}},shapes:{Se:{type:"structure",members:{UUID:{},BatchSize:{type:"integer"},EventSourceArn:{},FunctionArn:{},LastModified:{type:"timestamp"},LastProcessingResult:{},State:{},StateTransitionReason:{}}},St:{type:"structure",members:{FunctionName:{},FunctionArn:{},Runtime:{},Role:{},Handler:{},CodeSize:{type:"long"},Description:{},Timeout:{type:"integer"},MemorySize:{type:"integer"},LastModified:{}}}},paginators:{ListEventSourceMappings:{input_token:"Marker",output_token:"NextMarker",limit_key:"MaxItems",result_key:"EventSourceMappings"},ListFunctions:{input_token:"Marker",output_token:"NextMarker",limit_key:"MaxItems",result_key:"Functions"}}},i.apiLoader.services.machinelearning={},i.MachineLearning=i.Service.defineService("machinelearning",["2014-12-12"]),e("./services/machinelearning"),i.apiLoader.services.machinelearning["2014-12-12"]={version:"2.0",metadata:{apiVersion:"2014-12-12",endpointPrefix:"machinelearning",jsonVersion:"1.1",serviceFullName:"Amazon Machine Learning",signatureVersion:"v4",targetPrefix:"AmazonML_20141212",protocol:"json"},operations:{CreateBatchPrediction:{input:{type:"structure",required:["BatchPredictionId","MLModelId","BatchPredictionDataSourceId","OutputUri"],members:{BatchPredictionId:{},BatchPredictionName:{},MLModelId:{},BatchPredictionDataSourceId:{},OutputUri:{}}},output:{type:"structure",members:{BatchPredictionId:{}}},http:{}},CreateDataSourceFromRDS:{input:{type:"structure",required:["DataSourceId","RDSData","RoleARN"],members:{DataSourceId:{},DataSourceName:{},RDSData:{type:"structure",required:["DatabaseInformation","SelectSqlQuery","DatabaseCredentials","S3StagingLocation","ResourceRole","ServiceRole","SubnetId","SecurityGroupIds"],members:{DatabaseInformation:{shape:"S8"},SelectSqlQuery:{},DatabaseCredentials:{type:"structure",required:["Username","Password"],members:{Username:{},Password:{}}},S3StagingLocation:{},DataRearrangement:{},DataSchema:{},DataSchemaUri:{},ResourceRole:{},ServiceRole:{},SubnetId:{},SecurityGroupIds:{type:"list",member:{}}}},RoleARN:{},ComputeStatistics:{type:"boolean"}}},output:{type:"structure",members:{DataSourceId:{}}},http:{}},CreateDataSourceFromRedshift:{input:{type:"structure",required:["DataSourceId","DataSpec","RoleARN"],members:{DataSourceId:{},DataSourceName:{},DataSpec:{type:"structure",required:["DatabaseInformation","SelectSqlQuery","DatabaseCredentials","S3StagingLocation"],members:{DatabaseInformation:{shape:"Sr"},SelectSqlQuery:{},DatabaseCredentials:{type:"structure",required:["Username","Password"],members:{Username:{},Password:{}}},S3StagingLocation:{},DataRearrangement:{},DataSchema:{},DataSchemaUri:{}}},RoleARN:{},ComputeStatistics:{type:"boolean"}}},output:{type:"structure",members:{DataSourceId:{}}},http:{}},CreateDataSourceFromS3:{input:{type:"structure",required:["DataSourceId","DataSpec"],members:{DataSourceId:{},DataSourceName:{},DataSpec:{type:"structure",required:["DataLocationS3"],members:{DataLocationS3:{},DataRearrangement:{},DataSchema:{},DataSchemaLocationS3:{}}},ComputeStatistics:{type:"boolean"}}},output:{type:"structure",members:{DataSourceId:{}}},http:{}},CreateEvaluation:{input:{type:"structure",required:["EvaluationId","MLModelId","EvaluationDataSourceId"],members:{EvaluationId:{},EvaluationName:{},MLModelId:{},EvaluationDataSourceId:{}}},output:{type:"structure",members:{EvaluationId:{}}},http:{}},CreateMLModel:{input:{type:"structure",required:["MLModelId","MLModelType","TrainingDataSourceId"],members:{MLModelId:{},MLModelName:{},MLModelType:{},Parameters:{shape:"S16"},TrainingDataSourceId:{},Recipe:{},RecipeUri:{}}},output:{type:"structure",members:{MLModelId:{}}},http:{}},CreateRealtimeEndpoint:{input:{type:"structure",required:["MLModelId"],members:{MLModelId:{}}},output:{type:"structure",members:{MLModelId:{},RealtimeEndpointInfo:{shape:"S1c"}}},http:{}},DeleteBatchPrediction:{input:{type:"structure",required:["BatchPredictionId"],members:{BatchPredictionId:{}}},output:{type:"structure",members:{BatchPredictionId:{}}},http:{}},DeleteDataSource:{input:{type:"structure",required:["DataSourceId"],members:{DataSourceId:{}}},output:{type:"structure",members:{DataSourceId:{}}},http:{}},DeleteEvaluation:{input:{type:"structure",required:["EvaluationId"],members:{EvaluationId:{}}},output:{type:"structure",members:{EvaluationId:{}}},http:{}},DeleteMLModel:{input:{type:"structure",required:["MLModelId"],members:{MLModelId:{}}},output:{type:"structure",members:{MLModelId:{}}},http:{}},DeleteRealtimeEndpoint:{input:{type:"structure",required:["MLModelId"],members:{MLModelId:{}}},output:{type:"structure",members:{MLModelId:{},RealtimeEndpointInfo:{shape:"S1c"}}},http:{}},DescribeBatchPredictions:{input:{type:"structure",members:{FilterVariable:{},EQ:{},GT:{},LT:{},GE:{},LE:{},NE:{},Prefix:{},SortOrder:{},NextToken:{},Limit:{type:"integer"}}},output:{type:"structure",members:{Results:{type:"list",member:{type:"structure",members:{BatchPredictionId:{},MLModelId:{},BatchPredictionDataSourceId:{},InputDataLocationS3:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},Name:{},Status:{},OutputUri:{},Message:{}}}},NextToken:{}}},http:{}},DescribeDataSources:{input:{type:"structure",members:{FilterVariable:{},EQ:{},GT:{},LT:{},GE:{},LE:{},NE:{},Prefix:{},SortOrder:{},NextToken:{},Limit:{type:"integer"}}},output:{type:"structure",members:{Results:{type:"list",member:{type:"structure",members:{DataSourceId:{},DataLocationS3:{},DataRearrangement:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},DataSizeInBytes:{type:"long"},NumberOfFiles:{type:"long"},Name:{},Status:{},Message:{},RedshiftMetadata:{shape:"S28"},RDSMetadata:{shape:"S29"},RoleARN:{},ComputeStatistics:{type:"boolean"}}}},NextToken:{}}},http:{}},DescribeEvaluations:{input:{type:"structure",members:{FilterVariable:{},EQ:{},GT:{},LT:{},GE:{},LE:{},NE:{},Prefix:{},SortOrder:{},NextToken:{},Limit:{type:"integer"}}},output:{type:"structure",members:{Results:{type:"list",member:{type:"structure",members:{EvaluationId:{},MLModelId:{},EvaluationDataSourceId:{},InputDataLocationS3:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},Name:{},Status:{},PerformanceMetrics:{shape:"S2g"},Message:{}}}},NextToken:{}}},http:{}},DescribeMLModels:{input:{type:"structure",members:{FilterVariable:{},EQ:{},GT:{},LT:{},GE:{},LE:{},NE:{},Prefix:{},SortOrder:{},NextToken:{},Limit:{type:"integer"}}},output:{type:"structure",members:{Results:{type:"list",member:{type:"structure",members:{MLModelId:{},TrainingDataSourceId:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},Name:{},Status:{},SizeInBytes:{type:"long"},EndpointInfo:{shape:"S1c"},TrainingParameters:{shape:"S16"},InputDataLocationS3:{},Algorithm:{},MLModelType:{},ScoreThreshold:{type:"float"},ScoreThresholdLastUpdatedAt:{type:"timestamp"},Message:{}}}},NextToken:{}}},http:{}},GetBatchPrediction:{input:{type:"structure",required:["BatchPredictionId"],members:{BatchPredictionId:{}}},output:{type:"structure",members:{BatchPredictionId:{},MLModelId:{},BatchPredictionDataSourceId:{},InputDataLocationS3:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},Name:{},Status:{},OutputUri:{},LogUri:{},Message:{}}},http:{}},GetDataSource:{input:{type:"structure",required:["DataSourceId"],members:{DataSourceId:{},Verbose:{type:"boolean"}}},output:{type:"structure",members:{DataSourceId:{},DataLocationS3:{},DataRearrangement:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},DataSizeInBytes:{type:"long"},NumberOfFiles:{type:"long"},Name:{},Status:{},LogUri:{},Message:{},RedshiftMetadata:{shape:"S28"},RDSMetadata:{shape:"S29"},RoleARN:{},ComputeStatistics:{type:"boolean"},DataSourceSchema:{}}},http:{}},GetEvaluation:{input:{type:"structure",required:["EvaluationId"],members:{EvaluationId:{}}},output:{type:"structure",members:{EvaluationId:{},MLModelId:{},EvaluationDataSourceId:{},InputDataLocationS3:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},Name:{},Status:{},PerformanceMetrics:{shape:"S2g"},LogUri:{},Message:{}}},http:{}},GetMLModel:{input:{type:"structure",required:["MLModelId"],members:{MLModelId:{},Verbose:{type:"boolean"}}},output:{type:"structure",members:{MLModelId:{},TrainingDataSourceId:{},CreatedByIamUser:{},CreatedAt:{type:"timestamp"},LastUpdatedAt:{type:"timestamp"},Name:{},Status:{},SizeInBytes:{type:"long"},EndpointInfo:{shape:"S1c"},TrainingParameters:{shape:"S16"},InputDataLocationS3:{},MLModelType:{},ScoreThreshold:{type:"float"},ScoreThresholdLastUpdatedAt:{type:"timestamp"},LogUri:{},Message:{},Recipe:{},Schema:{}}},http:{}},Predict:{input:{type:"structure",required:["MLModelId","Record","PredictEndpoint"],members:{MLModelId:{},Record:{type:"map",key:{},value:{}},PredictEndpoint:{}}},output:{type:"structure",members:{Prediction:{type:"structure",members:{predictedLabel:{},predictedValue:{type:"float"},predictedScores:{type:"map",key:{},value:{type:"float"}},details:{type:"map",key:{},value:{}}}}}},http:{}},UpdateBatchPrediction:{input:{type:"structure",required:["BatchPredictionId","BatchPredictionName"],members:{BatchPredictionId:{},BatchPredictionName:{}}},output:{type:"structure",members:{BatchPredictionId:{}}},http:{}},UpdateDataSource:{input:{type:"structure",required:["DataSourceId","DataSourceName"],members:{DataSourceId:{},DataSourceName:{}}},output:{type:"structure",members:{DataSourceId:{}}},http:{}},UpdateEvaluation:{input:{type:"structure",required:["EvaluationId","EvaluationName"],members:{EvaluationId:{},EvaluationName:{}}},output:{type:"structure",members:{EvaluationId:{}}},http:{}},UpdateMLModel:{input:{type:"structure",required:["MLModelId"],members:{MLModelId:{},MLModelName:{},ScoreThreshold:{type:"float"}}},output:{type:"structure",members:{MLModelId:{}}},http:{}}},shapes:{S8:{type:"structure",required:["InstanceIdentifier","DatabaseName"],members:{InstanceIdentifier:{},DatabaseName:{}}},Sr:{type:"structure",required:["DatabaseName","ClusterIdentifier"],members:{DatabaseName:{},ClusterIdentifier:{}}},S16:{type:"map",key:{},value:{}},S1c:{type:"structure",members:{PeakRequestsPerSecond:{type:"integer"},CreatedAt:{type:"timestamp"},EndpointUrl:{},EndpointStatus:{}}},S28:{type:"structure",members:{RedshiftDatabase:{shape:"Sr"},DatabaseUserName:{},SelectSqlQuery:{}}},S29:{type:"structure",members:{Database:{shape:"S8"},DatabaseUserName:{},SelectSqlQuery:{},ResourceRole:{},ServiceRole:{},DataPipelineId:{}}},S2g:{type:"structure",members:{Properties:{type:"map",key:{},value:{}}}}},paginators:{DescribeBatchPredictions:{limit_key:"Limit",output_token:"NextToken",input_token:"NextToken",result_key:"Results"},DescribeDataSources:{limit_key:"Limit",output_token:"NextToken",input_token:"NextToken",result_key:"Results"},DescribeEvaluations:{limit_key:"Limit",output_token:"NextToken",input_token:"NextToken",result_key:"Results"},DescribeMLModels:{limit_key:"Limit",output_token:"NextToken",input_token:"NextToken",result_key:"Results"}}},i.apiLoader.services.mobileanalytics={},i.MobileAnalytics=i.Service.defineService("mobileanalytics",["2014-06-05"]),i.apiLoader.services.mobileanalytics["2014-06-05"]={version:"2.0",metadata:{apiVersion:"2014-06-05",endpointPrefix:"mobileanalytics",serviceFullName:"Amazon Mobile Analytics",signatureVersion:"v4",protocol:"rest-json"},operations:{PutEvents:{http:{requestUri:"/2014-06-05/events",responseCode:202},input:{type:"structure",required:["events","clientContext"],members:{events:{type:"list",member:{type:"structure",required:["eventType","timestamp"],members:{eventType:{},timestamp:{},session:{type:"structure",members:{id:{},duration:{type:"long"},startTimestamp:{},stopTimestamp:{}}},version:{},attributes:{type:"map",key:{},value:{}},metrics:{type:"map",key:{},value:{type:"double"}}}}},clientContext:{location:"header",locationName:"x-amz-Client-Context"},clientContextEncoding:{location:"header",locationName:"x-amz-Client-Context-Encoding"}}}}},shapes:{}},i.apiLoader.services.opsworks={},i.OpsWorks=i.Service.defineService("opsworks",["2013-02-18"]),i.apiLoader.services.opsworks["2013-02-18"]={version:"2.0",metadata:{apiVersion:"2013-02-18",endpointPrefix:"opsworks",jsonVersion:"1.1",serviceFullName:"AWS OpsWorks",signatureVersion:"v4",targetPrefix:"OpsWorks_20130218",protocol:"json"},operations:{AssignInstance:{input:{type:"structure",required:["InstanceId","LayerIds"],members:{InstanceId:{},LayerIds:{shape:"S3"}}},http:{}},AssignVolume:{input:{type:"structure",required:["VolumeId"],members:{VolumeId:{},InstanceId:{}}},http:{}},AssociateElasticIp:{input:{type:"structure",required:["ElasticIp"],members:{ElasticIp:{},InstanceId:{}}},http:{}},AttachElasticLoadBalancer:{input:{type:"structure",required:["ElasticLoadBalancerName","LayerId"],members:{ElasticLoadBalancerName:{},LayerId:{}}},http:{}},CloneStack:{input:{type:"structure",required:["SourceStackId","ServiceRoleArn"],members:{SourceStackId:{},Name:{},Region:{},VpcId:{},Attributes:{shape:"S8"},ServiceRoleArn:{},DefaultInstanceProfileArn:{},DefaultOs:{},HostnameTheme:{},DefaultAvailabilityZone:{},DefaultSubnetId:{},CustomJson:{},ConfigurationManager:{shape:"Sa"},ChefConfiguration:{shape:"Sb"},UseCustomCookbooks:{type:"boolean"},UseOpsworksSecurityGroups:{type:"boolean"},CustomCookbooksSource:{shape:"Sd"},DefaultSshKeyName:{},ClonePermissions:{type:"boolean"},CloneAppIds:{shape:"S3"},DefaultRootDeviceType:{}}},output:{type:"structure",members:{StackId:{}}},http:{}},CreateApp:{input:{type:"structure",required:["StackId","Name","Type"],members:{StackId:{},Shortname:{},Name:{},Description:{},DataSources:{shape:"Si"},Type:{},AppSource:{shape:"Sd"},Domains:{shape:"S3"},EnableSsl:{type:"boolean"},SslConfiguration:{shape:"Sl"},Attributes:{shape:"Sm"},Environment:{shape:"So"}}},output:{type:"structure",members:{AppId:{}}},http:{}},CreateDeployment:{input:{type:"structure",required:["StackId","Command"],members:{StackId:{},AppId:{},InstanceIds:{shape:"S3"},Command:{shape:"Ss"},Comment:{},CustomJson:{}}},output:{type:"structure",members:{DeploymentId:{}}},http:{}},CreateInstance:{input:{type:"structure",required:["StackId","LayerIds","InstanceType"],members:{StackId:{},LayerIds:{shape:"S3"},InstanceType:{},AutoScalingType:{},Hostname:{},Os:{},AmiId:{},SshKeyName:{},AvailabilityZone:{},VirtualizationType:{},SubnetId:{},Architecture:{},RootDeviceType:{},BlockDeviceMappings:{shape:"Sz"},InstallUpdatesOnBoot:{type:"boolean"},EbsOptimized:{type:"boolean"}}},output:{type:"structure",members:{InstanceId:{}}},http:{}},CreateLayer:{input:{type:"structure",required:["StackId","Type","Name","Shortname"],members:{StackId:{},Type:{},Name:{},Shortname:{},Attributes:{shape:"S17"},CustomInstanceProfileArn:{},CustomSecurityGroupIds:{shape:"S3"},Packages:{shape:"S3"},VolumeConfigurations:{shape:"S19"},EnableAutoHealing:{type:"boolean"},AutoAssignElasticIps:{type:"boolean"},AutoAssignPublicIps:{type:"boolean"},CustomRecipes:{shape:"S1b"},InstallUpdatesOnBoot:{type:"boolean"},UseEbsOptimizedInstances:{type:"boolean"},LifecycleEventConfiguration:{shape:"S1c"}}},output:{type:"structure",members:{LayerId:{}}},http:{}},CreateStack:{input:{type:"structure",required:["Name","Region","ServiceRoleArn","DefaultInstanceProfileArn"],members:{Name:{},Region:{},VpcId:{},Attributes:{shape:"S8"},ServiceRoleArn:{},DefaultInstanceProfileArn:{},DefaultOs:{},HostnameTheme:{},DefaultAvailabilityZone:{},DefaultSubnetId:{},CustomJson:{},ConfigurationManager:{shape:"Sa"},ChefConfiguration:{shape:"Sb"},UseCustomCookbooks:{type:"boolean"},UseOpsworksSecurityGroups:{type:"boolean"},CustomCookbooksSource:{shape:"Sd"},DefaultSshKeyName:{},DefaultRootDeviceType:{}}},output:{type:"structure",members:{StackId:{}}},http:{}},CreateUserProfile:{input:{type:"structure",required:["IamUserArn"],members:{IamUserArn:{},SshUsername:{},SshPublicKey:{},AllowSelfManagement:{type:"boolean"}}},output:{type:"structure",members:{IamUserArn:{}}},http:{}},DeleteApp:{input:{type:"structure",required:["AppId"],members:{AppId:{}}},http:{}},DeleteInstance:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{},DeleteElasticIp:{type:"boolean"},DeleteVolumes:{type:"boolean"}}},http:{}},DeleteLayer:{input:{type:"structure",required:["LayerId"],members:{LayerId:{}}},http:{}},DeleteStack:{input:{type:"structure",required:["StackId"],members:{StackId:{}}},http:{}},DeleteUserProfile:{input:{type:"structure",required:["IamUserArn"],members:{IamUserArn:{}}},http:{}},DeregisterElasticIp:{input:{type:"structure",required:["ElasticIp"],members:{ElasticIp:{}}},http:{}},DeregisterInstance:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{}}},http:{}},DeregisterRdsDbInstance:{input:{type:"structure",required:["RdsDbInstanceArn"],members:{RdsDbInstanceArn:{}}},http:{}},DeregisterVolume:{input:{type:"structure",required:["VolumeId"],members:{VolumeId:{}}},http:{}},DescribeApps:{input:{type:"structure",members:{StackId:{},AppIds:{shape:"S3"}}},output:{type:"structure",members:{Apps:{type:"list",member:{type:"structure",members:{AppId:{},StackId:{},Shortname:{},Name:{},Description:{},DataSources:{shape:"Si"},Type:{},AppSource:{shape:"Sd"},Domains:{shape:"S3"},EnableSsl:{type:"boolean"},SslConfiguration:{shape:"Sl"},Attributes:{shape:"Sm"},CreatedAt:{},Environment:{shape:"So"}}}}}},http:{}},DescribeCommands:{input:{type:"structure",members:{DeploymentId:{},InstanceId:{},CommandIds:{shape:"S3"}}},output:{type:"structure",members:{Commands:{type:"list",member:{type:"structure",members:{CommandId:{},InstanceId:{},DeploymentId:{},CreatedAt:{},AcknowledgedAt:{},CompletedAt:{},Status:{},ExitCode:{type:"integer"},LogUrl:{},Type:{}}}}}},http:{}},DescribeDeployments:{input:{type:"structure",members:{StackId:{},AppId:{},DeploymentIds:{shape:"S3"}}},output:{type:"structure",members:{Deployments:{type:"list",member:{type:"structure",members:{DeploymentId:{},StackId:{},AppId:{},CreatedAt:{},CompletedAt:{},Duration:{type:"integer"},IamUserArn:{},Comment:{},Command:{shape:"Ss"},Status:{},CustomJson:{},InstanceIds:{shape:"S3"}}}}}},http:{}},DescribeElasticIps:{input:{type:"structure",members:{InstanceId:{},StackId:{},Ips:{shape:"S3"}}},output:{type:"structure",members:{ElasticIps:{type:"list",member:{type:"structure",members:{Ip:{},Name:{},Domain:{},Region:{},InstanceId:{}}}}}},http:{}},DescribeElasticLoadBalancers:{input:{type:"structure",members:{StackId:{},LayerIds:{shape:"S3"}}},output:{type:"structure",members:{ElasticLoadBalancers:{type:"list",member:{type:"structure",members:{ElasticLoadBalancerName:{},Region:{},DnsName:{},StackId:{},LayerId:{},VpcId:{},AvailabilityZones:{shape:"S3"},SubnetIds:{shape:"S3"},Ec2InstanceIds:{shape:"S3"}}}}}},http:{}},DescribeInstances:{input:{type:"structure",members:{StackId:{},LayerId:{},InstanceIds:{shape:"S3"}}},output:{type:"structure",members:{Instances:{type:"list",member:{type:"structure",members:{InstanceId:{},Ec2InstanceId:{},VirtualizationType:{},Hostname:{},StackId:{},LayerIds:{shape:"S3"},SecurityGroupIds:{shape:"S3"},InstanceType:{},InstanceProfileArn:{},Status:{},Os:{},AmiId:{},AvailabilityZone:{},SubnetId:{},PublicDns:{},PrivateDns:{},PublicIp:{},PrivateIp:{},ElasticIp:{},AutoScalingType:{},SshKeyName:{},SshHostRsaKeyFingerprint:{},SshHostDsaKeyFingerprint:{},CreatedAt:{},LastServiceErrorId:{},Architecture:{},RootDeviceType:{},RootDeviceVolumeId:{},BlockDeviceMappings:{shape:"Sz"},InstallUpdatesOnBoot:{type:"boolean"},EbsOptimized:{type:"boolean"},ReportedAgentVersion:{},ReportedOs:{type:"structure",members:{Family:{},Name:{},Version:{}}},InfrastructureClass:{},RegisteredBy:{}}}}}},http:{}},DescribeLayers:{input:{type:"structure",members:{StackId:{},LayerIds:{shape:"S3"}}},output:{type:"structure",members:{Layers:{type:"list",member:{type:"structure",members:{StackId:{},LayerId:{},Type:{},Name:{},Shortname:{},Attributes:{shape:"S17"},CustomInstanceProfileArn:{},CustomSecurityGroupIds:{shape:"S3"},DefaultSecurityGroupNames:{shape:"S3"},Packages:{shape:"S3"},VolumeConfigurations:{shape:"S19"},EnableAutoHealing:{type:"boolean"},AutoAssignElasticIps:{type:"boolean"},AutoAssignPublicIps:{type:"boolean"},DefaultRecipes:{shape:"S1b"},CustomRecipes:{shape:"S1b"},CreatedAt:{},InstallUpdatesOnBoot:{type:"boolean"},UseEbsOptimizedInstances:{type:"boolean"},LifecycleEventConfiguration:{shape:"S1c"}}}}}},http:{}},DescribeLoadBasedAutoScaling:{input:{type:"structure",required:["LayerIds"],members:{LayerIds:{shape:"S3"}}},output:{type:"structure",members:{LoadBasedAutoScalingConfigurations:{type:"list",member:{type:"structure",members:{LayerId:{},Enable:{type:"boolean"},UpScaling:{shape:"S2r"},DownScaling:{shape:"S2r"}}}}}},http:{}},DescribeMyUserProfile:{output:{type:"structure",members:{UserProfile:{type:"structure",members:{IamUserArn:{},Name:{},SshUsername:{},SshPublicKey:{}}}}},http:{}},DescribePermissions:{input:{type:"structure",members:{IamUserArn:{},StackId:{}}},output:{type:"structure",members:{Permissions:{type:"list",member:{type:"structure",members:{StackId:{},IamUserArn:{},AllowSsh:{type:"boolean"},AllowSudo:{type:"boolean"},Level:{}}}}}},http:{}},DescribeRaidArrays:{input:{type:"structure",members:{InstanceId:{},StackId:{},RaidArrayIds:{shape:"S3"}}},output:{type:"structure",members:{RaidArrays:{type:"list",member:{type:"structure",members:{RaidArrayId:{},InstanceId:{},Name:{},RaidLevel:{type:"integer"},NumberOfDisks:{type:"integer"},Size:{type:"integer"},Device:{},MountPoint:{},AvailabilityZone:{},CreatedAt:{},StackId:{},VolumeType:{},Iops:{type:"integer"}}}}}},http:{}},DescribeRdsDbInstances:{input:{type:"structure",required:["StackId"],members:{StackId:{},RdsDbInstanceArns:{shape:"S3"}}},output:{type:"structure",members:{RdsDbInstances:{type:"list",member:{type:"structure",members:{RdsDbInstanceArn:{},DbInstanceIdentifier:{},DbUser:{},DbPassword:{},Region:{},Address:{},Engine:{},StackId:{},MissingOnRds:{type:"boolean"}}}}}},http:{}},DescribeServiceErrors:{input:{type:"structure",members:{StackId:{},InstanceId:{},ServiceErrorIds:{shape:"S3"}}},output:{type:"structure",members:{ServiceErrors:{type:"list",member:{type:"structure",members:{ServiceErrorId:{},StackId:{},InstanceId:{},Type:{},Message:{},CreatedAt:{}}}}}},http:{}},DescribeStackProvisioningParameters:{input:{type:"structure",required:["StackId"],members:{StackId:{}}},output:{type:"structure",members:{AgentInstallerUrl:{},Parameters:{type:"map",key:{},value:{}}}},http:{}},DescribeStackSummary:{input:{type:"structure",required:["StackId"],members:{StackId:{}}},output:{type:"structure",members:{StackSummary:{type:"structure",members:{StackId:{},Name:{},Arn:{},LayersCount:{type:"integer"},AppsCount:{type:"integer"},InstancesCount:{type:"structure",members:{Assigning:{type:"integer"},Booting:{type:"integer"},ConnectionLost:{type:"integer"},Deregistering:{type:"integer"},Online:{type:"integer"},Pending:{type:"integer"},Rebooting:{type:"integer"},Registered:{type:"integer"},Registering:{type:"integer"},Requested:{type:"integer"},RunningSetup:{type:"integer"},SetupFailed:{type:"integer"},ShuttingDown:{type:"integer"},StartFailed:{type:"integer"},Stopped:{type:"integer"},Stopping:{type:"integer"},Terminated:{type:"integer"},Terminating:{type:"integer"},Unassigning:{type:"integer"}}}}}}},http:{}},DescribeStacks:{input:{type:"structure",members:{StackIds:{shape:"S3"}}},output:{type:"structure",members:{Stacks:{type:"list",member:{type:"structure",members:{StackId:{},Name:{},Arn:{},Region:{},VpcId:{},Attributes:{shape:"S8"},ServiceRoleArn:{},DefaultInstanceProfileArn:{},DefaultOs:{},HostnameTheme:{},DefaultAvailabilityZone:{},DefaultSubnetId:{},CustomJson:{},ConfigurationManager:{shape:"Sa"},ChefConfiguration:{shape:"Sb"},UseCustomCookbooks:{type:"boolean"},UseOpsworksSecurityGroups:{type:"boolean"},CustomCookbooksSource:{shape:"Sd"},DefaultSshKeyName:{},CreatedAt:{},DefaultRootDeviceType:{}}}}}},http:{}},DescribeTimeBasedAutoScaling:{input:{type:"structure",required:["InstanceIds"],members:{InstanceIds:{shape:"S3"}}},output:{type:"structure",members:{TimeBasedAutoScalingConfigurations:{type:"list",member:{type:"structure",members:{InstanceId:{},AutoScalingSchedule:{shape:"S3r"}}}}}},http:{}},DescribeUserProfiles:{input:{type:"structure",members:{IamUserArns:{shape:"S3"}}},output:{type:"structure",members:{UserProfiles:{type:"list",member:{type:"structure",members:{IamUserArn:{},Name:{},SshUsername:{},SshPublicKey:{},AllowSelfManagement:{type:"boolean"}}}}}},http:{}},DescribeVolumes:{input:{type:"structure",members:{InstanceId:{},StackId:{},RaidArrayId:{},VolumeIds:{shape:"S3"}}},output:{type:"structure",members:{Volumes:{type:"list",member:{type:"structure",members:{VolumeId:{},Ec2VolumeId:{},Name:{},RaidArrayId:{},InstanceId:{},Status:{},Size:{type:"integer"},Device:{},MountPoint:{},Region:{},AvailabilityZone:{},VolumeType:{},Iops:{type:"integer"}}}}}},http:{}},DetachElasticLoadBalancer:{input:{type:"structure",required:["ElasticLoadBalancerName","LayerId"],members:{ElasticLoadBalancerName:{},LayerId:{}}},http:{}},DisassociateElasticIp:{input:{type:"structure",required:["ElasticIp"],members:{ElasticIp:{}}},http:{}},GetHostnameSuggestion:{input:{type:"structure",required:["LayerId"],members:{LayerId:{}}},output:{type:"structure",members:{LayerId:{},Hostname:{}}},http:{}},GrantAccess:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{},ValidForInMinutes:{type:"integer"}}},output:{type:"structure",members:{TemporaryCredential:{type:"structure",members:{Username:{},Password:{},ValidForInMinutes:{type:"integer"},InstanceId:{}}}}},http:{}},RebootInstance:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{}}},http:{}},RegisterElasticIp:{input:{type:"structure",required:["ElasticIp","StackId"],members:{ElasticIp:{},StackId:{}}},output:{type:"structure",members:{ElasticIp:{}}},http:{}},RegisterInstance:{input:{type:"structure",required:["StackId"],members:{StackId:{},Hostname:{},PublicIp:{},PrivateIp:{},RsaPublicKey:{},RsaPublicKeyFingerprint:{},InstanceIdentity:{type:"structure",members:{Document:{},Signature:{}}}}},output:{type:"structure",members:{InstanceId:{}}},http:{}},RegisterRdsDbInstance:{input:{type:"structure",required:["StackId","RdsDbInstanceArn","DbUser","DbPassword"],members:{StackId:{},RdsDbInstanceArn:{},DbUser:{},DbPassword:{}}},http:{}},RegisterVolume:{input:{type:"structure",required:["StackId"],members:{Ec2VolumeId:{},StackId:{}}},output:{type:"structure",members:{VolumeId:{}}},http:{}},SetLoadBasedAutoScaling:{input:{type:"structure",required:["LayerId"],members:{LayerId:{},Enable:{type:"boolean"},UpScaling:{shape:"S2r"},DownScaling:{shape:"S2r"}}},http:{}},SetPermission:{input:{type:"structure",required:["StackId","IamUserArn"],members:{StackId:{},IamUserArn:{},AllowSsh:{type:"boolean"},AllowSudo:{type:"boolean"},Level:{}}},http:{}},SetTimeBasedAutoScaling:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{},AutoScalingSchedule:{shape:"S3r"}}},http:{}},StartInstance:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{}}},http:{}},StartStack:{input:{type:"structure",required:["StackId"],members:{StackId:{}}},http:{}},StopInstance:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{}}},http:{}},StopStack:{input:{type:"structure",required:["StackId"],members:{StackId:{}}},http:{}},UnassignInstance:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{}}},http:{}},UnassignVolume:{input:{type:"structure",required:["VolumeId"],members:{VolumeId:{}}},http:{}},UpdateApp:{input:{type:"structure",required:["AppId"],members:{AppId:{},Name:{},Description:{},DataSources:{shape:"Si"},Type:{},AppSource:{shape:"Sd"},Domains:{shape:"S3"},EnableSsl:{type:"boolean"},SslConfiguration:{shape:"Sl"},Attributes:{shape:"Sm"},Environment:{shape:"So"}}},http:{}},UpdateElasticIp:{input:{type:"structure",required:["ElasticIp"],members:{ElasticIp:{},Name:{}}},http:{}},UpdateInstance:{input:{type:"structure",required:["InstanceId"],members:{InstanceId:{},LayerIds:{shape:"S3"},InstanceType:{},AutoScalingType:{},Hostname:{},Os:{},AmiId:{},SshKeyName:{},Architecture:{},InstallUpdatesOnBoot:{type:"boolean"},EbsOptimized:{type:"boolean"}}},http:{}},UpdateLayer:{input:{type:"structure",required:["LayerId"],members:{LayerId:{},Name:{},Shortname:{},Attributes:{shape:"S17"},CustomInstanceProfileArn:{},CustomSecurityGroupIds:{shape:"S3"},Packages:{shape:"S3"},VolumeConfigurations:{shape:"S19"},EnableAutoHealing:{type:"boolean"},AutoAssignElasticIps:{type:"boolean"},AutoAssignPublicIps:{type:"boolean"},CustomRecipes:{shape:"S1b"},InstallUpdatesOnBoot:{type:"boolean"},UseEbsOptimizedInstances:{type:"boolean"},LifecycleEventConfiguration:{shape:"S1c"}}},http:{}},UpdateMyUserProfile:{input:{type:"structure",members:{SshPublicKey:{}}},http:{}},UpdateRdsDbInstance:{input:{type:"structure",required:["RdsDbInstanceArn"],members:{RdsDbInstanceArn:{},DbUser:{},DbPassword:{}}},http:{}},UpdateStack:{input:{type:"structure",required:["StackId"],members:{StackId:{},Name:{},Attributes:{shape:"S8"},ServiceRoleArn:{},DefaultInstanceProfileArn:{},DefaultOs:{},HostnameTheme:{},DefaultAvailabilityZone:{},DefaultSubnetId:{},CustomJson:{},ConfigurationManager:{shape:"Sa"},ChefConfiguration:{shape:"Sb"},UseCustomCookbooks:{type:"boolean"},CustomCookbooksSource:{shape:"Sd"},DefaultSshKeyName:{},DefaultRootDeviceType:{},UseOpsworksSecurityGroups:{type:"boolean"}}},http:{}},UpdateUserProfile:{input:{type:"structure",required:["IamUserArn"],members:{IamUserArn:{},SshUsername:{},SshPublicKey:{},AllowSelfManagement:{type:"boolean"}}},http:{}},UpdateVolume:{input:{type:"structure",required:["VolumeId"],members:{VolumeId:{},Name:{},MountPoint:{}}},http:{}}},shapes:{S3:{type:"list",member:{}},S8:{type:"map",key:{},value:{}},Sa:{type:"structure",members:{Name:{},Version:{}}},Sb:{type:"structure",members:{ManageBerkshelf:{type:"boolean"},BerkshelfVersion:{}}},Sd:{type:"structure",members:{Type:{},Url:{},Username:{},Password:{},SshKey:{},Revision:{}}},Si:{type:"list",member:{type:"structure",members:{Type:{},Arn:{},DatabaseName:{}}}},Sl:{type:"structure",required:["Certificate","PrivateKey"],members:{Certificate:{},PrivateKey:{},Chain:{}}},Sm:{type:"map",key:{},value:{}},So:{type:"list",member:{type:"structure",required:["Key","Value"],members:{Key:{},Value:{},Secure:{type:"boolean"}}}},Ss:{type:"structure",required:["Name"],members:{Name:{},Args:{type:"map",key:{},value:{shape:"S3"}}}},Sz:{type:"list",member:{type:"structure",members:{DeviceName:{},NoDevice:{},VirtualName:{},Ebs:{type:"structure",members:{SnapshotId:{},Iops:{type:"integer"},VolumeSize:{type:"integer"},VolumeType:{},DeleteOnTermination:{type:"boolean"}}}}}},S17:{type:"map",key:{},value:{}},S19:{type:"list",member:{type:"structure",required:["MountPoint","NumberOfDisks","Size"],members:{MountPoint:{},RaidLevel:{type:"integer"},NumberOfDisks:{type:"integer"},Size:{type:"integer"},VolumeType:{},Iops:{type:"integer"}}}},S1b:{type:"structure",members:{Setup:{shape:"S3"},Configure:{shape:"S3"},Deploy:{shape:"S3"},Undeploy:{shape:"S3"},Shutdown:{shape:"S3"}}},S1c:{type:"structure",members:{Shutdown:{type:"structure",members:{ExecutionTimeout:{type:"integer"},DelayUntilElbConnectionsDrained:{type:"boolean"}}}}},S2r:{type:"structure",members:{InstanceCount:{type:"integer"},ThresholdsWaitTime:{type:"integer"},IgnoreMetricsTime:{type:"integer"},CpuThreshold:{type:"double"},MemoryThreshold:{type:"double"},LoadThreshold:{type:"double"},Alarms:{shape:"S3"}}},S3r:{type:"structure",members:{Monday:{shape:"S3s"},Tuesday:{shape:"S3s"},Wednesday:{shape:"S3s"},Thursday:{shape:"S3s"},Friday:{shape:"S3s"},Saturday:{shape:"S3s"},Sunday:{shape:"S3s"}}},S3s:{type:"map",key:{},value:{}}},paginators:{DescribeApps:{result_key:"Apps"},DescribeCommands:{result_key:"Commands"},DescribeDeployments:{result_key:"Deployments"},DescribeElasticIps:{result_key:"ElasticIps"},DescribeElasticLoadBalancers:{result_key:"ElasticLoadBalancers"},DescribeInstances:{result_key:"Instances"},DescribeLayers:{result_key:"Layers"},DescribeLoadBasedAutoScaling:{result_key:"LoadBasedAutoScalingConfigurations"},DescribePermissions:{result_key:"Permissions"},DescribeRaidArrays:{result_key:"RaidArrays"},DescribeServiceErrors:{result_key:"ServiceErrors"},DescribeStacks:{result_key:"Stacks"},DescribeTimeBasedAutoScaling:{result_key:"TimeBasedAutoScalingConfigurations"},DescribeUserProfiles:{result_key:"UserProfiles"},DescribeVolumes:{result_key:"Volumes"}}},i.apiLoader.services.s3={},i.S3=i.Service.defineService("s3",["2006-03-01"]),e("./services/s3"),i.apiLoader.services.s3["2006-03-01"]={version:"2.0",metadata:{apiVersion:"2006-03-01",checksumFormat:"md5",endpointPrefix:"s3",globalEndpoint:"s3.amazonaws.com",serviceAbbreviation:"Amazon S3",serviceFullName:"Amazon Simple Storage Service",signatureVersion:"s3",timestampFormat:"rfc822",protocol:"rest-xml"},operations:{AbortMultipartUpload:{http:{method:"DELETE",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key","UploadId"],members:{Bucket:{location:"uri",locationName:"Bucket"},Key:{location:"uri",locationName:"Key"},UploadId:{location:"querystring",locationName:"uploadId"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},CompleteMultipartUpload:{http:{requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key","UploadId"],members:{Bucket:{location:"uri",locationName:"Bucket"},Key:{location:"uri",locationName:"Key"},MultipartUpload:{locationName:"CompleteMultipartUpload",xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},type:"structure",members:{Parts:{locationName:"Part",type:"list",member:{type:"structure",members:{ETag:{},PartNumber:{type:"integer"}}},flattened:!0}}},UploadId:{location:"querystring",locationName:"uploadId"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}},payload:"MultipartUpload"},output:{type:"structure",members:{Location:{},Bucket:{},Key:{},Expiration:{location:"header",locationName:"x-amz-expiration"},ETag:{},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},VersionId:{location:"header",locationName:"x-amz-version-id"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},CopyObject:{http:{method:"PUT",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","CopySource","Key"],members:{ACL:{location:"header",locationName:"x-amz-acl"},Bucket:{location:"uri",locationName:"Bucket"},CacheControl:{location:"header",locationName:"Cache-Control"},ContentDisposition:{location:"header",locationName:"Content-Disposition"},ContentEncoding:{location:"header",locationName:"Content-Encoding"},ContentLanguage:{location:"header",locationName:"Content-Language"},ContentType:{location:"header",locationName:"Content-Type"},CopySource:{location:"header",locationName:"x-amz-copy-source"},CopySourceIfMatch:{location:"header",locationName:"x-amz-copy-source-if-match"},CopySourceIfModifiedSince:{location:"header",locationName:"x-amz-copy-source-if-modified-since",type:"timestamp"},CopySourceIfNoneMatch:{location:"header",locationName:"x-amz-copy-source-if-none-match"},CopySourceIfUnmodifiedSince:{location:"header",locationName:"x-amz-copy-source-if-unmodified-since",type:"timestamp"},Expires:{location:"header",locationName:"Expires",type:"timestamp"},GrantFullControl:{location:"header",locationName:"x-amz-grant-full-control"},GrantRead:{location:"header",locationName:"x-amz-grant-read"},GrantReadACP:{location:"header",locationName:"x-amz-grant-read-acp"},GrantWriteACP:{location:"header",locationName:"x-amz-grant-write-acp"},Key:{location:"uri",locationName:"Key"},Metadata:{shape:"S11",location:"headers",locationName:"x-amz-meta-"},MetadataDirective:{location:"header",locationName:"x-amz-metadata-directive"},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},StorageClass:{location:"header",locationName:"x-amz-storage-class"},WebsiteRedirectLocation:{location:"header",locationName:"x-amz-website-redirect-location"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKey:{shape:"S18",location:"header",locationName:"x-amz-server-side-encryption-customer-key"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},CopySourceSSECustomerAlgorithm:{location:"header",locationName:"x-amz-copy-source-server-side-encryption-customer-algorithm"},CopySourceSSECustomerKey:{shape:"S1b",location:"header",locationName:"x-amz-copy-source-server-side-encryption-customer-key"},CopySourceSSECustomerKeyMD5:{location:"header",locationName:"x-amz-copy-source-server-side-encryption-customer-key-MD5"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{CopyObjectResult:{type:"structure",members:{ETag:{},LastModified:{type:"timestamp"}}},Expiration:{location:"header",locationName:"x-amz-expiration"},CopySourceVersionId:{location:"header",locationName:"x-amz-copy-source-version-id"},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}},payload:"CopyObjectResult"},alias:"PutObjectCopy"},CreateBucket:{http:{method:"PUT",requestUri:"/{Bucket}"},input:{type:"structure",required:["Bucket"],members:{ACL:{location:"header",locationName:"x-amz-acl"},Bucket:{location:"uri",locationName:"Bucket"},CreateBucketConfiguration:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"CreateBucketConfiguration",type:"structure",members:{LocationConstraint:{}}},GrantFullControl:{location:"header",locationName:"x-amz-grant-full-control"},GrantRead:{location:"header",locationName:"x-amz-grant-read"},GrantReadACP:{location:"header",locationName:"x-amz-grant-read-acp"},GrantWrite:{location:"header",locationName:"x-amz-grant-write"},GrantWriteACP:{location:"header",locationName:"x-amz-grant-write-acp"}},payload:"CreateBucketConfiguration"},output:{type:"structure",members:{Location:{location:"header",locationName:"Location"}}},alias:"PutBucket"},CreateMultipartUpload:{http:{requestUri:"/{Bucket}/{Key+}?uploads"},input:{type:"structure",required:["Bucket","Key"],members:{ACL:{location:"header",locationName:"x-amz-acl"},Bucket:{location:"uri",locationName:"Bucket"},CacheControl:{location:"header",locationName:"Cache-Control"},ContentDisposition:{location:"header",locationName:"Content-Disposition"},ContentEncoding:{location:"header",locationName:"Content-Encoding"},ContentLanguage:{location:"header",locationName:"Content-Language"},ContentType:{location:"header",locationName:"Content-Type"},Expires:{location:"header",locationName:"Expires",type:"timestamp"},GrantFullControl:{location:"header",locationName:"x-amz-grant-full-control"},GrantRead:{location:"header",locationName:"x-amz-grant-read"},GrantReadACP:{location:"header",locationName:"x-amz-grant-read-acp"},GrantWriteACP:{location:"header",locationName:"x-amz-grant-write-acp"},Key:{location:"uri",locationName:"Key"},Metadata:{shape:"S11",location:"headers",locationName:"x-amz-meta-"},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},StorageClass:{location:"header",locationName:"x-amz-storage-class"},WebsiteRedirectLocation:{location:"header",locationName:"x-amz-website-redirect-location"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKey:{shape:"S18",location:"header",locationName:"x-amz-server-side-encryption-customer-key"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{Bucket:{locationName:"Bucket"},Key:{},UploadId:{},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}},alias:"InitiateMultipartUpload"},DeleteBucket:{http:{method:"DELETE",requestUri:"/{Bucket}"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},DeleteBucketCors:{http:{method:"DELETE",requestUri:"/{Bucket}?cors"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},DeleteBucketLifecycle:{http:{method:"DELETE",requestUri:"/{Bucket}?lifecycle"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},DeleteBucketPolicy:{http:{method:"DELETE",requestUri:"/{Bucket}?policy"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},DeleteBucketReplication:{http:{method:"DELETE",requestUri:"/{Bucket}?replication"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},DeleteBucketTagging:{http:{method:"DELETE",requestUri:"/{Bucket}?tagging"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},DeleteBucketWebsite:{http:{method:"DELETE",requestUri:"/{Bucket}?website"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},DeleteObject:{http:{method:"DELETE",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key"],members:{Bucket:{location:"uri",locationName:"Bucket"},Key:{location:"uri",locationName:"Key"},MFA:{location:"header",locationName:"x-amz-mfa"},VersionId:{location:"querystring",locationName:"versionId"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{DeleteMarker:{location:"header",locationName:"x-amz-delete-marker",type:"boolean"},VersionId:{location:"header",locationName:"x-amz-version-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},DeleteObjects:{http:{requestUri:"/{Bucket}?delete"},input:{type:"structure",required:["Bucket","Delete"],members:{Bucket:{location:"uri",locationName:"Bucket"},Delete:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"Delete",type:"structure",required:["Objects"],members:{Objects:{locationName:"Object",type:"list",member:{type:"structure",required:["Key"],members:{Key:{},VersionId:{}}},flattened:!0},Quiet:{type:"boolean"}}},MFA:{location:"header",locationName:"x-amz-mfa"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}},payload:"Delete"},output:{type:"structure",members:{Deleted:{type:"list",member:{type:"structure",members:{Key:{},VersionId:{},DeleteMarker:{type:"boolean"},DeleteMarkerVersionId:{}}},flattened:!0},RequestCharged:{location:"header",locationName:"x-amz-request-charged"},Errors:{locationName:"Error",type:"list",member:{type:"structure",members:{Key:{},VersionId:{},Code:{},Message:{}}},flattened:!0}}},alias:"DeleteMultipleObjects"},GetBucketAcl:{http:{method:"GET",requestUri:"/{Bucket}?acl"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{Owner:{shape:"S2f"},Grants:{shape:"S2i",locationName:"AccessControlList"}}}},GetBucketCors:{http:{method:"GET",requestUri:"/{Bucket}?cors"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{CORSRules:{shape:"S2r",locationName:"CORSRule"}}}},GetBucketLifecycle:{http:{method:"GET",requestUri:"/{Bucket}?lifecycle"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{Rules:{shape:"S34",locationName:"Rule"}}}},GetBucketLocation:{http:{method:"GET",requestUri:"/{Bucket}?location"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{LocationConstraint:{}}}},GetBucketLogging:{http:{method:"GET",requestUri:"/{Bucket}?logging"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{LoggingEnabled:{shape:"S3j"}}}},GetBucketNotification:{http:{method:"GET",requestUri:"/{Bucket}?notification"},input:{shape:"S3p"},output:{shape:"S3q"},deprecated:!0},GetBucketNotificationConfiguration:{http:{method:"GET",requestUri:"/{Bucket}?notification"},input:{shape:"S3p"},output:{shape:"S41"}},GetBucketPolicy:{http:{method:"GET",requestUri:"/{Bucket}?policy"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{Policy:{}},payload:"Policy"}},GetBucketReplication:{http:{method:"GET",requestUri:"/{Bucket}?replication"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{ReplicationConfiguration:{shape:"S4e"}},payload:"ReplicationConfiguration"}},GetBucketRequestPayment:{http:{method:"GET",requestUri:"/{Bucket}?requestPayment"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{Payer:{}}}},GetBucketTagging:{http:{method:"GET",requestUri:"/{Bucket}?tagging"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",required:["TagSet"],members:{TagSet:{shape:"S4p"}}}},GetBucketVersioning:{http:{method:"GET",requestUri:"/{Bucket}?versioning"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{Status:{},MFADelete:{locationName:"MfaDelete"}}}},GetBucketWebsite:{http:{method:"GET",requestUri:"/{Bucket}?website"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},output:{type:"structure",members:{RedirectAllRequestsTo:{shape:"S4y"},IndexDocument:{shape:"S51"},ErrorDocument:{shape:"S53"},RoutingRules:{shape:"S54"}}}},GetObject:{http:{method:"GET",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key"],members:{Bucket:{location:"uri",locationName:"Bucket"},IfMatch:{location:"header",locationName:"If-Match"},IfModifiedSince:{location:"header",locationName:"If-Modified-Since",type:"timestamp"},IfNoneMatch:{location:"header",locationName:"If-None-Match"},IfUnmodifiedSince:{location:"header",locationName:"If-Unmodified-Since",type:"timestamp"},Key:{location:"uri",locationName:"Key"},Range:{location:"header",locationName:"Range"},ResponseCacheControl:{location:"querystring",locationName:"response-cache-control"},ResponseContentDisposition:{location:"querystring",locationName:"response-content-disposition"},ResponseContentEncoding:{location:"querystring",locationName:"response-content-encoding"},ResponseContentLanguage:{location:"querystring",locationName:"response-content-language"},ResponseContentType:{location:"querystring",locationName:"response-content-type"},ResponseExpires:{location:"querystring",locationName:"response-expires",type:"timestamp"},VersionId:{location:"querystring",locationName:"versionId"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKey:{shape:"S18",location:"header",locationName:"x-amz-server-side-encryption-customer-key"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{Body:{streaming:!0,type:"blob"},DeleteMarker:{location:"header",locationName:"x-amz-delete-marker",type:"boolean"},AcceptRanges:{location:"header",locationName:"accept-ranges"},Expiration:{location:"header",locationName:"x-amz-expiration"},Restore:{location:"header",locationName:"x-amz-restore"},LastModified:{location:"header",locationName:"Last-Modified",type:"timestamp"},ContentLength:{location:"header",locationName:"Content-Length",type:"integer"},ETag:{location:"header",locationName:"ETag"},MissingMeta:{location:"header",locationName:"x-amz-missing-meta",type:"integer"},VersionId:{location:"header",locationName:"x-amz-version-id"},CacheControl:{location:"header",locationName:"Cache-Control"},ContentDisposition:{location:"header",locationName:"Content-Disposition"},ContentEncoding:{location:"header",locationName:"Content-Encoding"},ContentLanguage:{location:"header",locationName:"Content-Language"},ContentType:{location:"header",locationName:"Content-Type"},Expires:{location:"header",locationName:"Expires",type:"timestamp"},WebsiteRedirectLocation:{location:"header",locationName:"x-amz-website-redirect-location"},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},Metadata:{shape:"S11",location:"headers",locationName:"x-amz-meta-"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"},ReplicationStatus:{location:"header",locationName:"x-amz-replication-status"}},payload:"Body"}},GetObjectAcl:{http:{method:"GET",requestUri:"/{Bucket}/{Key+}?acl"},input:{type:"structure",required:["Bucket","Key"],members:{Bucket:{location:"uri",locationName:"Bucket"},Key:{location:"uri",locationName:"Key"},VersionId:{location:"querystring",locationName:"versionId"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{Owner:{shape:"S2f"},Grants:{shape:"S2i",locationName:"AccessControlList"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},GetObjectTorrent:{http:{method:"GET",requestUri:"/{Bucket}/{Key+}?torrent"},input:{type:"structure",required:["Bucket","Key"],members:{Bucket:{location:"uri",locationName:"Bucket"},Key:{location:"uri",locationName:"Key"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{Body:{streaming:!0,type:"blob"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}},payload:"Body"}},HeadBucket:{http:{method:"HEAD",requestUri:"/{Bucket}"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}}},HeadObject:{http:{method:"HEAD",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key"],members:{Bucket:{location:"uri",locationName:"Bucket"},IfMatch:{location:"header",locationName:"If-Match"},IfModifiedSince:{location:"header",locationName:"If-Modified-Since",type:"timestamp"},IfNoneMatch:{location:"header",locationName:"If-None-Match"},IfUnmodifiedSince:{location:"header",locationName:"If-Unmodified-Since",type:"timestamp"},Key:{location:"uri",locationName:"Key"},Range:{location:"header",locationName:"Range"},VersionId:{location:"querystring",locationName:"versionId"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKey:{shape:"S18",location:"header",locationName:"x-amz-server-side-encryption-customer-key"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{DeleteMarker:{location:"header",locationName:"x-amz-delete-marker",type:"boolean"},AcceptRanges:{location:"header",locationName:"accept-ranges"},Expiration:{location:"header",locationName:"x-amz-expiration"},Restore:{location:"header",locationName:"x-amz-restore"},LastModified:{location:"header",locationName:"Last-Modified",type:"timestamp"},ContentLength:{location:"header",locationName:"Content-Length",type:"integer"},ETag:{location:"header",locationName:"ETag"},MissingMeta:{location:"header",locationName:"x-amz-missing-meta",type:"integer"},VersionId:{location:"header",locationName:"x-amz-version-id"},CacheControl:{location:"header",locationName:"Cache-Control"},ContentDisposition:{location:"header",locationName:"Content-Disposition"},ContentEncoding:{location:"header",locationName:"Content-Encoding"},ContentLanguage:{location:"header",locationName:"Content-Language"},ContentType:{location:"header",locationName:"Content-Type"},Expires:{location:"header",locationName:"Expires",type:"timestamp"},WebsiteRedirectLocation:{location:"header",locationName:"x-amz-website-redirect-location"},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},Metadata:{shape:"S11",location:"headers",locationName:"x-amz-meta-"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"},ReplicationStatus:{location:"header",locationName:"x-amz-replication-status"}}}},ListBuckets:{http:{method:"GET"},output:{type:"structure",members:{Buckets:{type:"list",member:{locationName:"Bucket",type:"structure",members:{Name:{},CreationDate:{type:"timestamp"}}}},Owner:{shape:"S2f"}}},alias:"GetService"},ListMultipartUploads:{http:{method:"GET",requestUri:"/{Bucket}?uploads"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"},Delimiter:{location:"querystring",locationName:"delimiter"},EncodingType:{location:"querystring",locationName:"encoding-type"},KeyMarker:{location:"querystring",locationName:"key-marker"},MaxUploads:{location:"querystring",locationName:"max-uploads",type:"integer"},Prefix:{location:"querystring",locationName:"prefix"},UploadIdMarker:{location:"querystring",locationName:"upload-id-marker"}}},output:{type:"structure",members:{Bucket:{},KeyMarker:{},UploadIdMarker:{},NextKeyMarker:{},Prefix:{},Delimiter:{},NextUploadIdMarker:{},MaxUploads:{type:"integer"},IsTruncated:{type:"boolean"},Uploads:{locationName:"Upload",type:"list",member:{type:"structure",members:{UploadId:{},Key:{},Initiated:{type:"timestamp"},StorageClass:{},Owner:{shape:"S2f"},Initiator:{shape:"S6k"}}},flattened:!0},CommonPrefixes:{shape:"S6l"},EncodingType:{}}}},ListObjectVersions:{http:{method:"GET",requestUri:"/{Bucket}?versions"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"},Delimiter:{location:"querystring",locationName:"delimiter"},EncodingType:{location:"querystring",locationName:"encoding-type"},KeyMarker:{location:"querystring",locationName:"key-marker"},MaxKeys:{location:"querystring",locationName:"max-keys",type:"integer"},Prefix:{location:"querystring",locationName:"prefix"},VersionIdMarker:{location:"querystring",locationName:"version-id-marker"}}},output:{type:"structure",members:{IsTruncated:{type:"boolean"},KeyMarker:{},VersionIdMarker:{},NextKeyMarker:{},NextVersionIdMarker:{},Versions:{locationName:"Version",type:"list",member:{type:"structure",members:{ETag:{},Size:{type:"integer"},StorageClass:{},Key:{},VersionId:{},IsLatest:{type:"boolean"},LastModified:{type:"timestamp"},Owner:{shape:"S2f"}}},flattened:!0},DeleteMarkers:{locationName:"DeleteMarker",type:"list",member:{type:"structure",members:{Owner:{shape:"S2f"},Key:{},VersionId:{},IsLatest:{type:"boolean"},LastModified:{type:"timestamp"}}},flattened:!0},Name:{},Prefix:{},Delimiter:{},MaxKeys:{type:"integer"},CommonPrefixes:{shape:"S6l"},EncodingType:{}}},alias:"GetBucketObjectVersions"},ListObjects:{http:{method:"GET",requestUri:"/{Bucket}"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"},Delimiter:{location:"querystring",locationName:"delimiter"},EncodingType:{location:"querystring",locationName:"encoding-type"},Marker:{location:"querystring",locationName:"marker"},MaxKeys:{location:"querystring",locationName:"max-keys",type:"integer"},Prefix:{location:"querystring",locationName:"prefix"}}},output:{type:"structure",members:{IsTruncated:{type:"boolean"},Marker:{},NextMarker:{},Contents:{type:"list",member:{type:"structure",members:{Key:{},LastModified:{type:"timestamp"},ETag:{},Size:{type:"integer"},StorageClass:{},Owner:{shape:"S2f"}}},flattened:!0},Name:{},Prefix:{},Delimiter:{},MaxKeys:{type:"integer"},CommonPrefixes:{shape:"S6l"},EncodingType:{}}},alias:"GetBucket"},ListParts:{http:{method:"GET",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key","UploadId"],members:{Bucket:{location:"uri",locationName:"Bucket"},Key:{location:"uri",locationName:"Key"},MaxParts:{location:"querystring",locationName:"max-parts",type:"integer"},PartNumberMarker:{location:"querystring",locationName:"part-number-marker",type:"integer"},UploadId:{location:"querystring",locationName:"uploadId"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{Bucket:{},Key:{},UploadId:{},PartNumberMarker:{type:"integer"},NextPartNumberMarker:{type:"integer"},MaxParts:{type:"integer"},IsTruncated:{type:"boolean"},Parts:{locationName:"Part",type:"list",member:{type:"structure",members:{PartNumber:{type:"integer"},LastModified:{type:"timestamp"},ETag:{},Size:{type:"integer"}}},flattened:!0},Initiator:{shape:"S6k"},Owner:{shape:"S2f"},StorageClass:{},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},PutBucketAcl:{http:{method:"PUT",requestUri:"/{Bucket}?acl"},input:{type:"structure",required:["Bucket"],members:{ACL:{location:"header",locationName:"x-amz-acl"},AccessControlPolicy:{shape:"S7e",xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"AccessControlPolicy"},Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},GrantFullControl:{location:"header",locationName:"x-amz-grant-full-control"},GrantRead:{location:"header",locationName:"x-amz-grant-read"},GrantReadACP:{location:"header",locationName:"x-amz-grant-read-acp"},GrantWrite:{location:"header",locationName:"x-amz-grant-write"},GrantWriteACP:{location:"header",locationName:"x-amz-grant-write-acp"}},payload:"AccessControlPolicy"}},PutBucketCors:{http:{method:"PUT",requestUri:"/{Bucket}?cors"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"},CORSConfiguration:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"CORSConfiguration",type:"structure",members:{CORSRules:{shape:"S2r",locationName:"CORSRule"}}},ContentMD5:{location:"header",locationName:"Content-MD5"}},payload:"CORSConfiguration"}},PutBucketLifecycle:{http:{method:"PUT",requestUri:"/{Bucket}?lifecycle"},input:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},LifecycleConfiguration:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"LifecycleConfiguration",type:"structure",required:["Rules"],members:{Rules:{shape:"S34",locationName:"Rule"}}}},payload:"LifecycleConfiguration"}},PutBucketLogging:{http:{method:"PUT",requestUri:"/{Bucket}?logging"},input:{type:"structure",required:["Bucket","BucketLoggingStatus"],members:{Bucket:{location:"uri",locationName:"Bucket"},BucketLoggingStatus:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"BucketLoggingStatus",type:"structure",members:{LoggingEnabled:{shape:"S3j"}}},ContentMD5:{location:"header",locationName:"Content-MD5"}},payload:"BucketLoggingStatus"}},PutBucketNotification:{http:{method:"PUT",requestUri:"/{Bucket}?notification"},input:{type:"structure",required:["Bucket","NotificationConfiguration"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},NotificationConfiguration:{shape:"S3q",xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"NotificationConfiguration"}},payload:"NotificationConfiguration"},deprecated:!0},PutBucketNotificationConfiguration:{http:{method:"PUT",requestUri:"/{Bucket}?notification"},input:{type:"structure",required:["Bucket","NotificationConfiguration"],members:{Bucket:{location:"uri",locationName:"Bucket"},NotificationConfiguration:{shape:"S41",xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"NotificationConfiguration"}},payload:"NotificationConfiguration"}},PutBucketPolicy:{http:{method:"PUT",requestUri:"/{Bucket}?policy"},input:{type:"structure",required:["Bucket","Policy"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},Policy:{}},payload:"Policy"}},PutBucketReplication:{http:{method:"PUT",requestUri:"/{Bucket}?replication"},input:{type:"structure",required:["Bucket","ReplicationConfiguration"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},ReplicationConfiguration:{shape:"S4e",xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"ReplicationConfiguration"}},payload:"ReplicationConfiguration"}},PutBucketRequestPayment:{http:{method:"PUT",requestUri:"/{Bucket}?requestPayment"},input:{type:"structure",required:["Bucket","RequestPaymentConfiguration"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},RequestPaymentConfiguration:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"RequestPaymentConfiguration",type:"structure",required:["Payer"],members:{Payer:{}}}},payload:"RequestPaymentConfiguration"}},PutBucketTagging:{http:{method:"PUT",requestUri:"/{Bucket}?tagging"},input:{type:"structure",required:["Bucket","Tagging"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},Tagging:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"Tagging",type:"structure",required:["TagSet"],members:{TagSet:{shape:"S4p"}}}},payload:"Tagging"}},PutBucketVersioning:{http:{method:"PUT",requestUri:"/{Bucket}?versioning"},input:{type:"structure",required:["Bucket","VersioningConfiguration"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},MFA:{location:"header",locationName:"x-amz-mfa"},VersioningConfiguration:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"VersioningConfiguration",type:"structure",members:{MFADelete:{locationName:"MfaDelete"},Status:{}}}},payload:"VersioningConfiguration"}},PutBucketWebsite:{http:{method:"PUT",requestUri:"/{Bucket}?website"},input:{type:"structure",required:["Bucket","WebsiteConfiguration"],members:{Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},WebsiteConfiguration:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"WebsiteConfiguration",type:"structure",members:{ErrorDocument:{shape:"S53"},IndexDocument:{shape:"S51"},RedirectAllRequestsTo:{shape:"S4y"},RoutingRules:{shape:"S54"}}}},payload:"WebsiteConfiguration"}},PutObject:{http:{method:"PUT",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key"],members:{ACL:{location:"header",locationName:"x-amz-acl"},Body:{streaming:!0,type:"blob"},Bucket:{location:"uri",locationName:"Bucket"},CacheControl:{location:"header",locationName:"Cache-Control"},ContentDisposition:{location:"header",locationName:"Content-Disposition"},ContentEncoding:{location:"header",locationName:"Content-Encoding"},ContentLanguage:{location:"header",locationName:"Content-Language"},ContentLength:{location:"header",locationName:"Content-Length",type:"integer"},ContentMD5:{location:"header",locationName:"Content-MD5"},ContentType:{location:"header",locationName:"Content-Type"},Expires:{location:"header",locationName:"Expires",type:"timestamp"},GrantFullControl:{location:"header",locationName:"x-amz-grant-full-control"},GrantRead:{location:"header",locationName:"x-amz-grant-read"},GrantReadACP:{location:"header",locationName:"x-amz-grant-read-acp"},GrantWriteACP:{location:"header",locationName:"x-amz-grant-write-acp"},Key:{location:"uri",locationName:"Key"},Metadata:{shape:"S11",location:"headers",locationName:"x-amz-meta-"},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},StorageClass:{location:"header",locationName:"x-amz-storage-class"},WebsiteRedirectLocation:{location:"header",locationName:"x-amz-website-redirect-location"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKey:{shape:"S18",location:"header",locationName:"x-amz-server-side-encryption-customer-key"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}},payload:"Body"},output:{type:"structure",members:{Expiration:{location:"header",locationName:"x-amz-expiration"},ETag:{location:"header",locationName:"ETag"},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},VersionId:{location:"header",locationName:"x-amz-version-id"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},PutObjectAcl:{http:{method:"PUT",requestUri:"/{Bucket}/{Key+}?acl"},input:{type:"structure",required:["Bucket","Key"],members:{ACL:{location:"header",locationName:"x-amz-acl"},AccessControlPolicy:{shape:"S7e",xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"AccessControlPolicy"},Bucket:{location:"uri",locationName:"Bucket"},ContentMD5:{location:"header",locationName:"Content-MD5"},GrantFullControl:{location:"header",locationName:"x-amz-grant-full-control"},GrantRead:{location:"header",locationName:"x-amz-grant-read"},GrantReadACP:{location:"header",locationName:"x-amz-grant-read-acp"},GrantWrite:{location:"header",locationName:"x-amz-grant-write"},GrantWriteACP:{location:"header",locationName:"x-amz-grant-write-acp"},Key:{location:"uri",locationName:"Key"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}},payload:"AccessControlPolicy"},output:{type:"structure",members:{RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},RestoreObject:{http:{requestUri:"/{Bucket}/{Key+}?restore"},input:{type:"structure",required:["Bucket","Key"],members:{Bucket:{location:"uri",locationName:"Bucket"},Key:{location:"uri",locationName:"Key"},VersionId:{location:"querystring",locationName:"versionId"},RestoreRequest:{xmlNamespace:{uri:"http://s3.amazonaws.com/doc/2006-03-01/"},locationName:"RestoreRequest",type:"structure",required:["Days"],members:{Days:{type:"integer"}}},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}},payload:"RestoreRequest"},output:{type:"structure",members:{RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}},alias:"PostObjectRestore"},UploadPart:{http:{method:"PUT",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","Key","PartNumber","UploadId"],members:{Body:{streaming:!0,type:"blob"},Bucket:{location:"uri",locationName:"Bucket"},ContentLength:{location:"header",locationName:"Content-Length",type:"integer"},ContentMD5:{location:"header",locationName:"Content-MD5"},Key:{location:"uri",locationName:"Key"},PartNumber:{location:"querystring",locationName:"partNumber",type:"integer"},UploadId:{location:"querystring",locationName:"uploadId"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKey:{shape:"S18",location:"header",locationName:"x-amz-server-side-encryption-customer-key"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}},payload:"Body"},output:{type:"structure",members:{ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},ETag:{location:"header",locationName:"ETag"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}}}},UploadPartCopy:{http:{method:"PUT",requestUri:"/{Bucket}/{Key+}"},input:{type:"structure",required:["Bucket","CopySource","Key","PartNumber","UploadId"],members:{Bucket:{location:"uri",locationName:"Bucket"},CopySource:{location:"header",locationName:"x-amz-copy-source"},CopySourceIfMatch:{location:"header",locationName:"x-amz-copy-source-if-match"},CopySourceIfModifiedSince:{location:"header",locationName:"x-amz-copy-source-if-modified-since",type:"timestamp"},CopySourceIfNoneMatch:{location:"header",locationName:"x-amz-copy-source-if-none-match"},CopySourceIfUnmodifiedSince:{location:"header",locationName:"x-amz-copy-source-if-unmodified-since",type:"timestamp"},CopySourceRange:{location:"header",locationName:"x-amz-copy-source-range"},Key:{location:"uri",locationName:"Key"},PartNumber:{location:"querystring",locationName:"partNumber",type:"integer"},UploadId:{location:"querystring",locationName:"uploadId"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKey:{shape:"S18",location:"header",locationName:"x-amz-server-side-encryption-customer-key"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},CopySourceSSECustomerAlgorithm:{location:"header",locationName:"x-amz-copy-source-server-side-encryption-customer-algorithm"},CopySourceSSECustomerKey:{shape:"S1b",location:"header",locationName:"x-amz-copy-source-server-side-encryption-customer-key"},CopySourceSSECustomerKeyMD5:{location:"header",locationName:"x-amz-copy-source-server-side-encryption-customer-key-MD5"},RequestPayer:{location:"header",locationName:"x-amz-request-payer"}}},output:{type:"structure",members:{CopySourceVersionId:{location:"header",locationName:"x-amz-copy-source-version-id"},CopyPartResult:{type:"structure",members:{ETag:{},LastModified:{type:"timestamp"}}},ServerSideEncryption:{location:"header",locationName:"x-amz-server-side-encryption"},SSECustomerAlgorithm:{location:"header",locationName:"x-amz-server-side-encryption-customer-algorithm"},SSECustomerKeyMD5:{location:"header",locationName:"x-amz-server-side-encryption-customer-key-MD5"},SSEKMSKeyId:{shape:"Sj",location:"header",locationName:"x-amz-server-side-encryption-aws-kms-key-id"},RequestCharged:{location:"header",locationName:"x-amz-request-charged"}},payload:"CopyPartResult"}}},shapes:{Sj:{type:"string",sensitive:!0},S11:{type:"map",key:{},value:{}},S18:{type:"string",sensitive:!0},S1b:{type:"string",sensitive:!0},S2f:{type:"structure",members:{DisplayName:{},ID:{}}},S2i:{type:"list",member:{locationName:"Grant",type:"structure",members:{Grantee:{shape:"S2k"},Permission:{}}}},S2k:{type:"structure",required:["Type"],members:{DisplayName:{},EmailAddress:{},ID:{},Type:{xmlAttribute:!0,locationName:"xsi:type"},URI:{}},xmlNamespace:{prefix:"xsi",uri:"http://www.w3.org/2001/XMLSchema-instance"}},S2r:{type:"list",member:{type:"structure",members:{AllowedHeaders:{locationName:"AllowedHeader",type:"list",member:{},flattened:!0},AllowedMethods:{locationName:"AllowedMethod",type:"list",member:{},flattened:!0},AllowedOrigins:{locationName:"AllowedOrigin",type:"list",member:{},flattened:!0},ExposeHeaders:{locationName:"ExposeHeader",type:"list",member:{},flattened:!0},MaxAgeSeconds:{type:"integer"}}},flattened:!0},S34:{type:"list",member:{type:"structure",required:["Prefix","Status"],members:{Expiration:{type:"structure",members:{Date:{shape:"S37"},Days:{type:"integer"}}},ID:{},Prefix:{},Status:{},Transition:{type:"structure",members:{Date:{shape:"S37"},Days:{type:"integer"},StorageClass:{}}},NoncurrentVersionTransition:{type:"structure",members:{NoncurrentDays:{type:"integer"},StorageClass:{}}},NoncurrentVersionExpiration:{type:"structure",members:{NoncurrentDays:{type:"integer"}}}}},flattened:!0},S37:{type:"timestamp",timestampFormat:"iso8601"},S3j:{type:"structure",members:{TargetBucket:{},TargetGrants:{type:"list",member:{locationName:"Grant",type:"structure",members:{Grantee:{shape:"S2k"},Permission:{}}}},TargetPrefix:{}}},S3p:{type:"structure",required:["Bucket"],members:{Bucket:{location:"uri",locationName:"Bucket"}}},S3q:{type:"structure",members:{TopicConfiguration:{type:"structure",members:{Id:{},Events:{shape:"S3t",locationName:"Event"},Event:{deprecated:!0},Topic:{}}},QueueConfiguration:{type:"structure",members:{Id:{},Event:{deprecated:!0},Events:{shape:"S3t",locationName:"Event"},Queue:{}}},CloudFunctionConfiguration:{type:"structure",members:{Id:{},Event:{deprecated:!0},Events:{shape:"S3t",locationName:"Event"},CloudFunction:{},InvocationRole:{}}}}},S3t:{type:"list",member:{},flattened:!0},S41:{type:"structure",members:{TopicConfigurations:{locationName:"TopicConfiguration",type:"list",member:{type:"structure",required:["TopicArn","Events"],members:{Id:{},TopicArn:{locationName:"Topic"},Events:{shape:"S3t",locationName:"Event"}}},flattened:!0},QueueConfigurations:{locationName:"QueueConfiguration",type:"list",member:{type:"structure",required:["QueueArn","Events"],members:{Id:{},QueueArn:{locationName:"Queue"},Events:{shape:"S3t",locationName:"Event"}}},flattened:!0},LambdaFunctionConfigurations:{locationName:"CloudFunctionConfiguration",type:"list",member:{type:"structure",required:["LambdaFunctionArn","Events"],members:{Id:{},LambdaFunctionArn:{locationName:"CloudFunction"},Events:{shape:"S3t",locationName:"Event"}}},flattened:!0}}},S4e:{type:"structure",required:["Role","Rules"],members:{Role:{},Rules:{locationName:"Rule",type:"list",member:{type:"structure",required:["Prefix","Status","Destination"],members:{ID:{},Prefix:{},Status:{},Destination:{type:"structure",required:["Bucket"],members:{Bucket:{}}}}},flattened:!0}}},S4p:{type:"list",member:{locationName:"Tag",type:"structure",required:["Key","Value"],members:{Key:{},Value:{}}}},S4y:{type:"structure",required:["HostName"],members:{HostName:{},Protocol:{}}},S51:{type:"structure",required:["Suffix"],members:{Suffix:{}}},S53:{type:"structure",required:["Key"],members:{Key:{}}},S54:{type:"list",member:{locationName:"RoutingRule",type:"structure",required:["Redirect"],members:{Condition:{type:"structure",members:{HttpErrorCodeReturnedEquals:{},KeyPrefixEquals:{}}},Redirect:{type:"structure",members:{HostName:{},HttpRedirectCode:{},Protocol:{},ReplaceKeyPrefixWith:{},ReplaceKeyWith:{}}}}}},S6k:{type:"structure",members:{ID:{},DisplayName:{}}},S6l:{type:"list",member:{type:"structure",members:{Prefix:{}}},flattened:!0},S7e:{type:"structure",members:{Grants:{shape:"S2i",locationName:"AccessControlList"},Owner:{shape:"S2f"}}}},paginators:{ListBuckets:{result_key:"Buckets"},ListMultipartUploads:{limit_key:"MaxUploads",more_results:"IsTruncated",output_token:["NextKeyMarker","NextUploadIdMarker"],input_token:["KeyMarker","UploadIdMarker"],result_key:["Uploads","CommonPrefixes"]},ListObjectVersions:{more_results:"IsTruncated",limit_key:"MaxKeys",output_token:["NextKeyMarker","NextVersionIdMarker"],input_token:["KeyMarker","VersionIdMarker"],result_key:["Versions","DeleteMarkers","CommonPrefixes"]},ListObjects:{more_results:"IsTruncated",limit_key:"MaxKeys",output_token:"NextMarker || Contents[-1].Key",input_token:"Marker",result_key:["Contents","CommonPrefixes"]},ListParts:{more_results:"IsTruncated",limit_key:"MaxParts",output_token:"NextPartNumberMarker",input_token:"PartNumberMarker",result_key:"Parts"}},waiters:{__default__:{interval:5,max_attempts:20},BucketExists:{operation:"HeadBucket",ignore_errors:[404],success_type:"output"},BucketNotExists:{operation:"HeadBucket",success_type:"error",success_value:404},ObjectExists:{operation:"HeadObject",ignore_errors:[404],success_type:"output"},ObjectNotExists:{operation:"HeadObject",success_type:"error",success_value:404}}},i.apiLoader.services.sns={},i.SNS=i.Service.defineService("sns",["2010-03-31"]),i.apiLoader.services.sns["2010-03-31"]={metadata:{apiVersion:"2010-03-31",endpointPrefix:"sns",serviceAbbreviation:"Amazon SNS",serviceFullName:"Amazon Simple Notification Service",signatureVersion:"v4",xmlNamespace:"http://sns.amazonaws.com/doc/2010-03-31/",protocol:"query"},operations:{AddPermission:{input:{type:"structure",required:["TopicArn","Label","AWSAccountId","ActionName"],members:{TopicArn:{},Label:{},AWSAccountId:{type:"list",member:{}},ActionName:{type:"list",member:{}}}},http:{}},ConfirmSubscription:{input:{type:"structure",required:["TopicArn","Token"],members:{TopicArn:{},Token:{},AuthenticateOnUnsubscribe:{}}},output:{resultWrapper:"ConfirmSubscriptionResult",type:"structure",members:{SubscriptionArn:{}}},http:{}},CreatePlatformApplication:{input:{type:"structure",required:["Name","Platform","Attributes"],members:{Name:{},Platform:{},Attributes:{shape:"Sf"}}},output:{resultWrapper:"CreatePlatformApplicationResult",type:"structure",members:{PlatformApplicationArn:{}}},http:{}},CreatePlatformEndpoint:{input:{type:"structure",required:["PlatformApplicationArn","Token"],members:{PlatformApplicationArn:{},Token:{},CustomUserData:{},Attributes:{shape:"Sf"}}},output:{resultWrapper:"CreatePlatformEndpointResult",type:"structure",members:{EndpointArn:{}}},http:{}},CreateTopic:{input:{type:"structure",required:["Name"],members:{Name:{}}},output:{resultWrapper:"CreateTopicResult",type:"structure",members:{TopicArn:{}}},http:{}},DeleteEndpoint:{input:{type:"structure",required:["EndpointArn"],members:{EndpointArn:{}}},http:{}},DeletePlatformApplication:{input:{type:"structure",required:["PlatformApplicationArn"],members:{PlatformApplicationArn:{}}},http:{}},DeleteTopic:{input:{type:"structure",required:["TopicArn"],members:{TopicArn:{}}},http:{}},GetEndpointAttributes:{input:{type:"structure",required:["EndpointArn"],members:{EndpointArn:{}}},output:{resultWrapper:"GetEndpointAttributesResult",type:"structure",members:{Attributes:{shape:"Sf"}}},http:{}},GetPlatformApplicationAttributes:{input:{type:"structure",required:["PlatformApplicationArn"],members:{PlatformApplicationArn:{}}},output:{resultWrapper:"GetPlatformApplicationAttributesResult",type:"structure",members:{Attributes:{shape:"Sf"}}},http:{}},GetSubscriptionAttributes:{input:{type:"structure",required:["SubscriptionArn"],members:{SubscriptionArn:{}}},output:{resultWrapper:"GetSubscriptionAttributesResult",type:"structure",members:{Attributes:{type:"map",key:{},value:{}}}},http:{}},GetTopicAttributes:{input:{type:"structure",required:["TopicArn"],members:{TopicArn:{}}},output:{resultWrapper:"GetTopicAttributesResult",type:"structure",members:{Attributes:{type:"map",key:{},value:{}}}},http:{}},ListEndpointsByPlatformApplication:{input:{type:"structure",required:["PlatformApplicationArn"],members:{PlatformApplicationArn:{},NextToken:{}}},output:{resultWrapper:"ListEndpointsByPlatformApplicationResult",type:"structure",members:{Endpoints:{type:"list",member:{type:"structure",members:{EndpointArn:{},Attributes:{shape:"Sf"}}}},NextToken:{}}},http:{}},ListPlatformApplications:{input:{type:"structure",members:{NextToken:{}}},output:{resultWrapper:"ListPlatformApplicationsResult",type:"structure",members:{PlatformApplications:{type:"list",member:{type:"structure",members:{PlatformApplicationArn:{},Attributes:{shape:"Sf"}}}},NextToken:{}}},http:{}},ListSubscriptions:{input:{type:"structure",members:{NextToken:{}}},output:{resultWrapper:"ListSubscriptionsResult",type:"structure",members:{Subscriptions:{shape:"S1c"},NextToken:{}}},http:{}},ListSubscriptionsByTopic:{input:{type:"structure",required:["TopicArn"],members:{TopicArn:{},NextToken:{}}},output:{resultWrapper:"ListSubscriptionsByTopicResult",type:"structure",members:{Subscriptions:{shape:"S1c"},NextToken:{}}},http:{}},ListTopics:{input:{type:"structure",members:{NextToken:{}}},output:{resultWrapper:"ListTopicsResult",type:"structure",members:{Topics:{type:"list",member:{type:"structure",members:{TopicArn:{}}}},NextToken:{}}},http:{}},Publish:{input:{type:"structure",required:["Message"],members:{TopicArn:{},TargetArn:{},Message:{},Subject:{},MessageStructure:{},MessageAttributes:{type:"map",key:{locationName:"Name"},value:{locationName:"Value",type:"structure",required:["DataType"],members:{DataType:{},StringValue:{},BinaryValue:{type:"blob"}}}}}},output:{resultWrapper:"PublishResult",type:"structure",members:{MessageId:{}}},http:{}},RemovePermission:{input:{type:"structure",required:["TopicArn","Label"],members:{TopicArn:{},Label:{}}},http:{}},SetEndpointAttributes:{input:{type:"structure",required:["EndpointArn","Attributes"],members:{EndpointArn:{},Attributes:{shape:"Sf"}}},http:{}},SetPlatformApplicationAttributes:{input:{type:"structure",required:["PlatformApplicationArn","Attributes"],members:{PlatformApplicationArn:{},Attributes:{shape:"Sf"}}},http:{}},SetSubscriptionAttributes:{input:{type:"structure",required:["SubscriptionArn","AttributeName"],members:{SubscriptionArn:{},AttributeName:{},AttributeValue:{}}},http:{}},SetTopicAttributes:{input:{type:"structure",required:["TopicArn","AttributeName"],members:{TopicArn:{},AttributeName:{},AttributeValue:{}}},http:{}},Subscribe:{input:{type:"structure",required:["TopicArn","Protocol"],members:{TopicArn:{},Protocol:{},Endpoint:{}}},output:{resultWrapper:"SubscribeResult",type:"structure",members:{SubscriptionArn:{}}},http:{}},Unsubscribe:{input:{type:"structure",required:["SubscriptionArn"],members:{SubscriptionArn:{}}},http:{}}},shapes:{Sf:{type:"map",key:{},value:{}},S1c:{type:"list",member:{type:"structure",members:{SubscriptionArn:{},Owner:{},Protocol:{},Endpoint:{},TopicArn:{}}}}},paginators:{ListEndpointsByPlatformApplication:{input_token:"NextToken",output_token:"NextToken",result_key:"Endpoints"},ListPlatformApplications:{input_token:"NextToken",output_token:"NextToken",result_key:"PlatformApplications"},ListSubscriptions:{input_token:"NextToken",output_token:"NextToken",result_key:"Subscriptions"},ListSubscriptionsByTopic:{input_token:"NextToken",output_token:"NextToken",result_key:"Subscriptions"},ListTopics:{input_token:"NextToken",output_token:"NextToken",result_key:"Topics"}}},i.apiLoader.services.sqs={},i.SQS=i.Service.defineService("sqs",["2012-11-05"]),e("./services/sqs"),i.apiLoader.services.sqs["2012-11-05"]={metadata:{apiVersion:"2012-11-05",endpointPrefix:"sqs",serviceAbbreviation:"Amazon SQS",serviceFullName:"Amazon Simple Queue Service",signatureVersion:"v4",xmlNamespace:"http://queue.amazonaws.com/doc/2012-11-05/",protocol:"query"},operations:{AddPermission:{input:{type:"structure",required:["QueueUrl","Label","AWSAccountIds","Actions"],members:{QueueUrl:{},Label:{},AWSAccountIds:{type:"list",member:{locationName:"AWSAccountId"},flattened:!0},Actions:{type:"list",member:{locationName:"ActionName"},flattened:!0}}},http:{}},ChangeMessageVisibility:{input:{type:"structure",required:["QueueUrl","ReceiptHandle","VisibilityTimeout"],members:{QueueUrl:{},ReceiptHandle:{},VisibilityTimeout:{type:"integer"}}},http:{}},ChangeMessageVisibilityBatch:{input:{type:"structure",required:["QueueUrl","Entries"],members:{QueueUrl:{},Entries:{type:"list",member:{locationName:"ChangeMessageVisibilityBatchRequestEntry",type:"structure",required:["Id","ReceiptHandle"],members:{Id:{},ReceiptHandle:{},VisibilityTimeout:{type:"integer"}}},flattened:!0}}},output:{resultWrapper:"ChangeMessageVisibilityBatchResult",type:"structure",required:["Successful","Failed"],members:{Successful:{type:"list",member:{locationName:"ChangeMessageVisibilityBatchResultEntry",type:"structure",required:["Id"],members:{Id:{}}},flattened:!0},Failed:{shape:"Sd"}}},http:{}},CreateQueue:{input:{type:"structure",required:["QueueName"],members:{QueueName:{},Attributes:{shape:"Sh",locationName:"Attribute"}}},output:{resultWrapper:"CreateQueueResult",type:"structure",members:{QueueUrl:{}}},http:{}},DeleteMessage:{input:{type:"structure",required:["QueueUrl","ReceiptHandle"],members:{QueueUrl:{},ReceiptHandle:{}}},http:{}},DeleteMessageBatch:{input:{type:"structure",required:["QueueUrl","Entries"],members:{QueueUrl:{},Entries:{type:"list",member:{locationName:"DeleteMessageBatchRequestEntry",type:"structure",required:["Id","ReceiptHandle"],members:{Id:{},ReceiptHandle:{}}},flattened:!0}}},output:{resultWrapper:"DeleteMessageBatchResult",type:"structure",required:["Successful","Failed"],members:{Successful:{type:"list",member:{locationName:"DeleteMessageBatchResultEntry",type:"structure",required:["Id"],members:{Id:{}}},flattened:!0},Failed:{shape:"Sd"}}},http:{}},DeleteQueue:{input:{type:"structure",required:["QueueUrl"],members:{QueueUrl:{}}},http:{}},GetQueueAttributes:{input:{type:"structure",required:["QueueUrl"],members:{QueueUrl:{},AttributeNames:{shape:"St"}}},output:{resultWrapper:"GetQueueAttributesResult",type:"structure",members:{Attributes:{shape:"Sh",locationName:"Attribute"}}},http:{}},GetQueueUrl:{input:{type:"structure",required:["QueueName"],members:{QueueName:{},QueueOwnerAWSAccountId:{}}},output:{resultWrapper:"GetQueueUrlResult",type:"structure",members:{QueueUrl:{}}},http:{}},ListDeadLetterSourceQueues:{input:{type:"structure",required:["QueueUrl"],members:{QueueUrl:{}}},output:{resultWrapper:"ListDeadLetterSourceQueuesResult",type:"structure",required:["queueUrls"],members:{queueUrls:{shape:"Sz"}}},http:{}},ListQueues:{input:{type:"structure",members:{QueueNamePrefix:{}}},output:{resultWrapper:"ListQueuesResult",type:"structure",members:{QueueUrls:{shape:"Sz"}}},http:{}},PurgeQueue:{input:{type:"structure",required:["QueueUrl"],members:{QueueUrl:{}}},http:{}},ReceiveMessage:{input:{type:"structure",required:["QueueUrl"],members:{QueueUrl:{},AttributeNames:{shape:"St"},MessageAttributeNames:{type:"list",member:{locationName:"MessageAttributeName"},flattened:!0},MaxNumberOfMessages:{type:"integer"},VisibilityTimeout:{type:"integer"},WaitTimeSeconds:{type:"integer"}}},output:{resultWrapper:"ReceiveMessageResult",type:"structure",members:{Messages:{type:"list",member:{locationName:"Message",type:"structure",members:{MessageId:{},ReceiptHandle:{},MD5OfBody:{},Body:{},Attributes:{shape:"Sh",locationName:"Attribute"},MD5OfMessageAttributes:{},MessageAttributes:{shape:"S19",locationName:"MessageAttribute"}}},flattened:!0}}},http:{}},RemovePermission:{input:{type:"structure",required:["QueueUrl","Label"],members:{QueueUrl:{},Label:{}}},http:{}},SendMessage:{input:{type:"structure",required:["QueueUrl","MessageBody"],members:{QueueUrl:{},MessageBody:{},DelaySeconds:{type:"integer"},MessageAttributes:{shape:"S19",locationName:"MessageAttribute"}}},output:{resultWrapper:"SendMessageResult",type:"structure",members:{MD5OfMessageBody:{},MD5OfMessageAttributes:{},MessageId:{}}},http:{}},SendMessageBatch:{input:{type:"structure",required:["QueueUrl","Entries"],members:{QueueUrl:{},Entries:{type:"list",member:{locationName:"SendMessageBatchRequestEntry",type:"structure",required:["Id","MessageBody"],members:{Id:{},MessageBody:{},DelaySeconds:{type:"integer"},MessageAttributes:{shape:"S19",locationName:"MessageAttribute"}}},flattened:!0}}},output:{resultWrapper:"SendMessageBatchResult",type:"structure",required:["Successful","Failed"],members:{Successful:{type:"list",member:{locationName:"SendMessageBatchResultEntry",type:"structure",required:["Id","MessageId","MD5OfMessageBody"],members:{Id:{},MessageId:{},MD5OfMessageBody:{},MD5OfMessageAttributes:{}}},flattened:!0},Failed:{shape:"Sd"}}},http:{}},SetQueueAttributes:{input:{type:"structure",required:["QueueUrl","Attributes"],members:{QueueUrl:{},Attributes:{shape:"Sh",locationName:"Attribute"}}},http:{}}},shapes:{Sd:{type:"list",member:{locationName:"BatchResultErrorEntry",type:"structure",required:["Id","SenderFault","Code"],members:{Id:{},SenderFault:{type:"boolean"},Code:{},Message:{}}},flattened:!0},Sh:{type:"map",key:{locationName:"Name"},value:{locationName:"Value"},flattened:!0,locationName:"Attribute"},St:{type:"list",member:{locationName:"AttributeName"},flattened:!0},Sz:{type:"list",member:{locationName:"QueueUrl"},flattened:!0},S19:{type:"map",key:{locationName:"Name"},value:{locationName:"Value",type:"structure",required:["DataType"],members:{StringValue:{},BinaryValue:{type:"blob"},StringListValues:{flattened:!0,locationName:"StringListValue",type:"list",member:{locationName:"StringListValue"}},BinaryListValues:{flattened:!0,locationName:"BinaryListValue",type:"list",member:{locationName:"BinaryListValue",type:"blob"}},DataType:{}}},flattened:!0}},paginators:{ListQueues:{result_key:"QueueUrls"}}},i.apiLoader.services.sts={},i.STS=i.Service.defineService("sts",["2011-06-15"]),e("./services/sts"),i.apiLoader.services.sts["2011-06-15"]={version:"2.0",metadata:{apiVersion:"2011-06-15",endpointPrefix:"sts",globalEndpoint:"sts.amazonaws.com",serviceAbbreviation:"AWS STS",serviceFullName:"AWS Security Token Service",signatureVersion:"v4",xmlNamespace:"https://sts.amazonaws.com/doc/2011-06-15/",protocol:"query"},operations:{AssumeRole:{input:{type:"structure",required:["RoleArn","RoleSessionName"],members:{RoleArn:{},RoleSessionName:{},Policy:{},DurationSeconds:{type:"integer"},ExternalId:{},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:"AssumeRoleResult",type:"structure",members:{Credentials:{shape:"Sa"},AssumedRoleUser:{shape:"Sf"},PackedPolicySize:{type:"integer"}}},http:{}},AssumeRoleWithSAML:{input:{type:"structure",required:["RoleArn","PrincipalArn","SAMLAssertion"],members:{RoleArn:{},PrincipalArn:{},SAMLAssertion:{},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"AssumeRoleWithSAMLResult",type:"structure",members:{Credentials:{shape:"Sa"},AssumedRoleUser:{shape:"Sf"},PackedPolicySize:{type:"integer"},Subject:{},SubjectType:{},Issuer:{},Audience:{},NameQualifier:{}}},http:{}},AssumeRoleWithWebIdentity:{input:{type:"structure",required:["RoleArn","RoleSessionName","WebIdentityToken"],members:{RoleArn:{},RoleSessionName:{},WebIdentityToken:{},ProviderId:{},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"AssumeRoleWithWebIdentityResult",type:"structure",members:{Credentials:{shape:"Sa"},SubjectFromWebIdentityToken:{},AssumedRoleUser:{shape:"Sf"},PackedPolicySize:{type:"integer"},Provider:{},Audience:{}}},http:{}},DecodeAuthorizationMessage:{input:{type:"structure",required:["EncodedMessage"],members:{EncodedMessage:{}}},output:{resultWrapper:"DecodeAuthorizationMessageResult",type:"structure",members:{DecodedMessage:{}}},http:{}},GetFederationToken:{input:{type:"structure",required:["Name"],members:{Name:{},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"GetFederationTokenResult",type:"structure",members:{Credentials:{shape:"Sa"},FederatedUser:{type:"structure",required:["FederatedUserId","Arn"],members:{FederatedUserId:{},Arn:{}}},PackedPolicySize:{type:"integer"}}},http:{}},GetSessionToken:{input:{type:"structure",members:{DurationSeconds:{type:"integer"},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:"GetSessionTokenResult",type:"structure",members:{Credentials:{shape:"Sa"}}},http:{}}},shapes:{Sa:{type:"structure",required:["AccessKeyId","SecretAccessKey","SessionToken","Expiration"],members:{AccessKeyId:{},SecretAccessKey:{},SessionToken:{},Expiration:{type:"timestamp"}}},Sf:{type:"structure",required:["AssumedRoleId","Arn"],members:{AssumedRoleId:{},Arn:{}}}}}},{"./core":3,"./http/xhr":12,"./services/cognitoidentity":36,"./services/dynamodb":37,"./services/machinelearning":38,"./services/s3":39,"./services/sqs":40,"./services/sts":41,"./xml/browser_parser":51}],2:[function(e){var t=e("./core");e("./credentials"),e("./credentials/credential_provider_chain"),t.Config=t.util.inherit({constructor:function(e){void 0===e&&(e={}),e=this.extractCredentials(e),t.util.each.call(this,this.keys,function(t,i){this.set(t,e[t],i)})},getCredentials:function(e){function i(t){e(t,t?null:r.credentials)}function n(e,i){return new t.util.error(i||new Error,{code:"CredentialsError",message:e})}var r=this;r.credentials?"function"==typeof r.credentials.get?r.credentials.get(function(e){e&&(e=n("Could not load credentials from "+r.credentials.constructor.name,e)),i(e)}):function(){var e=null;r.credentials.accessKeyId&&r.credentials.secretAccessKey||(e=n("Missing credentials")),i(e)}():r.credentialProvider?r.credentialProvider.resolve(function(e,t){e&&(e=n("Could not load credentials from any providers",e)),r.credentials=t,i(e)}):i(n("No credentials to load"))},update:function(e,i){i=i||!1,e=this.extractCredentials(e),t.util.each.call(this,e,function(e,n){(i||this.keys.hasOwnProperty(e)||t.Service.hasService(e))&&this.set(e,n)})},loadFromPath:function(e){this.clear();var i=JSON.parse(t.util.readFileSync(e)),n=new t.FileSystemCredentials(e),r=new t.CredentialProviderChain;return r.providers.unshift(n),r.resolve(function(e,t){if(e)throw e;i.credentials=t}),this.constructor(i),this},clear:function(){t.util.each.call(this,this.keys,function(e){delete this[e]}),this.set("credentials",void 0),this.set("credentialProvider",void 0)},set:function(e,i,n){void 0===i?(void 0===n&&(n=this.keys[e]),this[e]="function"==typeof n?n.call(this):n):this[e]="httpOptions"===e&&this[e]?t.util.merge(this[e],i):i},keys:{credentials:null,credentialProvider:null,region:null,logger:null,apiVersions:{},apiVersion:null,endpoint:void 0,httpOptions:{timeout:12e4},maxRetries:void 0,maxRedirects:10,paramValidation:!0,sslEnabled:!0,s3ForcePathStyle:!1,s3BucketEndpoint:!1,computeChecksums:!0,convertResponseTypes:!0,dynamoDbCrc32:!0,systemClockOffset:0,signatureVersion:null},extractCredentials:function(e){return e.accessKeyId&&e.secretAccessKey&&(e=t.util.copy(e),e.credentials=new t.Credentials(e)),e}}),t.config=new t.Config},{"./core":3,"./credentials":4,"./credentials/credential_provider_chain":6}],3:[function(e,t){var i={util:e("./util")};({}).toString(),t.exports=i,i.util.update(i,{VERSION:"2.1.32",Signers:{},Protocol:{Json:e("./protocol/json"),Query:e("./protocol/query"),Rest:e("./protocol/rest"),RestJson:e("./protocol/rest_json"),RestXml:e("./protocol/rest_xml")},XML:{Builder:e("./xml/builder"),Parser:null},JSON:{Builder:e("./json/builder"),Parser:e("./json/parser")},Model:{Api:e("./model/api"),Operation:e("./model/operation"),Shape:e("./model/shape"),Paginator:e("./model/paginator"),ResourceWaiter:e("./model/resource_waiter")},util:e("./util"),apiLoader:function(){throw new Error("No API loader set")}}),e("./service"),e("./credentials"),e("./credentials/credential_provider_chain"),e("./credentials/temporary_credentials"),e("./credentials/web_identity_credentials"),e("./credentials/cognito_identity_credentials"),e("./credentials/saml_credentials"),e("./config"),e("./http"),e("./sequential_executor"),e("./event_listeners"),e("./request"),e("./response"),e("./resource_waiter"),e("./signers/request_signer"),e("./param_validator"),i.events=new i.SequentialExecutor},{"./config":2,"./credentials":4,"./credentials/cognito_identity_credentials":5,"./credentials/credential_provider_chain":6,"./credentials/saml_credentials":7,"./credentials/temporary_credentials":8,"./credentials/web_identity_credentials":9,"./event_listeners":10,"./http":11,"./json/builder":13,"./json/parser":14,"./model/api":15,"./model/operation":17,"./model/paginator":18,"./model/resource_waiter":19,"./model/shape":20,"./param_validator":21,"./protocol/json":22,"./protocol/query":23,"./protocol/rest":24,"./protocol/rest_json":25,"./protocol/rest_xml":26,"./request":30,"./resource_waiter":31,"./response":32,"./sequential_executor":34,"./service":35,"./signers/request_signer":43,"./util":50,"./xml/builder":52}],4:[function(e){var t=e("./core");t.Credentials=t.util.inherit({constructor:function(){if(t.util.hideProperties(this,["secretAccessKey"]),this.expired=!1,this.expireTime=null,1===arguments.length&&"object"==typeof arguments[0]){var e=arguments[0].credentials||arguments[0];this.accessKeyId=e.accessKeyId,this.secretAccessKey=e.secretAccessKey,this.sessionToken=e.sessionToken}else this.accessKeyId=arguments[0],this.secretAccessKey=arguments[1],this.sessionToken=arguments[2]},expiryWindow:15,needsRefresh:function(){var e=t.util.date.getDate().getTime(),i=new Date(e+1e3*this.expiryWindow);return!!(this.expireTime&&i>this.expireTime)||(this.expired||!this.accessKeyId||!this.secretAccessKey)},get:function(e){var t=this;this.needsRefresh()?this.refresh(function(i){i||(t.expired=!1),e&&e(i)}):e&&e()},refresh:function(e){this.expired=!1,e()}})},{"./core":3}],5:[function(e){var t=e("../core");t.CognitoIdentityCredentials=t.util.inherit(t.Credentials,{localStorageKey:{id:"aws.cognito.identity-id.",providers:"aws.cognito.identity-providers."},constructor:function(e){t.Credentials.call(this),this.expired=!0,this.params=e,this.data=null,this.identityId=null,this.loadCachedId()},refresh:function(e){var t=this;t.createClients(),t.data=null,t.identityId=null,t.getId(function(i){i?(t.clearCachedId(),e(i)):t.params.RoleArn?t.getCredentialsFromSTS(e):t.getCredentialsForIdentity(e)})},clearCachedId:function(){this.identityId=null,delete this.params.IdentityId;var e=this.params.IdentityPoolId;delete this.storage[this.localStorageKey.id+e],delete this.storage[this.localStorageKey.providers+e]},getId:function(e){var t=this;return"string"==typeof t.params.IdentityId?e(null,t.params.IdentityId):void t.cognito.getId(function(i,n){!i&&n.IdentityId?(t.params.IdentityId=n.IdentityId,e(null,n.IdentityId)):e(i)})},loadCredentials:function(e,t){e&&t&&(t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration)},getCredentialsForIdentity:function(e){var t=this;t.cognito.getCredentialsForIdentity(function(i,n){i?t.clearCachedId():(t.cacheId(n),t.data=n,t.loadCredentials(t.data,t)),e(i)})},getCredentialsFromSTS:function(e){var t=this;t.cognito.getOpenIdToken(function(i,n){i?(t.clearCachedId(),e(i)):(t.cacheId(n),t.params.WebIdentityToken=n.Token,t.webIdentityCredentials.refresh(function(i){i?t.clearCachedId():(t.data=t.webIdentityCredentials.data,t.sts.credentialsFrom(t.data,t)),e(i)}))})},loadCachedId:function(){var e=this;if(t.util.isBrowser()&&!e.params.IdentityId){var i=e.getStorage("id");if(i&&e.params.Logins){var n=Object.keys(e.params.Logins);0!==(e.getStorage("providers")||"").split(",").filter(function(e){return-1!==n.indexOf(e)}).length&&(e.params.IdentityId=i)}else i&&(e.params.IdentityId=i)}},createClients:function(){this.webIdentityCredentials=this.webIdentityCredentials||new t.WebIdentityCredentials(this.params),this.cognito=this.cognito||new t.CognitoIdentity({params:this.params}),this.sts=this.sts||new t.STS},cacheId:function(e){this.identityId=e.IdentityId,this.params.IdentityId=this.identityId,t.util.isBrowser()&&(this.setStorage("id",e.IdentityId),this.params.Logins&&this.setStorage("providers",Object.keys(this.params.Logins).join(",")))},getStorage:function(e){return this.storage[this.localStorageKey[e]+this.params.IdentityPoolId]},setStorage:function(e,t){try{this.storage[this.localStorageKey[e]+this.params.IdentityPoolId]=t}catch(e){}},storage:function(){try{return t.util.isBrowser()&&"object"==typeof window.localStorage?window.localStorage:{}}catch(e){return{}}}()})},{"../core":3}],6:[function(e){var t=e("../core");t.CredentialProviderChain=t.util.inherit(t.Credentials,{constructor:function(e){this.providers=e||t.CredentialProviderChain.defaultProviders.slice(0)},resolve:function(e){function t(r,o){if(!r&&o||i===n.length)e(r,o);else{var s=n[i++];(o="function"==typeof s?s.call():s).get?o.get(function(e){t(e,e?null:o)}):t(null,o)}}if(0===this.providers.length)return e(new Error("No providers")),this;var i=0,n=this.providers.slice(0);return t(),this}}),t.CredentialProviderChain.defaultProviders=[]},{"../core":3}],7:[function(e){var t=e("../core");t.SAMLCredentials=t.util.inherit(t.Credentials,{constructor:function(e){t.Credentials.call(this),this.expired=!0,this.params=e},refresh:function(e){var t=this;t.createClients(),e||(e=function(e){if(e)throw e}),t.service.assumeRoleWithSAML(function(i,n){i||t.service.credentialsFrom(n,t),e(i)})},createClients:function(){this.service=this.service||new t.STS({params:this.params})}})},{"../core":3}],8:[function(e){var t=e("../core");t.TemporaryCredentials=t.util.inherit(t.Credentials,{constructor:function(e){t.Credentials.call(this),this.loadMasterCredentials(),this.expired=!0,this.params=e||{},this.params.RoleArn&&(this.params.RoleSessionName=this.params.RoleSessionName||"temporary-credentials")},refresh:function(e){var t=this;t.createClients(),e||(e=function(e){if(e)throw e}),t.service.config.credentials=t.masterCredentials,(t.params.RoleArn?t.service.assumeRole:t.service.getSessionToken).call(t.service,function(i,n){i||t.service.credentialsFrom(n,t),e(i)})},loadMasterCredentials:function(){for(this.masterCredentials=t.config.credentials;this.masterCredentials.masterCredentials;)this.masterCredentials=this.masterCredentials.masterCredentials},createClients:function(){this.service=this.service||new t.STS({params:this.params})}})},{"../core":3}],9:[function(e){var t=e("../core");t.WebIdentityCredentials=t.util.inherit(t.Credentials,{constructor:function(e){t.Credentials.call(this),this.expired=!0,this.params=e,this.params.RoleSessionName=this.params.RoleSessionName||"web-identity",this.data=null},refresh:function(e){var t=this;t.createClients(),e||(e=function(e){if(e)throw e}),t.service.assumeRoleWithWebIdentity(function(i,n){t.data=null,i||(t.data=n,t.service.credentialsFrom(n,t)),e(i)})},createClients:function(){this.service=this.service||new t.STS({params:this.params})}})},{"../core":3}],10:[function(e){var t=e("./core"),i=e("./sequential_executor");t.EventListeners={Core:{}},t.EventListeners={Core:(new i).addNamedListeners(function(e,i){i("VALIDATE_CREDENTIALS","validate",function(e,i){return e.service.api.signatureVersion?void e.service.config.getCredentials(function(n){n&&(e.response.error=t.util.error(n,{code:"CredentialsError",message:"Missing credentials in config"})),i()}):i()}),e("VALIDATE_REGION","validate",function(e){e.service.config.region||e.service.isGlobalEndpoint||(e.response.error=t.util.error(new Error,{code:"ConfigError",message:"Missing region in config"}))}),e("VALIDATE_PARAMETERS","validate",function(e){var i=e.service.api.operations[e.operation].input;(new t.ParamValidator).validate(i,e.params)}),i("COMPUTE_SHA256","afterBuild",function(e,i){if(!e.service.api.signatureVersion)return i();if(e.service.getSignerClass(e)===t.Signers.V4){var n=e.httpRequest.body||"";t.util.computeSha256(n,function(t,n){t?i(t):(e.httpRequest.headers["X-Amz-Content-Sha256"]=n,i())})}else i()}),e("SET_CONTENT_LENGTH","afterBuild",function(e){if(void 0===e.httpRequest.headers["Content-Length"]){var i=t.util.string.byteLength(e.httpRequest.body);e.httpRequest.headers["Content-Length"]=i}}),e("SET_HTTP_HOST","afterBuild",function(e){e.httpRequest.headers.Host=e.httpRequest.endpoint.host}),e("RESTART","restart",function(){var e=this.response.error;e&&e.retryable&&(this.response.retryCount<this.service.config.maxRetries?this.response.retryCount++:this.response.error=null)}),i("SIGN","sign",function(e,i){return e.service.api.signatureVersion?void e.service.config.getCredentials(function(n,r){if(n)return e.response.error=n,i();try{var o=t.util.date.getDate(),s=new(e.service.getSignerClass(e))(e.httpRequest,e.service.api.signingName||e.service.api.endpointPrefix);delete e.httpRequest.headers.Authorization,delete e.httpRequest.headers.Date,delete e.httpRequest.headers["X-Amz-Date"],s.addAuthorization(r,o),e.signedAt=o}catch(t){e.response.error=t}i()}):i()}),e("VALIDATE_RESPONSE","validateResponse",function(e){this.service.successfulResponse(e,this)?(e.data={},e.error=null):(e.data=null,e.error=t.util.error(new Error,{code:"UnknownError",message:"An unknown error occurred."}))}),i("SEND","send",function(e,i){function n(n){e.httpResponse.stream=n,n.on("headers",function(i,r){e.request.emit("httpHeaders",[i,r,e]),e.httpResponse.streaming||(2===t.HttpClient.streamsApiVersion?n.on("readable",function(){var t=n.read();null!==t&&e.request.emit("httpData",[t,e])}):n.on("data",function(t){e.request.emit("httpData",[t,e])}))}),n.on("end",function(){e.request.emit("httpDone"),i()})}function r(t){t.on("sendProgress",function(t){e.request.emit("httpUploadProgress",[t,e])}),t.on("receiveProgress",function(t){e.request.emit("httpDownloadProgress",[t,e])})}function o(n){e.error=t.util.error(n,{code:"NetworkingError",region:e.request.httpRequest.region,hostname:e.request.httpRequest.endpoint.hostname,retryable:!0}),e.request.emit("httpError",[e.error,e],function(){i()})}function s(){var i=t.HttpClient.getInstance(),s=e.request.service.config.httpOptions||{};try{r(i.handleRequest(e.request.httpRequest,s,n,o))}catch(e){o(e)}}e.httpResponse._abortCallback=i,e.error=null,e.data=null,(t.util.date.getDate()-this.signedAt)/1e3>=600?this.emit("sign",[this],function(e){e?i(e):s()}):s()}),e("HTTP_HEADERS","httpHeaders",function(e,i,n){n.httpResponse.statusCode=e,n.httpResponse.headers=i,n.httpResponse.body=new t.util.Buffer(""),n.httpResponse.buffers=[],n.httpResponse.numBytes=0}),e("HTTP_DATA","httpData",function(e,i){if(e){if(t.util.isNode()){i.httpResponse.numBytes+=e.length;var n=i.httpResponse.headers["content-length"],r={loaded:i.httpResponse.numBytes,total:n};i.request.emit("httpDownloadProgress",[r,i])}i.httpResponse.buffers.push(new t.util.Buffer(e))}}),e("HTTP_DONE","httpDone",function(e){if(e.httpResponse.buffers&&e.httpResponse.buffers.length>0){var i=t.util.buffer.concat(e.httpResponse.buffers);e.httpResponse.body=i}delete e.httpResponse.numBytes,delete e.httpResponse.buffers}),e("FINALIZE_ERROR","retry",function(e){e.httpResponse.statusCode&&(e.error.statusCode=e.httpResponse.statusCode,void 0===e.error.retryable&&(e.error.retryable=this.service.retryableError(e.error,this)))}),e("INVALIDATE_CREDENTIALS","retry",function(e){if(e.error)switch(e.error.code){case"RequestExpired":case"ExpiredTokenException":case"ExpiredToken":e.error.retryable=!0,e.request.service.config.credentials.expired=!0}}),e("EXPIRED_SIGNATURE","retry",function(e){var t=e.error;t&&"string"==typeof t.code&&"string"==typeof t.message&&t.code.match(/Signature/)&&t.message.match(/expired/)&&(e.error.retryable=!0)}),e("REDIRECT","retry",function(e){e.error&&e.error.statusCode>=300&&e.error.statusCode<400&&e.httpResponse.headers.location&&(this.httpRequest.endpoint=new t.Endpoint(e.httpResponse.headers.location),this.httpRequest.headers.Host=this.httpRequest.endpoint.host,e.error.redirect=!0,e.error.retryable=!0)}),e("RETRY_CHECK","retry",function(e){if(e.error)if(e.error.redirect&&e.redirectCount<e.maxRedirects)e.error.retryDelay=0;else if(e.retryCount<e.maxRetries){var t=this.service.retryDelays();e.error.retryDelay=t[e.retryCount]||0}}),i("RESET_RETRY_STATE","afterRetry",function(e,t){var i,n=!1;e.error&&(i=e.error.retryDelay||0,e.error.retryable&&e.retryCount<e.maxRetries?(e.retryCount++,n=!0):e.error.redirect&&e.redirectCount<e.maxRedirects&&(e.redirectCount++,n=!0)),n?(e.error=null,setTimeout(t,i)):t()})}),CorePost:(new i).addNamedListeners(function(e){e("EXTRACT_REQUEST_ID","extractData",function(e){e.requestId||(e.requestId=e.httpResponse.headers["x-amz-request-id"]||e.httpResponse.headers["x-amzn-requestid"]),!e.requestId&&e.data&&e.data.ResponseMetadata&&(e.requestId=e.data.ResponseMetadata.RequestId)}),e("ENOTFOUND_ERROR","httpError",function(e){if("NetworkingError"===e.code&&"ENOTFOUND"===e.errno){var i="Inaccessible host: `"+e.hostname+"'. This service may not be available in the `"+e.region+"' region.";this.response.error=t.util.error(new Error(i),{code:"UnknownEndpoint",region:e.region,hostname:e.hostname,retryable:!0,originalError:e})}})}),Logger:(new i).addNamedListeners(function(i){i("LOG_REQUEST","complete",function(i){var n=i.request,r=n.service.config.logger;if(r){var o=function(){var o=(t.util.date.getDate().getTime()-n.startTime.getTime())/1e3,s=!!r.isTTY,a=i.httpResponse.statusCode,c=e("util").inspect(n.params,!0,null),l="";return s&&(l+="[33m"),l+="[AWS "+n.service.serviceIdentifier+" "+a,l+=" "+o.toString()+"s "+i.retryCount+" retries]",s&&(l+="[0;1m"),l+=" "+t.util.string.lowerFirst(n.operation),l+="("+c+")",s&&(l+="[0m"),l}();"function"==typeof r.log?r.log(o):"function"==typeof r.write&&r.write(o+"\n")}})}),Json:(new i).addNamedListeners(function(t){var i=e("./protocol/json");t("BUILD","build",i.buildRequest),t("EXTRACT_DATA","extractData",i.extractData),t("EXTRACT_ERROR","extractError",i.extractError)}),Rest:(new i).addNamedListeners(function(t){var i=e("./protocol/rest");t("BUILD","build",i.buildRequest),t("EXTRACT_DATA","extractData",i.extractData),t("EXTRACT_ERROR","extractError",i.extractError)}),RestJson:(new i).addNamedListeners(function(t){var i=e("./protocol/rest_json");t("BUILD","build",i.buildRequest),t("EXTRACT_DATA","extractData",i.extractData),t("EXTRACT_ERROR","extractError",i.extractError)}),RestXml:(new i).addNamedListeners(function(t){var i=e("./protocol/rest_xml");t("BUILD","build",i.buildRequest),t("EXTRACT_DATA","extractData",i.extractData),t("EXTRACT_ERROR","extractError",i.extractError)}),Query:(new i).addNamedListeners(function(t){var i=e("./protocol/query");t("BUILD","build",i.buildRequest),t("EXTRACT_DATA","extractData",i.extractData),t("EXTRACT_ERROR","extractError",i.extractError)})}},{"./core":3,"./protocol/json":22,"./protocol/query":23,"./protocol/rest":24,"./protocol/rest_json":25,"./protocol/rest_xml":26,"./sequential_executor":34,util:71}],11:[function(e){var t=e("./core"),i=t.util.inherit;t.Endpoint=i({constructor:function(e,i){if(t.util.hideProperties(this,["slashes","auth","hash","search","query"]),void 0===e||null===e)throw new Error("Invalid endpoint: "+e);if("string"!=typeof e)return t.util.copy(e);e.match(/^http/)||(e=((i&&void 0!==i.sslEnabled?i.sslEnabled:t.config.sslEnabled)?"https":"http")+"://"+e),t.util.update(this,t.util.urlParse(e)),this.port=this.port?parseInt(this.port,10):"https:"===this.protocol?443:80}}),t.HttpRequest=i({constructor:function(e,i){e=new t.Endpoint(e),this.method="POST",this.path=e.path||"/",this.headers={},this.body="",this.endpoint=e,this.region=i,this.setUserAgent()},setUserAgent:function(){var e=t.util.isBrowser()?"X-Amz-":"";this.headers[e+"User-Agent"]=t.util.userAgent()},pathname:function(){return this.path.split("?",1)[0]},search:function(){var e=this.path.split("?",2)[1];return e?(e=t.util.queryStringParse(e),t.util.queryParamsToString(e)):""}}),t.HttpResponse=i({constructor:function(){this.statusCode=void 0,this.headers={},this.body=void 0,this.streaming=!1,this.stream=null},createUnbufferedStream:function(){return this.streaming=!0,this.stream}}),t.HttpClient=i({}),t.HttpClient.getInstance=function(){return void 0===this.singleton&&(this.singleton=new this),this.singleton}},{"./core":3}],12:[function(e){var t=e("../core"),i=e("events").EventEmitter;e("../http"),t.XHRClient=t.util.inherit({handleRequest:function(e,n,r,o){var s=this,a=e.endpoint,c=new i,l=a.protocol+"//"+a.hostname;80!==a.port&&443!==a.port&&(l+=":"+a.port),l+=e.path;var u=new XMLHttpRequest,h=!1;e.stream=u,u.addEventListener("readystatechange",function(){try{if(0===u.status)return}catch(e){return}if(this.readyState>=this.HEADERS_RECEIVED&&!h){try{u.responseType="arraybuffer"}catch(e){}c.statusCode=u.status,c.headers=s.parseHeaders(u.getAllResponseHeaders()),c.emit("headers",c.statusCode,c.headers),h=!0}this.readyState===this.DONE&&s.finishRequest(u,c)},!1),u.upload.addEventListener("progress",function(e){c.emit("sendProgress",e)}),u.addEventListener("progress",function(e){c.emit("receiveProgress",e)},!1),u.addEventListener("timeout",function(){o(t.util.error(new Error("Timeout"),{code:"TimeoutError"}))},!1),u.addEventListener("error",function(){o(t.util.error(new Error("Network Failure"),{code:"NetworkingError"}))},!1),r(c),u.open(e.method,l,!1!==n.xhrAsync),t.util.each(e.headers,function(e,t){"Content-Length"!==e&&"User-Agent"!==e&&"Host"!==e&&u.setRequestHeader(e,t)}),n.timeout&&!1!==n.xhrAsync&&(u.timeout=n.timeout),n.xhrWithCredentials&&(u.withCredentials=!0);try{u.send(e.body)}catch(t){if(!e.body||"object"!=typeof e.body.buffer)throw t;u.send(e.body.buffer)}return c},parseHeaders:function(e){var i={};return t.util.arrayEach(e.split(/\r?\n/),function(e){var t=e.split(":",1)[0],n=e.substring(t.length+2);t.length>0&&(i[t]=n)}),i},finishRequest:function(e,i){var n;if("arraybuffer"===e.responseType&&e.response){var r=e.response;n=new t.util.Buffer(r.byteLength);for(var o=new Uint8Array(r),s=0;s<n.length;++s)n[s]=o[s]}try{n||"string"!=typeof e.responseText||(n=new t.util.Buffer(e.responseText))}catch(e){}n&&i.emit("data",n),i.emit("end")}}),t.HttpClient.prototype=t.XHRClient.prototype,t.HttpClient.streamsApiVersion=1},{"../core":3,"../http":11,events:62}],13:[function(e,t){function i(){}function n(e,t){if(t&&void 0!==e&&null!==e)switch(t.type){case"structure":return r(e,t);case"map":return s(e,t);case"list":return o(e,t);default:return a(e,t)}}function r(e,t){var i={};return c.each(e,function(e,r){var o=t.members[e];if(o){if("body"!==o.location)return;var s=n(r,o);void 0!==s&&(i[e]=s)}}),i}function o(e,t){var i=[];return c.arrayEach(e,function(e){var r=n(e,t.member);void 0!==r&&i.push(r)}),i}function s(e,t){var i={};return c.each(e,function(e,r){var o=n(r,t.value);void 0!==o&&(i[e]=o)}),i}function a(e,t){return t.toWireFormat(e)}var c=e("../util");i.prototype.build=function(e,t){return JSON.stringify(n(e,t))},t.exports=i},{"../util":50}],14:[function(e,t){function i(){}function n(e,t){if(t&&void 0!==e&&null!==e)switch(t.type){case"structure":return r(e,t);case"map":return s(e,t);case"list":return o(e,t);default:return a(e,t)}}function r(e,t){var i={};return c.each(e,function(e,r){var o=t.members[e];if(o){var s=n(r,o);void 0!==s&&(i[e]=s)}}),i}function o(e,t){var i=[];return c.arrayEach(e,function(e){var r=n(e,t.member);void 0!==r&&i.push(r)}),i}function s(e,t){var i={};return c.each(e,function(e,r){var o=n(r,t.value);void 0!==o&&(i[e]=o)}),i}function a(e,t){return t.toType(e)}var c=e("../util");i.prototype.parse=function(e,t){return n(JSON.parse(e),t)},t.exports=i},{"../util":50}],15:[function(e,t){var i=e("./collection"),n=e("./operation"),r=e("./shape"),o=e("./paginator"),s=e("./resource_waiter"),a=e("../util"),c=a.property,l=a.memoizedProperty;t.exports=function(e,t){e=e||{},(t=t||{}).api=this,e.metadata=e.metadata||{},c(this,"isApi",!0,!1),c(this,"apiVersion",e.metadata.apiVersion),c(this,"endpointPrefix",e.metadata.endpointPrefix),c(this,"signingName",e.metadata.signingName),c(this,"globalEndpoint",e.metadata.globalEndpoint),c(this,"signatureVersion",e.metadata.signatureVersion),c(this,"jsonVersion",e.metadata.jsonVersion),c(this,"targetPrefix",e.metadata.targetPrefix),c(this,"protocol",e.metadata.protocol),c(this,"timestampFormat",e.metadata.timestampFormat),c(this,"xmlNamespaceUri",e.metadata.xmlNamespace),c(this,"abbreviation",e.metadata.serviceAbbreviation),c(this,"fullName",e.metadata.serviceFullName),l(this,"className",function(){var t=e.metadata.serviceAbbreviation||e.metadata.serviceFullName;return t?("ElasticLoadBalancing"===(t=t.replace(/^Amazon|AWS\s*|\(.*|\s+|\W+/g,""))&&(t="ELB"),t):null}),c(this,"operations",new i(e.operations,t,function(e,i){return new n(e,i,t)},a.string.lowerFirst)),c(this,"shapes",new i(e.shapes,t,function(e,i){return r.create(i,t)})),c(this,"paginators",new i(e.paginators,t,function(e,i){return new o(e,i,t)})),c(this,"waiters",new i(e.waiters,t,function(e,i){return new s(e,i,t)},a.string.lowerFirst)),t.documentation&&(c(this,"documentation",e.documentation),c(this,"documentationUrl",e.documentationUrl))}},{"../util":50,"./collection":16,"./operation":17,"./paginator":18,"./resource_waiter":19,"./shape":20}],16:[function(e,t){function i(e,t,i,r){n(this,r(e),function(){return i(e,t)})}var n=e("../util").memoizedProperty;t.exports=function(e,t,n,r){r=r||String;var o=this;for(var s in e)e.hasOwnProperty(s)&&i.call(o,s,e[s],n,r)}},{"../util":50}],17:[function(e,t){var i=e("./shape"),n=e("../util"),r=n.property,o=n.memoizedProperty;t.exports=function(e,t,n){n=n||{},r(this,"name",t.name||e),r(this,"api",n.api,!1),t.http=t.http||{},r(this,"httpMethod",t.http.method||"POST"),r(this,"httpPath",t.http.requestUri||"/"),o(this,"input",function(){return t.input?i.create(t.input,n):new i.create({type:"structure"},n)}),o(this,"output",function(){return t.output?i.create(t.output,n):new i.create({type:"structure"},n)}),o(this,"errors",function(){var e=[];if(!t.errors)return null;for(var r=0;r<t.errors.length;r++)e.push(i.create(t.errors[r],n));return e}),o(this,"paginator",function(){return n.api.paginators[e]}),n.documentation&&(r(this,"documentation",t.documentation),r(this,"documentationUrl",t.documentationUrl))}},{"../util":50,"./shape":20}],18:[function(e,t){var i=e("../util").property;t.exports=function(e,t){i(this,"inputToken",t.input_token),i(this,"limitKey",t.limit_key),i(this,"moreResults",t.more_results),i(this,"outputToken",t.output_token),i(this,"resultKey",t.result_key)}},{"../util":50}],19:[function(e,t){var i=e("../util"),n=i.property;t.exports=function(e,t,r){function o(){n(this,"name",e),n(this,"api",r.api,!1),t.operation&&n(this,"operation",i.string.lowerFirst(t.operation));var o=this,s={ignoreErrors:"ignore_errors",successType:"success_type",successValue:"success_value",successPath:"success_path",acceptorType:"acceptor_type",acceptorValue:"acceptor_value",acceptorPath:"acceptor_path",failureType:"failure_type",failureValue:"failure_value",failurePath:"success_path",interval:"interval",maxAttempts:"max_attempts"};Object.keys(s).forEach(function(e){var i=t[s[e]];i&&n(o,e,i)})}if((r=r||{}).api){var s=null;t.extends?s=r.api.waiters[t.extends]:"__default__"!==e&&(s=r.api.waiters.__default__),s&&(o.prototype=s)}return new o}},{"../util":50}],20:[function(e,t){function i(e,t,i){null!==i&&void 0!==i&&_.property.apply(this,arguments)}function n(e,t){e.constructor.prototype[t]||_.memoizedProperty.apply(this,arguments)}function r(e,t,n){t=t||{},i(this,"shape",e.shape),i(this,"api",t.api,!1),i(this,"type",e.type),i(this,"location",e.location||this.location||"body"),i(this,"name",this.name||e.xmlName||e.queryName||e.locationName||n),i(this,"isStreaming",e.streaming||this.isStreaming||!1),i(this,"isComposite",e.isComposite||!1),i(this,"isShape",!0,!1),i(this,"isQueryName",!!e.queryName,!1),i(this,"isLocationName",!!e.locationName,!1),t.documentation&&(i(this,"documentation",e.documentation),i(this,"documentationUrl",e.documentationUrl)),e.xmlAttribute&&i(this,"isXmlAttribute",e.xmlAttribute||!1),i(this,"defaultValue",null),this.toWireFormat=function(e){return null===e||void 0===e?"":e},this.toType=function(e){return e}}function o(e){r.apply(this,arguments),i(this,"isComposite",!0),e.flattened&&i(this,"flattened",e.flattened||!1)}function s(e,t){var s=null,a=!this.isShape;o.apply(this,arguments),a&&(i(this,"defaultValue",function(){return{}}),i(this,"members",{}),i(this,"memberNames",[]),i(this,"required",[]),i(this,"isRequired",function(){return!1})),e.members&&(i(this,"members",new p(e.members,t,function(e,i){return r.create(i,t,e)})),n(this,"memberNames",function(){return e.xmlOrder||Object.keys(e.members)})),e.required&&(i(this,"required",e.required),i(this,"isRequired",function(t){if(!s){s={};for(var i=0;i<e.required.length;i++)s[e.required[i]]=!0}return s[t]},!1,!0)),i(this,"resultWrapper",e.resultWrapper||null),e.payload&&i(this,"payload",e.payload),"string"==typeof e.xmlNamespace?i(this,"xmlNamespaceUri",e.xmlNamespace):"object"==typeof e.xmlNamespace&&(i(this,"xmlNamespacePrefix",e.xmlNamespace.prefix),i(this,"xmlNamespaceUri",e.xmlNamespace.uri))}function a(e,t){var s=this,a=!this.isShape;if(o.apply(this,arguments),a&&i(this,"defaultValue",function(){return[]}),e.member&&n(this,"member",function(){return r.create(e.member,t)}),this.flattened){var c=this.name;n(this,"name",function(){return s.member.name||c})}}function c(e,t){var s=!this.isShape;o.apply(this,arguments),s&&(i(this,"defaultValue",function(){return{}}),i(this,"key",r.create({type:"string"},t)),i(this,"value",r.create({type:"string"},t))),e.key&&n(this,"key",function(){return r.create(e.key,t)}),e.value&&n(this,"value",function(){return r.create(e.value,t)})}function l(){if(r.apply(this,arguments),this.api)switch(this.api.protocol){case"rest-xml":case"query":case"ec2":this.toType=function(e){return e||""}}}function u(){r.apply(this,arguments),this.toType=_.base64.decode,this.toWireFormat=_.base64.encode}function h(){u.apply(this,arguments)}function d(){r.apply(this,arguments),this.toType=function(e){return"boolean"==typeof e?e:null===e||void 0===e?null:"true"===e}}var p=e("./collection"),_=e("../util");r.normalizedTypes={character:"string",double:"float",long:"integer",short:"integer",biginteger:"integer",bigdecimal:"float",blob:"binary"},r.types={structure:s,list:a,map:c,boolean:d,timestamp:function(e){var t=this;if(r.apply(this,arguments),"header"===this.location)i(this,"timestampFormat","rfc822");else if(e.timestampFormat)i(this,"timestampFormat",e.timestampFormat);else if(this.api)if(this.api.timestampFormat)i(this,"timestampFormat",this.api.timestampFormat);else switch(this.api.protocol){case"json":case"rest-json":i(this,"timestampFormat","unixTimestamp");break;case"rest-xml":case"query":case"ec2":i(this,"timestampFormat","iso8601")}this.toType=function(e){return null===e||void 0===e?null:"function"==typeof e.toUTCString?e:"string"==typeof e||"number"==typeof e?_.date.parseTimestamp(e):null},this.toWireFormat=function(e){return _.date.format(e,t.timestampFormat)}},float:function(){r.apply(this,arguments),this.toType=function(e){return null===e||void 0===e?null:parseFloat(e)},this.toWireFormat=this.toType},integer:function(){r.apply(this,arguments),this.toType=function(e){return null===e||void 0===e?null:parseInt(e,10)},this.toWireFormat=this.toType},string:l,base64:h,binary:u},r.resolve=function(e,t){if(e.shape){var i=t.api.shapes[e.shape];if(!i)throw new Error("Cannot find shape reference: "+e.shape);return i}return null},r.create=function(e,t,i){if(e.isShape)return e;var n=r.resolve(e,t);if(n){var o=Object.keys(e);if(t.documentation||(o=o.filter(function(e){return!e.match(/documentation/)})),o===["shape"])return n;var s=function(){n.constructor.call(this,e,t,i)};return s.prototype=n,new s}e.type||(e.type=e.members?"structure":e.member?"list":e.key?"map":"string");var a=e.type;if(r.normalizedTypes[e.type]&&(e.type=r.normalizedTypes[e.type]),r.types[e.type])return new r.types[e.type](e,t,i);throw new Error("Unrecognized shape type: "+a)},r.shapes={StructureShape:s,ListShape:a,MapShape:c,StringShape:l,BooleanShape:d,Base64Shape:h},t.exports=r},{"../util":50,"./collection":16}],21:[function(e){var t=e("./core");t.ParamValidator=t.util.inherit({validate:function(e,i,n){if(this.errors=[],this.validateMember(e,i||{},n||"params"),!(this.errors.length>1)){if(1===this.errors.length)throw this.errors[0];return!0}var r=this.errors.join("\n* ");if(this.errors.length>1)throw r="There were "+this.errors.length+" validation errors:\n* "+r,t.util.error(new Error(r),{code:"MultipleValidationErrors",errors:this.errors})},validateStructure:function(e,t,i){this.validateType(i,t,["object"],"structure");for(var n,r=0;e.required&&r<e.required.length;r++){var o=t[n=e.required[r]];(void 0===o||null===o)&&this.fail("MissingRequiredParameter","Missing required key '"+n+"' in "+i)}for(n in t)if(t.hasOwnProperty(n)){var s=t[n],a=e.members[n];if(void 0!==a){var c=[i,n].join(".");this.validateMember(a,s,c)}else this.fail("UnexpectedParameter","Unexpected key '"+n+"' found in "+i)}return!0},validateMember:function(e,t,i){switch(e.type){case"structure":return this.validateStructure(e,t,i);case"list":return this.validateList(e,t,i);case"map":return this.validateMap(e,t,i);default:return this.validateScalar(e,t,i)}},validateList:function(e,t,i){this.validateType(i,t,[Array]);for(var n=0;n<t.length;n++)this.validateMember(e.member,t[n],i+"["+n+"]")},validateMap:function(e,t,i){this.validateType(i,t,["object"],"map");for(var n in t)t.hasOwnProperty(n)&&this.validateMember(e.value,t[n],i+"['"+n+"']")},validateScalar:function(e,t,i){switch(e.type){case null:case void 0:case"string":return this.validateType(i,t,["string"]);case"base64":case"binary":return this.validatePayload(i,t);case"integer":case"float":return this.validateNumber(i,t);case"boolean":return this.validateType(i,t,["boolean"]);case"timestamp":return this.validateType(i,t,[Date,/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?Z$/,"number"],"Date object, ISO-8601 string, or a UNIX timestamp");default:return this.fail("UnkownType","Unhandled type "+e.type+" for "+i)}},fail:function(e,i){this.errors.push(t.util.error(new Error(i),{code:e}))},validateType:function(e,i,n,r){if(null!==i&&void 0!==i){for(var o=!1,s=0;s<n.length;s++){if("string"==typeof n[s]){if(typeof i===n[s])return}else if(n[s]instanceof RegExp){if((i||"").toString().match(n[s]))return}else{if(i instanceof n[s])return;if(t.util.isType(i,n[s]))return;r||o||(n=n.slice()),n[s]=t.util.typeName(n[s])}o=!0}var a=r;a||(a=n.join(", ").replace(/,([^,]+)$/,", or$1"));var c=a.match(/^[aeiou]/i)?"n":"";this.fail("InvalidParameterType","Expected "+e+" to be a"+c+" "+a)}},validateNumber:function(e,t){if(null!==t&&void 0!==t){if("string"==typeof t){var i=parseFloat(t);i.toString()===t&&(t=i)}this.validateType(e,t,["number"])}},validatePayload:function(e,i){if(null!==i&&void 0!==i&&"string"!=typeof i&&(!i||"number"!=typeof i.byteLength)){if(t.util.isNode()){var n=t.util.nodeRequire("stream").Stream;if(t.util.Buffer.isBuffer(i)||i instanceof n)return}var r=["Buffer","Stream","File","Blob","ArrayBuffer","DataView"];if(i)for(var o=0;o<r.length;o++){if(t.util.isType(i,r[o]))return;if(t.util.typeName(i.constructor)===r[o])return}this.fail("InvalidParameterType","Expected "+e+" to be a string, Buffer, Stream, Blob, or typed array object")}}})},{"./core":3}],22:[function(e,t){var i=e("../util"),n=e("../json/builder"),r=e("../json/parser");t.exports={buildRequest:function(e){var t=e.httpRequest,i=e.service.api,r=i.targetPrefix+"."+i.operations[e.operation].name,o=i.jsonVersion||"1.0",s=i.operations[e.operation].input,a=new n;1===o&&(o="1.0"),t.body=a.build(e.params||{},s),t.headers["Content-Type"]="application/x-amz-json-"+o,t.headers["X-Amz-Target"]=r},extractError:function(e){var t={},n=e.httpResponse;if(t.code=n.headers["x-amzn-errortype"]||"UnknownError","string"==typeof t.code&&(t.code=t.code.split(":")[0]),n.body.length>0){var r=JSON.parse(n.body.toString());(r.__type||r.code)&&(t.code=(r.__type||r.code).split("#").pop()),t.message="RequestEntityTooLarge"===t.code?"Request body must be less than 1 MB":r.message||r.Message||null}else t.statusCode=n.statusCode,t.message=n.statusCode.toString();e.error=i.error(new Error,t)},extractData:function(e){var t=e.httpResponse.body.toString()||"{}";if(!1===e.request.service.config.convertResponseTypes)e.data=JSON.parse(t);else{var i=e.request.service.api.operations[e.request.operation].output||{},n=new r;e.data=n.parse(t,i)}}}},{"../json/builder":13,"../json/parser":14,"../util":50}],23:[function(e,t){var i=e("../core"),n=e("../util"),r=e("../query/query_param_serializer"),o=e("../model/shape");t.exports={buildRequest:function(e){var t=e.service.api.operations[e.operation],i=e.httpRequest;i.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",i.params={Version:e.service.api.apiVersion,Action:t.name},(new r).serialize(e.params,t.input,function(e,t){i.params[e]=t}),i.body=n.queryParamsToString(i.params)},extractError:function(e){var t,r=e.httpResponse.body.toString();(t=r.match("<UnknownOperationException")?{Code:"UnknownOperation",Message:"Unknown operation "+e.request.operation}:(new i.XML.Parser).parse(r)).requestId&&!e.requestId&&(e.requestId=t.requestId),t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),e.error=t.Code?n.error(new Error,{code:t.Code,message:t.Message}):n.error(new Error,{code:e.httpResponse.statusCode,message:null})},extractData:function(e){var t=e.request,r=t.service.api.operations[t.operation].output||{},s=r;if(s.resultWrapper){var a=o.create({type:"structure"});a.members[s.resultWrapper]=r,a.memberNames=[s.resultWrapper],n.property(r,"name",r.resultWrapper),r=a}var c=new i.XML.Parser;if(r&&r.members&&!r.members._XAMZRequestId){var l=o.create({type:"string"},{api:{protocol:"query"}},"requestId");r.members._XAMZRequestId=l}var u=c.parse(e.httpResponse.body.toString(),r);e.requestId=u._XAMZRequestId||u.requestId,u._XAMZRequestId&&delete u._XAMZRequestId,s.resultWrapper&&u[s.resultWrapper]&&(n.update(u,u[s.resultWrapper]),delete u[s.resultWrapper]),e.data=u}}},{"../core":3,"../model/shape":20,"../query/query_param_serializer":27,"../util":50}],24:[function(e,t){function i(e){e.httpRequest.method=e.service.api.operations[e.operation].httpMethod}function n(e){var t=e.service.api.operations[e.operation],i=t.input,n=[e.httpRequest.endpoint.path,t.httpPath].join("/");n=n.replace(/\/+/g,"/");var r={},s=!1;if(o.each(i.members,function(t,i){var a=e.params[t];if(null!==a&&void 0!==a)if("uri"===i.location){var c=new RegExp("\\{"+i.name+"(\\+)?\\}");n=n.replace(c,function(e,t){return(t?o.uriEscapePath:o.uriEscape)(String(a))})}else"querystring"===i.location&&(s=!0,r[i.name]="list"===i.type?a.map(function(e){return o.uriEscape(String(e))}):o.uriEscape(String(a)))}),s){n+=n.indexOf("?")>=0?"&":"?";var a=[];o.arrayEach(Object.keys(r).sort(),function(e){Array.isArray(r[e])||(r[e]=[r[e]]);for(var t=0;t<r[e].length;t++)a.push(o.uriEscape(String(e))+"="+r[e][t])}),n+=a.join("&")}e.httpRequest.path=n}function r(e){var t=e.service.api.operations[e.operation];o.each(t.input.members,function(t,i){var n=e.params[t];null!==n&&void 0!==n&&("headers"===i.location&&"map"===i.type?o.each(n,function(t,n){e.httpRequest.headers[i.name+t]=n}):"header"===i.location&&(n=i.toWireFormat(n).toString(),e.httpRequest.headers[i.name]=n))})}var o=e("../util");t.exports={buildRequest:function(e){i(e),n(e),r(e)},extractError:function(){},extractData:function(e){var t=e.request,i={},n=e.httpResponse,r=t.service.api.operations[t.operation].output,s={};o.each(n.headers,function(e,t){s[e.toLowerCase()]=t}),o.each(r.members,function(e,t){var r=(t.name||e).toLowerCase();if("headers"===t.location&&"map"===t.type){i[e]={};var a=t.isLocationName?t.name:"",c=new RegExp("^"+a+"(.+)","i");o.each(n.headers,function(t,n){var r=t.match(c);null!==r&&(i[e][r[1]]=n)})}else"header"===t.location?void 0!==s[r]&&(i[e]=s[r]):"statusCode"===t.location&&(i[e]=parseInt(n.statusCode,10))}),e.data=i}}},{"../util":50}],25:[function(e,t){function i(e){var t=new s,i=e.service.api.operations[e.operation].input;if(i.payload){var n={},r=i.members[i.payload];if(void 0===(n=e.params[i.payload]))return;e.httpRequest.body="structure"===r.type?t.build(n,r):n}else e.httpRequest.body=t.build(e.params,i)}var n=e("../util"),r=e("./rest"),o=e("./json"),s=e("../json/builder"),a=e("../json/parser");t.exports={buildRequest:function(e){r.buildRequest(e),["GET","HEAD"].indexOf(e.httpRequest.method)<0&&i(e)},extractError:function(e){o.extractError(e)},extractData:function(e){r.extractData(e);var t=e.request,i=t.service.api.operations[t.operation].output||{};if(i.payload){var s=i.members[i.payload],c=e.httpResponse.body;if(s.isStreaming)e.data[i.payload]=c;else if("structure"===s.type){var l=new a;e.data[i.payload]=l.parse(c,s)}else e.data[i.payload]=c.toString()}else{var u=e.data;o.extractData(e),e.data=n.merge(u,e.data)}}}},{"../json/builder":13,"../json/parser":14,"../util":50,"./json":22,"./rest":24}],26:[function(e,t){function i(e){var t=e.service.api.operations[e.operation].input,i=new n.XML.Builder,o=e.params,s=t.payload;if(s){var a=t.members[s];if(void 0===(o=o[s]))return;if("structure"===a.type){var c=a.name;e.httpRequest.body=i.toXML(o,a,c,!0)}else e.httpRequest.body=o}else e.httpRequest.body=i.toXML(o,t,t.name||t.shape||r.string.upperFirst(e.operation)+"Request")}var n=e("../core"),r=e("../util"),o=e("./rest");t.exports={buildRequest:function(e){o.buildRequest(e),["GET","HEAD"].indexOf(e.httpRequest.method)<0&&i(e)},extractError:function(e){o.extractError(e);var t=(new n.XML.Parser).parse(e.httpResponse.body.toString());t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),e.error=t.Code?r.error(new Error,{code:t.Code,message:t.Message}):r.error(new Error,{code:e.httpResponse.statusCode,message:null})},extractData:function(e){o.extractData(e);var t,i=e.request,s=e.httpResponse.body,a=i.service.api.operations[i.operation].output,c=a.payload;if(c){var l=a.members[c];l.isStreaming?e.data[c]=s:"structure"===l.type?(t=new n.XML.Parser,e.data[c]=t.parse(s.toString(),l)):e.data[c]=s.toString()}else if(s.length>0){var u=(t=new n.XML.Parser).parse(s.toString(),a);r.update(e.data,u)}}}},{"../core":3,"../util":50,"./rest":24}],27:[function(e,t){function i(){}function n(e){return e.isQueryName||"ec2"!==e.api.protocol?e.name:e.name[0].toUpperCase()+e.name.substr(1)}function r(e,t,i,r){c.each(i.members,function(i,o){var s=t[i];if(null!==s&&void 0!==s){var c=n(o);a(c=e?e+"."+c:c,s,o,r)}})}function o(e,t,i,n){var r=1;c.each(t,function(t,o){var s=(i.flattened?".":".entry.")+r+++".",c=s+(i.key.name||"key"),l=s+(i.value.name||"value");a(e+c,t,i.key,n),a(e+l,o,i.value,n)})}function s(e,t,i,r){var o=i.member||{};return 0===t.length?void r.call(this,e,null):void c.arrayEach(t,function(t,s){var c="."+(s+1);if("ec2"===i.api.protocol)c+="";else if(i.flattened){if(o.name){var l=e.split(".");l.pop(),l.push(n(o)),e=l.join(".")}}else c=".member"+c;a(e+c,t,o,r)})}function a(e,t,i,n){null!==t&&void 0!==t&&("structure"===i.type?r(e,t,i,n):"list"===i.type?s(e,t,i,n):"map"===i.type?o(e,t,i,n):n(e,i.toWireFormat(t).toString()))}var c=e("../util");i.prototype.serialize=function(e,t,i){r("",e,t,i)},t.exports=i},{"../util":50}],28:[function(e,t){function i(e){if(!e)return null;var t=e.split("-");return t.length<3?null:t.slice(0,t.length-2).join("-")+"-*"}function n(e){var t=e.config.region,n=i(t),r=e.api.endpointPrefix;return[[t,r],[n,r],[t,"*"],[n,"*"],["*",r],["*","*"]].map(function(e){return e[0]&&e[1]?e.join("/"):null})}function r(e,t){o.each(t,function(t,i){"globalEndpoint"!==t&&(void 0===e.config[t]||null===e.config[t])&&(e.config[t]=i)})}var o=e("./util"),s=e("./region_config.json");t.exports=function(e){for(var t=n(e),i=0;i<t.length;i++){var o=t[i];if(o&&s.rules.hasOwnProperty(o)){var a=s.rules[o];return"string"==typeof a&&(a=s.patterns[a]),e.isGlobalEndpoint=!!a.globalEndpoint,a.signatureVersion||(a.signatureVersion="v4"),void r(e,a)}}}},{"./region_config.json":29,"./util":50}],29:[function(e,t){t.exports={rules:{"*/*":{endpoint:"{service}.{region}.amazonaws.com"},"cn-*/*":{endpoint:"{service}.{region}.amazonaws.com.cn"},"*/cloudfront":"globalSSL","*/iam":"globalSSL","*/sts":"globalSSL","*/importexport":{endpoint:"{service}.amazonaws.com",signatureVersion:"v2",globalEndpoint:!0},"*/route53":{endpoint:"https://{service}.amazonaws.com",signatureVersion:"v3https",globalEndpoint:!0},"us-gov-*/iam":"globalGovCloud","us-gov-*/sts":{endpoint:"{service}.{region}.amazonaws.com"},"us-gov-west-1/s3":"s3dash","us-west-1/s3":"s3dash","us-west-2/s3":"s3dash","eu-west-1/s3":"s3dash","ap-southeast-1/s3":"s3dash","ap-southeast-2/s3":"s3dash","ap-northeast-1/s3":"s3dash","sa-east-1/s3":"s3dash","us-east-1/s3":{endpoint:"{service}.amazonaws.com",signatureVersion:"s3"},"us-east-1/sdb":{endpoint:"{service}.amazonaws.com",signatureVersion:"v2"},"*/sdb":{endpoint:"{service}.{region}.amazonaws.com",signatureVersion:"v2"}},patterns:{globalSSL:{endpoint:"https://{service}.amazonaws.com",globalEndpoint:!0},globalGovCloud:{endpoint:"{service}.us-gov.amazonaws.com"},s3dash:{endpoint:"{service}-{region}.amazonaws.com",signatureVersion:"s3"}}}},{}],30:[function(e){(function(t){function i(e){return a.hasOwnProperty(e._asm.currentState)}var n=e("./core"),r=e("./state_machine"),o=n.util.inherit,s=n.util.nodeRequire("domain"),a={success:1,error:1,complete:1},c=new r;c.setupStates=function(){var e=function(e,t){var n=this;try{n.emit(n._asm.currentState,function(){t(n.response.error)})}catch(e){if(i(n)){if(!(s&&n.domain instanceof s.Domain))throw e;e.domainEmitter=n,e.domain=n.domain,e.domainThrown=!1,n.domain.emit("error",e)}else n.response.error=e,t(e)}};this.addState("validate","build","error",e),this.addState("build","afterBuild","restart",e),this.addState("afterBuild","sign","restart",e),this.addState("sign","send","retry",e),this.addState("retry","afterRetry","afterRetry",e),this.addState("afterRetry","sign","error",e),this.addState("send","validateResponse","retry",e),this.addState("validateResponse","extractData","extractError",e),this.addState("extractError","extractData","retry",e),this.addState("extractData","success","retry",e),this.addState("restart","build","error",e),this.addState("success","complete","complete",e),this.addState("error","complete","complete",e),this.addState("complete",null,null,e)},c.setupStates(),n.Request=o({constructor:function(e,t,i){var o=e.endpoint,a=e.config.region;e.isGlobalEndpoint&&(a="us-east-1"),this.domain=s&&s.active,this.service=e,this.operation=t,this.params=i||{},this.httpRequest=new n.HttpRequest(o,a),this.startTime=n.util.date.getDate(),this.response=new n.Response(this),this._asm=new r(c.states,"validate"),n.SequentialExecutor.call(this),this.emit=this.emitEvent},send:function(e){return e&&this.on("complete",function(t){e.call(t,t.error,t.data)}),this.runTo(),this.response},build:function(e){return this.runTo("send",e)},runTo:function(e,t){return this._asm.runTo(e,t,this),this},abort:function(){return this.removeAllListeners("validateResponse"),this.removeAllListeners("extractError"),this.on("validateResponse",function(e){e.error=n.util.error(new Error("Request aborted by user"),{code:"RequestAbortedError",retryable:!1})}),this.httpRequest.stream&&(this.httpRequest.stream.abort(),this.httpRequest._abortCallback?this.httpRequest._abortCallback():this.removeAllListeners("send")),this},eachPage:function(e){function t(i){e.call(i,i.error,i.data,function(r){!1!==r&&(i.hasNextPage()?i.nextPage().on("complete",t).send():e.call(i,null,null,n.util.fn.noop))})}e=n.util.fn.makeAsync(e,3),this.on("complete",t).send()},eachItem:function(e){var t=this;this.eachPage(function(i,r){if(i)return e(i,null);if(null===r)return e(null,null);var o=t.service.paginationConfig(t.operation).resultKey;Array.isArray(o)&&(o=o[0]);var s=n.util.jamespath.query(o,r);n.util.arrayEach(s,function(t){n.util.arrayEach(t,function(t){e(null,t)})})})},isPageable:function(){return!!this.service.paginationConfig(this.operation)},createReadStream:function(){var e=n.util.nodeRequire("stream"),i=this,r=null;return 2===n.HttpClient.streamsApiVersion?(r=new e.PassThrough,i.send()):(r=new e.Stream,r.readable=!0,r.sent=!1,r.on("newListener",function(e){r.sent||"data"!==e||(r.sent=!0,t.nextTick(function(){i.send()}))})),this.on("httpHeaders",function(e,t,o){if(300>e){i.removeListener("httpData",n.EventListeners.Core.HTTP_DATA),i.removeListener("httpError",n.EventListeners.Core.HTTP_ERROR),i.on("httpError",function(e){o.error=e,o.error.retryable=!1});var s=o.httpResponse.createUnbufferedStream();2===n.HttpClient.streamsApiVersion?s.pipe(r):(s.on("data",function(e){r.emit("data",e)}),s.on("end",function(){r.emit("end")})),s.on("error",function(e){r.emit("error",e)})}}),this.on("error",function(e){r.emit("error",e)}),r},emitEvent:function(e,t,i){"function"==typeof t&&(i=t,t=null),i||(i=function(){}),t||(t=this.eventParameters(e,this.response)),n.SequentialExecutor.prototype.emit.call(this,e,t,function(e){e&&(this.response.error=e),i.call(this,e)})},eventParameters:function(e){switch(e){case"restart":case"validate":case"sign":case"build":case"afterValidate":case"afterBuild":return[this];case"error":return[this.response.error,this.response];default:return[this.response]}},presign:function(e,t){return t||"function"!=typeof e||(t=e,e=null),(new n.Signers.Presign).sign(this.toGet(),e,t)},toUnauthenticated:function(){return this.removeListener("validate",n.EventListeners.Core.VALIDATE_CREDENTIALS),this.removeListener("sign",n.EventListeners.Core.SIGN),this.toGet()},toGet:function(){return("query"===this.service.api.protocol||"ec2"===this.service.api.protocol)&&(this.removeListener("build",this.buildAsGet),this.addListener("build",this.buildAsGet)),this},buildAsGet:function(e){e.httpRequest.method="GET",e.httpRequest.path=e.service.endpoint.path+"?"+e.httpRequest.body,e.httpRequest.body="",delete e.httpRequest.headers["Content-Length"],delete e.httpRequest.headers["Content-Type"]}}),n.util.mixin(n.Request,n.SequentialExecutor)}).call(this,e("FWaASH"))},{"./core":3,"./state_machine":49,FWaASH:64}],31:[function(e){var t=e("./core"),i=t.util.inherit;t.ResourceWaiter=i({constructor:function(e,i){this.service=e,this.state=i,"object"==typeof this.state&&t.util.each.call(this,this.state,function(e,t){this.state=e,this.expectedValue=t}),this.loadWaiterConfig(this.state),this.expectedValue||(this.expectedValue=this.config.successValue)},service:null,state:null,expectedValue:null,config:null,waitDone:!1,Listeners:{retry:(new t.SequentialExecutor).addNamedListeners(function(e){e("RETRY_CHECK","retry",function(e){var t=e.request._waiter;e.error&&"ResourceNotReady"===e.error.code&&(e.error.retryDelay=1e3*t.config.interval)})}),output:(new t.SequentialExecutor).addNamedListeners(function(e){e("CHECK_OUT_ERROR","extractError",function(e){e.error&&e.request._waiter.setError(e,!0)}),e("CHECK_OUTPUT","extractData",function(e){var t=e.request._waiter,i=t.checkSuccess(e);i?e.error=null:t.setError(e,null!==i)})}),error:(new t.SequentialExecutor).addNamedListeners(function(e){e("CHECK_ERROR","extractError",function(e){var t=e.request._waiter,i=t.checkError(e);i?(e.error=null,e.data={},e.request.removeAllListeners("extractData")):t.setError(e,null!==i)}),e("CHECK_ERR_OUTPUT","extractData",function(e){e.request._waiter.setError(e,!0)})})},wait:function(e,t){"function"==typeof e&&(t=e,e=void 0);var i=this.service.makeRequest(this.config.operation,e),n=this.Listeners[this.config.successType];return i._waiter=this,i.response.maxRetries=this.config.maxAttempts,i.addListeners(this.Listeners.retry),n&&i.addListeners(n),t&&i.send(t),i},setError:function(e,i){e.data=null,e.error=t.util.error(e.error||new Error,{code:"ResourceNotReady",message:"Resource is not in the state "+this.state,retryable:i})},checkSuccess:function(e){if(!this.config.successPath)return e.httpResponse.statusCode<300;var i=t.util.jamespath.find(this.config.successPath,e.data);return this.config.failureValue&&this.config.failureValue.indexOf(i)>=0?null:this.expectedValue?i===this.expectedValue:!!i},checkError:function(e){var t=this.config.successValue;return"number"==typeof t?e.httpResponse.statusCode===t:e.error&&e.error.code===t},loadWaiterConfig:function(e,i){if(!this.service.api.waiters[e]){if(i)return;throw new t.util.error(new Error,{code:"StateNotFoundError",message:"State "+e+" not found."})}this.config=this.service.api.waiters[e];var n=this.config;n.successType=n.successType||n.acceptorType,n.successPath=n.successPath||n.acceptorPath,n.successValue=n.successValue||n.acceptorValue,n.failureType=n.failureType||n.acceptorType,n.failurePath=n.failurePath||n.acceptorPath,n.failureValue=n.failureValue||n.acceptorValue}})},{"./core":3}],32:[function(e){var t=e("./core"),i=t.util.inherit;t.Response=i({constructor:function(e){this.request=e,this.data=null,this.error=null,this.retryCount=0,this.redirectCount=0,this.httpResponse=new t.HttpResponse,e&&(this.maxRetries=e.service.numRetries(),this.maxRedirects=e.service.config.maxRedirects)},nextPage:function(e){var i,n=this.request.service,r=this.request.operation;try{i=n.paginationConfig(r,!0)}catch(e){this.error=e}if(!this.hasNextPage()){if(e)e(this.error,null);else if(this.error)throw this.error;return null}var o=t.util.copy(this.request.params);if(this.nextPageTokens){var s=i.inputToken;"string"==typeof s&&(s=[s]);for(var a=0;a<s.length;a++)o[s[a]]=this.nextPageTokens[a];return n.makeRequest(this.request.operation,o,e)}return e?e(null,null):null},hasNextPage:function(){return this.cacheNextPageTokens(),!!this.nextPageTokens||void 0===this.nextPageTokens&&void 0},cacheNextPageTokens:function(){if(this.hasOwnProperty("nextPageTokens"))return this.nextPageTokens;this.nextPageTokens=void 0;var e=this.request.service.paginationConfig(this.request.operation);if(!e)return this.nextPageTokens;if(this.nextPageTokens=null,e.moreResults&&!t.util.jamespath.find(e.moreResults,this.data))return this.nextPageTokens;var i=e.outputToken;return"string"==typeof i&&(i=[i]),t.util.arrayEach.call(this,i,function(e){var i=t.util.jamespath.find(e,this.data);i&&(this.nextPageTokens=this.nextPageTokens||[],this.nextPageTokens.push(i))}),this.nextPageTokens}})},{"./core":3}],33:[function(e,t){(function(i){var n=e("../core"),r=n.util.string.byteLength;n.S3.ManagedUpload=n.util.inherit({constructor:function(e){var t=this;n.SequentialExecutor.call(t),t.body=null,t.sliceFn=null,t.callback=null,t.parts={},t.completeInfo=[],t.fillQueue=function(){t.callback(new Error("Unsupported body payload "+typeof t.body))},t.configure(e)},configure:function(e){if(e=e||{},this.partSize=this.minPartSize,e.queueSize&&(this.queueSize=e.queueSize),e.partSize&&(this.partSize=e.partSize),e.leavePartsOnError&&(this.leavePartsOnError=!0),this.partSize<this.minPartSize)throw new Error("partSize must be greater than "+this.minPartSize);this.service=e.service,this.bindServiceObject(e.params),this.validateBody(),this.adjustTotalBytes()},leavePartsOnError:!1,queueSize:4,partSize:null,minPartSize:5242880,maxTotalParts:1e4,send:function(e){var t=this;t.callback=e||function(e){if(e)throw e};var i=!0;if(t.sliceFn)t.fillQueue=t.fillBuffer;else if(n.util.isNode()){var r=n.util.nodeRequire("stream").Stream;t.body instanceof r&&(i=!1,t.fillQueue=t.fillStream,t.partBuffers=[],t.body.on("readable",function(){t.fillQueue()}).on("end",function(){t.isDoneChunking=!0,t.numParts=t.totalPartNumbers,t.fillQueue.call(t)}))}i&&t.fillQueue.call(t)},abort:function(){this.cleanup(n.util.error(new Error("Request aborted by user"),{code:"RequestAbortedError",retryable:!1}))},validateBody:function(){var e=this;if(e.body=e.service.config.params.Body,!e.body)throw new Error("params.Body is required");"string"==typeof e.body&&(e.body=new n.util.Buffer(e.body)),e.sliceFn=n.util.arraySliceFn(e.body)},bindServiceObject:function(e){e=e||{};var t=this;if(t.service){var i=n.util.copy(t.service.config);t.service=new t.service.constructor.__super__(i),t.service.config.params=n.util.merge(t.service.config.params||{},e)}else t.service=new n.S3({params:e})},adjustTotalBytes:function(){var e=this;try{e.totalBytes=r(e.body)}catch(e){}if(e.totalBytes){var t=Math.ceil(e.totalBytes/e.maxTotalParts);t>e.partSize&&(e.partSize=t)}else e.totalBytes=void 0},isDoneChunking:!1,partPos:0,totalChunkedBytes:0,totalUploadedBytes:0,totalBytes:void 0,numParts:0,totalPartNumbers:0,activeParts:0,doneParts:0,parts:null,completeInfo:null,failed:!1,multipartReq:null,partBuffers:null,partBufferLength:0,fillBuffer:function(){var e=this,t=r(e.body);if(0===t)return e.isDoneChunking=!0,e.numParts=1,void e.nextChunk(e.body);for(;e.activeParts<e.queueSize&&e.partPos<t;){var i=Math.min(e.partPos+e.partSize,t),n=e.sliceFn.call(e.body,e.partPos,i);e.partPos+=e.partSize,(r(n)<e.partSize||e.partPos===t)&&(e.isDoneChunking=!0,e.numParts=e.totalPartNumbers+1),e.nextChunk(n)}},fillStream:function(){var e=this;if(!(e.activeParts>=e.queueSize)){var t=e.body.read(e.partSize-e.partBufferLength)||e.body.read();if(t&&(e.partBuffers.push(t),e.partBufferLength+=t.length,e.totalChunkedBytes+=t.length),e.partBufferLength>=e.partSize){var n=i.concat(e.partBuffers);if(e.partBuffers=[],e.partBufferLength=0,n.length>e.partSize){var r=n.slice(e.partSize);e.partBuffers.push(r),e.partBufferLength+=r.length,n=n.slice(0,e.partSize)}e.nextChunk(n)}e.isDoneChunking&&!e.isDoneSending&&(n=i.concat(e.partBuffers),e.partBuffers=[],e.partBufferLength=0,e.totalBytes=e.totalChunkedBytes,e.isDoneSending=!0,(0===e.numParts||n.length>0)&&(e.numParts++,e.nextChunk(n))),e.body.read(0)}},nextChunk:function(e){var t=this;if(t.failed)return null;var i=++t.totalPartNumbers;if(t.isDoneChunking&&1===i){var n=t.service.putObject({Body:e});return n._managedUpload=t,n.on("httpUploadProgress",t.progress).send(t.finishSinglePart),null}t.activeParts++,t.service.config.params.UploadId?t.uploadPart(e,i):t.multipartReq?t.queueChunks(e,i):(t.multipartReq=t.service.createMultipartUpload(),t.multipartReq.on("success",function(e){t.service.config.params.UploadId=e.data.UploadId,t.multipartReq=null}),t.queueChunks(e,i),t.multipartReq.on("error",function(e){t.cleanup(e)}),t.multipartReq.send())},uploadPart:function(e,t){var i=this,r={Body:e,ContentLength:n.util.string.byteLength(e),PartNumber:t},o={ETag:null,PartNumber:t};i.completeInfo.push(o);var s=i.service.uploadPart(r);i.parts[t]=s,s._lastUploadedBytes=0,s._managedUpload=i,s.on("httpUploadProgress",i.progress),s.send(function(e,t){if(delete i.parts[r.PartNumber],i.activeParts--,!(e||t&&t.ETag)){var s="No access to ETag property on response.";n.util.isBrowser()&&(s+=" Check CORS configuration to expose ETag header."),e=n.util.error(new Error(s),{code:"ETagMissing",retryable:!1})}return e?i.cleanup(e):(o.ETag=t.ETag,i.doneParts++,void(i.isDoneChunking&&i.doneParts===i.numParts?i.finishMultiPart():i.fillQueue.call(i)))})},queueChunks:function(e,t){var i=this;i.multipartReq.on("success",function(){i.uploadPart(e,t)})},cleanup:function(e){var t=this;t.failed||("function"==typeof t.body.removeAllListeners&&"function"==typeof t.body.resume&&(t.body.removeAllListeners("readable"),t.body.removeAllListeners("end"),t.body.resume()),t.service.config.params.UploadId&&!t.leavePartsOnError&&t.service.abortMultipartUpload().send(),n.util.each(t.parts,function(e,t){t.removeAllListeners("complete"),t.abort()}),t.parts={},t.callback(e),t.failed=!0)},finishMultiPart:function(){var e=this,t={MultipartUpload:{Parts:e.completeInfo}};e.service.completeMultipartUpload(t,function(t,i){return t?e.cleanup(t):void e.callback(t,i)})},finishSinglePart:function(e,t){var i=this.request._managedUpload,r=this.request.httpRequest,o=n.util.urlFormat(r.endpoint);return e?i.callback(e):(t.Location=o.substr(0,o.length-1)+r.path,void i.callback(e,t))},progress:function(e){var t=this._managedUpload;"putObject"===this.operation?e.part=1:(t.totalUploadedBytes+=e.loaded-this._lastUploadedBytes,this._lastUploadedBytes=e.loaded,e={loaded:t.totalUploadedBytes,total:t.totalBytes,part:this.params.PartNumber}),t.emit("httpUploadProgress",[e])}}),n.util.mixin(n.S3.ManagedUpload,n.SequentialExecutor),t.exports=n.S3.ManagedUpload}).call(this,e("buffer").Buffer)},{"../core":3,buffer:53}],34:[function(e,t){var i=e("./core");i.SequentialExecutor=i.util.inherit({constructor:function(){this._events={}},listeners:function(e){return this._events[e]?this._events[e].slice(0):[]},on:function(e,t){return this._events[e]?this._events[e].push(t):this._events[e]=[t],this},onAsync:function(e,t){return t._isAsync=!0,this.on(e,t)},removeListener:function(e,t){var i=this._events[e];if(i){for(var n=i.length,r=-1,o=0;n>o;++o)i[o]===t&&(r=o);r>-1&&i.splice(r,1)}return this},removeAllListeners:function(e){return e?delete this._events[e]:this._events={},this},emit:function(e,t,i){i||(i=function(){});var n=this.listeners(e),r=n.length;return this.callListeners(n,t,i),r>0},callListeners:function(e,t,i){for(var n=this;e.length>0;){var r=e.shift();if(r._isAsync)return void r.apply(n,t.concat([function(r){r?i.call(n,r):n.callListeners(e,t,i)}]));r.apply(n,t)}i.call(n)},addListeners:function(e){var t=this;return e._events&&(e=e._events),i.util.each(e,function(e,n){"function"==typeof n&&(n=[n]),i.util.arrayEach(n,function(i){t.on(e,i)})}),t},addNamedListener:function(e,t,i){return this[e]=i,this.addListener(t,i),this},addNamedAsyncListener:function(e,t,i){return i._isAsync=!0,this.addNamedListener(e,t,i)},addNamedListeners:function(e){var t=this;return e(function(){t.addNamedListener.apply(t,arguments)},function(){t.addNamedAsyncListener.apply(t,arguments)}),this}}),i.SequentialExecutor.prototype.addListener=i.SequentialExecutor.prototype.on,t.exports=i.SequentialExecutor},{"./core":3}],35:[function(e){var t=e("./core"),i=e("./model/api"),n=e("./region_config"),r=t.util.inherit;t.Service=r({constructor:function(e){if(!this.loadServiceClass)throw t.util.error(new Error,"Service must be constructed with `new' operator");var i=this.loadServiceClass(e||{});return i?new i(e):void this.initialize(e)},initialize:function(e){var i=t.config[this.serviceIdentifier];this.config=new t.Config(t.config),i&&this.config.update(i,!0),e&&this.config.update(e,!0),this.validateService(),this.config.endpoint||n(this),this.config.endpoint=this.endpointFromTemplate(this.config.endpoint),this.setEndpoint(this.config.endpoint)},validateService:function(){},loadServiceClass:function(e){var i=e;if(t.util.isEmpty(this.api)){if(i.apiConfig)return t.Service.defineServiceApi(this.constructor,i.apiConfig);if(this.constructor.services){(i=new t.Config(t.config)).update(e,!0);var n=i.apiVersions[this.constructor.serviceIdentifier];return n=n||i.apiVersion,this.getLatestServiceClass(n)}return null}return null},getLatestServiceClass:function(e){return e=this.getLatestServiceVersion(e),null===this.constructor.services[e]&&t.Service.defineServiceApi(this.constructor,e),this.constructor.services[e]},getLatestServiceVersion:function(e){if(!this.constructor.services||0===this.constructor.services.length)throw new Error("No services defined on "+this.constructor.serviceIdentifier);if(e?t.util.isType(e,Date)&&(e=t.util.date.iso8601(e).split("T")[0]):e="latest",Object.hasOwnProperty(this.constructor.services,e))return e;for(var i=Object.keys(this.constructor.services).sort(),n=null,r=i.length-1;r>=0;r--)if("*"!==i[r][i[r].length-1]&&(n=i[r]),i[r].substr(0,10)<=e)return n;throw new Error("Could not find "+this.constructor.serviceIdentifier+" API to satisfy version constraint `"+e+"'")},api:{},defaultRetryCount:3,makeRequest:function(e,i,n){if("function"==typeof i&&(n=i,i=null),i=i||{},this.config.params){var r=this.api.operations[e];r&&(i=t.util.copy(i),t.util.each(this.config.params,function(e,t){r.input.members[e]&&(void 0===i[e]||null===i[e])&&(i[e]=t)}))}var o=new t.Request(this,e,i);return this.addAllRequestListeners(o),n&&o.send(n),o},makeUnauthenticatedRequest:function(e,t,i){"function"==typeof t&&(i=t,t={});var n=this.makeRequest(e,t).toUnauthenticated();return i?n.send(i):n},waitFor:function(e,i,n){return new t.ResourceWaiter(this,e).wait(i,n)},addAllRequestListeners:function(e){for(var i=[t.events,t.EventListeners.Core,this.serviceInterface(),t.EventListeners.CorePost],n=0;n<i.length;n++)i[n]&&e.addListeners(i[n]);this.config.paramValidation||e.removeListener("validate",t.EventListeners.Core.VALIDATE_PARAMETERS),this.config.logger&&e.addListeners(t.EventListeners.Logger),this.setupRequestListeners(e)},setupRequestListeners:function(){},getSignerClass:function(){var e;return e=this.config.signatureVersion?this.config.signatureVersion:this.api.signatureVersion,t.Signers.RequestSigner.getVersion(e)},serviceInterface:function(){switch(this.api.protocol){case"ec2":case"query":return t.EventListeners.Query;case"json":return t.EventListeners.Json;case"rest-json":return t.EventListeners.RestJson;case"rest-xml":return t.EventListeners.RestXml}if(this.api.protocol)throw new Error("Invalid service `protocol' "+this.api.protocol+" in API config")},successfulResponse:function(e){return e.httpResponse.statusCode<300},numRetries:function(){return void 0!==this.config.maxRetries?this.config.maxRetries:this.defaultRetryCount},retryDelays:function(){for(var e=this.numRetries(),t=[],i=0;e>i;++i)t[i]=30*Math.pow(2,i);return t},retryableError:function(e){return!!this.networkingError(e)||(!!this.expiredCredentialsError(e)||(!!this.throttledError(e)||e.statusCode>=500))},networkingError:function(e){return"NetworkingError"===e.code},expiredCredentialsError:function(e){return"ExpiredTokenException"===e.code},throttledError:function(e){switch(e.code){case"ProvisionedThroughputExceededException":case"Throttling":case"ThrottlingException":case"RequestLimitExceeded":case"RequestThrottled":return!0;default:return!1}},endpointFromTemplate:function(e){if("string"!=typeof e)return e;var t=e;return t=t.replace(/\{service\}/g,this.api.endpointPrefix),t=t.replace(/\{region\}/g,this.config.region),t=t.replace(/\{scheme\}/g,this.config.sslEnabled?"https":"http")},setEndpoint:function(e){this.endpoint=new t.Endpoint(e,this.config)},paginationConfig:function(e,i){var n=this.api.operations[e].paginator;if(!n){if(i){var r=new Error;throw t.util.error(r,"No pagination configuration for "+e)}return null}return n}}),t.util.update(t.Service,{defineMethods:function(e){t.util.each(e.prototype.api.operations,function(t){e.prototype[t]||(e.prototype[t]=function(e,i){return this.makeRequest(t,e,i)})})},defineService:function(e,i,n){t.Service._serviceMap[e]=!0,Array.isArray(i)||(n=i,i=[]);var o=r(t.Service,n||{});if("string"==typeof e){t.Service.addVersions(o,i);var s=o.serviceIdentifier||e;o.serviceIdentifier=s}else o.prototype.api=e,t.Service.defineMethods(o);return o},addVersions:function(e,t){Array.isArray(t)||(t=[t]),e.services=e.services||{};for(var i=0;i<t.length;i++)void 0===e.services[t[i]]&&(e.services[t[i]]=null);e.apiVersions=Object.keys(e.services).sort()},defineServiceApi:function(e,n,o){function s(e){a.prototype.api=e.isApi?e:new i(e)}var a=r(e,{serviceIdentifier:e.serviceIdentifier});if("string"==typeof n){if(o)s(o);else try{s(t.apiLoader(e.serviceIdentifier,n))}catch(i){throw t.util.error(i,{message:"Could not find API configuration "+e.serviceIdentifier+"-"+n})}e.services.hasOwnProperty(n)||(e.apiVersions=e.apiVersions.concat(n).sort()),e.services[n]=a}else s(n);return t.Service.defineMethods(a),a},hasService:function(e){return t.Service._serviceMap.hasOwnProperty(e)},_serviceMap:{}})},{"./core":3,"./model/api":15,"./region_config":28}],36:[function(e){var t=e("../core");t.util.update(t.CognitoIdentity.prototype,{getOpenIdToken:function(e,t){return this.makeUnauthenticatedRequest("getOpenIdToken",e,t)},getId:function(e,t){return this.makeUnauthenticatedRequest("getId",e,t)},getCredentialsForIdentity:function(e,t){return this.makeUnauthenticatedRequest("getCredentialsForIdentity",e,t)}})},{"../core":3}],37:[function(e){var t=e("../core");t.util.update(t.DynamoDB.prototype,{setupRequestListeners:function(e){e.service.config.dynamoDbCrc32&&e.addListener("extractData",this.checkCrc32)},checkCrc32:function(e){e.httpResponse.streaming||e.request.service.crc32IsValid(e)||(e.error=t.util.error(new Error,{code:"CRC32CheckFailed",message:"CRC32 integrity check failed",retryable:!0}))},crc32IsValid:function(e){var i=e.httpResponse.headers["x-amz-crc32"];return!i||parseInt(i,10)===t.util.crypto.crc32(e.httpResponse.body)},defaultRetryCount:10,retryDelays:function(){for(var e=this.numRetries(),t=[],i=0;e>i;++i)t.push(0===i?0:50*Math.pow(2,i-1));return t}})},{"../core":3}],38:[function(e){var t=e("../core");t.util.update(t.MachineLearning.prototype,{setupRequestListeners:function(e){"predict"===e.operation&&e.addListener("build",this.buildEndpoint)},buildEndpoint:function(e){var i=e.params.PredictEndpoint;i&&(e.httpRequest.endpoint=new t.Endpoint(i))}})},{"../core":3}],39:[function(e){var t=e("../core");e("../s3/managed_upload"),t.util.update(t.S3.prototype,{validateService:function(){if(this.config.region||(this.config.region="us-east-1"),!this.config.endpoint&&this.config.s3BucketEndpoint){throw t.util.error(new Error,{name:"InvalidEndpoint",message:"An endpoint must be provided when configuring `s3BucketEndpoint` to true."})}},setupRequestListeners:function(e){e.addListener("validate",this.validateScheme),e.addListener("validate",this.validateBucketEndpoint),e.addListener("build",this.addContentType),e.addListener("build",this.populateURI),e.addListener("build",this.computeContentMd5),e.addListener("build",this.computeSseCustomerKeyMd5),e.addListener("afterBuild",this.addExpect100Continue),e.removeListener("validate",t.EventListeners.Core.VALIDATE_REGION),e.addListener("extractError",this.extractError),e.addListener("extractData",this.extractData),e.addListener("extractData",t.util.hoistPayloadMember),e.addListener("beforePresign",this.prepareSignedUrl)},validateScheme:function(e){var i=e.params,n=e.httpRequest.endpoint.protocol;if((i.SSECustomerKey||i.CopySourceSSECustomerKey)&&"https:"!==n){throw t.util.error(new Error,{code:"ConfigError",message:"Cannot send SSE keys over HTTP. Set 'sslEnabled'to 'true' in your configuration"})}},validateBucketEndpoint:function(e){if(!e.params.Bucket&&e.service.config.s3BucketEndpoint){throw t.util.error(new Error,{code:"ConfigError",message:"Cannot send requests to root API with `s3BucketEndpoint` set."})}},populateURI:function(e){var t=e.httpRequest,i=e.params.Bucket;if(i&&!e.service.pathStyleBucketName(i)){if(!e.service.config.s3BucketEndpoint){t.endpoint.hostname=i+"."+t.endpoint.hostname;var n=t.endpoint.port;t.endpoint.host=80!==n&&443!==n?t.endpoint.hostname+":"+t.endpoint.port:t.endpoint.hostname}t.virtualHostedBucket=i,t.path=t.path.replace(new RegExp("/"+i),""),"/"!==t.path[0]&&(t.path="/"+t.path)}},addExpect100Continue:function(e){var i=e.httpRequest.headers["Content-Length"];t.util.isNode()&&i>=1048576&&(e.httpRequest.headers.Expect="100-continue")},addContentType:function(e){var i=e.httpRequest;if("GET"!==i.method&&"HEAD"!==i.method){i.headers["Content-Type"]||(i.headers["Content-Type"]="application/octet-stream");var n=i.headers["Content-Type"];if(t.util.isBrowser())if("string"!=typeof i.body||n.match(/;\s*charset=/)){var r=function(e,t,i){return t+i.toUpperCase()};i.headers["Content-Type"]=n.replace(/(;\s*charset=)(.+)$/,r)}else{i.headers["Content-Type"]+="; charset=UTF-8"}}else delete i.headers["Content-Type"]},computableChecksumOperations:{putBucketCors:!0,putBucketLifecycle:!0,putBucketTagging:!0,deleteObjects:!0},willComputeChecksums:function(e){if(this.computableChecksumOperations[e.operation])return!0;if(!this.config.computeChecksums)return!1;if(!t.util.Buffer.isBuffer(e.httpRequest.body)&&"string"!=typeof e.httpRequest.body)return!1;var i=e.service.api.operations[e.operation].input.members;return!(e.service.getSignerClass(e)===t.Signers.V4&&i.ContentMD5&&!i.ContentMD5.required)&&(!(!i.ContentMD5||e.params.ContentMD5)||void 0)},computeContentMd5:function(e){if(e.service.willComputeChecksums(e)){var i=t.util.crypto.md5(e.httpRequest.body,"base64");e.httpRequest.headers["Content-MD5"]=i}},computeSseCustomerKeyMd5:function(e){var i=["x-amz-server-side-encryption-customer-key","x-amz-copy-source-server-side-encryption-customer-key"];t.util.arrayEach(i,function(i){if(e.httpRequest.headers[i]){var n=e.httpRequest.headers[i],r=i+"-MD5";if(e.httpRequest.headers[i]=t.util.base64.encode(n),!e.httpRequest.headers[r]){var o=t.util.crypto.md5(n,"base64");e.httpRequest.headers[r]=o}}})},pathStyleBucketName:function(e){return!!this.config.s3ForcePathStyle||!this.config.s3BucketEndpoint&&(!this.dnsCompatibleBucketName(e)||!(!this.config.sslEnabled||!e.match(/\./)))},dnsCompatibleBucketName:function(e){var t=e,i=new RegExp(/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/),n=new RegExp(/(\d+\.){3}\d+/),r=new RegExp(/\.\./);return!(!t.match(i)||t.match(n)||t.match(r))},successfulResponse:function(e){var t=e.request,i=e.httpResponse;return("completeMultipartUpload"!==t.operation||!i.body.toString().match("<Error>"))&&i.statusCode<300},retryableError:function(e,i){return"completeMultipartUpload"===i.operation&&200===e.statusCode||(!(!e||"RequestTimeout"!==e.code)||t.Service.prototype.retryableError.call(this,e,i))},extractData:function(e){if("getBucketLocation"===e.request.operation){var t=e.httpResponse.body.toString().match(/>(.+)<\/Location/);delete e.data._,e.data.LocationConstraint=t?t[1]:""}},extractError:function(e){var i={304:"NotModified",403:"Forbidden",400:"BadRequest",404:"NotFound"},n=e.httpResponse.statusCode,r=e.httpResponse.body||"";if(i[n]&&0===r.length)e.error=t.util.error(new Error,{code:i[e.httpResponse.statusCode],message:null});else{var o=(new t.XML.Parser).parse(r.toString());e.error=t.util.error(new Error,{code:o.Code||n,message:o.Message||null})}},getSignedUrl:function(e,i,n){var r=(i=t.util.copy(i||{})).Expires||900;return delete i.Expires,this.makeRequest(e,i).presign(r,n)},prepareSignedUrl:function(e){e.addListener("validate",e.service.noPresignedContentLength),e.removeListener("build",e.service.addContentType),e.params.Body?e.addListener("afterBuild",t.EventListeners.Core.COMPUTE_SHA256):e.removeListener("build",e.service.computeContentMd5)},noPresignedContentLength:function(e){if(void 0!==e.params.ContentLength)throw t.util.error(new Error,{code:"UnexpectedParameter",message:"ContentLength is not supported in pre-signed URLs."})},createBucket:function(e,t){return e||(e={}),this.endpoint.hostname===this.api.globalEndpoint||e.CreateBucketConfiguration||(e.CreateBucketConfiguration={LocationConstraint:this.config.region}),this.makeRequest("createBucket",e,t)},upload:function(e,i,n){"function"==typeof i&&void 0===n&&(n=i,i=null),i=i||{},i=t.util.merge(i||{},{service:this,params:e});var r=new t.S3.ManagedUpload(i);return"function"==typeof n&&r.send(n),r}})},{"../core":3,"../s3/managed_upload":33}],40:[function(e){var t=e("../core");t.util.update(t.SQS.prototype,{setupRequestListeners:function(e){e.addListener("build",this.buildEndpoint),e.service.config.computeChecksums&&("sendMessage"===e.operation?e.addListener("extractData",this.verifySendMessageChecksum):"sendMessageBatch"===e.operation?e.addListener("extractData",this.verifySendMessageBatchChecksum):"receiveMessage"===e.operation&&e.addListener("extractData",this.verifyReceiveMessageChecksum))},verifySendMessageChecksum:function(e){if(e.data){var t=e.data.MD5OfMessageBody,i=this.params.MessageBody,n=this.service.calculateChecksum(i);if(n!==t){var r='Got "'+e.data.MD5OfMessageBody+'", expecting "'+n+'".';this.service.throwInvalidChecksumError(e,[e.data.MessageId],r)}}},verifySendMessageBatchChecksum:function(e){if(e.data){var i=this.service,n={},r=[],o=[];t.util.arrayEach(e.data.Successful,function(e){n[e.Id]=e}),t.util.arrayEach(this.params.Entries,function(e){if(n[e.Id]){var t=n[e.Id].MD5OfMessageBody,s=e.MessageBody;i.isChecksumValid(t,s)||(r.push(e.Id),o.push(n[e.Id].MessageId))}}),r.length>0&&i.throwInvalidChecksumError(e,o,"Invalid messages: "+r.join(", "))}},verifyReceiveMessageChecksum:function(e){if(e.data){var i=this.service,n=[];t.util.arrayEach(e.data.Messages,function(e){var t=e.MD5OfBody,r=e.Body;i.isChecksumValid(t,r)||n.push(e.MessageId)}),n.length>0&&i.throwInvalidChecksumError(e,n,"Invalid messages: "+n.join(", "))}},throwInvalidChecksumError:function(e,i,n){e.error=t.util.error(new Error,{retryable:!0,code:"InvalidChecksum",messageIds:i,message:e.request.operation+" returned an invalid MD5 response. "+n})},isChecksumValid:function(e,t){return this.calculateChecksum(t)===e},calculateChecksum:function(e){return t.util.crypto.md5(e,"hex")},buildEndpoint:function(e){var i=e.httpRequest.params.QueueUrl;if(i){e.httpRequest.endpoint=new t.Endpoint(i);var n=e.httpRequest.endpoint.host.match(/^sqs\.(.+?)\./);n&&(e.httpRequest.region=n[1])}}})},{"../core":3}],41:[function(e){var t=e("../core");t.util.update(t.STS.prototype,{credentialsFrom:function(e,i){return e?(i||(i=new t.TemporaryCredentials),i.expired=!1,i.accessKeyId=e.Credentials.AccessKeyId,i.secretAccessKey=e.Credentials.SecretAccessKey,i.sessionToken=e.Credentials.SessionToken,i.expireTime=e.Credentials.Expiration,i):null},assumeRoleWithWebIdentity:function(e,t){return this.makeUnauthenticatedRequest("assumeRoleWithWebIdentity",e,t)},assumeRoleWithSAML:function(e,t){return this.makeUnauthenticatedRequest("assumeRoleWithSAML",e,t)}})},{"../core":3}],42:[function(e,t){function i(e){var t=e.httpRequest.headers[s];if(delete e.httpRequest.headers["User-Agent"],delete e.httpRequest.headers["X-Amz-User-Agent"],e.service.getSignerClass()===r.Signers.V4){if(t>604800){throw r.util.error(new Error,{code:"InvalidExpiryTime",message:"Presigning does not support expiry time greater than a week with SigV4 signing.",retryable:!1})}e.httpRequest.headers[s]=t}else{if(e.service.getSignerClass()!==r.Signers.S3)throw r.util.error(new Error,{message:"Presigning only supports S3 or SigV4 signing.",code:"UnsupportedSigner",retryable:!1});e.httpRequest.headers[s]=parseInt(r.util.date.unixTimestamp()+t,10).toString()}}function n(e){var t=e.httpRequest.endpoint,i=r.util.urlParse(e.httpRequest.path),n={};i.search&&(n=r.util.queryStringParse(i.search.substr(1))),r.util.each(e.httpRequest.headers,function(e,t){e===s&&(e="Expires"),n[e]=t}),delete e.httpRequest.headers[s];var o=n.Authorization.split(" ");if("AWS"===o[0])o=o[1].split(":"),n.AWSAccessKeyId=o[0],n.Signature=o[1];else if("AWS4-HMAC-SHA256"===o[0]){o.shift();var a=o.join(" ").match(/Signature=(.*?)(?:,|\s|\r?\n|$)/)[1];n["X-Amz-Signature"]=a,delete n.Expires}delete n.Authorization,delete n.Host,t.pathname=i.pathname,t.search=r.util.queryParamsToString(n)}var r=e("../core"),o=r.util.inherit,s="presigned-expires";r.Signers.Presign=o({sign:function(e,t,o){if(e.httpRequest.headers[s]=t||3600,e.on("build",i),e.on("sign",n),e.removeListener("afterBuild",r.EventListeners.Core.SET_CONTENT_LENGTH),e.removeListener("afterBuild",r.EventListeners.Core.COMPUTE_SHA256),e.emit("beforePresign",[e]),!o){if(e.build(),e.response.error)throw e.response.error;return r.util.urlFormat(e.httpRequest.endpoint)}e.build(function(){this.response.error?o(this.response.error):o(null,r.util.urlFormat(e.httpRequest.endpoint))})}}),t.exports=r.Signers.Presign},{"../core":3}],43:[function(e){var t=e("../core"),i=t.util.inherit;t.Signers.RequestSigner=i({constructor:function(e){this.request=e}}),t.Signers.RequestSigner.getVersion=function(e){switch(e){case"v2":return t.Signers.V2;case"v3":return t.Signers.V3;case"v4":return t.Signers.V4;case"s3":return t.Signers.S3;case"v3https":return t.Signers.V3Https}throw new Error("Unknown signing version "+e)},e("./v2"),e("./v3"),e("./v3https"),e("./v4"),e("./s3"),e("./presign")},{"../core":3,"./presign":42,"./s3":44,"./v2":45,"./v3":46,"./v3https":47,"./v4":48}],44:[function(e,t){var i=e("../core"),n=i.util.inherit;i.Signers.S3=n(i.Signers.RequestSigner,{subResources:{acl:1,cors:1,lifecycle:1,delete:1,location:1,logging:1,notification:1,partNumber:1,policy:1,requestPayment:1,restore:1,tagging:1,torrent:1,uploadId:1,uploads:1,versionId:1,versioning:1,versions:1,website:1},responseHeaders:{"response-content-type":1,"response-content-language":1,"response-expires":1,"response-cache-control":1,"response-content-disposition":1,"response-content-encoding":1},addAuthorization:function(e,t){this.request.headers["presigned-expires"]||(this.request.headers["X-Amz-Date"]=i.util.date.rfc822(t)),e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken);var n=this.sign(e.secretAccessKey,this.stringToSign()),r="AWS "+e.accessKeyId+":"+n;this.request.headers.Authorization=r},stringToSign:function(){var e=this.request,t=[];t.push(e.method),t.push(e.headers["Content-MD5"]||""),t.push(e.headers["Content-Type"]||""),t.push(e.headers["presigned-expires"]||"");var i=this.canonicalizedAmzHeaders();return i&&t.push(i),t.push(this.canonicalizedResource()),t.join("\n")},canonicalizedAmzHeaders:function(){var e=[];i.util.each(this.request.headers,function(t){t.match(/^x-amz-/i)&&e.push(t)}),e.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1});var t=[];return i.util.arrayEach.call(this,e,function(e){t.push(e.toLowerCase()+":"+String(this.request.headers[e]))}),t.join("\n")},canonicalizedResource:function(){var e=this.request,t=e.path.split("?"),n=t[0],r=t[1],o="";if(e.virtualHostedBucket&&(o+="/"+e.virtualHostedBucket),o+=n,r){var s=[];i.util.arrayEach.call(this,r.split("&"),function(e){var t=e.split("=")[0],i=e.split("=")[1];if(this.subResources[t]||this.responseHeaders[t]){var n={name:t};void 0!==i&&(n.value=this.subResources[t]?i:decodeURIComponent(i)),s.push(n)}}),s.sort(function(e,t){return e.name<t.name?-1:1}),s.length&&(r=[],i.util.arrayEach(s,function(e){r.push(void 0===e.value?e.name:e.name+"="+e.value)}),o+="?"+r.join("&"))}return o},sign:function(e,t){return i.util.crypto.hmac(e,t,"base64","sha1")}}),t.exports=i.Signers.S3},{"../core":3}],45:[function(e,t){var i=e("../core"),n=i.util.inherit;i.Signers.V2=n(i.Signers.RequestSigner,{addAuthorization:function(e,t){t||(t=i.util.date.getDate());var n=this.request;n.params.Timestamp=i.util.date.iso8601(t),n.params.SignatureVersion="2",n.params.SignatureMethod="HmacSHA256",n.params.AWSAccessKeyId=e.accessKeyId,e.sessionToken&&(n.params.SecurityToken=e.sessionToken),delete n.params.Signature,n.params.Signature=this.signature(e),n.body=i.util.queryParamsToString(n.params),n.headers["Content-Length"]=n.body.length},signature:function(e){return i.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),"base64")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push(this.request.endpoint.host.toLowerCase()),e.push(this.request.pathname()),e.push(i.util.queryParamsToString(this.request.params)),e.join("\n")}}),t.exports=i.Signers.V2},{"../core":3}],46:[function(e,t){var i=e("../core"),n=i.util.inherit;i.Signers.V3=n(i.Signers.RequestSigner,{addAuthorization:function(e,t){var n=i.util.date.rfc822(t);this.request.headers["X-Amz-Date"]=n,e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken),this.request.headers["X-Amzn-Authorization"]=this.authorization(e,n)},authorization:function(e){return"AWS3 AWSAccessKeyId="+e.accessKeyId+",Algorithm=HmacSHA256,SignedHeaders="+this.signedHeaders()+",Signature="+this.signature(e)},signedHeaders:function(){var e=[];return i.util.arrayEach(this.headersToSign(),function(t){e.push(t.toLowerCase())}),e.sort().join(";")},canonicalHeaders:function(){var e=this.request.headers,t=[];return i.util.arrayEach(this.headersToSign(),function(i){t.push(i.toLowerCase().trim()+":"+String(e[i]).trim())}),t.sort().join("\n")+"\n"},headersToSign:function(){var e=[];return i.util.each(this.request.headers,function(t){("Host"===t||"Content-Encoding"===t||t.match(/^X-Amz/i))&&e.push(t)}),e},signature:function(e){return i.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),"base64")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push("/"),e.push(""),e.push(this.canonicalHeaders()),e.push(this.request.body),i.util.crypto.sha256(e.join("\n"))}}),t.exports=i.Signers.V3},{"../core":3}],47:[function(e,t){var i=e("../core"),n=i.util.inherit;e("./v3"),i.Signers.V3Https=n(i.Signers.V3,{authorization:function(e){return"AWS3-HTTPS AWSAccessKeyId="+e.accessKeyId+",Algorithm=HmacSHA256,Signature="+this.signature(e)},stringToSign:function(){return this.request.headers["X-Amz-Date"]}}),t.exports=i.Signers.V3Https},{"../core":3,"./v3":46}],48:[function(e,t){var i=e("../core"),n=i.util.inherit,r={},o="presigned-expires";i.Signers.V4=n(i.Signers.RequestSigner,{constructor:function(e,t){i.Signers.RequestSigner.call(this,e),this.serviceName=t},algorithm:"AWS4-HMAC-SHA256",addAuthorization:function(e,t){var n=i.util.date.iso8601(t).replace(/[:\-]|\.\d{3}/g,"");this.isPresigned()?this.updateForPresigned(e,n):this.addHeaders(e,n),this.request.headers.Authorization=this.authorization(e,n)},addHeaders:function(e,t){this.request.headers["X-Amz-Date"]=t,e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken)},updateForPresigned:function(e,t){var n=this.credentialString(t),r={"X-Amz-Date":t,"X-Amz-Algorithm":this.algorithm,"X-Amz-Credential":e.accessKeyId+"/"+n,"X-Amz-Expires":this.request.headers[o],"X-Amz-SignedHeaders":this.signedHeaders()};e.sessionToken&&(r["X-Amz-Security-Token"]=e.sessionToken),this.request.headers["Content-Type"]&&(r["Content-Type"]=this.request.headers["Content-Type"]),i.util.each.call(this,this.request.headers,function(e,t){e!==o&&this.isSignableHeader(e)&&0===e.toLowerCase().indexOf("x-amz-")&&(r[e]=t)});var s=this.request.path.indexOf("?")>=0?"&":"?";this.request.path+=s+i.util.queryParamsToString(r)},authorization:function(e,t){var i=[],n=this.credentialString(t);return i.push(this.algorithm+" Credential="+e.accessKeyId+"/"+n),i.push("SignedHeaders="+this.signedHeaders()),i.push("Signature="+this.signature(e,t)),i.join(", ")},signature:function(e,t){var n=r[this.serviceName],o=t.substr(0,8);if(!n||n.akid!==e.accessKeyId||n.region!==this.request.region||n.date!==o){var s=e.secretAccessKey,a=i.util.crypto.hmac("AWS4"+s,o,"buffer"),c=i.util.crypto.hmac(a,this.request.region,"buffer"),l=i.util.crypto.hmac(c,this.serviceName,"buffer"),u=i.util.crypto.hmac(l,"aws4_request","buffer");r[this.serviceName]={region:this.request.region,date:o,key:u,akid:e.accessKeyId}}var h=r[this.serviceName].key;return i.util.crypto.hmac(h,this.stringToSign(t),"hex")},stringToSign:function(e){var t=[];return t.push("AWS4-HMAC-SHA256"),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join("\n")},canonicalString:function(){var e=[],t=this.request.pathname();return"s3"!==this.serviceName&&(t=i.util.uriEscapePath(t)),e.push(this.request.method),e.push(t),e.push(this.request.search()),e.push(this.canonicalHeaders()+"\n"),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join("\n")},canonicalHeaders:function(){var e=[];i.util.each.call(this,this.request.headers,function(t,i){e.push([t,i])}),e.sort(function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1});var t=[];return i.util.arrayEach.call(this,e,function(e){var i=e[0].toLowerCase();this.isSignableHeader(i)&&t.push(i+":"+this.canonicalHeaderValues(e[1].toString()))}),t.join("\n")},canonicalHeaderValues:function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},signedHeaders:function(){var e=[];return i.util.each.call(this,this.request.headers,function(t){t=t.toLowerCase(),this.isSignableHeader(t)&&e.push(t)}),e.sort().join(";")},credentialString:function(e){var t=[];return t.push(e.substr(0,8)),t.push(this.request.region),t.push(this.serviceName),t.push("aws4_request"),t.join("/")},hexEncodedHash:function(e){return i.util.crypto.sha256(e,"hex")},hexEncodedBodyHash:function(){return this.isPresigned()&&"s3"===this.serviceName?"UNSIGNED-PAYLOAD":this.request.headers["X-Amz-Content-Sha256"]?this.request.headers["X-Amz-Content-Sha256"]:this.hexEncodedHash(this.request.body||"")},unsignableHeaders:["authorization","content-type","content-length","user-agent",o],isSignableHeader:function(e){return 0===e.toLowerCase().indexOf("x-amz-")||this.unsignableHeaders.indexOf(e)<0},isPresigned:function(){return!!this.request.headers[o]}}),t.exports=i.Signers.V4},{"../core":3}],49:[function(e,t){function i(e,t){this.currentState=t||null,this.states=e||{}}i.prototype.runTo=function(e,t,i,n){"function"==typeof e&&(n=i,i=t,t=e,e=null);var r=this,o=r.states[r.currentState];o.fn.call(i||r,n,function(n){if(n){if(!o.fail)return t?t.call(i,n):null;r.currentState=o.fail}else{if(!o.accept)return t?t.call(i):null;r.currentState=o.accept}return r.currentState===e?t?t.call(i,n):null:void r.runTo(e,t,i,n)})},i.prototype.addState=function(e,t,i,n){return"function"==typeof t?(n=t,t=null,i=null):"function"==typeof i&&(n=i,i=null),this.currentState||(this.currentState=e),this.states[e]={accept:t,fail:i,fn:n},this},t.exports=i},{}],50:[function(e,t){(function(i){var n,r=e("crypto"),o=e("buffer").Buffer,s={engine:function(){return s.isBrowser()&&"undefined"!=typeof navigator?navigator.userAgent:i.platform+"/"+i.version},userAgent:function(){var t=s.isBrowser()?"js":"nodejs",i="aws-sdk-"+t+"/"+e("./core").VERSION;return"nodejs"===t&&(i+=" "+s.engine()),i},isBrowser:function(){return i&&i.browser},isNode:function(){return!s.isBrowser()},nodeRequire:function(t){return s.isNode()?e(t):void 0},multiRequire:function(t,i){return e(s.isNode()?t:i)},uriEscape:function(e){var t=encodeURIComponent(e);return t=t.replace(/[^A-Za-z0-9_.~\-%]+/g,escape),t=t.replace(/[*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},uriEscapePath:function(e){var t=[];return s.arrayEach(e.split("/"),function(e){t.push(s.uriEscape(e))}),t.join("/")},urlParse:function(t){return e("url").parse(t)},urlFormat:function(t){return e("url").format(t)},queryStringParse:function(t){return e("querystring").parse(t)},queryParamsToString:function(e){var t=[],i=s.uriEscape,n=Object.keys(e).sort();return s.arrayEach(n,function(n){var r=e[n],o=i(n),a=o+"=";if(Array.isArray(r)){var c=[];s.arrayEach(r,function(e){c.push(i(e))}),a=o+"="+c.sort().join("&"+o+"=")}else void 0!==r&&null!==r&&(a=o+"="+i(r));t.push(a)}),t.join("&")},readFileSync:function(e){return"undefined"!=typeof window?null:s.nodeRequire("fs").readFileSync(e,"utf-8")},base64:{encode:function(e){return new o(e).toString("base64")},decode:function(e){return new o(e,"base64")}},Buffer:o,buffer:{toStream:function(e){s.Buffer.isBuffer(e)||(e=new s.Buffer(e));var t=new(s.nodeRequire("stream").Readable),i=0;return t._read=function(n){if(i>=e.length)return t.push(null);var r=i+n;r>e.length&&(r=e.length),t.push(e.slice(i,r)),i=r},t},concat:function(e){var t,i=0,n=0,r=null;for(t=0;t<e.length;t++)i+=e[t].length;for(r=new o(i),t=0;t<e.length;t++)e[t].copy(r,n),n+=e[t].length;return r}},string:{byteLength:function(e){if(null===e||void 0===e)return 0;if("string"==typeof e&&(e=new o(e)),"number"==typeof e.byteLength)return e.byteLength;if("number"==typeof e.length)return e.length;if("number"==typeof e.size)return e.size;if("string"==typeof e.path)return s.nodeRequire("fs").lstatSync(e.path).size;throw s.error(new Error("Cannot determine length of "+e),{object:e})},upperFirst:function(e){return e[0].toUpperCase()+e.substr(1)},lowerFirst:function(e){return e[0].toLowerCase()+e.substr(1)}},ini:{parse:function(e){var t,i={};return s.arrayEach(e.split(/\r?\n/),function(e){var n=(e=e.split(/(^|\s);/)[0]).match(/^\s*\[([^\[\]]+)\]\s*$/);if(n)t=n[1];else if(t){var r=e.match(/^\s*(.+?)\s*=\s*(.+?)\s*$/);r&&(i[t]=i[t]||{},i[t][r[1]]=r[2])}}),i}},fn:{noop:function(){},makeAsync:function(e,t){return t&&t<=e.length?e:function(){var t=Array.prototype.slice.call(arguments,0);t.pop()(e.apply(null,t))}}},jamespath:{query:function(e,t){if(!t)return[];var i=[],n=e.split(/\s+\|\|\s+/);return s.arrayEach.call(this,n,function(e){var n=[t],r=e.split(".");return s.arrayEach.call(this,r,function(e){var t=e.match("^(.+?)(?:\\[(-?\\d+|\\*|)\\])?$"),i=[];return s.arrayEach.call(this,n,function(e){"*"===t[1]?s.arrayEach.call(this,e,function(e){i.push(e)}):e.hasOwnProperty(t[1])&&i.push(e[t[1]])}),n=i,void 0!==t[2]&&(i=[],s.arrayEach.call(this,n,function(e){if(Array.isArray(e))if("*"===t[2]||""===t[2])i=i.concat(e);else{var n=parseInt(t[2],10);0>n&&(n=e.length+n),i.push(e[n])}}),n=i),0===n.length?s.abort:void 0}),n.length>0?(i=n,s.abort):void 0}),i},find:function(e,t){return s.jamespath.query(e,t)[0]}},date:{getDate:function(){return n||(n=e("./core")),n.config.systemClockOffset?new Date((new Date).getTime()+n.config.systemClockOffset):new Date},iso8601:function(e){return void 0===e&&(e=s.date.getDate()),e.toISOString().replace(/\.\d{3}Z$/,"Z")},rfc822:function(e){return void 0===e&&(e=s.date.getDate()),e.toUTCString()},unixTimestamp:function(e){return void 0===e&&(e=s.date.getDate()),e.getTime()/1e3},from:function(e){return new Date("number"==typeof e?1e3*e:e)},format:function(e,t){return t||(t="iso8601"),s.date[t](s.date.from(e))},parseTimestamp:function(e){if("number"==typeof e)return new Date(1e3*e);if(e.match(/^\d+$/))return new Date(1e3*e);if(e.match(/^\d{4}/))return new Date(e);if(e.match(/^\w{3},/))return new Date(e);throw s.error(new Error("unhandled timestamp format: "+e),{code:"TimestampParserError"})}},crypto:{crc32Table:[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc32:function(e){var t=s.crypto.crc32Table,i=-1;"string"==typeof e&&(e=new o(e));for(var n=0;n<e.length;n++)i=i>>>8^t[255&(i^e.readUInt8(n))];return(-1^i)>>>0},hmac:function(e,t,i,n){return i||(i="binary"),"buffer"===i&&(i=void 0),n||(n="sha256"),"string"==typeof t&&(t=new o(t)),r.createHmac(n,e).update(t).digest(i)},md5:function(e,t,i){return s.crypto.hash("md5",e,t,i)},sha256:function(e,t,i){return s.crypto.hash("sha256",e,t,i)},hash:function(e,t,i,n){var r=s.crypto.createHash(e);i||(i="binary"),"buffer"===i&&(i=void 0),"string"==typeof t&&(t=new o(t));var a=s.arraySliceFn(t),c=o.isBuffer(t);if(n&&"object"==typeof t&&"function"==typeof t.on&&!c)t.on("data",function(e){r.update(e)}),t.on("error",function(e){n(e)}),t.on("end",function(){n(null,r.digest(i))});else{if(!n||!a||c||"undefined"==typeof FileReader){s.isBrowser()&&"object"==typeof t&&!c&&(t=new o(new Uint8Array(t)));var l=r.update(t).digest(i);return n&&n(null,l),l}var u=0,h=new FileReader;h.onerror=function(){n(new Error("Failed to read data."))},h.onload=function(){var e=new o(new Uint8Array(h.result));r.update(e),u+=e.length,h._continueReading()},h._continueReading=function(){if(u>=t.size)n(null,r.digest(i));else{var e=u+524288;e>t.size&&(e=t.size),h.readAsArrayBuffer(a.call(t,u,e))}},h._continueReading()}},toHex:function(e){for(var t=[],i=0;i<e.length;i++)t.push(("0"+e.charCodeAt(i).toString(16)).substr(-2,2));return t.join("")},createHash:function(e){return r.createHash(e)}},abort:{},each:function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&t.call(this,i,e[i])===s.abort)break},arrayEach:function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&t.call(this,e[i],parseInt(i,10))===s.abort)break},update:function(e,t){return s.each(t,function(t,i){e[t]=i}),e},merge:function(e,t){return s.update(s.copy(e),t)},copy:function(e){if(null===e||void 0===e)return e;var t={};for(var i in e)t[i]=e[i];return t},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},arraySliceFn:function(e){var t=e.slice||e.webkitSlice||e.mozSlice;return"function"==typeof t?t:null},isType:function(e,t){return"function"==typeof t&&(t=s.typeName(t)),Object.prototype.toString.call(e)==="[object "+t+"]"},typeName:function(e){if(e.hasOwnProperty("name"))return e.name;var t=e.toString(),i=t.match(/^\s*function (.+)\(/);return i?i[1]:t},error:function(e,t){var i=null;return"string"==typeof e.message&&""!==e.message&&("string"==typeof t||t&&t.message)&&(i=s.copy(e),i.message=e.message),e.message=e.message||null,"string"==typeof t?e.message=t:s.update(e,t),"function"==typeof Object.defineProperty&&(Object.defineProperty(e,"name",{writable:!0,enumerable:!1}),Object.defineProperty(e,"message",{enumerable:!0})),e.name=e.name||e.code||"Error",e.time=new Date,i&&(e.originalError=i),e},inherit:function(e,t){var i=null;if(void 0===t)t=e,e=Object,i={};else{var n=function(){};n.prototype=e.prototype,i=new n}return t.constructor===Object&&(t.constructor=function(){return e!==Object?e.apply(this,arguments):void 0}),t.constructor.prototype=i,s.update(t.constructor.prototype,t),t.constructor.__super__=e,t.constructor},mixin:function(){for(var e=arguments[0],t=1;t<arguments.length;t++)for(var i in arguments[t].prototype){var n=arguments[t].prototype[i];"constructor"!==i&&(e.prototype[i]=n)}return e},hideProperties:function(e,t){"function"==typeof Object.defineProperty&&s.arrayEach(t,function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0})})},property:function(e,t,i,n,r){var o={configurable:!0,enumerable:void 0===n||n};"function"!=typeof i||r?(o.value=i,o.writable=!0):o.get=i,Object.defineProperty(e,t,o)},memoizedProperty:function(e,t,i,n){var r=null;s.property(e,t,function(){return null===r&&(r=i()),r},n)},hoistPayloadMember:function(e){var t=e.request,i=t.operation,r=t.service.api.operations[i].output;if(r.payload){var o=r.members[r.payload],s=e.data[r.payload];"structure"===o.type&&n.util.each(s,function(t,i){n.util.property(e.data,t,i,!1)})}},computeSha256:function(e,t){if(n.util.isNode()){var i=n.util.nodeRequire("stream").Stream,r=n.util.nodeRequire("fs");if(e instanceof i){if("string"!=typeof e.path)return t(new Error("Non-file stream objects are not supported with SigV4"));e=r.createReadStream(e.path)}}n.util.crypto.sha256(e,"hex",function(e,i){e?t(e):t(null,i)})}};t.exports=s}).call(this,e("FWaASH"))},{"./core":3,FWaASH:64,buffer:53,crypto:57,querystring:68,url:69}],51:[function(e,t){function i(){}function n(e,t){switch(t||(t={}),t.type){case"structure":return r(e,t);case"map":return o(e,t);case"list":return s(e,t);case void 0:case null:return c(e);default:return a(e,t)}}function r(e,t){var i={};return null===e?i:(l.each(t.members,function(t,r){if(r.isXmlAttribute){if(e.attributes.hasOwnProperty(r.name)){var o=e.attributes[r.name].value;i[t]=n({textContent:o},r)}}else{var s=r.flattened?e:e.getElementsByTagName(r.name)[0];s?i[t]=n(s,r):r.flattened||"list"!==r.type||(i[t]=r.defaultValue)}}),i)}function o(e,t){for(var i={},r=t.key.name||"key",o=t.value.name||"value",s=t.flattened?t.name:"entry",a=e.firstElementChild;a;){if(a.nodeName===s){var c=a.getElementsByTagName(r)[0].textContent,l=a.getElementsByTagName(o)[0];i[c]=n(l,t.value)}a=a.nextElementSibling}return i}function s(e,t){for(var i=[],r=t.flattened?t.name:t.member.name||"member",o=e.firstElementChild;o;)o.nodeName===r&&i.push(n(o,t.member)),o=o.nextElementSibling;return i}function a(e,t){if(e.getAttribute){var i=e.getAttribute("encoding");"base64"===i&&(t=new u.create({type:i}))}var n=e.textContent;return""===n&&(n=null),"function"==typeof t.toType?t.toType(n):n}function c(e){if(void 0===e||null===e)return"";if(!e.firstElementChild)return null===e.parentNode.parentNode?{}:0===e.childNodes.length?"":e.textContent;for(var t={type:"structure",members:{}},i=e.firstElementChild;i;){var n=i.nodeName;t.members.hasOwnProperty(n)?t.members[n].type="list":t.members[n]={name:n},i=i.nextElementSibling}return r(e,t)}var l=e("../util"),u=e("../model/shape");i.prototype.parse=function(e,t){if(""===e.replace(/^\s+/,""))return{};var i,r;try{if(window.DOMParser){try{i=(new DOMParser).parseFromString(e,"text/xml")}catch(e){throw l.error(new Error("Parse error in document"),{originalError:e})}if(null===i.documentElement)throw new Error("Cannot parse empty document.");var o=i.getElementsByTagName("parsererror")[0];if(o&&(o.parentNode===i||"body"===o.parentNode.nodeName))throw new Error(o.getElementsByTagName("div")[0].textContent)}else{if(!window.ActiveXObject)throw new Error("Cannot load XML parser");if(i=new window.ActiveXObject("Microsoft.XMLDOM"),i.async=!1,!i.loadXML(e))throw new Error("Parse error in document")}}catch(e){r=e}if(i&&i.documentElement&&!r){var s=n(i.documentElement,t),a=i.getElementsByTagName("ResponseMetadata")[0];return a&&(s.ResponseMetadata=n(a,{})),s}if(r)throw l.error(r||new Error,{code:"XMLParserError"});return{}},t.exports=i},{"../model/shape":20,"../util":50}],52:[function(e,t){function i(){}function n(e,t,i){switch(i.type){case"structure":return r(e,t,i);case"map":return o(e,t,i);case"list":return s(e,t,i);default:return a(e,t,i)}}function r(e,t,i){l.arrayEach(i.memberNames,function(r){var o=i.members[r];if("body"===o.location){var s=t[r],a=o.name;if(void 0!==s&&null!==s)if(o.isXmlAttribute)e.att(a,s);else if(o.flattened)n(e,s,o);else{var l=e.ele(a);c(l,o),n(l,s,o)}}})}function o(e,t,i){var r=i.key.name||"key",o=i.value.name||"value";l.each(t,function(t,s){var a=e.ele(i.flattened?i.name:"entry");n(a.ele(r),t,i.key),n(a.ele(o),s,i.value)})}function s(e,t,i){i.flattened?l.arrayEach(t,function(t){var r=i.member.name||i.name;n(e.ele(r),t,i.member)}):l.arrayEach(t,function(t){var r=i.member.name||"member";n(e.ele(r),t,i.member)})}function a(e,t,i){e.txt(i.toWireFormat(t))}function c(e,t){var i,n="xmlns";t.xmlNamespaceUri?(i=t.xmlNamespaceUri,t.xmlNamespacePrefix&&(n+=":"+t.xmlNamespacePrefix)):e.isRoot&&t.api.xmlNamespaceUri&&(i=t.api.xmlNamespaceUri),i&&e.att(n,i)}var l=e("../util"),u=e("xmlbuilder");i.prototype.toXML=function(e,t,i,r){var o=u.create(i);return c(o,t),n(o,e,t),o.children.length>0||r?o.root().toString():""},t.exports=i},{"../util":50,xmlbuilder:74}],53:[function(e,t,i){function n(e,t,i){if(!(this instanceof n))return new n(e,t,i);var r=typeof e;if("base64"===t&&"string"===r)for(e=P(e);e.length%4!=0;)e+="=";var o;if("number"===r)o=w(e);else if("string"===r)o=n.byteLength(e,t);else{if("object"!==r)throw new Error("First argument needs to be a number, array or string.");o=w(e.length)}var s;n._useTypedArrays?s=n._augment(new Uint8Array(o)):(s=this,s.length=o,s._isBuffer=!0);var a;if(n._useTypedArrays&&"number"==typeof e.byteLength)s._set(e);else if(L(e))for(a=0;o>a;a++)s[a]=n.isBuffer(e)?e.readUInt8(a):e[a];else if("string"===r)s.write(e,0,t);else if("number"===r&&!n._useTypedArrays&&!i)for(a=0;o>a;a++)s[a]=0;return s}function r(e,t,i,r){i=Number(i)||0;var o=e.length-i;r?(r=Number(r))>o&&(r=o):r=o;var s=t.length;U(s%2==0,"Invalid hex string"),r>s/2&&(r=s/2);for(var a=0;r>a;a++){var c=parseInt(t.substr(2*a,2),16);U(!isNaN(c),"Invalid hex string"),e[i+a]=c}return n._charsWritten=2*a,a}function o(e,t,i,r){return n._charsWritten=k(D(t),e,i,r)}function s(e,t,i,r){return n._charsWritten=k(F(t),e,i,r)}function a(e,t,i,n){return s(e,t,i,n)}function c(e,t,i,r){return n._charsWritten=k(M(t),e,i,r)}function l(e,t,i,r){return n._charsWritten=k(B(t),e,i,r)}function u(e,t,i){return Y.fromByteArray(0===t&&i===e.length?e:e.slice(t,i))}function h(e,t,i){var n="",r="";i=Math.min(e.length,i);for(var o=t;i>o;o++)e[o]<=127?(n+=W(r)+String.fromCharCode(e[o]),r=""):r+="%"+e[o].toString(16);return n+W(r)}function d(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;i>r;r++)n+=String.fromCharCode(e[r]);return n}function p(e,t,i){return d(e,t,i)}function _(e,t,i){var n=e.length;(!t||0>t)&&(t=0),(!i||0>i||i>n)&&(i=n);for(var r="",o=t;i>o;o++)r+=O(e[o]);return r}function f(e,t,i){for(var n=e.slice(t,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function m(e,t,i,n){n||(U("boolean"==typeof i,"missing or invalid endian"),U(void 0!==t&&null!==t,"missing offset"),U(t+1<e.length,"Trying to read beyond buffer length"));var r=e.length;if(!(t>=r)){var o;return i?(o=e[t],r>t+1&&(o|=e[t+1]<<8)):(o=e[t]<<8,r>t+1&&(o|=e[t+1])),o}}function g(e,t,i,n){n||(U("boolean"==typeof i,"missing or invalid endian"),U(void 0!==t&&null!==t,"missing offset"),U(t+3<e.length,"Trying to read beyond buffer length"));var r=e.length;if(!(t>=r)){var o;return i?(r>t+2&&(o=e[t+2]<<16),r>t+1&&(o|=e[t+1]<<8),o|=e[t],r>t+3&&(o+=e[t+3]<<24>>>0)):(r>t+1&&(o=e[t+1]<<16),r>t+2&&(o|=e[t+2]<<8),r>t+3&&(o|=e[t+3]),o+=e[t]<<24>>>0),o}}function y(e,t,i,n){if(n||(U("boolean"==typeof i,"missing or invalid endian"),U(void 0!==t&&null!==t,"missing offset"),U(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var r=m(e,t,i,!0);return 32768&r?-1*(65535-r+1):r}}function T(e,t,i,n){if(n||(U("boolean"==typeof i,"missing or invalid endian"),U(void 0!==t&&null!==t,"missing offset"),U(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var r=g(e,t,i,!0);return 2147483648&r?-1*(4294967295-r+1):r}}function v(e,t,i,n){return n||(U("boolean"==typeof i,"missing or invalid endian"),U(t+3<e.length,"Trying to read beyond buffer length")),H.read(e,t,i,23,4)}function S(e,t,i,n){return n||(U("boolean"==typeof i,"missing or invalid endian"),U(t+7<e.length,"Trying to read beyond buffer length")),H.read(e,t,i,52,8)}function C(e,t,i,n,r){r||(U(void 0!==t&&null!==t,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==i&&null!==i,"missing offset"),U(i+1<e.length,"trying to write beyond buffer length"),V(t,65535));var o=e.length;if(!(i>=o))for(var s=0,a=Math.min(o-i,2);a>s;s++)e[i+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function E(e,t,i,n,r){r||(U(void 0!==t&&null!==t,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==i&&null!==i,"missing offset"),U(i+3<e.length,"trying to write beyond buffer length"),V(t,4294967295));var o=e.length;if(!(i>=o))for(var s=0,a=Math.min(o-i,4);a>s;s++)e[i+s]=t>>>8*(n?s:3-s)&255}function b(e,t,i,n,r){r||(U(void 0!==t&&null!==t,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==i&&null!==i,"missing offset"),U(i+1<e.length,"Trying to write beyond buffer length"),z(t,32767,-32768)),i>=e.length||(t>=0?C(e,t,i,n,r):C(e,65535+t+1,i,n,r))}function A(e,t,i,n,r){r||(U(void 0!==t&&null!==t,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==i&&null!==i,"missing offset"),U(i+3<e.length,"Trying to write beyond buffer length"),z(t,2147483647,-2147483648)),i>=e.length||(t>=0?E(e,t,i,n,r):E(e,4294967295+t+1,i,n,r))}function x(e,t,i,n,r){r||(U(void 0!==t&&null!==t,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==i&&null!==i,"missing offset"),U(i+3<e.length,"Trying to write beyond buffer length"),G(t,3.4028234663852886e38,-3.4028234663852886e38)),i>=e.length||H.write(e,t,i,n,23,4)}function R(e,t,i,n,r){r||(U(void 0!==t&&null!==t,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==i&&null!==i,"missing offset"),U(i+7<e.length,"Trying to write beyond buffer length"),G(t,1.7976931348623157e308,-1.7976931348623157e308)),i>=e.length||H.write(e,t,i,n,52,8)}function P(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function I(e,t,i){return"number"!=typeof e?i:(e=~~e)>=t?t:e>=0?e:(e+=t)>=0?e:0}function w(e){return 0>(e=~~Math.ceil(+e))?0:e}function N(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function L(e){return N(e)||n.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function O(e){return 16>e?"0"+e.toString(16):e.toString(16)}function D(e){for(var t=[],i=0;i<e.length;i++){var n=e.charCodeAt(i);if(127>=n)t.push(e.charCodeAt(i));else{var r=i;n>=55296&&57343>=n&&i++;for(var o=encodeURIComponent(e.slice(r,i+1)).substr(1).split("%"),s=0;s<o.length;s++)t.push(parseInt(o[s],16))}}return t}function F(e){for(var t=[],i=0;i<e.length;i++)t.push(255&e.charCodeAt(i));return t}function B(e){for(var t,i,n,r=[],o=0;o<e.length;o++)t=e.charCodeAt(o),i=t>>8,n=t%256,r.push(n),r.push(i);return r}function M(e){return Y.toByteArray(e)}function k(e,t,i,n){for(var r=0;n>r&&!(r+i>=t.length||r>=e.length);r++)t[r+i]=e[r];return r}function W(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function V(e,t){U("number"==typeof e,"cannot write a non-number as a number"),U(e>=0,"specified a negative value for writing an unsigned value"),U(t>=e,"value is larger than maximum value for type"),U(Math.floor(e)===e,"value has a fractional component")}function z(e,t,i){U("number"==typeof e,"cannot write a non-number as a number"),U(t>=e,"value larger than maximum allowed value"),U(e>=i,"value smaller than minimum allowed value"),U(Math.floor(e)===e,"value has a fractional component")}function G(e,t,i){U("number"==typeof e,"cannot write a non-number as a number"),U(t>=e,"value larger than maximum allowed value"),U(e>=i,"value smaller than minimum allowed value")}function U(e,t){if(!e)throw new Error(t||"Failed assertion")}var Y=e("base64-js"),H=e("ieee754");i.Buffer=n,i.SlowBuffer=n,i.INSPECT_MAX_BYTES=50,n.poolSize=8192,n._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),n.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.isBuffer=function(e){return!(null===e||void 0===e||!e._isBuffer)},n.byteLength=function(e,t){var i;switch(e+="",t||"utf8"){case"hex":i=e.length/2;break;case"utf8":case"utf-8":i=D(e).length;break;case"ascii":case"binary":case"raw":i=e.length;break;case"base64":i=M(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=2*e.length;break;default:throw new Error("Unknown encoding")}return i},n.concat=function(e,t){if(U(N(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new n(0);if(1===e.length)return e[0];var i;if("number"!=typeof t)for(t=0,i=0;i<e.length;i++)t+=e[i].length;var r=new n(t),o=0;for(i=0;i<e.length;i++){var s=e[i];s.copy(r,o),o+=s.length}return r},n.prototype.write=function(e,t,i,n){if(isFinite(t))isFinite(i)||(n=i,i=void 0);else{var u=n;n=t,t=i,i=u}t=Number(t)||0;var h=this.length-t;i?(i=Number(i))>h&&(i=h):i=h;var d;switch(n=String(n||"utf8").toLowerCase()){case"hex":d=r(this,e,t,i);break;case"utf8":case"utf-8":d=o(this,e,t,i);break;case"ascii":d=s(this,e,t,i);break;case"binary":d=a(this,e,t,i);break;case"base64":d=c(this,e,t,i);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":d=l(this,e,t,i);break;default:throw new Error("Unknown encoding")}return d},n.prototype.toString=function(e,t,i){var n=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(i=void 0!==i?Number(i):i=n.length)===t)return"";var r;switch(e){case"hex":r=_(n,t,i);break;case"utf8":case"utf-8":r=h(n,t,i);break;case"ascii":r=d(n,t,i);break;case"binary":r=p(n,t,i);break;case"base64":r=u(n,t,i);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=f(n,t,i);break;default:throw new Error("Unknown encoding")}return r},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.copy=function(e,t,i,r){var o=this;if(i||(i=0),r||0===r||(r=this.length),t||(t=0),r!==i&&0!==e.length&&0!==o.length){U(r>=i,"sourceEnd < sourceStart"),U(t>=0&&t<e.length,"targetStart out of bounds"),U(i>=0&&i<o.length,"sourceStart out of bounds"),U(r>=0&&r<=o.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var s=r-i;if(100>s||!n._useTypedArrays)for(var a=0;s>a;a++)e[a+t]=this[a+i];else e._set(this.subarray(i,i+s),t)}},n.prototype.slice=function(e,t){var i=this.length;if(e=I(e,i,0),t=I(t,i,i),n._useTypedArrays)return n._augment(this.subarray(e,t));for(var r=t-e,o=new n(r,void 0,!0),s=0;r>s;s++)o[s]=this[s+e];return o},n.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},n.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},n.prototype.readUInt8=function(e,t){return t||(U(void 0!==e&&null!==e,"missing offset"),U(e<this.length,"Trying to read beyond buffer length")),e>=this.length?void 0:this[e]},n.prototype.readUInt16LE=function(e,t){return m(this,e,!0,t)},n.prototype.readUInt16BE=function(e,t){return m(this,e,!1,t)},n.prototype.readUInt32LE=function(e,t){return g(this,e,!0,t)},n.prototype.readUInt32BE=function(e,t){return g(this,e,!1,t)},n.prototype.readInt8=function(e,t){if(t||(U(void 0!==e&&null!==e,"missing offset"),U(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},n.prototype.readInt16LE=function(e,t){return y(this,e,!0,t)},n.prototype.readInt16BE=function(e,t){return y(this,e,!1,t)},n.prototype.readInt32LE=function(e,t){return T(this,e,!0,t)},n.prototype.readInt32BE=function(e,t){return T(this,e,!1,t)},n.prototype.readFloatLE=function(e,t){return v(this,e,!0,t)},n.prototype.readFloatBE=function(e,t){return v(this,e,!1,t)},n.prototype.readDoubleLE=function(e,t){return S(this,e,!0,t)},n.prototype.readDoubleBE=function(e,t){return S(this,e,!1,t)},n.prototype.writeUInt8=function(e,t,i){i||(U(void 0!==e&&null!==e,"missing value"),U(void 0!==t&&null!==t,"missing offset"),U(t<this.length,"trying to write beyond buffer length"),V(e,255)),t>=this.length||(this[t]=e)},n.prototype.writeUInt16LE=function(e,t,i){C(this,e,t,!0,i)},n.prototype.writeUInt16BE=function(e,t,i){C(this,e,t,!1,i)},n.prototype.writeUInt32LE=function(e,t,i){E(this,e,t,!0,i)},n.prototype.writeUInt32BE=function(e,t,i){E(this,e,t,!1,i)},n.prototype.writeInt8=function(e,t,i){i||(U(void 0!==e&&null!==e,"missing value"),U(void 0!==t&&null!==t,"missing offset"),U(t<this.length,"Trying to write beyond buffer length"),z(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,i):this.writeUInt8(255+e+1,t,i))},n.prototype.writeInt16LE=function(e,t,i){b(this,e,t,!0,i)},n.prototype.writeInt16BE=function(e,t,i){b(this,e,t,!1,i)},n.prototype.writeInt32LE=function(e,t,i){A(this,e,t,!0,i)},n.prototype.writeInt32BE=function(e,t,i){A(this,e,t,!1,i)},n.prototype.writeFloatLE=function(e,t,i){x(this,e,t,!0,i)},n.prototype.writeFloatBE=function(e,t,i){x(this,e,t,!1,i)},n.prototype.writeDoubleLE=function(e,t,i){R(this,e,t,!0,i)},n.prototype.writeDoubleBE=function(e,t,i){R(this,e,t,!1,i)},n.prototype.fill=function(e,t,i){if(e||(e=0),t||(t=0),i||(i=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),U("number"==typeof e&&!isNaN(e),"value is not a number"),U(i>=t,"end < start"),i!==t&&0!==this.length){U(t>=0&&t<this.length,"start out of bounds"),U(i>=0&&i<=this.length,"end out of bounds");for(var n=t;i>n;n++)this[n]=e}},n.prototype.inspect=function(){for(var e=[],t=this.length,n=0;t>n;n++)if(e[n]=O(this[n]),n===i.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},n.prototype.toArrayBuffer=function(){if(void 0!==Uint8Array){if(n._useTypedArrays)return new n(this).buffer;for(var e=new Uint8Array(this.length),t=0,i=e.length;i>t;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var X=n.prototype;n._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=X.get,e.set=X.set,e.write=X.write,e.toString=X.toString,e.toLocaleString=X.toString,e.toJSON=X.toJSON,e.copy=X.copy,e.slice=X.slice,e.readUInt8=X.readUInt8,e.readUInt16LE=X.readUInt16LE,e.readUInt16BE=X.readUInt16BE,e.readUInt32LE=X.readUInt32LE,e.readUInt32BE=X.readUInt32BE,e.readInt8=X.readInt8,e.readInt16LE=X.readInt16LE,e.readInt16BE=X.readInt16BE,e.readInt32LE=X.readInt32LE,e.readInt32BE=X.readInt32BE,e.readFloatLE=X.readFloatLE,e.readFloatBE=X.readFloatBE,e.readDoubleLE=X.readDoubleLE,e.readDoubleBE=X.readDoubleBE,e.writeUInt8=X.writeUInt8,e.writeUInt16LE=X.writeUInt16LE,e.writeUInt16BE=X.writeUInt16BE,e.writeUInt32LE=X.writeUInt32LE,e.writeUInt32BE=X.writeUInt32BE,e.writeInt8=X.writeInt8,e.writeInt16LE=X.writeInt16LE,e.writeInt16BE=X.writeInt16BE,e.writeInt32LE=X.writeInt32LE,e.writeInt32BE=X.writeInt32BE,e.writeFloatLE=X.writeFloatLE,e.writeFloatBE=X.writeFloatBE,e.writeDoubleLE=X.writeDoubleLE,e.writeDoubleBE=X.writeDoubleBE,e.fill=X.fill,e.inspect=X.inspect,e.toArrayBuffer=X.toArrayBuffer,e}},{"base64-js":54,ieee754:55}],54:[function(e,t,i){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===r||t===l?62:t===o||t===u?63:s>t?-1:s+10>t?t-s+26+26:c+26>t?t-c:a+26>t?t-a+26:void 0}var i=void 0!==Uint8Array?Uint8Array:Array,r="+".charCodeAt(0),o="/".charCodeAt(0),s="0".charCodeAt(0),a="a".charCodeAt(0),c="A".charCodeAt(0),l="-".charCodeAt(0),u="_".charCodeAt(0);e.toByteArray=function(e){function n(e){l[h++]=e}var r,o,s,a,c,l;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;c="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,l=new i(3*e.length/4-c),s=c>0?e.length-4:e.length;var h=0;for(r=0,o=0;s>r;r+=4,o+=3)a=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===c?(a=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&a)):1===c&&(a=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(a>>8&255),n(255&a)),l},e.fromByteArray=function(e){function t(e){return n.charAt(e)}var i,r,o,s=e.length%3,a="";for(i=0,o=e.length-s;o>i;i+=3)r=(e[i]<<16)+(e[i+1]<<8)+e[i+2],a+=function(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}(r);switch(s){case 1:a+=t((r=e[e.length-1])>>2),a+=t(r<<4&63),a+="==";break;case 2:a+=t((r=(e[e.length-2]<<8)+e[e.length-1])>>10),a+=t(r>>4&63),a+=t(r<<2&63),a+="="}return a}}(void 0===i?this.base64js={}:i)},{}],55:[function(e,t,i){i.read=function(e,t,i,n,r){var o,s,a=8*r-n-1,c=(1<<a)-1,l=c>>1,u=-7,h=i?r-1:0,d=i?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=l}return(p?-1:1)*s*Math.pow(2,o-n)},i.write=function(e,t,i,n,r,o){var s,a,c,l=8*o-r-1,u=(1<<l)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,_=n?1:-1,f=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*c-1)*Math.pow(2,r),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[i+p]=255&a,p+=_,a/=256,r-=8);for(s=s<<r|a,l+=r;l>0;e[i+p]=255&s,p+=_,s/=256,l-=8);e[i+p-_]|=128*f}},{}],56:[function(e,t){function i(e,t){if(e.length%o!=0){var i=e.length+(o-e.length%o);e=r.concat([e,s],i)}for(var n=[],a=t?e.readInt32BE:e.readInt32LE,c=0;c<e.length;c+=o)n.push(a.call(e,c));return n}function n(e,t,i){for(var n=new r(t),o=i?n.writeInt32BE:n.writeInt32LE,s=0;s<e.length;s++)o.call(n,e[s],4*s,!0);return n}var r=e("buffer").Buffer,o=4,s=new r(o);s.fill(0);var a=8;t.exports={hash:function(e,t,o,s){return r.isBuffer(e)||(e=new r(e)),n(t(i(e,s),e.length*a),o,s)}}},{buffer:53}],57:[function(e,t,i){function n(e,t,i){s.isBuffer(t)||(t=new s(t)),s.isBuffer(i)||(i=new s(i)),t.length>h?t=e(t):t.length<h&&(t=s.concat([t,d],h));for(var n=new s(h),r=new s(h),o=0;h>o;o++)n[o]=54^t[o],r[o]=92^t[o];var a=e(s.concat([n,i]));return e(s.concat([r,a]))}function r(e,t){var i=u[e=e||"sha1"],r=[],a=0;return i||o("algorithm:",e,"is not yet supported"),{update:function(e){return s.isBuffer(e)||(e=new s(e)),r.push(e),a+=e.length,this},digest:function(e){var o=s.concat(r),a=t?n(i,t,o):i(o);return r=null,e?a.toString(e):a}}}function o(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}var s=e("buffer").Buffer,a=e("./sha"),c=e("./sha256"),l=e("./rng"),u={sha1:a,sha256:c,md5:e("./md5")},h=64,d=new s(h);d.fill(0),i.createHash=function(e){return r(e)},i.createHmac=function(e,t){return r(e,t)},i.randomBytes=function(e,t){if(!t||!t.call)return new s(l(e));try{t.call(this,void 0,new s(l(e)))}catch(e){t(e)}},function(e,t){for(var i in e)t(e[i],i)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(e){i[e]=function(){o("sorry,",e,"is not implemented yet")}})},{"./md5":58,"./rng":59,"./sha":60,"./sha256":61,buffer:53}],58:[function(e,t){function i(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var i=1732584193,n=-271733879,l=-1732584194,u=271733878,h=0;h<e.length;h+=16){var d=i,p=n,_=l,f=u;n=a(n=a(n=a(n=a(n=s(n=s(n=s(n=s(n=o(n=o(n=o(n=o(n=r(n=r(n=r(n=r(n,l=r(l,u=r(u,i=r(i,n,l,u,e[h+0],7,-680876936),n,l,e[h+1],12,-389564586),i,n,e[h+2],17,606105819),u,i,e[h+3],22,-1044525330),l=r(l,u=r(u,i=r(i,n,l,u,e[h+4],7,-176418897),n,l,e[h+5],12,1200080426),i,n,e[h+6],17,-1473231341),u,i,e[h+7],22,-45705983),l=r(l,u=r(u,i=r(i,n,l,u,e[h+8],7,1770035416),n,l,e[h+9],12,-1958414417),i,n,e[h+10],17,-42063),u,i,e[h+11],22,-1990404162),l=r(l,u=r(u,i=r(i,n,l,u,e[h+12],7,1804603682),n,l,e[h+13],12,-40341101),i,n,e[h+14],17,-1502002290),u,i,e[h+15],22,1236535329),l=o(l,u=o(u,i=o(i,n,l,u,e[h+1],5,-165796510),n,l,e[h+6],9,-1069501632),i,n,e[h+11],14,643717713),u,i,e[h+0],20,-373897302),l=o(l,u=o(u,i=o(i,n,l,u,e[h+5],5,-701558691),n,l,e[h+10],9,38016083),i,n,e[h+15],14,-660478335),u,i,e[h+4],20,-405537848),l=o(l,u=o(u,i=o(i,n,l,u,e[h+9],5,568446438),n,l,e[h+14],9,-1019803690),i,n,e[h+3],14,-187363961),u,i,e[h+8],20,1163531501),l=o(l,u=o(u,i=o(i,n,l,u,e[h+13],5,-1444681467),n,l,e[h+2],9,-51403784),i,n,e[h+7],14,1735328473),u,i,e[h+12],20,-1926607734),l=s(l,u=s(u,i=s(i,n,l,u,e[h+5],4,-378558),n,l,e[h+8],11,-2022574463),i,n,e[h+11],16,1839030562),u,i,e[h+14],23,-35309556),l=s(l,u=s(u,i=s(i,n,l,u,e[h+1],4,-1530992060),n,l,e[h+4],11,1272893353),i,n,e[h+7],16,-155497632),u,i,e[h+10],23,-1094730640),l=s(l,u=s(u,i=s(i,n,l,u,e[h+13],4,681279174),n,l,e[h+0],11,-358537222),i,n,e[h+3],16,-722521979),u,i,e[h+6],23,76029189),l=s(l,u=s(u,i=s(i,n,l,u,e[h+9],4,-640364487),n,l,e[h+12],11,-421815835),i,n,e[h+15],16,530742520),u,i,e[h+2],23,-995338651),l=a(l,u=a(u,i=a(i,n,l,u,e[h+0],6,-198630844),n,l,e[h+7],10,1126891415),i,n,e[h+14],15,-1416354905),u,i,e[h+5],21,-57434055),l=a(l,u=a(u,i=a(i,n,l,u,e[h+12],6,1700485571),n,l,e[h+3],10,-1894986606),i,n,e[h+10],15,-1051523),u,i,e[h+1],21,-2054922799),l=a(l,u=a(u,i=a(i,n,l,u,e[h+8],6,1873313359),n,l,e[h+15],10,-30611744),i,n,e[h+6],15,-1560198380),u,i,e[h+13],21,1309151649),l=a(l,u=a(u,i=a(i,n,l,u,e[h+4],6,-145523070),n,l,e[h+11],10,-1120210379),i,n,e[h+2],15,718787259),u,i,e[h+9],21,-343485551),i=c(i,d),n=c(n,p),l=c(l,_),u=c(u,f)}return Array(i,n,l,u)}function n(e,t,i,n,r,o){return c(l(c(c(t,e),c(n,o)),r),i)}function r(e,t,i,r,o,s,a){return n(t&i|~t&r,e,t,o,s,a)}function o(e,t,i,r,o,s,a){return n(t&r|i&~r,e,t,o,s,a)}function s(e,t,i,r,o,s,a){return n(t^i^r,e,t,o,s,a)}function a(e,t,i,r,o,s,a){return n(i^(t|~r),e,t,o,s,a)}function c(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function l(e,t){return e<<t|e>>>32-t}var u=e("./helpers");t.exports=function(e){return u.hash(e,i,16)}},{"./helpers":56}],59:[function(e,t){!function(){var e,i;e=function(e){for(var t,i=new Array(e),n=0;e>n;n++)0==(3&n)&&(t=4294967296*Math.random()),i[n]=t>>>((3&n)<<3)&255;return i},this.crypto&&crypto.getRandomValues&&(i=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=i||e}()},{}],60:[function(e,t){function i(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var i=Array(80),a=1732584193,c=-271733879,l=-1732584194,u=271733878,h=-1009589776,d=0;d<e.length;d+=16){for(var p=a,_=c,f=l,m=u,g=h,y=0;80>y;y++){i[y]=16>y?e[d+y]:s(i[y-3]^i[y-8]^i[y-14]^i[y-16],1);var T=o(o(s(a,5),n(y,c,l,u)),o(o(h,i[y]),r(y)));h=u,u=l,l=s(c,30),c=a,a=T}a=o(a,p),c=o(c,_),l=o(l,f),u=o(u,m),h=o(h,g)}return Array(a,c,l,u,h)}function n(e,t,i,n){return 20>e?t&i|~t&n:40>e?t^i^n:60>e?t&i|t&n|i&n:t^i^n}function r(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function o(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function s(e,t){return e<<t|e>>>32-t}var a=e("./helpers");t.exports=function(e){return a.hash(e,i,20,!0)}},{"./helpers":56}],61:[function(e,t){var i=e("./helpers"),n=function(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i},r=function(e,t){return e>>>t|e<<32-t},o=function(e,t){return e>>>t},s=function(e,t,i){return e&t^~e&i},a=function(e,t,i){return e&t^e&i^t&i},c=function(e){return r(e,2)^r(e,13)^r(e,22)},l=function(e){return r(e,6)^r(e,11)^r(e,25)},u=function(e){return r(e,7)^r(e,18)^o(e,3)},h=function(e){return r(e,17)^r(e,19)^o(e,10)},d=function(e,t){var i,r,o,d,p,_,f,m,g,y,T=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),v=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),S=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var C=0;C<e.length;C+=16){i=v[0],r=v[1],o=v[2],d=v[3],p=v[4],_=v[5],f=v[6],m=v[7];for(var E=0;64>E;E++)S[E]=16>E?e[E+C]:n(n(n(h(S[E-2]),S[E-7]),u(S[E-15])),S[E-16]),g=n(n(n(n(m,l(p)),s(p,_,f)),T[E]),S[E]),y=n(c(i),a(i,r,o)),m=f,f=_,_=p,p=n(d,g),d=o,o=r,r=i,i=n(g,y);v[0]=n(i,v[0]),v[1]=n(r,v[1]),v[2]=n(o,v[2]),v[3]=n(d,v[3]),v[4]=n(p,v[4]),v[5]=n(_,v[5]),v[6]=n(f,v[6]),v[7]=n(m,v[7])}return v};t.exports=function(e){return i.hash(e,d,32,!0)}},{"./helpers":56}],62:[function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function r(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!r(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,i,r,a,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[e],s(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=new Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];i.apply(this,a)}else if(o(i)){for(r=arguments.length,a=new Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];for(r=(l=i.slice()).length,c=0;r>c;c++)l[c].apply(this,a)}return!0},i.prototype.addListener=function(e,t){if(!n(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var r;(r=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var r=!1;return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var i,r,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],s=i.length,r=-1,i===t||n(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(i)){for(a=s;a-- >0;)if(i[a]===t||i[a].listener&&i[a].listener===t){r=a;break}if(0>r)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],n(i))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.listenerCount=function(e,t){return e._events&&e._events[t]?n(e._events[t])?1:e._events[t].length:0}},{}],63:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],64:[function(e,t){function i(){}var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var i=[];return window.addEventListener("message",function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),i.length>0)&&i.shift()()},!0),function(e){i.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=i,n.addListener=i,n.once=i,n.off=i,n.removeListener=i,n.removeAllListeners=i,n.emit=i,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],65:[function(e,t,i){(function(e){!function(n){function r(e){throw RangeError(N[e])}function o(e,t){for(var i=e.length;i--;)e[i]=t(e[i]);return e}function s(e,t){return o(e.split(w),t).join(".")}function a(e){for(var t,i,n=[],r=0,o=e.length;o>r;)(t=e.charCodeAt(r++))>=55296&&56319>=t&&o>r?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function c(e){return o(e,function(e){var t="";return e>65535&&(e-=65536,t+=D(e>>>10&1023|55296),e=56320|1023&e),t+=D(e)}).join("")}function l(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:v}function u(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function h(e,t,i){var n=0;for(e=i?O(e/b):e>>1,e+=O(e/t);e>L*C>>1;n+=v)e=O(e/L);return O(n+(L+1)*e/(e+E))}function d(e){var t,i,n,o,s,a,u,d,p,_,f=[],m=e.length,g=0,y=x,E=A;for(0>(i=e.lastIndexOf(R))&&(i=0),n=0;i>n;++n)e.charCodeAt(n)>=128&&r("not-basic"),f.push(e.charCodeAt(n));for(o=i>0?i+1:0;m>o;){for(s=g,a=1,u=v;o>=m&&r("invalid-input"),((d=l(e.charCodeAt(o++)))>=v||d>O((T-g)/a))&&r("overflow"),g+=d*a,!((p=E>=u?S:u>=E+C?C:u-E)>d);u+=v)_=v-p,a>O(T/_)&&r("overflow"),a*=_;E=h(g-s,t=f.length+1,0==s),O(g/t)>T-y&&r("overflow"),y+=O(g/t),g%=t,f.splice(g++,0,y)}return c(f)}function p(e){var t,i,n,o,s,c,l,d,p,_,f,m,g,y,E,b=[];for(m=(e=a(e)).length,t=x,i=0,s=A,c=0;m>c;++c)128>(f=e[c])&&b.push(D(f));for(n=o=b.length,o&&b.push(R);m>n;){for(l=T,c=0;m>c;++c)(f=e[c])>=t&&l>f&&(l=f);for(l-t>O((T-i)/(g=n+1))&&r("overflow"),i+=(l-t)*g,t=l,c=0;m>c;++c)if(f=e[c],t>f&&++i>T&&r("overflow"),f==t){for(d=i,p=v;!((_=s>=p?S:p>=s+C?C:p-s)>d);p+=v)E=d-_,y=v-_,b.push(D(u(_+E%y,0))),d=O(E/y);b.push(D(u(d,0))),s=h(i,g,n==o),i=0,++n}++i,++t}return b.join("")}var _="object"==typeof i&&i,f="object"==typeof t&&t&&t.exports==_&&t,m="object"==typeof e&&e;(m.global===m||m.window===m)&&(n=m);var g,y,T=2147483647,v=36,S=1,C=26,E=38,b=700,A=72,x=128,R="-",P=/^xn--/,I=/[^ -~]/,w=/\x2E|\u3002|\uFF0E|\uFF61/g,N={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=v-S,O=Math.floor,D=String.fromCharCode;if(g={version:"1.2.4",ucs2:{decode:a,encode:c},decode:d,encode:p,toASCII:function(e){return s(e,function(e){return I.test(e)?"xn--"+p(e):e})},toUnicode:function(e){return s(e,function(e){return P.test(e)?d(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return g});else if(_&&!_.nodeType)if(f)f.exports=g;else for(y in g)g.hasOwnProperty(y)&&(_[y]=g[y]);else n.punycode=g}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],66:[function(e,t){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;l>u;++u){var h,d,p,_,f=e[u].replace(a,"%20"),m=f.indexOf(r);m>=0?(h=f.substr(0,m),d=f.substr(m+1)):(h=f,d=""),p=decodeURIComponent(h),_=decodeURIComponent(d),i(s,p)?n(s[p])?s[p].push(_):s[p]=[s[p],_]:s[p]=_}return s};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],67:[function(e,t){"use strict";function i(e,t){if(e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n));return i}var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,s,a){return t=t||"&",s=s||"=",null===e&&(e=void 0),"object"==typeof e?i(o(e),function(i){var o=encodeURIComponent(n(i))+s;return r(e[i])?e[i].map(function(e){return o+encodeURIComponent(n(e))}).join(t):o+encodeURIComponent(n(e[i]))}).join(t):a?encodeURIComponent(n(a))+s+encodeURIComponent(n(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}},{}],68:[function(e,t,i){"use strict";i.decode=i.parse=e("./decode"),i.encode=i.stringify=e("./encode")},{"./decode":66,"./encode":67}],69:[function(e,t,i){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(e,t,i){if(e&&s(e)&&e instanceof n)return e;var r=new n;return r.parse(e,t,i),r}function o(e){return"string"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return null===e}function c(e){return null==e}var l=e("punycode");i.parse=r,i.resolve=function(e,t){return r(e,!1,!0).resolve(t)},i.resolveObject=function(e,t){return e?r(e,!1,!0).resolveObject(t):t},i.format=function(e){return o(e)&&(e=r(e)),e instanceof n?e.format():n.prototype.format.call(e)},i.Url=n;var u=/^([a-z0-9.+-]+:)/i,h=/:[0-9]*$/,d=["<",">",'"',"`"," ","\r","\n","\t"],p=["{","}","|","\\","^","`"].concat(d),_=["'"].concat(p),f=["%","/","?",";","#"].concat(_),m=["/","?","#"],g=/^[a-z0-9A-Z_-]{0,63}$/,y=/^([a-z0-9A-Z_-]{0,63})(.*)$/,T={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},C=e("querystring");n.prototype.parse=function(e,t,i){if(!o(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e;n=n.trim();var r=u.exec(n);if(r){var s=(r=r[0]).toLowerCase();this.protocol=s,n=n.substr(r.length)}if(i||r||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===n.substr(0,2);!a||r&&v[r]||(n=n.substr(2),this.slashes=!0)}if(!v[r]&&(a||r&&!S[r])){for(var c=-1,h=0;h<m.length;h++)-1!==(E=n.indexOf(m[h]))&&(-1===c||c>E)&&(c=E);var d,p;-1!==(p=-1===c?n.lastIndexOf("@"):n.lastIndexOf("@",c))&&(d=n.slice(0,p),n=n.slice(p+1),this.auth=decodeURIComponent(d)),c=-1;for(h=0;h<f.length;h++){var E=n.indexOf(f[h]);-1!==E&&(-1===c||c>E)&&(c=E)}-1===c&&(c=n.length),this.host=n.slice(0,c),n=n.slice(c),this.parseHost(),this.hostname=this.hostname||"";var b="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!b)for(var A=this.hostname.split(/\./),h=0,x=A.length;x>h;h++){var R=A[h];if(R&&!R.match(g)){for(var P="",I=0,w=R.length;w>I;I++)P+=R.charCodeAt(I)>127?"x":R[I];if(!P.match(g)){var N=A.slice(0,h),L=A.slice(h+1),O=R.match(y);O&&(N.push(O[1]),L.unshift(O[2])),L.length&&(n="/"+L.join(".")+n),this.hostname=N.join(".");break}}}if(this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),!b){for(var D=this.hostname.split("."),F=[],h=0;h<D.length;++h){G=D[h];F.push(G.match(/[^A-Za-z0-9_-]/)?"xn--"+l.encode(G):G)}this.hostname=F.join(".")}var B=this.port?":"+this.port:"",M=this.hostname||"";this.host=M+B,this.href+=this.host,b&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!T[s])for(var h=0,x=_.length;x>h;h++){var k=_[h],W=encodeURIComponent(k);W===k&&(W=escape(k)),n=n.split(k).join(W)}var V=n.indexOf("#");-1!==V&&(this.hash=n.substr(V),n=n.slice(0,V));var z=n.indexOf("?");if(-1!==z?(this.search=n.substr(z),this.query=n.substr(z+1),t&&(this.query=C.parse(this.query)),n=n.slice(0,z)):t&&(this.search="",this.query={}),n&&(this.pathname=n),S[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var B=this.pathname||"",G=this.search||"";this.path=B+G}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",n=this.hash||"",r=!1,o="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&s(this.query)&&Object.keys(this.query).length&&(o=C.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||S[t])&&!1!==r?(r="//"+(r||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):r||(r=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),i=i.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),t+r+i+a+n},n.prototype.resolve=function(e){return this.resolveObject(r(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(o(e)){var t=new n;t.parse(e,!1,!0),e=t}var i=new n;if(Object.keys(this).forEach(function(e){i[e]=this[e]},this),i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(i[t]=e[t])}),S[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i;if(e.protocol&&e.protocol!==i.protocol){if(!S[e.protocol])return Object.keys(e).forEach(function(t){i[t]=e[t]}),i.href=i.format(),i;if(i.protocol=e.protocol,e.host||v[e.protocol])i.pathname=e.pathname;else{for(_=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),i.pathname=_.join("/")}if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var r=i.pathname||"",s=i.search||"";i.path=r+s}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var l=i.pathname&&"/"===i.pathname.charAt(0),u=e.host||e.pathname&&"/"===e.pathname.charAt(0),h=u||l||i.host&&e.pathname,d=h,p=i.pathname&&i.pathname.split("/")||[],_=e.pathname&&e.pathname.split("/")||[],f=i.protocol&&!S[i.protocol];if(f&&(i.hostname="",i.port=null,i.host&&(""===p[0]?p[0]=i.host:p.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),h=h&&(""===_[0]||""===p[0])),u)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,p=_;else if(_.length)p||(p=[]),p.pop(),p=p.concat(_),i.search=e.search,i.query=e.query;else if(!c(e.search))return f&&(i.hostname=i.host=p.shift(),(E=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=E.shift(),i.host=i.hostname=E.shift())),i.search=e.search,i.query=e.query,a(i.pathname)&&a(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!p.length)return i.pathname=null,i.path=i.search?"/"+i.search:null,i.href=i.format(),i;for(var m=p.slice(-1)[0],g=(i.host||e.host)&&("."===m||".."===m)||""===m,y=0,T=p.length;T>=0;T--)"."==(m=p[T])?p.splice(T,1):".."===m?(p.splice(T,1),y++):y&&(p.splice(T,1),y--);if(!h&&!d)for(;y--;y)p.unshift("..");!h||""===p[0]||p[0]&&"/"===p[0].charAt(0)||p.unshift(""),g&&"/"!==p.join("/").substr(-1)&&p.push("");var C=""===p[0]||p[0]&&"/"===p[0].charAt(0);if(f){i.hostname=i.host=C?"":p.length?p.shift():"";var E=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@");E&&(i.auth=E.shift(),i.host=i.hostname=E.shift())}return(h=h||i.host&&p.length)&&!C&&p.unshift(""),p.length?i.pathname=p.join("/"):(i.pathname=null,i.path=null),a(i.pathname)&&a(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},n.prototype.parseHost=function(){var e=this.host,t=h.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:65,querystring:68}],70:[function(e,t){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],71:[function(e,t,i){(function(t,n){function r(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(t)?n.showHidden=t:t&&i._extend(n,t),T(n.showHidden)&&(n.showHidden=!1),T(n.depth)&&(n.depth=2),T(n.colors)&&(n.colors=!1),T(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),c(n,e,n.depth)}function o(e,t){var i=r.styles[t];return i?"["+r.colors[i][0]+"m"+e+"["+r.colors[i][1]+"m":e}function s(e){return e}function a(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function c(e,t,n){if(e.customInspect&&t&&b(t.inspect)&&t.inspect!==i.inspect&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return y(r)||(r=c(e,r,n)),r}var o=l(e,t);if(o)return o;var s=Object.keys(t),f=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),E(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return u(t);if(0===s.length){if(b(t)){var m=t.name?": "+t.name:"";return e.stylize("[Function"+m+"]","special")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(C(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return u(t)}var g="",T=!1,S=["{","}"];if(_(t)&&(T=!0,S=["[","]"]),b(t)&&(g=" [Function"+(t.name?": "+t.name:"")+"]"),v(t)&&(g=" "+RegExp.prototype.toString.call(t)),C(t)&&(g=" "+Date.prototype.toUTCString.call(t)),E(t)&&(g=" "+u(t)),0===s.length&&(!T||0==t.length))return S[0]+g+S[1];if(0>n)return v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var A;return A=T?h(e,t,n,f,s):s.map(function(i){return d(e,t,n,f,i,T)}),e.seen.pop(),p(A,g,S)}function l(e,t){if(T(t))return e.stylize("undefined","undefined");if(y(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}return g(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,i,n,r){for(var o=[],s=0,a=t.length;a>s;++s)o.push(P(t,String(s))?d(e,t,i,n,String(s),!0):"");return r.forEach(function(r){r.match(/^\d+$/)||o.push(d(e,t,i,n,r,!0))}),o}function d(e,t,i,n,r,o){var s,a,l;if((l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),P(n,r)||(s="["+r+"]"),a||(e.seen.indexOf(l.value)<0?(a=m(i)?c(e,l.value,null):c(e,l.value,i-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),T(s)){if(o&&r.match(/^\d+$/))return a;(s=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e,t,i){var n=0;return e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]}function _(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function T(e){return void 0===e}function v(e){return S(e)&&"[object RegExp]"===A(e)}function S(e){return"object"==typeof e&&null!==e}function C(e){return S(e)&&"[object Date]"===A(e)}function E(e){return S(e)&&("[object Error]"===A(e)||e instanceof Error)}function b(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function x(e){return 10>e?"0"+e.toString(10):e.toString(10)}function R(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var I=/%[sdj%]/g;i.format=function(e){if(!y(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(r(arguments[i]));return t.join(" ")}for(var i=1,n=arguments,o=n.length,s=String(e).replace(I,function(e){if("%"===e)return"%";if(i>=o)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return e}}),a=n[i];o>i;a=n[++i])s+=m(a)||!S(a)?" "+a:" "+r(a);return s},i.deprecate=function(e,r){if(T(n.process))return function(){return i.deprecate(e,r).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),o=!0}return e.apply(this,arguments)}};var w,N={};i.debuglog=function(e){if(T(w)&&(w=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!N[e])if(new RegExp("\\b"+e+"\\b","i").test(w)){var n=t.pid;N[e]=function(){var t=i.format.apply(i,arguments);console.error("%s %d: %s",e,n,t)}}else N[e]=function(){};return N[e]},i.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=_,i.isBoolean=f,i.isNull=m,i.isNullOrUndefined=function(e){return null==e},i.isNumber=g,i.isString=y,i.isSymbol=function(e){return"symbol"==typeof e},i.isUndefined=T,i.isRegExp=v,i.isObject=S,i.isDate=C,i.isError=E,i.isFunction=b,i.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},i.isBuffer=e("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",R(),i.format.apply(i,arguments))},i.inherits=e("inherits"),i._extend=function(e,t){if(!t||!S(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e}}).call(this,e("FWaASH"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":70,FWaASH:64,inherits:63}],72:[function(e,t){(function(){var i,n;n=e("./XMLFragment"),i=function(){function e(e,t,i){var r,o,s;if(this.children=[],this.rootObject=null,this.is(e,"Object")&&(s=[e,t],t=s[0],i=s[1],e=null),null!=e&&(e=""+e||"",null==t&&(t={version:"1.0"})),null!=t&&null==t.version)throw new Error("Version number is required");if(null!=t){if(t.version=""+t.version||"",!t.version.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t.version);if(r={version:t.version},null!=t.encoding){if(t.encoding=""+t.encoding||"",!t.encoding.match(/[A-Za-z](?:[A-Za-z0-9._-]|-)*/))throw new Error("Invalid encoding: "+t.encoding);r.encoding=t.encoding}null!=t.standalone&&(r.standalone=t.standalone?"yes":"no"),o=new n(this,"?xml",r),this.children.push(o)}null!=i&&(r={},null!=e&&(r.name=e),null!=i.ext&&(i.ext=""+i.ext||"",r.ext=i.ext),o=new n(this,"!DOCTYPE",r),this.children.push(o)),null!=e&&this.begin(e)}return e.prototype.begin=function(t,i,r){var o;if(null==t)throw new Error("Root element needs a name");return this.rootObject&&(this.children=[],this.rootObject=null),null!=i?new e(t,i,r).root():(t=""+t||"",o=new n(this,t,{}),o.isRoot=!0,o.documentObject=this,this.children.push(o),this.rootObject=o,o)},e.prototype.root=function(){return this.rootObject},e.prototype.end=function(e){return toString(e)},e.prototype.toString=function(e){var t,i,n,r,o;for(i="",n=0,r=(o=this.children).length;r>n;n++)t=o[n],i+=t.toString(e);return i},e.prototype.is=function(e,t){var i;return i=Object.prototype.toString.call(e).slice(8,-1),null!=e&&i===t},e}(),t.exports=i}).call(this)},{"./XMLFragment":73}],73:[function(e,t){(function(){var e,i={}.hasOwnProperty;e=function(){function e(e,t,i,n){this.isRoot=!1,this.documentObject=null,this.parent=e,this.name=t,this.attributes=i,this.value=n,this.children=[]}return e.prototype.element=function(t,n,r){var o,s,a,c,l;if(null==t)throw new Error("Missing element name");t=""+t||"",this.assertLegalChar(t),null==n&&(n={}),this.is(n,"String")&&this.is(r,"Object")?(c=[r,n],n=c[0],r=c[1]):this.is(n,"String")&&(l=[{},n],n=l[0],r=l[1]);for(s in n)i.call(n,s)&&(a=n[s],a=""+a||"",n[s]=this.escape(a));return o=new e(this,t,n),null!=r&&(r=""+r||"",r=this.escape(r),this.assertLegalChar(r),o.raw(r)),this.children.push(o),o},e.prototype.insertBefore=function(t,n,r){var o,s,a,c,l,u;if(this.isRoot)throw new Error("Cannot insert elements at root level");if(null==t)throw new Error("Missing element name");t=""+t||"",this.assertLegalChar(t),null==n&&(n={}),this.is(n,"String")&&this.is(r,"Object")?(l=[r,n],n=l[0],r=l[1]):this.is(n,"String")&&(u=[{},n],n=u[0],r=u[1]);for(a in n)i.call(n,a)&&(c=n[a],c=""+c||"",n[a]=this.escape(c));return o=new e(this.parent,t,n),null!=r&&(r=""+r||"",r=this.escape(r),this.assertLegalChar(r),o.raw(r)),s=this.parent.children.indexOf(this),this.parent.children.splice(s,0,o),o},e.prototype.insertAfter=function(t,n,r){var o,s,a,c,l,u;if(this.isRoot)throw new Error("Cannot insert elements at root level");if(null==t)throw new Error("Missing element name");t=""+t||"",this.assertLegalChar(t),null==n&&(n={}),this.is(n,"String")&&this.is(r,"Object")?(l=[r,n],n=l[0],r=l[1]):this.is(n,"String")&&(u=[{},n],n=u[0],r=u[1]);for(a in n)i.call(n,a)&&(c=n[a],c=""+c||"",n[a]=this.escape(c));return o=new e(this.parent,t,n),null!=r&&(r=""+r||"",r=this.escape(r),this.assertLegalChar(r),o.raw(r)),s=this.parent.children.indexOf(this),this.parent.children.splice(s+1,0,o),o},e.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element");return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},e.prototype.text=function(t){var i;if(null==t)throw new Error("Missing element text");return t=""+t||"",t=this.escape(t),this.assertLegalChar(t),i=new e(this,"",{},t),this.children.push(i),this},e.prototype.cdata=function(t){var i;if(null==t)throw new Error("Missing CDATA text");if(t=""+t||"",this.assertLegalChar(t),t.match(/]]>/))throw new Error("Invalid CDATA text: "+t);return i=new e(this,"",{},"<![CDATA["+t+"]]>"),this.children.push(i),this},e.prototype.comment=function(t){var i;if(null==t)throw new Error("Missing comment text");if(t=""+t||"",t=this.escape(t),this.assertLegalChar(t),t.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return i=new e(this,"",{},"\x3c!-- "+t+" --\x3e"),this.children.push(i),this},e.prototype.raw=function(t){var i;if(null==t)throw new Error("Missing raw text");return t=""+t||"",i=new e(this,"",{},t),this.children.push(i),this},e.prototype.up=function(){if(this.isRoot)throw new Error("This node has no parent. Use doc() if you need to get the document object.");return this.parent},e.prototype.root=function(){var e;if(this.isRoot)return this;for(e=this.parent;!e.isRoot;)e=e.parent;return e},e.prototype.document=function(){return this.root().documentObject},e.prototype.end=function(e){return this.document().toString(e)},e.prototype.prev=function(){var e;if(this.isRoot)throw new Error("Root node has no siblings");if(1>(e=this.parent.children.indexOf(this)))throw new Error("Already at the first node");return this.parent.children[e-1]},e.prototype.next=function(){var e;if(this.isRoot)throw new Error("Root node has no siblings");if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[e+1]},e.prototype.clone=function(t){var i;return i=new e(this.parent,this.name,this.attributes,this.value),t&&this.children.forEach(function(e){var n;return n=e.clone(t),n.parent=i,i.children.push(n)}),i},e.prototype.importXMLBuilder=function(e){var t;return t=e.root().clone(!0),t.parent=this,this.children.push(t),t.isRoot=!1,this},e.prototype.attribute=function(e,t){if(null==e)throw new Error("Missing attribute name");if(null==t)throw new Error("Missing attribute value");return e=""+e||"",t=""+t||"",null==this.attributes&&(this.attributes={}),this.attributes[e]=this.escape(t),this},e.prototype.removeAttribute=function(e){if(null==e)throw new Error("Missing attribute name");return e=""+e||"",delete this.attributes[e],this},e.prototype.toString=function(e,t){var i,n,r,o,s,a,c,l,u,h,d,p;a=null!=e&&e.pretty||!1,o=null!=e&&e.indent||"  ",s=null!=e&&e.newline||"\n",t||(t=0),l=new Array(t+1).join(o),c="",a&&(c+=l),c+=null==this.value?"<"+this.name:""+this.value,d=this.attributes;for(i in d)n=d[i],c+="!DOCTYPE"===this.name?" "+n:" "+i+'="'+n+'"';if(0===this.children.length)null==this.value&&(c+="?xml"===this.name?"?>":"!DOCTYPE"===this.name?">":"/>"),a&&(c+=s);else if(a&&1===this.children.length&&this.children[0].value)c+=">",c+=this.children[0].value,c+="</"+this.name+">",c+=s;else{for(c+=">",a&&(c+=s),u=0,h=(p=this.children).length;h>u;u++)r=p[u],c+=r.toString(e,t+1);a&&(c+=l),c+="</"+this.name+">",a&&(c+=s)}return c},e.prototype.escape=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")},e.prototype.assertLegalChar=function(e){var t,i;if(t=/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/,i=e.match(t))throw new Error("Invalid character ("+i+") in string: "+e)},e.prototype.is=function(e,t){var i;return i=Object.prototype.toString.call(e).slice(8,-1),null!=e&&i===t},e.prototype.ele=function(e,t,i){return this.element(e,t,i)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.att=function(e,t){return this.attribute(e,t)},e.prototype.com=function(e){return this.comment(e)},e.prototype.doc=function(){return this.document()},e.prototype.e=function(e,t,i){return this.element(e,t,i)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.a=function(e,t){return this.attribute(e,t)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.u=function(){return this.up()},e}(),t.exports=e}).call(this)},{}],74:[function(e,t){(function(){var i;i=e("./XMLBuilder"),t.exports.create=function(e,t,n){return null!=e?new i(e,t,n).root():new i}}).call(this)},{"./XMLBuilder":72}]},{},[1]),function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){var i=t[s][1][e];return r(i||e)},u,u.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t){(function(i){var n=i.AMA;n.Storage=e("./StorageClients/LocalStorage.js"),n.StorageKeys=e("./StorageClients/StorageKeys.js"),n.Util=e("./MobileAnalyticsUtilities.js"),n.Client=function(){"use strict";var e=function(e){return Function.prototype.bind||(Function.prototype.bind=function(e){"function"!=typeof this&&this.logger.error("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),i=this,r=function(){return i.apply(this instanceof n.Util.NOP&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return n.Util.NOP.prototype=this.prototype,r.prototype=new n.Util.NOP,r}),this.options=e||{},this.options.logger=this.options.logger||{},this.logger={log:this.options.logger.log||n.Util.NOP,info:this.options.logger.info||n.Util.NOP,warn:this.options.logger.warn||n.Util.NOP,error:this.options.logger.error||n.Util.NOP},this.logger.log=this.logger.log.bind(this.options.logger),this.logger.info=this.logger.info.bind(this.options.logger),this.logger.warn=this.logger.warn.bind(this.options.logger),this.logger.error=this.logger.error.bind(this.options.logger),n.Storage.setLogger(this.logger),this.logger.log("[Function:(AMA)Client Constructor]"+(e?"\noptions:"+JSON.stringify(e):"")),void 0===e.appId?(this.logger.error("AMA.Client must be initialized with an appId"),null):(void 0===e.platform&&this.logger.error("AMA.Client must be initialized with a platform"),this.options.apiVersion=this.options.apiVersion||"2014-06-05",this.options.provider=this.options.provider||AWS.config.credentials,this.options.autoSubmitEvents=void 0===e.autoSubmitEvents||e.autoSubmitEvents,this.options.autoSubmitInterval=this.options.autoSubmitInterval||1e4,this.options.batchSizeLimit=this.options.batchSizeLimit||256e3,this.options.submitCallback=this.options.submitCallback||n.Util.NOP,this.options.globalAttributes=this.options.globalAttributes||{},this.options.globalMetrics=this.options.globalMetrics||{},n.Storage.set(n.StorageKeys.GLOBAL_ATTRIBUTES,n.Util.mergeObjects(this.options.globalAttributes,n.Storage.get(n.StorageKeys.GLOBAL_ATTRIBUTES)||{})),n.Storage.set(n.StorageKeys.GLOBAL_METRICS,n.Util.mergeObjects(this.options.globalMetrics,n.Storage.get(n.StorageKeys.GLOBAL_METRICS)||{})),this.options.clientContext=this.options.clientContext||{client:{client_id:this.options.clientId||n.Util.GetClientId(),app_title:this.options.appTitle,app_version_name:this.options.appVersionName,app_version_code:this.options.appVersionCode,app_package_name:this.options.appPackageName},env:{platform:this.options.platform,platform_version:this.options.platformVersion,model:this.options.model,make:this.options.make,locale:this.options.locale},services:{mobile_analytics:{app_id:this.options.appId,sdk_name:"aws-sdk-mobile-analytics-js",sdk_version:"0.9.0"}},custom:{}},this.StorageKeys={EVENTS:"AWSMobileAnalyticsEventStorage",BATCHES:"AWSMobileAnalyticsBatchStorage",BATCH_INDEX:"AWSMobileAnalyticsBatchIndexStorage"},this.outputs={},this.outputs.MobileAnalytics=new AWS.MobileAnalytics({apiVersion:this.options.apiVersion,provider:this.options.provider}),this.outputs.timeoutReference=null,this.outputs.events=n.Storage.get(this.StorageKeys.EVENTS)||[],this.outputs.batches=n.Storage.get(this.StorageKeys.BATCHES)||{},this.outputs.batchIndex=n.Storage.get(this.StorageKeys.BATCH_INDEX)||[],void this.submitEvents())};return e.prototype.validateEvent=function(e){function t(e){return 0===e.length||e.length>50}function i(e){return n.logger.error(e),null}var n=this,r=[];return r=Object.keys(e.metrics).filter(function(t){return"number"!=typeof e.metrics[t]}),"v2.0"!==e.version?i("Event must have version v2.0"):"string"!=typeof e.eventType?i("Event Type must be a string"):r.length>0?i("Event Metrics must be numeric ("+r[0]+")"):Object.keys(e.metrics).length+Object.keys(e.attributes).length>40?i("Event Metric and Attribute Count cannot exceed 40"):Object.keys(e.attributes).filter(t).length?i("Event Attribute names must be 1-50 characters"):Object.keys(e.metrics).filter(t).length?i("Event Metric names must be 1-50 characters"):Object.keys(e.attributes).filter(function(t){return e.attributes[t]&&e.attributes[t].length>200}).length?i("Event Attribute values cannot be longer than 200 characters"):e},e.prototype.createEvent=function(e,t,i,r){var o=this;this.logger.log("[Function:(AMA.Client).createEvent]"+(e?"\neventType:"+e:"")+(t?"\nsession:"+t:"")+(i?"\nattributes:"+JSON.stringify(i):"")+(r?"\nmetrics:"+JSON.stringify(r):"")),i=i||{},r=r||{},n.Util.mergeObjects(i,this.options.globalAttributes),n.Util.mergeObjects(r,this.options.globalMetrics),Object.keys(i).forEach(function(e){if("string"!=typeof i[e])try{i[e]=JSON.stringify(i[e])}catch(t){o.logger.warn("Error parsing attribute "+e)}});var s={eventType:e,timestamp:(new Date).toISOString(),session:{id:t.id,startTimestamp:t.startTimestamp},version:"v2.0",attributes:i,metrics:r};return t.stopTimestamp&&(s.session.stopTimestamp=t.stopTimestamp,s.session.duration=new Date(s.stopTimestamp).getTime()-new Date(s.startTimestamp).getTime()),this.validateEvent(s)},e.prototype.pushEvent=function(e){if(!e)return-1;this.logger.log("[Function:(AMA.Client).pushEvent]"+(e?"\nevent:"+JSON.stringify(e):""));var t=this.outputs.events.push(e);return n.Storage.set(this.StorageKeys.EVENTS,this.outputs.events),t-1},e.prototype.recordEvent=function(e,t,i,r){this.logger.log("[Function:(AMA.Client).recordEvent]"+(e?"\neventType:"+e:"")+(t?"\nsession:"+t:"")+(i?"\nattributes:"+JSON.stringify(i):"")+(r?"\nmetrics:"+JSON.stringify(r):""));var o,s=this.createEvent(e,t,i,r);return s?(o=this.pushEvent(s),n.Util.getRequestBodySize(this.outputs.events)>=this.options.batchSizeLimit&&this.submitEvents(),this.outputs.events[o]):null},e.prototype.recordMonetizationEvent=function(e,t,i,n){return this.logger.log("[Function:(AMA.Client).recordMonetizationEvent]"+(e?"\nsession:"+e:"")+(t?"\nmonetizationDetails:"+JSON.stringify(t):"")+(i?"\nattributes:"+JSON.stringify(i):"")+(n?"\nmetrics:"+JSON.stringify(n):"")),i=i||{},n=n||{},i._currency=t.currency||i._currency,i._product_id=t.productId||i._product_id,n._quantity=t.quantity||n._quantity,"number"==typeof t.price?n._item_price=t.price||n._item_price:i._item_price_formatted=t.price||i._item_price_formatted,this.recordEvent("_monetization.purchase",e,i,n)},e.prototype.submitEvents=function(e){if(e=e||{},e.submitCallback=e.submitCallback||this.options.submitCallback,this.logger.log("[Function:(AMA.Client).submitEvents]"+(e?"\noptions:"+JSON.stringify(e):"")),this.outputs.lastSubmitTimestamp&&(new Date).getTime()-this.outputs.lastSubmitTimestamp<1e3)return this.logger.warn("Prevented multiple submissions in under a second"),[];this.outputs.lastSubmitTimestamp=(new Date).getTime();var t,i,r;for(e=e||{},this.options.autoSubmitEvents&&(clearTimeout(this.outputs.timeoutReference),this.outputs.timeoutReference=setTimeout(this.submitEvents.bind(this),this.options.autoSubmitInterval));this.outputs.events.length>0;){for(t=this.outputs.events.length,this.logger.log(this.outputs.events.length+" events to be submitted");t>1&&n.Util.getRequestBodySize(this.outputs.events.slice(0,t))>this.options.batchSizeLimit;)this.logger.log("Finding Batch Size ("+this.options.batchSizeLimit+"): "+t+"("+n.Util.getRequestBodySize(this.outputs.events.slice(0,t))+")"),t-=1;r=this.outputs.events.slice(0,t),this.logger.log(r.length+" events in batch"),n.Util.getRequestBodySize(r)<512e3?(i=n.Util.GUID(),this.outputs.batches[i]=r,n.Storage.set(this.StorageKeys.BATCHES,this.outputs.batches),this.outputs.batchIndex.push(i),n.Storage.set(this.StorageKeys.BATCH_INDEX,this.outputs.batchIndex),this.outputs.events.splice(0,t),n.Storage.set(this.StorageKeys.EVENTS,this.outputs.events)):this.logger.error("Events too large")}return this.submitAllBatches(e)},e.prototype.submitAllBatches=function(e){e.submitCallback=e.submitCallback||this.options.submitCallback,this.logger.log("[Function:(AMA.Client).submitAllBatches]"+(e?"\noptions:"+JSON.stringify(e):""));var t=[],i=this;return this.outputs.batchIndex.forEach(function(n){e.batchId=n,e.clientContext=e.clientContext||i.options.clientContext,i.submitBatchById(e),t.push(n)}),t},e.prototype.clearBatchById=function(e){this.logger.log("[Function:(AMA.Client).clearBatchById]"+(e?"\nbatchId:"+e:"")),-1!==this.outputs.batchIndex.indexOf(e)&&(delete this.outputs.batches[e],this.outputs.batchIndex.splice(this.outputs.batchIndex.indexOf(e),1),n.Storage.set(this.StorageKeys.BATCH_INDEX,this.outputs.batchIndex),n.Storage.set(this.StorageKeys.BATCHES,this.outputs.batches))},e.NON_RETRYABLE_EXCEPTIONS=["BadRequestException","SerializationException","ValidationException"],e.prototype.submitBatchById=function(t){(t=t||{}).submitCallback=t.submitCallback||this.options.submitCallback,this.logger.log("[Function:(AMA.Client).submitBatchById]"+(t?"\noptions:"+JSON.stringify(t):""));var i={events:this.outputs.batches[t.batchId],clientContext:JSON.stringify(t.clientContext||this.options.clientContext)},n=this;this.outputs.MobileAnalytics.putEvents(i,function(i,r){var o=!0;t.submitCallback(i,r,t.batchId),i?(n.logger.error(i,r),(void 0===i.statusCode||400===i.statusCode)&&e.NON_RETRYABLE_EXCEPTIONS.indexOf(i.code)<0&&(o=!1)):n.logger.info("Events Submitted Successfully"),o&&n.clearBatchById(t.batchId)})},e}(),t.exports=n.Client}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsUtilities.js":4,"./StorageClients/LocalStorage.js":5,"./StorageClients/StorageKeys.js":6}],2:[function(e,t){(function(i){var n=i.AMA;n.Storage=e("./StorageClients/LocalStorage.js"),n.StorageKeys=e("./StorageClients/StorageKeys.js"),n.Util=e("./MobileAnalyticsUtilities.js"),n.Session=function(){"use strict";var e=function(e){this.options=e||{},this.options.logger=this.options.logger||{},this.logger={log:this.options.logger.log||n.Util.NOP,info:this.options.logger.info||n.Util.NOP,warn:this.options.logger.warn||n.Util.NOP,error:this.options.logger.error||n.Util.NOP},this.logger.log=this.logger.log.bind(this.options.logger),this.logger.info=this.logger.info.bind(this.options.logger),this.logger.warn=this.logger.warn.bind(this.options.logger),this.logger.error=this.logger.error.bind(this.options.logger),this.logger.log("[Function:(AWS.MobileAnalyticsClient)Session Constructor]"+(e?"\noptions:"+JSON.stringify(e):"")),this.options.expirationCallback=this.options.expirationCallback||n.Util.NOP,this.id=this.options.sessionId||n.Util.GUID(),this.sessionLength=this.options.sessionLength||6e5,this.StorageKeys={SESSION_ID:n.StorageKeys.SESSION_ID+this.id,SESSION_EXPIRATION:n.StorageKeys.SESSION_EXPIRATION+this.id,SESSION_START_TIMESTAMP:n.StorageKeys.SESSION_START_TIMESTAMP+this.id},this.startTimestamp=this.options.startTime||n.Storage.get(this.StorageKeys.SESSION_START_TIMESTAMP)||(new Date).toISOString(),this.expirationDate=parseInt(n.Storage.get(this.StorageKeys.SESSION_EXPIRATION),10),isNaN(this.expirationDate)&&(this.expirationDate=(new Date).getTime()+this.sessionLength),n.Storage.set(this.StorageKeys.SESSION_ID,this.id),n.Storage.set(this.StorageKeys.SESSION_EXPIRATION,this.expirationDate),n.Storage.set(this.StorageKeys.SESSION_START_TIMESTAMP,this.startTimestamp),this.sessionTimeoutReference=setTimeout(this.expireSession.bind(this),this.sessionLength)};return e.prototype.expireSession=function(e){this.logger.log("[Function:(Session).expireSession]");var t=(e=e||this.options.expirationCallback)(this);"boolean"==typeof t&&t&&(t=this.options.sessionLength),"number"==typeof t?this.extendSession(t):this.clearSession()},e.prototype.clearSession=function(){this.logger.log("[Function:(Session).clearSession]"),clearTimeout(this.sessionTimeoutReference),n.Storage.delete(this.StorageKeys.SESSION_ID),n.Storage.delete(this.StorageKeys.SESSION_EXPIRATION),n.Storage.delete(this.StorageKeys.SESSION_START_TIMESTAMP)},e.prototype.extendSession=function(e){this.logger.log("[Function:(Session).extendSession]"+(e?"\nsessionExtensionLength:"+e:"")),e=e||this.sessionLength,this.setSessionTimeout(this.expirationDate+parseInt(e,10))},e.prototype.stopSession=function(e){this.logger.log("[Function:(Session).stopSession]"+(e?"\nstopDate:"+e:"")),this.stopTimestamp=e||(new Date).toISOString()},e.prototype.resetSessionTimeout=function(e){this.logger.log("[Function:(Session).resetSessionTimeout]"+(e?"\nmilliseconds:"+e:"")),e=e||this.sessionLength,this.setSessionTimeout((new Date).getTime()+e)},e.prototype.setSessionTimeout=function(e){this.logger.log("[Function:(Session).setSessionTimeout]"+(e?"\ntimeout:"+e:"")),clearTimeout(this.sessionTimeoutReference),this.expirationDate=e,n.Storage.set(this.StorageKeys.SESSION_EXPIRATION,this.expirationDate),this.sessionTimeoutReference=setTimeout(this.expireSession.bind(this),this.expirationDate-(new Date).getTime())},e}(),t.exports=n.Session}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsUtilities.js":4,"./StorageClients/LocalStorage.js":5,"./StorageClients/StorageKeys.js":6}],3:[function(e,t){(function(i){var n=i.AMA;n.Storage=e("./StorageClients/LocalStorage.js"),n.StorageKeys=e("./StorageClients/StorageKeys.js"),n.Session=e("./MobileAnalyticsSession.js"),n.Client=e("./MobileAnalyticsClient.js"),n.Manager=function(){"use strict";var e=function(e){this.client=e instanceof n.Client?e:new n.Client(e),this.options=this.client.options,this.outputs=this.client.outputs,this.options.expirationCallback=this.options.expirationCallback||n.Util.NOP,function(e){n.Storage.each(function(t){0===t.indexOf(n.StorageKeys.SESSION_ID)&&(e.outputs.session=new n.Session({sessionId:n.Storage.get(t),sessionLength:e.options.sessionLength,expirationCallback:function(t){var i=e.options.expirationCallback(t);return!0===i||"number"==typeof i?i:void e.stopSession()}}),(new Date).getTime()>e.outputs.session.expirationDate&&(e.outputs.session.expireSession(),delete e.outputs.session))})}(this),this.outputs.session||this.startSession(),this.client.submitEvents()};return e.prototype.submitEvents=function(e){return this.client.submitEvents(e)},e.prototype.startSession=function(){return this.client.logger.log("[Function:(AMA.Manager).startSession]"),this.outputs.session&&this.outputs.session.clearSession(),this.outputs.session=new n.Session({logger:this.client.options.logger,sessionLength:this.options.sessionLength,expirationCallback:function(e){var t=this.options.expirationCallback(e);return!0===t||"number"==typeof t?t:void this.stopSession()}.bind(this)}),this.recordEvent("_session.start")},e.prototype.extendSession=function(e){return this.outputs.session.extendSession(e||this.options.sessionLength)},e.prototype.stopSession=function(){return this.client.logger.log("[Function:(AMA.Manager).stopSession]"),this.outputs.session.stopSession(),this.outputs.session.expireSession(n.Util.NOP),this.recordEvent("_session.stop")},e.prototype.renewSession=function(){return this.stopSession(),this.startSession(),this.outputs.session},e.prototype.createEvent=function(e,t,i){return this.client.createEvent(e,this.outputs.session,t,i)},e.prototype.recordEvent=function(e,t,i){return this.client.recordEvent(e,this.outputs.session,t,i)},e.prototype.recordMonetizationEvent=function(e,t,i){return this.client.recordMonetizationEvent(this.outputs.session,e,t,i)},e}(),t.exports=n.Manager}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsClient.js":1,"./MobileAnalyticsSession.js":2,"./StorageClients/LocalStorage.js":5,"./StorageClients/StorageKeys.js":6}],4:[function(e,t){(function(i){var n=i.AMA;n.Storage=e("./StorageClients/LocalStorage.js"),n.StorageKeys=e("./StorageClients/StorageKeys.js"),n.Util=function(){"use strict";function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function t(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function i(e,t){return Object.keys(t).forEach(function(i){t.hasOwnProperty(i)&&(e[i]=e[i]||t[i])}),e}return{copy:function(e,t){return i(JSON.parse(JSON.stringify(e)),t)},GUID:t,GetClientId:function(){return void 0===n.Storage.get(n.StorageKeys.CLIENT_ID)&&n.Storage.set(n.StorageKeys.CLIENT_ID,t()),n.Storage.get(n.StorageKeys.CLIENT_ID)},getRequestBodySize:function(e){"string"!=typeof e&&(e=JSON.stringify(e));var t,i,n=e.length;for(t=e.length-1;t>=0;t-=1)(i=e.charCodeAt(t))>127&&2047>=i?n+=1:i>2047&&65535>=i&&(n+=2),i>=56320&&57343>=i&&(t-=1);return n},mergeObjects:i,NOP:function(){}}}(),t.exports=n.Util}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./StorageClients/LocalStorage.js":5,"./StorageClients/StorageKeys.js":6}],5:[function(e,t){(function(i){var n=i.AMA;n.Util=e("../MobileAnalyticsUtilities.js"),n.Storage=function(){"use strict";function e(){try{return window&&window.localStorage}catch(e){return!1}}function t(){if(a={},e())try{o&&o.log("[Function:(AWS.MobileAnalyticsClient.Storage).clearLocalStorage]"),window.localStorage.removeItem(s)}catch(e){console.log("Error clearing LocalStorage: "+JSON.stringify(e))}else console.log("LocalStorage is not available")}function i(){if(e()){var i;try{if(o&&o.log("[Function:(AWS.MobileAnalyticsClient.Storage).loadLocalStorage]"),i=window.localStorage.getItem(s),o&&o.log("LocalStorage Cache: "+i),i)try{a=JSON.parse(i)}catch(e){t()}}catch(e){console.log("Error loading LocalStorage: "+JSON.stringify(e)),t()}}else console.log("LocalStorage is not available")}function r(){if(e())try{o&&o.log("[Function:(AWS.MobileAnalyticsClient.Storage).saveToLocalStorage]"),window.localStorage.setItem(s,JSON.stringify(a)),o&&o.log("LocalStorage Cache: "+JSON.stringify(a))}catch(e){console.log("Error saving to LocalStorage: "+JSON.stringify(e))}else console.log("LocalStorage is not available")}var o,s="AWSMobileAnalyticsStorage",a={};return i(),{type:"LOCAL_STORAGE",id:n.Util.GUID(),get:function(e){return a[e]},set:function(e,t){a[e]=t,r()},delete:function(e){delete a[e],r()},each:function(e){var t;for(t in a)a.hasOwnProperty(t)&&e(t,a[t])},reload:i,setLogger:function(e){o=e},supportsLocalStorage:e,clearLocalStorage:t}}(),t.exports=n.Storage}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../MobileAnalyticsUtilities.js":4}],6:[function(e,t){(function(e){var i=e.AMA;i.StorageKeys={CLIENT_ID:"AWSMobileAnalyticsClientId",GLOBAL_ATTRIBUTES:"AWSMobileAnalyticsGlobalAttributes",GLOBAL_METRICS:"AWSMobileAnalyticsGlobalMetrics",SESSION_ID:"MobileAnalyticsSessionId",SESSION_EXPIRATION:"MobileAnalyticsSessionExpiration",SESSION_START_TIMESTAMP:"MobileAnalyticsSessionStartTimeStamp"},t.exports=i.StorageKeys}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t){(function(i){i.AMA=i.AMA||{},e("./MobileAnalyticsClient.js"),e("./MobileAnalyticsUtilities.js"),e("./StorageClients/StorageKeys.js"),e("./StorageClients/LocalStorage.js"),e("./MobileAnalyticsSession.js"),e("./MobileAnalyticsSessionManager.js"),t.exports=i.AMA}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsClient.js":1,"./MobileAnalyticsSession.js":2,"./MobileAnalyticsSessionManager.js":3,"./MobileAnalyticsUtilities.js":4,"./StorageClients/LocalStorage.js":5,"./StorageClients/StorageKeys.js":6}]},{},[7]);